var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,d){c!=Array.prototype&&c!=Object.prototype&&(c[f]=d.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var f=0;return $jscomp.iteratorPrototype(function(){return f<c.length?{done:!1,value:c[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.iteratorFromArray=function(c,f){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var d=0,e={next:function(){if(d<c.length){var g=d++;return{value:f(g,c[g]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(c,f,d,e){if(f){d=$jscomp.global;c=c.split(".");for(e=0;e<c.length-1;e++){var g=c[e];g in d||(d[g]={});d=d[g]}c=c[c.length-1];e=d[c];f=f(e);f!=e&&null!=f&&$jscomp.defineProperty(d,c,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6","es3");
$jscomp.polyfill("Array.from",function(c){return c?c:function(c,d,e){$jscomp.initSymbolIterator();d=null!=d?d:function(c){return c};var g=[],f=c[Symbol.iterator];if("function"==typeof f){c=f.call(c);for(var h=0;!(f=c.next()).done;)g.push(d.call(e,f.value,h++))}else for(f=c.length,h=0;h<f;h++)g.push(d.call(e,c[h],h));return g}},"es6","es3");$jscomp.owns=function(c,f){return Object.prototype.hasOwnProperty.call(c,f)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(c,f){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var g in e)$jscomp.owns(e,g)&&(c[g]=e[g])}return c};$jscomp.polyfill("Object.assign",function(c){return c||$jscomp.assign},"es6","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c,d){return d})}},"es8","es3");$jscomp.polyfill("Object.is",function(c){return c?c:function(c,d){return c===d?0!==c||1/c===1/d:c!==c&&d!==d}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(c){return c?c:function(c,d){var e=this;e instanceof String&&(e=String(e));var g=e.length;d=d||0;for(0>d&&(d=Math.max(d+g,0));d<g;d++){var f=e[d];if(f===c||Object.is(f,c))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(c,f,d){if(null==c)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return c+""};$jscomp.polyfill("String.prototype.includes",function(c){return c?c:function(c,d){return-1!==$jscomp.checkStringArgs(this,c,"includes").indexOf(c,d||0)}},"es6","es3");
$jscomp.polyfill("Math.sign",function(c){return c?c:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}},"es6","es3");$jscomp.polyfill("Object.entries",function(c){return c?c:function(c){var d=[],e;for(e in c)$jscomp.owns(c,e)&&d.push([e,c[e]]);return d}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(c){return c?c:function(c,d,e){var g=this.length||0;0>d&&(d=Math.max(0,g+d));if(null==e||e>g)e=g;e=Number(e);0>e&&(e=Math.max(0,g+e));for(d=Number(d||0);d<e;d++)this[d]=c;return this}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var c={},f=Object.create(new $jscomp.global.Proxy(c,{get:function(d,e,g){return d==c&&"q"==e&&g==f}}));return!0===f.q}catch(d){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();var f=c[Symbol.iterator];return f?f.call(c):$jscomp.arrayIterator(c)};
$jscomp.polyfill("WeakMap",function(c){function f(){if(!c||!Object.seal)return!1;try{var d=Object.seal({}),e=Object.seal({}),g=new c([[d,2],[e,3]]);if(2!=g.get(d)||3!=g.get(e))return!1;g.delete(d);g.set(e,4);return!g.has(d)&&4==g.get(e)}catch(p){return!1}}function d(c){$jscomp.owns(c,g)||$jscomp.defineProperty(c,g,{value:{}})}function e(c){var e=Object[c];e&&(Object[c]=function(c){d(c);return e(c)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(f())return c;
var g="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var k=0,h=function(c){this.id_=(k+=Math.random()+1).toString();if(c){$jscomp.initSymbol();$jscomp.initSymbolIterator();c=$jscomp.makeIterator(c);for(var d;!(d=c.next()).done;)d=d.value,this.set(d[0],d[1])}};h.prototype.set=function(c,e){d(c);if(!$jscomp.owns(c,g))throw Error("WeakMap key fail: "+c);c[g][this.id_]=e;return this};h.prototype.get=function(c){return $jscomp.owns(c,g)?c[g][this.id_]:void 0};h.prototype.has=
function(c){return $jscomp.owns(c,g)&&$jscomp.owns(c[g],this.id_)};h.prototype.delete=function(c){return $jscomp.owns(c,g)&&$jscomp.owns(c[g],this.id_)?delete c[g][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(c){function f(){if($jscomp.ASSUME_NO_NATIVE_MAP||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),e=new c($jscomp.makeIterator([[d,"s"]]));if("s"!=e.get(d)||1!=e.size||e.get({x:4})||e.set({x:4},"t")!=e||2!=e.size)return!1;var g=e.entries(),f=g.next();if(f.done||f.value[0]!=d||"s"!=f.value[1])return!1;f=g.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!g.next().done?!1:!0}catch(t){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(f())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=new WeakMap,e=function(c){this.data_={};this.head_=h();this.size=0;if(c){c=$jscomp.makeIterator(c);for(var d;!(d=c.next()).done;)d=d.value,this.set(d[0],d[1])}};e.prototype.set=function(c,d){c=0===c?0:c;var e=g(this,c);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=d:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:c,value:d},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};e.prototype.delete=function(c){c=g(this,c);return c.entry&&c.list?(c.list.splice(c.index,1),c.list.length||delete this.data_[c.id],c.entry.previous.next=c.entry.next,c.entry.next.previous=c.entry.previous,c.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=h();this.size=0};e.prototype.has=function(c){return!!g(this,c).entry};
e.prototype.get=function(c){return(c=g(this,c).entry)&&c.value};e.prototype.entries=function(){return k(this,function(c){return[c.key,c.value]})};e.prototype.keys=function(){return k(this,function(c){return c.key})};e.prototype.values=function(){return k(this,function(c){return c.value})};e.prototype.forEach=function(c,d){for(var e=this.entries(),g;!(g=e.next()).done;)g=g.value,c.call(d,g[1],g[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var g=function(c,e){var g=e&&typeof e;"object"==
g||"function"==g?d.has(e)?g=d.get(e):(g=""+ ++n,d.set(e,g)):g="p_"+e;var f=c.data_[g];if(f&&$jscomp.owns(c.data_,g))for(c=0;c<f.length;c++){var h=f[c];if(e!==e&&h.key!==h.key||e===h.key)return{id:g,list:f,index:c,entry:h}}return{id:g,list:f,index:-1,entry:void 0}},k=function(c,d){var e=c.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=c.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:d(e)};e=null}return{done:!0,value:void 0}})},h=function(){var c={};return c.previous=
c.next=c.head=c},n=0;return e},"es6","es3");
$jscomp.polyfill("Set",function(c){function f(){if($jscomp.ASSUME_NO_NATIVE_SET||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),g=new c($jscomp.makeIterator([d]));if(!g.has(d)||1!=g.size||g.add(d)!=g||1!=g.size||g.add({x:4})!=g||2!=g.size)return!1;var f=g.entries(),h=f.next();if(h.done||h.value[0]!=d||h.value[1]!=d)return!1;h=f.next();return h.done||h.value[0]==d||4!=h.value[0].x||h.value[1]!=h.value[0]?!1:f.next().done}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(f())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var d=function(c){this.map_=new Map;if(c){c=$jscomp.makeIterator(c);for(var d;!(d=c.next()).done;)this.add(d.value)}this.size=this.map_.size};d.prototype.add=function(c){c=0===c?0:c;this.map_.set(c,c);this.size=this.map_.size;return this};d.prototype.delete=function(c){c=this.map_.delete(c);this.size=this.map_.size;return c};d.prototype.clear=
function(){this.map_.clear();this.size=0};d.prototype.has=function(c){return this.map_.has(c)};d.prototype.entries=function(){return this.map_.entries()};d.prototype.values=function(){return this.map_.values()};d.prototype.keys=d.prototype.values;d.prototype[Symbol.iterator]=d.prototype.values;d.prototype.forEach=function(c,d){var e=this;this.map_.forEach(function(g){return c.call(d,g,g,e)})};return d},"es6","es3");
$jscomp.polyfill("Math.log10",function(c){return c?c:function(c){return Math.log(c)/Math.LN10}},"es6","es3");
for(var __svgElements=document.getElementsByTagName("svg"),__svgElements_count=0;__svgElements_count<__svgElements.length;__svgElements_count++)if(__svgElements[__svgElements_count].hasAttribute("workspace")){var __globals={};__globals.svgElement=__svgElements[__svgElements_count];__globals.super={};__globals.super.devMode=null!=(new URL(window.location.href)).searchParams.get("dev");__globals.super.testMode=null!=(new URL(window.location.href)).searchParams.get("test");__globals.super.mouseWheelZoomEnabled=
!0;__globals.super.mouseGripPanningEnabled=!0;__globals.super.readOnlyMode=!1;__globals.super.enableSaveload=!0;__globals.super.keys={alt:"altKey",ctrl:"ctrlKey"};-1!=window.navigator.platform.indexOf("Mac")&&(__globals.super.keys.ctrl="metaKey");__globals.super.helpFolderLocation="https://metasophiea.com/curve/help/";__globals.super.demoMode=function(c){__globals.super.mouseWheelZoomEnabled=!c;__globals.super.mouseGripPanningEnabled=!c;__globals.super.readOnlyMode=c;__globals.super.enableSaveload=
!c};__globals.super.devMode||(window.onbeforeunload=function(){return"Unsaved work will be lost"});__globals.utility=new function(){this.workspace=new function(){this.currentPosition=function(){return __globals.utility.element.getTransform(__globals.panes.workspace)};this.gotoPosition=function(c,f,d,e){__globals.utility.element.setTransform(__globals.panes.workspace,{x:c,y:f,s:d,r:e})};this.getPane=function(c){for(;!c.getAttribute("pane");)c=c.parentElement;return c};this.getGlobal=function(c){for(;!c.getAttribute("global");)c=
c.parentElement;return c};this.objectUnderPoint=function(c,f){if(void 0!=c&&void 0!=f){c=document.elementFromPoint(c,f);if(c.hasAttribute("workspace"))return null;for(;!c.parentElement.hasAttribute("pane");)c=c.parentElement;return c}};this.pointConverter=new function(){this.browser2workspace=function(c,f){var d=__globals.utility.element.getTransform(__globals.panes.workspace);return{x:(c-d.x)/d.s,y:(f-d.y)/d.s}};this.workspace2browser=function(c,f){var d=__globals.utility.element.getTransform(__globals.panes.workspace);
return{x:c*d.s+d.x,y:f*d.s+d.y}}};this.dotMaker=function(c,f,d,e,g,k){d=void 0===d?"":d;e=void 0===e?1:e;g=void 0===g?"fill:rgba(255,100,255,0.75); font-size:3; font-family:Helvetica;":g;k=void 0===k?!1:k;c=__globals.utility.misc.elementMaker("g",null,{x:c,y:f});e=__globals.utility.misc.elementMaker("circle",null,{x:0,y:0,r:e,style:g});d=__globals.utility.misc.elementMaker("text",null,{x:0,y:0,angle:0,text:d,style:g});c.appendChild(e);c.appendChild(d);k&&__globals.panes.foreground.append(c);return c};
this.getGlobalScale=function(c){return __globals.utility.element.getTransform(__globals.utility.workspace.getGlobal(c)).s};this.getViewportDimensions=function(){return{width:__globals.svgElement.width.baseVal.value,height:__globals.svgElement.height.baseVal.value}};this.placeAndReturnObject=function(c,f){return __globals.panes[void 0===f?"middleground":f].appendChild(c)};this.mouseInteractionHandler=function(c,f){void 0!=c&&(__globals.svgElement.onmousemove_old=__globals.svgElement.onmousemove,__globals.svgElement.onmouseup_old=
__globals.svgElement.onmouseup,__globals.svgElement.onmouseleave_old=__globals.svgElement.onmouseleave,__globals.svgElement.onmousemove=function(d){c(d)},__globals.svgElement.onmouseup=function(c){void 0!=f&&f(c);__globals.svgElement.onmousemove=__globals.svgElement.onmousemove_old;__globals.svgElement.onmouseleave=__globals.svgElement.onmouseleave_old;__globals.svgElement.onmouseup=__globals.svgElement.onmouseup_old},__globals.svgElement.onmouseleave=__globals.svgElement.onmouseup)};this.clear=function(c){__globals.panes[void 0===
c?"middleground":c].innerHTML=""};this.exportScene=function(c){c=void 0===c?!1:c;for(var f=[],d={},e=Array.from(__globals.panes.middleground.children),g=[],k=0;k<e.length;k++)"null"!=e[k].id&&g.push(e[k]);e=g;for(k=0;k<e.length;k++)if(g={},e[k].creatorMethod){c&&(d[e[k].id]=e[k].creatorMethod);g.objectConstructorName=e[k].id;g.position=__globals.utility.element.getTransform(e[k]);e[k].exportData&&(g.data=e[k].exportData());if(e[k].io){for(var h=[],n=Object.keys(e[k].io),l=0;l<n.length;l++){var m=
{};m.originPort=n[l];if(e[k].io[n[l]].foreignNode){for(var p=Object.keys(e[k].io[n[l]].foreignNode.parentElement.io),r=0;r<p.length;r++)if(e[k].io[n[l]].foreignNode.parentElement.io[p[r]]===e[k].io[n[l]].foreignNode){m.destinationPorts=p[r];m.destinationIndex=e.indexOf(e[k].io[n[l]].foreignNode.parentElement);break}0<=m.destinationIndex&&h.push(m)}}g.connections=h}f.push(g)}return{scene:f,constructorFunctions:d}};this.importScene=function(c,f,d){f=void 0===f?!1:f;for(var e=[],g=0;g<c.length;g++){var k=
c[g],h=__globals.utility.workspace.placeAndReturnObject((f?d[k.objectConstructorName]:objects[k.objectConstructorName])(k.position.x,k.position.y));h.importData&&h.importData(k.data);k.connections&&k.connections.forEach(function(c){c.destinationIndex<e.length&&h.io[c.originPort].connectTo(e[c.destinationIndex].io[c.destinationPorts])});e.push(h)}};this.saveload=new function(){this.save=function(c,f,d){c=void 0===c?!0:c;d={sceneName:void 0===f?"project":f,bundleConstructorFunctions:void 0===d?!1:d,
viewportLocation:__globals.utility.workspace.currentPosition(),constructorFunctions:{},objects:[]};f=d.sceneName;__globals.audio.destination.masterGain(0);var e=__globals.utility.workspace.exportScene(d.bundleConstructorFunctions);d.objects=e.scene;d.constructorFunctions=e.constructorFunctions;d=__globals.utility.misc.serialize(d,c);__globals.utility.misc.printFile(f+".crv",d);__globals.audio.destination.masterGain(1)};this.__loadProcess=function(c,f){__globals.audio.destination.masterGain(0);__globals.utility.workspace.clear();
c=__globals.utility.misc.unserialize(c,f);__globals.utility.workspace.importScene(c.objects,c.bundleConstructorFunctions,c.constructorFunctions);__globals.utility.workspace.gotoPosition(c.viewportLocation.x,c.viewportLocation.y,c.viewportLocation.s,c.viewportLocation.r);__globals.audio.destination.masterGain(1);console.log('scene "'+c.sceneName+'" has been loaded')};this.load=function(c){c=void 0===c?!0:c;__globals.utility.misc.openFile(function(f){__globals.utility.workspace.saveload.__loadProcess(f,
c)})};this.loadFromURL=function(c,f){f=void 0===f?!0:f;var d=new XMLHttpRequest;d.open("GET",c,!0);d.responseType="text";d.onload=function(){__globals.utility.workspace.saveload.__loadProcess(this.response,f)};d.send()}};this.setStaticBackgroundStyle=function(c){__globals.panes.staticBackground.innerHTML="";__globals.utility.workspace.placeAndReturnObject(__globals.utility.misc.elementMaker("rect",null,{width:"100%",height:"100%",style:c+"pointer-events:none;"}),"staticBackground")}};this.element=
new function(){this.getTransform=function(c){var f=c.style.transform;f=f.slice(10).split("px, ",2);c=Number(f[0]);f=f[1].split("px) scale(",2);var d=Number(f[0]);f=f[1].split(") rotate(",2);var e=Number(f[0]);f=Number(f[1].slice(0,-4));return{x:c,y:d,s:e,r:f}};this.getCumulativeTransform=function(c){for(data=this.getTransform(c);!c.parentElement.getAttribute("pane");){c=c.parentElement;var f=this.getTransform(c);data.x+=f.x;data.y+=f.y;data.s*=f.s;data.r+=f.r}return data};this.getTruePoint=function(c){for(data=
this.getTransform(c);!c.parentElement.getAttribute("pane");){c=c.parentElement;var f=this.getTransform(c),d=__globals.utility.math.cartesian2polar(data.x,data.y);d.ang+=f.r;d=__globals.utility.math.polar2cartesian(d.ang,d.dis);data.x=d.x+f.x;data.y=d.y+f.y;data.s*=f.s;data.r+=f.r}return data};this.setTransform=function(c,f){c.style.transform="translate("+f.x+"px, "+f.y+"px) scale("+f.s+") rotate("+f.r+"rad)"};this.setTransform_XYonly=function(c,f,d){if(null!=f||null!=d){var e=this.getTransform(c);
null!=f&&(e.x=f);null!=d&&(e.y=d);this.setTransform(c,e)}};this.setStyle=function(c,f){var d=this.getTransform(c);c.style=f;this.setTransform(c,d)};this.setRotation=function(c,f){c.style.transform=c.style.transform.replace(/rotate\(([-+]?[0-9]*\.?[0-9]+)/,"rotate("+f)};this.getBoundingBox=function(c){var f=document.createElementNS("http://www.w3.org/2000/svg","g");__globals.panes.workspace.append(f);c=c.cloneNode(!0);f.append(c);c=c.getBBox();f.remove();return c};this.makeUnselectable=function(c){c.style["-webkit-user-select"]=
"none";c.style["-moz-user-select"]="none";c.style["-ms-user-select"]="none";c.style["user-select"]="none"};this.getPositionWithinFromMouse=function(c,f,d,e){f=__globals.utility.element.getTruePoint(f);c=__globals.utility.workspace.pointConverter.browser2workspace(c.offsetX,c.offsetY);c=__globals.utility.math.cartesian2polar(c.x-f.x,c.y-f.y);c.ang-=f.r;c=__globals.utility.math.polar2cartesian(c.ang,c.dis);d={x:c.x/d,y:c.y/e};0>d.x?d.x=0:1<d.x&&(d.x=1);0>d.y?d.y=0:1<d.y&&(d.y=1);return d};this.styleExtractor=
function(c){var f={},d=c.split(";").filter(function(c){return 0!=c.length});try{for(var e=0;e<d.length;e++){var g=d[e].split(":");g[0]=g[0].replace(/^\s+|\s+$/g,"");g[1]=g[1].replace(/^\s+|\s+$/g,"");f[g[0]]=g[1]}}catch(k){return console.error('styleExtractor was unable to parse the string "'+c+'"'),{}}return f};this.stylePacker=function(c){for(var f="",d=Object.keys(c),e=0;e<d.length;e++)f+=d[e]+":"+c[d[e]]+";";return f}};this.object=new function(){this.requestInteraction=function(c,f,d,e){if(!c||
!f)return!0;c=document.elementFromPoint(c,f);if(c.hasAttribute("workspace"))return!0;for(;!c.hasAttribute("global");){if(c==document.body||c[d]||c.hasAttribute(d))return!1;c=c.parentElement}return c.getAttribute("pane")==e};this.generateSelectionArea=function(c,f){f.selectionArea={};f.selectionArea.box=[];f.selectionArea.points=[];f.updateSelectionArea=function(){f.selectionArea.points=[];c.forEach(function(c){f.selectionArea.points.push({x:c.x,y:c.y})});f.selectionArea.box=__globals.utility.math.boundingBoxFromPoints(f.selectionArea.points);
var d=__globals.utility.element.getTransform(f);f.selectionArea.box.forEach(function(c){c.x+=d.x;c.y+=d.y});f.selectionArea.points.forEach(function(c){c.x+=d.x;c.y+=d.y})};f.updateSelectionArea()}};this.audio=new function(){this.changeAudioParam=function(c,f,d,e,g,k){if(null==d)return f.value;(void 0===k||k)&&f.cancelScheduledValues(c.currentTime);try{switch(g){case "linear":f.linearRampToValueAtTime(d,c.currentTime+e);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");
0==d&&(d=1E-4);f.exponentialRampToValueAtTime(d,c.currentTime+e);break;case "s":var h=d-f.value,n=__globals.utility.math.curveGenerator.s(10);for(d=0;d<n.length;d++)n[d]=f.value+n[d]*h;f.setValueCurveAtTime(new Float32Array(n),c.currentTime,e);break;default:f.setTargetAtTime(d,c.currentTime,.001)}}catch(l){console.log("could not change param (probably due to an overlap)"),console.log(l)}};this.loadAudioFile=function(c,f,d){d=void 0===d?"":d;switch(void 0===f?"file":f){case "url":f=new XMLHttpRequest;
f.open("GET",d,!0);f.responseType="arraybuffer";f.onload=function(){__globals.audio.context.decodeAudioData(this.response,function(e){c({buffer:e,name:d.split("/").pop(),duration:e.duration})},function(c){console.warn("Error with decoding audio data"+c.err)})};f.send();break;default:f=document.createElement("input"),f.type="file",f.onchange=function(){var d=this.files[0],g=new FileReader;g.readAsArrayBuffer(d);g.onload=function(e){__globals.audio.context.decodeAudioData(e.target.result,function(e){c({buffer:e,
name:d.name,duration:e.duration})})}},document.body.appendChild(f),f.click()}};this.waveformSegment=function(c,f){f=void 0===f?{start:0,end:1}:f;var d=c.getChannelData(0);f.start=f.start?f.start:0;f.end=f.end?f.end:1;var e=c.length*f.start;c=c.length*f.end;f=(c-e)/1E4;for(var g=[];e<c;e+=Math.round(f))g.push(__globals.utility.math.largestValueFound(d.slice(e,e+Math.round(f))));return g};this.loadBuffer=function(c,f,d,e){c=c.createBufferSource();c.buffer=f;c.connect(d);c.onended=e;return c}};this.math=
new function(){this.averageArray=function(c){return c.reduce(function(c,d){return c+d},0)/c.length};this.largestValueFound=function(c){return c.reduce(function(c,d){return Math.abs(c)>Math.abs(d)?c:d})};this.polar2cartesian=function(c,f){return{x:f*Math.cos(c),y:f*Math.sin(c)}};this.cartesian2polar=function(c,f){return{dis:Math.pow(Math.pow(c,2)+Math.pow(f,2),.5),ang:0===c?0===f?0:0<f?.5*Math.PI:1.5*Math.PI:0===f?0<=c?0:Math.PI:0<=c?Math.atan(f/c):Math.atan(f/c)+Math.PI}};this.boundingBoxFromPoints=
function(c){for(var f=c[0].x,d=c[0].x,e=c[0].y,g=c[0].y,k=1;k<c.length;k++)c[k].x<f?f=c[k].x:c[k].x>d&&(d=c[k].x),c[k].y<e?e=c[k].y:c[k].y>g&&(g=c[k].y);return[{x:d,y:g},{x:f,y:e}]};this.intersectionOfTwoLineSegments=function(c,f){var d=(f[1].y-f[0].y)*(c[1].x-c[0].x)-(f[1].x-f[0].x)*(c[1].y-c[0].y);if(0==d)return null;var e=((f[1].x-f[0].x)*(c[0].y-f[0].y)-(f[1].y-f[0].y)*(c[0].x-f[0].x))/d;f=((c[1].x-c[0].x)*(c[0].y-f[0].y)-(c[1].y-c[0].y)*(c[0].x-f[0].x))/d;return{x:c[0].x+e*(c[1].x-c[0].x),y:c[0].y+
e*(c[1].y-c[0].y),inSeg1:0<=e&&1>=e,inSeg2:0<=f&&1>=f}};this.seconds2time=function(c){var f={h:0,m:0,s:0};f.h=Math.floor(c/3600);c-=3600*f.h;f.m=Math.floor(c/60);c-=60*f.m;f.s=c;return f};this.detectOverlap=function(c,f,d,e){function g(c,d,e){function g(c,d){return Math.pow(c.x-d.x,2)+Math.pow(c.y-d.y,2)}var f=g(d,e);if(0==f)return g(c,d);f=((c.x-d.x)*(e.x-d.x)+(c.y-d.y)*(e.y-d.y))/f;f=Math.max(0,Math.min(1,f));return g(c,{x:d.x+f*(e.x-d.x),y:d.y+f*(e.y-d.y)})}function k(c,d,e){return 0<(e.x-d.x)*
(c.y-d.y)-(c.x-d.x)*(e.y-d.y)}if(d&&e){if(d[0].x<d[1].x){var h=d[0];d[0]=d[1];d[1]=h}e[0].x<e[1].x&&(h=e[0],e[0]=e[1],e[1]=h);if(d[0].y<e[1].y||d[1].y>e[0].y||d[0].x<e[1].x||d[1].x>e[0].x)return!1}d=Object.assign([],f);d.push(f[0]);for(e=0;e<c.length;e++){var n=Number.MAX_SAFE_INTEGER;var l=!1;for(h=0;h<d.length-1;h++){var m={x:d[h].x,y:d[h].y},p={x:d[h+1].x,y:d[h+1].y},r={x:c[e].x,y:c[e].y},t=g(r,m,p);if(0==t)return!0;n>t&&(n=t,l=k(r,m,p))}if(l)return!0}var v=Object.assign([],c);v.push(c[0]);for(e=
0;e<f.length;e++){n=Number.MAX_SAFE_INTEGER;l=!1;for(h=0;h<v.length-1;h++){m={x:v[h].x,y:v[h].y};p={x:v[h+1].x,y:v[h+1].y};r={x:c[e].x,y:c[e].y};t=g(r,m,p);if(0==t)return!0;n>t&&(n=t,l=k(r,m,p),testTemp=r,testTempA=m,testTempB=p)}if(l)return!0}for(h=0;h<v.length-1;h++)for(e=0;e<d.length-1;e++)if((c=this.intersectionOfTwoLineSegments(v,d))&&c.inSeg1&&c.inSeg2)return!0;return!1};this.normalizeStretchArray=function(c){var f=c.reduce(function(c,d,e,f){return d>f[c]?e:c},0),d=Math.abs(c[f]);c=c.map(function(c){return c/
d});if(0==c[0]&&1==c[c.length-1])return c;var e=0!=c[0]?c[0]:c[c.length-1];return c=c.map(function(c){return(c-e)/(1-e)})};this.curvePoint=new function(){this.linear=function(c,f,d){f=void 0===f?0:f;return(void 0===c?.5:c)*((void 0===d?1:d)-f)+f};this.sin=function(c,f,d){f=void 0===f?0:f;return Math.sin(Math.PI/2*(void 0===c?.5:c))*((void 0===d?1:d)-f)+f};this.cos=function(c,f,d){f=void 0===f?0:f;return(1-Math.cos(Math.PI/2*(void 0===c?.5:c)))*((void 0===d?1:d)-f)+f};this.s=function(c,f,d,e){f=void 0===
f?0:f;d=void 0===d?1:d;e=void 0===e?8:e;return __globals.utility.math.normalizeStretchArray([1/(1+Math.exp(-.5*-e)),1/(1+Math.exp(-e*((void 0===c?.5:c)-.5))),1/(1+Math.exp(.5*-e))])[1]*(d-f)+f};this.exponential=function(c,f,d,e){f=void 0===f?0:f;d=void 0===d?1:d;e=void 0===e?2:e;return __globals.utility.math.normalizeStretchArray([(Math.exp(0*e)-1)/(Math.E-1),(Math.exp(e*(void 0===c?.5:c))-1)/(Math.E-1),(Math.exp(1*e)-1)/(Math.E-1)])[1]*(d-f)+f}};this.curveGenerator=new function(){this.linear=function(c,
f,d){f=void 0===f?0:f;d=void 0===d?1:d;c=Math.abs(void 0===c?2:c)-1;for(var e=[0],g=1;g<c;g++)e.push(g/c);e.push(1);c=d-f;for(g=0;g<e.length;g++)e[g]=e[g]*c+f;return e};this.sin=function(c,f,d){f=void 0===f?0:f;d=void 0===d?1:d;c=Math.abs(void 0===c?2:c)-1;for(var e=[0],g=1;g<c;g++)e.push(Math.sin(Math.PI/2*(g/c)));e.push(1);c=d-f;for(g=0;g<e.length;g++)e[g]=e[g]*c+f;return e};this.cos=function(c,f,d){f=void 0===f?0:f;d=void 0===d?1:d;c=Math.abs(void 0===c?2:c)-1;for(var e=[0],g=1;g<c;g++)e.push(1-
Math.cos(Math.PI/2*(g/c)));e.push(1);c=d-f;for(g=0;g<e.length;g++)e[g]=e[g]*c+f;return e};this.s=function(c,f,d,e){c=void 0===c?2:c;f=void 0===f?0:f;d=void 0===d?1:d;e=void 0===e?8:e;0==e&&(e=1E-6);for(var g=[],k=0;k<c;k++)g.push(1/(1+Math.exp(-e*(k/c-.5))));c=__globals.utility.math.normalizeStretchArray(g);d-=f;for(k=0;k<c.length;k++)c[k]=c[k]*d+f;return c};this.exponential=function(c,f,d,e){f=void 0===f?0:f;d=void 0===d?1:d;e=void 0===e?2:e;c=(void 0===c?2:c)-1;for(var g=[],k=0;k<=c;k++)g.push((Math.exp(k/
c*e)-1)/(Math.E-1));g=__globals.utility.math.normalizeStretchArray(g);c=d-f;for(k=0;k<g.length;k++)g[k]=g[k]*c+f;return g}};this.relativeDistance=function(c,f,d,e,g){f=(e-f)/(d-f);if(void 0===g||!g){if(1<f)return c;if(0>f)return 0}return f*c};this.lineCorrecter=function(c,f,d){if(!(0>c.x1||0>c.x2||c.x1>d||c.x2>d||0>c.y1&&0>c.y2||c.y1>f&&c.y2>f))return d=(c.y2-c.y1)/(c.x2-c.x1),0>c.y1?(c.x1=(0-c.y1+d*c.x1)/d,c.y1=0):0>c.y2&&(c.x2=(0-c.y2+d*c.x2)/d,c.y2=0),c.y1>f?(c.x1=(f-c.y1+d*c.x1)/d,c.y1=f):c.y2>
f&&(c.x2=(f-c.y2+d*c.x2)/d,c.y2=f),c}};this.misc=new function(){this.padString=function(c,f,d){d=void 0===d?" ":d;if(1>d.length)return c;for(c=""+c;c.length<f;)c=d+c;return c};this.blendColours=function(c,f,d){function e(c){c=c.split(",");c[0]=c[0].replace("rgba(","");c[3]=c[3].replace(")","");return c.map(function(c){return parseFloat(c)})}c=e(c);f=e(f);for(var g=[],k=0;k<c.length;k++)g[k]=(1-d)*c[k]+d*f[k];return"rgba("+g[0]+","+g[1]+","+g[2]+","+g[3]+")"};this.multiBlendColours=function(c,f){if(0==
f)return c[0];if(1==f)return c[c.length-1];f*=c.length-1;return __globals.utility.misc.blendColours(c[~~f],c[~~f+1],f%1)};this.compressString=function(c){return __globals.utility.thirdparty.lzString.compress(c)};this.decompressString=function(c){return __globals.utility.thirdparty.lzString.decompress(c)};this.serialize=function(c,f){f=void 0===f?!0:f;c=JSON.stringify(c,function(c,e){switch({}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()){case "function":return{__uniqueType:"function",
__value:e.toString(),__name:e.name};case "arraybuffer":return{__uniqueType:"arraybuffer",__value:btoa(String.fromCharCode(new Uint8Array(e)))};case "audiobuffer":c=[];for(var d=0;d<e.numberOfChannels;d++)c.push(Array.from(e.getChannelData(d)));return{__uniqueType:"audiobuffer",__channelData:c,__sampleRate:e.sampleRate,__numberOfChannels:e.numberOfChannels,__length:e.length};default:return e}});f&&(c=__globals.utility.misc.compressString(c));return c};this.unserialize=function(c,f){if(void 0!==c)return(void 0===
f||f)&&(c=__globals.utility.misc.decompressString(c)),JSON.parse(c,function(c,e){if("object"==typeof e&&null!=e&&"__uniqueType"in e)switch(e.__uniqueType){case "function":c=e.__value.substring(0,e.__value.indexOf("{"));c=c.substring(c.indexOf("(")+1,c.lastIndexOf(")"));e=e.__value.substring(e.__value.indexOf("{")+1,e.__value.lastIndexOf("}"));e=Function(c,e);break;case "arraybuffer":e=atob(e.__value);for(c=0;c<e.length;c++)e[c]=e[c].charCodeAt(0);e=new ArrayBuffer(e);break;case "audiobuffer":var d=
__globals.audio.context.createBuffer(e.__numberOfChannels,e.__length,e.__sampleRate);for(c=0;c<d.numberOfChannels;c++){workingBuffer=d.getChannelData(c);for(var f=0;f<d.length;f++)workingBuffer[f]=e.__channelData[c][f]}e=d;break;default:e=e.__value}return e})};this.openFile=function(c,f){f=void 0===f?"readAsBinaryString":f;var d=document.createElement("input");d.type="file";d.onchange=function(){var d=new FileReader;switch(f){case "readAsArrayBuffer":d.readAsArrayBuffer(this.files[0]);break;default:d.readAsBinaryString(this.files[0])}d.onloadend=
function(){c&&c(d.result)}};d.click()};this.printFile=function(c,f){var d=document.createElement("a");d.href=URL.createObjectURL(new Blob([f]));d.download=c;d.click()};this.elementMaker=function(c,f,d){d.style||(d.style="");switch(c){case "g":return parts.elements.basic.g(f,d.x,d.y,d.r,d.style);case "line":return parts.elements.basic.line(f,d.x1,d.y1,d.x2,d.y2,d.style);case "rect":return parts.elements.basic.rect(f,d.x,d.y,d.width,d.height,d.angle,d.style);case "path":return parts.elements.basic.path(f,
d.path,d.lineType,d.style);case "text":return parts.elements.basic.text(f,d.x,d.y,d.text,d.angle,d.style);case "circle":return parts.elements.basic.circle(f,d.x,d.y,d.r,d.angle,d.style);case "canvas":return parts.elements.basic.canvas(f,d.x,d.y,d.width,d.height,d.angle,d.resolution)}""==d.style&&(d.style={});switch(c){default:return console.warn("Unknown element: "+c),null;case "label":return parts.elements.display.label(f,d.x,d.y,d.text,d.style,d.angle);case "level":return parts.elements.display.level(f,
d.x,d.y,d.angle,d.width,d.height,d.style.backing,d.style.level);case "meter_level":return parts.elements.display.meter_level(f,d.x,d.y,d.angle,d.width,d.height,d.markings,d.style.backing,d.style.levels,d.style.marking);case "audio_meter_level":return parts.elements.display.audio_meter_level(f,d.x,d.y,d.angle,d.width,d.height,d.markings,d.style.backing,d.style.levels,d.style.marking);case "sevenSegmentDisplay":return parts.elements.display.sevenSegmentDisplay(f,d.x,d.y,d.width,d.height,d.style.background,
d.style.glow,d.style.dim);case "sixteenSegmentDisplay":return parts.elements.display.sixteenSegmentDisplay(f,d.x,d.y,d.width,d.height,d.style.background,d.style.glow,d.style.dim);case "readout_sixteenSegmentDisplay":return parts.elements.display.readout_sixteenSegmentDisplay(f,d.x,d.y,d.width,d.height,d.count,d.style.background,d.style.glow,d.style.dime);case "rastorDisplay":return parts.elements.display.rastorDisplay(f,d.x,d.y,d.width,d.height,d.xCount,d.yCount,d.xGappage,d.yGappage);case "glowbox_rect":return parts.elements.display.glowbox_rect(f,
d.x,d.y,d.width,d.height,d.angle,d.style.glow,d.style.dim);case "grapherSVG":return parts.elements.display.grapherSVG(f,d.x,d.y,d.width,d.height,d.style.foreground,d.style.foregroundText,d.style.background,d.style.backgroundText,d.style.backing);case "grapherCanvas":return parts.elements.display.grapherCanvas(f,d.x,d.y,d.width,d.height,d.style.foreground,d.style.foregroundText,d.style.background,d.style.backgroundText,d.style.backing);case "grapher_periodicWave":return parts.elements.display.grapher_periodicWave(f,
d.x,d.y,d.width,d.height,d.graphType,d.style.foreground,d.style.foregroundText,d.style.background,d.style.backgroundText,d.style.backing);case "grapher_audioScope":return parts.elements.display.grapher_audioScope(f,d.x,d.y,d.width,d.height,d.graphType,d.style.foreground,d.style.foregroundText,d.style.background,d.style.backgroundText,d.style.backing);case "button_rect":return c=parts.elements.control.button_rect(f,d.x,d.y,d.width,d.height,d.angle,d.style.up,d.style.hover,d.style.down,d.style.glow),
c.onmouseup=d.onmouseup?d.onmouseup:c.onmouseup,c.onmousedown=d.onmousedown?d.onmousedown:c.onmousedown,c.onmouseenter=d.onmouseenter?d.onmouseenter:c.onmouseenter,c.onmouseleave=d.onmouseleave?d.onmouseleave:c.onmouseleave,c.onmousemove=d.onmousemove?d.onmousemove:c.onmousemove,c.onclick=d.onclick?d.onclick:c.onclick,c.ondblclick=d.ondblclick?d.ondblclick:c.ondblclick,c;case "checkbox_rect":return c=parts.elements.control.checkbox_rect(f,d.x,d.y,d.width,d.height,d.angle,d.style.check,d.style.backing,
d.style.checkGlow,d.style.backingGlow),c.onchange=d.onchange?d.onchange:c.onchange,c;case "key_rect":return c=parts.elements.control.key_rect(f,d.x,d.y,d.width,d.height,d.angle,d.style.off,d.style.press,d.style.glow,d.style.pressAndGlow),c.keyup=d.keyup?d.keyup:c.keyup,c.keydown=d.keydown?d.keydown:c.keydown,c;case "slide":return c=parts.elements.control.slide(f,d.x,d.y,d.width,d.height,d.angle,d.handleHeight,d.value,d.resetValue,d.style.handle,d.style.backing,d.style.slot,d.style.invisibleHandle),
c.onchange=d.onchange?d.onchange:c.onchange,c.onrelease=d.onrelease?d.onrelease:c.onrelease,c;case "slidePanel":return c=parts.elements.control.slidePanel(f,d.x,d.y,d.width,d.height,d.count,d.angle,d.handleHeight,d.value,d.resetValue,d.style.handle,d.style.backing,d.style.slot),c.onchange=d.onchange?d.onchange:c.onchange,c.onrelease=d.onrelease?d.onrelease:c.onrelease,c;case "rangeslide":return c=parts.elements.control.rangeslide(f,d.x,d.y,d.width,d.height,d.angle,d.handleHeight,d.spanWidth,d.values,
d.resetValues,d.style.handle,d.style.backing,d.style.slot,d.style.invisibleHandle,d.style.span),c.onchange=d.onchange?d.onchange:c.onchange,c.onrelease=d.onrelease?d.onrelease:c.onrelease,c;case "dial_continuous":return c=parts.elements.control.dial_continuous(f,d.x,d.y,d.r,d.startAngle,d.maxAngle,d.style.handle,d.style.slot,d.style.needle,d.style.handle_glow,d.style.slot_glow,d.style.needle_glow,d.arcDistance,d.style.outerArc,d.style.outerArc_glow),c.onchange=d.onchange?d.onchange:c.onchange,c.onrelease=
d.onrelease?d.onrelease:c.onrelease,c;case "dial_discrete":return c=parts.elements.control.dial_discrete(f,d.x,d.y,d.r,d.optionCount,d.startAngle,d.maxAngle,d.style.handle,d.style.slot,d.style.needle,d.style.handle_glow,d.style.slot_glow,d.style.needle_glow,d.arcDistance,d.style.outerArc,d.style.outerArc_glow),c.onchange=d.onchange?d.onchange:c.onchange,c.onrelease=d.onrelease?d.onrelease:c.onrelease,c;case "rastorgrid":return c=parts.elements.control.rastorgrid(f,d.x,d.y,d.width,d.height,d.xCount,
d.yCount,d.style.backing,d.style.check,d.style.backingGlow,d.style.checkGlow),c.onchange=d.onchange?d.onchange:c.onchange,c;case "sequencer":return c=parts.elements.control.sequencer(f,d.x,d.y,d.width,d.height,d.angle,d.xCount,d.yCount,d.zoomLevel_x,d.zoomLevel_y,d.style.backing,d.style.selectionArea,d.style.block_body,d.style.block_bodyGlow,d.style.block_handle,d.style.block_handleWidth,d.style.horizontalStrip_pattern,d.style.horizontalStrip_glow,d.style.horizontalStrip_styles,d.style.verticalStrip_pattern,
d.style.verticalStrip_glow,d.style.verticalStrip_styles,d.style.playhead),c.onpan=d.onpan?d.onpan:c.onpan,c.onchangeviewarea=d.onchangeviewarea?d.onchangeviewarea:c.onchangeviewarea,c.event=d.event?d.event:c.event,c;case "needleOverlay":return c=parts.elements.control.needleOverlay(f,d.x,d.y,d.width,d.height,d.angle,d.needleWidth,d.selectNeedle,d.selectionArea,d.needleStyles),c.onchange=d.onchange?d.onchange:c.onchange,c.onrelease=d.onrelease?d.onrelease:c.onrelease,c.selectionAreaToggle=d.selectionAreaToggle?
d.selectionAreaToggle:c.selectionAreaToggle,c;case "grapher_waveWorkspace":return c=parts.elements.control.grapher_waveWorkspace(f,d.x,d.y,d.width,d.height,d.angle,d.graphType,d.selectNeedle,d.selectionArea,d.style.foreground,d.style.foregroundText,d.style.middleground,d.style.middlegroundText,d.style.background,d.style.backgroundText),c.onchange=d.onchange?d.onchange:c.onchange,c.onrelease=d.onrelease?d.onrelease:c.onrelease,c.selectionAreaToggle=d.selectionAreaToggle?d.selectionAreaToggle:c.selectionAreaToggle,
c;case "cable":return parts.elements.dynamic.cable(f,d.x1,d.y1,d.x2,d.y2,d.style.unactive,d.style.active);case "connectionNode_audio":return parts.elements.dynamic.connectionNode_audio(f,d.type,d.x,d.y,d.width,d.height,d.angle,__globals.audio.context);case "connectionNode_data":return c=parts.elements.dynamic.connectionNode_data(f,d.x,d.y,d.width,d.height,d.angle),c.receive=d.receive?d.receive:c.receive,c.give=d.give?d.give:c.give,c}};this.objectBuilder=function(c,f){var d=__globals.utility.misc.elementMaker("g",
f.type,{x:f.x,y:f.y});void 0==f.base.type&&(f.base.type="path");switch(f.base.type){case "rect":f.base.points=[{x:f.x,y:f.y},{x:f.width,y:f.y},{x:f.width,y:f.height},{x:f.x,y:f.height}];__globals.utility.object.generateSelectionArea(f.base.points,d);f.base=__globals.utility.misc.elementMaker("rect",null,{x:f.base.x,y:f.base.y,width:f.base.width,height:f.base.height,angle:f.base.angle,style:f.base.style});break;case "circle":var e=2*Math.PI/12;f.base.points=[];for(var g=0;12>g;g++)f.base.points.push({x:f.base.x-
Math.sin(g*e)*f.base.r,y:f.base.y-Math.cos(g*e)*f.base.r});__globals.utility.object.generateSelectionArea(f.base.points,d);f.base=__globals.utility.misc.elementMaker("circle",null,{x:f.base.x,y:f.base.y,r:f.base.r,angle:f.base.angle,style:f.base.style});break;case "path":__globals.utility.object.generateSelectionArea(f.base.points,d);f.base=__globals.utility.misc.elementMaker("path",null,{path:f.base.points,lineType:"L",style:f.base.style});break;default:console.error("Unknown base type:",f.base.type,
'when creating object "'+f.type+'"');return}d.append(f.base);f.skipGrapple||__globals.mouseInteraction.declareObjectGrapple(f.base,d,c);if(f.elements)for(g=0;g<f.elements.length;g++)f[f.elements[g].type]||(f[f.elements[g].type]={}),f.elements[g].name in f[f.elements[g].type]?console.warn('error: element with the name "'+f.elements[g].name+'" already exists. Element:',f.elements[g],"will not be added"):(f[f.elements[g].type][f.elements[g].name]=__globals.utility.misc.elementMaker(f.elements[g].type,
f.elements[g].name,f.elements[g].data),d.append(f[f.elements[g].type][f.elements[g].name]));d.io={};if(f.connectionNode_audio)for(c=Object.keys(f.connectionNode_audio),g=0;g<c.length;g++)c[g]in d.io?console.warn('error: connection node with the name "'+c[g]+'" already exists in the .io group. Node ',f.connectionNode_data[c[g]]," will not be added"):d.io[c[g]]=f.connectionNode_audio[c[g]];if(f.connectionNode_data)for(c=Object.keys(f.connectionNode_data),g=0;g<c.length;g++)c[g]in d.io?console.warn('error: connection node with the name "'+
c[g]+'" already exists in the .io group. Node ',f.connectionNode_data[c[g]]," will not be added"):d.io[c[g]]=f.connectionNode_data[c[g]];return d}};this.thirdparty=new function(){this.lzString=function(){var c=String.fromCharCode,f={},d={compress:function(c){return null==c?"":d._compress(c,6,function(c){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(c)})},decompress:function(c){if(null==c)return"";if(""==c)return null;c=c.replace(/ /g,"+");return d._decompress(c.length,
32,function(d){d=c.charAt(d);if(!f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]){f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]={};for(var e=0;65>e;e++)f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(e)]=e}return f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"][d]})},_compress:function(c,d,f){if(null==c)return"";var e,g={},k={},m="",
p=2,r=3,t=2,v=[],u=0,w=0,q;for(q=0;q<c.length;q+=1){var y=c.charAt(q);Object.prototype.hasOwnProperty.call(g,y)||(g[y]=r++,k[y]=!0);var z=m+y;if(Object.prototype.hasOwnProperty.call(g,z))m=z;else{if(Object.prototype.hasOwnProperty.call(k,m)){if(256>m.charCodeAt(0)){for(e=0;e<t;e++)u<<=1,w==d-1?(w=0,v.push(f(u)),u=0):w++;var x=m.charCodeAt(0);for(e=0;8>e;e++)u=u<<1|x&1,w==d-1?(w=0,v.push(f(u)),u=0):w++,x>>=1}else{x=1;for(e=0;e<t;e++)u=u<<1|x,w==d-1?(w=0,v.push(f(u)),u=0):w++,x=0;x=m.charCodeAt(0);
for(e=0;16>e;e++)u=u<<1|x&1,w==d-1?(w=0,v.push(f(u)),u=0):w++,x>>=1}p--;0==p&&(p=Math.pow(2,t),t++);delete k[m]}else for(x=g[m],e=0;e<t;e++)u=u<<1|x&1,w==d-1?(w=0,v.push(f(u)),u=0):w++,x>>=1;p--;0==p&&(p=Math.pow(2,t),t++);g[z]=r++;m=String(y)}}if(""!==m){if(Object.prototype.hasOwnProperty.call(k,m)){if(256>m.charCodeAt(0)){for(e=0;e<t;e++)u<<=1,w==d-1?(w=0,v.push(f(u)),u=0):w++;x=m.charCodeAt(0);for(e=0;8>e;e++)u=u<<1|x&1,w==d-1?(w=0,v.push(f(u)),u=0):w++,x>>=1}else{x=1;for(e=0;e<t;e++)u=u<<1|x,
w==d-1?(w=0,v.push(f(u)),u=0):w++,x=0;x=m.charCodeAt(0);for(e=0;16>e;e++)u=u<<1|x&1,w==d-1?(w=0,v.push(f(u)),u=0):w++,x>>=1}p--;0==p&&(p=Math.pow(2,t),t++);delete k[m]}else for(x=g[m],e=0;e<t;e++)u=u<<1|x&1,w==d-1?(w=0,v.push(f(u)),u=0):w++,x>>=1;p--;0==p&&t++}x=2;for(e=0;e<t;e++)u=u<<1|x&1,w==d-1?(w=0,v.push(f(u)),u=0):w++,x>>=1;for(;;)if(u<<=1,w==d-1){v.push(f(u));break}else w++;return v.join("")},_decompress:function(d,g,f){var e=[],k=4,l=4,m=3,p=[],r,t,v=f(0),u=g,w=1;for(r=0;3>r;r+=1)e[r]=r;var q=
0;var y=Math.pow(2,2);for(t=1;t!=y;){var z=v&u;u>>=1;0==u&&(u=g,v=f(w++));q|=(0<z?1:0)*t;t<<=1}switch(q){case 0:q=0;y=Math.pow(2,8);for(t=1;t!=y;)z=v&u,u>>=1,0==u&&(u=g,v=f(w++)),q|=(0<z?1:0)*t,t<<=1;var x=c(q);break;case 1:q=0;y=Math.pow(2,16);for(t=1;t!=y;)z=v&u,u>>=1,0==u&&(u=g,v=f(w++)),q|=(0<z?1:0)*t,t<<=1;x=c(q);break;case 2:return""}r=e[3]=x;for(p.push(x);;){if(w>d)return"";q=0;y=Math.pow(2,m);for(t=1;t!=y;)z=v&u,u>>=1,0==u&&(u=g,v=f(w++)),q|=(0<z?1:0)*t,t<<=1;switch(x=q){case 0:q=0;y=Math.pow(2,
8);for(t=1;t!=y;)z=v&u,u>>=1,0==u&&(u=g,v=f(w++)),q|=(0<z?1:0)*t,t<<=1;e[l++]=c(q);x=l-1;k--;break;case 1:q=0;y=Math.pow(2,16);for(t=1;t!=y;)z=v&u,u>>=1,0==u&&(u=g,v=f(w++)),q|=(0<z?1:0)*t,t<<=1;e[l++]=c(q);x=l-1;k--;break;case 2:return p.join("")}0==k&&(k=Math.pow(2,m),m++);if(e[x])x=e[x];else if(x===l)x=r+r.charAt(0);else return null;p.push(x);e[l++]=r+x.charAt(0);k--;r=x;0==k&&(k=Math.pow(2,m),m++)}}};return d}()};this.experimental=new function(){}};__globals.panes={global:null,staticBackground:null,
background:null,middleground:null,foreground:null,menu:null};if(__globals.svgElement.children){for(var a=0;a<__globals.svgElement.children.length;a++)if(__globals.svgElement.children[a].hasAttribute("pane"))switch(__globals.svgElement.children[a].getAttribute("pane")){case "global":__globals.panes.workspace=__globals.svgElement.children[a];break;case "staticBackground":__globals.panes.staticBackground=__globals.svgElement.children[a];break;case "background":__globals.panes.background=__globals.svgElement.children[a];
break;case "middleground":__globals.panes.middleground=__globals.svgElement.children[a];break;case "foreground":__globals.panes.foreground=__globals.svgElement.children[a];break;case "menu":__globals.panes.menu=__globals.svgElement.children[a]}null==__globals.panes.workspace&&(__globals.panes.workspace=document.createElementNS("http://www.w3.org/2000/svg","g"),__globals.panes.workspace.setAttribute("pane","workspace"));null==__globals.panes.staticBackground&&(__globals.panes.staticBackground=document.createElementNS("http://www.w3.org/2000/svg",
"g"),__globals.panes.staticBackground.setAttribute("pane","staticBackground"));null==__globals.panes.background&&(__globals.panes.background=document.createElementNS("http://www.w3.org/2000/svg","g"),__globals.panes.background.setAttribute("pane","background"));null==__globals.panes.middleground&&(__globals.panes.middleground=document.createElementNS("http://www.w3.org/2000/svg","g"),__globals.panes.middleground.setAttribute("pane","middleground"));null==__globals.panes.foreground&&(__globals.panes.foreground=
document.createElementNS("http://www.w3.org/2000/svg","g"),__globals.panes.foreground.setAttribute("pane","foreground"));null==__globals.panes.menu&&(__globals.panes.menu=document.createElementNS("http://www.w3.org/2000/svg","g"),__globals.panes.menu.setAttribute("pane","menu"))}__globals.utility.element.makeUnselectable(__globals.panes.staticBackground);__globals.utility.element.makeUnselectable(__globals.panes.background);__globals.utility.element.makeUnselectable(__globals.panes.middleground);
__globals.utility.element.makeUnselectable(__globals.panes.foreground);__globals.panes.staticBackground.style.transform||(__globals.panes.staticBackground.style.transform="translate(0px,0px) scale(1) rotate(0rad)");__globals.panes.staticBackground.setAttribute("global",!0);__globals.panes.workspace.style.transform||(__globals.panes.workspace.style.transform="translate(0px,0px) scale(1) rotate(0rad)");__globals.panes.workspace.setAttribute("global",!0);__globals.panes.menu.style.transform||(__globals.panes.menu.style.transform=
"translate(0px,0px) scale(1) rotate(0rad)");__globals.panes.menu.setAttribute("global",!0);__globals.svgElement.innerHTML="";__globals.svgElement.append(__globals.panes.staticBackground);__globals.svgElement.append(__globals.panes.workspace);__globals.panes.workspace.append(__globals.panes.background);__globals.panes.workspace.append(__globals.panes.middleground);__globals.panes.workspace.append(__globals.panes.foreground);__globals.svgElement.append(__globals.panes.menu);__globals.svgElement.onmouseover=
function(c){document.body.style.overflow="hidden"};__globals.svgElement.onmouseout=function(c){document.body.style.overflow=""};__globals.selection=new function(){this.selectedObjects=[];this.lastSelectedObject=null;this.clipboard=[];this.deselectEverything=function(c){c=void 0===c?[]:c;for(var f=[],d=0;d<__globals.selection.selectedObjects.length;d++)if(c.includes(__globals.selection.selectedObjects[d]))f.push(__globals.selection.selectedObjects[d]);else if(__globals.selection.selectedObjects[d].onDeselect)__globals.selection.selectedObjects[d].onDeselect();
__globals.selection.selectedObjects=f};this.selectObject=function(c){if(c.onSelect)c.onSelect();__globals.selection.selectedObjects.push(c);__globals.selection.lastSelectedObject=c};this.deselectObject=function(c){__globals.selection.selectedObjects.splice(__globals.selection.selectedObjects.indexOf(c),1);if(c.onDeselect)c.onDeselect()};this.cut=function(){this.copy();this.delete()};this.copy=function(){this.clipboard=[];for(var c=0;c<this.selectedObjects.length;c++){var f=[];f.push(__globals.utility.workspace.getPane(this.selectedObjects[c]));
if(this.selectedObjects[c].creatorMethod){f.push(this.selectedObjects[c].creatorMethod);f.push(__globals.utility.element.getTransform(this.selectedObjects[c]));this.selectedObjects[c].exportData?f.push(this.selectedObjects[c].exportData()):f.push(null);if(this.selectedObjects[c].io){for(var d=[],e=Object.keys(this.selectedObjects[c].io),g=0;g<e.length;g++){var k=[];k.push(e[g]);if(this.selectedObjects[c].io[e[g]].foreignNode){for(var h=Object.keys(this.selectedObjects[c].io[e[g]].foreignNode.parentElement.io),
n=0;n<h.length;n++)if(this.selectedObjects[c].io[e[g]].foreignNode.parentElement.io[h[n]]===this.selectedObjects[c].io[e[g]].foreignNode){k.push(h[n]);k.push(this.selectedObjects.indexOf(this.selectedObjects[c].io[e[g]].foreignNode.parentElement));break}0<=k[2]&&d.push(k)}}f.push(d)}this.clipboard.push(f)}else __globals.selection.deselectObject(this.selectedObjects[c]),c--}};this.paste=function(c){c=void 0===c?null:c;if(0!=this.clipboard.length){this.deselectEverything();if("duplicate"!=c){var f=
[];this.clipboard.forEach(function(c){return f.push(c[2])});var d=__globals.utility.math.boundingBoxFromPoints(f)[0];c||(c=__globals.utility.workspace.pointConverter.browser2workspace(__globals.mouseInteraction.currentPosition[0],__globals.mouseInteraction.currentPosition[1]));this.clipboard.forEach(function(e){e[2].x+=c.x-d.x;e[2].y+=c.y-d.y})}this.clipboard.forEach(function(c){var d=c[1](c[2].x,c[2].y);d.importData&&d.importData(c[3]);c[0].appendChild(d);__globals.selection.selectObject(d);c[4]&&
c[4].forEach(function(c){c[2]<__globals.selection.selectedObjects.length&&d.io[c[0]].connectTo(__globals.selection.selectedObjects[c[2]].io[c[1]])})})}};this.duplicate=function(){this.copy();this.paste("duplicate");this.clipboard=[]};this.delete=function(){for(;0<this.selectedObjects.length;){if(this.selectedObjects[0].onDelete)this.selectedObjects[0].onDelete();for(var c=Object.keys(this.selectedObjects[0].io),f=0;f<c.length;f++)if(Array.isArray(this.selectedObjects[0].io[c[f]]))for(var d=0;d<this.selectedObjects[0].io[c[f]].length;d++)this.selectedObjects[0].io[c[f]][d].disconnect();
else this.selectedObjects[0].io[c[f]].disconnect();__globals.utility.workspace.getPane(this.selectedObjects[0]).removeChild(this.selectedObjects[0]);this.selectedObjects.shift()}this.lastSelectedObject=null}};__globals.mouseInteraction={};__globals.mouseInteraction.currentPosition=[];__globals.mouseInteraction.wheelInterpreter=function(c){return c/100};__globals.mouseInteraction.objectGrapple_functionList={};__globals.mouseInteraction.objectGrapple_functionList.onmousedown=[];__globals.mouseInteraction.objectGrapple_functionList.onmouseup=
[];__globals.mouseInteraction.declareObjectGrapple=function(c,f,d){d?(c.target=f?f:c,c.target.creatorMethod=d,c.target.grapple=c,c.target.style.transform=c.target.style.transform?c.target.style.transform:"translate(0px,0px) scale(1) rotate(0rad)",c.onmousedown=function(c){if(0==c.button){__globals.svgElement.temp_onmousedown_originalObject=this.target;for(var d=0;d<__globals.mouseInteraction.objectGrapple_functionList.onmousedown.length;d++){for(var e=!0,f=0;f<__globals.mouseInteraction.objectGrapple_functionList.onmousedown[d].specialKeys.length&&
(e=e&&c[__globals.mouseInteraction.objectGrapple_functionList.onmousedown[d].specialKeys[f]],e);f++);if(e){__globals.mouseInteraction.objectGrapple_functionList.onmousedown[d].function(c);break}}}},c.onmouseup=function(c){__globals.svgElement.temp_onmouseup_originalObject=this.target;for(var d=0;d<__globals.mouseInteraction.objectGrapple_functionList.onmouseup.length;d++){for(var e=!0,f=0;f<__globals.mouseInteraction.objectGrapple_functionList.onmouseup[d].specialKeys.length&&(e=e&&c[__globals.mouseInteraction.objectGrapple_functionList.onmouseup[d].specialKeys[f]],
e);f++);if(e){__globals.mouseInteraction.objectGrapple_functionList.onmouseup[d].function(c);break}}}):console.error('"declareObjectGrapple" requires a creatorMethod')};__globals.mouseInteraction.objectGrapple_functionList.onmousedown.push({specialKeys:[__globals.super.keys.alt],"function":function(c){__globals.super.readOnlyMode||(__globals.selection.selectedObjects.includes(__globals.svgElement.temp_onmousedown_originalObject)||__globals.selection.selectObject(__globals.svgElement.temp_onmousedown_originalObject),
__globals.selection.duplicate(),__globals.selection.selectedObjects[0].grapple.onmousedown({x:c.x,y:c.y,button:0}))}});__globals.mouseInteraction.objectGrapple_functionList.onmousedown.push({specialKeys:[],"function":function(c){if(!__globals.super.readOnlyMode){__globals.selection.selectedObjects.includes(__globals.svgElement.temp_onmousedown_originalObject)||(c.shiftKey||__globals.selection.deselectEverything(),__globals.selection.selectObject(__globals.svgElement.temp_onmousedown_originalObject));
__globals.svgElement.temp_oldClickPosition=[c.x,c.y];__globals.svgElement.temp_oldObjectPositions=[];for(var f=0;f<__globals.selection.selectedObjects.length;f++)__globals.svgElement.temp_oldObjectPositions.push(__globals.utility.element.getTransform(__globals.selection.selectedObjects[f]));__globals.svgElement.onmousemove_old=__globals.svgElement.onmousemove;__globals.svgElement.onmousemove=function(c){for(var d=0;d<__globals.selection.selectedObjects.length;d++){var g=__globals.svgElement.temp_oldClickPosition,
f={};f.x=__globals.svgElement.temp_oldObjectPositions[d].x;f.y=__globals.svgElement.temp_oldObjectPositions[d].y;f.s=__globals.svgElement.temp_oldObjectPositions[d].s;f.r=__globals.svgElement.temp_oldObjectPositions[d].r;var h=__globals.utility.workspace.getGlobalScale(__globals.selection.selectedObjects[d]);f.x-=(g[0]-c.x)/h;f.y-=(g[1]-c.y)/h;__globals.utility.element.setTransform(__globals.selection.selectedObjects[d],f);if(__globals.selection.selectedObjects[d].onMove)__globals.selection.selectedObjects[d].onMove();
__globals.selection.selectedObjects[d].updateSelectionArea&&__globals.selection.selectedObjects[d].updateSelectionArea();if(__globals.selection.selectedObjects[d].io)for(g=Object.keys(__globals.selection.selectedObjects[d].io),f=0;f<g.length;f++)if(Array.isArray(__globals.selection.selectedObjects[d].io[g[f]]))for(h=0;h<__globals.selection.selectedObjects[d].io[g[f]].length;h++)__globals.selection.selectedObjects[d].io[g[f]][h].redraw();else __globals.selection.selectedObjects[d].io[g[f]].redraw()}};
__globals.svgElement.onmouseup=function(){this.onmousemove=null;delete __globals.svgElement.tempElements;this.onmousemove=__globals.svgElement.onmousemove_old;delete this.temp_onmousedown_originalObject;delete this.temp_oldClickPosition;delete this.temp_oldObjectPositions;delete this.onmouseleave;delete this.onmouseup};__globals.svgElement.onmouseleave=__globals.svgElement.onmouseup;__globals.svgElement.onmousemove(c)}}});__globals.mouseInteraction.objectGrapple_functionList.onmouseup.push({specialKeys:[],
"function":function(c){__globals.selection.selectedObjects.includes(__globals.svgElement.temp_onmouseup_originalObject)&&(c.shiftKey&&__globals.selection.lastSelectedObject!=__globals.svgElement.temp_onmouseup_originalObject&&__globals.selection.deselectObject(__globals.svgElement.temp_onmouseup_originalObject),__globals.selection.lastSelectedObject=null)}});__globals.mouseInteraction.onmousemove_functionList=[];__globals.svgElement.onmousemove=function(c){if(__globals.utility.object.requestInteraction(c.x,
c.y,"onmousemove","workspace"))for(var f=0;f<__globals.mouseInteraction.onmousemove_functionList.length;f++){for(var d=!0,e=0;e<__globals.mouseInteraction.onmousemove_functionList[f].specialKeys.length&&(d=d&&c[__globals.mouseInteraction.onmousemove_functionList[f].specialKeys[e]],d);e++);if(d){__globals.mouseInteraction.onmousemove_functionList[f].function(c);break}}};__globals.mouseInteraction.onmousemove_functionList.push({specialKeys:[],"function":function(c){__globals.mouseInteraction.currentPosition=
[c.x,c.y]}});__globals.mouseInteraction.onmousedown_functionList=[];__globals.svgElement.onmousedown=function(c){if(__globals.utility.object.requestInteraction(c.x,c.y,"onmousedown","workspace")&&0==c.button)for(var f=0;f<__globals.mouseInteraction.onmousedown_functionList.length;f++){for(var d=!0,e=0;e<__globals.mouseInteraction.onmousedown_functionList[f].specialKeys.length&&(d=d&&c[__globals.mouseInteraction.onmousedown_functionList[f].specialKeys[e]],d);e++);if(d){__globals.mouseInteraction.onmousedown_functionList[f].function(c,
__globals.panes.workspace);break}}};__globals.mouseInteraction.onmousedown_functionList.push({specialKeys:["shiftKey"],"function":function(c,f){__globals.svgElement.tempData={};__globals.svgElement.tempElements=[];__globals.svgElement.tempData.start={x:c.x,y:c.y};__globals.svgElement.tempElements.push(__globals.utility.misc.elementMaker("path",null,{path:[__globals.svgElement.tempData.start,__globals.svgElement.tempData.start,__globals.svgElement.tempData.start,__globals.svgElement.tempData.start],
type:"L",style:"fill:rgba(120,120,255,0.25)"}));for(var d=0;d<__globals.svgElement.tempElements.length;d++)__globals.panes.menu.append(__globals.svgElement.tempElements[d]);__globals.svgElement.onmousemove_old=__globals.svgElement.onmousemove;__globals.svgElement.onmousemove=function(c){__globals.svgElement.tempData.end={x:c.x,y:c.y};__globals.svgElement.tempElements[0].path([{x:__globals.svgElement.tempData.start.x,y:__globals.svgElement.tempData.start.y},{x:__globals.svgElement.tempData.end.x,y:__globals.svgElement.tempData.start.y},
{x:__globals.svgElement.tempData.end.x,y:__globals.svgElement.tempData.end.y},{x:__globals.svgElement.tempData.start.x,y:__globals.svgElement.tempData.end.y}])};__globals.svgElement.onmouseup=function(){__globals.selection.deselectEverything();var c=__globals.utility.workspace.pointConverter.browser2workspace(__globals.svgElement.tempData.start.x,__globals.svgElement.tempData.start.y),d=__globals.utility.workspace.pointConverter.browser2workspace(__globals.svgElement.tempData.end.x,__globals.svgElement.tempData.end.y);
var k=[{},{}];c.x>d.x?(k[0].x=c.x,k[1].x=d.x):(k[0].x=d.x,k[1].x=c.x);c.y>d.y?(k[0].y=c.y,k[1].y=d.y):(k[0].y=d.y,k[1].y=c.y);c=Math.sign(c.x-d.x)!=Math.sign(c.y-d.y)?[c,{x:c.x,y:d.y},d,{x:d.x,y:c.y}]:[c,{x:d.x,y:c.y},d,{x:c.x,y:d.y}];d=__globals.panes.middleground.children;for(var h=0;h<d.length;h++)d[h].selectionArea&&__globals.utility.math.detectOverlap(c,d[h].selectionArea.points,k,d[h].selectionArea.box)&&__globals.selection.selectObject(d[h]);delete __globals.svgElement.tempData;for(h=0;h<__globals.svgElement.tempElements.length;h++)__globals.panes.menu.removeChild(__globals.svgElement.tempElements[h]),
__globals.svgElement.tempElements[h]=null;delete __globals.svgElement.tempElements;this.onmousemove=__globals.svgElement.onmousemove_old;delete __globals.svgElement.onmousemove_old;this.onmouseleave=null;f.removeAttribute("oldPosition");f.removeAttribute("clickPosition");this.onmouseup=this.onmouseleave=null};__globals.svgElement.onmouseleave=__globals.svgElement.onmouseup;__globals.svgElement.onmousemove(c)}});__globals.mouseInteraction.onmousedown_functionList.push({specialKeys:[],"function":function(c,
f){__globals.super.mouseGripPanningEnabled&&(__globals.selection.deselectEverything(),__globals.svgElement.temp_oldPosition=__globals.utility.element.getTransform(f),__globals.panes.workspace.setAttribute("clickPosition","["+c.x+","+c.y+"]"),__globals.svgElement.onmousemove_old=__globals.svgElement.onmousemove,__globals.svgElement.onmousemove=function(c){var d={};d.x=__globals.svgElement.temp_oldPosition.x;d.y=__globals.svgElement.temp_oldPosition.y;d.s=__globals.svgElement.temp_oldPosition.s;d.r=
__globals.svgElement.temp_oldPosition.r;var g=JSON.parse(f.getAttribute("clickPosition"));d.x-=g[0]-c.x;d.y-=g[1]-c.y;__globals.utility.element.setTransform(f,d)},__globals.svgElement.onmouseup=function(){this.onmousemove=__globals.svgElement.onmousemove_old;delete __globals.svgElement.onmousemove_old;f.removeAttribute("oldPosition");f.removeAttribute("clickPosition");this.onmouseup=this.onmouseleave=null},__globals.svgElement.onmouseleave=__globals.svgElement.onmouseup,__globals.svgElement.onmousemove(c))}});
__globals.mouseInteraction.onwheel_functionList=[];__globals.svgElement.onwheel=function(c){if(__globals.utility.object.requestInteraction(c.x,c.y,"onwheel","workspace"))for(var f=0;f<__globals.mouseInteraction.onwheel_functionList.length;f++){for(var d=!0,e=0;e<__globals.mouseInteraction.onwheel_functionList[f].specialKeys.length&&(d=d&&c[__globals.mouseInteraction.onwheel_functionList[f].specialKeys[e]],d);e++);if(d){__globals.mouseInteraction.onwheel_functionList[f].function(c);break}}};__globals.mouseInteraction.onwheel_functionList.push({specialKeys:[],
"function":function(c){if(__globals.super.mouseWheelZoomEnabled){var f=__globals.utility.element.getTransform(__globals.panes.workspace),d=(c.x-f.x)/f.s,e=(c.y-f.y)/f.s,g=f.s*(d+f.x/f.s),k=f.s*(e+f.y/f.s);f.s-=f.s*__globals.mouseInteraction.wheelInterpreter(c.deltaY);10<f.s&&(f.s=10);.1>f.s&&(f.s=.1);c=f.s*(e+f.y/f.s);f.x-=f.s*(d+f.x/f.s)-g;f.y-=c-k;__globals.utility.element.setTransform(__globals.panes.workspace,f)}}});__globals.keyboardInteraction={};__globals.keyboardInteraction.pressedKeys={};
__globals.keyboardInteraction.declareKeycaptureObject=function(c,f){function d(c,d){if(!e[c])return!1;modifiers={shift:d.shiftKey,control:d[__globals.super.keys.ctrl],meta:d.metaKey,alt:d[__globals.super.keys.alt]};return d.control&&f.control&&("all"==f.control||Array.isArray(f.control)&&f.control.includes(d.key))||d.shiftKey&&f.shift&&("all"==f.shift||Array.isArray(f.shift)&&f.shift.includes(d.key))||d.metaKey&&f.meta&&("all"==f.meta||Array.isArray(f.meta)&&f.meta.includes(d.key))||d.alt&&f.alt&&
("all"==f.alt||Array.isArray(f.alt)&&f.alt.includes(d.key))||f.none&&("all"==f.none||Array.isArray(f.none)&&f.none.includes(d.key))?(e[c](d.key,modifiers),!0):!1}f=void 0===f?{none:[],shift:[],control:[],meta:[],alt:[]}:f;var e=new function(){this.keyPress=function(c,d){};this.keyRelease=function(c,d){}};c.onkeydown=function(c){return d("keyPress",c)};c.onkeyup=function(c){return d("keyRelease",c)};return e};__globals.keyboardInteraction.onkeydown_functionList={};document.onkeydown=function(c){if(!__globals.keyboardInteraction.pressedKeys[c.code]){__globals.keyboardInteraction.pressedKeys[c.code]=
!0;var f=[__globals.mouseInteraction.currentPosition[0],__globals.mouseInteraction.currentPosition[1]];if(!__globals.utility.object.requestInteraction(f[0],f[1],"onkeydown","workspace"))if(void 0!=__globals.utility.workspace.objectUnderPoint(f[0],f[1]).onkeydown){if(__globals.utility.workspace.objectUnderPoint(f[0],f[1]).onkeydown(c))return}else for(f=document.elementFromPoint(f[0],f[1]);!f.hasAttribute("pane");){if(void 0!=f.onkeydown&&f.onkeydown(c))return;f=f.parentElement}if(__globals.keyboardInteraction.onkeydown_functionList[c.key])__globals.keyboardInteraction.onkeydown_functionList[c.key](c)}};
__globals.keyboardInteraction.onkeydown_functionList.Delete=function(c){console.log("delete!");__globals.selection.delete()};__globals.keyboardInteraction.onkeydown_functionList.Backspace=function(c){console.log("backspace!");__globals.keyboardInteraction.onkeydown_functionList.Delete(c)};__globals.keyboardInteraction.onkeydown_functionList.x=function(c){c[__globals.super.keys.ctrl]&&(console.log("cut!"),__globals.selection.cut())};__globals.keyboardInteraction.onkeydown_functionList.c=function(c){c[__globals.super.keys.ctrl]&&
(console.log("copy!"),__globals.selection.copy())};__globals.keyboardInteraction.onkeydown_functionList.b=function(c){c[__globals.super.keys.ctrl]&&(console.log("duplicate!"),__globals.selection.duplicate())};__globals.keyboardInteraction.onkeydown_functionList.v=function(c){c[__globals.super.keys.ctrl]&&(console.log("paste!"),__globals.selection.paste())};__globals.keyboardInteraction.onkeydown_functionList.F1=function(c){c[__globals.super.keys.ctrl]&&(console.log("help!"),(c=__globals.utility.workspace.objectUnderPoint(__globals.mouseInteraction.currentPosition[0],
__globals.mouseInteraction.currentPosition[1]))&&window.open(__globals.super.helpFolderLocation+"object/"+c.id,"_blank"))};__globals.keyboardInteraction.onkeydown_functionList.F2=function(c){c[__globals.super.keys.ctrl]&&(console.log("save!"),__globals.super.enableSaveload&&__globals.utility.workspace.saveload.save())};__globals.keyboardInteraction.onkeydown_functionList.F3=function(c){c[__globals.super.keys.ctrl]&&(console.log("load!"),__globals.super.enableSaveload&&__globals.utility.workspace.saveload.load())};
__globals.keyboardInteraction.onkeyup_functionList={};document.onkeyup=function(c){if(__globals.keyboardInteraction.pressedKeys[c.code]){delete __globals.keyboardInteraction.pressedKeys[c.code];var f=[__globals.mouseInteraction.currentPosition[0],__globals.mouseInteraction.currentPosition[1]];if(!__globals.utility.object.requestInteraction(f[0],f[1],"onkeyup","workspace"))if(void 0!=__globals.utility.workspace.objectUnderPoint(f[0],f[1]).onkeyup){if(__globals.utility.workspace.objectUnderPoint(f[0],
f[1]).onkeyup(c))return}else for(f=document.elementFromPoint(f[0],f[1]);!f.hasAttribute("pane");){if(void 0!=f.onkeyup&&f.onkeyup(c))return;f=f.parentElement}if(__globals.keyboardInteraction.onkeyup_functionList[c.key])__globals.keyboardInteraction.onkeyup_functionList[c.key](c)}};__globals.audio={};__globals.audio.context=new (window.AudioContext||window.webkitAudioContext);__globals.audio.destination=__globals.audio.context.createGain();__globals.audio.destination.connect(__globals.audio.context.destination);
__globals.audio.destination._gain=1;__globals.audio.destination.masterGain=function(c){if(void 0==c)return __globals.audio.destination._gain;__globals.audio.destination._gain=c;__globals.utility.audio.changeAudioParam(__globals.audio.context,__globals.audio.destination.gain,__globals.audio.destination._gain,.01,"instant",!0)};__globals.audio.destination.masterGain(1);__globals.audio.names_frequencies_split={0:{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,
"A#":29.14,B:30.87},1:{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},2:{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.8,A:110,"A#":116.5,B:123.5},3:{C:130.8,"C#":138.6,D:146.8,"D#":155.6,E:164.8,F:174.6,"F#":185,G:196,"G#":207.7,A:220,"A#":233.1,B:246.9},4:{C:261.6,"C#":277.2,D:293.7,"D#":311.1,E:329.6,F:349.2,"F#":370,G:392,"G#":415.3,A:440,"A#":466.2,B:493.9},5:{C:523.3,"C#":554.4,D:587.3,"D#":622.3,E:659.3,
F:698.5,"F#":740,G:784,"G#":830.6,A:880,"A#":932.3,B:987.8},6:{C:1047,"C#":1109,D:1175,"D#":1245,E:1319,F:1397,"F#":1480,G:1568,"G#":1661,A:1760,"A#":1865,B:1976},7:{C:2093,"C#":2217,D:2349,"D#":2489,E:2637,F:2794,"F#":2960,G:3136,"G#":3322,A:3520,"A#":3729,B:3951},8:{C:4186,"C#":4435,D:4699,"D#":4978,E:5274,F:5588,"F#":5920,G:6272,"G#":6645,A:7040,"A#":7459,B:7902}};__globals.audio.names_frequencies={};var octaves=Object.entries(__globals.audio.names_frequencies_split);for(a=0;a<octaves.length;a++)for(var names=
Object.entries(__globals.audio.names_frequencies_split[a]),b=0;b<names.length;b++)__globals.audio.names_frequencies[octaves[a][0]+names[b][0]]=names[b][1];__globals.audio.frequencies_names={};var temp=Object.entries(__globals.audio.names_frequencies);for(a=0;a<temp.length;a++)__globals.audio.frequencies_names[temp[a][1]]=temp[a][0];__globals.audio.getFreq=function(c){return __globals.audio.names_frequencies[c]};__globals.audio.getName=function(c){return __globals.audio.frequencies_names[c]};temp=
"0C 0C# 0D 0D# 0E 0F 0F# 0G 0G# 0A 0A# 0B 1C 1C# 1D 1D# 1E 1F 1F# 1G 1G# 1A 1A# 1B 2C 2C# 2D 2D# 2E 2F 2F# 2G 2G# 2A 2A# 2B 3C 3C# 3D 3D# 3E 3F 3F# 3G 3G# 3A 3A# 3B 4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C 7C# 7D 7D# 7E 7F 7F# 7G 7G# 7A 7A# 7B 8C 8C# 8D 8D# 8E 8F 8F# 8G 8G# 8A 8A# 8B".split(" ");__globals.audio.midinumbers_names={};for(a=0;a<temp.length;a++)__globals.audio.midinumbers_names[a+24]=temp[a];__globals.audio.names_midinumbers=
{};temp=Object.entries(__globals.audio.midinumbers_names);for(a=0;a<temp.length;a++)__globals.audio.names_midinumbers[temp[a][1]]=parseInt(temp[a][0]);__globals.audio.num2name=function(c){return __globals.audio.midinumbers_names[c]};__globals.audio.num2freq=function(c){return __globals.audio.names_frequencies[__globals.audio.midinumbers_names[c]]};__globals.audio.name2num=function(c){return __globals.audio.names_midinumbers[c]};__globals.audio.name2freq=function(c){return __globals.audio.names_frequencies[c]};
__globals.audio.freq2num=function(c){return __globals.audio.names_midinumbers[__globals.audio.frequencies_names[c]]};__globals.audio.freq2name=function(c){return __globals.audio.frequencies_names[c]};var parts=new function(){this.circuits=new function(){this.audio=new function(){this.audio2percentage=function(){return new function(){var c=null,f=null;var d=__globals.audio.context.createAnalyser();d.fftSize=128;c=new Uint8Array(d.fftSize);new Uint8Array(d.fftSize);this.__render=function(){d.getByteTimeDomainData(c);
for(var e=[],f=0;f<c.length;f++)e.push(c[f]/128-1);var k=0;e.forEach(function(c){Math.abs(c)>k&&(k=Math.abs(c))});this.newValue(k)};this.audioIn=function(){return d};this.start=function(){f=setInterval(function(c){c.__render()},1E3/30,this)};this.stop=function(){clearInterval(f)};this.newValue=function(c){}}};this.audioIn=function(c,f){f=void 0===f?!0:f;var d=1;var e=c.createGain();__globals.utility.audio.changeAudioParam(c,e.gain,d);this.out=function(){return e};this.listDevices=function(c){navigator.mediaDevices.enumerateDevices().then(function(d){c(d.filter(function(c){return"audioinput"===
c.kind}))})};this.selectDevice=function(c){navigator.mediaDevices.getUserMedia({audio:{deviceId:c}}).then(function(c){audioDevice=c;__globals.audio.context.createMediaStreamSource(c).connect(e)},function(d){console.warn('could not find audio input device: "'+c+'"');console.warn("\terror:",d)})};this.gain=function(f){if(null==f)return d;d=f;__globals.utility.audio.changeAudioParam(c,e.gain,f)};f&&this.selectDevice("default")};this.channelMultiplier=function(c,f){f=void 0===f?2:f;var d=[];var e=1;var g=
c.createGain();__globals.utility.audio.changeAudioParam(c,g.gain,e,.01,"instant",!0);for(var k=0;k<f;k++){var h={gain:.5,node:c.createGain()};__globals.utility.audio.changeAudioParam(c,h.node.gain,h.gain,.01,"instant",!0);d.push(h);g.connect(h.node)}this.in=function(){return g};this.out=function(c){return d[c].node};this.inGain=function(d){if(void 0==d)return e;e=d;__globals.utility.audio.changeAudioParam(c,g.gain,e,.01,"instant",!0)};this.outGain=function(e,f){if(void 0==f)return d[e].gain;d[e].gain=
f;__globals.utility.audio.changeAudioParam(c,d[e].node.gain,d[e].gain,.01,"instant",!0)}};this.distortionUnit=function(c){function f(){d.inAggregator.node.disconnect();d.distortionNode.node&&d.distortionNode.node.disconnect();d.distortionNode.node=c.createWaveShaper();d.distortionNode.curve=new Float32Array(__globals.utility.math.curveGenerator.s(d.distortionNode.resolution,-1,1,d.distortionNode.distortionAmount));d.distortionNode.node.curve=d.distortionNode.curve;d.distortionNode.node.oversample=
d.distortionNode.oversample;d.inAggregator.node.connect(d.distortionNode.node);d.distortionNode.node.connect(d.outAggregator.node)}var d={inAggregator:{},distortionNode:{},outAggregator:{}};d.inAggregator.gain=0;d.inAggregator.node=c.createGain();__globals.utility.audio.changeAudioParam(c,d.inAggregator.node.gain,d.inAggregator.gain,.01,"instant",!0);d.distortionNode.distortionAmount=0;d.distortionNode.oversample="none";d.distortionNode.resolution=100;d.outAggregator.gain=0;d.outAggregator.node=c.createGain();
__globals.utility.audio.changeAudioParam(c,d.outAggregator.node.gain,d.outAggregator.gain,.01,"instant",!0);this.in=function(){return d.inAggregator.node};this.out=function(){return d.outAggregator.node};this.inGain=function(e){if(null==e)return d.inAggregator.gain;d.inAggregator.gain=e;__globals.utility.audio.changeAudioParam(c,d.inAggregator.node.gain,e,.01,"instant",!0)};this.outGain=function(e){if(null==e)return d.outAggregator.gain;d.outAggregator.gain=e;__globals.utility.audio.changeAudioParam(c,
d.outAggregator.node.gain,e,.01,"instant",!0)};this.distortionAmount=function(c){if(null==c)return d.distortionNode.distortionAmount;d.distortionNode.distortionAmount=c;f()};this.oversample=function(c){if(null==c)return d.distortionNode.oversample;d.distortionNode.oversample=c;f()};this.resolution=function(c){if(null==c)return d.distortionNode.resolution;d.distortionNode.resolution=2<=c?c:2;f()};f()};this.filterUnit=function(c){var f=c.createGain();__globals.utility.audio.changeAudioParam(c,f.gain,
1,.01,"instant",!0);var d=c.createBiquadFilter();d.type="lowpass";__globals.utility.audio.changeAudioParam(c,d.frequency,110,.01,"instant",!0);__globals.utility.audio.changeAudioParam(c,d.gain,1,.01,"instant",!0);__globals.utility.audio.changeAudioParam(c,d.Q,.1,.01,"instant",!0);var e=c.createGain();__globals.utility.audio.changeAudioParam(c,e.gain,1,.01,"instant",!0);f.connect(d);d.connect(e);this.in=function(){return f};this.out=function(){return e};this.type=function(c){d.type=c};this.frequency=
function(e){__globals.utility.audio.changeAudioParam(c,d.frequency,e,.01,"instant",!0)};this.gain=function(e){__globals.utility.audio.changeAudioParam(c,d.gain,e,.01,"instant",!0)};this.Q=function(e){__globals.utility.audio.changeAudioParam(c,d.Q,e,.01,"instant",!0)};this.measureFrequencyResponse=function(c,d,e){for(var f=[];c<d;c+=e)f.push(c);return this.measureFrequencyResponse_values(f)};this.measureFrequencyResponse_values=function(c){var e=new Float32Array(c),f=new Float32Array(e.length),g=new Float32Array(e.length);
d.getFrequencyResponse(e,f,g);return[f,c]}};this.looper=function(c){var f=this,d=!1,e=1,g=!0,k=0,h=1,n={},l=null,m={};m=c.createChannelSplitter(2);var p=c.createGain();p.gain.setTargetAtTime(1,c.currentTime,0);m.connect(p,0);var r=c.createGain();r.gain.setTargetAtTime(1,c.currentTime,0);m.connect(r,1);this.out_left=function(){return p};this.out_right=function(){return r};this.load=function(c,e,g){d=!1;__globals.utility.audio.loadAudioFile(function(c){f.stop();n=c;d=!0;e(c)},c,void 0===g?"":g)};this.start=
function(){d&&(l&&(l.onended=function(){},l.stop(0)),l=__globals.utility.audio.loadBuffer(c,n.buffer,m),l.playbackRate.value=e,l.loop=g,l.loopStart=k*this.duration(),l.loopEnd=h*this.duration(),l.start(0,0),l.onended=function(){l=null})};this.stop=function(){d&&l&&(l.stop(0),l=void 0)};this.rate=function(){e=value};this.duration=function(){return d?n.duration:-1};this.title=function(){return d?n.name:""};this.waveformSegment=function(c){c=void 0===c?{start:0,end:1}:c;return void 0!=c&&d?__globals.utility.audio.waveformSegment(n.buffer,
c):[]};this.loop=function(c){if(void 0==data)return data;g=void 0===c?!1:c};this.loopBounds=function(c){c=void 0===c?{start:0,end:1}:c;if(void 0==c)return c;k=void 0!=c.start?c.start:k;h=void 0!=c.end?c.end:h}};this.oneShot_multi=function(c){var f=this,d=!1,e=1,g={},k=[],h={};h=c.createChannelSplitter(2);var n=c.createGain();n.gain.setTargetAtTime(1,c.currentTime,0);h.connect(n,0);var l=c.createGain();l.gain.setTargetAtTime(1,c.currentTime,0);h.connect(l,1);this.audioOut=function(c){switch(c){case "r":return l;
case "l":return n;default:console.error('"parts.circuits.audio.oneShot_multi2.audioOut" unknown channel "'+c+'"')}};this.out_left=function(){return this.audioOut("l")};this.out_right=function(){return this.audioOut("r")};this.loadRaw=function(c){0!==Object.keys(c).length&&(g=c,d=!0)};this.load=function(c,e,g){d=!1;__globals.utility.audio.loadAudioFile(function(c){f.loadRaw(c);void 0!=e&&e(c)},c,g)};this.unloadRaw=function(){return g};this.fire=function(f,l){f=void 0===f?0:f;if(d){var m=__globals.utility.audio.loadBuffer(c,
g.buffer,h,function(){k.splice(k.indexOf(this),1)});m.playbackRate.value=e;m.start(0,f*e,l*e);k.push(m)}};this.panic=function(){for(;0<k.length;)k.shift().stop(0)};this.rate=function(c){if(void 0==c)return e;0==c&&(c=1E-6);e=c};this.duration=function(){return d?g.duration/e:-1};this.title=function(){return d?g.name:""};this.waveformSegment=function(c){c=void 0===c?{start:0,end:1}:c;return void 0!=c&&d?__globals.utility.audio.waveformSegment(g.buffer,c):[]}};this.oneShot_single=function(c){var f=this,
d=!1,e=1,g={},k=null,h={};h=c.createChannelSplitter(2);var n=c.createGain();n.gain.setTargetAtTime(1,c.currentTime,0);h.connect(n,0);var l=c.createGain();l.gain.setTargetAtTime(1,c.currentTime,0);h.connect(l,1);this.out_left=function(){return n};this.out_right=function(){return l};this.load=function(c,e,h){d=!1;__globals.utility.audio.loadAudioFile(function(c){f.stop();g=c;d=!0;e(c)},c,void 0===h?"":h)};this.fire=function(){d&&(k&&(k.onended=function(){},k.stop(0)),k=__globals.utility.audio.loadBuffer(c,
g.buffer,h),k.playbackRate.value=e,k.start(0,0),k.onended=function(){k=null})};this.stop=function(){d&&(k.stop(0),k=void 0)};this.rate=function(){e=value};this.duration=function(){return d?g.duration:-1};this.title=function(){return d?g.name:""};this.waveformSegment=function(c){c=void 0===c?{start:0,end:1}:c;return void 0!=c&&d?__globals.utility.audio.waveformSegment(g.buffer,c):[]}};this.player=function(c){function f(){clearInterval(e.loop.timeout);e.playhead.position=e.itself.currentTime();e.playhead.lastSightingTime=
c.currentTime;if(e.loop.active&&e.playing){var d=e.loop.end-e.itself.currentTime();0>d&&(d=0);e.loop.timeout=setTimeout(function(){e.itself.jumpTo(e.loop.start,!1);f()},1E3*d/e.rate)}}function d(d){e.fileLoaded&&(e.playing?(e.loop.active&&d>e.loop.end&&(d=e.loop.start),e.itself.stop(function(){e.playhead.position=d;e.playhead.lastSightingTime=c.currentTime;e.itself.start()})):(e.playhead.position=d,e.playhead.lastSightingTime=c.currentTime))}var e={itself:this,fileLoaded:!1,playing:!1,playhead:{position:0,
lastSightingTime:0},loop:{active:!1,start:0,end:1,timeout:null},rate:1},g={},k=null,h={};h=c.createChannelSplitter(2);var n=c.createGain();n.gain.setTargetAtTime(1,c.currentTime,0);h.connect(n,0);var l=c.createGain();l.gain.setTargetAtTime(1,c.currentTime,0);h.connect(l,1);this.out_left=function(){return n};this.out_right=function(){return l};this.load=function(c,d,f){e.fileLoaded=!1;__globals.utility.audio.loadAudioFile(function(c){e.itself.stop();g=c;e.fileLoaded=!0;e.playhead.position=0;d(c)},
c,void 0===f?"":f)};this.start=function(){!e.playing&&e.fileLoaded&&(k=__globals.utility.audio.loadBuffer(c,g.buffer,h,function(c){e.itself.stop()}),k.loop=e.loop.active,k.loopStart=e.loop.start,k.loopEnd=e.loop.end,k.playbackRate.value=e.rate,k.start(0,e.playhead.position),e.playhead.lastSightingTime=c.currentTime,e.playing=!0,f())};this.stop=function(c){e.playing&&(c&&(k.onended=function(){c()}),k.stop(0),k=void 0,f(),e.playing=!1)};this.jumpTo=function(c,e){c=void 0===c?0:c;void 0===e||e?(c=1<
c?1:c,c=0>c?0:c,d(this.duration()*c)):d(c);f()};this.loop=function(c,d){c=void 0===c?{active:!1,start:0,end:1}:c;d=void 0===d?!0:d;if(void 0==c)return e.loop;void 0!=c.active&&(e.loop.active=c.active,k&&(k.loop=c.active));if(void 0!=c.start||void 0!=c.end)d=d?this.duration():1,e.loop.start=void 0!=c.start?c.start*d:e.loop.start,e.loop.end=void 0!=c.end?c.end*d:e.loop.end,k&&(k.loopStart=e.loop.start,k.loopEnd=e.loop.end);f()};this.rate=function(c){c=void 0===c?1:c;e.rate=c;k&&(k.playbackRate.value=
c);f()};this.isLoaded=function(){return e.fileLoaded};this.duration=function(){return e.fileLoaded?g.duration:-1};this.title=function(){return e.fileLoaded?g.name:""};this.currentTime=function(){return e.fileLoaded?e.playing?e.playhead.position+e.rate*(c.currentTime-e.playhead.lastSightingTime):e.playhead.position:-1};this.progress=function(){return this.currentTime()/this.duration()};this.waveformSegment=function(c){c=void 0===c?{start:0,end:1}:c;return void 0!=c&&e.fileLoaded?__globals.utility.audio.waveformSegment(g.buffer,
c):[]}};this.recorder=function(c){function f(){switch(e.recordingNode.node.state){case "inactive":case "paused":return d.recordingLength;case "recording":return c.currentTime-d.recordingStartTime}}var d={recordedChunks:[],recordingStartTime:-1,recordingLength:0},e={leftIn:{},rightIn:{},recordingNode:{},leftOut:{},rightOut:{}};e.leftIn.node=c.createAnalyser();e.rightIn.node=c.createAnalyser();e.recordingNode.audioDest=new MediaStreamAudioDestinationNode(c);e.recordingNode.node=new MediaRecorder(e.recordingNode.audioDest.stream,
{mimeType:"audio/webm"});e.recordingNode.node.onstart=function(){};e.recordingNode.node.ondataavailable=function(c){d.recordedChunks.push(c.data)};e.recordingNode.node.onpause=function(){};e.recordingNode.node.onresume=function(){};e.recordingNode.node.onerror=function(c){console.log(c)};e.recordingNode.node.onstop=function(){};e.leftIn.node.connect(e.recordingNode.audioDest);e.rightIn.node.connect(e.recordingNode.audioDest);e.leftOut.node=c.createAnalyser();e.leftIn.node.connect(e.leftOut.node);
e.rightOut.node=c.createAnalyser();e.rightIn.node.connect(e.rightOut.node);this.clear=function(){this.stop();d.recordedChunks=[];d.recordingStartTime=-1;d.recordingLength=0};this.start=function(){this.clear();e.recordingNode.node.start();d.recordingStartTime=c.currentTime};this.pause=function(){"inactive"!=this.state()&&(d.recordingLength=f(),e.recordingNode.node.pause())};this.resume=function(){e.recordingNode.node.resume();d.recordingStartTime=c.currentTime-d.recordingLength};this.stop=function(){"inactive"!=
this.state()&&(d.recordingLength=f(),e.recordingNode.node.stop())};this.export=function(){return new Blob(d.recordedChunks,{type:"audio/ogg; codecs=opus"})};this.save=function(c){c=void 0===c?"output":c;var d=document.createElement("a");d.href=URL.createObjectURL(this.export());d.download=c+".ogg";document.body.appendChild(d);d.click();document.body.removeChild(d)};this.state=function(){return e.recordingNode.node.state};this.recordingTime=function(){return f()};this.getTrack=function(){return new Blob(d.recordedChunks,
{type:"audio/ogg; codecs=opus"})};this.in_left=function(){return e.leftIn.node};this.in_right=function(){return e.rightIn.node};this.out_left=function(){return e.leftOut.node};this.out_right=function(){return e.rightOut.node}};this.reverbUnit=function(c){function f(d,f,h){var g=new XMLHttpRequest;g.open("GET",d+f,!0);g.responseType="arraybuffer";g.onload=function(){c.decodeAudioData(g.response,function(c){e.reverbNode.node.buffer=c},function(c){console.warn("Error with decoding audio data"+c.err)});
h&&h()};g.send()}function d(c,d){d=void 0===d?null:d;var e=new XMLHttpRequest;e.open("GET",c+"available2.list",!0);e.onload=function(){var c=e.response.split("\n");c[c.length-1]=c[c.length-1].split("");c[c.length-1].pop();c[c.length-1]=c[c.length-1].join("");c.splice(-1,1);null==d?console.log(c):d(c)};e.send()}var e={inAggregator:{},reverbGain:{},bypassGain:{},reverbNode:{},outAggregator:{}};e.inAggregator.gain=1;e.inAggregator.node=c.createGain();__globals.utility.audio.changeAudioParam(c,e.inAggregator.node.gain,
e.inAggregator.gain,.01,"instant",!0);e.reverbGain.gain=.5;e.bypassGain.gain=.5;e.reverbGain.node=c.createGain();e.bypassGain.node=c.createGain();__globals.utility.audio.changeAudioParam(c,e.reverbGain.node.gain,e.reverbGain.gain,.01,"instant",!0);__globals.utility.audio.changeAudioParam(c,e.bypassGain.node.gain,e.bypassGain.gain,.01,"instant",!0);e.reverbNode.impulseResponseRepoURL="https://metasophiea.com/lib/audio/impulseResponse/";e.reverbNode.selectedReverbType="Musikvereinsaal.wav";e.reverbNode.node=
c.createConvolver();e.outAggregator.gain=1;e.outAggregator.node=c.createGain();__globals.utility.audio.changeAudioParam(c,e.outAggregator.node.gain,e.outAggregator.gain,.01,"instant",!0);e.inAggregator.node.connect(e.reverbGain.node);e.inAggregator.node.connect(e.bypassGain.node);e.reverbGain.node.connect(e.reverbNode.node);e.bypassGain.node.connect(e.outAggregator.node);e.reverbNode.node.connect(e.outAggregator.node);this.in=function(){return e.inAggregator.node};this.out=function(){return e.outAggregator.node};
this.getTypes=function(c){d(e.reverbNode.impulseResponseRepoURL,c)};this.type=function(c,d){if(null==c)return e.reverbNode.selectedReverbType;e.reverbNode.selectedReverbType=c;f(e.reverbNode.impulseResponseRepoURL,e.reverbNode.selectedReverbType,d)};this.outGain=function(d){if(null==d)return e.outAggregator.gain;e.outAggregator.gain=d;__globals.utility.audio.changeAudioParam(c,e.outAggregator.node.gain,d,.01,"instant",!0)};this.wetdry=function(d){if(null==d)return e.reverbGain.gain;e.reverbGain.gain=
d;e.bypassGain.gain=1-d;__globals.utility.audio.changeAudioParam(c,e.reverbGain.node.gain,e.reverbGain.gain,.01,"instant",!0);__globals.utility.audio.changeAudioParam(c,e.bypassGain.node.gain,e.bypassGain.gain,.01,"instant",!0)};f(e.reverbNode.impulseResponseRepoURL,e.reverbNode.selectedReverbType)};this.synthesizer_1=function(c,f,d,e,g,k,h,n){function l(c,d,e,f,g,h,k,l,n,p){return new function(){this.generator=c.createOscillator();"custom"==f?this.generator.setPeriodicWave(c.createPeriodicWave(new Float32Array(g.cos),
new Float32Array(g.sin))):this.generator.type=f;this.generator.frequency.setTargetAtTime(__globals.audio.num2freq(e,p),c.currentTime,0);this.generator.detune.setTargetAtTime(n,c.currentTime,0);this.generator.start(0);this.gain=c.createGain();this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,c.currentTime,0);m(this.gain.gain,h,k.time,k.curve,!1);this.gain.connect(d);this.detune=function(c,d,e){m(this.generator.detune,c,d,e)};this.changeVelocity=function(c){m(this.gain.gain,c,k.time,
k.curve)};this.stop=function(){m(this.gain.gain,0,l.time,l.curve,!1);setTimeout(function(c){c.gain.disconnect();c.generator.stop();c.generator.disconnect();c.gain=null;c.generator=null},1E3*l.time,this)}}}function m(d,e,f,g,h){if(null==e)return d.value;(void 0===h||h)&&d.cancelScheduledValues(c.currentTime);switch(g){case "linear":d.linearRampToValueAtTime(e,c.currentTime+f);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");0==e&&(e=1E-4);d.exponentialRampToValueAtTime(e,
c.currentTime+f);break;case "s":e-=d.value;g=__globals.utility.math.curveGenerator.s(10);for(h=0;h<g.length;h++)g[h]=d.value+g[h]*e;d.setValueCurveAtTime(new Float32Array(g),c.currentTime,f);break;default:d.setTargetAtTime(e,c.currentTime,.001)}}f=void 0===f?"sine":f;d=void 0===d?{sin:[0,1],cos:[0,0]}:d;e=void 0===e?1:e;g=void 0===g?{time:.01,curve:"linear"}:g;k=void 0===k?{time:.05,curve:"linear"}:k;h=void 0===h?0:h;n=void 0===n?0:n;var p=c.createGain();p.gain.setTargetAtTime(e,c.currentTime,0);
var r={};this.waveType=function(c){if(null==c)return f;f=c};this.periodicWave=function(c){if(null==c)return d;d=c};this.gain=function(c,d,e){return m(p.gain,c,d,e)};this.attack=function(c,d){if(null==c&&null==d)return g;g.time=c?c:g.time;g.curve=d?d:g.curve};this.release=function(c,d){if(null==c&&null==d)return k;k.time=c?c:k.time;k.curve=d?d:k.curve};this.octave=function(c){if(null==c)return n;n=c};this.detune=function(c,d,e){if(null==a)return h;var f=h,g=c-f,k=Math.round(Math.abs(g)),m=k*d,l=[1];
switch(e){case "linear":l=__globals.utility.math.curveGenerator.linear(m);break;case "exponential":l=__globals.utility.math.curveGenerator.exponential(m);break;case "s":l=__globals.utility.math.curveGenerator.s(m,8)}if(0!=l.length)var n=setInterval(function(){h=f+l.shift()*g;0==l.length&&clearInterval(n)},1E3/k);k=Object.keys(r);for(m=0;m<k.length;m++)r[k[m]].detune(c,d,e)};this.out=function(){return p};this.perform=function(e){if(r[e.num]||0!=e.velocity)r[e.num]?0==e.velocity?(r[e.num].stop(),delete r[e.num]):
r[e.num].changeVelocity(e.velocity):r[e.num]=l(c,p,e.num,f,d,e.velocity,g,k,h,n)};this.panic=function(){for(var c=Object.keys(r),d=0;d<c.length;d++)this.perform({num:c[d],velocity:0})}};this.synthesizer2=function(c,f,d,e,g,k,h,n,l,m,p,r,t,v,u,w){d=void 0===d?{sin:[0,1],cos:[0,0]}:d;e=void 0===e?1:e;g=void 0===g?0:g;k=void 0===k?0:k;h=void 0===h?.01:h;n=void 0===n?1:n;l=void 0===l?{time:.01,curve:"linear"}:l;m=void 0===m?{time:.05,curve:"linear"}:m;u=void 0===u?.01:u;w=void 0===w?1:w;var q={},y={},
z={},x={};q.waveType=void 0===f?"sine":f;q.periodicWave=d;q.attack=l;q.release=m;q.octave=void 0===p?0:p;q.detune=void 0===r?0:r;q.func=function(c,d,e,f,g,h,k,m,l,n){return new function(){this.generator=c.createOscillator();"custom"==f?this.generator.setPeriodicWave(c.createPeriodicWave(new Float32Array(g.cos),new Float32Array(g.sin))):this.generator.type=f;this.generator.frequency.setTargetAtTime(__globals.audio.num2freq(e+12*n),c.currentTime,0);this.generator.detune.setTargetAtTime(l,c.currentTime,
0);this.generator.start(0);this.gain=c.createGain();this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,c.currentTime,0);__globals.utility.audio.changeAudioParam(c,this.gain.gain,h,k.time,k.curve,!1);this.gain.connect(d);this.detune=function(d,e,f){__globals.utility.audio.changeAudioParam(c,this.generator.detune,d,e,f)};this.changeVelocity=function(d){__globals.utility.audio.changeAudioParam(c,this.gain.gain,d,k.time,k.curve)};this.stop=function(){__globals.utility.audio.changeAudioParam(c,
this.gain.gain,0,m.time,m.curve,!1);setTimeout(function(c){c.gain.disconnect();c.generator.stop();c.generator.disconnect();c.gain=null;c.generator=null},1E3*m.time,this)}}};z.depth=void 0===t?0:t;z.period=void 0===v?0:v;z.phase=!0;z.wave="s";z.interval=null;z.start=function(){z.period<u||z.period>=w||(z.interval=setInterval(function(){var c=Object.keys(y);if(z.phase)for(var d=0;d<c.length;d++)y[c[d]].detune(z.depth,.9*z.period,z.wave);else for(d=0;d<c.length;d++)y[c[d]].detune(-z.depth,.9*z.period,
z.wave);z.phase=!z.phase},1E3*z.period))};z.stop=function(){clearInterval(z.interval)};var E=c.createGain();E.gain.setTargetAtTime(1,c.currentTime,0);x.depth=g;x.period=k;x.phase=!0;x.wave="s";x.interval=null;x.start=function(){x.period<h||x.period>=n?__globals.utility.audio.changeAudioParam(c,x.node.gain,1,.01,x.wave):x.interval=setInterval(function(){x.phase?__globals.utility.audio.changeAudioParam(c,x.node.gain,1,.9*x.period,x.wave):__globals.utility.audio.changeAudioParam(c,x.node.gain,1-x.depth,
.9*x.period,x.wave);x.phase=!x.phase},1E3*x.period)};x.stop=function(){clearInterval(x.interval)};x.node=c.createGain();x.node.gain.setTargetAtTime(1,c.currentTime,0);E.connect(x.node);var A=c.createGain();A.gain.setTargetAtTime(e,c.currentTime,0);x.node.connect(A);this.out=function(){return A};this.perform=function(d){if(y[d.num]||0!=d.velocity)y[d.num]?0==d.velocity?(y[d.num].stop(),delete y[d.num]):y[d.num].changeVelocity(d.velocity):y[d.num]=q.func(c,E,d.num,q.waveType,q.periodicWave,d.velocity,
q.attack,q.release,q.detune,q.octave)};this.panic=function(){for(var c=Object.keys(y),d=0;d<c.length;d++)this.perform({num:c[d],velocity:0})};this.waveType=function(c){if(null==c)return q.waveType;q.waveType=c};this.periodicWave=function(c){if(null==c)return q.periodicWave;q.periodicWave=c};this.gain=function(d,e,f){return __globals.utility.audio.changeAudioParam(c,A.gain,d,e,f)};this.attack=function(c,d){if(null==c&&null==d)return q.attack;q.attack.time=c?c:q.attack.time;q.attack.curve=d?d:q.attack.curve};
this.release=function(c,d){if(null==c&&null==d)return q.release;q.release.time=c?c:q.release.time;q.release.curve=d?d:q.release.curve};this.octave=function(c){if(null==c)return q.octave;q.octave=c};this.detune=function(c,d,e){if(null==a)return q.detune;var f=q.detune,g=c-f,h=Math.round(Math.abs(g)),k=h*d,m=[1];switch(e){case "linear":m=__globals.utility.math.curveGenerator.linear(k);break;case "exponential":m=__globals.utility.math.curveGenerator.exponential(k);break;case "s":m=__globals.utility.math.curveGenerator.s(k,
8)}if(0!=m.length)var l=setInterval(function(){q.detune=f+m.shift()*g;0==m.length&&clearInterval(l)},1E3/h);h=Object.keys(y);for(k=0;k<h.length;k++)y[h[k]].detune(c,d,e)};this.gainWobbleDepth=function(c){if(null==c)return x.depth;x.depth=c;x.stop();x.start()};this.gainWobblePeriod=function(c){if(null==c)return x.period;x.period=c;x.stop();x.start()};this.detuneWobbleDepth=function(c){if(null==c)return z.depth;z.depth=c;z.stop();z.start()};this.detuneWobblePeriod=function(c){if(null==c)return z.period;
z.period=c;z.stop();z.start()}}};this.sequencing=new function(){this.launchpad=function(c,f){var d=[],e=0,g=0,k=c-1;this.square=function(g,k,l){0>g?g=0:g>c-1&&(g=c-1);0>k?k=0:g>f-1&&(g=f-1);if(void 0==l)return d[e][k][g];d[e][k][g]=l};this.line=function(c,k){if(void 0==k){k=[];for(c=0;c<f;c++)void 0==d[e]||void 0==d[e][c]||void 0==d[e][c][g]?k.push(!1):k.push(d[e][c][g]);return k}for(c=0;c<f;c++)d[e][c][g]=k[c]};this.position=function(d,e){if(void 0==d)return g;k=g;d>c-1?d=0:0>d&&(d=c-1);g=d;(void 0===
e||e)&&this.commands(this.line())};this.previousPosition=function(){return k};this.inc=function(){this.position(g+1)};this.dec=function(){this.position(g-1)};this.page=function(c){if(void 0==c)return e;-1==c?c=9:0>c?c=0:10==c?c=0:10<=c&&(c=9);e=c;void 0!=this.pageChange&&this.pageChange(e)};this.incPage=function(){this.page(e+1)};this.decPage=function(){this.page(e-1)};this.exportPages=function(){return JSON.parse(JSON.stringify(d))};this.importPages=function(c){d=c;this.pageChange(e)};this.exportPage=
function(g){void 0==g&&(g=e);return void 0==d[g]?Array(c).fill(Array(f).fill(!1)):JSON.parse(JSON.stringify(d[g]))};this.importPage=function(c,f){void 0==f&&(f=e);d[f]=c;void 0!=this.pageChange&&this.pageChange(e)};this.commands=function(){};this.pageChange=function(){}};this.noteRegistry=function(c,f,d){c=void 0===c?-1:c;f=void 0===f?-1:f;d=void 0===d?-1:d;var e=[],g=[],k=[],h=[],n={},l=[];this.__dump=function(){console.log("---- noteRegistry dump ----");console.log("\tnotes");for(var c=0;c<e.length;c++)console.log("\t\t",
c," "+JSON.stringify(e[c]));console.log("\tselectedNotes");for(c=0;c<g.length;c++)console.log("\t\t",c," "+JSON.stringify(g[c]));console.log("\tevents");for(c=0;c<k.length;c++)console.log("\t\t",c," "+JSON.stringify(k[c]));console.log("\tevents_byID");for(c=0;c<h.length;c++)console.log("\t\t",c," "+JSON.stringify(h[c]));console.log("\tevents_byPosition");var d=Object.keys(n);for(c=0;c<d.length;c++)console.log("\t\t",d[c]," "+JSON.stringify(n[d[c]]));console.log("\tpositions");for(c=0;c<l.length;c++)console.log("\t\t",
c," "+JSON.stringify(l[c]))};this.export=function(){return JSON.parse(JSON.stringify({notes:e,selectedNotes:g,events:k,events_byID:h,events_byPosition:n,positions:l}))};this.import=function(c){e=JSON.parse(JSON.stringify(c.notes));g=JSON.parse(JSON.stringify(c.selectedNotes));k=JSON.parse(JSON.stringify(c.events));h=JSON.parse(JSON.stringify(c.events_byID));n=JSON.parse(JSON.stringify(c.events_byPosition));l=JSON.parse(JSON.stringify(c.positions))};this.getAllNotes=function(){return JSON.parse(JSON.stringify(e))};
this.getAllEvents=function(){return JSON.parse(JSON.stringify(k))};this.getNote=function(c){if(void 0!=e[c])return JSON.parse(JSON.stringify(e[c]))};this.eventsBetween=function(c,d){for(var e=void 0==d?Array.from(new Set(l.filter(function(d){return d==c}))):Array.from(new Set(l.filter(function(e){return e>=c&&e<d}))),f=[],g=0;g<e.length;g++){e[g]=n[String(e[g])];for(var h=0;h<e[g].length;h++)f.push(k[e[g][h]])}return f.sort(function(c,d){return c.position<d.position?-1:c.position>d.position?1:0})};
this.add=function(g,p){if(void 0!=g&&"line"in g&&"position"in g&&"length"in g){"strength"in g||(g.strength=1);0>g.line&&(g.line=0);0>g.length&&(g.length=0);0>g.position&&(g.position=0);0>g.strength&&(g.strength=0);-1<f&&g.line>f-1&&(g.line=f-1);-1<d&&g.length>d&&(g.length=d);-1<c&&g.position>c&&(g.position=c-g.length);-1<c&&g.position+g.length>c&&(g.length=c-g.position);-1<c&&g.position+g.length>c&&(g.position=c-g.length);1<g.strength&&(g.strength=1);var m=0;if(void 0==p)for(;void 0!=e[m];)m++;else m=
p;e[m]=JSON.parse(JSON.stringify(g));g=[{noteID:m,line:g.line,position:g.position,strength:g.strength},{noteID:m,line:g.line,position:g.position+g.length,strength:0}];for(p=0;void 0!=k[p];)p++;k[p]=g[0];h[m]=[p];void 0==n[g[0].position]?n[g[0].position]=[p]:n[g[0].position].push(p);for(l.push(g[0].position);void 0!=k[p];)p++;k[p]=g[1];h[m]=h[m].concat(p);void 0==n[g[1].position]?n[g[1].position]=[p]:n[g[1].position].push(p);l.push(g[1].position);return m}};this.remove=function(c){if(void 0!=e[c]){delete e[c];
for(var d=0;d<h[c].length;d++){var f=h[c][d];n[k[f].position].splice(n[k[f].position].indexOf(f),1);l.splice(l.indexOf(k[f].position),1);0==n[k[f].position].length&&delete n[k[f].position];delete k[f]}delete h[c]}};this.update=function(d,f){void 0!=f&&("line"in f||(f.line=e[d].line),-1<c&&("position"in f&&"length"in f?f.length+f.position>c&&(f.length=c-f.position):("position"in f?e[d].length+f.position>=c&&(f.position=c-e[d].length):f.position=e[d].position,"length"in f?f.length+f.position>c&&(f.length=
c-f.position):f.length=e[d].length)),"strength"in f||(f.strength=e[d].strength),this.remove(d),this.add(f,d))};this.reset=function(){e=[];g=[];k=[];h=[];n={};l=[]}}}};this.elements=new function(){this.basic=new function(){this.canvas=function(c,f,d,e,g,k,h){c=void 0===c?null:c;f=void 0===f?0:f;d=void 0===d?0:d;e=void 0===e?0:e;g=void 0===g?0:g;k=void 0===k?0:k;h=void 0===h?1:h;var n=document.createElement("canvas");n.setAttribute("height",h*g);n.setAttribute("width",h*e);var l=document.createElementNS("http://www.w3.org/2000/svg",
"image");l.id=c;l.style="transform: translate("+f+"px,"+d+"px) scale("+1/h+") rotate("+k+"rad)";l.setAttribute("height",g*h);l.setAttribute("width",e*h);return{element:l,canvas:n,context:n.getContext("2d"),c:function(c){return c*h},print:function(){this.element.setAttribute("href",this.canvas.toDataURL())}}};this.circle=function(c,f,d,e,g,k){c=void 0===c?null:c;f=void 0===f?0:f;d=void 0===d?0:d;e=void 0===e?0:e;g=void 0===g?0:g;k=void 0===k?"fill:rgba(255,100,255,0.75)":k;var h=document.createElementNS("http://www.w3.org/2000/svg",
"circle");h.id=c;h.setAttribute("r",e);h.style="transform: translate("+f+"px,"+d+"px) scale(1) rotate("+g+"rad);"+k;return h};this.g=function(c,f,d,e,g){c=void 0===c?null:c;f=void 0===f?0:f;d=void 0===d?0:d;e=void 0===e?0:e;g=void 0===g?"":g;var k=document.createElementNS("http://www.w3.org/2000/svg","g");k.id=c;k.style=g+"transform: translate("+f+"px,"+d+"px) scale(1) rotate("+e+"rad);";return k};this.image=function(c,f,d,e,g,k,h){c=void 0===c?null:c;d=void 0===d?0:d;e=void 0===e?0:e;g=void 0===
g?0:g;k=void 0===k?0:k;h=void 0===h?0:h;var n=document.createElementNS("http://www.w3.org/2000/svg","image");n.id=c;n.style="transform: translate("+d+"px,"+e+"px) scale(1) rotate("+h+"rad)";n.setAttribute("height",k);n.setAttribute("width",g);n.setAttribute("href",f);return n};this.line=function(c,f,d,e,g,k){c=void 0===c?null:c;f=void 0===f?0:f;d=void 0===d?0:d;e=void 0===e?10:e;g=void 0===g?10:g;k=void 0===k?"stroke:rgb(255,0,0); stroke-width:1":k;var h=document.createElementNS("http://www.w3.org/2000/svg",
"line");h.id=c;h.setAttribute("x1",f);h.setAttribute("y1",d);h.setAttribute("x2",e);h.setAttribute("y2",g);h.setAttribute("style",k);return h};this.path=function(c,f,d,e){c=void 0===c?null:c;f=void 0===f?[]:f;d=void 0===d?"L":d;e=void 0===e?"fill:rgba(0,0,0,0);":e;var g=document.createElementNS("http://www.w3.org/2000/svg","path");g.id=c;g.style="transform: translate(0px,0px) scale(1) rotate(0rad);"+e;g._installPath=function(c){for(var e="M "+c[0].x+" "+c[0].y+" "+d,f=1;f<c.length;f++)e+=" "+c[f].x+
" "+c[f].y;this.setAttribute("d",e)};g._path=f;g._installPath(f);g.path=function(c){if(null==c)return this._path;this._path=c;this._installPath(c)};return g};this.rect=function(c,f,d,e,g,k,h){c=void 0===c?null:c;f=void 0===f?0:f;d=void 0===d?0:d;e=void 0===e?0:e;g=void 0===g?0:g;k=void 0===k?0:k;h=void 0===h?"fill:rgba(255,100,255,0.75)":h;var n=document.createElementNS("http://www.w3.org/2000/svg","rect");n.id=c;n.style="transform: translate("+f+"px,"+d+"px) scale(1) rotate("+k+"rad);"+h;n.setAttribute("height",
g);n.setAttribute("width",e);n.rotation=function(c){if(null==c)return __globals.utility.element.getTransform(this).r;__globals.utility.element.setRotation(this,c)};return n};this.text=function(c,f,d,e,g,k,h){c=void 0===c?null:c;f=void 0===f?0:f;d=void 0===d?0:d;e=void 0===e?"":e;g=void 0===g?0:g;k=void 0===k?"fill:rgba(0,0,0,1); font-size:3; font-family:Helvetica;":k;h=void 0===h?1:h;var n=document.createElementNS("http://www.w3.org/2000/svg","text");n.id=c;n.style="transform: translate("+f+"px,"+
d+"px) scale("+h+") rotate("+g+"rad);"+k;n.innerHTML=e;return n}};this.display=new function(){this.audio_meter_level=function(c,f,d,e,g,k,h,n,l,m){h=void 0===h?[.125,.25,.375,.5,.625,.75,.875]:h;l=void 0===l?["fill:rgba(250,250,250,1);","fill:rgb(100,100,100);"]:l;var p=__globals.utility.misc.elementMaker("meter_level","mainlevel",{x:f,y:d,width:g,height:k,angle:void 0===e?0:e,markings:h,style:{backing:void 0===n?"fill:rgb(10,10,10)":n,levels:l,marking:void 0===m?"fill:rgba(220,220,220,1); stroke:none; font-size:1px; font-family:Courier New;":
m}}),r=parts.circuits.audio.audio2percentage();r.newValue=function(c){p.set(c)};p.audioIn=function(){return r.audioIn()};p.start=function(){r.start()};p.stop=function(){r.stop()};p.set(0);return p};this.glowbox_rect=function(c,f,d,e,g,k,h,n){k=void 0===k?0:k;h=void 0===h?"fill:rgba(240,240,240,1)":h;n=void 0===n?"fill:rgba(80,80,80,1)":n;c=__globals.utility.misc.elementMaker("g",void 0===c?"glowbox_rect":c,{x:f,y:d});var l=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,sngle:k,
style:n});c.appendChild(l);c.on=function(){__globals.utility.element.setStyle(l,h)};c.off=function(){__globals.utility.element.setStyle(l,n)};return c};this.grapher_audioScope=function(c,f,d,e,g,k,h,n,l,m,p){c=void 0===c?"grapher_audioScope":c;k=void 0===k?"Canvas":k;h=void 0===h?["stroke:rgba(0,255,0,1); stroke-width:0.5; stroke-linecap:round;"]:h;n=void 0===n?["fill:rgba(0,255,0,1); font-size:3; font-family:Helvetica;"]:n;l=void 0===l?"stroke:rgba(0,100,0,1); stroke-width:0.25;":l;m=void 0===m?
"fill:rgba(0,100,0,1); font-size:3; font-family:Helvetica;":m;p=void 0===p?"fill:rgba(50,50,50,1)":p;var r=__globals.audio.context.createAnalyser(),t=null,v=30,u=null,w=256;r.fftSize=w;t=new Uint8Array(r.fftSize);new Uint8Array(r.fftSize);c=__globals.utility.misc.elementMaker("g",c,{x:f,y:d});c._data={};c._data.wave={sin:[],cos:[]};c._data.resolution=500;var q=__globals.utility.misc.elementMaker("grapher"+k,"graph",{x:0,y:0,width:e,height:g,style:{foreground:h,foregroundText:n,background:l,backgroundText:m,
backing:p}});c.append(q);c.start=function(){null==u&&(u=setInterval(function(){var c=[];r.getByteTimeDomainData(t);for(var d=0;d<t.length;d++)c.push(t[d]/128-1);q.draw(c)},1E3/v))};c.stop=function(){clearInterval(u);u=null};c.getNode=function(){return r};c.resolution=function(c){c=void 0===c?null:c;if(null==c)return w;w=c;this.stop();this.start()};c.refreshRate=function(c){if(null==c)return v;v=c;this.stop();this.start()};q.viewbox({l:-1.1,h:1.1});q.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,
-.5,-.75,-1],printText:!1});q.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});q.drawBackground();return c};this.grapher_periodicWave=function(c,f,d,e,g,k,h,n,l,m,p){k=void 0===k?"Canvas":k;h=void 0===h?["stroke:rgba(0,255,0,1); stroke-width:0.75; stroke-linecap:round;"]:h;n=void 0===n?["fill:rgba(0,255,0,1); font-size:3; font-family:Helvetica;"]:n;l=void 0===l?"stroke:rgba(0,100,0,1); stroke-width:1;":l;m=void 0===m?"fill:rgba(0,100,0,1); font-size:3; font-family:Helvetica;":
m;p=void 0===p?"fill:rgba(50,50,50,1)":p;c=__globals.utility.misc.elementMaker("g",void 0===c?"grapher_periodicWave":c,{x:f,y:d});c._data={};c._data.wave={sin:[],cos:[]};c._data.resolution=500;var r=__globals.utility.misc.elementMaker("grapher"+k,"graph",{x:0,y:0,width:e,height:g,style:{foreground:h,foregroundText:n,background:l,backgroundText:m,backing:p}});c.append(r);c.wave=function(c,d){c=void 0===c?null:c;d=void 0===d?null:d;if(null==c){for(;this._data.wave.sin.length<this._data.wave.cos.length;)this._data.wave.sin.push(0);
for(;this._data.wave.sin.length>this._data.wave.cos.length;)this._data.wave.cos.push(0);for(c=0;c<this._data.wave.sin.length;c++)this._data.wave.sin[c]||(this._data.wave.sin[c]=0),this._data.wave.cos[c]||(this._data.wave.cos[c]=0);return this._data.wave}null==d&&(this._data.wave=c);switch(d){case "sin":this._data.wave.sin=c;break;case "cos":this._data.wave.cos=c}};c.waveElement=function(c,d,e){if(null==e)return this._data.wave[c][d];this._data.wave[c][d]=e};c.resolution=function(c){c=void 0===c?null:
c;if(null==c)return this._data.resolution;this._data.resolution=c};c.updateBackground=function(){r.viewbox({bottom:-1.1,top:1.1});r.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});r.verticalMarkings({points:[0,.25,.5,.75],printText:!0});r.drawBackground()};c.draw=function(){for(var c=[],d,e=0;e<=this._data.resolution;e++){for(var f=d=0;f<this._data.wave.sin.length;f++)this._data.wave.sin[f]||(this._data.wave.sin[f]=0),d+=Math.sin(e/this._data.resolution*f*Math.PI*2)*this._data.wave.sin[f];
for(f=0;f<this._data.wave.cos.length;f++)this._data.wave.cos[f]||(this._data.wave.cos[f]=0),d+=Math.cos(e/this._data.resolution*f*Math.PI*2)*this._data.wave.cos[f];c.push(d)}r.draw(c)};c.reset=function(){this.wave({sin:[],cos:[]});this.resolution(500);this.updateBackground()};c.reset();return c};this.grapherCanvas=function(c,f,d,e,g,k,h,n,l,m){c=void 0===c?"grapherCanvas":c;k=void 0===k?["stroke:rgba(0,255,0,1); stroke-width:0.75; stroke-linecap:round;","stroke:rgba(255,255,0,1); stroke-width:0.75; stroke-linecap:round;"]:
k;n=void 0===n?"stroke:rgba(0,100,0,1); stroke-width:1;":n;l=void 0===l?"fill:rgba(0,150,0,1); font-size:5; font-family:Helvetica;":l;m=void 0===m?"fill:rgba(50,50,50,1)":m;var p={bottom:-1,top:1,left:0,right:1},r={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.995,y:.06},printText:!1},t={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.0025,y:.04},printText:!1},v=[];h=k.map(function(c){return __globals.utility.element.styleExtractor(c)});k=h.map(function(c){return c.stroke});
var u=h.map(function(c){return 10*c["stroke-width"]});h=__globals.utility.element.styleExtractor(l);l=12*h["font-size"]+"px "+h["font-family"];h=__globals.utility.element.styleExtractor(n);n=h.stroke;var w=10*h["stroke-width"];h=__globals.utility.element.styleExtractor(m);m=h.fill;f=__globals.utility.misc.elementMaker("g",c,{x:f,y:d});var q=__globals.utility.misc.elementMaker("canvas",c,{width:e,height:g,resolution:10});f.appendChild(q.element);f._test=function(){this.drawBackground();this.draw([0,
-2,1,-1,2],[0,.25,.5,.75,1]);this.draw([0,1],void 0,1)};f.backgroundLineThickness=function(c){if(null==c)return w;w=c};f.foregroundLineThickness=function(c){if(null==c)return foregroundLineThickness;foregroundLineThickness=c};f.viewbox=function(c){if(null==c)return p;void 0!=c.bottom&&(p.bottom=c.bottom);void 0!=c.top&&(p.top=c.top);void 0!=c.left&&(p.left=c.left);void 0!=c.right&&(p.right=c.right)};f.horizontalMarkings=function(c){if(null==c)return r;void 0!=c.points&&(r.points=c.points);void 0!=
c.printingValues&&(r.printingValues=c.printingValues);void 0!=c.textPosition&&(r.textPosition=c.textPosition);void 0!=c.printText&&(r.printText=c.printText)};f.verticalMarkings=function(c){if(null==c)return t;void 0!=c.points&&(t.points=c.points);void 0!=c.printingValues&&(t.printingValues=c.printingValues);void 0!=c.textPosition&&(t.textPosition=c.textPosition);void 0!=c.printText&&(t.printText=c.printText)};f.drawBackground=function(){q.context.fillStyle=m;q.context.fillRect(q.c(0),q.c(0),q.c(e),
q.c(g));for(var c=0;c<r.points.length;c++){var d=__globals.utility.math.relativeDistance(g,p.bottom,p.top,r.points[c]);q.context.strokeStyle=n;q.context.lineWidth=w;q.context.beginPath();q.context.moveTo(0,q.c(d));q.context.lineTo(q.c(e),q.c(d));q.context.closePath();q.context.stroke();r.printText&&(q.context.fillStyle=n,q.context.font=l,q.context.fillText(r.printingValues&&void 0!=r.printingValues[c]?r.printingValues[c]:r.points[c],q.c(void 0==r.textPosition||void 0==r.textPosition.x?.5:__globals.utility.math.relativeDistance(e,
p.left,p.right,"number"==typeof r.textPosition.x?r.textPosition.x:r.textPosition.x[c])),q.c(void 0==r.textPosition||void 0==r.textPosition.y?d+1.75:g-__globals.utility.math.relativeDistance(g,p.bottom,p.top,r.points[c]-("number"==typeof r.textPosition.y?r.textPosition.y:r.textPosition.y[c])))))}for(c=0;c<t.points.length;c++){var f=__globals.utility.math.relativeDistance(e,p.left,p.right,t.points[c]);q.context.strokeStyle=n;q.context.lineWidth=w;q.context.beginPath();q.context.moveTo(q.c(f),0);q.context.lineTo(q.c(f),
q.c(g));q.context.closePath();q.context.stroke();t.printText&&(q.context.fillStyle=n,q.context.font=l,q.context.fillText(t.printingValues&&void 0!=t.printingValues[c]?t.printingValues[c]:t.points[c],q.c(void 0==t.textPosition||void 0==t.textPosition.x?.5:__globals.utility.math.relativeDistance(e,p.left,p.right,t.points[c]-("number"==typeof t.textPosition.x?t.textPosition.x:t.textPosition.x[c]))),q.c(void 0==t.textPosition||void 0==t.textPosition.y?d:__globals.utility.math.relativeDistance(g,p.bottom,
p.top,"number"==typeof t.textPosition.y?t.textPosition.y:t.textPosition.y[c]))))}q.print()};f.draw=function(c,d,f){v[void 0===f?0:f]={x:d,y:c};this.drawBackground();for(f=0;f<v.length;f++)if(void 0!=v[f]){c=v[f].y;d=v[f].x;for(var h=0;h<c.length-1;h++){var l=__globals.utility.math.lineCorrecter({x1:void 0==d?e/(c.length-1)*(h+0):__globals.utility.math.relativeDistance(e,p.left,p.right,d[h+0]),x2:void 0==d?e/(c.length-1)*(h+1):__globals.utility.math.relativeDistance(e,p.left,p.right,d[h+1]),y1:g-__globals.utility.math.relativeDistance(g,
p.bottom,p.top,c[h+0],!0),y2:g-__globals.utility.math.relativeDistance(g,p.bottom,p.top,c[h+1],!0)},g,e);l&&(q.context.strokeStyle=void 0==k[f]?k[0]:k[f],q.context.lineWidth=void 0==u[f]?u[0]:u[f],q.context.beginPath(),q.context.moveTo(q.c(l.x1),q.c(l.y1)),q.context.lineTo(q.c(l.x2),q.c(l.y2)),q.context.closePath(),q.context.stroke())}}q.print()};return f};this.grapherSVG=function(c,f,d,e,g,k,h,n,l,m){k=void 0===k?["stroke:rgba(0,255,0,1); stroke-width:0.75; stroke-linecap:round;","stroke:rgba(255,255,0,1); stroke-width:0.75; stroke-linecap:round;"]:
k;n=void 0===n?"stroke:rgba(0,100,0,1); stroke-width:1;":n;l=void 0===l?"fill:rgba(0,150,0,1); font-size:5; font-family:Helvetica;":l;m=void 0===m?"fill:rgba(50,50,50,1)":m;var p={bottom:-1,top:1,left:0,right:1},r={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.995,y:.06},printText:!1},t={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.0025,y:.04},printText:!1},v=2,u=2,w=__globals.utility.misc.elementMaker("g",void 0===c?"grapherSVG":c,{x:f,y:d});c=
__globals.utility.misc.elementMaker("rect","backing",{width:e,height:g,style:m});w.appendChild(c);var q=__globals.utility.misc.elementMaker("g","backgroundElements",{});w.appendChild(q);var y=[];w._test=function(){this.drawBackground();this.draw([0,-2,1,-1,2],[0,.25,.5,.75,1]);this.draw([0,1],void 0,1)};w.backgroundLineThickness=function(c){if(null==c)return v;v=c};w.foregroundLineThickness=function(c){if(null==c)return u;u=c};w.viewbox=function(c){if(null==c)return p;void 0!=c.bottom&&(p.bottom=
c.bottom);void 0!=c.top&&(p.top=c.top);void 0!=c.left&&(p.left=c.left);void 0!=c.right&&(p.right=c.right)};w.horizontalMarkings=function(c){if(null==c)return r;void 0!=c.points&&(r.points=c.points);void 0!=c.printingValues&&(r.printingValues=c.printingValues);void 0!=c.textPosition&&(r.textPosition=c.textPosition);void 0!=c.printText&&(r.printText=c.printText)};w.verticalMarkings=function(c){if(null==c)return t;void 0!=c.points&&(t.points=c.points);void 0!=c.printingValues&&(t.printingValues=c.printingValues);
void 0!=c.textPosition&&(t.textPosition=c.textPosition);void 0!=c.printText&&(t.printText=c.printText)};w.drawBackground=function(){q.innerHTML="";for(var c=0;c<r.points.length;c++){var d=g-__globals.utility.math.relativeDistance(g,p.bottom,p.top,r.points[c]);q.append(__globals.utility.misc.elementMaker("line","horizontalMarkings_line_"+c,{y1:d,x2:e,y2:d,style:n}));r.printText&&q.append(__globals.utility.misc.elementMaker("text","horizontalMarkings_text_"+r.points[c],{x:void 0==r.textPosition||void 0==
r.textPosition.x?.5:__globals.utility.math.relativeDistance(e,p.left,p.right,"number"==typeof r.textPosition.x?r.textPosition.x:r.textPosition.x[c]),y:void 0==r.textPosition||void 0==r.textPosition.y?d:g-__globals.utility.math.relativeDistance(g,p.bottom,p.top,r.points[c]-("number"==typeof r.textPosition.y?r.textPosition.y:r.textPosition.y[c])),text:r.printingValues&&void 0!=r.printingValues[c]?r.printingValues[c]:r.points[c],style:l}))}for(c=0;c<t.points.length;c++){var f=__globals.utility.math.relativeDistance(e,
p.left,p.right,t.points[c]);q.append(__globals.utility.misc.elementMaker("line","verticalMarkings_line_"+c,{x1:f,x2:f,y2:g,style:n}));t.printText&&q.append(__globals.utility.misc.elementMaker("text","verticalMarkings_text_"+t.points[c],{x:void 0==t.textPosition||void 0==t.textPosition.x?.5:__globals.utility.math.relativeDistance(e,p.left,p.right,t.points[c]-("number"==typeof t.textPosition.x?t.textPosition.x:t.textPosition.x[c])),y:void 0==t.textPosition||void 0==t.textPosition.y?d:__globals.utility.math.relativeDistance(g,
p.bottom,p.top,"number"==typeof t.textPosition.y?t.textPosition.y:t.textPosition.y[c]),text:t.printingValues&&void 0!=t.printingValues[c]?t.printingValues[c]:t.points[c],style:l}))}};w.draw=function(c,d,f){f=void 0===f?0:f;void 0==y[f]?(y[f]=__globals.utility.misc.elementMaker("g","foregroundElements_"+f,{}),w.appendChild(y[f])):y[f].innerHTML="";for(var h=0;h<c.length-1;h++){var l=__globals.utility.math.lineCorrecter({x1:void 0==d?e/(c.length-1)*(h+0):__globals.utility.math.relativeDistance(e,p.left,
p.right,d[h+0]),x2:void 0==d?e/(c.length-1)*(h+1):__globals.utility.math.relativeDistance(e,p.left,p.right,d[h+1]),y1:g-__globals.utility.math.relativeDistance(g,p.bottom,p.top,c[h+0],!0),y2:g-__globals.utility.math.relativeDistance(g,p.bottom,p.top,c[h+1],!0)},g,e);l&&y[f].append(__globals.utility.misc.elementMaker("line",null,{x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2,style:void 0==k[f]?k[0]:k[f]}))}};return w};this.label=function(c,f,d,e,g,k){c=void 0===c?"label":c;g=void 0===g?"fill:rgba(0,0,0,1); font-size:3; font-family:Helvetica;":
g;k=void 0===k?0:k;f=__globals.utility.misc.elementMaker("g",c,{x:f,y:d});var h=__globals.utility.misc.elementMaker("text",c,{text:e,angle:k,style:g});f.appendChild(h);f.text=function(c){c=void 0===c?null:c;if(null==c)return h.innerHTML;h.innerHTML=c};return f};this.level=function(c,f,d,e,g,k,h,n){c=void 0===c?"level":c;h=void 0===h?"fill:rgb(10,10,10)":h;n=void 0===n?["fill:rgb(250,250,250)","fill:rgb(200,200,200)"]:n;Array.apply(null,Array(n.length)).map(Number.prototype.valueOf,0);c=__globals.utility.misc.elementMaker("g",
c,{x:f,y:d});var l=[];for(f=0;f<n.length;f++)d=void 0!=n[f]?n[f]:n[0],d=__globals.utility.misc.elementMaker("rect","movingRect_"+f,{x:(-k*Math.sin(e)+g*Math.cos(e)).toFixed(10),y:(k*Math.cos(e)+g*Math.sin(e)).toFixed(10),width:g,height:0,angle:e+Math.PI,style:d}),l.push(d),c.prepend(d);e=__globals.utility.misc.elementMaker("rect","movingRect_"+f,{width:g,height:k,angle:e,style:h});c.prepend(e);c.set=function(c,d){if(null==c)return value;c=1<c?1:c;value=0>c?0:c;l[void 0===d?0:d].height.baseVal.valueInSpecifiedUnits=
k*value};c.getLevelStyle=function(c){return l[c].style};return c};this.meter_level=function(c,f,d,e,g,k,h,n,l,m){function p(c){return __globals.utility.misc.elementMaker("path",null,{path:[{x:g,y:c-.1},{x:g-g/4,y:c-.1},{x:g-g/4,y:c+.1},{x:g,y:c+.1}],lineType:"L",style:m})}h=void 0===h?[.125,.25,.375,.5,.625,.75,.875]:h;n=void 0===n?"fill:rgb(10,10,10)":n;l=void 0===l?["fill:rgba(250,250,250,1);","fill:rgb(100,100,100);"]:l;m=void 0===m?"fill:rgba(220,220,220,1); stroke:none; font-size:1px; font-family:Courier New;":
m;var r=0,t=0;c=__globals.utility.misc.elementMaker("g",void 0===c?"meter_level":c,{x:f,y:d});l[0]+="transition: height 0s;";l[1]+="transition: height 0.01s;";var v=__globals.utility.misc.elementMaker("level","mainlevel",{width:g,height:k,angle:e,style:{backing:n,levels:l}});c.append(v);for(e=0;e<h.length;e++)c.append(p(k*(1-h[e]))),c.append(__globals.utility.misc.elementMaker("label",null,{y:k*(1-h[e])+.3,text:h[e],style:m}));setInterval(function(){v.set(t,0);0<r&&(r-=.0025);v.set(r,1);t>r&&(r=t)},
1E3/30);c.set=function(c){mostRecentSetting_slow=t=c};return c};this.rastorDisplay=function(c,f,d,e,g,k,h,n,l){function m(){for(var c=0;c<k;c++)for(var d=0;d<h;d++)__globals.utility.element.setStyle(r[c][d],"fill:rgb("+255*t[c][d][0]+","+255*t[c][d][1]+","+255*t[c][d][2]+")")}n=void 0===n?1:n;l=void 0===l?1:l;c=__globals.utility.misc.elementMaker("g",void 0===c?"rastorDisplay":c,{x:f,y:d});var p=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,style:"fill:rgb(0,0,0)"});c.appendChild(p);
var r=[],t=[];e/=k;g/=h;for(f=0;f<k;f++){var v=[],u=[];for(d=0;d<h;d++)p=__globals.utility.misc.elementMaker("rect",null,{x:f*e+n/2,y:d*g+l/2,width:e-n,height:g-l,style:"fill:rgb(0,0,0)"}),v.push(p),u.push([0,0,0]),c.appendChild(p);r.push(v);t.push(u)}c.get=function(c,d){return t[c][d]};c.set=function(c,d,e){t[c][d]=e;m()};c.import=function(c){for(var d=0;d<k;d++)for(var e=0;e<h;e++)this.set(d,e,c[d][e]);m()};c.export=function(){return t};c.setAll=function(c){for(var d=0;d<k;d++)for(var e=0;e<h;e++)this.set(d,
e,c)};c.test=function(){this.setAll([1,1,1]);this.set(1,1,[1,.5,.5]);this.set(2,2,[.5,1,.5]);this.set(3,3,[.5,.5,1]);this.set(4,4,[1,.5,1]);m()};return c};this.readout_sixteenSegmentDisplay=function(c,f,d,e,g,k,h,n,l){h=void 0===h?"fill:rgb(0,0,0)":h;n=void 0===n?"fill:rgb(200,200,200)":n;l=void 0===l?"fill:rgb(20,20,20)":l;var m="",p=null;c=__globals.utility.misc.elementMaker("g",void 0===c?"readout_sixteenSegmentDisplay":c,{x:f,y:d});var r=[];for(f=0;f<k;f++)d=__globals.utility.misc.elementMaker("sixteenSegmentDisplay",
f,{x:e/k*f,width:e/k,height:g,style:{background:h,glow:n,dim:l}}),c.append(d),r.push(d);c.test=function(){this.text("Look at all the text I've got here! 1234567890 \\/<>()[]{}*!?\"#_,.");this.print("r2lSweep")};c.text=function(c){if(null==c)return m;m=c};c.print=function(c){clearInterval(p);switch(c){case "smart":m.length>r.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var d=0;p=setInterval(function(){for(var c=r.length-1;0<=c;c--)r[c].enterCharacter(m[d-(r.length-1-c)]);
d++;d>r.length+m.length-1&&(d=0)},100);break;default:for(c=0;c<r.length;c++)r[c].enterCharacter(m[c])}};return c};this.sevenSegmentDisplay=function(c,f,d,e,g,k,h,n){k=void 0===k?"fill:rgb(0,0,0)":k;h=void 0===h?"fill:rgb(200,200,200)":h;n=void 0===n?"fill:rgb(20,20,20)":n;var l=e/8,m=e/8,p=[{x:1*m+l,y:1*m+l},{x:.5*m+l,y:.5*m+l},{x:1*m+l,y:0*m+l},{x:0*m+l,y:1*m+l}],r=[{x:e-1*m-l,y:0*m+l},{x:e-.5*m-l,y:.5*m+l},{x:e-1*m-l,y:1*m+l},{x:e-0*m-l,y:1*m+l}],t=[{x:1*m+l,y:.5*g-1*m+.5*l},{x:.5*m+l,y:.5*g-.5*
m+.5*l},{x:1*m+l,y:.5*g-0*m+.5*l},{x:0*m+l,y:.5*g-1*m+.5*l},{x:0*m+l,y:.5*g-0*m+.5*l}],v=[{x:e-1*m-l,y:.5*g-0*m+.5*l},{x:e-.5*m-l,y:.5*g-.5*m+.5*l},{x:e-1*m-l,y:.5*g-1*m+.5*l},{x:e-0*m-l,y:.5*g-1*m+.5*l},{x:e-0*m-l,y:.5*g-0*m+.5*l}],u=[{x:1*m+l,y:g-1*m-l},{x:.5*m+l,y:g-.5*m-l},{x:1*m+l,y:g-0*m-l},{x:0*m+l,y:g-1*m-l}];l=[{x:e-1*m-l,y:g-0*m-l},{x:e-.5*m-l,y:g-.5*m-l},{x:e-1*m-l,y:g-1*m-l},{x:e-0*m-l,y:g-1*m-l}];c=__globals.utility.misc.elementMaker("g",void 0===c?"sevenSegmentDisplay":c,{x:f,y:d});
e=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,style:k});c.appendChild(e);var w=[];p=[[p[0],r[2],r[1],r[0],p[2],p[1]],[p[1],p[3],t[3],t[1],t[0],p[0]],[r[1],r[3],v[3],v[1],v[2],r[2]],[t[0],v[2],v[1],v[0],t[2],t[1]],[t[1],t[4],u[3],u[1],u[0],t[2]],[v[1],v[4],l[3],l[1],l[2],v[0]],[u[0],l[2],l[1],l[0],u[2],u[1]]];for(r=0;r<p.length;r++)t={segment:__globals.utility.misc.elementMaker("path","arc",{path:p[r],lineType:"L",style:n}),state:!1},w.push(t),c.append(t.segment);c.set=function(c,
d){(w[c].state=d)?__globals.utility.element.setStyle(w[c].segment,h):__globals.utility.element.setStyle(w[c].segment,n)};c.get=function(c){return w[c].state};c.clear=function(){for(var c=0;c<w.length;c++)this.set(c,!1)};c.enterCharacter=function(c){switch(c){case "0":c=[1,1,1,0,1,1,1];break;case "1":c=[0,0,1,0,0,1,0];break;case "2":c=[1,0,1,1,1,0,1];break;case "3":c=[1,0,1,1,0,1,1];break;case "4":c=[0,1,1,1,0,1,0];break;case "5":c=[1,1,0,1,0,1,1];break;case "6":c=[1,1,0,1,1,1,1];break;case "7":c=
[1,0,1,0,0,1,0];break;case "8":c=[1,1,1,1,1,1,1];break;case "9":c=[1,1,1,1,0,1,1];break;default:c=[0,0,0,0,0,0,0]}for(var d=0;d<c.length;d++)this.set(d,1==c[d])};c.test=function(){this.clear();this.enterCharacter("9")};return c};this.sixteenSegmentDisplay=function(c,f,d,e,g,k,h,n){k=void 0===k?"fill:rgb(0,0,0)":k;h=void 0===h?"fill:rgb(200,200,200)":h;n=void 0===n?"fill:rgb(20,20,20)":n;var l=e/8,m=e/8,p=[{x:.5*m+l,y:.5*m+l},{x:1*m+l,y:0*m+l},{x:0*m+l,y:1*m+l},{x:1*m+l,y:1*m+l},{x:1.75*m+l,y:1*m+
l},{x:1*m+l,y:1.75*m+l}],r=[{x:e/2,y:.5*m+l},{x:e/2-.5*m,y:1*m+l},{x:e/2+.5*m,y:1*m+l},{x:e/2-.5*m,y:0*m+l},{x:e/2+.5*m,y:0*m+l}],t=[{x:e-.5*m-l,y:.5*m+l},{x:e-1*m-l,y:0*m+l},{x:e-0*m-l,y:1*m+l},{x:e-1*m-l,y:1*m+l},{x:e-1*m-l,y:1.75*m+l},{x:e-1.75*m-l,y:1*m+l}],v=[{x:0*m+l,y:.5*g-.5*m},{x:1*m+l,y:.5*g-.5*m},{x:.5*m+l,y:.5*g-0*m},{x:0*m+l,y:.5*g+.5*m},{x:1*m+l,y:.5*g+.5*m}],u=[{x:e/2,y:g/2},{x:e/2-.5*m,y:.5*m+g/2},{x:e/2-.25*m,y:1.25*m+g/2},{x:e/2-1*m,y:.5*m+g/2},{x:e/2+.5*m,y:.5*m+g/2},{x:e/2+.5*
m,y:1.75*m+g/2},{x:e/2+1*m,y:.5*m+g/2},{x:e/2-.5*m,y:.5*-m+g/2},{x:e/2-.25*m,y:1.25*-m+g/2},{x:e/2-1*m,y:.25*-m+g/2},{x:e/2+.5*m,y:.5*-m+g/2},{x:e/2+.5*m,y:1.75*-m+g/2},{x:e/2+1*m,y:.25*-m+g/2}],w=[{x:e-1*m-l,y:.5*g-.5*m},{x:e-0*m-l,y:.5*g-.5*m},{x:e-.5*m-l,y:.5*g-0*m},{x:e-1*m-l,y:.5*g+.5*m},{x:e-0*m-l,y:.5*g+.5*m}],q=[{x:.5*m+l,y:g-.5*m-l},{x:0*m+l,y:g-1*m-l},{x:1*m+l,y:g-0*m-l},{x:1*m+l,y:g-1*m-l},{x:1*m+l,y:g-1.75*m-l},{x:1.75*m+l,y:g-1*m-l}],y=[{x:e/2-.5*m,y:g-1*m-l},{x:e/2+.5*m,y:g-1*m-l},{x:e/
2,y:g-.5*m-l},{x:e/2-.5*m,y:g-0*m-l},{x:e/2+.5*m,y:g-0*m-l}];l=[{x:e-.5*m-l,y:g-.5*m-l},{x:e-0*m-l,y:g-1*m-l},{x:e-1*m-l,y:g-0*m-l},{x:e-1*m-l,y:g-1*m-l},{x:e-1*m-l,y:g-1.75*m-l},{x:e-1.75*m-l,y:g-1*m-l}];c=__globals.utility.misc.elementMaker("g",void 0===c?"sixteenSegmentDisplay":c,{x:f,y:d});e=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,style:k});c.appendChild(e);var z=[];p=[[p[1],p[0],p[3],r[1],r[0],r[3]],[r[4],r[0],r[2],t[3],t[0],t[1]],[p[0],p[2],v[0],v[2],v[1],p[3]],[p[4],
p[3],p[5],u[9],u[7],u[8]],[r[0],r[1],u[7],u[0],u[10],r[2]],[t[4],t[3],t[5],u[11],u[10],u[12]],[t[0],t[2],w[1],w[2],w[0],t[3]],[v[4],v[2],v[1],u[7],u[0],u[1]],[w[3],w[2],w[0],u[10],u[0],u[4]],[q[0],q[1],v[3],v[2],v[4],q[3]],[q[4],q[3],q[5],u[2],u[1],u[3]],[y[0],y[2],y[1],u[4],u[0],u[1]],[l[4],l[3],l[5],u[5],u[4],u[6]],[l[3],w[3],w[2],w[4],l[1],l[0]],[q[2],q[0],q[3],y[0],y[2],y[3]],[l[2],l[0],l[3],y[1],y[2],y[4]]];for(r=0;r<p.length;r++)t={segment:__globals.utility.misc.elementMaker("path","arc",{path:p[r],
lineType:"L",style:n}),state:!1},z.push(t),c.append(t.segment);c.set=function(c,d){(z[c].state=d)?__globals.utility.element.setStyle(z[c].segment,h):__globals.utility.element.setStyle(z[c].segment,n)};c.get=function(c){return z[c].state};c.clear=function(){for(var c=0;c<z.length;c++)this.set(c,!1)};c.enterCharacter=function(c){switch(c){case "!":c=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":c=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":c=
[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":c=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":c=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':c=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":c=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":c=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":c=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":c=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":c=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":c=
[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":c=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":c=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":c=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":c=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":c=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":c=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":c=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":c=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":c=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":c=
[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":c=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":c=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":c=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":c=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":c=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":c=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":c=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":c=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":c=[1,1,0,0,1,0,1,0,1,0,0,1,
0,1,1,1];break;case "c":case "C":c=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":c=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":c=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":c=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":c=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":c=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":c=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":c=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":c=
[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":c=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":c=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":c=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":c=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":c=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":c=[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":c=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":c=[1,1,1,0,0,0,0,1,1,0,
0,0,0,1,1,1];break;case "t":case "T":c=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":c=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":c=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":c=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":c=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":c=[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":c=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":c=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:c=
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}for(var d=0;d<c.length;d++)this.set(d,1==c[d])};c.test=function(){this.clear();var c=0;setInterval(function(d){d.enterCharacter("0123456789abcdefghijklmnopqrstuvwxyz".split("")[c++]);36<c&&(c=0)},500,this)};return c}};this.control=new function(){this.button_rect=function(c,f,d,e,g,k,h,n,l,m){k=void 0===k?0:k;h=void 0===h?"fill:rgba(200,200,200,1)":h;n=void 0===n?"fill:rgba(220,220,220,1)":n;l=void 0===l?"fill:rgba(180,180,180,1)":l;m=void 0===m?"fill:rgba(220,200,220,1)":
m;c=__globals.utility.misc.elementMaker("g",void 0===c?"button_rect":c,{x:f,y:d});var p=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,angle:k,style:h});c.appendChild(p);p.onmouseenter=function(){__globals.utility.element.setStyle(this,n)};p.onmouseleave=function(){__globals.utility.element.setStyle(this,h)};p.onmousedown=function(){__globals.utility.element.setStyle(this,l)};p.onmouseup=function(){this.onmouseleave()};p.glow=function(){__globals.utility.element.setStyle(this,m)};
c.onmouseup=function(){};c.onmousedown=function(){};c.onmouseenter=function(){};c.onmouseleave=function(){};c.onmousemove=function(){};c.onclick=function(){};c.ondblclick=function(){};c.click=function(c){c=void 0===c?!1:c;this.onclick();this.onmousedown();if(c)p.glow();else p.onmousedown();setTimeout(function(c){p.onmouseup();c.onmouseup()},250,this)};c.hover=function(){this.onmouseenter();p.onmouseenter()};c.unhover=function(){this.onmouseleave();p.onmouseleave()};return c};this.checkbox_rect=function(c,
f,d,e,g,k,h,n,l,m){function p(){r._checked?__globals.utility.element.setStyle(v,r.styles.check):__globals.utility.element.setStyle(v,r.styles.uncheck);__globals.utility.element.setStyle(t,r.styles.backing)}h=void 0===h?"fill:rgba(150,150,150,1)":h;n=void 0===n?"fill:rgba(200,200,200,1)":n;l=void 0===l?"fill:rgba(220,220,220,1)":l;m=void 0===m?"fill:rgba(220,220,220,1)":m;var r=__globals.utility.misc.elementMaker("g",void 0===c?"checkbox_rect":c,{x:f,y:d,r:void 0===k?0:k});r._checked=!1;r.styles={check:h,
uncheck:"fill:rgba(0,0,0,0)",backing:n};var t=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,style:n});r.appendChild(t);var v=__globals.utility.misc.elementMaker("rect",null,{x:.1*e,y:.1*g,width:.8*e,height:.8*g,style:r.styles.uncheck});r.appendChild(v);r.get=function(){return r._checked};r.set=function(c,d){d=void 0===d?!0:d;r._checked=c;p();if(d&&this.onchange)this.onchange(c)};r.light=function(c){c?(r.styles.check=l,r.styles.backing=m):(r.styles.check=h,r.styles.backing=n);p()};
r.onchange=function(){};r.onclick=function(c){r.set(!r.get())};return r};this.dial_continuous=function(c,f,d,e,g,k,h,n,l,m,p,r,t,v,u){g=void 0===g?3*Math.PI/4:g;k=void 0===k?1.5*Math.PI:k;h=void 0===h?"fill:rgba(175,175,175,1)":h;n=void 0===n?"fill:rgba(50,50,50,1)":n;l=void 0===l?"fill:rgba(250,100,100,1)":l;m=void 0===m?"fill:rgba(175,175,175,1)":m;p=void 0===p?"fill:rgba(254,255,219,1)":p;r=void 0===r?"fill:rgba(250,100,100,1)":r;t=void 0===t?1.35:t;v=void 0===v?"fill:none; stroke:none;":v;u=void 0===
u?"fill:none; stroke:none;":u;var w=__globals.utility.misc.elementMaker("g",void 0===c?"dial_continuous":c,{x:f,y:d});w._value=0;w._data={mux:4*e};c=[];for(f=0;5>f;f++)d=__globals.utility.math.polar2cartesian(g+k/5*f,e*t),c.push(d),d=__globals.utility.math.polar2cartesian(g+k/5*(f+.5),1.11*e*t),c.push(d);d=__globals.utility.math.polar2cartesian(g+k,e*t);c.push(d);var q=__globals.utility.misc.elementMaker("path","arc",{path:c,lineType:"Q",style:v});w.appendChild(q);var y=__globals.utility.misc.elementMaker("circle",
"slot",{r:1.1*e,style:n});w.appendChild(y);var z=__globals.utility.misc.elementMaker("circle","slot",{r:e,style:h});w.appendChild(z);t=e/5;var x=__globals.utility.misc.elementMaker("rect","needle",{height:t,width:e,style:l});x.x.baseVal.valueInSpecifiedUnits=e/3;x.y.baseVal.valueInSpecifiedUnits=-t/2;w.appendChild(x);w.get=function(){return this._value};w.set=function(c,d,e){d=void 0===d?!1:d;e=void 0===e?!0:e;c=1<c?1:c;this._value=c=0>c?0:c;if(e&&this.onchange)try{this.onchange(c)}catch(S){console.error("Error with dial_continuous:onchange\n",
S)}if(e&&!d&&this.onrelease)try{this.onrelease(c)}catch(S){console.error("Error with dial_continuous:onrelease\n",S)}this.children.needle.rotation(g+k*c)};w.smoothSet=function(c,d,e,f){f=void 0===f?!0:f;var g=__globals.audio.context.currentTime,h=value,k=__globals.utility.math.curvePoint.linear;switch(e){case "linear":k=__globals.utility.math.curvePoint.linear;break;case "sin":k=__globals.utility.math.curvePoint.sin;break;case "cos":k=__globals.utility.math.curvePoint.cos;break;case "exponential":k=
__globals.utility.math.curvePoint.exponential;break;case "s":k=__globals.utility.math.curvePoint.s}w.smoothSet.interval=setInterval(function(){var e=(__globals.audio.context.currentTime-g)/d;1<e&&(e=1);w.set(k(e,h,c),!0,f);__globals.audio.context.currentTime-g>=d&&clearInterval(w.smoothSet.interval)},1E3/30)};w.glow=function(c){c?(__globals.utility.element.setStyle(q,u),__globals.utility.element.setStyle(y,p),__globals.utility.element.setStyle(z,m),__globals.utility.element.setStyle(x,r)):(__globals.utility.element.setStyle(q,
v),__globals.utility.element.setStyle(y,n),__globals.utility.element.setStyle(z,h),__globals.utility.element.setStyle(x,l))};w.onchange=function(){};w.onrelease=function(){};w.ondblclick=function(){this.set(.5)};w.onwheel=function(c){c=__globals.mouseInteraction.wheelInterpreter(c.deltaY);var d=__globals.utility.workspace.getGlobalScale(w);this.set(this.get()-c/(10*d))};w.onmousedown=function(c){__globals.svgElement.onmousemove_old=__globals.svgElement.onmousemove;__globals.svgElement.onmouseleave_old=
__globals.svgElement.onmouseleave;__globals.svgElement.onmouseup_old=__globals.svgElement.onmouseup;__globals.svgElement.tempRef=this;__globals.svgElement.tempRef._data.initialValue=this.get();__globals.svgElement.tempRef._data.initialY=c.y;__globals.svgElement.tempRef._data.mux=__globals.svgElement.tempRef._data.mux;__globals.svgElement.onmousemove=function(c){var d=__globals.svgElement.tempRef._data.mux,e=__globals.svgElement.tempRef._data.initialValue;c=c.y-__globals.svgElement.tempRef._data.initialY;
var f=__globals.utility.workspace.getGlobalScale(w);__globals.svgElement.tempRef.set(e-c/(f*d),!0)};__globals.svgElement.onmouseup=function(){this.tempRef.set(this.tempRef.get(),!1);delete this.tempRef;__globals.svgElement.onmousemove=__globals.svgElement.onmousemove_old;__globals.svgElement.onmouseleave=__globals.svgElement.onmouseleave_old;__globals.svgElement.onmouseup=__globals.svgElement.onmouseup_old;__globals.svgElement.onmousemove_old=null;__globals.svgElement.onmouseleave_old=null;__globals.svgElement.onmouseup_old=
null};__globals.svgElement.onmouseleave=__globals.svgElement.onmouseup;__globals.svgElement.onmousemove(c)};w.set(0);return w};this.dial_discrete=function(c,f,d,e,g,k,h,n,l,m,p,r,t,v,u,w){g=void 0===g?5:g;k=void 0===k?3*Math.PI/4:k;h=void 0===h?1.5*Math.PI:h;n=void 0===n?"fill:rgba(175,175,175,1)":n;l=void 0===l?"fill:rgba(50,50,50,1)":l;m=void 0===m?"fill:rgba(250,100,100,1)":m;p=void 0===p?"fill:rgba(175,175,175,1)":p;r=void 0===r?"fill:rgba(254,255,219,1)":r;t=void 0===t?"fill:rgba(250,100,100,1)":
t;v=void 0===v?1.35:v;u=void 0===u?"fill:none; stroke:none;":u;w=void 0===w?"fill:none; stroke:none;":w;var q=__globals.utility.misc.elementMaker("g",void 0===c?"dial_discrete":c,{x:f,y:d});q._value=0;q._selection=0;q._data={optionCount:g,mux:4*e};c=[];for(f=0;5>f;f++)d=__globals.utility.math.polar2cartesian(k+h/5*f,e*v),c.push(d),d=__globals.utility.math.polar2cartesian(k+h/5*(f+.5),1.11*e*v),c.push(d);d=__globals.utility.math.polar2cartesian(k+h,e*v);c.push(d);var y=__globals.utility.misc.elementMaker("path",
"arc",{path:c,lineType:"Q",style:u});q.appendChild(y);var z=__globals.utility.misc.elementMaker("circle","slot",{r:1.1*e,style:l});q.appendChild(z);var x=__globals.utility.misc.elementMaker("circle","slot",{r:e,style:n});q.appendChild(x);v=e/5;var E=__globals.utility.misc.elementMaker("rect","needle",{height:v,width:e,style:m});E.x.baseVal.valueInSpecifiedUnits=e/3;E.y.baseVal.valueInSpecifiedUnits=-v/2;q.appendChild(E);q.select=function(c,d,e){c=void 0===c?null:c;d=void 0===d?!0:d;e=void 0===e?!0:
e;if(null==c)return this._selection;c=c>this._data.optionCount-1?this._data.optionCount-1:c;c=0>c?0:c;if(this._selection!=c){this._selection=c;this._set(c/(this._data.optionCount-1));if(e&&this.onchange)this.onchange(c);if(e&&!d&&this.onrelease)this.onrelease(value)}};q._get=function(){return this._value};q._set=function(c){c=1<c?1:c;this._value=c=0>c?0:c;this.children.needle.rotation(k+h*c)};q.glow=function(c){c?(__globals.utility.element.setStyle(y,w),__globals.utility.element.setStyle(z,r),__globals.utility.element.setStyle(x,
p),__globals.utility.element.setStyle(E,t)):(__globals.utility.element.setStyle(y,u),__globals.utility.element.setStyle(z,l),__globals.utility.element.setStyle(x,n),__globals.utility.element.setStyle(E,m))};q.onchange=function(){};q.onrelease=function(){};q.ondblclick=function(){this.select(Math.floor(g/2))};q.onwheel=function(c){c=__globals.mouseInteraction.wheelInterpreter(c.deltaY);var d=__globals.utility.workspace.getGlobalScale(q);q.onwheel.acc||(q.onwheel.acc=0);q.onwheel.acc+=c/d;1<=Math.abs(q.onwheel.acc)&&
(this.select(this.select()-1*Math.sign(q.onwheel.acc)),q.onwheel.acc=0)};q.onmousedown=function(c){__globals.svgElement.onmousemove_old=__globals.svgElement.onmousemove;__globals.svgElement.onmouseleave_old=__globals.svgElement.onmouseleave;__globals.svgElement.onmouseup_old=__globals.svgElement.onmouseup;__globals.svgElement.tempRef=this;__globals.svgElement.tempRef._data.initialValue=this._get();__globals.svgElement.tempRef._data.initialY=c.y;__globals.svgElement.tempRef._data.mux=__globals.svgElement.tempRef._data.mux;
__globals.svgElement.onmousemove=function(c){var d=__globals.svgElement.tempRef._data.mux,e=__globals.svgElement.tempRef._data.initialValue;c=c.y-__globals.svgElement.tempRef._data.initialY;var f=__globals.utility.workspace.getGlobalScale(q);__globals.svgElement.tempRef.select(Math.round((__globals.svgElement.tempRef._data.optionCount-1)*(e-c/(f*d))))};__globals.svgElement.onmouseup=function(){this.tempRef.select(this.tempRef.select(),!1);this.tempRef=null;__globals.svgElement.onmousemove=__globals.svgElement.onmousemove_old;
__globals.svgElement.onmouseleave=__globals.svgElement.onmouseleave_old;__globals.svgElement.onmouseup=__globals.svgElement.onmouseup_old;__globals.svgElement.onmousemove_old=null;__globals.svgElement.onmouseleave_old=null;__globals.svgElement.onmouseup_old=null};__globals.svgElement.onmouseleave=__globals.svgElement.onmouseup;__globals.svgElement.onmousemove(c)};q._set(0);return q};this.grapher_waveWorkspace=function(c,f,d,e,g,k,h,n,l,m,p,r,t,v,u,w){h=void 0===h?"Canvas":h;n=void 0===n?!0:n;l=void 0===
l?!0:l;m=void 0===m?["fill:rgba(240, 240, 240, 1);","fill:rgba(255, 231, 114, 1);"]:m;r=void 0===r?["stroke:rgba(0,255,0,1); stroke-width:0.1; stroke-linecap:round;"]:r;t=void 0===t?["fill:rgba(0,255,0,1); font-size:3; font-family:Helvetica;"]:t;v=void 0===v?"stroke:rgba(0,100,0,1); stroke-width:0.25;":v;u=void 0===u?"fill:rgba(0,100,0,1); font-size:3; font-family:Helvetica;":u;w=void 0===w?"fill:rgba(50,50,50,1)":w;var q=__globals.utility.misc.elementMaker("g",void 0===c?"grapher_waveWorkspace":
c,{x:f,y:d});c=__globals.utility.misc.elementMaker("grapher"+h,"graph",{x:0,y:0,width:e,height:g,style:{foreground:r,foregroundText:t,background:v,backgroundText:u,backing:w}});q.append(c);e=__globals.utility.misc.elementMaker("needleOverlay","overlay",{x:0,y:0,width:e,height:g,selectNeedle:n,selectionArea:l,needleStyles:m});q.append(e);q.select=e.select;q.area=e.area;q.draw=c.draw;q.foregroundLineThickness=c.foregroundLineThickness;q.drawBackground=c.drawBackground;q.area=e.area;q._test=c._test;
q.genericNeedle=e.genericNeedle;q.onchange=function(c,d){};e.onchange=function(c,d){if(q.onchange)q.onchange(c,d)};q.onrelease=function(c,d){};e.onrelease=function(c,d){if(q.onrelease)q.onrelease(c,d)};q.selectionAreaToggle=function(c){};e.selectionAreaToggle=function(c){q.selectionAreaToggle&&q.selectionAreaToggle(c)};q.drawBackground();return q};this.key_rect=function(c,f,d,e,g,k,h,n,l,m){k=void 0===k?0:k;h=void 0===h?"fill:rgba(200,200,200,1)":h;n=void 0===n?"fill:rgba(180,180,180,1)":n;l=void 0===
l?"fill:rgba(220,200,220,1)":l;m=void 0===m?"fill:rgba(200,190,200,1)":m;var p=__globals.utility.misc.elementMaker("g",void 0===c?"key_rect":c,{x:f,y:d}),r=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,angle:k,style:h});p.appendChild(r);p.state=0;p.activateState=function(c){switch(c){case 0:__globals.utility.element.setStyle(r,h);break;case 1:__globals.utility.element.setStyle(r,n);break;case 2:__globals.utility.element.setStyle(r,l);break;case 3:__globals.utility.element.setStyle(r,
m);break;default:return}p.state=c};r.onmousedown=function(){p.press()};r.onmouseup=function(){p.release()};r.onmouseleave=function(){p.release()};r.onmouseenter=function(c){1==c.buttons&&p.press()};p.keyup=function(){};p.keydown=function(){};p.press=function(){0==this.state%2&&(this.activateState(this.state+1),this.keydown&&this.keydown())};p.release=function(){0!=this.state%2&&(this.activateState(p.state-1),this.keyup&&this.keyup())};p.glow=function(){this.activateState(this.state+2)};p.dim=function(){this.activateState(this.state-
2)};return p};this.needleOverlay=function(c,f,d,e,g,k,h,n,l,m){function p(c,d){void 0==d||0>d||1<d?(q[c].remove(),delete v[c]):(y.contains(q[c])||y.append(q[c]),__globals.utility.element.setTransform_XYonly(q[c],d*e-e*h*d,0),v[c]=d)}function r(){if(void 0==v.selection_A||void 0==v.selection_B||v.selection_A==v.selection_B)q.selection_area.remove(),u.selectionAreaToggle(!1),delete v.selection_area;else{y.contains(q.selection_area)||(y.append(q.selection_area),u.selectionAreaToggle(!0));if(v.selection_A<
v.selection_B)var c=v.selection_A,d=v.selection_B;else c=v.selection_B,d=v.selection_A;c=c-h*c+h;d=d-h*d-c;0>d&&(d=0);__globals.utility.element.setTransform_XYonly(q.selection_area,e*c,0);q.selection_area.setAttribute("width",e*d)}}function t(c,d){if(u.onchange)u.onchange(c,__globals.utility.element.getPositionWithinFromMouse(event,u,e,g).x);__globals.svgElement.onmousemove=function(f){f=__globals.utility.element.getPositionWithinFromMouse(f,u,e,g).x;p(c,f);if(u.onchange)u.onchange(c,f);d&&d()};__globals.svgElement.onmouseup=
function(f){f=__globals.utility.element.getPositionWithinFromMouse(f,u,e,g).x;p(c,f);if(u.onrelease)u.onrelease(c,f);d&&d();__globals.svgElement.onmousemove=void 0;__globals.svgElement.onmouseleave=void 0;__globals.svgElement.onmouseup=void 0};__globals.svgElement.onmouseleave=__globals.svgElement.onmouseup}h=void 0===h?.00125:h;n=void 0===n?!0:n;l=void 0===l?!0:l;m=void 0===m?["fill:rgba(240, 240, 240, 1);","fill:rgba(255, 231, 114, 1);"]:m;var v={},u=__globals.utility.misc.elementMaker("g",void 0===
c?"needleOverlay":c,{x:f,y:d});c=__globals.utility.misc.elementMaker("rect","backing",{width:e,height:g,style:"fill:rgba(100,100,100, 0);"});u.appendChild(c);var w=e*h+.005*e,q={};q.lead=__globals.utility.misc.elementMaker("g","lead",{});q.lead.append(__globals.utility.misc.elementMaker("rect","handle",{width:h*e,height:g,style:m[0]}));q.lead.append(__globals.utility.misc.elementMaker("rect","invisibleHandle",{x:(e*h-w)/2,width:w,height:g,style:"fill:rgba(255,0,0,0);cursor: col-resize;"}));q.selection_A=
__globals.utility.misc.elementMaker("g","selection_A",{});q.selection_A.append(__globals.utility.misc.elementMaker("rect","handle",{width:h*e,height:g,style:m[1]}));q.selection_A.append(__globals.utility.misc.elementMaker("rect","invisibleHandle",{x:(e*h-w)/2,width:w,height:g,style:"fill:rgba(255,0,0,0);cursor: col-resize;"}));q.selection_B=__globals.utility.misc.elementMaker("g","selection_B",{});q.selection_B.append(__globals.utility.misc.elementMaker("rect","handle",{width:h*e,height:g,style:m[1]}));
q.selection_B.append(__globals.utility.misc.elementMaker("rect","invisibleHandle",{x:(e*h-w)/2,width:w,height:g,style:"fill:rgba(255,0,0,0);cursor: col-resize;"}));q.selection_area=__globals.utility.misc.elementMaker("rect","selection_area",{height:g,style:m[1]+"opacity:0.33; cursor: move;"});q.generic=[];var y=__globals.utility.misc.elementMaker("g","controlObjectsGroup",{});u.append(y);c.onmousedown=function(c){c.shiftKey?l&&(p("selection_A",__globals.utility.element.getPositionWithinFromMouse(c,
u,e,g).x),t("selection_B",r)):n&&(p("lead",__globals.utility.element.getPositionWithinFromMouse(c,u,e,g).x),t("lead"))};q.lead.onmousedown=function(){t("lead")};q.selection_A.onmousedown=function(){t("selection_A",r)};q.selection_B.onmousedown=function(){t("selection_B",r)};q.selection_area.onmousedown=function(){__globals.svgElement.onmousemove=function(c){var d=__globals.utility.workspace.getGlobalScale(u),f=v.selection_A+c.movementX/(e*d);c=v.selection_B+c.movementX/(e*d);1<f||0>f||1<c||0>c||(u.onchange&&
(u.onchange("selection_A",f),u.onchange("selection_B",c)),p("selection_A",f),p("selection_B",c),r())};__globals.svgElement.onmouseup=function(c){u.onrelease&&(u.onrelease("selection_A",v.selection_A),u.onrelease("selection_B",v.selection_B));__globals.svgElement.onmousemove=void 0;__globals.svgElement.onmouseleave=void 0;__globals.svgElement.onmouseup=void 0}};q.selection_A.ondblclick=function(){p("selection_A");p("selection_B");r()};q.selection_B.ondblclick=q.selection_A.ondblclick;q.selection_area.ondblclick=
q.selection_A.ondblclick;u.select=function(c,d){if(n){if(void 0==c)return v.lead;1<c||0>c?p("lead"):p("lead",c)}};u.area=function(c,d){if(l){if(void 0==c||void 0==d)return{A:v.selection_A,B:v.selection_B};1<c||0>c||1<d||0>d?(p("selection_A"),p("selection_B")):(p("selection_A",c),p("selection_B",d));r()}};u.genericNeedle=function(c,d,f){f=void 0===f?"":f;f=void 0===f?{}:f;q.generic[c]&&void 0!=d?__globals.utility.element.setTransform_XYonly(q.generic[c],d*e-e*h*d,0):q.generic[c]?(q.generic[c].remove(),
delete q.generic[c]):(q.generic[c]=__globals.utility.misc.elementMaker("g","generic_"+c,{x:d*e-h*e/2,style:f}),q.generic[c].append(__globals.utility.misc.elementMaker("rect","handle",{width:h*e,height:g,style:m[0]})),q.generic[c].append(__globals.utility.misc.elementMaker("rect","invisibleHandle",{x:(e*h-w)/2,width:w,height:g,style:"fill:rgba(255,0,0,0);"})),y.append(q.generic[c]))};u.onchange=function(c,d){};u.onrelease=function(c,d){};u.selectionAreaToggle=function(c){};return u};this.rangeslide=
function(c,f,d,e,g,k,h,n,l,m,p,r,t,v,u){function w(c,d,f){f=void 0===f?!0:f;c=1<c?1:c;c=0>c?0:c;switch(d){default:console.error("unknown handle to adjust");break;case "start":1<=c/(1-h/(1-h))&&(c=1-h/(1-h));var k=c+(1-c)*h,m=l.end-l.end*h;k>=m&&(l.end=k/(1-h));break;case "end":1>=c/(h/(1-h))&&(c=h/(1-h)),k=l.start+(1-l.start)*h,m=c-c*h,k>=m&&(l.start=(m-h)/(1-h))}l[d]=c;__globals.utility.element.setTransform_XYonly(N.start,0,l.start*g*(1-h));__globals.utility.element.setTransform_XYonly(N.end,0,l.end*
g*(1-h));__globals.utility.element.setTransform_XYonly(A,(1-n)/2*e,g*(h+l.start-h*(l.start+.1)));A.height.baseVal.value=g*(l.end-l.start+h*(l.start-l.end-1+.2));if(f&&x.onchange)x.onchange(l)}function q(c){c=[c,c+(l.end-l.start)];0>=c[0]?(c[1]-=c[0],c[0]=0):1<=c[1]&&(c[0]-=c[1]-1,c[1]=1);w(c[0],"start");w(c[1],"end")}h=void 0===h?.025:h;n=void 0===n?.75:n;l=void 0===l?{start:0,end:1}:l;m=void 0===m?{start:-1,end:-1}:m;p=void 0===p?"fill:rgba(200,200,200,1)":p;r=void 0===r?"fill:rgba(150,150,150,1)":
r;t=void 0===t?"fill:rgba(50,50,50,1)":t;v=void 0===v?"fill:rgba(0,0,0,0);":v;u=void 0===u?"fill:rgba(200,0,200,0.5);":u;var y=!1,z=["start","end"],x=__globals.utility.misc.elementMaker("g",void 0===c?"rangeslide":c,{x:f,y:d,r:void 0===k?0:k}),E=__globals.utility.misc.elementMaker("g","backingAndSlotGroup",{});x.appendChild(E);c=__globals.utility.misc.elementMaker("rect","backing",{width:e,height:g,style:r});E.appendChild(c);t=__globals.utility.misc.elementMaker("rect","slot",{x:.45*e,y:h/2*g,width:.1*
e,height:g*(1-h),style:t});E.appendChild(t);var A=__globals.utility.misc.elementMaker("rect","span",{x:(1-n)/2*e,y:g*h,width:e*n,height:g-2*g*h,style:u});x.appendChild(A);var N={};for(u=0;u<z.length;u++)N[z[u]]=__globals.utility.misc.elementMaker("g","handle_"+u,{}),x.appendChild(N[z[u]]),t=__globals.utility.misc.elementMaker("rect","handle",{width:e,height:g*h,style:p}),N[z[u]].appendChild(t),t=g*h+.01*g,t=__globals.utility.misc.elementMaker("rect","invisibleHandle",{y:(g*h-t)/2,width:e,height:t+
h,style:v}),N[z[u]].appendChild(t);x.get=function(){return l};x.set=function(c,d){y||(void 0!=c.start&&w(c.start,"start",d),void 0!=c.end&&w(c.end,"end",d))};x.smoothSet=function(c,d,e,f){if(!y){var g=__globals.audio.context.currentTime;JSON.parse(JSON.stringify(l));var h=__globals.utility.math.curvePoint.linear;switch(e){case "linear":h=__globals.utility.math.curvePoint.linear;break;case "sin":h=__globals.utility.math.curvePoint.sin;break;case "cos":h=__globals.utility.math.curvePoint.cos;break;
case "exponential":h=__globals.utility.math.curvePoint.exponential;break;case "s":h=__globals.utility.math.curvePoint.s}x.smoothSet.interval=setInterval(function(){var e=(__globals.audio.context.currentTime-g)/d;1<e&&(e=1);void 0!=c.start&&w(h(e,startvalues.start,c.start),"start",f);void 0!=c.end&&w(h(e,startvalues.end,c.end),"end",f);if(__globals.audio.context.currentTime-g>=d){if(x.onrelease)x.onrelease(l);clearInterval(x.smoothSet.interval)}},1E3/30)}};E.onclick=function(c){y||(x.smoothSet.interval&&
clearInterval(x.smoothSet.interval),c=__globals.utility.element.getPositionWithinFromMouse(c,E,e,g).y,c+=.5*h*(2*c-1),Math.abs(l.start-c)<Math.abs(l.end-c)?w(c,"start"):w(c,"end"))};x.ondblclick=function(){0>m.start||0>m.end||y||(x.smoothSet.interval&&clearInterval(x.smoothSet.interval),w(m.start,"start"),w(m.end,"end"),x.onrelease(l))};x.onwheel=function(){if(!y){x.smoothSet.interval&&clearInterval(x.smoothSet.interval);var c=__globals.mouseInteraction.wheelInterpreter(event.deltaY),d=__globals.utility.workspace.getGlobalScale(x);
c/=10*d;w(l.start-c,"start");w(l.end+c,"end")}};A.onmousedown=function(c){y=!0;x.smoothSet.interval&&clearInterval(x.smoothSet.interval);var d=l.start,f=__globals.utility.element.getPositionWithinFromMouse(c,E,e,g);__globals.utility.workspace.mouseInteractionHandler(function(c){c=__globals.utility.element.getPositionWithinFromMouse(c,E,e,g);q(d+(c.y-f.y));x.onchange(l)},function(c){c=__globals.utility.element.getPositionWithinFromMouse(c,E,e,g);q(d+(c.y-f.y));x.onrelease(l);y=!1})};for(u=0;u<z.length;u++)N[z[u]].onmousedown=
function(c){return function(d){y=!0;x.smoothSet.interval&&clearInterval(x.smoothSet.interval);var f=l[z[c]],k=__globals.utility.element.getPositionWithinFromMouse(d,E,e,g);__globals.utility.workspace.mouseInteractionHandler(function(d){d=__globals.utility.element.getPositionWithinFromMouse(d,E,e,g);w(f+(d.y-k.y)/(1-h),z[c]);x.onchange(l)},function(c){x.onrelease(l);y=!1})}}(u);x.onchange=function(){};x.onrelease=function(){};w(0,"start");w(1,"end");return x};this.rastorgrid=function(c,f,d,e,g,k,h,
n,l,m,p){n=void 0===n?"fill:rgba(200,200,200,1)":n;l=void 0===l?"fill:rgba(150,150,150,1)":l;m=void 0===m?"fill:rgba(220,220,220,1)":m;p=void 0===p?"fill:rgba(220,220,220,1)":p;var r=__globals.utility.misc.elementMaker("g",void 0===c?"rastorgrid":c,{x:f,y:d});f=__globals.utility.misc.elementMaker("rect",null,{width:e,height:g,style:n});r.appendChild(f);for(d=0;d<h;d++)for(f=0;f<k;f++)c=__globals.utility.misc.elementMaker("checkbox_rect",d+"_"+f,{x:e/k*f,y:g/h*d,width:e/k,height:g/h,style:{check:l,
backing:n,checkGlow:p,backingGlow:m}}),r.appendChild(c),c.onchange=function(){if(r.onchange)r.onchange(r.get())};r.box=function(c,d){return r.children[d+"_"+c]};r.get=function(){for(var c=[],d=0;d<h;d++){for(var e=[],f=0;f<k;f++)e.push(this.box(f,d).get());c.push(e)}return c};r.set=function(c,d){for(d=0;d<h;d++)for(var e=0;e<k;e++)r.box(e,d).set(c[d][e],!1)};r.clear=function(){for(var c=0;c<h;c++)for(var d=0;d<k;d++)r.box(d,c).set(!1,!1)};r.light=function(c,d,e){r.box(c,d).light(e)};r.onchange=function(){};
return r};this.sequencer=function(c,f,d,e,g,k,h,n,l,m,p,r,t,v,u,w,q,y,z,x,E,A,N){function S(c,d){if(void 0==c&&void 0==d)return{x:l,y:m};var f=.01;if(void 0!=c&&c!=l&&void 0!=d&&d!=m){f=.01;c=c<f?f:c;d=d<f?f:d;l=1<c?1:c;m=1<d?1:d;G=e/l;F=g/m;M.width.baseVal.value=G;M.height.baseVal.value=F;for(c=0;c<h;c++)__globals.utility.element.setTransform_XYonly(J.children["strip_vertical_"+c],e/(h*l)*c,0),J.children["strip_vertical_"+c].width.baseVal.value=e/(h*l),J.children["strip_vertical_"+c].height.baseVal.value=
F;for(c=0;c<n;c++)__globals.utility.element.setTransform_XYonly(J.children["strip_horizontal_"+c],0,g/(n*m)*c),J.children["strip_horizontal_"+c].height.baseVal.value=g/(n*m),J.children["strip_horizontal_"+c].width.baseVal.value=G;for(c=0;c<Q.children.length;c++)Q.children[c].unit(e/(h*l),g/(n*m));0<=D.position&&(L.children.playhead.main.y2.baseVal.value=F,L.children.playhead.invisibleHandle.y2.baseVal.value=F,__globals.utility.element.setTransform_XYonly(L.children.playhead,G/h*D.position,0))}else if(void 0!=
c&&c!=l){c=c<f?f:c;l=1<c?1:c;G=e/l;M.width.baseVal.value=G;for(c=0;c<h;c++)__globals.utility.element.setTransform_XYonly(J.children["strip_vertical_"+c],e/(h*l)*c,0),J.children["strip_vertical_"+c].width.baseVal.value=e/(h*l);for(c=0;c<n;c++)J.children["strip_horizontal_"+c].width.baseVal.value=G;for(c=0;c<Q.children.length;c++)Q.children[c].unit(e/(h*l),void 0);0<=D.position&&__globals.utility.element.setTransform_XYonly(L.children.playhead,G/h*D.position,0)}else if(void 0!=d&&d!=m){d=d<f?f:d;m=
1<d?1:d;F=g/m;M.height.baseVal.value=F;for(c=0;c<h;c++)J.children["strip_vertical_"+c].height.baseVal.value=F;for(c=0;c<n;c++)__globals.utility.element.setTransform_XYonly(J.children["strip_horizontal_"+c],0,g/(n*m)*c),J.children["strip_horizontal_"+c].height.baseVal.value=g/(n*m);for(c=0;c<Q.children.length;c++)Q.children[c].unit(void 0,g/(n*m));0<=D.position&&(L.children.playhead.main.y2.baseVal.value=F,L.children.playhead.invisibleHandle.y2.baseVal.value=F)}}function X(c,d,f){f=void 0===f?!0:f;
if(void 0==c&&void 0==d)return K;if(void 0==c||isNaN(c))c=K.x;if(void 0==d||isNaN(d))d=K.y;c=0>c?0:c;c=1<c?1:c;d=0>d?0:d;d=1<d?1:d;K.x=c;K.y=d;__globals.utility.element.setTransform_XYonly(L,-K.x*(G-e),-K.y*(F-g));var h=(G-e)*K.x,k=(F-g)*K.y,l=h+e,m=k+g;W.setAttribute("clip-path","polygon("+h+"px "+k+"px, "+h+"px "+m+"px, "+l+"px "+m+"px, "+l+"px "+k+"px)");h=(1-(I.right-I.left))*c;k=(1-(I.bottom-I.top))*d;I={left:h,right:h+(I.right-I.left),top:k,bottom:k+(I.bottom-I.top)};f&&(B.onpan({x:c,y:d}),
B.onchangeviewarea(I))}function Z(c){return{x:l*(c.x-K.x)+K.x,y:m*(c.y-K.y)+K.y}}function R(c){c.y=Math.floor(c.y*n);c.y>=n&&(c.y=n-1);c.x=Math.round(c.x*h/T)*T;0>c.x&&(c.x=0);return{line:c.y,position:c.x}}function Y(c,d,f,k){c=H.add({line:c,position:d,length:f,strength:void 0===k?.5:k});d=H.getNote(c);var p=parts.elements.control.sequencer.noteBlock(c,e/(h*l),g/(n*m),d.line,d.position,d.length,d.strength,!1,t,v,u,w);Q.append(p);p.select=function(c){c=void 0===c?!1:c;-1!=C.indexOf(this)?c||this.deselect():
(this.selected(!0),C.push(this),this.glow(!0))};p.deselect=function(){C.splice(C.indexOf(this),1);this.selected(!1);this.glow(!1)};p.delete=function(){this.deselect();H.remove(parseInt(this.id));this.remove()};p.ondblclick=function(c){c[__globals.super.keys.ctrl]&&C.map(function(c){c.strength(.5);H.update(c.id,{strength:.5})})};p.body.onmousedown=function(c){if(__globals.keyboardInteraction.pressedKeys.hasOwnProperty("Space")&&__globals.keyboardInteraction.pressedKeys.Space)M.onmousedown(c);else{if(!c.shiftKey&&
!p.selected())for(;0<C.length;)C[0].deselect();p.select(!0);for(var d=[],e=0;e<C.length;e++)d.push({id:parseInt(C[e].id),block:C[e],starting:H.getNote(parseInt(C[e].id))});if(c[__globals.super.keys.ctrl]){var f=d.map(function(c){return c.block.strength()}),g=c.offsetY;__globals.utility.workspace.mouseInteractionHandler(function(c){c=(g-c.offsetY)/__globals.svgElement.clientHeight;for(var e=0;e<d.length;e++)d[e].block.strength(f[e]+c),H.update(d[e].id,{strength:f[e]+c})})}else{var h=!1,k=R(__globals.utility.element.getPositionWithinFromMouse(c,
M,G,F));__globals.utility.workspace.mouseInteractionHandler(function(e){if(!h&&(h=!0,c[__globals.super.keys.alt]))for(var f=0;f<C.length;f++){var g=H.getNote(parseInt(C[f].id));Y(g.line,g.position,g.length,g.strength)}f=R(__globals.utility.element.getPositionWithinFromMouse(e,M,G,F));e=f.line-k.line;f=f.position-k.position;for(g=0;g<d.length;g++){H.update(d[g].id,{line:d[g].starting.line+e,position:d[g].starting.position+f});var l=H.getNote(d[g].id);d[g].block.line(l.line);d[g].block.position(l.position)}})}}};
p.leftHandle.onmousedown=function(c){if(!c.shiftKey&&!p.selected())for(;0<C.length;)C[0].deselect();p.select(!0);for(var d=[],e=0;e<C.length;e++)d.push({id:parseInt(C[e].id),block:C[e],starting:H.getNote(parseInt(C[e].id))});var f=R(__globals.utility.element.getPositionWithinFromMouse(c,M,G,F));__globals.utility.workspace.mouseInteractionHandler(function(c){c=R(__globals.utility.element.getPositionWithinFromMouse(c,M,G,F));c=f.position-c.position;for(var e=0;e<d.length;e++)if(!(0>d[e].starting.position-
c)){H.update(d[e].id,{length:d[e].starting.length+c,position:d[e].starting.position-c});var g=H.getNote(d[e].id);d[e].block.position(g.position);d[e].block.length(g.length)}})};p.rightHandle.onmousedown=function(c){if(!c.shiftKey&&!p.selected())for(;0<C.length;)C[0].deselect();p.select(!0);for(var d=[],e=0;e<C.length;e++)d.push({id:parseInt(C[e].id),block:C[e],starting:H.getNote(parseInt(C[e].id))});var f=R(__globals.utility.element.getPositionWithinFromMouse(c,M,G,F));__globals.utility.workspace.mouseInteractionHandler(function(c){c=
R(__globals.utility.element.getPositionWithinFromMouse(c,M,G,F)).position-f.position;for(var e=0;e<d.length;e++){H.update(d[e].id,{length:d[e].starting.length+c});var g=H.getNote(d[e].id);d[e].block.position(g.position);d[e].block.length(g.length)}})};return{id:c,noteBlock:p}}function aa(){var c=__globals.utility.misc.elementMaker("g","playhead",{});L.appendChild(c);c.onmousedown=function(){D.held=!0;__globals.utility.workspace.mouseInteractionHandler(function(c){c=R(__globals.utility.element.getPositionWithinFromMouse(c,
M,G,F));B.playheadPosition(c.position)},function(){D.held=!1})};c.main=__globals.utility.misc.elementMaker("line","main",{x1:0,y1:0,x2:0,y2:F,style:N+"stroke-width:"+D.width+";"});c.appendChild(c.main);c.invisibleHandle=__globals.utility.misc.elementMaker("line","invisibleHandle",{x1:0,y1:0,x2:0,y2:F,style:"stroke:rgba(0,0,0,0); cursor: col-resize; stroke-width:"+D.width*D.invisibleHandleMux+";"});c.appendChild(c.invisibleHandle)}c=void 0===c?"svg_sequencer":c;h=void 0===h?64:h;n=void 0===n?16:n;
l=void 0===l?1:l;m=void 0===m?1:m;p=void 0===p?"fill:rgba(20,20,20,1);":p;r=void 0===r?"fill:rgba(209, 189, 222, 0.5);stroke:rgba(225, 217, 234,1);stroke-width:0.5;pointer-events:none;":r;t=void 0===t?"fill:rgba(138,138,138,0.6);stroke:rgba(175,175,175,0.8);stroke-width:0.5;{fill:rgba(130,199,208,0.6);stroke:rgba(130,199,208,0.8);stroke-width:0.5;{fill:rgba(129,209,173,0.6);stroke:rgba(129,209,173,0.8);stroke-width:0.5;{fill:rgba(234,238,110,0.6);stroke:rgba(234,238,110,0.8);stroke-width:0.5;{fill:rgba(249,178,103,0.6);stroke:rgba(249,178,103,0.8);stroke-width:0.5;{fill:rgba(255, 69, 69,0.6);stroke:rgba(255, 69, 69,0.8);stroke-width:0.5;".split("{"):
t;v=void 0===v?"fill:rgba(138,138,138,0.8);stroke:rgba(175,175,175,1);stroke-width:0.5;{fill:rgba(130,199,208,0.8);stroke:rgba(130,199,208,1);stroke-width:0.5;{fill:rgba(129,209,173,0.8);stroke:rgba(129,209,173,1);stroke-width:0.5;{fill:rgba(234,238,110,0.8);stroke:rgba(234,238,110,1);stroke-width:0.5;{fill:rgba(249,178,103,0.8);stroke:rgba(249,178,103,1);stroke-width:0.5;{fill:rgba(255, 69, 69,0.8);stroke:rgba(255, 69, 69,1);stroke-width:0.5;".split("{"):v;u=void 0===u?"fill:rgba(200,0,0,0);cursor:col-resize;":
u;w=void 0===w?3:w;q=void 0===q?[0,1]:q;y=void 0===y?"stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(120,120,120,0.8);":y;z=void 0===z?["stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(120,120,120,0.5);","stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(100,100,100,0);"]:z;x=void 0===x?[0]:x;E=void 0===E?"stroke:rgba(252,244,128,0.5);stroke-width:0.5;fill:rgba(229, 221, 112,0.25);":E;A=void 0===A?["stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(30,30,30,0.5);"]:A;N=void 0===
N?"stroke:rgb(240, 240, 240);":N;var G=e/l;var F=g/m;var K={x:0,y:0},I={left:0,right:l,top:0,bottom:m},H=new parts.circuits.sequencing.noteRegistry(h,n),C=[],O=[],T=1,U=!1,P={start:0,end:h},D={width:.75,invisibleHandleMux:6,position:-1,held:!1,automoveViewposition:!1},B=__globals.utility.misc.elementMaker("g",c,{x:f,y:d,r:k}),V=__globals.utility.misc.elementMaker("rect","backing",{width:e,height:g,style:p});B.appendChild(V);var W=__globals.utility.misc.elementMaker("g","viewport",{});W.setAttribute("clip-path",
"polygon(0px 0px, "+e+"px 0px, "+e+"px "+g+"px, 0px "+g+"px)");B.appendChild(W);var L=__globals.utility.misc.elementMaker("g","workarea",{});W.appendChild(L);L.onkeydown=function(c){if("Delete"==c.key||"Backspace"==c.key){for(;0<C.length;)C[0].delete();return!0}};var J=__globals.utility.misc.elementMaker("g","backgroundDrawArea",{});L.appendChild(J);(function(){J.innerHTML="";for(var c=0;c<n;c++)J.appendChild(__globals.utility.misc.elementMaker("rect","strip_horizontal_"+c,{x1:0,y:g/(n*m)*c,width:G,
height:g/(n*m),style:z[q[c%q.length]]}));for(c=0;c<h;c++)J.appendChild(__globals.utility.misc.elementMaker("rect","strip_vertical_"+c,{x:e/(h*l)*c,y:0,width:e/(h*l),height:F,style:A[x[c%x.length]]}))})();var M=__globals.utility.misc.elementMaker("rect","interactionPlane",{width:G,height:F,style:"fill:rgba(0,0,0,0);"});L.appendChild(M);M.onmousedown=function(c){if(c.shiftKey){var d=__globals.utility.element.getPositionWithinFromMouse(c,V,e,g),f=__globals.utility.element.getPositionWithinFromMouse(c,
V,e,g),k=__globals.utility.misc.elementMaker("rect","selectionArea",{x:d.x*e,y:d.y*g,width:0,height:0,style:r});B.appendChild(k);__globals.utility.workspace.mouseInteractionHandler(function(c){f=__globals.utility.element.getPositionWithinFromMouse(c,V,e,g);var h=f.x-d.x;c=f.y-d.y;0>h?(k.width.baseVal.value=-h*e,h=d.x+h):(k.width.baseVal.value=h*e,h=d.x);0>c?(k.height.baseVal.value=-c*g,c=d.y+c):(k.height.baseVal.value=c*g,c=d.y);__globals.utility.element.setTransform_XYonly(k,h*e,c*g)},function(){k.remove();
var c=Z(d),e=Z(f);c.x*=G;e.y*=F;e.x*=G;c.y*=F;var g=[{},{}];c.x<e.x?(g[0].x=c.x,g[1].x=e.x):(g[0].x=e.x,g[1].x=c.x);c.y<e.y?(g[0].y=c.y,g[1].y=e.y):(g[0].y=e.y,g[1].y=c.y);for(;0<C.length;)C[0].deselect();c=Q.getElementsByTagName("g");for(e=0;e<c.length;e++){var l=H.getNote(parseInt(c[e].id));l=[{x:G/h*l.position,y:F/n*l.line},{x:G/h*(l.position+l.length),y:F/n*(l.line+1)}];__globals.utility.math.detectOverlap(g,l,g,l)&&c[e].select(!0)}})}else if(c[__globals.super.keys.alt]){for(;0<C.length;)C[0].deselect();
var p=R(__globals.utility.element.getPositionWithinFromMouse(c,M,G,F));p=Y(p.line,p.position,0);p.noteBlock.select();p.noteBlock.rightHandle.onmousedown(c)}else if(__globals.keyboardInteraction.pressedKeys.Space){var q=__globals.utility.element.getPositionWithinFromMouse(c,V,e,g),u=K.x,t=K.y;__globals.utility.workspace.mouseInteractionHandler(function(c){c=__globals.utility.element.getPositionWithinFromMouse(c,V,e,g);X(u+(q.x-c.x)*h*l/(h-h*l),t+(q.y-c.y)*n*m/(n-n*m))},function(c){})}else for(;0<C.length;)C[0].deselect()};
var Q=__globals.utility.misc.elementMaker("g","notePane",{});L.appendChild(Q);B.glowHorizontal=function(c,d,e){for(void 0==e&&(e=d+1);d<e;d++)__globals.utility.element.setStyle(J.children["strip_horizontal_"+d],c?y:z[q[d%q.length]])};B.glowVertical=function(c,d,e){for(void 0==e&&(e=d+1);d<e;d++)__globals.utility.element.setStyle(J.children["strip_vertical_"+d],c?E:A[x[d%x.length]])};B.step=function(c){if(void 0==c)return T;T=c};B.viewposition=X;B.viewArea=function(c,d){d=void 0===d?!0:d;if(void 0==
c||void 0==c.left&&void 0==c.right&&void 0==c.top&&void 0==c.bottom)return I;void 0==c.left&&(c.left=I.left);void 0==c.right&&(c.right=I.right);void 0==c.top&&(c.top=I.top);void 0==c.bottom&&(c.bottom=I.bottom);var e=I.right-I.left!=c.right-c.left,f=c.bottom-c.top!=I.bottom-I.top;e&&f?S(c.right-c.left,c.bottom-c.top):e?S(c.right-c.left,void 0):f&&S(void 0,c.bottom-c.top);f=e=0;0!=1-(c.right-c.left)&&(e=c.left+(c.right-c.left)/(1-(c.right-c.left))*c.left);0!=1-(c.bottom-c.top)&&(f=c.top+(c.bottom-
c.top)/(1-(c.bottom-c.top))*c.top);X(e,f,d);I={top:c.top,bottom:c.bottom,left:c.left,right:c.right}};B.export=function(){return H.export()};B.import=function(c){H.import(c)};B.eventsBetween=function(c,d){return H.eventsBetween(c,d)};B.getAllNotes=function(){return H.getAllNotes()};B.addNote=function(c,d,e,f){Y(c,d,e,void 0===f?1:f)};B.addNotes=function(c){for(var d=0;d<c.length;d++)this.addNote(c[d].line,c[d].position,c[d].length,c[d].strength)};B.loopActive=function(c){if(void 0==c)return U;U=c;
B.glowVertical(!1,0,h);U&&B.glowVertical(!0,0>P.start?0:P.start,P.end>h?h:P.end)};B.loopPeriod=function(c,d){if(void 0==c||void 0==d)return P;c>d||0>c||0>d||(P={start:c,end:d},U&&(B.glowVertical(!1,0,h),B.glowVertical(!0,0>c?0:c,d>h?h:d)))};B.automove=function(c){if(void 0==c)return D.automoveViewposition;D.automoveViewposition=c};B.playheadPosition=function(c,d){if(void 0==c)return D.position;D.position=c;if(void 0===d||d){c=[];for(d=0;d<O.length;d++){var e=H.getNote(O[d]);null!=e&&c.unshift({noteID:O[d],
line:e.line,position:P.start,strength:0})}O=[];B.event&&0<c.length&&B.event(c)}0>D.position||D.position>h?L.children.playhead&&L.children.playhead.remove():(L.children.playhead||aa(),__globals.utility.element.setTransform_XYonly(L.children.playhead,G/h*D.position,0),D.automoveViewposition&&(c=h-h*l,(D.position<Math.floor(K.x*c)||D.position>Math.floor(K.x*c)+h*l)&&B.viewposition((D.position>c?c:D.position)/c)))};B.progress=function(){if(!D.held){0>D.position&&(aa(),D.position=0);var c=B.eventsBetween(D.position,
D.position+T);if(U&&D.position==P.start){for(var d=0;d<O.length;d++){var e=H.getNote(O[d]);null!=e&&c.unshift({noteID:O[d],line:e.line,position:P.start,strength:0})}O=[]}for(d=0;d<c.length;d++)e=O.indexOf(c[d].noteID),-1!=e&&0==c[d].strength?O.splice(e):0<c[d].strength&&O.push(c[d].noteID);D.position=U&&D.position+T==P.end?P.start:D.position+T;B.playheadPosition(D.position,!1);B.event&&0<c.length&&B.event(c)}};B.onpan=function(c){};B.onchangeviewarea=function(c){};B.event=function(c){};return B};
this.sequencer.noteBlock=function(c,f,d,e,g,k,h,n,l,m,p,r){function t(){A.body.height.baseVal.value=d;A.leftHandle.height.baseVal.value=d;A.rightHandle.height.baseVal.value=d}function v(){A.body.width.baseVal.value=k*f;__globals.utility.element.setTransform_XYonly(A.rightHandle,k*f-r/2,0)}function u(){__globals.utility.element.setTransform_XYonly(A,void 0,e*d)}function w(){__globals.utility.element.setTransform_XYonly(A,g*f,void 0)}function q(c,d){for(var e=[],f=0;f<c.length;f++)e[f]=__globals.utility.element.styleExtractor(c[f]);
c=e[0];e[0].hasOwnProperty("fill")&&(c.fill=__globals.utility.misc.multiBlendColours(e.map(function(c){return c.fill}),d));e[0].hasOwnProperty("stroke")&&(c.stroke=__globals.utility.misc.multiBlendColours(e.map(function(c){return c.stroke}),d));return __globals.utility.element.stylePacker(c)}h=void 0===h?1:h;n=void 0===n?!1:n;l=void 0===l?"fill:rgba(138,138,138,0.6);stroke:rgba(175,175,175,0.8);stroke-width:0.5;{fill:rgba(130,199,208,0.6);stroke:rgba(130,199,208,0.8);stroke-width:0.5;{fill:rgba(129,209,173,0.6);stroke:rgba(129,209,173,0.8);stroke-width:0.5;{fill:rgba(234,238,110,0.6);stroke:rgba(234,238,110,0.8);stroke-width:0.5;{fill:rgba(249,178,103,0.6);stroke:rgba(249,178,103,0.8);stroke-width:0.5;{fill:rgba(255, 69, 69,0.6);stroke:rgba(255, 69, 69,0.8);stroke-width:0.5;".split("{"):
l;m=void 0===m?"fill:rgba(138,138,138,0.8);stroke:rgba(175,175,175,1);stroke-width:0.5;{fill:rgba(130,199,208,0.8);stroke:rgba(130,199,208,1);stroke-width:0.5;{fill:rgba(129,209,173,0.8);stroke:rgba(129,209,173,1);stroke-width:0.5;{fill:rgba(234,238,110,0.8);stroke:rgba(234,238,110,1);stroke-width:0.5;{fill:rgba(249,178,103,0.8);stroke:rgba(249,178,103,1);stroke-width:0.5;{fill:rgba(255, 69, 69,0.8);stroke:rgba(255, 69, 69,1);stroke-width:0.5;".split("{"):m;p=void 0===p?"fill:rgba(255,0,255,0);cursor:col-resize;":
p;r=void 0===r?5:r;var y=!1,z=r/4,x=q(l,h),E=q(m,h),A=__globals.utility.misc.elementMaker("g",c,{y:e*d,x:g*f});A.body=__globals.utility.misc.elementMaker("rect","body",{width:k*f,height:d,style:x});A.leftHandle=__globals.utility.misc.elementMaker("rect","leftHandle",{x:-r/2,width:r,height:d,style:p});A.rightHandle=__globals.utility.misc.elementMaker("rect","rightHandle",{x:k*f-r/2,width:r,height:d,style:p});A.append(A.body);A.append(A.leftHandle);A.append(A.rightHandle);A.unit=function(c,h){if(void 0==
c&&void 0==h)return{x:f,y:d};void 0==c?(d=h,t(),u()):void 0==h?(f=c,v(),w()):(f=c,d=h,t(),v(),__globals.utility.element.setTransform_XYonly(A,g*f,e*d))};A.line=function(c){if(void 0==c)return e;e=c;u()};A.position=function(c){if(void 0==c)return g;g=c;w()};A.length=function(c){if(void 0==c)return k;k=c<z/f?z/f:c;v()};A.strength=function(c){if(void 0==c)return h;c=1<c?1:c;h=0>c?0:c;x=q(l,h);E=q(m,h);A.glow(n)};A.glow=function(c){if(void 0==c)return n;(n=c)?__globals.utility.element.setStyle(A.body,
E):__globals.utility.element.setStyle(A.body,x)};A.selected=function(c){if(void 0==c)return y;y=c};return A};this.slide=function(c,f,d,e,g,k,h,n,l,m,p,r,t){function v(c,d){c=1<c?1:c;c=0>c?0:c;if(void 0===d||d)q.onchange(c);n=c;z.y.baseVal.valueInSpecifiedUnits=c*g*(1-h);x.y.baseVal.valueInSpecifiedUnits=c*g*(1-h)}function u(c){return c.y*Math.cos(q.__calculationAngle)-c.x*Math.sin(q.__calculationAngle)}k=void 0===k?0:k;h=void 0===h?.1:h;n=void 0===n?0:n;l=void 0===l?-1:l;m=void 0===m?"fill:rgba(200,200,200,1)":
m;p=void 0===p?"fill:rgba(150,150,150,1)":p;r=void 0===r?"fill:rgba(50,50,50,1)":r;t=void 0===t?"fill:rgba(0,0,0,0);":t;var w=!1,q=__globals.utility.misc.elementMaker("g",void 0===c?"slide":c,{x:f,y:d,r:k}),y=__globals.utility.misc.elementMaker("g","backingAndSlotGroup",{});q.appendChild(y);c=__globals.utility.misc.elementMaker("rect","backing",{width:e,height:g,style:p});y.appendChild(c);r=__globals.utility.misc.elementMaker("rect","slot",{x:.45*e,y:h/2*g,width:.1*e,height:g*(1-h),style:r});y.appendChild(r);
var z=__globals.utility.misc.elementMaker("rect","handle",{width:e,height:g*h,style:m});q.appendChild(z);m=g*h+.01*g;var x=__globals.utility.misc.elementMaker("rect","invisibleHandle",{y:(g*h-m)/2,width:e,height:m+h,style:t});q.appendChild(x);q.__calculationAngle=k;q.set=function(c,d){w||v(c,d)};q.smoothSet=function(c,d,e,f){if(!w){var g=__globals.audio.context.currentTime,h=n,k=__globals.utility.math.curvePoint.linear;switch(e){case "linear":k=__globals.utility.math.curvePoint.linear;break;case "sin":k=
__globals.utility.math.curvePoint.sin;break;case "cos":k=__globals.utility.math.curvePoint.cos;break;case "exponential":k=__globals.utility.math.curvePoint.exponential;break;case "s":k=__globals.utility.math.curvePoint.s}q.smoothSet.interval=setInterval(function(){var e=(__globals.audio.context.currentTime-g)/d;1<e&&(e=1);v(k(e,h,c),f);__globals.audio.context.currentTime-g>=d&&clearInterval(q.smoothSet.interval)},1E3/30)}};q.get=function(){return n};q.ondblclick=function(){0>l||w||(q.smoothSet.interval&&
clearInterval(q.smoothSet.interval),v(l),q.onrelease(n))};q.onwheel=function(){if(!w){q.smoothSet.interval&&clearInterval(q.smoothSet.interval);var c=__globals.mouseInteraction.wheelInterpreter(event.deltaY),d=__globals.utility.workspace.getGlobalScale(q);v(n+c/(10*d));q.onrelease(n)}};y.onclick=function(c){w||(q.smoothSet.interval&&clearInterval(q.smoothSet.interval),c=__globals.utility.element.getPositionWithinFromMouse(c,y,e,g).y,c+=.5*h*(2*c-1),v(c),q.onrelease(c))};x.onmousedown=function(c){w=
!0;q.smoothSet.interval&&clearInterval(q.smoothSet.interval);var d=n,e=u(c),f=g-g*h;__globals.utility.workspace.mouseInteractionHandler(function(c){c=e-u(c);var g=__globals.utility.workspace.getGlobalScale(q);v(d-c/(g*f))},function(c){c=e-u(c);var g=__globals.utility.workspace.getGlobalScale(q);q.onrelease(d-c/(g*f));w=!1})};q.onchange=function(){};q.onrelease=function(){};v(n);return q};this.slidePanel=function(c,f,d,e,g,k,h,n,l,m,p,r,t){h=void 0===h?0:h;l=void 0===l?0:l;m=void 0===m?.5:m;p=void 0===
p?"fill:rgba(180,180,180,1)":p;r=void 0===r?"fill:rgba(150,150,150,1)":r;t=void 0===t?"fill:rgba(50,50,50,1)":t;var v=__globals.utility.misc.elementMaker("g",void 0===c?"slidePanel":c,{x:f,y:d,r:h});for(c=0;c<k;c++)f=__globals.utility.misc.elementMaker("slide",c,{x:e/k*c,y:0,width:e/k,height:g,value:l,resetValue:m,style:{handle:p,backing:r,slot:t}}),f.onchange=function(c){v.onchange(this.id,c)},f.onrelease=function(c){v.onrelease(this.id,c)},f.__calculationAngle=h,v.appendChild(f);v.slide=function(c){return v.children[c]};
v.get=function(){for(var c=[],d=0;d<k;d++)c.push(this.slide(d).get());return c};v.set=function(c,d){d=void 0===d?!0:d;for(var e=0;e<c.length;e++)this.slide(e).set(c[e],d)};v.setAll=function(c,d){d=void 0===d?!0:d;this.set(Array.apply(null,Array(k)).map(Number.prototype.valueOf,c),!1);if(d)this.onchange("all",c)};v.smoothSet=function(c,d,e,f){f=void 0===f?!0:f;for(var g=0;g<c.length;g++)this.slide(g).smoothSet(c[g],d,e,f)};v.smoothSetAll=function(c,d,e,f){f=void 0===f?!0:f;this.smoothSet(Array.apply(null,
Array(k)).map(Number.prototype.valueOf,c),d,e,!1);if(f)this.onchange("all",c)};v.onchange=function(c,d){};v.onrelease=function(c,d){};return v}};this.dynamic=new function(){this.cable=function(c,f,d,e,g,k,h){f=void 0===f?0:f;d=void 0===d?0:d;e=void 0===e?0:e;g=void 0===g?0:g;k=void 0===k?"fill:none; stroke:rgb(255,0,0); stroke-width:4;":k;h=void 0===h?"fill:none; stroke:rgb(255,100,100); stroke-width:4;":h;c=__globals.utility.misc.elementMaker("g",void 0===c?null:c,{x:f,y:d});c.points=[{x:f,y:d},
{x:e,y:g}];c.styles={normal:k,active:h};var n=__globals.utility.misc.elementMaker("path",null,{path:c.points,lineType:"L",style:k});c.appendChild(n);c.activate=function(){n.style=this.styles.active};c.disactivate=function(){n.style=this.styles.normal};c.draw=function(c,d,e,f){this.points=[{x:c,y:d},{x:e,y:f}];n.path(this.points)};c.redraw=function(c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;c=null!=c?c:this.x1;d=d?d:this.y1;e=null!=e?e:this.x2;f=f?f:this.y2;
this.draw(c,d,e,f)};return c};this.connectionNode_audio=function(c,f,d,e,g,k,h,n,l){f=void 0===f?0:f;l=void 0===l?"fill:rgba(255, 220, 220,1)":l;var m=__globals.utility.misc.elementMaker("g",void 0===c?"connectionNode_audio":c,{x:d,y:e,r:void 0===h?0:h});m._type="audio";m._cable=null;m._cableStyle="fill:none; stroke:rgb(242, 119, 84); stroke-width:4;";m._cableActiveStyle="fill:none; stroke:rgb(242, 161, 138); stroke-width:4;";m._boundary={width:g,height:k};m._audioNode=n.createAnalyser();m._portType=
f;0!=f&&1!=f&&(f=0);c=__globals.utility.misc.elementMaker("rect","tab",{x:0,y:0,width:g,height:k,style:l});m.appendChild(c);m.onConnect=function(){};m.onDisconnect=function(){};m.out=function(){return this._audioNode};m.in=function(){return this._audioNode};m.connectTo=function(c){c._type&&c._type==this._type&&c._portType!=this._portType&&c!=this&&c!=this.foreignNode&&(this.disconnect(),this.foreignNode=c,1==this._portType&&this._audioNode.connect(this.foreignNode._audioNode),this.foreignNode._receiveConnection(this),
this._add_cable(),this.onConnect())};m._receiveConnection=function(c){this.disconnect();this.foreignNode=c;1==this._portType&&this._audioNode.connect(this.foreignNode._audioNode);this.onConnect()};m.disconnect=function(){this.foreignNode&&(this._remove_cable(),this.foreignNode._receiveDisconnection(),1==this._portType&&this._audioNode.disconnect(this.foreignNode._audioNode),this.foreignNode=null,this.onDisconnect())};m._receiveDisconnection=function(){1==this._portType&&this._audioNode.disconnect(this.foreignNode._audioNode);
this.foreignNode=null;this.onDisconnect()};m.onmousedown=function(c){__globals.svgElement.tempRef=this;__globals.svgElement.onmouseup=function(c){c=document.elementFromPoint(c.x,c.y).parentElement;__globals.svgElement.tempRef.connectTo(c);this.onmouseup=__globals.svgElement.tempRef=null}};m.ondblclick=function(){this.disconnect()};m._add_cable=function(){this._cable=__globals.utility.misc.elementMaker("cable",null,{style:{unactive:this._cableStyle,active:this._cableActiveStyle}});this.foreignNode._receive_cable(this._cable);
__globals.utility.workspace.getPane(this).appendChild(this._cable);this.draw()};m._receive_cable=function(c){this._cable=c};m._remove_cable=function(){__globals.utility.workspace.getPane(this).removeChild(this._cable);this.foreignNode._lose_cable();this._cable=null};m._lose_cable=function(){this._cable=null};m.draw=function(){if(m._cable){var c=__globals.utility.element.getCumulativeTransform(this),d=__globals.utility.element.getCumulativeTransform(this.foreignNode);this._cable.draw(c.x+this._boundary.width/
2,c.y+this._boundary.height/2,d.x+this.foreignNode._boundary.width/2,d.y+this.foreignNode._boundary.height/2)}};m.redraw=function(){if(m._cable){var c=__globals.utility.element.getCumulativeTransform(this),d=__globals.utility.element.getCumulativeTransform(this.foreignNode);this._cable.redraw(c.x+this._boundary.width/2,c.y+this._boundary.height/2,d.x+this.foreignNode._boundary.width/2,d.y+this.foreignNode._boundary.height/2)}};return m};this.connectionNode_data=function(c,f,d,e,g,k,h,n){k=void 0===
k?0:k;h=void 0===h?"fill:rgba(220, 244, 255,1)":h;n=void 0===n?"fill:rgba(244, 244, 255, 1)":n;var l=__globals.utility.misc.elementMaker("g",void 0===c?"connectionNode_data":c,{x:f,y:d,r:k});l._type="data";l._rotation=k;l._cable=null;l._cableStyle="fill:none; stroke:rgb(84, 146, 247); stroke-width:4;";l._cableActiveStyle="fill:none; stroke:rgb(123, 168, 242); stroke-width:4;";l._boundary={width:e,height:g};var m=__globals.utility.misc.elementMaker("rect","tab",{x:0,y:0,width:e,height:g,style:h});
l.appendChild(m);l.send=function(c,d){d=void 0===d?null:d;l.activate();setTimeout(function(){l&&(l.disactivate(),l._cable&&(l._cable.disactivate(),l.foreignNode.disactivate()))},100);l.foreignNode&&(l.foreignNode.receive&&l.foreignNode.receive(c,d),l._cable.activate(),l.foreignNode.activate())};l.receive=function(c,d){};l.request=function(c){if(this.foreignNode)return this.foreignNode.give(c)};l.give=function(c){};l.onConnect=function(){};l.onDisconnect=function(){};l.activate=function(){__globals.utility.element.setStyle(m,
n)};l.disactivate=function(){__globals.utility.element.setStyle(m,h)};l.connectTo=function(c){c._type&&c._type==this._type&&c!=this&&c!=this.foreignNode&&(this.disconnect(),this.foreignNode=c,this.foreignNode._receiveConnection(this),this._add_cable(),this.onConnect(),this.foreignNode.onConnect())};l._receiveConnection=function(c){this.disconnect();this.foreignNode=c};l.disconnect=function(){this.foreignNode&&(this._remove_cable(),this.foreignNode._receiveDisconnection(),this.foreignNode=null,this.onDisconnect())};
l._receiveDisconnection=function(){this.foreignNode=null;this.onDisconnect()};l.onmousedown=function(c){__globals.svgElement.tempRef=this;__globals.svgElement.onmouseup=function(c){c=document.elementFromPoint(c.x,c.y).parentElement;__globals.svgElement.tempRef.connectTo(c);this.onmouseup=__globals.svgElement.tempRef=null}};l.ondblclick=function(){this.disconnect()};l._add_cable=function(){this._cable=__globals.utility.misc.elementMaker("cable",null,{style:{unactive:this._cableStyle,active:this._cableActiveStyle}});
this.foreignNode._receive_cable(this._cable);__globals.utility.workspace.getPane(this).appendChild(this._cable);this.draw()};l._receive_cable=function(c){this._cable=c};l._remove_cable=function(){__globals.utility.workspace.getPane(this).removeChild(this._cable);this.foreignNode._lose_cable();this._cable=null};l._lose_cable=function(){this._cable=null};l.draw=function(){if(l._cable){var c=__globals.utility.element.getCumulativeTransform(this),d=__globals.utility.element.getCumulativeTransform(this.foreignNode),
e={x:this._boundary.width/2,y:this._boundary.height/2},f={x:this.foreignNode._boundary.width/2,y:this.foreignNode._boundary.height/2};if(0!=this._rotation){var g=__globals.utility.math.cartesian2polar(e.x,e.y);g.ang+=this._rotation;e=__globals.utility.math.polar2cartesian(g.ang,g.dis)}0!=this.foreignNode._rotation&&(g=__globals.utility.math.cartesian2polar(f.x,f.y),g.ang+=this.foreignNode._rotation,f=__globals.utility.math.polar2cartesian(g.ang,g.dis));this._cable.draw(c.x+e.x,c.y+e.y,d.x+f.x,d.y+
f.y)}};l.redraw=function(){if(l._cable){var c=__globals.utility.element.getCumulativeTransform(this),d=__globals.utility.element.getCumulativeTransform(this.foreignNode),e={x:this._boundary.width/2,y:this._boundary.height/2},f={x:this.foreignNode._boundary.width/2,y:this.foreignNode._boundary.height/2};if(0!=this._rotation){var g=__globals.utility.math.cartesian2polar(e.x,e.y);g.ang+=this._rotation;e=__globals.utility.math.polar2cartesian(g.ang,g.dis)}0!=this.foreignNode._rotation&&(g=__globals.utility.math.cartesian2polar(f.x,
f.y),g.ang+=this.foreignNode._rotation,f=__globals.utility.math.polar2cartesian(g.ang,g.dis));this._cable.draw(c.x+e.x,c.y+e.y,d.x+f.x,d.y+f.y)}};return l}}}},objects=new function(){this.audio_duplicator=function(c,f){c={type:"audio_duplicator",x:c,y:f,base:{points:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,0);"},elements:[{type:"connectionNode_audio",name:"input",data:{type:0,x:45,y:5,width:20,height:20}},{type:"connectionNode_audio",name:"output_1",data:{type:1,x:-10,
y:5,width:20,height:20}},{type:"connectionNode_audio",name:"output_2",data:{type:1,x:-10,y:30,width:20,height:20}},{type:"path",name:"backing",data:{path:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1);pointer-events:none;"}},{type:"path",name:"upperArrow",data:{path:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"path",name:"lowerArrow",data:{path:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},
{type:"rect",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}}]};f=__globals.utility.misc.objectBuilder(objects.audio_duplicator,c);c.connectionNode_audio.input.out().connect(c.connectionNode_audio.output_1.in());
c.connectionNode_audio.input.out().connect(c.connectionNode_audio.output_2.in());return f};this.audioIn=function(c,f,d){function e(c){if(0==g.deviceList.length)n.readout_sixteenSegmentDisplay.index.text(" n/a"),n.readout_sixteenSegmentDisplay.index.print(),n.readout_sixteenSegmentDisplay.text.text("no devices"),n.readout_sixteenSegmentDisplay.text.print("smart");else if(!(0>c||c>=g.deviceList.length)){g.currentSelection=c;for(selectionNum=""+(c+1);2>selectionNum.length;)selectionNum="0"+selectionNum;
for(totalNum=""+g.deviceList.length;2>totalNum.length;)totalNum="0"+totalNum;n.readout_sixteenSegmentDisplay.index.text(selectionNum+"/"+totalNum);n.readout_sixteenSegmentDisplay.index.print();var d=g.deviceList[c].deviceId;0<g.deviceList[c].label.length&&(d=g.deviceList[c].label+" - "+d);n.readout_sixteenSegmentDisplay.text.text(d);n.readout_sixteenSegmentDisplay.text.print("smart");l.circuitry.unit.selectDevice(g.deviceList[c].deviceId)}}d=void 0===d?!0:d;var g={deviceList:[],currentSelection:0},
k={background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",dim:"fill:rgb(20,20,20)"},h={up:"fill:rgba(180,180,180,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(170,170,170,1)",glow:"fill:rgba(220,200,220,1)"},n={type:"audioIn",x:c,y:f,base:{points:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},{x:50,y:40},{x:37.5,y:50},{x:22.5,y:50},{x:10,y:40},{x:0,y:40}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioOut",
data:{type:1,x:-10,y:15,width:20,height:20}},{type:"readout_sixteenSegmentDisplay",name:"index",data:{x:70,y:15,angle:0,width:50,height:20,count:5,style:k}},{type:"readout_sixteenSegmentDisplay",name:"text",data:{x:122.5,y:15,angle:0,width:100,height:20,count:10,style:k}},{type:"button_rect",name:"up",data:{x:225,y:15,width:15,height:10,style:h,onclick:function(){e(g.currentSelection+1)}}},{type:"button_rect",name:"down",data:{x:225,y:25,width:15,height:10,style:h,onclick:function(){e(g.currentSelection-
1)}}},{type:"dial_continuous",name:"outputGain",data:{x:30,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){l.circuitry.unit.gain(2*c)}}},{type:"label",name:"gainLabel_name",data:{x:21.25,y:44,text:"gain",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;",angle:0}},{type:"label",
name:"gainLabel_0",data:{x:15,y:40,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;",angle:0}},{type:"label",name:"gainLabel_1",data:{x:28.75,y:7,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;",angle:0}},{type:"label",name:"gainLabel_2",data:{x:42.5,y:40,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;",angle:0}},{type:"path",name:"upArrow",data:{path:[{x:227.5,y:22.5},{x:232.5,y:17.5},{x:237.5,y:22.5}],style:"fill:none; stroke:rgb(160,160,160); stroke-width:1;pointer-events: none;"}},
{type:"path",name:"downArrow",data:{path:[{x:227.5,y:27.5},{x:232.5,y:32.5},{x:237.5,y:27.5}],style:"fill:none; stroke:rgb(160,160,160); stroke-width:1;pointer-events: none;"}},{type:"audio_meter_level",name:"audioIn",data:{x:50,y:15,width:17.5,height:20}}]},l=__globals.utility.misc.objectBuilder(objects.audioIn,n);__globals.keyboardInteraction.declareKeycaptureObject(l,{none:["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"]}).keyPress=function(c){switch(c){case "ArrowUp":n.button_rect.up.click();
break;case "ArrowDown":n.button_rect.down.click();break;case "ArrowLeft":n.dial_continuous.outputGain.set(n.dial_continuous.outputGain.get()-.1);break;case "ArrowRight":n.dial_continuous.outputGain.set(n.dial_continuous.outputGain.get()+.1)}};l.circuitry={unit:new parts.circuits.audio.audioIn(__globals.audio.context,d)};l.circuitry.unit.out().connect(n.connectionNode_audio.audioOut.in());l.circuitry.unit.out().connect(n.audio_meter_level.audioIn.audioIn());l.circuitry.unit.listDevices(function(c){g.deviceList=
c});d&&setTimeout(function(){e(0)},500);n.dial_continuous.outputGain.set(.5);n.audio_meter_level.audioIn.start();return l};this.audio_scope=function(c,f){var d={type:"audio_scope",x:c,y:f,base:{points:[{x:0,y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],style:"fill:rgba(200,200,200,1);"},elements:[{type:"connectionNode_audio",name:"input",data:{type:0,x:195,y:5,width:10,height:20}},{type:"grapher_audioScope",name:"waveport",data:{x:5,y:5,width:150,height:100}},{type:"key_rect",name:"holdKey",data:{x:160,
y:5,width:30,height:20,style:{off:"fill:rgba(175,175,175,1)",press:"fill:rgba(220,220,220,1)",pressAndGlow:"fill:rgba(150,150,150,1)"},keydown:function(){d.grapher_audioScope.waveport.stop()},keyup:function(){d.grapher_audioScope.waveport.start()}}},{type:"text",name:"framerate_name",data:{x:161.5,y:70,text:"framerate",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"text",name:"framerate_1",data:{x:159,y:64,text:"1",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},
{type:"text",name:"framerate_15",data:{x:172,y:32,text:"15",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"text",name:"framerate_30",data:{x:188,y:64,text:"30",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"dial_continuous",name:"framerate",data:{x:175,y:50,r:12,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,250,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(c){d.grapher_audioScope.waveport.refreshRate(1+Math.floor(29*c))}}}]};c=__globals.utility.misc.objectBuilder(objects.audio_scope,d);d.connectionNode_audio.input.out().connect(d.grapher_audioScope.waveport.getNode());d.grapher_audioScope.waveport.start();d.dial_continuous.framerate.set(0);return c};this.audio_sink=function(c,f){var d={background:"fill:rgba(200,200,200,1)",level:{backing:"fill:rgb(10,10,10)",levels:["fill:rgb(250,250,250);","fill:rgb(200,200,200);"],marking:"fill:rgba(220,220,220,1); stroke:none; font-size:1px; font-family:Courier New;"}};
c={type:"audio_sink",x:c,y:f,base:{points:[{x:0,y:0},{x:100,y:0},{x:100,y:55},{x:0,y:55}],style:d.background},elements:[{type:"connectionNode_audio",name:"right",data:{type:0,x:90,y:5,width:20,height:20}},{type:"connectionNode_audio",name:"left",data:{type:0,x:90,y:30,width:20,height:20}},{type:"audio_meter_level",name:"right",data:{x:10,y:5,width:5,height:45,style:{backing:d.backing,levels:d.levels,markings:d.markings}}},{type:"audio_meter_level",name:"left",data:{x:5,y:5,width:5,height:45,style:{backing:d.backing,
levels:d.levels,markings:d.markings}}}]};f=__globals.utility.misc.objectBuilder(objects.audio_sink,c);var e=__globals.audio.destination;d=new ChannelMergerNode(__globals.audio.context,{numberOfInputs:2});c.connectionNode_audio.left.out().connect(c.audio_meter_level.left.audioIn());c.connectionNode_audio.right.out().connect(c.audio_meter_level.right.audioIn());c.connectionNode_audio.left.out().connect(d,0,0);c.connectionNode_audio.right.out().connect(d,0,1);d.connect(e);c.audio_meter_level.left.start();
c.audio_meter_level.right.start();return f};this.basicMixer=function(c,f){var d={type:"basicMixer",x:c,y:f,base:{points:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],style:"fill:rgba(200,200,200,0);"},elements:[{type:"connectionNode_audio",name:"input_0",data:{type:0,x:90,y:10,width:20,height:20}},{type:"connectionNode_audio",name:"input_1",data:{type:0,x:90,y:35,width:20,height:20}},{type:"connectionNode_audio",name:"input_2",data:{type:0,x:90,y:60,width:20,height:20}},{type:"connectionNode_audio",
name:"input_3",data:{type:0,x:90,y:85,width:20,height:20}},{type:"connectionNode_audio",name:"input_4",data:{type:0,x:90,y:110,width:20,height:20}},{type:"connectionNode_audio",name:"input_5",data:{type:0,x:90,y:135,width:20,height:20}},{type:"connectionNode_audio",name:"input_6",data:{type:0,x:90,y:160,width:20,height:20}},{type:"connectionNode_audio",name:"input_7",data:{type:0,x:90,y:185,width:20,height:20}},{type:"connectionNode_audio",name:"output_0",data:{type:1,x:-10,y:5,width:20,height:20}},
{type:"connectionNode_audio",name:"output_1",data:{type:1,x:-10,y:30,width:20,height:20}},{type:"path",name:"backing",data:{path:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],style:"fill:rgba(200,200,200,1);pointer-events:none;"}},{type:"text",name:"gain",data:{x:80,y:6.5,text:"gain",style:"fill:rgb(150,150,150); font-size:4px; font-family:Courier New;"}},{type:"text",name:"pan",data:{x:56.5,y:6.5,text:"pan",style:"fill:rgb(150,150,150); font-size:4px; font-family:Courier New;"}},{type:"rect",
name:"vertical",data:{x:22.5,y:6,width:2,height:190,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"overTheTop",data:{x:10,y:6,width:14,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"down",data:{x:10,y:6,width:2,height:35,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"inTo0",data:{x:2,y:14,width:10,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"inTo1",data:{x:2,
y:39,width:10,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}}]};for(c=0;8>c;c++)d.elements.push({type:"rect",name:"line_"+c,data:{x:23,y:19.1+25*c,width:75,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}}),d.elements.push({type:"dial_continuous",name:"gain_"+c,data:{x:85,y:20+25*c,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(c){return function(d){e["splitter_"+c].inGain(d)}}(c)}}),d.elements.push({type:"dial_continuous",name:"pan_"+c,data:{x:60,y:20+25*c,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){return function(d){e["splitter_"+c].outGain(0,d);e["splitter_"+c].outGain(1,1-d)}}(c)}});var e=__globals.utility.misc.objectBuilder(objects.basicMixer,
d);for(c=0;8>c;c++)e["splitter_"+c]=new parts.circuits.audio.channelMultiplier(__globals.audio.context,2),d.connectionNode_audio["input_"+c].out().connect(e["splitter_"+c].in()),e["splitter_"+c].out(0).connect(d.connectionNode_audio.output_0.in()),e["splitter_"+c].out(1).connect(d.connectionNode_audio.output_1.in());e.i={gain:function(c,e){d.dial_continuous["gain_"+c].set(e)},pan:function(c,e){d.dial_continuous["pan_"+c].set(e)}};for(c=0;8>c;c++)e.i.gain(c,.5),e.i.pan(c,.5);return e};this.basicSequencer=
function(c,f,d){var e={type:"basicSequencer",x:c,y:f,base:{type:"path",points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"sequencer",name:"main",data:{x:10,y:20,width:780,height:170,xCount:64,yCount:10,event:function(c){for(var d=0;d<c.length;d++)e.connectionNode_data["output_"+c[d].line].send("hit",{velocity:c[d].strength})},onchangeviewarea:function(c){e.rangeslide.viewselect.set({start:c.left,end:c.right},!1)}}},
{type:"rangeslide",name:"viewselect",data:{x:10,y:20,height:780,width:10,angle:-Math.PI/2,handleHeight:.03125,spanWidth:1,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(220,220,220,1)"},onchange:function(c){e.sequencer.main.viewArea({left:c.start,right:c.end},!1)}}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"fill:rgba(229, 229, 229,1)",
check:"fill:rgba(252,252,252,1)"},onchange:function(c){e.sequencer.main.automove(c)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"fill:rgba(229, 221, 112,1)",check:"fill:rgba(252,244,128,1)"},onchange:function(c){e.sequencer.main.loopActive(c)}}},{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/2,handleHeight:.03125,spanWidth:.75,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",
invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(255,247,145,0.5)"},onchange:function(c){var d=Math.round(64*c.start);c=Math.round(64*c.end);0==c&&(c=1);e.sequencer.main.loopPeriod(d,c)}}},{type:"button_rect",name:"progress",data:{x:10,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",down:"fill:rgba(180,180,180,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){e.sequencer.main.progress()}}},{type:"connectionNode_data",name:"progress",data:{x:800,
y:5,width:5,height:20,receive:function(){e.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{path:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"button_rect",name:"reset",data:{x:40,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",down:"fill:rgba(180,180,180,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){e.sequencer.main.playheadPosition(0)}}},
{type:"connectionNode_data",name:"reset",data:{x:800,y:30,width:5,height:20,receive:function(){e.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{path:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"path",name:"reset_line",data:{path:[{x:49,y:209},{x:49,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}}]};for(c=0;10>c;c++)e.elements.push({type:"connectionNode_data",
name:"output_"+c,data:{x:-5,y:11+18*c,width:5,height:16,receive:function(){e.sequencer.main.playheadPosition(0)}}});var g=__globals.utility.misc.objectBuilder(objects.basicSequencer,e);g.exportData=function(){return{loop:{active:e.checkbox_rect.loopActive.get(),range:e.sequencer.main.loopPeriod()},autofollow:e.checkbox_rect.followPlayhead.get(),notes:e.sequencer.main.getAllNotes()}};g.importData=function(c){e.sequencer.main.addNotes(c.notes);g.i.loopActive(c.loop.active);e.rangeslide.loopSelect.set(c.loop.range);
e.checkbox_rect.followPlayhead.set(c.autofollow)};g.i={addNote:function(c,d,f,g){e.sequencer.main.addNote(c,d,f,void 0===g?1:g)},addNotes:function(c){e.sequencer.main.addNotes(c)},getNotes:function(){return e.sequencer.main.getAllNotes()},loopActive:function(c){e.checkbox_rect.loopActive.set(c)}};return g};this.basicSequencer_midiOut=function(c,f,d){d=[0,0,1,0,1,0,1,0,0,1,0,1];var e=d.length-"C C# D D# E F F# G G# A A# B".split(" ").indexOf(__globals.audio.num2name(131).slice(1));d=d.slice(e).concat(d.slice(0,
e));var g={type:"basicSequencer_midiOut",x:c,y:f,base:{type:"path",points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"midiout",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"sequencer",name:"main",data:{x:20,y:20,width:770,height:170,xCount:64,yCount:108,event:function(c){for(var d=0;d<c.length;d++)g.connectionNode_data.midiout.send("midinumber",{num:131-c[d].line,velocity:c[d].strength})},
style:{horizontalStrip_pattern:d},onchangeviewarea:function(c){g.rangeslide.viewselect_x.set({start:c.left,end:c.right},!1);g.rangeslide.viewselect_y.set({start:c.top,end:c.bottom},!1)}}},{type:"rangeslide",name:"viewselect_y",data:{x:10,y:20,height:170,width:10,angle:0,handleHeight:.0625,spanWidth:1,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(220,220,220,1)"},onchange:function(c){g.sequencer.main.viewArea({top:c.start,
bottom:c.end},!1)}}},{type:"rangeslide",name:"viewselect_x",data:{x:20,y:20,height:770,width:10,angle:-Math.PI/2,handleHeight:.03125,spanWidth:1,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(220,220,220,1)"},onchange:function(c){g.sequencer.main.viewArea({left:c.start,right:c.end},!1)}}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"fill:rgba(229, 229, 229,1)",
check:"fill:rgba(252,252,252,1)"},onchange:function(c){g.sequencer.main.automove(c)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"fill:rgba(229, 221, 112,1)",check:"fill:rgba(252,244,128,1)"},onchange:function(c){g.sequencer.main.loopActive(c)}}},{type:"rangeslide",name:"loopSelect",data:{x:20,y:200,height:770,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:.75,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",
invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(255,247,145,0.5)"},onchange:function(c){var d=Math.round(64*c.start);c=Math.round(64*c.end);0==c&&(c=1);g.sequencer.main.loopPeriod(d,c)}}},{type:"button_rect",name:"progress",data:{x:10,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",down:"fill:rgba(180,180,180,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){g.sequencer.main.progress()}}},{type:"connectionNode_data",name:"progress",data:{x:800,
y:5,width:5,height:20,receive:function(){g.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{path:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"button_rect",name:"reset",data:{x:40,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",down:"fill:rgba(180,180,180,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){g.sequencer.main.playheadPosition(0)}}},
{type:"connectionNode_data",name:"reset",data:{x:800,y:30,width:5,height:20,receive:function(){g.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{path:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"path",name:"reset_line",data:{path:[{x:49,y:209},{x:49,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}}]},k=__globals.utility.misc.objectBuilder(objects.basicSequencer_midiOut,
g);k.exportData=function(){return{loop:{active:g.checkbox_rect.loopActive.get(),range:g.sequencer.main.loopPeriod()},autofollow:g.checkbox_rect.followPlayhead.get(),notes:g.sequencer.main.getAllNotes(),viewArea:g.sequencer.main.viewArea()}};k.importData=function(c){g.sequencer.main.addNotes(c.notes);k.i.loopActive(c.loop.active);g.rangeslide.loopSelect.set(c.loop.range);g.checkbox_rect.followPlayhead.set(c.autofollow);g.sequencer.main.viewArea(c.viewArea)};k.i={addNote:function(c,d,e,f){g.sequencer.main.addNote(131-
c,d,e,void 0===f?1:f)},addNotes:function(c){for(var d=0;d<c.length;d++)this.addNote(c[d].line,c[d].position,c[d].length,c[d].strength)},getNotes:function(){return g.sequencer.main.getAllNotes()},loopActive:function(c){g.checkbox_rect.loopActive.set(c)},stepSize:g.sequencer.main.step};g.rangeslide.viewselect_y.set({start:.3,end:.7});return k};this.basicSynthesizer=function(c,f){var d={type:"basicSynthesizer",x:c,y:f,base:{points:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],
style:"fill:rgba(200,200,200,1);"},elements:[{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-15,y:5,width:15,height:30}},{type:"connectionNode_data",name:"gain",data:{x:12.5,y:-7.5,width:15,height:7.5,receive:function(c,f){switch(c){case "%":d.dial_continuous.gain.set(f);break;case "%t":e.__synthesizer.gain(f.target,f.time,f.curve),d.dial_continuous.gain.smoothSet(f.target,f.time,f.curve,!1)}}}},{type:"connectionNode_data",name:"attack",data:{x:52.5,y:-7.5,width:15,height:7.5,receive:function(c,
e){"%"==c&&d.dial_continuous.attack.set(e)}}},{type:"connectionNode_data",name:"release",data:{x:92.5,y:-7.5,width:15,height:7.5,receive:function(c,e){"%"==c&&d.dial_continuous.release.set(e)}}},{type:"connectionNode_data",name:"detune",data:{x:132.5,y:-7.5,width:15,height:7.5,receive:function(c,f){switch(c){case "%":d.dial_continuous.detune.set(f);break;case "%t":e.__synthesizer.detune(200*f.target+-100,f.time,f.curve),d.dial_continuous.detune.smoothSet(f.target,f.time,f.curve,!1)}}}},{type:"connectionNode_data",
name:"octave",data:{x:170.5,y:-7.5,width:15,height:7.5,receive:function(c,e){"discrete"==c&&d.dial_discrete.octave.select(e)}}},{type:"connectionNode_data",name:"waveType",data:{x:210.5,y:-7.5,width:15,height:7.5,receive:function(c,e){"discrete"==c&&d.dial_discrete.waveType.select(e)}}},{type:"connectionNode_data",name:"periodicWave",data:{x:240,y:12.5,width:7.5,height:15,receive:function(c,d){"periodicWave"==c&&e.__synthesizer.periodicWave(d)}}},{type:"connectionNode_data",name:"midiNote",data:{x:225,
y:55,width:15,height:30,angle:Math.PI/4,receive:function(c,d){"midinumber"==c&&e.__synthesizer.perform(d)}}},{type:"connectionNode_data",name:"gainWobblePeriod",data:{x:22.5,y:90,width:15,height:7.5,receive:function(c,e){"%"==c&&d.dial_continuous.gainWobblePeriod.set(e)}}},{type:"connectionNode_data",name:"gainWobbleDepth",data:{x:57.5,y:90,width:15,height:7.5,receive:function(c,e){"%"==c&&d.dial_continuous.gainWobbleDepth.set(e)}}},{type:"connectionNode_data",name:"detuneWobblePeriod",data:{x:107.5,
y:90,width:15,height:7.5,receive:function(c,e){"%"==c&&d.dial_continuous.detuneWobblePeriod.set(e)}}},{type:"connectionNode_data",name:"detuneWobbleDepth",data:{x:142.5,y:90,width:15,height:7.5,receive:function(c,e){"%"==c&&d.dial_continuous.detuneWobbleDepth.set(e)}}},{type:"text",name:"gain_gain",data:{x:11,y:43,text:"gain",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"gain_0",data:{x:7,y:37,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"gain_1/2",data:{x:16.5,y:7,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gain_1",data:{x:30,y:37,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"gain",data:{x:20,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(c){e.__synthesizer.gain(c)}}},{type:"text",name:"attack_gain",data:{x:47,y:43,text:"attack",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"attack_0",data:{x:47,y:37,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"attack_5",data:{x:58.5,y:7,text:"5",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"attack_10",data:{x:70,y:37,text:"10",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_continuous",name:"attack",data:{x:60,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.__synthesizer.attack(c)}}},{type:"text",name:"release_gain",data:{x:85,y:43,text:"release",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"release_0",
data:{x:85,y:37,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"release_5",data:{x:98.5,y:7,text:"5",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"release_10",data:{x:110,y:37,text:"10",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"release",data:{x:100,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",
slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.__synthesizer.release(c)}}},{type:"text",name:"detune_gain",data:{x:127,y:43,text:"detune",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"detune_-100",data:{x:122,y:37,text:"-100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detune_0",data:{x:138.5,y:7,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"detune_100",data:{x:150,y:37,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"detune",data:{x:140,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.__synthesizer.detune(200*c+-100)}}},{type:"text",name:"octave_gain",
data:{x:167,y:43,text:"octave",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"octave_-3",data:{x:164,y:35,text:"-3",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_-2",data:{x:160,y:24,text:"-2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_-1",data:{x:164,y:13,text:"-1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_0",
data:{x:178.75,y:8,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_1",data:{x:190,y:13,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_2",data:{x:195,y:24,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_3",data:{x:190,y:35,text:"3",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_discrete",name:"octave",
data:{x:180,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:7,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(c){e.__synthesizer.octave(c-3)}}},{type:"text",name:"waveType_gain",data:{x:211,y:43,text:"wave",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"waveType_sin",data:{x:202,y:35,text:"sin",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"waveType_tri",data:{x:199,y:21,text:"tri",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"waveType_squ",data:{x:210,y:9,text:"squ",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"waveType_saw",data:{x:227,y:10,text:"saw",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"rect",name:"periodicWaveType",data:{x:230,y:21.75,angle:0,width:10,height:2.5,style:"fill:rgba(50,50,50,1)"}},
{type:"dial_discrete",name:"waveType",data:{x:220,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:5*Math.PI/4,optionCount:5,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(c){e.__synthesizer.waveType(["sine","triangle","square","sawtooth","custom"][c])}}},{type:"text",name:"gainWobble",data:{x:13,y:70,angle:-Math.PI/2,text:"gain",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_gain",
data:{x:21,y:84,text:"rate",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_0",data:{x:16,y:77,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_50",data:{x:27.5,y:49,text:"50",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_100",data:{x:42,y:77,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_continuous",name:"gainWobblePeriod",data:{x:30,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.__synthesizer.gainWobblePeriod(.01>1-c?.011:1-c)}}},{type:"text",name:"gainWobbleDepth_gain",data:{x:54,y:84,text:"depth",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},
{type:"text",name:"gainWobbleDepth_0",data:{x:51,y:77,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobbleDepth_50",data:{x:61,y:49,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobbleDepth_100",data:{x:77,y:77,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"gainWobbleDepth",data:{x:65,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*
Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.__synthesizer.gainWobbleDepth(c)}}},{type:"text",name:"detuneWobble",data:{x:98,y:70,angle:-Math.PI/2,text:"detune",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobblePeriod_gain",data:{x:105,y:84,text:"rate",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},
{type:"text",name:"detuneWobblePeriod_0",data:{x:100,y:77,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobblePeriod_50",data:{x:111.5,y:49,text:"50",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobblePeriod_100",data:{x:126,y:77,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"detuneWobblePeriod",data:{x:114,y:65,r:12,startAngle:3*
Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.__synthesizer.detuneWobblePeriod(.01>1-c?.011:1-c)}}},{type:"text",name:"detuneWobbleDepth_gain",data:{x:140,y:84,text:"depth",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"detuneWobbleDepth_0",data:{x:135,y:77,text:"0",
style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobbleDepth_50",data:{x:145.5,y:49,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobbleDepth_100",data:{x:161,y:77,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"detuneWobbleDepth",data:{x:149,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",
slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.__synthesizer.detuneWobbleDepth(100*c)}}},{type:"button_rect",name:"panicButton",data:{x:197.5,y:47.5,width:20,height:20,angle:Math.PI/4,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){e.__synthesizer.panic()}}},{type:"path",name:"selectionGlow",
data:{path:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],style:"pointer-events:none; fill:none; "}}]},e=__globals.utility.misc.objectBuilder(objects.basicSynthesizer,d);e.exportData=function(){return{gain:d.dial_continuous.gain.get(),attack:10*d.dial_continuous.attack.get(),release:10*d.dial_continuous.release.get(),detune:100*(2*d.dial_continuous.detune.get()-1),octave:d.dial_discrete.octave.select()-3,waveType:["sine","triangle","square","sawtooth","custom"][d.dial_discrete.waveType.select()],
gainWobble:{rate:100*d.dial_continuous.gainWobblePeriod.get(),depth:d.dial_continuous.gainWobbleDepth.get()},detuneWobble:{rate:100*d.dial_continuous.detuneWobblePeriod.get(),depth:d.dial_continuous.detuneWobbleDepth.get()}}};e.importData=function(c){d.dial_continuous.gain.set(c.gain);d.dial_continuous.attack.set(c.attack/10);d.dial_continuous.release.set(c.release/10);d.dial_continuous.detune.set((1+c.detune/100)/2);d.dial_discrete.octave.select(c.octave+3);d.dial_discrete.waveType.select(["sine",
"triangle","square","sawtooth","custom"].indexOf(c.waveType));d.dial_continuous.gainWobblePeriod.set(c.gainWobble.rate/100);d.dial_continuous.gainWobbleDepth.set(c.gainWobble.depth);d.dial_continuous.detuneWobblePeriod.set(c.detuneWobble.rate/100);d.dial_continuous.detuneWobbleDepth.set(c.detuneWobble.depth)};e.onSelect=function(){__globals.utility.element.setStyle(d.path.selectionGlow,"pointer-events:none; fill:none; stroke:rgb(255, 237, 147); stroke-width:2; stroke-linecap:round;")};e.onDeselect=
function(){__globals.utility.element.setStyle(d.path.selectionGlow,"pointer-events:none; fill:none; ")};e.__synthesizer=new parts.circuits.audio.synthesizer2(__globals.audio.context);e.__synthesizer.out().connect(d.connectionNode_audio.audioOut.in());e.i={gain:function(c){d.dial_continuous.gain.set(c)},attack:function(c){d.dial_continuous.attack.set(c)},release:function(c){d.dial_continuous.release.set(c)},detune:function(c){d.dial_continuous.detune.set(c)},octave:function(c){d.dial_discrete.octave.select(c)},
waveType:function(c){d.dial_discrete.waveType.select(c)},periodicWave:function(c){e.__synthesizer.periodicWave(c)},midiNote:function(c){e.__synthesizer.perform(c)},gainWobblePeriod:function(c){d.dial_continuous.gainWobblePeriod.set(c)},gainWobbleDepth:function(c){d.dial_continuous.gainWobbleDepth.set(c)},detuneWobblePeriod:function(c){d.dial_continuous.detuneWobblePeriod.set(c)},detuneWobbleDepth:function(c){d.dial_continuous.detuneWobbleDepth.set(c)}};d.dial_continuous.gain.set(.5);d.dial_continuous.detune.set(.5);
d.dial_discrete.octave.select(3);return e};this.data_duplicator=function(c,f){var d=__globals.utility.misc.objectBuilder(objects.data_duplicator,{type:"data_duplicator",x:c,y:f,base:{points:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,0);"},elements:[{type:"connectionNode_data",name:"output_1",data:{x:-10,y:5,width:20,height:20}},{type:"connectionNode_data",name:"output_2",data:{x:-10,y:30,width:20,height:20}},{type:"connectionNode_data",name:"input",data:{x:45,y:5,width:20,
height:20,receive:function(c,f){d.io.output_1.send(c,f);d.io.output_2.send(c,f)}}},{type:"path",name:"backing",data:{path:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1);pointer-events:none;"}},{type:"path",name:"upperArrow",data:{path:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"path",name:"lowerArrow",data:{path:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",
name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}}]});return d};this.distortionUnit=function(c,f){var d={type:"distortionUnit",x:c,y:f,base:{points:[{x:0,y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,
y:10},{x:102.5*.55,y:10},{x:102.5/3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioIn",data:{type:0,x:102.5,y:61.5,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-10,y:61.5,width:10,height:20}},{type:"label",name:"outGain_title",data:{x:17.5,y:91,text:"out",
style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"outGain_0",data:{x:9.5,y:85.5,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"outGain_1/2",data:{x:19,y:57,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"outGain_1",data:{x:33,y:85.5,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"outGain",data:{x:22.5,
y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.distortionCircuit.outGain(c)}}},{type:"label",name:"distortionAmount_title",data:{x:15.5,y:41.5,text:"dist",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"distortionAmount_0",data:{x:9.5,y:36,text:"0",
style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"distortionAmount_50",data:{x:20,y:7.5,text:"50",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"distortionAmount_100",data:{x:33,y:36,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"distortionAmount",data:{x:22.5,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",
slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.distortionCircuit.distortionAmount(100*c)}}},{type:"label",name:"resolution_title",data:{x:47,y:66,text:"res",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"resolution_2",data:{x:39,y:60,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"resolution_50",data:{x:49,
y:32,text:"500",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"resolution_100",data:{x:63,y:60,text:"1000",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"resolution",data:{x:52.5,y:47.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(c){e.distortionCircuit.resolution(Math.round(1E3*c))}}},{type:"label",name:"overSample_title",data:{x:67,y:41.5,text:"overSamp",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"overSample_0",data:{x:61,y:12,text:"none",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"overSample_50",data:{x:77.5,y:7.5,text:"2x",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"overSample_100",
data:{x:90.5,y:12,text:"4x",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_discrete",name:"overSample",data:{x:80,y:23,r:12,startAngle:1.25*Math.PI,maxAngle:.5*Math.PI,arcDistance:1.35,optionCount:3,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(c){e.distortionCircuit.oversample(["none","2x","4x"][c])}}},{type:"label",name:"inGain_title",data:{x:76,y:91,text:"in",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},
{type:"label",name:"inGain_0",data:{x:67,y:85.5,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"inGain_1/2",data:{x:76.5,y:57,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"inGain_1",data:{x:90.5,y:85.5,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"inGain",data:{x:80,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,
style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e.distortionCircuit.inGain(2*c)}}}]},e=__globals.utility.misc.objectBuilder(objects.distortionUnit,d);e.importData=function(c){d.dial_continuous.outGain.set(c.outGain);d.dial_continuous.distortionAmount.set(c.distortionAmount);d.dial_continuous.resolution.set(c.resolution);d.dial_discrete.overSample.select(c.overSample);
d.dial_continuous.inGain.set(c.inGain)};e.exportData=function(){return{outGain:d.dial_continuous.outGain.get(),distortionAmount:d.dial_continuous.distortionAmount.get(),resolution:d.dial_continuous.resolution.get(),overSample:d.dial_discrete.overSample.select(),inGain:d.dial_continuous.inGain.get()}};e.distortionCircuit=new parts.circuits.audio.distortionUnit(__globals.audio.context);d.connectionNode_audio.audioIn.out().connect(e.distortionCircuit.in());e.distortionCircuit.out().connect(d.connectionNode_audio.audioOut.in());
d.dial_continuous.resolution.set(.5);d.dial_continuous.inGain.set(.5);d.dial_continuous.outGain.set(1);return e};this.filterUnit=function(c,f){function d(){for(var c=[],d=[],e=0;e<=Math.floor(Math.log10(g.freqRange.high))+1;e++)for(var f=1;10>f&&!(f/10*Math.pow(10,e)>=g.freqRange.high);f+=1/Math.pow(2,g.graphDetail))c.push(Math.log10(Math.pow(10,e)*f)),d.push(f/10*Math.pow(10,e));return{frequency:d,location:__globals.utility.math.normalizeStretchArray(c)}}function e(){var c=d();k.grapherCanvas.graph.draw(h.filterCircuit.measureFrequencyResponse_values(c.frequency)[0],
c.location)}var g={freqRange:{low:.1,high:2E4},graphDetail:3},k={type:"filterUnit",x:c,y:f,base:{points:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},{x:0,y:70}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioIn",data:{type:0,x:94.8,y:16,width:10,height:20,angle:-.14}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-2.3,y:16,width:10,height:20,angle:.144}},{type:"grapherCanvas",name:"graph",data:{x:15,y:5,width:72.5,height:50,
style:{foreground:["stroke:rgba(0,200,163,1); stroke-width:0.5; stroke-linecap:round;"],background:"stroke:rgba(0,200,163,0.25); stroke-width:0.25;",backgroundText:"fill:rgba(0,200,163,0.75); font-size:1; font-family:Helvetica;"}}},{type:"label",name:"Q_0",data:{x:74,y:76,text:"0",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"Q_1/2",data:{x:79.5,y:59.5,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"Q_1",
data:{x:89,y:76,text:"1",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"Q_title",data:{x:81,y:79,text:"Q",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"Q",data:{x:82.5,y:68.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:0.5;"},
onchange:function(c){h.filterCircuit.Q(10*c);e()}}},{type:"label",name:"gain_0",data:{x:54,y:86,text:"0",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"gain_1/2",data:{x:61.5,y:68.5,text:"5",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"gain_1",data:{x:69,y:86,text:"10",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"gain_title",data:{x:58,y:89,text:"Gain",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_continuous",name:"gain",data:{x:62.5,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:0.5;"},onchange:function(c){h.filterCircuit.gain(10*c);e()}}},{type:"label",name:"frequency_0",data:{x:31.5,y:86,text:"0",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"frequency_100",
data:{x:38.25,y:68.5,text:"100",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"frequency_20000",data:{x:46.5,y:86,text:"20000",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"frequency_title",data:{x:35.5,y:89,text:"Freq",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"frequency",data:{x:40,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",
slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:0.5;"},onchange:function(c){h.filterCircuit.frequency(__globals.utility.math.curvePoint.exponential(c,0,2E4,10.5866095));e()}}},{type:"label",name:"type_lowp",data:{x:10,y:74.5,text:"lowp",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_highp",data:{x:5,y:69,text:"highp",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},
{type:"label",name:"type_band",data:{x:8,y:63,text:"band",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_lows",data:{x:14,y:59,text:"lows",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_highs",data:{x:22.5,y:59.5,text:"highs",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_peak",data:{x:27.5,y:63,text:"peak",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},
{type:"label",name:"type_notch",data:{x:29,y:69,text:"notch",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_all",data:{x:25.5,y:74.5,text:"all",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_title",data:{x:15.5,y:78.5,text:"Type",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_discrete",name:"type",data:{x:20,y:67.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,
optionCount:8,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(c){h.filterCircuit.type("lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ")[c]);e()}}}]},h=__globals.utility.misc.objectBuilder(objects.filterUnit,k);h.importData=function(c){k.dial_continuous.Q.set(c.Q);k.dial_continuous.gain.set(c.gain);k.dial_discrete.type.select(c.type);k.dial_continuous.frequency.set(c.frequency)};h.exportData=function(){return{Q:k.dial_continuous.Q.get(),
gain:k.dial_continuous.gain.get(),type:k.dial_discrete.type.select(),frequency:k.dial_continuous.frequency.get()}};h.filterCircuit=new parts.circuits.audio.filterUnit(__globals.audio.context);k.connectionNode_audio.audioIn.out().connect(h.filterCircuit.in());h.filterCircuit.out().connect(k.connectionNode_audio.audioOut.in());c=d();c.frequency=c.frequency.filter(function(c,d){return 0==d%Math.pow(2,g.graphDetail)});c.location=c.location.filter(function(c,d){return 0==d%Math.pow(2,g.graphDetail)});
k.grapherCanvas.graph.viewbox({bottom:0,top:2});k.grapherCanvas.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});k.grapherCanvas.graph.verticalMarkings({points:c.location,printingValues:c.frequency.map(function(c){return 0==Math.log10(c)%1?c:""}).slice(0,c.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});k.grapherCanvas.graph.drawBackground();k.dial_discrete.type.select(0);k.dial_continuous.Q.set(0);k.dial_continuous.gain.set(.1);
k.dial_continuous.frequency.set(.5);setTimeout(e,100);return h};this.launchpad=function(c,f,d){function e(){for(var c=0;c<g.yCount;c++)k.rastorgrid.rastorgrid.light(h.internalCircuits.previousPosition(),c,!1),k.rastorgrid.rastorgrid.light(h.internalCircuits.position(),c,!0)}var g={xCount:8,yCount:8},k={type:"launchpad",x:c,y:f,base:{type:"path",points:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",
name:"pulse",data:{x:125,y:5,width:5,height:10,receive:function(){h.internalCircuits.inc();e()}}},{type:"connectionNode_data",name:"nextPage",data:{x:125,y:22.5,width:5,height:10,receive:function(){h.internalCircuits.incPage()}}},{type:"connectionNode_data",name:"prevPage",data:{x:125,y:35,width:5,height:10,receive:function(){h.internalCircuits.decPage()}}},{type:"button_rect",name:"pulse",data:{x:100,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)"},
onmousedown:function(){h.internalCircuits.inc();e()}}},{type:"rastorgrid",name:"rastorgrid",data:{x:5,y:5,width:90,height:90,xCount:g.xCount,yCount:g.yCount,style:{backing:"fill:rgba(200,175,200,1)",check:"fill:rgba(150,125,150,1)",backingGlow:"fill:rgba(225,175,225,1)",checkGlow:"fill:rgba(200,125,200,1)"},onchange:function(c){h.internalCircuits.importPage(c)}}},{type:"sevenSegmentDisplay",name:"pageNumber",data:{x:100,y:22.5,width:20,height:22.5,style:{background:"fill:rgba(200,175,200,1)",glow:"fill:rgba(225,225,225,1)",
dim:"fill:rgba(150,125,150,1"}}},{type:"button_rect",name:"nextPage",data:{x:102.5,y:17.5,width:15,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)"},onmousedown:function(){h.internalCircuits.incPage()}}},{type:"button_rect",name:"prevPage",data:{x:102.5,y:45,width:15,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)"},onmousedown:function(){h.internalCircuits.decPage()}}}]};for(c=
0;c<g.yCount;c++)k.elements.push({type:"connectionNode_data",name:"out_"+c,data:{x:-5,y:12.5*c+2.5,width:5,height:7.5}});var h=__globals.utility.misc.objectBuilder(objects.launchpad,k);h.exportData=function(){return{currentPage:h.internalCircuits.page(),data:h.internalCircuits.exportPages()}};h.importData=function(c){void 0!=c.data&&h.internalCircuits.importPages(c.data);c.currentPage&&h.internalCircuits.page(c.currentPage)};h.internalCircuits=new parts.circuits.sequencing.launchpad(g.xCount,g.yCount);
h.internalCircuits.commands=function(c){for(var d=0;d<g.yCount;d++)c[d]&&h.io["out_"+d].send("pulse")};h.internalCircuits.pageChange=function(c){k.sevenSegmentDisplay.pageNumber.enterCharacter(""+c);c=h.internalCircuits.exportPage();void 0==c?k.rastorgrid.rastorgrid.clear():k.rastorgrid.rastorgrid.set(c)};h.i={importPage:function(c,d){h.internalCircuits.importPage(c,d)},exportPage:function(c){return h.internalCircuits.exportPage(c)},importPages:function(c){h.internalCircuits.importPages(c)},exportPages:function(){return h.internalCircuits.exportPages()},
setPage:function(c){h.internalCircuits.page(c)}};e();k.sevenSegmentDisplay.pageNumber.enterCharacter("0");return h};this.looper=function(c,f,d){var e={type:"looper",x:c,y:f,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}},{type:"connectionNode_data",name:"trigger",
data:{x:220,y:17.5,width:10,height:20,receive:function(c,d){e.button_rect.fire.click()}}},{type:"circle",name:"symbol_outterCircle1",data:{x:11.5,y:41,r:6,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_outterCircle2",data:{x:18.5,y:41,r:6,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"rect",name:"symbol_blockingrect",data:{x:11.5,y:34,width:7,height:15,style:"fill:rgba(200,200,200,1)"}},
{type:"path",name:"symbol_upperarrow",data:{path:[{x:13.5,y:32.5},{x:16.5,y:35},{x:13.5,y:37.5}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"path",name:"symbol_lowerarrow",data:{path:[{x:16.5,y:44.75},{x:13.5,y:47.25},{x:16.5,y:49.75}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",
down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){g.looper.load("file",function(c){e.grapher_waveWorkspace.grapher_waveWorkspace.draw(g.looper.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",down:"fill:rgba(150,170,150,1)",glow:"fill:rgba(220,220,220,1)"},onclick:function(){function c(){k&&(e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0),
clearTimeout(h));e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,0,"transition: transform "+d+"s;transition-timing-function: linear;");setTimeout(function(){e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,1)},1);k=!0;h=setTimeout(c,1E3*d)}if(!(0>g.looper.duration())){g.looper.start();var d=g.looper.duration();c()}}}},{type:"button_rect",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",down:"fill:rgba(170,150,150,1)",
glow:"fill:rgba(240,200,220,1)"},onclick:function(){g.looper.stop();k&&(e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0),k=!1,clearTimeout(h))}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]},g=__globals.utility.misc.objectBuilder(objects.looper,e),k=void 0,h=void 0;g.looper=new parts.circuits.audio.looper(__globals.audio.context);g.looper.out_right().connect(e.connectionNode_audio.outRight.in());g.looper.out_left().connect(e.connectionNode_audio.outLeft.in());
return g};this.musicalkeyboard=function(c,f,d){var e=.5,g={type:"musicalkeyboard",x:c,y:f,base:{type:"path",points:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},{x:0,y:62.5}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"midiout",data:{x:-5,y:5,width:5,height:10}},{type:"connectionNode_data",name:"midiin",data:{x:320,y:5,width:5,height:10,receive:function(c,d){"midinumber"==c&&(0<d.velocity?g.key_rect[__globals.audio.num2name(d.num)].press():g.key_rect[__globals.audio.num2name(d.num)].release())}}},
{type:"label",name:"velocity_title",data:{x:9,y:59,text:"velocity",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"velocity_0",data:{x:4,y:55,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"velocity_1/2",data:{x:14,y:26.5,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"velocity_1",data:{x:28,y:55,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_continuous",name:"velocity",data:{x:17.5,y:42,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){e=c}}}]},k="\\azsxcfvgbhnmk,l./1q2w3er5t6yu8i9o0p[".split(""),h="4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C".split(" ");
d=35;c=45;for(f=0;f<k.length;f++)"#"!=h[f].slice(-1)&&(g.elements.push({type:"key_rect",name:h[f],data:{x:d,y:12.5,width:12.5,height:50,style:{off:"fill:rgba(250,250,250,1)",press:"fill:rgba(230,230,230,1)",glow:"fill:rgba(220,200,220,1)",pressAndGlow:"fill:rgba(200,150,200,1)"},keydown:function(){n.io.midiout.send("midinumber",{num:__globals.audio.name2num(this.id),velocity:e})},keyup:function(){n.io.midiout.send("midinumber",{num:__globals.audio.name2num(this.id),velocity:0})}}}),d+=12.5);for(f=
d=0;f<k.length;f++)"#"==h[f].slice(-1)?(g.elements.push({type:"key_rect",name:h[f],data:{x:c,y:12.5,width:5,height:30,style:{off:"fill:rgba(50,50,50,1)",press:"fill:rgba(100,100,100,1)",glow:"fill:rgba(220,200,220,1)",pressAndGlow:"fill:rgba(200,150,200,1)"},keydown:function(){n.io.midiout.send("midinumber",{num:__globals.audio.name2num(this.id),velocity:e})},keyup:function(){n.io.midiout.send("midinumber",{num:__globals.audio.name2num(this.id),velocity:0})}}}),c+=12.5,d=0):d++,1<d&&(c+=12.5);var n=
__globals.utility.misc.objectBuilder(objects.musicalkeyboard,g);c=__globals.keyboardInteraction.declareKeycaptureObject(n,{none:k});c.keyPress=function(c){g.key_rect[h[k.indexOf(c)]].press()};c.keyRelease=function(c){g.key_rect[h[k.indexOf(c)]].release()};n.i={velocity:function(c){g.dial_continuous.velocity.set(c)}};g.dial_continuous.velocity.set(.5);return n};this.oneShot_multi=function(c,f,d){var e={type:"oneShot_multi",x:c,y:f,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1)"},
elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,receive:function(c,d){e.button_rect.fire.click()}}},{type:"path",name:"symbol_arrow",data:{path:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"rect",
name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"circle",name:"symbol_outterCircle",data:{x:10,y:40,r:5.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_infCircle1",data:{x:8.5,y:40,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_infCircle2",data:{x:11.5,y:40,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},
{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){g.oneShot.load("file",function(c){e.grapher_waveWorkspace.grapher_waveWorkspace.draw(g.oneShot.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",down:"fill:rgba(150,170,150,1)",
glow:"fill:rgba(220,220,220,1)"},onclick:function(){var c=g.oneShot,d=e.grapher_waveWorkspace.grapher_waveWorkspace;if(!(0>c.duration())){var f=void 0!=d.area().A?d.area().A:0,m=void 0!=d.area().B?d.area().B:1,p=c.duration(),r=f*p;p=m*p-r;c.fire(r,p);for(var t=0;t in k;)t++;k[t]={};e.glowbox_rect.glowbox_rect.on();setTimeout(function(){e.glowbox_rect.glowbox_rect.off()},100);d.genericNeedle(t,f,"transition: transform "+p+"s; transition-timing-function: linear;");setTimeout(function(c){d.genericNeedle(t,
c)},1,m);k[t].timeout=setTimeout(function(){d.genericNeedle(t);delete k[t]},1E3*p)}}}},{type:"button_rect",name:"panic",data:{x:15,y:17.5,width:10,height:10,style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",down:"fill:rgba(170,150,150,1)",glow:"fill:rgba(220,220,220,1)"},onclick:function(){var c=e.grapher_waveWorkspace.grapher_waveWorkspace;g.oneShot.panic();for(var d=Object.keys(k),f=0;f<d.length;f++)void 0!=k[f]&&(clearTimeout(k[f].timeout),c.genericNeedle(f),delete k[f])}}},
{type:"slide",name:"rate",data:{x:26.25,y:5,width:5,height:45,value:.5,resetValue:.5,style:{handle:"fill:rgba(220,220,220,1)"},onchange:function(c){g.oneShot.rate(2*(1-c))}}},{type:"glowbox_rect",name:"glowbox_rect",data:{x:32.5,y:5,width:2.5,height:45}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:35,y:5,width:180,height:45,selectNeedle:!1,selectionArea:!0}}]},g=__globals.utility.misc.objectBuilder(objects.oneShot_multi,e),k={};g.oneShot=new parts.circuits.audio.oneShot_multi(__globals.audio.context);
g.oneShot.out_right().connect(e.connectionNode_audio.outRight.in());g.oneShot.out_left().connect(e.connectionNode_audio.outLeft.in());g.i={};g.i.loadURL=function(c,d){g.oneShot.load("url",function(){e.grapher_waveWorkspace.grapher_waveWorkspace.draw(g.oneShot.waveformSegment());void 0!=d&&d()},c)};g.i.area=function(c,d){e.grapher_waveWorkspace.grapher_waveWorkspace.area(c,d)};return g};this.oneShot_multi_multiTrack=function(c,f,d){var e={type:"oneShot_multi_multiTrack",x:c,y:f,base:{points:[{x:0,
y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}}]};for(c=0;8>c;c++)e.elements=e.elements.concat([{type:"path",name:"symbol_"+c+"_arrow",data:{path:[{x:19,y:35+47*c},{x:25,y:40+47*c},{x:19,y:45+47*c}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},
{type:"rect",name:"symbol_"+c+"_line",data:{x:15,y:39.5+47*c,width:6,height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"circle",name:"symbo_"+c+"l_outterCircle",data:{x:10,y:40+47*c,r:5.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_"+c+"_infCircle1",data:{x:8.5,y:40+47*c,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_"+c+"_infCircle2",
data:{x:11.5,y:40+47*c,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}}]),e.elements.push({type:"slide",name:"rate_"+c,data:{x:26.25,y:5+47*c,width:5,height:45,value:.5,resetValue:.5,style:{handle:"fill:rgba(220,220,220,1)"},onchange:function(c){return function(d){g.oneShot_multi_array[c].rate(2*(1-e.slide["rate_"+c].get()))}}(c)}}),e.elements.push({type:"glowbox_rect",name:"glowbox_rect_"+c,data:{x:32.5,y:5+47*c,width:2.5,height:45}}),e.elements.push({type:"grapher_waveWorkspace",
name:"grapher_waveWorkspace_"+c,data:{x:35,y:5+47*c,width:180,height:45,selectNeedle:!1,selectionArea:!0}}),e.elements.push({type:"button_rect",name:"loadFile_"+c,data:{x:5,y:5+47*c,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(c){return function(){g.oneShot_multi_array[c].load("file",function(c){return function(d){e.grapher_waveWorkspace["grapher_waveWorkspace_"+c].draw(g.oneShot_multi_array[c].waveformSegment())}}(c))}}(c)}}),
e.elements.push({type:"button_rect",name:"fire_"+c,data:{x:5,y:17.5+47*c,width:10,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",down:"fill:rgba(150,170,150,1)",glow:"fill:rgba(220,220,220,1)"},onclick:function(c){return function(){var d=g.oneShot_multi_array[c],f=e.grapher_waveWorkspace["grapher_waveWorkspace_"+c],k=g.playheads[c];if(!(0>d.duration())){var m=void 0!=f.area().A?f.area().A:0,p=void 0!=f.area().B?f.area().B:1;if(m>p){var r=m;m=p;p=r}r=d.duration();var t=
m*r;r=p*r-t;d.fire(t,r);for(var v=0;v in k;)v++;k[v]={};e.glowbox_rect["glowbox_rect_"+c].on();setTimeout(function(c){return function(){e.glowbox_rect["glowbox_rect_"+c].off()}}(c),100);f.genericNeedle(v,m,"transition: transform "+r+"s; transition-timing-function: linear;");setTimeout(function(c){f.genericNeedle(v,c)},1,p);k[v].timeout=setTimeout(function(c){f.genericNeedle(c);delete k[c]},1E3*r,v)}}}(c)}}),e.elements.push({type:"button_rect",name:"panic_"+c,data:{x:15,y:17.5+47*c,width:10,height:10,
style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",down:"fill:rgba(170,150,150,1)",glow:"fill:rgba(220,220,220,1)"},onclick:function(c){return function(d){d=e.grapher_waveWorkspace["grapher_waveWorkspace_"+c];var f=g.playheads[c];g.oneShot_multi_array[c].panic();for(var h=Object.keys(f),k=0;k<h.length;k++)void 0!=f[k]&&(clearTimeout(f[k].timeout),d.genericNeedle(k),delete f[k])}}(c)}}),e.elements.push({type:"connectionNode_data",name:"trigger_"+c,data:{x:220,y:17.5+47*c,width:10,
height:20,receive:function(c){return function(d,f){"pulse"==d?e.button_rect["fire_"+c].click():"hit"==d&&.5<f.velocity&&e.button_rect["fire_"+c].click()}}(c)}});var g=__globals.utility.misc.objectBuilder(objects.oneShot_multi_multiTrack,e);g.exportData=function(){for(var c={tracks:[],areas:[]},d=0;8>d;d++)c.tracks.push(g.oneShot_multi_array[d].unloadRaw()),c.areas.push(g.i.area(d));return c};g.importData=function(c){for(var d=0;8>d;d++)g.i.loadRaw(d,c.tracks[d]),g.i.area(d,c.areas[d].A,c.areas[d].B)};
g.playheads=[];g.oneShot_multi_array=[];for(c=0;8>c;c++)g.oneShot_multi_array.push(new parts.circuits.audio.oneShot_multi(__globals.audio.context)),g.oneShot_multi_array[c].out_right().connect(e.connectionNode_audio.outRight.in()),g.oneShot_multi_array[c].out_left().connect(e.connectionNode_audio.outLeft.in()),g.playheads.push([]);g.i={loadURL:function(c,d,e){g.oneShot_multi_array[c].load("url",function(c){return function(){document.getElementById("oneShot_multi_multiTrack").children["grapher_waveWorkspace_"+
c].draw(document.getElementById("oneShot_multi_multiTrack").oneShot_multi_array[c].waveformSegment())}}(c),d)},loadRaw:function(c,d){g.oneShot_multi_array[c].loadRaw(d);e.grapher_waveWorkspace["grapher_waveWorkspace_"+c].draw(g.oneShot_multi_array[c].waveformSegment())},area:function(c,d,f){return e.grapher_waveWorkspace["grapher_waveWorkspace_"+c].area(d,f)}};return g};this.oneShot_single=function(c,f,d){var e={type:"oneShot_single",x:c,y:f,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],
style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,receive:function(c,d){e.button_rect.fire.click()}}},{type:"path",name:"symbol_arrow",data:{path:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},
{type:"rect",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"circle",name:"symbol_outterCircle",data:{x:10,y:40,r:5.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"rect",name:"symbol_1",data:{x:9.5,y:37.5,width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",
hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){g.oneShot.load("file",function(c){e.grapher_waveWorkspace.grapher_waveWorkspace.draw(g.oneShot.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:20,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",down:"fill:rgba(150,170,150,1)",glow:"fill:rgba(220,220,220,1)"},onclick:function(){if(!(0>g.oneShot.duration())){g.oneShot.fire();
k&&(e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0),k=!1,clearTimeout(h));var c=g.oneShot.duration();e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,0,"transition: transform "+c+"s;transition-timing-function: linear;");k=!0;setTimeout(function(){e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,1)},1);h=setTimeout(function(){e.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0);k=!1},1E3*c)}}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",
data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]},g=__globals.utility.misc.objectBuilder(objects.oneShot_single,e),k=void 0,h=void 0;g.oneShot=new parts.circuits.audio.oneShot_single(__globals.audio.context);g.oneShot.out_right().connect(e.connectionNode_audio.outRight.in());g.oneShot.out_left().connect(e.connectionNode_audio.outLeft.in());return g};this.player=function(c,f,d){var e={type:"player",x:c,y:f,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:80},{x:0,y:80}],style:"fill:rgba(200,200,200,1)"},
elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}},{type:"rect",name:"symbol_line1",data:{x:3.5,y:38.5,width:1,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line2",data:{x:5.5,y:37,width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line3",data:{x:7.5,y:35.5,width:1,
height:8,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line4",data:{x:9.5,y:34.5,width:1,height:10,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line5",data:{x:11.5,y:35.5,width:1,height:8,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line6",data:{x:13.5,y:37,width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line7",data:{x:15.5,y:39,width:1,
height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line8",data:{x:17.5,y:36,width:1,height:7,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line9",data:{x:19.5,y:32,width:1,height:15,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line10",data:{x:21.5,y:34.5,width:1,height:10,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line11",data:{x:23.5,y:37,
width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line12",data:{x:25.5,y:38.5,width:1,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"readout_sixteenSegmentDisplay",name:"trackNameReadout",data:{x:30,y:5,angle:0,width:100,height:20,count:10,style:{background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",dim:"fill:rgb(20,20,20)"}}},{type:"readout_sixteenSegmentDisplay",name:"time",data:{x:135,y:5,angle:0,width:80,height:20,
count:8,style:{background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",dim:"fill:rgb(20,20,20)"}}},{type:"button_rect",name:"load",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){g.player.load("file",function(c){e.grapher_waveWorkspace.grapher_waveWorkspace.draw(g.player.waveformSegment());e.grapher_waveWorkspace.grapher_waveWorkspace.select(0);e.grapher_waveWorkspace.grapher_waveWorkspace.area(-1,
-1);e.readout_sixteenSegmentDisplay.trackNameReadout.text(c.name);e.readout_sixteenSegmentDisplay.trackNameReadout.print("smart")})}}},{type:"button_rect",name:"start",data:{x:5,y:17.5,width:20,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",down:"fill:rgba(150,170,150,1)",glow:"fill:rgba(220,220,220,1)"},onclick:function(){g.player.start()}}},{type:"button_rect",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",
down:"fill:rgba(170,150,150,1)",glow:"fill:rgba(240,200,220,1)"},onclick:function(){g.player.stop()}}},{type:"label",name:"rate_label_name",data:{x:10,y:78,text:"rate",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},{type:"label",name:"rate_label_0",data:{x:5,y:75,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},{type:"label",name:"rate_label_1",data:{x:13.7,y:54,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},
{type:"label",name:"rate_label_2",data:{x:23,y:75,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},{type:"dial_continuous",name:"rate",data:{x:15,y:65,r:9,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,style:{outerArc:"stroke:rgba(50,50,50,0.25); fill:none;"},onchange:function(c){g.player.rate(2*c)}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:30,width:185,height:45,selectionAreaToggle:function(c){g.player.loop({active:c})},
onchange:function(c,d){if("lead"==c)g.player.jumpTo(d);else if("selection_A"==c||"selection_B"==c)c=e.grapher_waveWorkspace.grapher_waveWorkspace.area(),c.A<c.B?g.player.loop({start:c.A,end:c.B}):g.player.loop({start:c.B,end:c.A})}}}]},g=__globals.utility.misc.objectBuilder(objects.player,e);g.player=new parts.circuits.audio.player(__globals.audio.context);g.player.out_right().connect(e.connectionNode_audio.outRight.in());g.player.out_left().connect(e.connectionNode_audio.outLeft.in());setInterval(function(){if(g.player.isLoaded()){var c=
__globals.utility.math.seconds2time(Math.round(g.player.currentTime()));e.readout_sixteenSegmentDisplay.time.text(__globals.utility.misc.padString(c.h,2,"0")+":"+__globals.utility.misc.padString(c.m,2,"0")+":"+__globals.utility.misc.padString(c.s,2,"0"));e.readout_sixteenSegmentDisplay.time.print();e.grapher_waveWorkspace.grapher_waveWorkspace.select(g.player.progress())}},1E3/30);g.i={loadByURL:function(c){g.player.load("url",function(c){e.grapher_waveWorkspace.grapher_waveWorkspace.draw(g.player.waveformSegment());
e.grapher_waveWorkspace.grapher_waveWorkspace.select(0);e.grapher_waveWorkspace.grapher_waveWorkspace.area(-1,-1);e.readout_sixteenSegmentDisplay.trackNameReadout.text(c.name);e.readout_sixteenSegmentDisplay.trackNameReadout.print("smart")},c)}};e.dial_continuous.rate.set(.5);return g};this.pulseGenerator=function(c,f,d){function e(c){g.readout_sixteenSegmentDisplay.readout.text(__globals.utility.misc.padString(c,3," ")+"bpm");g.readout_sixteenSegmentDisplay.readout.print();h&&clearInterval(h);0<
c&&(h=setInterval(function(){k.io.out.send("pulse")},60/c*1E3));k.io.out.send("pulse");n=c}var g={type:"pulseGenerator",x:c,y:f,base:{type:"path",points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){g.button_rect.sync.click()}}},
{type:"button_rect",name:"sync",data:{x:102.5,y:11.25,width:10,height:17.5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){e(n)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(c){e(Math.round(240*c))}}},{type:"readout_sixteenSegmentDisplay",name:"readout",data:{x:40,y:10,width:60,height:20,count:6}}]},k=__globals.utility.misc.objectBuilder(objects.pulseGenerator,g);k.exportData=function(){return g.dial_continuous.tempo.get()};k.importData=function(c){g.dial_continuous.tempo.set(c)};var h=null,n=120;k.i={setTempo:function(c){g.dial_continuous.tempo.set(c)}};g.dial_continuous.tempo.set(.5);return k};this.pulseGenerator_hyper=function(c,f,d,e){function g(c){k.readout_sixteenSegmentDisplay.readout.text(__globals.utility.misc.padString(c,
3," ")+"bpm");k.readout_sixteenSegmentDisplay.readout.print();n&&clearInterval(n);0<c&&(n=setInterval(function(){h.io.out.send("pulse")},60/c*1E3));h.io.out.send("pulse");l=c}d=void 0===d?999:d;var k={type:"pulseGenerator_hyper",x:c,y:f,base:{type:"path",points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",
name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){k.button_rect.sync.click()}}},{type:"button_rect",name:"sync",data:{x:102.5,y:11.25,width:10,height:17.5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){g(l)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",
needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){g(Math.round(c*d))}}},{type:"readout_sixteenSegmentDisplay",name:"readout",data:{x:40,y:10,width:60,height:20,count:6}}]},h=__globals.utility.misc.objectBuilder(objects.pulseGenerator_hyper,k);h.exportData=function(){return k.dial_continuous.tempo.get()};h.importData=function(c){k.dial_continuous.tempo.set(c)};var n=null,l=120;h.i={setTempo:function(c){k.dial_continuous.tempo.set(c)}};
k.dial_continuous.tempo.set(.5);return h};this.recorder=function(c,f,d){function e(c){if("empty"!=h||"save"!=c&&"stop"!=c){if("stop"==c||"save"==c)h="full";"empty"==h&&"rec"==c&&(h="recording");"clear"==c&&(h="empty");"recording"==h&&"pause/resume"==c?h="paused":"paused"!=h||"pause/resume"!=c&&"rec"!=c||(h="recording");if("empty"==h)g.glowbox_rect.activityLight_empty.on();else g.glowbox_rect.activityLight_empty.off();if("recording"==h)g.glowbox_rect.activityLight_recording.on();else g.glowbox_rect.activityLight_recording.off();
if("paused"==h)g.glowbox_rect.activityLight_paused.on();else g.glowbox_rect.activityLight_paused.off();if("full"==h)g.glowbox_rect.activityLight_full.on();else g.glowbox_rect.activityLight_full.off()}}var g={type:"recorder",x:c,y:f,base:{points:[{x:0,y:0},{x:175,y:0},{x:175,y:40},{x:0,y:40}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"inRight",data:{type:0,x:175,y:2.5,width:10,height:15}},{type:"connectionNode_audio",name:"inLeft",data:{type:0,x:175,y:22.5,width:10,
height:15}},{type:"rect",name:"logo_rect",data:{x:135,y:27.5,angle:-.25,width:35,height:10,style:"fill:rgb(230,230,230)"}},{type:"label",name:"logo_label",data:{x:139,y:34.5,angle:-.25,text:"REcorder",style:"fill:rgba(100,100,100,1); font-size:8px; font-family:Bookman; pointer-events: none;"}},{type:"button_rect",name:"rec",data:{x:5,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){"paused"==
h?k.recorder.resume():k.recorder.start();e("rec")}}},{type:"text",name:"button_rect_text",data:{x:10.5,y:31.5,text:"rec",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"button_rect",name:"pause/resume",data:{x:27.5,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){"paused"==h?k.recorder.resume():k.recorder.pause();
e("pause/resume")}}},{type:"text",name:"button_pause/resume_text",data:{x:30,y:31.5,text:"pause",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"button_rect",name:"stop",data:{x:50,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){e("stop");k.recorder.stop()}}},{type:"text",name:"button_stop_text",data:{x:54,
y:31.5,text:"stop",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"button_rect",name:"save",data:{x:72.5,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){e("save");"empty"!=h&&k.recorder.save()}}},{type:"text",name:"button_save_text",data:{x:76.5,y:31.5,text:"save",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},
{type:"button_rect",name:"clear",data:{x:95,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){e("clear");k.recorder.clear()}}},{type:"text",name:"button_clear_text",data:{x:97.5,y:31.5,text:"clear",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"readout_sixteenSegmentDisplay",name:"time",data:{x:70,y:5,angle:0,
width:100,height:15,count:11,style:{background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",dim:"fill:rgb(20,20,20)"}}},{type:"glowbox_rect",name:"activityLight_recording",data:{x:5,y:5,width:15,height:15,style:{glow:"fill:rgb(255, 63, 63)",dim:"fill:rgb(25, 6, 6)"}}},{type:"text",name:"activityLight_recording_text",data:{x:8,y:14,text:"rec",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"glowbox_rect",name:"activityLight_paused",data:{x:20,
y:5,width:15,height:15,style:{glow:"fill:rgb(126, 186, 247)",dim:"fill:rgb(12, 18, 24)"}}},{type:"text",name:"activityLight_paused_text",data:{x:23,y:14,text:"pau",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"glowbox_rect",name:"activityLight_empty",data:{x:35,y:5,width:15,height:15,style:{glow:"fill:rgb(199, 249, 244)",dim:"fill:rgb(19, 24, 24)"}}},{type:"text",name:"activityLight_empty_text",data:{x:38,y:14,text:"emp",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},
{type:"glowbox_rect",name:"activityLight_full",data:{x:50,y:5,width:15,height:15,style:{glow:"fill:rgb(61, 224, 35)",dim:"fill:rgb(6, 22, 3)"}}},{type:"text",name:"activityLight_full_text",data:{x:53,y:14,text:"ful",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}}]},k=__globals.utility.misc.objectBuilder(objects.recorder,g);setInterval(function(){var c=k.recorder.recordingTime(),d=c%1;c=__globals.utility.math.seconds2time(Math.round(c));g.readout_sixteenSegmentDisplay.time.text(__globals.utility.misc.padString(c.h,
2,"0")+":"+__globals.utility.misc.padString(c.m,2,"0")+":"+__globals.utility.misc.padString(c.s,2,"0")+"."+__globals.utility.misc.padString((""+d).slice(2),2,"0"));g.readout_sixteenSegmentDisplay.time.print()},100);var h="empty";e("clear");g.glowbox_rect.activityLight_empty.on();k.recorder=new parts.circuits.audio.recorder(__globals.audio.context);g.connectionNode_audio.inRight.out().connect(k.recorder.in_right());g.connectionNode_audio.inLeft.out().connect(k.recorder.in_left());return k};this.reverbUnit=
function(c,f){function d(c){0==e.availableTypes.length?console.log("broken or not yet ready"):(c>=e.availableTypes.length?c=e.availableTypes.length-1:0>c&&(c=0),e.reverbTypeSelected=c,k.reverbCircuit.type(e.availableTypes[c],function(){var c=e.reverbTypeSelected;c=("0"+c).slice(-2);g.sevenSegmentDisplay.ones.enterCharacter(c[0]);g.sevenSegmentDisplay.tens.enterCharacter(c[1])}))}var e={reverbTypeSelected:0,availableTypes:[]},g={type:"reverbUnit",x:c,y:f,base:{points:[{x:0,y:10},{x:51.25,y:0},{x:102.5,
y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioIn",data:{type:0,x:102.5,y:16,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-10,y:16,width:10,height:20}},{type:"label",name:"outGain_0",data:{x:7,y:39,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"outGain_1/2",data:{x:16.5,y:10,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"label",name:"outGain_1",data:{x:30,y:39,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"outGain",data:{x:20,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(c){k.reverbCircuit.outGain(c)}}},{type:"label",name:"wetdry_1/2",data:{x:66.5,
y:39,text:"wet",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"wetdry_1",data:{x:92.5,y:39,text:"dry",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"wetdry",data:{x:82.5,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(c){k.reverbCircuit.wetdry(1-c)}}},{type:"button_rect",name:"raiseByOne",data:{x:51,y:6,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){d(e.reverbTypeSelected+1)}}},{type:"button_rect",name:"raiseByTen",data:{x:38.75,y:6,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},
onclick:function(){d(e.reverbTypeSelected+10)}}},{type:"button_rect",name:"lowerByOne",data:{x:51,y:39,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){d(e.reverbTypeSelected-1)}}},{type:"button_rect",name:"lowerByTen",data:{x:38.75,y:39,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},
onclick:function(){d(e.reverbTypeSelected-10)}}},{type:"sevenSegmentDisplay",name:"tens",data:{x:50,y:12.5,width:12.5,height:25}},{type:"sevenSegmentDisplay",name:"ones",data:{x:37.5,y:12.5,width:12.5,height:25}}]},k=__globals.utility.misc.objectBuilder(objects.reverbUnit,g);k.importData=function(c){e.reverbTypeSelected=c.selectedType;g.dial_continuous.wetdry.set(c.wetdry);g.dial_continuous.outGain.set(c.outGain)};k.exportData=function(){return{selectedType:e.reverbTypeSelected,wetdry:g.dial_continuous.wetdry.get(),
outGain:g.dial_continuous.outGain.get()}};k.reverbCircuit=new parts.circuits.audio.reverbUnit(__globals.audio.context);g.connectionNode_audio.audioIn.out().connect(k.reverbCircuit.in());k.reverbCircuit.out().connect(g.connectionNode_audio.audioOut.in());k.reverbCircuit.getTypes(function(c){e.availableTypes=c});k.i={gain:function(c){g.dial_continuous.outGain.set(c)},wetdry:function(c){g.dial_continuous.wetdry.set(c)}};g.dial_continuous.outGain.set(.5);g.dial_continuous.wetdry.set(.5);setTimeout(function(){d(e.reverbTypeSelected)},
1E3);return k};this.universalreadout=function(c,f,d){var e=__globals.utility.misc.objectBuilder(objects.universalreadout,{type:"universalreadout",x:c,y:f,base:{type:"circle",x:10,y:10,r:20,style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"in",data:{x:0,y:0,width:20,height:20,receive:function(c,d){c="address: "+c+" data: "+JSON.stringify(d);g.unshift(c);g.length>h&&g.pop();for(c=0;c<k.length;c++)k[c].remove();k=[];for(c=0;c<g.length;c++)k[c]=__globals.utility.misc.elementMaker("text",
"universalreadout_"+c,{x:40,y:5*c,text:g[c],style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}),e.append(k[c])}}}]}),g=[],k=[],h=10;return e}};__globals.audio.context.resume().then(function(){__globals.panes.menu.innerHTML="";clearTimeout(timeout)},function(){console.warn("I'm not sure what to do now..I guess we just sit here in silence")});var timeout=setTimeout(function(){var c=__globals.utility.workspace.getViewportDimensions();__globals.panes.menu.append(parts.basic.rect(null,
0,0,c.width,c.height,0,"fill:rgba(255,255,255,0.9)"));var f=__globals.utility.misc.elementMaker("text","explanation",{x:10,y:30,text:"because of the 'no autoplay' feature in browsers; this site needs you to allow it to produce sound",style:"fill:rgba(0,0,0,1); font-size:15px; font-family:Courier New; pointer-events:none;"});__globals.panes.menu.append(f);var d=f.getBBox();__globals.utility.element.setTransform(f,{x:(c.width-d.width)/2,y:(c.height-d.height)/2-30,s:1,r:0});__globals.panes.menu.append(__globals.utility.misc.elementMaker("button_rect",
"audioOn",{x:(c.width-100)/2,y:(c.height-50)/2,width:100,height:50,onclick:function(){__globals.audio.context.resume();__globals.panes.menu.innerHTML=""}}));__globals.panes.menu.append(__globals.utility.misc.elementMaker("text","explanation",{x:c.width/2-22.5,y:c.height/2+5,text:"allow",style:"fill:rgba(0,0,0,1); font-size:15px; font-family:Courier New; pointer-events:none;"}))},1)};
