var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,c){b!=Array.prototype&&b!=Object.prototype&&(b[e]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var e=0;return $jscomp.iteratorPrototype(function(){return e<b.length?{done:!1,value:b[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.iteratorFromArray=function(b,e){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var c=0,d={next:function(){if(c<b.length){var f=c++;return{value:e(f,b[f]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(b,e,c,d){if(e){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var f=b[d];f in c||(c[f]={});c=c[f]}b=b[b.length-1];d=c[b];e=e(d);e!=d&&null!=e&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Array.from",function(b){return b?b:function(b,c,d){$jscomp.initSymbolIterator();c=null!=c?c:function(b){return b};var f=[],e=b[Symbol.iterator];if("function"==typeof e){b=e.call(b);for(var g=0;!(e=b.next()).done;)f.push(c.call(d,e.value,g++))}else for(e=b.length,g=0;g<e;g++)f.push(c.call(d,b[g],g));return f}},"es6","es3");$jscomp.owns=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(b,e){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var f in d)$jscomp.owns(d,f)&&(b[f]=d[f])}return b};$jscomp.polyfill("Object.assign",function(b){return b||$jscomp.assign},"es6","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.polyfill("Object.is",function(b){return b?b:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(b){return b?b:function(b,c){var d=this;d instanceof String&&(d=String(d));var f=d.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var e=d[c];if(e===b||Object.is(e,b))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(b,e,c){if(null==b)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return b+""};$jscomp.polyfill("String.prototype.includes",function(b){return b?b:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6","es3");
$jscomp.polyfill("Math.sign",function(b){return b?b:function(b){b=Number(b);return 0===b||isNaN(b)?b:0<b?1:-1}},"es6","es3");$jscomp.polyfill("Object.entries",function(b){return b?b:function(b){var c=[],d;for(d in b)$jscomp.owns(b,d)&&c.push([d,b[d]]);return c}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,c,d){var f=this.length||0;0>c&&(c=Math.max(0,f+c));if(null==d||d>f)d=f;d=Number(d);0>d&&(d=Math.max(0,f+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},e=Object.create(new $jscomp.global.Proxy(b,{get:function(c,d,f){return c==b&&"q"==d&&f==e}}));return!0===e.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var e=b[Symbol.iterator];return e?e.call(b):$jscomp.arrayIterator(b)};
$jscomp.polyfill("WeakMap",function(b){function e(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),f=new b([[c,2],[d,3]]);if(2!=f.get(c)||3!=f.get(d))return!1;f.delete(c);f.set(d,4);return!f.has(c)&&4==f.get(d)}catch(p){return!1}}function c(b){$jscomp.owns(b,f)||$jscomp.defineProperty(b,f,{value:{}})}function d(b){var d=Object[b];d&&(Object[b]=function(b){c(b);return d(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(e())return b;
var f="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var h=0,g=function(b){this.id_=(h+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};g.prototype.set=function(b,d){c(b);if(!$jscomp.owns(b,f))throw Error("WeakMap key fail: "+b);b[f][this.id_]=d;return this};g.prototype.get=function(b){return $jscomp.owns(b,f)?b[f][this.id_]:void 0};g.prototype.has=
function(b){return $jscomp.owns(b,f)&&$jscomp.owns(b[f],this.id_)};g.prototype.delete=function(b){return $jscomp.owns(b,f)&&$jscomp.owns(b[f],this.id_)?delete b[f][this.id_]:!1};return g},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function e(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b($jscomp.makeIterator([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var f=d.entries(),e=f.next();if(e.done||e.value[0]!=c||"s"!=e.value[1])return!1;e=f.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!f.next().done?!1:!0}catch(r){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(e())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=new WeakMap,d=function(b){this.data_={};this.head_=g();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};d.prototype.set=function(b,c){b=0===b?0:b;var d=f(this,b);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=c:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:b,value:c},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};d.prototype.delete=function(b){b=f(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(b){return!!f(this,b).entry};
d.prototype.get=function(b){return(b=f(this,b).entry)&&b.value};d.prototype.entries=function(){return h(this,function(b){return[b.key,b.value]})};d.prototype.keys=function(){return h(this,function(b){return b.key})};d.prototype.values=function(){return h(this,function(b){return b.value})};d.prototype.forEach=function(b,c){for(var d=this.entries(),f;!(f=d.next()).done;)f=f.value,b.call(c,f[1],f[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var f=function(b,d){var f=d&&typeof d;"object"==
f||"function"==f?c.has(d)?f=c.get(d):(f=""+ ++m,c.set(d,f)):f="p_"+d;var e=b.data_[f];if(e&&$jscomp.owns(b.data_,f))for(b=0;b<e.length;b++){var g=e[b];if(d!==d&&g.key!==g.key||d===g.key)return{id:f,list:e,index:b,entry:g}}return{id:f,list:e,index:-1,entry:void 0}},h=function(b,c){var d=b.head_;return $jscomp.iteratorPrototype(function(){if(d){for(;d.head!=b.head_;)d=d.previous;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})},g=function(){var b={};return b.previous=
b.next=b.head=b},m=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(b){function e(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),f=new b($jscomp.makeIterator([c]));if(!f.has(c)||1!=f.size||f.add(c)!=f||1!=f.size||f.add({x:4})!=f||2!=f.size)return!1;var e=f.entries(),g=e.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=e.next();return g.done||g.value[0]==c||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:e.next().done}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(e())return b;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.map_.size};c.prototype.add=function(b){b=0===b?0:b;this.map_.set(b,b);this.size=this.map_.size;return this};c.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};c.prototype.clear=
function(){this.map_.clear();this.size=0};c.prototype.has=function(b){return this.map_.has(b)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.map_.forEach(function(f){return b.call(c,f,f,d)})};return c},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,c){return c})}},"es8","es3");$jscomp.polyfill("Math.log10",function(b){return b?b:function(b){return Math.log(b)/Math.LN10}},"es6","es3");
for(var __svgElements=document.getElementsByTagName("svg"),__svgElements_count=0;__svgElements_count<__svgElements.length;__svgElements_count++)if(__svgElements[__svgElements_count].hasAttribute("workspace")){var system=new function(){};system.svgElement=__svgElements[__svgElements_count];system.super=new function(){this.devMode=null!=(new URL(window.location.href)).searchParams.get("dev");this.devMode||(window.onbeforeunload=function(){return"Unsaved work will be lost"});this.testMode=null!=(new URL(window.location.href)).searchParams.get("test");
this.mouseGripPanningEnabled=this.mouseWheelZoomEnabled=!0;this.readOnlyMode=!1;this.enablCableDisconnectionConnection=this.enableWindowScrollbarAutomaticRemoval=this.enableMenubar=this.enableSaveload=!0;this.keys={alt:"altKey",ctrl:"ctrlKey"};-1!=window.navigator.platform.indexOf("Mac")&&(this.keys.ctrl="metaKey");this.helpFolderLocation="help/index.html";this.helpFolderLocation="help/";this.demoMode=function(b){this.mouseWheelZoomEnabled=!b;this.mouseGripPanningEnabled=!b;this.readOnlyMode=b;this.enableSaveload=
!b;this.enableMenubar=!b;this.enableWindowScrollbarAutomaticRemoval=!b;this.enablCableDisconnectionConnection=!b;window.onbeforeunload=void 0}};system.utility=new function(){this.workspace=new function(){this.currentPosition=function(){return system.utility.element.getTransform(system.pane.workspace)};this.gotoPosition=function(b,e,c,d){system.utility.element.setTransform(system.pane.workspace,{x:b,y:e,s:c,r:d})};this.getPane=function(b){for(;!b.getAttribute("pane");)b=b.parentElement;return b};this.getGlobal=
function(b){for(;!b.getAttribute("global");)b=b.parentElement;return b};this.objectUnderPoint=function(b,e){if(void 0!=b&&void 0!=e){b=document.elementFromPoint(b,e);if(b.hasAttribute("workspace"))return null;for(;!b.parentElement.hasAttribute("pane");)b=b.parentElement;return b}};this.pointConverter=new function(){this.browser2workspace=function(b,e){var c=system.utility.element.getTransform(system.pane.workspace);return{x:(b-c.x)/c.s,y:(e-c.y)/c.s}};this.workspace2browser=function(b,e){var c=system.utility.element.getTransform(system.pane.workspace);
return{x:b*c.s+c.x,y:e*c.s+c.y}}};this.dotMaker=function(b,e,c,d,f,h){c=void 0===c?"":c;d=void 0===d?1:d;f=void 0===f?"fill:rgba(255,100,255,0.75); font-size:3; font-family:Helvetica;":f;h=void 0===h?!1:h;b=part.builder("g",null,{x:b,y:e});d=part.builder("circle",null,{x:0,y:0,r:d,style:f});c=part.builder("text",null,{x:0,y:0,angle:0,text:c,style:f});b.appendChild(d);b.appendChild(c);h&&system.pane.foreground.append(b);return b};this.getGlobalScale=function(b){return system.utility.element.getTransform(system.utility.workspace.getGlobal(b)).s};
this.getViewportDimensions=function(){return{width:system.svgElement.width.baseVal.value,height:system.svgElement.height.baseVal.value}};this.placeAndReturnObject=function(b,e){if(void 0!=b)return system.pane[void 0===e?"middleground":e].appendChild(b)};this.mouseInteractionHandler=function(b,e){void 0!=b&&(system.svgElement.onmousemove_old=system.svgElement.onmousemove,system.svgElement.onmouseup_old=system.svgElement.onmouseup,system.svgElement.onmouseleave_old=system.svgElement.onmouseleave,system.svgElement.onmousemove=
function(c){b(c)},system.svgElement.onmouseup=function(b){void 0!=e&&e(b);system.svgElement.onmousemove=system.svgElement.onmousemove_old;system.svgElement.onmouseleave=system.svgElement.onmouseleave_old;system.svgElement.onmouseup=system.svgElement.onmouseup_old},system.svgElement.onmouseleave=system.svgElement.onmouseup)};this.clear=function(b){system.pane[void 0===b?"middleground":b].innerHTML=""};this.exportScene=function(b){b=void 0===b?!1:b;for(var e=[],c={},d=Array.from(system.pane.middleground.children),
f=[],h=0;h<d.length;h++)"null"!=d[h].id&&f.push(d[h]);d=f;for(h=0;h<d.length;h++)if(f={},d[h].creatorMethod){b&&(c[d[h].id]=d[h].creatorMethod);f.objectConstructorName=d[h].id;f.position=system.utility.element.getTransform(d[h]);d[h].exportData&&(f.data=d[h].exportData());if(d[h].io){for(var g=[],m=Object.keys(d[h].io),k=0;k<m.length;k++){var l={};l.originPort=m[k];if(d[h].io[m[k]].foreignNode){for(var p=Object.keys(d[h].io[m[k]].foreignNode.parentElement.io),q=0;q<p.length;q++)if(d[h].io[m[k]].foreignNode.parentElement.io[p[q]]===
d[h].io[m[k]].foreignNode){l.destinationPorts=p[q];l.destinationIndex=d.indexOf(d[h].io[m[k]].foreignNode.parentElement);break}0<=l.destinationIndex&&g.push(l)}}f.connections=g}e.push(f)}return{scene:e,constructorFunctions:c}};this.importScene=function(b,e,c){e=void 0===e?!1:e;for(var d=[],f=0;f<b.length;f++){var h=b[f],g=system.utility.workspace.placeAndReturnObject((e?c[h.objectConstructorName]:object[h.objectConstructorName])(h.position.x,h.position.y));g.importData&&g.importData(h.data);h.connections&&
h.connections.forEach(function(b){b.destinationIndex<d.length&&g.io[b.originPort].connectTo(d[b.destinationIndex].io[b.destinationPorts])});d.push(g)}};this.saveload=new function(){this.save=function(b,e,c){e=void 0===e?!0:e;if(system.super.enableSaveload){c={sceneName:void 0===b?"project":b,bundleConstructorFunctions:void 0===c?!1:c,viewportLocation:system.utility.workspace.currentPosition(),constructorFunctions:{},objects:[]};b=c.sceneName;system.audio.destination.masterGain(0);var d=system.utility.workspace.exportScene(c.bundleConstructorFunctions);
c.objects=d.scene;c.constructorFunctions=d.constructorFunctions;c=system.utility.misc.serialize(c,e);system.utility.misc.printFile(b+".crv",c);system.audio.destination.masterGain(1)}};this.__loadProcess=function(b,e,c){system.audio.destination.masterGain(0);b=system.utility.misc.unserialize(b,c);if(null!=b){system.utility.workspace.clear();system.utility.workspace.importScene(b.objects,b.bundleConstructorFunctions,b.constructorFunctions);system.utility.workspace.gotoPosition(b.viewportLocation.x,
b.viewportLocation.y,b.viewportLocation.s,b.viewportLocation.r);var d={sceneName:b.sceneName};console.log('scene "'+b.sceneName+'" has been loaded')}system.audio.destination.masterGain(1);e&&e(d)};this.load=function(b,e){e=void 0===e?!0:e;system.super.enableSaveload&&system.utility.misc.openFile(function(c){system.utility.workspace.saveload.__loadProcess(c,b,e)})};this.loadFromURL=function(b,e,c){c=void 0===c?!0:c;var d=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="text";d.onload=function(){system.utility.workspace.saveload.__loadProcess(this.response,
e,c)};d.send()}};this.setStaticBackgroundStyle=function(b){system.pane.staticBackground.innerHTML="";system.utility.workspace.placeAndReturnObject(part.builder("rect",null,{width:"100%",height:"100%",style:b+"pointer-events:none;"}),"staticBackground")}};this.element=new function(){this.getTransform=function(b){var e=b.style.transform;e=e.slice(10).split("px, ",2);b=Number(e[0]);e=e[1].split("px) scale(",2);var c=Number(e[0]);e=e[1].split(") rotate(",2);var d=Number(e[0]);e=Number(e[1].slice(0,-4));
return{x:b,y:c,s:d,r:e}};this.getCumulativeTransform=function(b){for(data=this.getTransform(b);!b.parentElement.getAttribute("pane");){b=b.parentElement;var e=this.getTransform(b);data.x+=e.x;data.y+=e.y;data.s*=e.s;data.r+=e.r}return data};this.getTruePoint=function(b){for(data=this.getTransform(b);!b.parentElement.getAttribute("pane");){b=b.parentElement;var e=this.getTransform(b),c=system.utility.math.cartesian2polar(data.x,data.y);c.ang+=e.r;c=system.utility.math.polar2cartesian(c.ang,c.dis);
data.x=c.x+e.x;data.y=c.y+e.y;data.s*=e.s;data.r+=e.r}return data};this.setTransform=function(b,e){b.style.transform="translate("+e.x+"px, "+e.y+"px) scale("+e.s+") rotate("+e.r+"rad)"};this.setTransform_XYonly=function(b,e,c){if(null!=e||null!=c){var d=this.getTransform(b);null!=e&&(d.x=e);null!=c&&(d.y=c);this.setTransform(b,d)}};this.setStyle=function(b,e){var c=this.getTransform(b);b.style=e;this.setTransform(b,c)};this.setRotation=function(b,e){b.style.transform=b.style.transform.replace(/rotate\(([-+]?[0-9]*\.?[0-9]+)/,
"rotate("+e)};this.getBoundingBox=function(b){var e=document.createElementNS("http://www.w3.org/2000/svg","g");system.pane.workspace.append(e);b=b.cloneNode(!0);e.append(b);b=b.getBBox();e.remove();return b};this.makeUnselectable=function(b){b.style["-webkit-user-select"]="none";b.style["-moz-user-select"]="none";b.style["-ms-user-select"]="none";b.style["user-select"]="none"};this.getPositionWithinFromMouse=function(b,e,c,d){e=system.utility.element.getTruePoint(e);b=system.utility.workspace.pointConverter.browser2workspace(b.offsetX,
b.offsetY);b=system.utility.math.cartesian2polar(b.x-e.x,b.y-e.y);b.ang-=e.r;b=system.utility.math.polar2cartesian(b.ang,b.dis);c={x:b.x/c,y:b.y/d};0>c.x?c.x=0:1<c.x&&(c.x=1);0>c.y?c.y=0:1<c.y&&(c.y=1);return c};this.styleExtractor=function(b){var e={},c=b.split(";").filter(function(b){return 0!=b.length});try{for(var d=0;d<c.length;d++){var f=c[d].split(":");f[0]=f[0].replace(/^\s+|\s+$/g,"");f[1]=f[1].replace(/^\s+|\s+$/g,"");e[f[0]]=f[1]}}catch(h){return console.error('styleExtractor was unable to parse the string "'+
b+'"'),{}}return e};this.stylePacker=function(b){for(var e="",c=Object.keys(b),d=0;d<c.length;d++)e+=c[d]+":"+b[c[d]]+";";return e}};this.object=new function(){this.requestInteraction=function(b,e,c,d){if(!b||!e)return!0;b=document.elementFromPoint(b,e);if(null==b)return!1;if(b.hasAttribute("workspace"))return!0;for(;!b.hasAttribute("global");){if(b==document.body||b[c]||b.hasAttribute(c))return!1;b=b.parentElement}return b.getAttribute("pane")==d};this.disconnectEverything=function(b){for(var e=
Object.keys(b.io),c=0;c<e.length;c++)if(Array.isArray(b.io[e[c]]))for(var d=0;d<b.io[e[c]].length;d++)b.io[e[c]][d].disconnect();else b.io[e[c]].disconnect()};this.generateSelectionArea=function(b,e){e.selectionArea={};e.selectionArea.box=[];e.selectionArea.points=[];e.updateSelectionArea=function(){e.selectionArea.points=[];b.forEach(function(b){e.selectionArea.points.push({x:b.x,y:b.y})});e.selectionArea.box=system.utility.math.boundingBoxFromPoints(e.selectionArea.points);var c=system.utility.element.getTransform(e);
e.selectionArea.box.forEach(function(b){b.x+=c.x;b.y+=c.y});e.selectionArea.points.forEach(function(b){b.x+=c.x;b.y+=c.y})};e.updateSelectionArea()};this.deleteObject=function(b){if(b.onDelete)b.onDelete();system.utility.object.disconnectEverything(b);system.utility.workspace.getPane(b).removeChild(b)}};this.audio=new function(){this.changeAudioParam=function(b,e,c,d,f,h){h=void 0===h?!0:h;if(null==c)return e.value;h&&e.cancelScheduledValues(b.currentTime);try{switch(f){case "linear":e.linearRampToValueAtTime(c,
b.currentTime+d);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");0==c&&(c=1E-4);e.exponentialRampToValueAtTime(c,b.currentTime+d);break;case "s":for(var g=c-e.value,m=system.utility.math.curveGenerator.s(10),k=0;k<m.length;k++)m[k]=e.value+m[k]*g;e.setValueCurveAtTime(new Float32Array(m),b.currentTime,d);break;default:e.setTargetAtTime(c,b.currentTime,.001)}}catch(l){console.log("could not change param (possibly due to an overlap, or bad target value)"),
console.log("audioParam:",e,"target:",c,"time:",d,"curve:",f,"cancelScheduledValues:",h),console.log(l)}};this.loadAudioFile=function(b,e,c){c=void 0===c?"":c;switch(void 0===e?"file":e){case "url":e=new XMLHttpRequest;e.open("GET",c,!0);e.responseType="arraybuffer";e.onload=function(){system.audio.context.decodeAudioData(this.response,function(d){b({buffer:d,name:c.split("/").pop(),duration:d.duration})},function(b){console.warn("Error with decoding audio data"+b.err)})};e.send();break;default:e=
document.createElement("input"),e.type="file",e.onchange=function(){var c=this.files[0],f=new FileReader;f.readAsArrayBuffer(c);f.onload=function(d){system.audio.context.decodeAudioData(d.target.result,function(d){b({buffer:d,name:c.name,duration:d.duration})})}},document.body.appendChild(e),e.click()}};this.waveformSegment=function(b,e){e=void 0===e?{start:0,end:1}:e;var c=b.getChannelData(0);e.start=e.start?e.start:0;e.end=e.end?e.end:1;var d=b.length*e.start;b=b.length*e.end;e=(b-d)/1E4;for(var f=
[];d<b;d+=Math.round(e))f.push(system.utility.math.largestValueFound(c.slice(d,d+Math.round(e))));return f};this.loadBuffer=function(b,e,c,d){b=b.createBufferSource();b.buffer=e;b.connect(c);b.onended=d;return b}};this.math=new function(){this.averageArray=function(b){return b.reduce(function(b,c){return b+c},0)/b.length};this.largestValueFound=function(b){return b.reduce(function(b,c){return Math.abs(b)>Math.abs(c)?b:c})};this.polar2cartesian=function(b,e){return{x:e*Math.cos(b),y:e*Math.sin(b)}};
this.cartesian2polar=function(b,e){return{dis:Math.pow(Math.pow(b,2)+Math.pow(e,2),.5),ang:0===b?0===e?0:0<e?.5*Math.PI:1.5*Math.PI:0===e?0<=b?0:Math.PI:0<=b?Math.atan(e/b):Math.atan(e/b)+Math.PI}};this.boundingBoxFromPoints=function(b){for(var e=b[0].x,c=b[0].x,d=b[0].y,f=b[0].y,h=1;h<b.length;h++)b[h].x<e?e=b[h].x:b[h].x>c&&(c=b[h].x),b[h].y<d?d=b[h].y:b[h].y>f&&(f=b[h].y);return[{x:c,y:f},{x:e,y:d}]};this.intersectionOfTwoLineSegments=function(b,e){var c=(e[1].y-e[0].y)*(b[1].x-b[0].x)-(e[1].x-
e[0].x)*(b[1].y-b[0].y);if(0==c)return null;var d=((e[1].x-e[0].x)*(b[0].y-e[0].y)-(e[1].y-e[0].y)*(b[0].x-e[0].x))/c;e=((b[1].x-b[0].x)*(b[0].y-e[0].y)-(b[1].y-b[0].y)*(b[0].x-e[0].x))/c;return{x:b[0].x+d*(b[1].x-b[0].x),y:b[0].y+d*(b[1].y-b[0].y),inSeg1:0<=d&&1>=d,inSeg2:0<=e&&1>=e}};this.seconds2time=function(b){var e={h:0,m:0,s:0};e.h=Math.floor(b/3600);b-=3600*e.h;e.m=Math.floor(b/60);b-=60*e.m;e.s=b;return e};this.detectOverlap=function(b,e,c,d){function f(b,c,d){function f(b,c){return Math.pow(b.x-
c.x,2)+Math.pow(b.y-c.y,2)}var e=f(c,d);if(0==e)return f(b,c);e=((b.x-c.x)*(d.x-c.x)+(b.y-c.y)*(d.y-c.y))/e;e=Math.max(0,Math.min(1,e));return f(b,{x:c.x+e*(d.x-c.x),y:c.y+e*(d.y-c.y)})}function h(b,c,d){return 0<(d.x-c.x)*(b.y-c.y)-(b.x-c.x)*(d.y-c.y)}if(c&&d){if(c[0].x<c[1].x){var g=c[0];c[0]=c[1];c[1]=g}d[0].x<d[1].x&&(g=d[0],d[0]=d[1],d[1]=g);if(c[0].y<d[1].y||c[1].y>d[0].y||c[0].x<d[1].x||c[1].x>d[0].x)return!1}c=Object.assign([],e);c.push(e[0]);for(d=0;d<b.length;d++){var m=Number.MAX_SAFE_INTEGER;
var k=!1;for(g=0;g<c.length-1;g++){var l={x:c[g].x,y:c[g].y},p={x:c[g+1].x,y:c[g+1].y},q={x:b[d].x,y:b[d].y},r=f(q,l,p);if(0==r)return!0;m>r&&(m=r,k=h(q,l,p))}if(k)return!0}var u=Object.assign([],b);u.push(b[0]);for(d=0;d<e.length;d++){m=Number.MAX_SAFE_INTEGER;k=!1;for(g=0;g<u.length-1;g++){l={x:u[g].x,y:u[g].y};p={x:u[g+1].x,y:u[g+1].y};q={x:b[d].x,y:b[d].y};r=f(q,l,p);if(0==r)return!0;m>r&&(m=r,k=h(q,l,p),testTemp=q,testTempA=l,testTempB=p)}if(k)return!0}for(g=0;g<u.length-1;g++)for(d=0;d<c.length-
1;d++)if((b=this.intersectionOfTwoLineSegments(u,c))&&b.inSeg1&&b.inSeg2)return!0;return!1};this.normalizeStretchArray=function(b){var e=b.reduce(function(b,c,d,e){return c>e[b]?d:b},0),c=Math.abs(b[e]);b=b.map(function(b){return b/c});if(0==b[0]&&1==b[b.length-1])return b;var d=0!=b[0]?b[0]:b[b.length-1];return b=b.map(function(b){return(b-d)/(1-d)})};this.curvePoint=new function(){this.linear=function(b,e,c){e=void 0===e?0:e;return(void 0===b?.5:b)*((void 0===c?1:c)-e)+e};this.sin=function(b,e,
c){e=void 0===e?0:e;return Math.sin(Math.PI/2*(void 0===b?.5:b))*((void 0===c?1:c)-e)+e};this.cos=function(b,e,c){e=void 0===e?0:e;return(1-Math.cos(Math.PI/2*(void 0===b?.5:b)))*((void 0===c?1:c)-e)+e};this.s=function(b,e,c,d){e=void 0===e?0:e;c=void 0===c?1:c;d=void 0===d?8:d;return system.utility.math.normalizeStretchArray([1/(1+Math.exp(-.5*-d)),1/(1+Math.exp(-d*((void 0===b?.5:b)-.5))),1/(1+Math.exp(.5*-d))])[1]*(c-e)+e};this.exponential=function(b,e,c,d){e=void 0===e?0:e;c=void 0===c?1:c;d=
void 0===d?2:d;return system.utility.math.normalizeStretchArray([(Math.exp(0*d)-1)/(Math.E-1),(Math.exp(d*(void 0===b?.5:b))-1)/(Math.E-1),(Math.exp(1*d)-1)/(Math.E-1)])[1]*(c-e)+e}};this.curveGenerator=new function(){this.linear=function(b,e,c){e=void 0===e?0:e;c=void 0===c?1:c;b=Math.abs(void 0===b?2:b)-1;for(var d=[0],f=1;f<b;f++)d.push(f/b);d.push(1);b=c-e;for(f=0;f<d.length;f++)d[f]=d[f]*b+e;return d};this.sin=function(b,e,c){e=void 0===e?0:e;c=void 0===c?1:c;b=Math.abs(void 0===b?2:b)-1;for(var d=
[0],f=1;f<b;f++)d.push(Math.sin(Math.PI/2*(f/b)));d.push(1);b=c-e;for(f=0;f<d.length;f++)d[f]=d[f]*b+e;return d};this.cos=function(b,e,c){e=void 0===e?0:e;c=void 0===c?1:c;b=Math.abs(void 0===b?2:b)-1;for(var d=[0],f=1;f<b;f++)d.push(1-Math.cos(Math.PI/2*(f/b)));d.push(1);b=c-e;for(f=0;f<d.length;f++)d[f]=d[f]*b+e;return d};this.s=function(b,e,c,d){b=void 0===b?2:b;e=void 0===e?0:e;c=void 0===c?1:c;d=void 0===d?8:d;0==d&&(d=1E-6);for(var f=[],h=0;h<b;h++)f.push(1/(1+Math.exp(-d*(h/b-.5))));b=system.utility.math.normalizeStretchArray(f);
c-=e;for(h=0;h<b.length;h++)b[h]=b[h]*c+e;return b};this.exponential=function(b,e,c,d){e=void 0===e?0:e;c=void 0===c?1:c;d=void 0===d?2:d;b=(void 0===b?2:b)-1;for(var f=[],h=0;h<=b;h++)f.push((Math.exp(h/b*d)-1)/(Math.E-1));f=system.utility.math.normalizeStretchArray(f);b=c-e;for(h=0;h<f.length;h++)f[h]=f[h]*b+e;return f}};this.relativeDistance=function(b,e,c,d,f){e=(d-e)/(c-e);if(void 0===f||!f){if(1<e)return b;if(0>e)return 0}return e*b};this.lineCorrecter=function(b,e,c){if(!(0>b.x1||0>b.x2||b.x1>
c||b.x2>c||0>b.y1&&0>b.y2||b.y1>e&&b.y2>e))return c=(b.y2-b.y1)/(b.x2-b.x1),0>b.y1?(b.x1=(0-b.y1+c*b.x1)/c,b.y1=0):0>b.y2&&(b.x2=(0-b.y2+c*b.x2)/c,b.y2=0),b.y1>e?(b.x1=(e-b.y1+c*b.x1)/c,b.y1=e):b.y2>e&&(b.x2=(e-b.y2+c*b.x2)/c,b.y2=e),b}};this.misc=new function(){this.padString=function(b,e,c){c=void 0===c?" ":c;if(1>c.length)return b;for(b=""+b;b.length<e;)b=c+b;return b};this.blendColours=function(b,e,c){function d(b){b=b.split(",");b[0]=b[0].replace("rgba(","");b[3]=b[3].replace(")","");return b.map(function(b){return parseFloat(b)})}
b=d(b);e=d(e);for(var f=[],h=0;h<b.length;h++)f[h]=(1-c)*b[h]+c*e[h];return"rgba("+f[0]+","+f[1]+","+f[2]+","+f[3]+")"};this.multiBlendColours=function(b,e){if(0==e)return b[0];if(1==e)return b[b.length-1];e*=b.length-1;return system.utility.misc.blendColours(b[~~e],b[~~e+1],e%1)};this.compressString=function(b){return system.utility.thirdparty.lzString.compress(b)};this.decompressString=function(b){return system.utility.thirdparty.lzString.decompress(b)};this.serialize=function(b,e){e=void 0===e?
!0:e;b=JSON.stringify(b,function(b,d){switch({}.toString.call(d).match(/\s([a-zA-Z]+)/)[1].toLowerCase()){case "function":return{__uniqueType:"function",__value:d.toString(),__name:d.name};case "arraybuffer":return{__uniqueType:"arraybuffer",__value:btoa(String.fromCharCode(new Uint8Array(d)))};case "audiobuffer":b=[];for(var c=0;c<d.numberOfChannels;c++)b.push(Array.from(d.getChannelData(c)));return{__uniqueType:"audiobuffer",__channelData:b,__sampleRate:d.sampleRate,__numberOfChannels:d.numberOfChannels,
__length:d.length};default:return d}});e&&(b=system.utility.misc.compressString(b));return b};this.unserialize=function(b,e){if(void 0!==b)return(void 0===e||e)&&(b=system.utility.misc.decompressString(b)),JSON.parse(b,function(b,d){if("object"==typeof d&&null!=d&&"__uniqueType"in d)switch(d.__uniqueType){case "function":b=d.__value.substring(0,d.__value.indexOf("{"));b=b.substring(b.indexOf("(")+1,b.lastIndexOf(")"));d=d.__value.substring(d.__value.indexOf("{")+1,d.__value.lastIndexOf("}"));d=Function(b,
d);break;case "arraybuffer":d=atob(d.__value);for(b=0;b<d.length;b++)d[b]=d[b].charCodeAt(0);d=new ArrayBuffer(d);break;case "audiobuffer":var c=system.audio.context.createBuffer(d.__numberOfChannels,d.__length,d.__sampleRate);for(b=0;b<c.numberOfChannels;b++){workingBuffer=c.getChannelData(b);for(var e=0;e<c.length;e++)workingBuffer[e]=d.__channelData[b][e]}d=c;break;default:d=d.__value}return d})};this.openFile=function(b,e){e=void 0===e?"readAsBinaryString":e;var c=document.createElement("input");
c.type="file";c.onchange=function(){var c=new FileReader;switch(e){case "readAsArrayBuffer":c.readAsArrayBuffer(this.files[0]);break;default:c.readAsBinaryString(this.files[0])}c.onloadend=function(){b&&b(c.result)}};c.click()};this.printFile=function(b,e){var c=document.createElement("a");c.href=URL.createObjectURL(new Blob([e]));c.download=b;c.click()};this.openURL=function(b){window.open(b,"_blank")}};this.thirdparty=new function(){this.lzString=function(){var b=String.fromCharCode,e={},c={compress:function(b){return null==
b?"":c._compress(b,6,function(b){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(b)})},decompress:function(b){if(null==b)return"";if(""==b)return null;b=b.replace(/ /g,"+");return c._decompress(b.length,32,function(c){c=b.charAt(c);if(!e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]){e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]={};for(var d=0;65>d;d++)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(d)]=
d}return e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"][c]})},_compress:function(b,c,e){if(null==b)return"";var d,f={},h={},l="",p=2,q=3,r=2,u=[],t=0,v=0,n;for(n=0;n<b.length;n+=1){var x=b.charAt(n);Object.prototype.hasOwnProperty.call(f,x)||(f[x]=q++,h[x]=!0);var y=l+x;if(Object.prototype.hasOwnProperty.call(f,y))l=y;else{if(Object.prototype.hasOwnProperty.call(h,l)){if(256>l.charCodeAt(0)){for(d=0;d<r;d++)t<<=1,v==c-1?(v=0,u.push(e(t)),t=0):v++;var w=l.charCodeAt(0);for(d=
0;8>d;d++)t=t<<1|w&1,v==c-1?(v=0,u.push(e(t)),t=0):v++,w>>=1}else{w=1;for(d=0;d<r;d++)t=t<<1|w,v==c-1?(v=0,u.push(e(t)),t=0):v++,w=0;w=l.charCodeAt(0);for(d=0;16>d;d++)t=t<<1|w&1,v==c-1?(v=0,u.push(e(t)),t=0):v++,w>>=1}p--;0==p&&(p=Math.pow(2,r),r++);delete h[l]}else for(w=f[l],d=0;d<r;d++)t=t<<1|w&1,v==c-1?(v=0,u.push(e(t)),t=0):v++,w>>=1;p--;0==p&&(p=Math.pow(2,r),r++);f[y]=q++;l=String(x)}}if(""!==l){if(Object.prototype.hasOwnProperty.call(h,l)){if(256>l.charCodeAt(0)){for(d=0;d<r;d++)t<<=1,v==
c-1?(v=0,u.push(e(t)),t=0):v++;w=l.charCodeAt(0);for(d=0;8>d;d++)t=t<<1|w&1,v==c-1?(v=0,u.push(e(t)),t=0):v++,w>>=1}else{w=1;for(d=0;d<r;d++)t=t<<1|w,v==c-1?(v=0,u.push(e(t)),t=0):v++,w=0;w=l.charCodeAt(0);for(d=0;16>d;d++)t=t<<1|w&1,v==c-1?(v=0,u.push(e(t)),t=0):v++,w>>=1}p--;0==p&&(p=Math.pow(2,r),r++);delete h[l]}else for(w=f[l],d=0;d<r;d++)t=t<<1|w&1,v==c-1?(v=0,u.push(e(t)),t=0):v++,w>>=1;p--;0==p&&r++}w=2;for(d=0;d<r;d++)t=t<<1|w&1,v==c-1?(v=0,u.push(e(t)),t=0):v++,w>>=1;for(;;)if(t<<=1,v==
c-1){u.push(e(t));break}else v++;return u.join("")},_decompress:function(c,f,e){var d=[],h=4,k=4,l=3,p=[],q,r,u=e(0),t=f,v=1;for(q=0;3>q;q+=1)d[q]=q;var n=0;var x=Math.pow(2,2);for(r=1;r!=x;){var y=u&t;t>>=1;0==t&&(t=f,u=e(v++));n|=(0<y?1:0)*r;r<<=1}switch(n){case 0:n=0;x=Math.pow(2,8);for(r=1;r!=x;)y=u&t,t>>=1,0==t&&(t=f,u=e(v++)),n|=(0<y?1:0)*r,r<<=1;var w=b(n);break;case 1:n=0;x=Math.pow(2,16);for(r=1;r!=x;)y=u&t,t>>=1,0==t&&(t=f,u=e(v++)),n|=(0<y?1:0)*r,r<<=1;w=b(n);break;case 2:return""}q=d[3]=
w;for(p.push(w);;){if(v>c)return"";n=0;x=Math.pow(2,l);for(r=1;r!=x;)y=u&t,t>>=1,0==t&&(t=f,u=e(v++)),n|=(0<y?1:0)*r,r<<=1;switch(w=n){case 0:n=0;x=Math.pow(2,8);for(r=1;r!=x;)y=u&t,t>>=1,0==t&&(t=f,u=e(v++)),n|=(0<y?1:0)*r,r<<=1;d[k++]=b(n);w=k-1;h--;break;case 1:n=0;x=Math.pow(2,16);for(r=1;r!=x;)y=u&t,t>>=1,0==t&&(t=f,u=e(v++)),n|=(0<y?1:0)*r,r<<=1;d[k++]=b(n);w=k-1;h--;break;case 2:return p.join("")}0==h&&(h=Math.pow(2,l),l++);if(d[w])w=d[w];else if(w===k)w=q+q.charAt(0);else return null;p.push(w);
d[k++]=q+w.charAt(0);h--;q=w;0==h&&(h=Math.pow(2,l),l++)}}};return c}()};this.experimental=new function(){}};system.pane=new function(){if(system.svgElement.children){for(var b=0;b<system.svgElement.children.length;b++)if(system.svgElement.children[b].hasAttribute("pane"))switch(system.svgElement.children[b].getAttribute("pane")){case "global":this.workspace=system.svgElement.children[b];break;case "staticBackground":this.staticBackground=system.svgElement.children[b];break;case "background":this.background=
system.svgElement.children[b];break;case "middleground":this.middleground=system.svgElement.children[b];break;case "foreground":this.foreground=system.svgElement.children[b];break;case "control":this.control=system.svgElement.children[b]}null==this.workspace&&(this.workspace=document.createElementNS("http://www.w3.org/2000/svg","g"),this.workspace.setAttribute("pane","workspace"));null==this.staticBackground&&(this.staticBackground=document.createElementNS("http://www.w3.org/2000/svg","g"),this.staticBackground.setAttribute("pane",
"staticBackground"));null==this.background&&(this.background=document.createElementNS("http://www.w3.org/2000/svg","g"),this.background.setAttribute("pane","background"));null==this.middleground&&(this.middleground=document.createElementNS("http://www.w3.org/2000/svg","g"),this.middleground.setAttribute("pane","middleground"));null==this.foreground&&(this.foreground=document.createElementNS("http://www.w3.org/2000/svg","g"),this.foreground.setAttribute("pane","foreground"));null==this.control&&(this.control=
document.createElementNS("http://www.w3.org/2000/svg","g"),this.control.setAttribute("pane","control"))}setTimeout(function(){system.utility.element.makeUnselectable(system.pane.staticBackground);system.utility.element.makeUnselectable(system.pane.background);system.utility.element.makeUnselectable(system.pane.middleground);system.utility.element.makeUnselectable(system.pane.foreground)},10);this.staticBackground.style.transform||(this.staticBackground.style.transform="translate(0px,0px) scale(1) rotate(0rad)");
this.staticBackground.setAttribute("global",!0);this.workspace.style.transform||(this.workspace.style.transform="translate(0px,0px) scale(1) rotate(0rad)");this.workspace.setAttribute("global",!0);this.control.style.transform||(this.control.style.transform="translate(0px,0px) scale(1) rotate(0rad)");this.control.setAttribute("global",!0);system.svgElement.innerHTML="";system.svgElement.append(this.staticBackground);system.svgElement.append(this.workspace);system.svgElement.append(this.control);this.workspace.append(this.background);
this.workspace.append(this.middleground);this.workspace.append(this.foreground);system.svgElement.onmouseover=function(b){system.super.enableWindowScrollbarAutomaticRemoval&&(document.body.style.overflow="hidden")};system.svgElement.onmouseout=function(b){system.super.enableWindowScrollbarAutomaticRemoval&&(document.body.style.overflow="")}};system.selection=new function(){this.selectedObjects=[];this.lastselectedObjects=null;this.clipboard=[];this.deselectEverything=function(b){b=void 0===b?[]:b;
for(var e=[],c=0;c<system.selection.selectedObjects.length;c++)if(b.includes(system.selection.selectedObjects[c]))e.push(system.selection.selectedObjects[c]);else if(system.selection.selectedObjects[c].onDeselect)system.selection.selectedObjects[c].onDeselect();system.selection.selectedObjects=e};this.selectObject=function(b){if(-1==system.selection.selectedObjects.indexOf(b)){var e=system.utility.workspace.getPane(b);e.removeChild(b);e.append(b);if(b.onSelect)b.onSelect();system.selection.selectedObjects.push(b);
system.selection.lastselectedObjects=b}};this.deselectObject=function(b){system.selection.selectedObjects.splice(system.selection.selectedObjects.indexOf(b),1);if(b.onDeselect)b.onDeselect()};this.cut=function(){this.copy();this.delete()};this.copy=function(){this.clipboard=[];for(var b=0;b<this.selectedObjects.length;b++){var e=[];e.push(system.utility.workspace.getPane(this.selectedObjects[b]));if(this.selectedObjects[b].creatorMethod){e.push(this.selectedObjects[b].creatorMethod);e.push(system.utility.element.getTransform(this.selectedObjects[b]));
this.selectedObjects[b].exportData?e.push(this.selectedObjects[b].exportData()):e.push(null);if(this.selectedObjects[b].io){for(var c=[],d=Object.keys(this.selectedObjects[b].io),f=0;f<d.length;f++){var h=[];h.push(d[f]);if(this.selectedObjects[b].io[d[f]].foreignNode){for(var g=Object.keys(this.selectedObjects[b].io[d[f]].foreignNode.parentElement.io),m=0;m<g.length;m++)if(this.selectedObjects[b].io[d[f]].foreignNode.parentElement.io[g[m]]===this.selectedObjects[b].io[d[f]].foreignNode){h.push(g[m]);
h.push(this.selectedObjects.indexOf(this.selectedObjects[b].io[d[f]].foreignNode.parentElement));break}0<=h[2]&&c.push(h)}}e.push(c)}this.clipboard.push(e)}else system.selection.deselectObject(this.selectedObjects[b]),b--}};this.paste=function(b){b=void 0===b?null:b;if(0!=this.clipboard.length){this.deselectEverything();if("duplicate"!=b){var e=[];this.clipboard.forEach(function(b){return e.push(b[2])});var c=system.utility.math.boundingBoxFromPoints(e)[0];b||(b=system.utility.workspace.pointConverter.browser2workspace(system.mouse.currentPosition[0],
system.mouse.currentPosition[1]));this.clipboard.forEach(function(d){d[2].x+=b.x-c.x;d[2].y+=b.y-c.y})}this.clipboard.forEach(function(b){var c=b[1](b[2].x,b[2].y);c.importData&&c.importData(b[3]);b[0].appendChild(c);system.selection.selectObject(c);b[4]&&b[4].forEach(function(b){b[2]<system.selection.selectedObjects.length&&c.io[b[0]].connectTo(system.selection.selectedObjects[b[2]].io[b[1]])})})}};this.duplicate=function(){this.copy();this.paste("duplicate");this.clipboard=[]};this.delete=function(){for(;0<
this.selectedObjects.length;)system.utility.object.deleteObject(this.selectedObjects[0]),this.selectedObjects.shift();this.lastselectedObjects=null}};system.mouse=new function(){this.currentPosition=[];this.wheelInterpreter=function(b){return b/100};this.objectGrapple_functionList={};this.objectGrapple_functionList.onmousedown=[];this.objectGrapple_functionList.onmouseup=[];this.declareObjectGrapple=function(b,e,c){c?(b.target=e?e:b,b.target.creatorMethod=c,b.target.grapple=b,b.target.style.transform=
b.target.style.transform?b.target.style.transform:"translate(0px,0px) scale(1) rotate(0rad)",b.onmousedown=function(b){if(0==b.button){system.svgElement.temp_onmousedown_originalObject=this.target;for(var c=0;c<system.mouse.objectGrapple_functionList.onmousedown.length;c++){for(var d=!0,e=0;e<system.mouse.objectGrapple_functionList.onmousedown[c].specialKeys.length&&(d=d&&b[system.mouse.objectGrapple_functionList.onmousedown[c].specialKeys[e]],d);e++);if(d){system.mouse.objectGrapple_functionList.onmousedown[c].function(b);
break}}}},b.onmouseup=function(b){system.svgElement.temp_onmouseup_originalObject=this.target;for(var c=0;c<system.mouse.objectGrapple_functionList.onmouseup.length;c++){for(var d=!0,e=0;e<system.mouse.objectGrapple_functionList.onmouseup[c].specialKeys.length&&(d=d&&b[system.mouse.objectGrapple_functionList.onmouseup[c].specialKeys[e]],d);e++);if(d){system.mouse.objectGrapple_functionList.onmouseup[c].function(b);break}}}):console.error('"declareObjectGrapple" requires a creatorMethod')};this.objectGrapple_functionList.onmousedown.push({specialKeys:[system.super.keys.alt],
"function":function(b){system.super.readOnlyMode||(system.selection.selectedObjects.includes(system.svgElement.temp_onmousedown_originalObject)||system.selection.selectObject(system.svgElement.temp_onmousedown_originalObject),system.selection.duplicate(),system.selection.selectedObjects[0].grapple.onmousedown({x:b.x,y:b.y,button:0}))}});this.objectGrapple_functionList.onmousedown.push({specialKeys:[],"function":function(b){if(!system.super.readOnlyMode){system.selection.selectedObjects.includes(system.svgElement.temp_onmousedown_originalObject)||
(b.shiftKey||system.selection.deselectEverything(),system.selection.selectObject(system.svgElement.temp_onmousedown_originalObject));system.svgElement.temp_oldClickPosition=[b.x,b.y];system.svgElement.temp_oldObjectPositions=[];for(var e=0;e<system.selection.selectedObjects.length;e++)system.svgElement.temp_oldObjectPositions.push(system.utility.element.getTransform(system.selection.selectedObjects[e]));system.svgElement.onmousemove_old=system.svgElement.onmousemove;system.svgElement.onmousemove=
function(b){for(var c=0;c<system.selection.selectedObjects.length;c++){var f=system.svgElement.temp_oldClickPosition,e={};e.x=system.svgElement.temp_oldObjectPositions[c].x;e.y=system.svgElement.temp_oldObjectPositions[c].y;e.s=system.svgElement.temp_oldObjectPositions[c].s;e.r=system.svgElement.temp_oldObjectPositions[c].r;var g=system.utility.workspace.getGlobalScale(system.selection.selectedObjects[c]);e.x-=(f[0]-b.x)/g;e.y-=(f[1]-b.y)/g;system.utility.element.setTransform(system.selection.selectedObjects[c],
e);if(system.selection.selectedObjects[c].onMove)system.selection.selectedObjects[c].onMove();system.selection.selectedObjects[c].updateSelectionArea&&system.selection.selectedObjects[c].updateSelectionArea();if(system.selection.selectedObjects[c].io)for(f=Object.keys(system.selection.selectedObjects[c].io),e=0;e<f.length;e++)if(Array.isArray(system.selection.selectedObjects[c].io[f[e]]))for(g=0;g<system.selection.selectedObjects[c].io[f[e]].length;g++)system.selection.selectedObjects[c].io[f[e]][g].redraw();
else system.selection.selectedObjects[c].io[f[e]].redraw()}};system.svgElement.onmouseup=function(){this.onmousemove=null;delete system.svgElement.tempElements;this.onmousemove=system.svgElement.onmousemove_old;delete this.temp_onmousedown_originalObject;delete this.temp_oldClickPosition;delete this.temp_oldObjectPositions;delete this.onmouseleave;delete this.onmouseup};system.svgElement.onmouseleave=system.svgElement.onmouseup;system.svgElement.onmousemove(b)}}});this.objectGrapple_functionList.onmouseup.push({specialKeys:[],
"function":function(b){system.selection.selectedObjects.includes(system.svgElement.temp_onmouseup_originalObject)&&(b.shiftKey&&system.selection.lastselectedObjects!=system.svgElement.temp_onmouseup_originalObject&&system.selection.deselectObject(system.svgElement.temp_onmouseup_originalObject),system.selection.lastselectedObjects=null)}});this.onmousemove_functionList=[];system.svgElement.onmousemove=function(b){control.mousemove(b);if(system.utility.object.requestInteraction(b.x,b.y,"onmousemove",
"workspace"))for(var e=0;e<system.mouse.onmousemove_functionList.length;e++){for(var c=!0,d=0;d<system.mouse.onmousemove_functionList[e].specialKeys.length&&(c=c&&b[system.mouse.onmousemove_functionList[e].specialKeys[d]],c);d++);if(c){system.mouse.onmousemove_functionList[e].function(b);break}}};this.onmousemove_functionList.push({specialKeys:[],"function":function(b){system.mouse.currentPosition=[b.x,b.y]}});this.onmousedown_functionList=[];system.svgElement.onmousedown=function(b){control.mousedown(b);
if(system.utility.object.requestInteraction(b.x,b.y,"onmousedown","workspace")&&0==b.button)for(var e=0;e<system.mouse.onmousedown_functionList.length;e++){for(var c=!0,d=0;d<system.mouse.onmousedown_functionList[e].specialKeys.length&&(c=c&&b[system.mouse.onmousedown_functionList[e].specialKeys[d]],c);d++);if(c){system.mouse.onmousedown_functionList[e].function(b,system.pane.workspace);break}}};this.onmousedown_functionList.push({specialKeys:["shiftKey"],"function":function(b,e){system.svgElement.tempData=
{};system.svgElement.tempElements=[];system.svgElement.tempData.start={x:b.x,y:b.y};system.svgElement.tempElements.push(part.builder("path",null,{path:[system.svgElement.tempData.start,system.svgElement.tempData.start,system.svgElement.tempData.start,system.svgElement.tempData.start],type:"L",style:"fill:rgba(120,120,255,0.25)"}));for(var c=0;c<system.svgElement.tempElements.length;c++)system.pane.control.append(system.svgElement.tempElements[c]);system.svgElement.onmousemove_old=system.svgElement.onmousemove;
system.svgElement.onmousemove=function(b){system.svgElement.tempData.end={x:b.x,y:b.y};system.svgElement.tempElements[0].path([{x:system.svgElement.tempData.start.x,y:system.svgElement.tempData.start.y},{x:system.svgElement.tempData.end.x,y:system.svgElement.tempData.start.y},{x:system.svgElement.tempData.end.x,y:system.svgElement.tempData.end.y},{x:system.svgElement.tempData.start.x,y:system.svgElement.tempData.end.y}])};system.svgElement.onmouseup=function(){system.selection.deselectEverything();
var b=system.utility.workspace.pointConverter.browser2workspace(system.svgElement.tempData.start.x,system.svgElement.tempData.start.y),c=system.utility.workspace.pointConverter.browser2workspace(system.svgElement.tempData.end.x,system.svgElement.tempData.end.y);var h=[{},{}];b.x>c.x?(h[0].x=b.x,h[1].x=c.x):(h[0].x=c.x,h[1].x=b.x);b.y>c.y?(h[0].y=b.y,h[1].y=c.y):(h[0].y=c.y,h[1].y=b.y);b=Math.sign(b.x-c.x)!=Math.sign(b.y-c.y)?[b,{x:b.x,y:c.y},c,{x:c.x,y:b.y}]:[b,{x:c.x,y:b.y},c,{x:b.x,y:c.y}];c=system.pane.middleground.children;
for(var g=[],m=0;m<c.length;m++)c[m].selectionArea&&system.utility.math.detectOverlap(b,c[m].selectionArea.points,h,c[m].selectionArea.box)&&g.push(c[m]);for(m=0;m<g.length;m++)system.selection.selectObject(g[m]);delete system.svgElement.tempData;for(m=0;m<system.svgElement.tempElements.length;m++)system.pane.control.removeChild(system.svgElement.tempElements[m]),system.svgElement.tempElements[m]=null;delete system.svgElement.tempElements;this.onmousemove=system.svgElement.onmousemove_old;delete system.svgElement.onmousemove_old;
this.onmouseleave=null;e.removeAttribute("oldPosition");e.removeAttribute("clickPosition");this.onmouseup=this.onmouseleave=null};system.svgElement.onmouseleave=system.svgElement.onmouseup;system.svgElement.onmousemove(b)}});this.onmousedown_functionList.push({specialKeys:[],"function":function(b,e){system.super.mouseGripPanningEnabled&&(system.selection.deselectEverything(),system.svgElement.temp_oldPosition=system.utility.element.getTransform(e),system.pane.workspace.setAttribute("clickPosition",
"["+b.x+","+b.y+"]"),system.svgElement.onmousemove_old=system.svgElement.onmousemove,system.svgElement.onmousemove=function(b){var c={};c.x=system.svgElement.temp_oldPosition.x;c.y=system.svgElement.temp_oldPosition.y;c.s=system.svgElement.temp_oldPosition.s;c.r=system.svgElement.temp_oldPosition.r;var f=JSON.parse(e.getAttribute("clickPosition"));c.x-=f[0]-b.x;c.y-=f[1]-b.y;system.utility.element.setTransform(e,c)},system.svgElement.onmouseup=function(){this.onmousemove=system.svgElement.onmousemove_old;
delete system.svgElement.onmousemove_old;e.removeAttribute("oldPosition");e.removeAttribute("clickPosition");this.onmouseup=this.onmouseleave=null},system.svgElement.onmouseleave=system.svgElement.onmouseup,system.svgElement.onmousemove(b))}});this.onwheel_functionList=[];system.svgElement.onwheel=function(b){control.mousewheel(b);if(system.utility.object.requestInteraction(b.x,b.y,"onwheel","workspace"))for(var e=0;e<system.mouse.onwheel_functionList.length;e++){for(var c=!0,d=0;d<system.mouse.onwheel_functionList[e].specialKeys.length&&
(c=c&&b[system.mouse.onwheel_functionList[e].specialKeys[d]],c);d++);if(c){system.mouse.onwheel_functionList[e].function(b);break}}};this.onwheel_functionList.push({specialKeys:[],"function":function(b){if(system.super.mouseWheelZoomEnabled){var e=system.utility.element.getTransform(system.pane.workspace),c=(b.x-e.x)/e.s,d=(b.y-e.y)/e.s,f=e.s*(c+e.x/e.s),h=e.s*(d+e.y/e.s);e.s-=e.s*system.mouse.wheelInterpreter(b.deltaY);10<e.s&&(e.s=10);.1>e.s&&(e.s=.1);b=e.s*(d+e.y/e.s);e.x-=e.s*(c+e.x/e.s)-f;e.y-=
b-h;system.utility.element.setTransform(system.pane.workspace,e)}}})};system.keyboard=new function(){this.pressedKeys={};this.declareKeycaptureObject=function(b,e){function c(b,c){if(!d[b])return!1;modifiers={shift:c.shiftKey,control:c[system.super.keys.ctrl],meta:c.metaKey,alt:c[system.super.keys.alt]};return c.control&&e.control&&("all"==e.control||Array.isArray(e.control)&&e.control.includes(c.key))||c.shiftKey&&e.shift&&("all"==e.shift||Array.isArray(e.shift)&&e.shift.includes(c.key))||c.metaKey&&
e.meta&&("all"==e.meta||Array.isArray(e.meta)&&e.meta.includes(c.key))||c.alt&&e.alt&&("all"==e.alt||Array.isArray(e.alt)&&e.alt.includes(c.key))||e.none&&("all"==e.none||Array.isArray(e.none)&&e.none.includes(c.key))?(d[b](c.key,modifiers),!0):!1}e=void 0===e?{none:[],shift:[],control:[],meta:[],alt:[]}:e;var d=new function(){this.keyPress=function(b,c){};this.keyRelease=function(b,c){}};b.onkeydown=function(b){return c("keyPress",b)};b.onkeyup=function(b){return c("keyRelease",b)};return d};document.onkeydown=
function(b){if(!system.keyboard.pressedKeys[b.code]){system.keyboard.pressedKeys[b.code]=!0;var e=[system.mouse.currentPosition[0],system.mouse.currentPosition[1]];if(!system.utility.object.requestInteraction(e[0],e[1],"onkeydown","workspace"))if(void 0!=system.utility.workspace.objectUnderPoint(e[0],e[1]).onkeydown){if(system.utility.workspace.objectUnderPoint(e[0],e[1]).onkeydown(b))return}else for(e=document.elementFromPoint(e[0],e[1]);!e.hasAttribute("pane");){if(void 0!=e.onkeydown&&e.onkeydown(b))return;
e=e.parentElement}control.keydown(b)}};document.onkeyup=function(b){if(system.keyboard.pressedKeys[b.code]){delete system.keyboard.pressedKeys[b.code];var e=[system.mouse.currentPosition[0],system.mouse.currentPosition[1]];if(!system.utility.object.requestInteraction(e[0],e[1],"onkeyup","workspace"))if(void 0!=system.utility.workspace.objectUnderPoint(e[0],e[1]).onkeyup){if(system.utility.workspace.objectUnderPoint(e[0],e[1]).onkeyup(b))return}else for(e=document.elementFromPoint(e[0],e[1]);!e.hasAttribute("pane");){if(void 0!=
e.onkeyup&&e.onkeyup(b))return;e=e.parentElement}control.keyup(b)}};this.releaseAll=function(){for(key in this.pressedKeys)document.onkeyup(new KeyboardEvent("keyup",{key:key}))}};system.audio=new function(){this.context=new (window.AudioContext||window.webkitAudioContext);this.destination=this.context.createGain();this.destination.connect(this.context.destination);this.destination._gain=1;this.destination.masterGain=function(b){if(void 0==b)return this.destination._gain;this._gain=b;system.utility.audio.changeAudioParam(system.audio.context,
this.gain,this._gain,.01,"instant",!0)};this.names_frequencies_split={0:{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,"A#":29.14,B:30.87},1:{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},2:{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.8,A:110,"A#":116.5,B:123.5},3:{C:130.8,"C#":138.6,D:146.8,"D#":155.6,E:164.8,F:174.6,"F#":185,G:196,"G#":207.7,A:220,"A#":233.1,B:246.9},
4:{C:261.6,"C#":277.2,D:293.7,"D#":311.1,E:329.6,F:349.2,"F#":370,G:392,"G#":415.3,A:440,"A#":466.2,B:493.9},5:{C:523.3,"C#":554.4,D:587.3,"D#":622.3,E:659.3,F:698.5,"F#":740,G:784,"G#":830.6,A:880,"A#":932.3,B:987.8},6:{C:1047,"C#":1109,D:1175,"D#":1245,E:1319,F:1397,"F#":1480,G:1568,"G#":1661,A:1760,"A#":1865,B:1976},7:{C:2093,"C#":2217,D:2349,"D#":2489,E:2637,F:2794,"F#":2960,G:3136,"G#":3322,A:3520,"A#":3729,B:3951},8:{C:4186,"C#":4435,D:4699,"D#":4978,E:5274,F:5588,"F#":5920,G:6272,"G#":6645,
A:7040,"A#":7459,B:7902}};this.names_frequencies={};for(var b=Object.entries(this.names_frequencies_split),e=0;e<b.length;e++)for(var c=Object.entries(this.names_frequencies_split[e]),d=0;d<c.length;d++)this.names_frequencies[b[e][0]+c[d][0]]=c[d][1];this.frequencies_names={};b=Object.entries(this.names_frequencies);for(e=0;e<b.length;e++)this.frequencies_names[b[e][1]]=b[e][0];this.getFreq=function(b){return this.names_frequencies[b]};this.getName=function(b){return this.frequencies_names[b]};b=
"0C 0C# 0D 0D# 0E 0F 0F# 0G 0G# 0A 0A# 0B 1C 1C# 1D 1D# 1E 1F 1F# 1G 1G# 1A 1A# 1B 2C 2C# 2D 2D# 2E 2F 2F# 2G 2G# 2A 2A# 2B 3C 3C# 3D 3D# 3E 3F 3F# 3G 3G# 3A 3A# 3B 4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C 7C# 7D 7D# 7E 7F 7F# 7G 7G# 7A 7A# 7B 8C 8C# 8D 8D# 8E 8F 8F# 8G 8G# 8A 8A# 8B".split(" ");this.midinumbers_names={};for(e=0;e<b.length;e++)this.midinumbers_names[e+24]=b[e];this.names_midinumbers={};b=Object.entries(this.midinumbers_names);
for(e=0;e<b.length;e++)this.names_midinumbers[b[e][1]]=parseInt(b[e][0]);this.num2name=function(b){return this.midinumbers_names[b]};this.num2freq=function(b){return this.names_frequencies[this.midinumbers_names[b]]};this.name2num=function(b){return this.names_midinumbers[b]};this.name2freq=function(b){return this.names_frequencies[b]};this.freq2num=function(b){return this.names_midinumbers[this.frequencies_names[b]]};this.freq2name=function(b){return this.frequencies_names[b]}};var part=new function(){this.circuit=
new function(){this.audio=new function(){this.recorder=function(b){function e(){switch(d.recordingNode.node.state){case "inactive":case "paused":return c.recordingLength;case "recording":return b.currentTime-c.recordingStartTime}}var c={recordedChunks:[],recordingStartTime:-1,recordingLength:0},d={leftIn:{},rightIn:{},recordingNode:{},leftOut:{},rightOut:{}};d.leftIn.node=b.createAnalyser();d.rightIn.node=b.createAnalyser();d.recordingNode.audioDest=new MediaStreamAudioDestinationNode(b);d.recordingNode.node=
new MediaRecorder(d.recordingNode.audioDest.stream,{mimeType:"audio/webm"});d.recordingNode.node.onstart=function(){};d.recordingNode.node.ondataavailable=function(b){c.recordedChunks.push(b.data)};d.recordingNode.node.onpause=function(){};d.recordingNode.node.onresume=function(){};d.recordingNode.node.onerror=function(b){console.log(b)};d.recordingNode.node.onstop=function(){};d.leftIn.node.connect(d.recordingNode.audioDest);d.rightIn.node.connect(d.recordingNode.audioDest);d.leftOut.node=b.createAnalyser();
d.leftIn.node.connect(d.leftOut.node);d.rightOut.node=b.createAnalyser();d.rightIn.node.connect(d.rightOut.node);this.clear=function(){this.stop();c.recordedChunks=[];c.recordingStartTime=-1;c.recordingLength=0};this.start=function(){this.clear();d.recordingNode.node.start();c.recordingStartTime=b.currentTime};this.pause=function(){"inactive"!=this.state()&&(c.recordingLength=e(),d.recordingNode.node.pause())};this.resume=function(){d.recordingNode.node.resume();c.recordingStartTime=b.currentTime-
c.recordingLength};this.stop=function(){"inactive"!=this.state()&&(c.recordingLength=e(),d.recordingNode.node.stop())};this.export=function(){return new Blob(c.recordedChunks,{type:"audio/ogg; codecs=opus"})};this.save=function(b){b=void 0===b?"output":b;var c=document.createElement("a");c.href=URL.createObjectURL(this.export());c.download=b+".ogg";document.body.appendChild(c);c.click();document.body.removeChild(c)};this.state=function(){return d.recordingNode.node.state};this.recordingTime=function(){return e()};
this.getTrack=function(){return new Blob(c.recordedChunks,{type:"audio/ogg; codecs=opus"})};this.in_left=function(){return d.leftIn.node};this.in_right=function(){return d.rightIn.node};this.out_left=function(){return d.leftOut.node};this.out_right=function(){return d.rightOut.node}};this.audioIn=function(b,e){e=void 0===e?!0:e;var c=1;var d=b.createGain();system.utility.audio.changeAudioParam(b,d.gain,c);this.out=function(){return d};this.listDevices=function(b){navigator.mediaDevices.enumerateDevices().then(function(c){b(c.filter(function(b){return"audioinput"===
b.kind}))})};this.selectDevice=function(b){navigator.mediaDevices.getUserMedia({audio:{deviceId:b}}).then(function(b){audioDevice=b;system.audio.context.createMediaStreamSource(b).connect(d)},function(c){console.warn('could not find audio input device: "'+b+'"');console.warn("\terror:",c)})};this.gain=function(e){if(null==e)return c;c=e;system.utility.audio.changeAudioParam(b,d.gain,e)};e&&this.selectDevice("default")};this.synthesizer2=function(b,e,c,d,f,h,g,m,k,l,p,q,r,u,t,v){c=void 0===c?{sin:[0,
1],cos:[0,0]}:c;d=void 0===d?1:d;f=void 0===f?0:f;h=void 0===h?0:h;g=void 0===g?.01:g;m=void 0===m?1:m;k=void 0===k?{time:.01,curve:"linear"}:k;l=void 0===l?{time:.05,curve:"linear"}:l;t=void 0===t?.01:t;v=void 0===v?1:v;var n={},x={},y={},w={};n.waveType=void 0===e?"sine":e;n.periodicWave=c;n.attack=k;n.release=l;n.octave=void 0===p?0:p;n.detune=void 0===q?0:q;n.func=function(b,c,d,e,f,g,h,l,m,k){return new function(){this.generator=b.createOscillator();"custom"==e?this.generator.setPeriodicWave(b.createPeriodicWave(new Float32Array(f.cos),
new Float32Array(f.sin))):this.generator.type=e;this.generator.frequency.setTargetAtTime(system.audio.num2freq(d+12*k),b.currentTime,0);this.generator.detune.setTargetAtTime(m,b.currentTime,0);this.generator.start(0);this.gain=b.createGain();this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,b.currentTime,0);system.utility.audio.changeAudioParam(b,this.gain.gain,g,h.time,h.curve,!1);this.gain.connect(c);this.detune=function(c,d,e){system.utility.audio.changeAudioParam(b,this.generator.detune,
c,d,e)};this.changeVelocity=function(c){system.utility.audio.changeAudioParam(b,this.gain.gain,c,h.time,h.curve)};this.stop=function(){system.utility.audio.changeAudioParam(b,this.gain.gain,0,l.time,l.curve,!1);setTimeout(function(b){b.gain.disconnect();b.generator.stop();b.generator.disconnect();b.gain=null;b.generator=null},1E3*l.time,this)}}};y.depth=void 0===r?0:r;y.period=void 0===u?0:u;y.phase=!0;y.wave="s";y.interval=null;y.start=function(){y.period<t||y.period>=v||(y.interval=setInterval(function(){var b=
Object.keys(x);if(y.phase)for(var c=0;c<b.length;c++)x[b[c]].detune(y.depth,.9*y.period,y.wave);else for(c=0;c<b.length;c++)x[b[c]].detune(-y.depth,.9*y.period,y.wave);y.phase=!y.phase},1E3*y.period))};y.stop=function(){clearInterval(y.interval)};var E=b.createGain();E.gain.setTargetAtTime(1,b.currentTime,0);w.depth=f;w.period=h;w.phase=!0;w.wave="s";w.interval=null;w.start=function(){w.period<g||w.period>=m?system.utility.audio.changeAudioParam(b,w.node.gain,1,.01,w.wave):w.interval=setInterval(function(){w.phase?
system.utility.audio.changeAudioParam(b,w.node.gain,1,.9*w.period,w.wave):system.utility.audio.changeAudioParam(b,w.node.gain,1-w.depth,.9*w.period,w.wave);w.phase=!w.phase},1E3*w.period)};w.stop=function(){clearInterval(w.interval)};w.node=b.createGain();w.node.gain.setTargetAtTime(1,b.currentTime,0);E.connect(w.node);var A=b.createGain();A.gain.setTargetAtTime(d,b.currentTime,0);w.node.connect(A);this.out=function(){return A};this.perform=function(c){if(x[c.num]||0!=c.velocity)x[c.num]?0==c.velocity?
(x[c.num].stop(),delete x[c.num]):x[c.num].changeVelocity(c.velocity):x[c.num]=n.func(b,E,c.num,n.waveType,n.periodicWave,c.velocity,n.attack,n.release,n.detune,n.octave)};this.panic=function(){for(var b=Object.keys(x),c=0;c<b.length;c++)this.perform({num:b[c],velocity:0})};this.waveType=function(b){if(null==b)return n.waveType;n.waveType=b};this.periodicWave=function(b){if(null==b)return n.periodicWave;n.periodicWave=b};this.gain=function(c,d,e){return system.utility.audio.changeAudioParam(b,A.gain,
c,d,e)};this.attack=function(b,c){if(null==b&&null==c)return n.attack;n.attack.time=b?b:n.attack.time;n.attack.curve=c?c:n.attack.curve};this.release=function(b,c){if(null==b&&null==c)return n.release;n.release.time=b?b:n.release.time;n.release.curve=c?c:n.release.curve};this.octave=function(b){if(null==b)return n.octave;n.octave=b};this.detune=function(b,c,d){if(null==b)return n.detune;var e=n.detune,f=b-e,g=Math.round(Math.abs(f)),h=g*c,l=[1];switch(d){case "linear":l=system.utility.math.curveGenerator.linear(h);
break;case "exponential":l=system.utility.math.curveGenerator.exponential(h);break;case "s":l=system.utility.math.curveGenerator.s(h,8)}if(0!=l.length)var m=setInterval(function(){n.detune=e+l.shift()*f;0==l.length&&clearInterval(m)},1E3/g);g=Object.keys(x);for(h=0;h<g.length;h++)x[g[h]].detune(b,c,d)};this.gainWobbleDepth=function(b){if(null==b)return w.depth;w.depth=b;w.stop();w.start()};this.gainWobblePeriod=function(b){if(null==b)return w.period;w.period=b;w.stop();w.start()};this.detuneWobbleDepth=
function(b){if(null==b)return y.depth;y.depth=b;y.stop();y.start()};this.detuneWobblePeriod=function(b){if(null==b)return y.period;y.period=b;y.stop();y.start()}};this.looper=function(b){var e=this,c=!1,d=1,f=!0,h=0,g=1,m={},k=null,l={};l=b.createChannelSplitter(2);var p=b.createGain();p.gain.setTargetAtTime(1,b.currentTime,0);l.connect(p,0);var q=b.createGain();q.gain.setTargetAtTime(1,b.currentTime,0);l.connect(q,1);this.out_left=function(){return p};this.out_right=function(){return q};this.load=
function(b,d,f){c=!1;system.utility.audio.loadAudioFile(function(b){e.stop();m=b;c=!0;d(b)},b,void 0===f?"":f)};this.start=function(){c&&(k&&(k.onended=function(){},k.stop(0)),k=system.utility.audio.loadBuffer(b,m.buffer,l),k.playbackRate.value=d,k.loop=f,k.loopStart=h*this.duration(),k.loopEnd=g*this.duration(),k.start(0,0),k.onended=function(){k=null})};this.stop=function(){c&&k&&(k.stop(0),k=void 0)};this.rate=function(){d=value};this.duration=function(){return c?m.duration:-1};this.title=function(){return c?
m.name:""};this.waveformSegment=function(b){b=void 0===b?{start:0,end:1}:b;return void 0!=b&&c?system.utility.audio.waveformSegment(m.buffer,b):[]};this.loop=function(b){if(void 0==data)return data;f=void 0===b?!1:b};this.loopBounds=function(b){b=void 0===b?{start:0,end:1}:b;if(void 0==b)return b;h=void 0!=b.start?b.start:h;g=void 0!=b.end?b.end:g}};this.oneShot_single=function(b){var e=this,c=!1,d=1,f={},h=null,g={};g=b.createChannelSplitter(2);var m=b.createGain();m.gain.setTargetAtTime(1,b.currentTime,
0);g.connect(m,0);var k=b.createGain();k.gain.setTargetAtTime(1,b.currentTime,0);g.connect(k,1);this.out_left=function(){return m};this.out_right=function(){return k};this.load=function(b,d,g){c=!1;system.utility.audio.loadAudioFile(function(b){e.stop();f=b;c=!0;d(b)},b,void 0===g?"":g)};this.fire=function(){c&&(h&&(h.onended=function(){},h.stop(0)),h=system.utility.audio.loadBuffer(b,f.buffer,g),h.playbackRate.value=d,h.start(0,0),h.onended=function(){h=null})};this.stop=function(){c&&(h.stop(0),
h=void 0)};this.rate=function(){d=value};this.duration=function(){return c?f.duration:-1};this.title=function(){return c?f.name:""};this.waveformSegment=function(b){b=void 0===b?{start:0,end:1}:b;return void 0!=b&&c?system.utility.audio.waveformSegment(f.buffer,b):[]}};this.oneShot_multi=function(b){var e=this,c=!1,d=1,f={},h=[],g={};g=b.createChannelSplitter(2);var m=b.createGain();m.gain.setTargetAtTime(1,b.currentTime,0);g.connect(m,0);var k=b.createGain();k.gain.setTargetAtTime(1,b.currentTime,
0);g.connect(k,1);this.audioOut=function(b){switch(b){case "r":return k;case "l":return m;default:console.error('"part.circuit.audio.oneShot_multi2.audioOut" unknown channel "'+b+'"')}};this.out_left=function(){return this.audioOut("l")};this.out_right=function(){return this.audioOut("r")};this.loadRaw=function(b){0!==Object.keys(b).length&&(f=b,c=!0)};this.load=function(b,d,f){c=!1;system.utility.audio.loadAudioFile(function(b){e.loadRaw(b);void 0!=d&&d(b)},b,f)};this.unloadRaw=function(){return f};
this.fire=function(e,m){e=void 0===e?0:e;if(c){var l=system.utility.audio.loadBuffer(b,f.buffer,g,function(){h.splice(h.indexOf(this),1)});l.playbackRate.value=d;l.start(0,e*d,m*d);h.push(l)}};this.panic=function(){for(;0<h.length;)h.shift().stop(0)};this.rate=function(b){if(void 0==b)return d;0==b&&(b=1E-6);d=b};this.duration=function(){return c?f.duration/d:-1};this.title=function(){return c?f.name:""};this.waveformSegment=function(b){b=void 0===b?{start:0,end:1}:b;return void 0!=b&&c?system.utility.audio.waveformSegment(f.buffer,
b):[]}};this.audio2percentage=function(){return new function(){var b=null,e=null;var c=system.audio.context.createAnalyser();c.fftSize=128;b=new Uint8Array(c.fftSize);new Uint8Array(c.fftSize);this.__render=function(){c.getByteTimeDomainData(b);for(var d=[],e=0;e<b.length;e++)d.push(b[e]/128-1);var h=0;d.forEach(function(b){Math.abs(b)>h&&(h=Math.abs(b))});this.newValue(h)};this.audioIn=function(){return c};this.start=function(){e=setInterval(function(b){b.__render()},1E3/30,this)};this.stop=function(){clearInterval(e)};
this.newValue=function(b){}}};this.reverbUnit=function(b){function e(c,e,g){var f=new XMLHttpRequest;f.open("GET",c+e,!0);f.responseType="arraybuffer";f.onload=function(){d.reverbNode.node.disconnect();d.reverbNode.node=b.createConvolver();d.reverbGain.node.connect(d.reverbNode.node);d.reverbNode.node.connect(d.outAggregator.node);b.decodeAudioData(f.response,function(b){d.reverbNode.node.buffer=b},function(b){console.warn("Error with decoding audio data"+b.err)});g&&g()};f.send()}function c(b,c){c=
void 0===c?null:c;var d=new XMLHttpRequest;d.open("GET",b+"available2.list",!0);d.onload=function(){var b=d.response.split("\n");b[b.length-1]=b[b.length-1].split("");b[b.length-1].pop();b[b.length-1]=b[b.length-1].join("");b.splice(-1,1);null==c?console.log(b):c(b)};d.send()}var d={inAggregator:{},reverbGain:{},bypassGain:{},reverbNode:{},outAggregator:{}};d.inAggregator.gain=1;d.inAggregator.node=b.createGain();system.utility.audio.changeAudioParam(b,d.inAggregator.node.gain,d.inAggregator.gain,
.01,"instant",!0);d.reverbGain.gain=.5;d.bypassGain.gain=.5;d.reverbGain.node=b.createGain();d.bypassGain.node=b.createGain();system.utility.audio.changeAudioParam(b,d.reverbGain.node.gain,d.reverbGain.gain,.01,"instant",!0);system.utility.audio.changeAudioParam(b,d.bypassGain.node.gain,d.bypassGain.gain,.01,"instant",!0);d.reverbNode.impulseResponseRepoURL="https://metasophiea.com/lib/audio/impulseResponse/";d.reverbNode.selectedReverbType="Musikvereinsaal.wav";d.reverbNode.node=b.createConvolver();
d.outAggregator.gain=1;d.outAggregator.node=b.createGain();system.utility.audio.changeAudioParam(b,d.outAggregator.node.gain,d.outAggregator.gain,.01,"instant",!0);d.inAggregator.node.connect(d.reverbGain.node);d.inAggregator.node.connect(d.bypassGain.node);d.reverbGain.node.connect(d.reverbNode.node);d.bypassGain.node.connect(d.outAggregator.node);d.reverbNode.node.connect(d.outAggregator.node);this.in=function(){return d.inAggregator.node};this.out=function(){return d.outAggregator.node};this.getTypes=
function(b){c(d.reverbNode.impulseResponseRepoURL,b)};this.type=function(b,c){if(null==b)return d.reverbNode.selectedReverbType;d.reverbNode.selectedReverbType=b;e(d.reverbNode.impulseResponseRepoURL,d.reverbNode.selectedReverbType,c)};this.outGain=function(c){if(null==c)return d.outAggregator.gain;d.outAggregator.gain=c;system.utility.audio.changeAudioParam(b,d.outAggregator.node.gain,c,.01,"instant",!0)};this.wetdry=function(c){if(null==c)return d.reverbGain.gain;d.reverbGain.gain=c;d.bypassGain.gain=
1-c;system.utility.audio.changeAudioParam(b,d.reverbGain.node.gain,d.reverbGain.gain,.01,"instant",!0);system.utility.audio.changeAudioParam(b,d.bypassGain.node.gain,d.bypassGain.gain,.01,"instant",!0)};e(d.reverbNode.impulseResponseRepoURL,d.reverbNode.selectedReverbType)};this.multibandFilter=function(b,e,c){function d(c){var d={frequency:110,Q:.1,node:b.createBiquadFilter()};d.node.type=c;system.utility.audio.changeAudioParam(b,d.node.frequency,110,.01,"instant",!0);system.utility.audio.changeAudioParam(b,
d.node.Q,.1,.01,"instant",!0);return d}c=void 0===c?!1:c;var f=[],h=[],g=[],m=[];var k=b.createGain();system.utility.audio.changeAudioParam(b,k.gain,1,.01,"instant",!0);if(c){2>e&&(e=2);g.push(d("lowpass"));for(c=1;c<e-1;c++)g.push(d("bandpass"));g.push(d("highpass"))}else for(c=0;c<e;c++)g.push(d("bandpass"));for(c=0;c<e;c++){var l={gain:1,node:b.createGain()};system.utility.audio.changeAudioParam(b,l.node.gain,l.gain,.01,"instant",!0);m.push(l);f[c]={Q:.1,gain:1,frequency:110,fresh:!0}}var p=1;
var q=b.createGain();system.utility.audio.changeAudioParam(b,q.gain,p,.01,"instant",!0);for(c=0;c<e;c++)k.connect(g[c].node),g[c].node.connect(m[c].node),m[c].node.connect(q);this.in=function(){return k};this.out=function(){return q};this.masterGain=function(c){if(void 0==c)return p;p=c;system.utility.audio.changeAudioParam(b,q.gain,p,.01,"instant",!0)};this.gain=function(c,d){if(void 0==d)return m[c].gain;m[c].gain=d;system.utility.audio.changeAudioParam(b,m[c].node.gain,m[c].gain,.01,"instant",
!0);f[c].gain=d;f[c].fresh=!0};this.frequency=function(c,d){if(void 0==d)return g[c].frequency;g[c].frequency=d;system.utility.audio.changeAudioParam(b,g[c].node.frequency,g[c].frequency,.01,"instant",!0);f[c].frequency=d;f[c].fresh=!0};this.Q=function(c,d){if(void 0==d)return g[c].Q;g[c].Q=d;system.utility.audio.changeAudioParam(b,g[c].node.Q,g[c].Q,.01,"instant",!0);f[c].Q=d;f[c].fresh=!0};this.measureFrequencyResponse=function(b,c){var d=this;if(void 0==b)return Array(e).fill(0).map(function(b,
e){return d.measureFrequencyResponse(e,c)});if(!f[b].fresh)return[h[b].magResponse.map(function(b){return b*p}),h[b].requencyArray];var l=new Float32Array(c),k=new Float32Array(l.length),q=new Float32Array(l.length);g[b].node.getFrequencyResponse(l,k,q);h[b]={magResponse:k.map(function(c){return c*m[b].gain}),phaseResponse:q,frequencyArray:c};f[b].fresh=!1;return[k.map(function(c){return c*m[b].gain*p}),c]}};this.distortionUnit=function(b){function e(){c.inAggregator.node.disconnect();c.distortionNode.node&&
c.distortionNode.node.disconnect();c.distortionNode.node=b.createWaveShaper();c.distortionNode.curve=new Float32Array(system.utility.math.curveGenerator.s(c.distortionNode.resolution,-1,1,c.distortionNode.distortionAmount));c.distortionNode.node.curve=c.distortionNode.curve;c.distortionNode.node.oversample=c.distortionNode.oversample;c.inAggregator.node.connect(c.distortionNode.node);c.distortionNode.node.connect(c.outAggregator.node)}var c={inAggregator:{},distortionNode:{},outAggregator:{}};c.inAggregator.gain=
0;c.inAggregator.node=b.createGain();system.utility.audio.changeAudioParam(b,c.inAggregator.node.gain,c.inAggregator.gain,.01,"instant",!0);c.distortionNode.distortionAmount=0;c.distortionNode.oversample="none";c.distortionNode.resolution=100;c.outAggregator.gain=0;c.outAggregator.node=b.createGain();system.utility.audio.changeAudioParam(b,c.outAggregator.node.gain,c.outAggregator.gain,.01,"instant",!0);this.in=function(){return c.inAggregator.node};this.out=function(){return c.outAggregator.node};
this.inGain=function(d){if(null==d)return c.inAggregator.gain;c.inAggregator.gain=d;system.utility.audio.changeAudioParam(b,c.inAggregator.node.gain,d,.01,"instant",!0)};this.outGain=function(d){if(null==d)return c.outAggregator.gain;c.outAggregator.gain=d;system.utility.audio.changeAudioParam(b,c.outAggregator.node.gain,d,.01,"instant",!0)};this.distortionAmount=function(b){if(null==b)return c.distortionNode.distortionAmount;c.distortionNode.distortionAmount=b;e()};this.oversample=function(b){if(null==
b)return c.distortionNode.oversample;c.distortionNode.oversample=b;e()};this.resolution=function(b){if(null==b)return c.distortionNode.resolution;c.distortionNode.resolution=2<=b?b:2;e()};e()};this.synthesizer_1=function(b,e,c,d,f,h,g,m){function k(b,c,d,e,f,g,h,k,m,p){return new function(){this.generator=b.createOscillator();"custom"==e?this.generator.setPeriodicWave(b.createPeriodicWave(new Float32Array(f.cos),new Float32Array(f.sin))):this.generator.type=e;this.generator.frequency.setTargetAtTime(system.audio.num2freq(d,
p),b.currentTime,0);this.generator.detune.setTargetAtTime(m,b.currentTime,0);this.generator.start(0);this.gain=b.createGain();this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,b.currentTime,0);l(this.gain.gain,g,h.time,h.curve,!1);this.gain.connect(c);this.detune=function(b,c,d){l(this.generator.detune,b,c,d)};this.changeVelocity=function(b){l(this.gain.gain,b,h.time,h.curve)};this.stop=function(){l(this.gain.gain,0,k.time,k.curve,!1);setTimeout(function(b){b.gain.disconnect();b.generator.stop();
b.generator.disconnect();b.gain=null;b.generator=null},1E3*k.time,this)}}}function l(c,d,e,f,g){if(null==d)return c.value;(void 0===g||g)&&c.cancelScheduledValues(b.currentTime);switch(f){case "linear":c.linearRampToValueAtTime(d,b.currentTime+e);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");0==d&&(d=1E-4);c.exponentialRampToValueAtTime(d,b.currentTime+e);break;case "s":d-=c.value;f=system.utility.math.curveGenerator.s(10);for(g=0;g<f.length;g++)f[g]=
c.value+f[g]*d;c.setValueCurveAtTime(new Float32Array(f),b.currentTime,e);break;default:c.setTargetAtTime(d,b.currentTime,.001)}}e=void 0===e?"sine":e;c=void 0===c?{sin:[0,1],cos:[0,0]}:c;d=void 0===d?1:d;f=void 0===f?{time:.01,curve:"linear"}:f;h=void 0===h?{time:.05,curve:"linear"}:h;g=void 0===g?0:g;m=void 0===m?0:m;var p=b.createGain();p.gain.setTargetAtTime(d,b.currentTime,0);var q={};this.waveType=function(b){if(null==b)return e;e=b};this.periodicWave=function(b){if(null==b)return c;c=b};this.gain=
function(b,c,d){return l(p.gain,b,c,d)};this.attack=function(b,c){if(null==b&&null==c)return f;f.time=b?b:f.time;f.curve=c?c:f.curve};this.release=function(b,c){if(null==b&&null==c)return h;h.time=b?b:h.time;h.curve=c?c:h.curve};this.octave=function(b){if(null==b)return m;m=b};this.detune=function(b,c,d){if(null==a)return g;var e=g,f=b-e,h=Math.round(Math.abs(f)),l=h*c,k=[1];switch(d){case "linear":k=system.utility.math.curveGenerator.linear(l);break;case "exponential":k=system.utility.math.curveGenerator.exponential(l);
break;case "s":k=system.utility.math.curveGenerator.s(l,8)}if(0!=k.length)var m=setInterval(function(){g=e+k.shift()*f;0==k.length&&clearInterval(m)},1E3/h);h=Object.keys(q);for(l=0;l<h.length;l++)q[h[l]].detune(b,c,d)};this.out=function(){return p};this.perform=function(d){if(q[d.num]||0!=d.velocity)q[d.num]?0==d.velocity?(q[d.num].stop(),delete q[d.num]):q[d.num].changeVelocity(d.velocity):q[d.num]=k(b,p,d.num,e,c,d.velocity,f,h,g,m)};this.panic=function(){for(var b=Object.keys(q),c=0;c<b.length;c++)this.perform({num:b[c],
velocity:0})}};this.player=function(b){function e(){clearInterval(d.loop.timeout);d.playhead.position=d.itself.currentTime();d.playhead.lastSightingTime=b.currentTime;if(d.loop.active&&d.playing){var c=d.loop.end-d.itself.currentTime();0>c&&(c=0);d.loop.timeout=setTimeout(function(){d.itself.jumpTo(d.loop.start,!1);e()},1E3*c/d.rate)}}function c(c){d.fileLoaded&&(d.playing?(d.loop.active&&c>d.loop.end&&(c=d.loop.start),d.itself.stop(function(){d.playhead.position=c;d.playhead.lastSightingTime=b.currentTime;
d.itself.start()})):(d.playhead.position=c,d.playhead.lastSightingTime=b.currentTime))}var d={itself:this,fileLoaded:!1,playing:!1,playhead:{position:0,lastSightingTime:0},loop:{active:!1,start:0,end:1,timeout:null},rate:1},f={},h=null,g={};g=b.createChannelSplitter(2);var m=b.createGain();m.gain.setTargetAtTime(1,b.currentTime,0);g.connect(m,0);var k=b.createGain();k.gain.setTargetAtTime(1,b.currentTime,0);g.connect(k,1);this.out_left=function(){return m};this.out_right=function(){return k};this.load=
function(b,c,e){d.fileLoaded=!1;system.utility.audio.loadAudioFile(function(b){d.itself.stop();f=b;d.fileLoaded=!0;d.playhead.position=0;c(b)},b,void 0===e?"":e)};this.start=function(){!d.playing&&d.fileLoaded&&(h=system.utility.audio.loadBuffer(b,f.buffer,g,function(b){d.itself.stop()}),h.loop=d.loop.active,h.loopStart=d.loop.start,h.loopEnd=d.loop.end,h.playbackRate.value=d.rate,h.start(0,d.playhead.position),d.playhead.lastSightingTime=b.currentTime,d.playing=!0,e())};this.stop=function(b){d.playing&&
(b&&(h.onended=function(){b()}),h.stop(0),h=void 0,e(),d.playing=!1)};this.jumpTo=function(b,d){b=void 0===b?0:b;void 0===d||d?(b=1<b?1:b,b=0>b?0:b,c(this.duration()*b)):c(b);e()};this.loop=function(b,c){b=void 0===b?{active:!1,start:0,end:1}:b;c=void 0===c?!0:c;if(void 0==b)return d.loop;void 0!=b.active&&(d.loop.active=b.active,h&&(h.loop=b.active));if(void 0!=b.start||void 0!=b.end)c=c?this.duration():1,d.loop.start=void 0!=b.start?b.start*c:d.loop.start,d.loop.end=void 0!=b.end?b.end*c:d.loop.end,
h&&(h.loopStart=d.loop.start,h.loopEnd=d.loop.end);e()};this.rate=function(b){b=void 0===b?1:b;d.rate=b;h&&(h.playbackRate.value=b);e()};this.isLoaded=function(){return d.fileLoaded};this.duration=function(){return d.fileLoaded?f.duration:-1};this.title=function(){return d.fileLoaded?f.name:""};this.currentTime=function(){return d.fileLoaded?d.playing?d.playhead.position+d.rate*(b.currentTime-d.playhead.lastSightingTime):d.playhead.position:-1};this.progress=function(){return this.currentTime()/this.duration()};
this.waveformSegment=function(b){b=void 0===b?{start:0,end:1}:b;return void 0!=b&&d.fileLoaded?system.utility.audio.waveformSegment(f.buffer,b):[]}};this.channelMultiplier=function(b,e){e=void 0===e?2:e;var c=[];var d=1;var f=b.createGain();system.utility.audio.changeAudioParam(b,f.gain,d,.01,"instant",!0);for(var h=0;h<e;h++){var g={gain:.5,node:b.createGain()};system.utility.audio.changeAudioParam(b,g.node.gain,g.gain,.01,"instant",!0);c.push(g);f.connect(g.node)}this.in=function(){return f};this.out=
function(b){return c[b].node};this.inGain=function(c){if(void 0==c)return d;d=c;system.utility.audio.changeAudioParam(b,f.gain,d,.01,"instant",!0)};this.outGain=function(d,e){if(void 0==e)return c[d].gain;c[d].gain=e;system.utility.audio.changeAudioParam(b,c[d].node.gain,c[d].gain,.01,"instant",!0)}};this.filterUnit=function(b){var e=b.createGain();system.utility.audio.changeAudioParam(b,e.gain,1,.01,"instant",!0);var c=b.createBiquadFilter();c.type="lowpass";system.utility.audio.changeAudioParam(b,
c.frequency,110,.01,"instant",!0);system.utility.audio.changeAudioParam(b,c.gain,1,.01,"instant",!0);system.utility.audio.changeAudioParam(b,c.Q,.1,.01,"instant",!0);var d=b.createGain();system.utility.audio.changeAudioParam(b,d.gain,1,.01,"instant",!0);e.connect(c);c.connect(d);this.in=function(){return e};this.out=function(){return d};this.type=function(b){c.type=b};this.frequency=function(d){system.utility.audio.changeAudioParam(b,c.frequency,d,.01,"instant",!0)};this.gain=function(d){system.utility.audio.changeAudioParam(b,
c.gain,d,.01,"instant",!0)};this.Q=function(d){system.utility.audio.changeAudioParam(b,c.Q,d,.01,"instant",!0)};this.measureFrequencyResponse=function(b,c,d){for(var e=[];b<c;b+=d)e.push(b);return this.measureFrequencyResponse_values(e)};this.measureFrequencyResponse_values=function(b){var d=new Float32Array(b),e=new Float32Array(d.length),f=new Float32Array(d.length);c.getFrequencyResponse(d,e,f);return[e,b]}}};this.sequencing=new function(){this.noteRegistry=function(b,e,c){b=void 0===b?-1:b;e=
void 0===e?-1:e;c=void 0===c?-1:c;var d=[],f=[],h=[],g=[],m={},k=[];this.__dump=function(){console.log("---- noteRegistry dump ----");console.log("\tnotes");for(var b=0;b<d.length;b++)console.log("\t\t",b," "+JSON.stringify(d[b]));console.log("\tselectedNotes");for(b=0;b<f.length;b++)console.log("\t\t",b," "+JSON.stringify(f[b]));console.log("\tevents");for(b=0;b<h.length;b++)console.log("\t\t",b," "+JSON.stringify(h[b]));console.log("\tevents_byID");for(b=0;b<g.length;b++)console.log("\t\t",b," "+
JSON.stringify(g[b]));console.log("\tevents_byPosition");var c=Object.keys(m);for(b=0;b<c.length;b++)console.log("\t\t",c[b]," "+JSON.stringify(m[c[b]]));console.log("\tpositions");for(b=0;b<k.length;b++)console.log("\t\t",b," "+JSON.stringify(k[b]))};this.export=function(){return JSON.parse(JSON.stringify({notes:d,selectedNotes:f,events:h,events_byID:g,events_byPosition:m,positions:k}))};this.import=function(b){d=JSON.parse(JSON.stringify(b.notes));f=JSON.parse(JSON.stringify(b.selectedNotes));h=
JSON.parse(JSON.stringify(b.events));g=JSON.parse(JSON.stringify(b.events_byID));m=JSON.parse(JSON.stringify(b.events_byPosition));k=JSON.parse(JSON.stringify(b.positions))};this.getAllNotes=function(){return JSON.parse(JSON.stringify(d))};this.getAllEvents=function(){return JSON.parse(JSON.stringify(h))};this.getNote=function(b){if(void 0!=d[b])return JSON.parse(JSON.stringify(d[b]))};this.eventsBetween=function(b,c){for(var d=void 0==c?Array.from(new Set(k.filter(function(c){return c==b}))):Array.from(new Set(k.filter(function(d){return d>=
b&&d<c}))),e=[],f=0;f<d.length;f++){d[f]=m[String(d[f])];for(var g=0;g<d[f].length;g++)e.push(h[d[f][g]])}return e.sort(function(b,c){return b.position<c.position?-1:b.position>c.position?1:0})};this.add=function(f,p){if(void 0!=f&&"line"in f&&"position"in f&&"length"in f){"strength"in f||(f.strength=1);0>f.line&&(f.line=0);0>f.length&&(f.length=0);0>f.position&&(f.position=0);0>f.strength&&(f.strength=0);-1<e&&f.line>e-1&&(f.line=e-1);-1<c&&f.length>c&&(f.length=c);-1<b&&f.position>b&&(f.position=
b-f.length);-1<b&&f.position+f.length>b&&(f.length=b-f.position);-1<b&&f.position+f.length>b&&(f.position=b-f.length);1<f.strength&&(f.strength=1);var l=0;if(void 0==p)for(;void 0!=d[l];)l++;else l=p;d[l]=JSON.parse(JSON.stringify(f));f=[{noteID:l,line:f.line,position:f.position,strength:f.strength},{noteID:l,line:f.line,position:f.position+f.length,strength:0}];for(p=0;void 0!=h[p];)p++;h[p]=f[0];g[l]=[p];void 0==m[f[0].position]?m[f[0].position]=[p]:m[f[0].position].push(p);for(k.push(f[0].position);void 0!=
h[p];)p++;h[p]=f[1];g[l]=g[l].concat(p);void 0==m[f[1].position]?m[f[1].position]=[p]:m[f[1].position].push(p);k.push(f[1].position);return l}};this.remove=function(b){if(void 0!=d[b]){delete d[b];for(var c=0;c<g[b].length;c++){var e=g[b][c];m[h[e].position].splice(m[h[e].position].indexOf(e),1);k.splice(k.indexOf(h[e].position),1);0==m[h[e].position].length&&delete m[h[e].position];delete h[e]}delete g[b]}};this.update=function(c,e){void 0!=e&&("line"in e||(e.line=d[c].line),-1<b&&("position"in e&&
"length"in e?e.length+e.position>b&&(e.length=b-e.position):("position"in e?d[c].length+e.position>=b&&(e.position=b-d[c].length):e.position=d[c].position,"length"in e?e.length+e.position>b&&(e.length=b-e.position):e.length=d[c].length)),"strength"in e||(e.strength=d[c].strength),this.remove(c),this.add(e,c))};this.reset=function(){d=[];f=[];h=[];g=[];m={};k=[]}};this.launchpad=function(b,e){var c=[],d=0,f=0,h=b-1;this.square=function(f,h,k){0>f?f=0:f>b-1&&(f=b-1);0>h?h=0:f>e-1&&(f=e-1);if(void 0==
k)return c[d][h][f];c[d][h][f]=k};this.line=function(b,h){if(void 0==h){h=[];for(b=0;b<e;b++)void 0==c[d]||void 0==c[d][b]||void 0==c[d][b][f]?h.push(!1):h.push(c[d][b][f]);return h}for(b=0;b<e;b++)c[d][b][f]=h[b]};this.position=function(c,d){if(void 0==c)return f;h=f;c>b-1?c=0:0>c&&(c=b-1);f=c;(void 0===d||d)&&this.commands(this.line())};this.previousPosition=function(){return h};this.inc=function(){this.position(f+1)};this.dec=function(){this.position(f-1)};this.page=function(b){if(void 0==b)return d;
-1==b?b=9:0>b?b=0:10==b?b=0:10<=b&&(b=9);d=b;void 0!=this.pageChange&&this.pageChange(d)};this.incPage=function(){this.page(d+1)};this.decPage=function(){this.page(d-1)};this.exportPages=function(){return JSON.parse(JSON.stringify(c))};this.importPages=function(b){c=b;this.pageChange(d)};this.exportPage=function(f){void 0==f&&(f=d);return void 0==c[f]?Array(b).fill(Array(e).fill(!1)):JSON.parse(JSON.stringify(c[f]))};this.importPage=function(b,e){void 0==e&&(e=d);c[e]=b;void 0!=this.pageChange&&this.pageChange(d)};
this.commands=function(){};this.pageChange=function(){}}}};this.element=new function(){this.basic=new function(){this.line=function(b,e,c,d,f,h){b=void 0===b?null:b;e=void 0===e?0:e;c=void 0===c?0:c;d=void 0===d?10:d;f=void 0===f?10:f;h=void 0===h?"stroke:rgb(255,0,0); stroke-width:1":h;var g=document.createElementNS("http://www.w3.org/2000/svg","line");g.id=b;g.setAttribute("x1",e);g.setAttribute("y1",c);g.setAttribute("x2",d);g.setAttribute("y2",f);g.setAttribute("style",h);return g};this.circle=
function(b,e,c,d,f,h){b=void 0===b?null:b;e=void 0===e?0:e;c=void 0===c?0:c;d=void 0===d?0:d;f=void 0===f?0:f;h=void 0===h?"fill:rgba(255,100,255,0.75)":h;var g=document.createElementNS("http://www.w3.org/2000/svg","circle");g.id=b;g.setAttribute("r",d);g.style="transform: translate("+e+"px,"+c+"px) scale(1) rotate("+f+"rad);"+h;return g};this.rect=function(b,e,c,d,f,h,g){b=void 0===b?null:b;e=void 0===e?0:e;c=void 0===c?0:c;d=void 0===d?0:d;f=void 0===f?0:f;h=void 0===h?0:h;g=void 0===g?"fill:rgba(255,100,255,0.75)":
g;var m=document.createElementNS("http://www.w3.org/2000/svg","rect");m.id=b;m.style="transform: translate("+e+"px,"+c+"px) scale(1) rotate("+h+"rad);"+g;m.setAttribute("height",f);m.setAttribute("width",d);m.rotation=function(b){if(null==b)return system.utility.element.getTransform(this).r;system.utility.element.setRotation(this,b)};return m};this.canvas=function(b,e,c,d,f,h,g){b=void 0===b?null:b;e=void 0===e?0:e;c=void 0===c?0:c;d=void 0===d?0:d;f=void 0===f?0:f;h=void 0===h?0:h;g=void 0===g?1:
g;var m=document.createElement("canvas");m.setAttribute("height",g*f);m.setAttribute("width",g*d);var k=document.createElementNS("http://www.w3.org/2000/svg","image");k.id=b;k.style="transform: translate("+e+"px,"+c+"px) scale("+1/g+") rotate("+h+"rad)";k.setAttribute("height",f*g);k.setAttribute("width",d*g);return{element:k,canvas:m,context:m.getContext("2d"),c:function(b){return b*g},print:function(){this.element.setAttribute("href",this.canvas.toDataURL())}}};this.image=function(b,e,c,d,f,h,g){b=
void 0===b?null:b;c=void 0===c?0:c;d=void 0===d?0:d;f=void 0===f?0:f;h=void 0===h?0:h;g=void 0===g?0:g;var m=document.createElementNS("http://www.w3.org/2000/svg","image");m.id=b;m.style="transform: translate("+c+"px,"+d+"px) scale(1) rotate("+g+"rad)";m.setAttribute("height",h);m.setAttribute("width",f);m.setAttribute("href",e);return m};this.path=function(b,e,c,d){b=void 0===b?null:b;e=void 0===e?[]:e;c=void 0===c?"L":c;d=void 0===d?"fill:rgba(0,0,0,0);":d;var f=document.createElementNS("http://www.w3.org/2000/svg",
"path");f.id=b;f.style="transform: translate(0px,0px) scale(1) rotate(0rad);"+d;f._installPath=function(b){for(var d="M "+b[0].x+" "+b[0].y+" "+c,e=1;e<b.length;e++)d+=" "+b[e].x+" "+b[e].y;this.setAttribute("d",d)};f._path=e;f._installPath(e);f.path=function(b){if(null==b)return this._path;this._path=b;this._installPath(b)};return f};this.g=function(b,e,c,d,f){b=void 0===b?null:b;e=void 0===e?0:e;c=void 0===c?0:c;d=void 0===d?0:d;f=void 0===f?"":f;var h=document.createElementNS("http://www.w3.org/2000/svg",
"g");h.id=b;h.style=f+"transform: translate("+e+"px,"+c+"px) scale(1) rotate("+d+"rad);";return h};this.text=function(b,e,c,d,f,h,g){b=void 0===b?null:b;e=void 0===e?0:e;c=void 0===c?0:c;d=void 0===d?"":d;f=void 0===f?0:f;h=void 0===h?"fill:rgba(0,0,0,1); font-size:3; font-family:Helvetica;":h;g=void 0===g?1:g;var m=document.createElementNS("http://www.w3.org/2000/svg","text");m.id=b;m.style="transform: translate("+e+"px,"+c+"px) scale("+g+") rotate("+f+"rad);"+h;m.innerHTML=d;return m}};this.display=
new function(){this.grapherSVG=function(b,e,c,d,f,h,g,m,k,l){h=void 0===h?["stroke:rgba(0,255,0,1); stroke-width:0.75; stroke-linecap:round;","stroke:rgba(255,255,0,1); stroke-width:0.75; stroke-linecap:round;"]:h;m=void 0===m?"stroke:rgba(0,100,0,1); stroke-width:1;":m;k=void 0===k?"fill:rgba(0,150,0,1); font-size:5; font-family:Helvetica;":k;l=void 0===l?"fill:rgba(50,50,50,1)":l;var p={bottom:-1,top:1,left:0,right:1},q={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.995,
y:.06},printText:!1},r={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.0025,y:.04},printText:!1},u=2,t=2,v=part.builder("g",void 0===b?"grapherSVG":b,{x:e,y:c});b=part.builder("rect","backing",{width:d,height:f,style:l});v.appendChild(b);var n=part.builder("g","backgroundElements",{});v.appendChild(n);var x=[];v._test=function(){this.drawBackground();this.draw([0,-2,1,-1,2],[0,.25,.5,.75,1]);this.draw([0,1],void 0,1)};v.backgroundLineThickness=function(b){if(null==b)return u;
u=b};v.foregroundLineThickness=function(b){if(null==b)return t;t=b};v.viewbox=function(b){if(null==b)return p;void 0!=b.bottom&&(p.bottom=b.bottom);void 0!=b.top&&(p.top=b.top);void 0!=b.left&&(p.left=b.left);void 0!=b.right&&(p.right=b.right)};v.horizontalMarkings=function(b){if(null==b)return q;void 0!=b.points&&(q.points=b.points);void 0!=b.printingValues&&(q.printingValues=b.printingValues);void 0!=b.textPosition&&(q.textPosition=b.textPosition);void 0!=b.printText&&(q.printText=b.printText)};
v.verticalMarkings=function(b){if(null==b)return r;void 0!=b.points&&(r.points=b.points);void 0!=b.printingValues&&(r.printingValues=b.printingValues);void 0!=b.textPosition&&(r.textPosition=b.textPosition);void 0!=b.printText&&(r.printText=b.printText)};v.drawBackground=function(){n.innerHTML="";for(var b=0;b<q.points.length;b++){var c=f-system.utility.math.relativeDistance(f,p.bottom,p.top,q.points[b]);n.append(part.builder("line","horizontalMarkings_line_"+b,{y1:c,x2:d,y2:c,style:m}));q.printText&&
n.append(part.builder("text","horizontalMarkings_text_"+q.points[b],{x:void 0==q.textPosition||void 0==q.textPosition.x?.5:system.utility.math.relativeDistance(d,p.left,p.right,"number"==typeof q.textPosition.x?q.textPosition.x:q.textPosition.x[b]),y:void 0==q.textPosition||void 0==q.textPosition.y?c:f-system.utility.math.relativeDistance(f,p.bottom,p.top,q.points[b]-("number"==typeof q.textPosition.y?q.textPosition.y:q.textPosition.y[b])),text:q.printingValues&&void 0!=q.printingValues[b]?q.printingValues[b]:
q.points[b],style:k}))}for(b=0;b<r.points.length;b++){var e=system.utility.math.relativeDistance(d,p.left,p.right,r.points[b]);n.append(part.builder("line","verticalMarkings_line_"+b,{x1:e,x2:e,y2:f,style:m}));r.printText&&n.append(part.builder("text","verticalMarkings_text_"+r.points[b],{x:void 0==r.textPosition||void 0==r.textPosition.x?.5:system.utility.math.relativeDistance(d,p.left,p.right,r.points[b]-("number"==typeof r.textPosition.x?r.textPosition.x:r.textPosition.x[b])),y:void 0==r.textPosition||
void 0==r.textPosition.y?c:system.utility.math.relativeDistance(f,p.bottom,p.top,"number"==typeof r.textPosition.y?r.textPosition.y:r.textPosition.y[b]),text:r.printingValues&&void 0!=r.printingValues[b]?r.printingValues[b]:r.points[b],style:k}))}};v.draw=function(b,c,e){e=void 0===e?0:e;void 0==x[e]?(x[e]=part.builder("g","foregroundElements_"+e,{}),v.appendChild(x[e])):x[e].innerHTML="";for(var g=0;g<b.length-1;g++){var k=system.utility.math.lineCorrecter({x1:void 0==c?d/(b.length-1)*(g+0):system.utility.math.relativeDistance(d,
p.left,p.right,c[g+0]),x2:void 0==c?d/(b.length-1)*(g+1):system.utility.math.relativeDistance(d,p.left,p.right,c[g+1]),y1:f-system.utility.math.relativeDistance(f,p.bottom,p.top,b[g+0],!0),y2:f-system.utility.math.relativeDistance(f,p.bottom,p.top,b[g+1],!0)},f,d);k&&x[e].append(part.builder("line",null,{x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,style:void 0==h[e]?h[0]:h[e]}))}};return v};this.grapher_audioScope=function(b,e,c,d,f,h,g,m,k,l,p){b=void 0===b?"grapher_audioScope":b;h=void 0===h?"Canvas":h;g=void 0===
g?["stroke:rgba(0,255,0,1); stroke-width:0.5; stroke-linecap:round;"]:g;m=void 0===m?["fill:rgba(0,255,0,1); font-size:3; font-family:Helvetica;"]:m;k=void 0===k?"stroke:rgba(0,100,0,1); stroke-width:0.25;":k;l=void 0===l?"fill:rgba(0,100,0,1); font-size:3; font-family:Helvetica;":l;p=void 0===p?"fill:rgba(50,50,50,1)":p;var q=system.audio.context.createAnalyser(),r=null,u=30,t=null,v=256;q.fftSize=v;r=new Uint8Array(q.fftSize);new Uint8Array(q.fftSize);b=part.builder("g",b,{x:e,y:c});b._data={};
b._data.wave={sin:[],cos:[]};b._data.resolution=500;var n=part.builder("grapher"+h,"graph",{x:0,y:0,width:d,height:f,style:{foreground:g,foregroundText:m,background:k,backgroundText:l,backing:p}});b.append(n);b.start=function(){null==t&&(t=setInterval(function(){var b=[];q.getByteTimeDomainData(r);for(var c=0;c<r.length;c++)b.push(r[c]/128-1);n.draw(b)},1E3/u))};b.stop=function(){clearInterval(t);t=null};b.getNode=function(){return q};b.resolution=function(b){b=void 0===b?null:b;if(null==b)return v;
v=b;this.stop();this.start()};b.refreshRate=function(b){if(null==b)return u;u=b;this.stop();this.start()};n.viewbox({l:-1.1,h:1.1});n.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});n.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});n.drawBackground();return b};this.sevenSegmentDisplay=function(b,e,c,d,f,h,g,m){h=void 0===h?"fill:rgb(0,0,0)":h;g=void 0===g?"fill:rgb(200,200,200)":g;m=void 0===m?"fill:rgb(20,20,20)":m;var k=d/8,l=d/8,p=[{x:1*l+k,y:1*
l+k},{x:.5*l+k,y:.5*l+k},{x:1*l+k,y:0*l+k},{x:0*l+k,y:1*l+k}],q=[{x:d-1*l-k,y:0*l+k},{x:d-.5*l-k,y:.5*l+k},{x:d-1*l-k,y:1*l+k},{x:d-0*l-k,y:1*l+k}],r=[{x:1*l+k,y:.5*f-1*l+.5*k},{x:.5*l+k,y:.5*f-.5*l+.5*k},{x:1*l+k,y:.5*f-0*l+.5*k},{x:0*l+k,y:.5*f-1*l+.5*k},{x:0*l+k,y:.5*f-0*l+.5*k}],u=[{x:d-1*l-k,y:.5*f-0*l+.5*k},{x:d-.5*l-k,y:.5*f-.5*l+.5*k},{x:d-1*l-k,y:.5*f-1*l+.5*k},{x:d-0*l-k,y:.5*f-1*l+.5*k},{x:d-0*l-k,y:.5*f-0*l+.5*k}],t=[{x:1*l+k,y:f-1*l-k},{x:.5*l+k,y:f-.5*l-k},{x:1*l+k,y:f-0*l-k},{x:0*l+
k,y:f-1*l-k}];k=[{x:d-1*l-k,y:f-0*l-k},{x:d-.5*l-k,y:f-.5*l-k},{x:d-1*l-k,y:f-1*l-k},{x:d-0*l-k,y:f-1*l-k}];b=part.builder("g",void 0===b?"sevenSegmentDisplay":b,{x:e,y:c});d=part.builder("rect",null,{width:d,height:f,style:h});b.appendChild(d);var v=[];p=[[p[0],q[2],q[1],q[0],p[2],p[1]],[p[1],p[3],r[3],r[1],r[0],p[0]],[q[1],q[3],u[3],u[1],u[2],q[2]],[r[0],u[2],u[1],u[0],r[2],r[1]],[r[1],r[4],t[3],t[1],t[0],r[2]],[u[1],u[4],k[3],k[1],k[2],u[0]],[t[0],k[2],k[1],k[0],t[2],t[1]]];for(q=0;q<p.length;q++)r=
{segment:part.builder("path","arc",{path:p[q],lineType:"L",style:m}),state:!1},v.push(r),b.append(r.segment);b.set=function(b,c){(v[b].state=c)?system.utility.element.setStyle(v[b].segment,g):system.utility.element.setStyle(v[b].segment,m)};b.get=function(b){return v[b].state};b.clear=function(){for(var b=0;b<v.length;b++)this.set(b,!1)};b.enterCharacter=function(b){switch(b){case "0":b=[1,1,1,0,1,1,1];break;case "1":b=[0,0,1,0,0,1,0];break;case "2":b=[1,0,1,1,1,0,1];break;case "3":b=[1,0,1,1,0,1,
1];break;case "4":b=[0,1,1,1,0,1,0];break;case "5":b=[1,1,0,1,0,1,1];break;case "6":b=[1,1,0,1,1,1,1];break;case "7":b=[1,0,1,0,0,1,0];break;case "8":b=[1,1,1,1,1,1,1];break;case "9":b=[1,1,1,1,0,1,1];break;default:b=[0,0,0,0,0,0,0]}for(var c=0;c<b.length;c++)this.set(c,1==b[c])};b.test=function(){this.clear();this.enterCharacter("9")};return b};this.sixteenSegmentDisplay=function(b,e,c,d,f,h,g,m){h=void 0===h?"fill:rgb(0,0,0)":h;g=void 0===g?"fill:rgb(200,200,200)":g;m=void 0===m?"fill:rgb(20,20,20)":
m;var k=d/8,l=d/8,p=[{x:.5*l+k,y:.5*l+k},{x:1*l+k,y:0*l+k},{x:0*l+k,y:1*l+k},{x:1*l+k,y:1*l+k},{x:1.75*l+k,y:1*l+k},{x:1*l+k,y:1.75*l+k}],q=[{x:d/2,y:.5*l+k},{x:d/2-.5*l,y:1*l+k},{x:d/2+.5*l,y:1*l+k},{x:d/2-.5*l,y:0*l+k},{x:d/2+.5*l,y:0*l+k}],r=[{x:d-.5*l-k,y:.5*l+k},{x:d-1*l-k,y:0*l+k},{x:d-0*l-k,y:1*l+k},{x:d-1*l-k,y:1*l+k},{x:d-1*l-k,y:1.75*l+k},{x:d-1.75*l-k,y:1*l+k}],u=[{x:0*l+k,y:.5*f-.5*l},{x:1*l+k,y:.5*f-.5*l},{x:.5*l+k,y:.5*f-0*l},{x:0*l+k,y:.5*f+.5*l},{x:1*l+k,y:.5*f+.5*l}],t=[{x:d/2,y:f/
2},{x:d/2-.5*l,y:.5*l+f/2},{x:d/2-.25*l,y:1.25*l+f/2},{x:d/2-1*l,y:.5*l+f/2},{x:d/2+.5*l,y:.5*l+f/2},{x:d/2+.5*l,y:1.75*l+f/2},{x:d/2+1*l,y:.5*l+f/2},{x:d/2-.5*l,y:.5*-l+f/2},{x:d/2-.25*l,y:1.25*-l+f/2},{x:d/2-1*l,y:.25*-l+f/2},{x:d/2+.5*l,y:.5*-l+f/2},{x:d/2+.5*l,y:1.75*-l+f/2},{x:d/2+1*l,y:.25*-l+f/2}],v=[{x:d-1*l-k,y:.5*f-.5*l},{x:d-0*l-k,y:.5*f-.5*l},{x:d-.5*l-k,y:.5*f-0*l},{x:d-1*l-k,y:.5*f+.5*l},{x:d-0*l-k,y:.5*f+.5*l}],n=[{x:.5*l+k,y:f-.5*l-k},{x:0*l+k,y:f-1*l-k},{x:1*l+k,y:f-0*l-k},{x:1*l+
k,y:f-1*l-k},{x:1*l+k,y:f-1.75*l-k},{x:1.75*l+k,y:f-1*l-k}],x=[{x:d/2-.5*l,y:f-1*l-k},{x:d/2+.5*l,y:f-1*l-k},{x:d/2,y:f-.5*l-k},{x:d/2-.5*l,y:f-0*l-k},{x:d/2+.5*l,y:f-0*l-k}];k=[{x:d-.5*l-k,y:f-.5*l-k},{x:d-0*l-k,y:f-1*l-k},{x:d-1*l-k,y:f-0*l-k},{x:d-1*l-k,y:f-1*l-k},{x:d-1*l-k,y:f-1.75*l-k},{x:d-1.75*l-k,y:f-1*l-k}];b=part.builder("g",void 0===b?"sixteenSegmentDisplay":b,{x:e,y:c});d=part.builder("rect",null,{width:d,height:f,style:h});b.appendChild(d);var y=[];p=[[p[1],p[0],p[3],q[1],q[0],q[3]],
[q[4],q[0],q[2],r[3],r[0],r[1]],[p[0],p[2],u[0],u[2],u[1],p[3]],[p[4],p[3],p[5],t[9],t[7],t[8]],[q[0],q[1],t[7],t[0],t[10],q[2]],[r[4],r[3],r[5],t[11],t[10],t[12]],[r[0],r[2],v[1],v[2],v[0],r[3]],[u[4],u[2],u[1],t[7],t[0],t[1]],[v[3],v[2],v[0],t[10],t[0],t[4]],[n[0],n[1],u[3],u[2],u[4],n[3]],[n[4],n[3],n[5],t[2],t[1],t[3]],[x[0],x[2],x[1],t[4],t[0],t[1]],[k[4],k[3],k[5],t[5],t[4],t[6]],[k[3],v[3],v[2],v[4],k[1],k[0]],[n[2],n[0],n[3],x[0],x[2],x[3]],[k[2],k[0],k[3],x[1],x[2],x[4]]];for(q=0;q<p.length;q++)r=
{segment:part.builder("path","arc",{path:p[q],lineType:"L",style:m}),state:!1},y.push(r),b.append(r.segment);b.set=function(b,c){(y[b].state=c)?system.utility.element.setStyle(y[b].segment,g):system.utility.element.setStyle(y[b].segment,m)};b.get=function(b){return y[b].state};b.clear=function(){for(var b=0;b<y.length;b++)this.set(b,!1)};b.enterCharacter=function(b){switch(b){case "!":b=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":b=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":b=[0,0,0,0,
0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":b=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":b=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":b=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':b=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":b=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":b=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":b=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":b=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":b=
[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":b=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":b=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":b=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":b=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":b=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":b=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":b=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":b=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":b=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":b=
[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":b=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":b=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":b=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":b=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":b=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":b=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":b=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":b=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":b=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];
break;case "b":case "B":b=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":b=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":b=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":b=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":b=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":b=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":b=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":b=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":b=
[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":b=[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":b=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":b=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":b=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":b=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":b=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":b=[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":b=[1,1,1,0,0,0,1,1,1,1,
0,0,1,0,0,0];break;case "s":case "S":b=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":b=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":b=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":b=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":b=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":b=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":b=[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":b=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":b=
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}for(var c=0;c<b.length;c++)this.set(c,1==b[c])};b.test=function(){this.clear();var b=0;setInterval(function(c){c.enterCharacter("0123456789abcdefghijklmnopqrstuvwxyz".split("")[b++]);36<b&&(b=0)},500,this)};return b};this.rastorDisplay=function(b,e,c,d,f,h,g,m,k){function l(){for(var b=0;b<h;b++)for(var c=0;c<g;c++)system.utility.element.setStyle(q[b][c],"fill:rgb("+255*r[b][c][0]+","+255*r[b][c][1]+","+255*r[b][c][2]+
")")}m=void 0===m?1:m;k=void 0===k?1:k;b=part.builder("g",void 0===b?"rastorDisplay":b,{x:e,y:c});var p=part.builder("rect",null,{width:d,height:f,style:"fill:rgb(0,0,0)"});b.appendChild(p);var q=[],r=[];d/=h;f/=g;for(e=0;e<h;e++){var u=[],t=[];for(c=0;c<g;c++)p=part.builder("rect",null,{x:e*d+m/2,y:c*f+k/2,width:d-m,height:f-k,style:"fill:rgb(0,0,0)"}),u.push(p),t.push([0,0,0]),b.appendChild(p);q.push(u);r.push(t)}b.get=function(b,c){return r[b][c]};b.set=function(b,c,d){r[b][c]=d;l()};b.import=
function(b){for(var c=0;c<h;c++)for(var d=0;d<g;d++)this.set(c,d,b[c][d]);l()};b.export=function(){return r};b.setAll=function(b){for(var c=0;c<h;c++)for(var d=0;d<g;d++)this.set(c,d,b)};b.test=function(){this.setAll([1,1,1]);this.set(1,1,[1,.5,.5]);this.set(2,2,[.5,1,.5]);this.set(3,3,[.5,.5,1]);this.set(4,4,[1,.5,1]);l()};return b};this.glowbox_rect=function(b,e,c,d,f,h,g,m){h=void 0===h?0:h;g=void 0===g?"fill:rgba(240,240,240,1)":g;m=void 0===m?"fill:rgba(80,80,80,1)":m;b=part.builder("g",void 0===
b?"glowbox_rect":b,{x:e,y:c});var k=part.builder("rect",null,{width:d,height:f,sngle:h,style:m});b.appendChild(k);b.on=function(){system.utility.element.setStyle(k,g)};b.off=function(){system.utility.element.setStyle(k,m)};return b};this.grapherCanvas=function(b,e,c,d,f,h,g,m,k,l){b=void 0===b?"grapherCanvas":b;h=void 0===h?["stroke:rgba(0,255,0,1); stroke-width:0.75; stroke-linecap:round;","stroke:rgba(255,255,0,1); stroke-width:0.75; stroke-linecap:round;"]:h;m=void 0===m?"stroke:rgba(0,100,0,1); stroke-width:1;":
m;k=void 0===k?"fill:rgba(0,150,0,1); font-size:5; font-family:Helvetica;":k;l=void 0===l?"fill:rgba(50,50,50,1)":l;var p={bottom:-1,top:1,left:0,right:1},q={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.995,y:.06},printText:!1},r={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],textPosition:{x:-.0025,y:.04},printText:!1},u=[];g=h.map(function(b){return system.utility.element.styleExtractor(b)});h=g.map(function(b){return b.stroke});var t=g.map(function(b){return 10*
b["stroke-width"]});g=system.utility.element.styleExtractor(k);k=12*g["font-size"]+"px "+g["font-family"];g=system.utility.element.styleExtractor(m);m=g.stroke;var v=10*g["stroke-width"];g=system.utility.element.styleExtractor(l);l=g.fill;e=part.builder("g",b,{x:e,y:c});var n=part.builder("canvas",b,{width:d,height:f,resolution:10});e.appendChild(n.element);e._test=function(){this.drawBackground();this.draw([0,-2,1,-1,2],[0,.25,.5,.75,1]);this.draw([0,1],void 0,1)};e.backgroundLineThickness=function(b){if(null==
b)return v;v=b};e.foregroundLineThickness=function(b){if(null==b)return foregroundLineThickness;foregroundLineThickness=b};e.viewbox=function(b){if(null==b)return p;void 0!=b.bottom&&(p.bottom=b.bottom);void 0!=b.top&&(p.top=b.top);void 0!=b.left&&(p.left=b.left);void 0!=b.right&&(p.right=b.right)};e.horizontalMarkings=function(b){if(null==b)return q;void 0!=b.points&&(q.points=b.points);void 0!=b.printingValues&&(q.printingValues=b.printingValues);void 0!=b.textPosition&&(q.textPosition=b.textPosition);
void 0!=b.printText&&(q.printText=b.printText)};e.verticalMarkings=function(b){if(null==b)return r;void 0!=b.points&&(r.points=b.points);void 0!=b.printingValues&&(r.printingValues=b.printingValues);void 0!=b.textPosition&&(r.textPosition=b.textPosition);void 0!=b.printText&&(r.printText=b.printText)};e.drawBackground=function(){n.context.fillStyle=l;n.context.fillRect(n.c(0),n.c(0),n.c(d),n.c(f));for(var b=0;b<q.points.length;b++){var c=system.utility.math.relativeDistance(f,p.bottom,p.top,q.points[b]);
n.context.strokeStyle=m;n.context.lineWidth=v;n.context.beginPath();n.context.moveTo(0,n.c(c));n.context.lineTo(n.c(d),n.c(c));n.context.closePath();n.context.stroke();q.printText&&(n.context.fillStyle=m,n.context.font=k,n.context.fillText(q.printingValues&&void 0!=q.printingValues[b]?q.printingValues[b]:q.points[b],n.c(void 0==q.textPosition||void 0==q.textPosition.x?.5:system.utility.math.relativeDistance(d,p.left,p.right,"number"==typeof q.textPosition.x?q.textPosition.x:q.textPosition.x[b])),
n.c(void 0==q.textPosition||void 0==q.textPosition.y?c+1.75:f-system.utility.math.relativeDistance(f,p.bottom,p.top,q.points[b]-("number"==typeof q.textPosition.y?q.textPosition.y:q.textPosition.y[b])))))}for(b=0;b<r.points.length;b++){var e=system.utility.math.relativeDistance(d,p.left,p.right,r.points[b]);n.context.strokeStyle=m;n.context.lineWidth=v;n.context.beginPath();n.context.moveTo(n.c(e),0);n.context.lineTo(n.c(e),n.c(f));n.context.closePath();n.context.stroke();r.printText&&(n.context.fillStyle=
m,n.context.font=k,n.context.fillText(r.printingValues&&void 0!=r.printingValues[b]?r.printingValues[b]:r.points[b],n.c(void 0==r.textPosition||void 0==r.textPosition.x?.5:system.utility.math.relativeDistance(d,p.left,p.right,r.points[b]-("number"==typeof r.textPosition.x?r.textPosition.x:r.textPosition.x[b]))),n.c(void 0==r.textPosition||void 0==r.textPosition.y?c:system.utility.math.relativeDistance(f,p.bottom,p.top,"number"==typeof r.textPosition.y?r.textPosition.y:r.textPosition.y[b]))))}n.print()};
e.draw=function(b,c,e){u[void 0===e?0:e]={x:c,y:b};this.drawBackground();for(e=0;e<u.length;e++)if(void 0!=u[e]){b=u[e].y;c=u[e].x;for(var g=0;g<b.length-1;g++){var k=system.utility.math.lineCorrecter({x1:void 0==c?d/(b.length-1)*(g+0):system.utility.math.relativeDistance(d,p.left,p.right,c[g+0]),x2:void 0==c?d/(b.length-1)*(g+1):system.utility.math.relativeDistance(d,p.left,p.right,c[g+1]),y1:f-system.utility.math.relativeDistance(f,p.bottom,p.top,b[g+0],!0),y2:f-system.utility.math.relativeDistance(f,
p.bottom,p.top,b[g+1],!0)},f,d);k&&(n.context.strokeStyle=void 0==h[e]?h[0]:h[e],n.context.lineWidth=void 0==t[e]?t[0]:t[e],n.context.beginPath(),n.context.moveTo(n.c(k.x1),n.c(k.y1)),n.context.lineTo(n.c(k.x2),n.c(k.y2)),n.context.closePath(),n.context.stroke())}}n.print()};return e};this.audio_meter_level=function(b,e,c,d,f,h,g,m,k,l){g=void 0===g?[.125,.25,.375,.5,.625,.75,.875]:g;k=void 0===k?["fill:rgba(250,250,250,1);","fill:rgb(100,100,100);"]:k;var p=part.builder("meter_level","mainlevel",
{x:e,y:c,width:f,height:h,angle:void 0===d?0:d,markings:g,style:{backing:void 0===m?"fill:rgb(10,10,10)":m,levels:k,marking:void 0===l?"fill:rgba(220,220,220,1); stroke:none; font-size:1px; font-family:Courier New;":l}}),q=part.circuit.audio.audio2percentage();q.newValue=function(b){p.set(b)};p.audioIn=function(){return q.audioIn()};p.start=function(){q.start()};p.stop=function(){q.stop()};p.set(0);return p};this.meter_level=function(b,e,c,d,f,h,g,m,k,l){function p(b){return part.builder("path",null,
{path:[{x:f,y:b-.1},{x:f-f/4,y:b-.1},{x:f-f/4,y:b+.1},{x:f,y:b+.1}],lineType:"L",style:l})}g=void 0===g?[.125,.25,.375,.5,.625,.75,.875]:g;m=void 0===m?"fill:rgb(10,10,10)":m;k=void 0===k?["fill:rgba(250,250,250,1);","fill:rgb(100,100,100);"]:k;l=void 0===l?"fill:rgba(220,220,220,1); stroke:none; font-size:1px; font-family:Courier New;":l;var q=0,r=0;b=part.builder("g",void 0===b?"meter_level":b,{x:e,y:c});k[0]+="transition: height 0s;";k[1]+="transition: height 0.01s;";var u=part.builder("level",
"mainlevel",{width:f,height:h,angle:d,style:{backing:m,levels:k}});b.append(u);for(d=0;d<g.length;d++)b.append(p(h*(1-g[d]))),b.append(part.builder("label",null,{y:h*(1-g[d])+.3,text:g[d],style:l}));setInterval(function(){u.set(r,0);0<q&&(q-=.0025);u.set(q,1);r>q&&(q=r)},1E3/30);b.set=function(b){mostRecentSetting_slow=r=b};return b};this.grapher_periodicWave=function(b,e,c,d,f,h,g,m,k,l,p){h=void 0===h?"Canvas":h;g=void 0===g?["stroke:rgba(0,255,0,1); stroke-width:0.75; stroke-linecap:round;"]:g;
m=void 0===m?["fill:rgba(0,255,0,1); font-size:3; font-family:Helvetica;"]:m;k=void 0===k?"stroke:rgba(0,100,0,1); stroke-width:1;":k;l=void 0===l?"fill:rgba(0,100,0,1); font-size:3; font-family:Helvetica;":l;p=void 0===p?"fill:rgba(50,50,50,1)":p;b=part.builder("g",void 0===b?"grapher_periodicWave":b,{x:e,y:c});b._data={};b._data.wave={sin:[],cos:[]};b._data.resolution=500;var q=part.builder("grapher"+h,"graph",{x:0,y:0,width:d,height:f,style:{foreground:g,foregroundText:m,background:k,backgroundText:l,
backing:p}});b.append(q);b.wave=function(b,c){b=void 0===b?null:b;c=void 0===c?null:c;if(null==b){for(;this._data.wave.sin.length<this._data.wave.cos.length;)this._data.wave.sin.push(0);for(;this._data.wave.sin.length>this._data.wave.cos.length;)this._data.wave.cos.push(0);for(b=0;b<this._data.wave.sin.length;b++)this._data.wave.sin[b]||(this._data.wave.sin[b]=0),this._data.wave.cos[b]||(this._data.wave.cos[b]=0);return this._data.wave}null==c&&(this._data.wave=b);switch(c){case "sin":this._data.wave.sin=
b;break;case "cos":this._data.wave.cos=b}};b.waveElement=function(b,c,d){if(null==d)return this._data.wave[b][c];this._data.wave[b][c]=d};b.resolution=function(b){b=void 0===b?null:b;if(null==b)return this._data.resolution;this._data.resolution=b};b.updateBackground=function(){q.viewbox({bottom:-1.1,top:1.1});q.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});q.verticalMarkings({points:[0,.25,.5,.75],printText:!0});q.drawBackground()};b.draw=function(){for(var b=[],c,d=
0;d<=this._data.resolution;d++){for(var e=c=0;e<this._data.wave.sin.length;e++)this._data.wave.sin[e]||(this._data.wave.sin[e]=0),c+=Math.sin(d/this._data.resolution*e*Math.PI*2)*this._data.wave.sin[e];for(e=0;e<this._data.wave.cos.length;e++)this._data.wave.cos[e]||(this._data.wave.cos[e]=0),c+=Math.cos(d/this._data.resolution*e*Math.PI*2)*this._data.wave.cos[e];b.push(c)}q.draw(b)};b.reset=function(){this.wave({sin:[],cos:[]});this.resolution(500);this.updateBackground()};b.reset();return b};this.readout_sixteenSegmentDisplay=
function(b,e,c,d,f,h,g,m,k,l){m=void 0===m?"fill:rgb(0,0,0)":m;k=void 0===k?"fill:rgb(200,200,200)":k;l=void 0===l?"fill:rgb(20,20,20)":l;var p="",q=null;b=part.builder("g",void 0===b?"readout_sixteenSegmentDisplay":b,{x:e,y:c,r:void 0===g?0:g});var r=[];for(e=0;e<h;e++)c=part.builder("sixteenSegmentDisplay",e,{x:d/h*e,width:d/h,height:f,style:{background:m,glow:k,dim:l}}),b.append(c),r.push(c);b.test=function(){this.text("Look at all the text I've got here! 1234567890 \\/<>()[]{}*!?\"#_,.");this.print("r2lSweep")};
b.text=function(b){if(null==b)return p;p=b};b.print=function(b){clearInterval(q);switch(b){case "smart":p.length>r.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var c=0;q=setInterval(function(){for(var b=r.length-1;0<=b;b--)r[b].enterCharacter(p[c-(r.length-1-b)]);c++;c>r.length+p.length-1&&(c=0)},100);break;default:for(b=0;b<r.length;b++)r[b].enterCharacter(p[b])}};return b};this.label=function(b,e,c,d,f,h){b=void 0===b?"label":b;f=void 0===f?"fill:rgba(0,0,0,1); font-size:3; font-family:Helvetica;":
f;h=void 0===h?0:h;e=part.builder("g",b,{x:e,y:c});var g=part.builder("text",b,{text:d,angle:h,style:f});e.appendChild(g);e.text=function(b){b=void 0===b?null:b;if(null==b)return g.innerHTML;g.innerHTML=b};return e};this.level=function(b,e,c,d,f,h,g,m){b=void 0===b?"level":b;g=void 0===g?"fill:rgb(10,10,10)":g;m=void 0===m?["fill:rgb(250,250,250)","fill:rgb(200,200,200)"]:m;Array.apply(null,Array(m.length)).map(Number.prototype.valueOf,0);b=part.builder("g",b,{x:e,y:c});var k=[];for(e=0;e<m.length;e++)c=
void 0!=m[e]?m[e]:m[0],c=part.builder("rect","movingRect_"+e,{x:(-h*Math.sin(d)+f*Math.cos(d)).toFixed(10),y:(h*Math.cos(d)+f*Math.sin(d)).toFixed(10),width:f,height:0,angle:d+Math.PI,style:c}),k.push(c),b.prepend(c);d=part.builder("rect","movingRect_"+e,{width:f,height:h,angle:d,style:g});b.prepend(d);b.set=function(b,c){if(null==b)return value;b=1<b?1:b;value=0>b?0:b;k[void 0===c?0:c].height.baseVal.valueInSpecifiedUnits=h*value};b.getLevelStyle=function(b){return k[b].style};return b}};this.control=
new function(){this.rangeslide=function(b,e,c,d,f,h,g,m,k,l,p,q,r,u,t){function v(b,c,e){e=void 0===e?!0:e;b=1<b?1:b;b=0>b?0:b;switch(c){default:console.error("unknown handle to adjust");break;case "start":1<=b/(1-g/(1-g))&&(b=1-g/(1-g));var h=b+(1-b)*g,l=k.end-k.end*g;h>=l&&(k.end=h/(1-g));break;case "end":1>=b/(g/(1-g))&&(b=g/(1-g)),h=k.start+(1-k.start)*g,l=b-b*g,h>=l&&(k.start=(l-g)/(1-g))}k[c]=b;system.utility.element.setTransform_XYonly(L.start,0,k.start*f*(1-g));system.utility.element.setTransform_XYonly(L.end,
0,k.end*f*(1-g));system.utility.element.setTransform_XYonly(A,(1-m)/2*d,f*(g+k.start-g*(k.start+.1)));A.height.baseVal.value=f*(k.end-k.start+g*(k.start-k.end-1+.2));if(e&&w.onchange)w.onchange(k)}function n(b){b=[b,b+(k.end-k.start)];0>=b[0]?(b[1]-=b[0],b[0]=0):1<=b[1]&&(b[0]-=b[1]-1,b[1]=1);v(b[0],"start");v(b[1],"end")}g=void 0===g?.025:g;m=void 0===m?.75:m;k=void 0===k?{start:0,end:1}:k;l=void 0===l?{start:-1,end:-1}:l;p=void 0===p?"fill:rgba(200,200,200,1)":p;q=void 0===q?"fill:rgba(150,150,150,1)":
q;r=void 0===r?"fill:rgba(50,50,50,1)":r;u=void 0===u?"fill:rgba(0,0,0,0);":u;t=void 0===t?"fill:rgba(200,0,200,0.5);":t;var x=!1,y=["start","end"],w=part.builder("g",void 0===b?"rangeslide":b,{x:e,y:c,r:void 0===h?0:h}),E=part.builder("g","backingAndSlotGroup",{});w.appendChild(E);b=part.builder("rect","backing",{width:d,height:f,style:q});E.appendChild(b);r=part.builder("rect","slot",{x:.45*d,y:g/2*f,width:.1*d,height:f*(1-g),style:r});E.appendChild(r);var A=part.builder("rect","span",{x:(1-m)/
2*d,y:f*g,width:d*m,height:f-2*f*g,style:t});w.appendChild(A);var L={};for(t=0;t<y.length;t++)L[y[t]]=part.builder("g","handle_"+t,{}),w.appendChild(L[y[t]]),r=part.builder("rect","handle",{width:d,height:f*g,style:p}),L[y[t]].appendChild(r),r=f*g+.01*f,r=part.builder("rect","invisibleHandle",{y:(f*g-r)/2,width:d,height:r+g,style:u}),L[y[t]].appendChild(r);w.get=function(){return k};w.set=function(b,c){x||(void 0!=b.start&&v(b.start,"start",c),void 0!=b.end&&v(b.end,"end",c))};w.smoothSet=function(b,
c,d,e){if(!x){var f=system.audio.context.currentTime;JSON.parse(JSON.stringify(k));var g=system.utility.math.curvePoint.linear;switch(d){case "linear":g=system.utility.math.curvePoint.linear;break;case "sin":g=system.utility.math.curvePoint.sin;break;case "cos":g=system.utility.math.curvePoint.cos;break;case "exponential":g=system.utility.math.curvePoint.exponential;break;case "s":g=system.utility.math.curvePoint.s}w.smoothSet.interval=setInterval(function(){var d=(system.audio.context.currentTime-
f)/c;1<d&&(d=1);void 0!=b.start&&v(g(d,startvalues.start,b.start),"start",e);void 0!=b.end&&v(g(d,startvalues.end,b.end),"end",e);if(system.audio.context.currentTime-f>=c){if(w.onrelease)w.onrelease(k);clearInterval(w.smoothSet.interval)}},1E3/30)}};E.onclick=function(b){x||(w.smoothSet.interval&&clearInterval(w.smoothSet.interval),b=system.utility.element.getPositionWithinFromMouse(b,E,d,f).y,b+=.5*g*(2*b-1),Math.abs(k.start-b)<Math.abs(k.end-b)?v(b,"start"):v(b,"end"))};w.ondblclick=function(){0>
l.start||0>l.end||x||(w.smoothSet.interval&&clearInterval(w.smoothSet.interval),v(l.start,"start"),v(l.end,"end"),w.onrelease(k))};w.onwheel=function(){if(!x){w.smoothSet.interval&&clearInterval(w.smoothSet.interval);var b=system.mouse.wheelInterpreter(event.deltaY),c=system.utility.workspace.getGlobalScale(w);b/=10*c;v(k.start-b,"start");v(k.end+b,"end")}};A.onmousedown=function(b){x=!0;w.smoothSet.interval&&clearInterval(w.smoothSet.interval);var c=k.start,e=system.utility.element.getPositionWithinFromMouse(b,
E,d,f);system.utility.workspace.mouseInteractionHandler(function(b){b=system.utility.element.getPositionWithinFromMouse(b,E,d,f);n(c+(b.y-e.y));w.onchange(k)},function(b){b=system.utility.element.getPositionWithinFromMouse(b,E,d,f);n(c+(b.y-e.y));w.onrelease(k);x=!1})};for(t=0;t<y.length;t++)L[y[t]].onmousedown=function(b){return function(c){x=!0;w.smoothSet.interval&&clearInterval(w.smoothSet.interval);var e=k[y[b]],h=system.utility.element.getPositionWithinFromMouse(c,E,d,f);system.utility.workspace.mouseInteractionHandler(function(c){c=
system.utility.element.getPositionWithinFromMouse(c,E,d,f);v(e+(c.y-h.y)/(1-g),y[b]);w.onchange(k)},function(b){w.onrelease(k);x=!1})}}(t);w.onchange=function(){};w.onrelease=function(){};v(0,"start");v(1,"end");return w};this.rastorgrid=function(b,e,c,d,f,h,g,m,k,l,p){m=void 0===m?"fill:rgba(200,200,200,1)":m;k=void 0===k?"fill:rgba(150,150,150,1)":k;l=void 0===l?"fill:rgba(220,220,220,1)":l;p=void 0===p?"fill:rgba(220,220,220,1)":p;var q=part.builder("g",void 0===b?"rastorgrid":b,{x:e,y:c});e=part.builder("rect",
null,{width:d,height:f,style:m});q.appendChild(e);for(c=0;c<g;c++)for(e=0;e<h;e++)b=part.builder("checkbox_rect",c+"_"+e,{x:d/h*e,y:f/g*c,width:d/h,height:f/g,style:{check:k,backing:m,checkGlow:p,backingGlow:l}}),q.appendChild(b),b.onchange=function(){if(q.onchange)q.onchange(q.get())};q.box=function(b,c){return q.children[c+"_"+b]};q.get=function(){for(var b=[],c=0;c<g;c++){for(var d=[],e=0;e<h;e++)d.push(this.box(e,c).get());b.push(d)}return b};q.set=function(b,c){for(c=0;c<g;c++)for(var d=0;d<
h;d++)q.box(d,c).set(b[c][d],!1)};q.clear=function(){for(var b=0;b<g;b++)for(var c=0;c<h;c++)q.box(c,b).set(!1,!1)};q.light=function(b,c,d){q.box(b,c).light(d)};q.onchange=function(){};return q};this.needleOverlay=function(b,e,c,d,f,h,g,m,k,l){function p(b,c){void 0==c||0>c||1<c?(n[b].remove(),delete u[b]):(x.contains(n[b])||x.append(n[b]),system.utility.element.setTransform_XYonly(n[b],c*d-d*g*c,0),u[b]=c)}function q(){if(void 0==u.selection_A||void 0==u.selection_B||u.selection_A==u.selection_B)n.selection_area.remove(),
t.selectionAreaToggle(!1),delete u.selection_area;else{x.contains(n.selection_area)||(x.append(n.selection_area),t.selectionAreaToggle(!0));if(u.selection_A<u.selection_B)var b=u.selection_A,c=u.selection_B;else b=u.selection_B,c=u.selection_A;b=b-g*b+g;c=c-g*c-b;0>c&&(c=0);system.utility.element.setTransform_XYonly(n.selection_area,d*b,0);n.selection_area.setAttribute("width",d*c)}}function r(b,c){if(t.onchange)t.onchange(b,system.utility.element.getPositionWithinFromMouse(event,t,d,f).x);system.svgElement.onmousemove=
function(e){e=system.utility.element.getPositionWithinFromMouse(e,t,d,f).x;p(b,e);if(t.onchange)t.onchange(b,e);c&&c()};system.svgElement.onmouseup=function(e){e=system.utility.element.getPositionWithinFromMouse(e,t,d,f).x;p(b,e);if(t.onrelease)t.onrelease(b,e);c&&c();system.svgElement.onmousemove=void 0;system.svgElement.onmouseleave=void 0;system.svgElement.onmouseup=void 0};system.svgElement.onmouseleave=system.svgElement.onmouseup}g=void 0===g?.00125:g;m=void 0===m?!0:m;k=void 0===k?!0:k;l=void 0===
l?["fill:rgba(240, 240, 240, 1);","fill:rgba(255, 231, 114, 1);"]:l;var u={},t=part.builder("g",void 0===b?"needleOverlay":b,{x:e,y:c});b=part.builder("rect","backing",{width:d,height:f,style:"fill:rgba(100,100,100, 0);"});t.appendChild(b);var v=d*g+.005*d,n={};n.lead=part.builder("g","lead",{});n.lead.append(part.builder("rect","handle",{width:g*d,height:f,style:l[0]}));n.lead.append(part.builder("rect","invisibleHandle",{x:(d*g-v)/2,width:v,height:f,style:"fill:rgba(255,0,0,0);cursor: col-resize;"}));
n.selection_A=part.builder("g","selection_A",{});n.selection_A.append(part.builder("rect","handle",{width:g*d,height:f,style:l[1]}));n.selection_A.append(part.builder("rect","invisibleHandle",{x:(d*g-v)/2,width:v,height:f,style:"fill:rgba(255,0,0,0);cursor: col-resize;"}));n.selection_B=part.builder("g","selection_B",{});n.selection_B.append(part.builder("rect","handle",{width:g*d,height:f,style:l[1]}));n.selection_B.append(part.builder("rect","invisibleHandle",{x:(d*g-v)/2,width:v,height:f,style:"fill:rgba(255,0,0,0);cursor: col-resize;"}));
n.selection_area=part.builder("rect","selection_area",{height:f,style:l[1]+"opacity:0.33; cursor: move;"});n.generic=[];var x=part.builder("g","controlObjectsGroup",{});t.append(x);b.onmousedown=function(b){b.shiftKey?k&&(p("selection_A",system.utility.element.getPositionWithinFromMouse(b,t,d,f).x),r("selection_B",q)):m&&(p("lead",system.utility.element.getPositionWithinFromMouse(b,t,d,f).x),r("lead"))};n.lead.onmousedown=function(){r("lead")};n.selection_A.onmousedown=function(){r("selection_A",
q)};n.selection_B.onmousedown=function(){r("selection_B",q)};n.selection_area.onmousedown=function(){system.svgElement.onmousemove=function(b){var c=system.utility.workspace.getGlobalScale(t),e=u.selection_A+b.movementX/(d*c);b=u.selection_B+b.movementX/(d*c);1<e||0>e||1<b||0>b||(t.onchange&&(t.onchange("selection_A",e),t.onchange("selection_B",b)),p("selection_A",e),p("selection_B",b),q())};system.svgElement.onmouseup=function(b){t.onrelease&&(t.onrelease("selection_A",u.selection_A),t.onrelease("selection_B",
u.selection_B));system.svgElement.onmousemove=void 0;system.svgElement.onmouseleave=void 0;system.svgElement.onmouseup=void 0}};n.selection_A.ondblclick=function(){p("selection_A");p("selection_B");q()};n.selection_B.ondblclick=n.selection_A.ondblclick;n.selection_area.ondblclick=n.selection_A.ondblclick;t.select=function(b,c){if(m){if(void 0==b)return u.lead;1<b||0>b?p("lead"):p("lead",b)}};t.area=function(b,c){if(k){if(void 0==b||void 0==c)return{A:u.selection_A,B:u.selection_B};1<b||0>b||1<c||
0>c?(p("selection_A"),p("selection_B")):(p("selection_A",b),p("selection_B",c));q()}};t.genericNeedle=function(b,c,e){e=void 0===e?"":e;e=void 0===e?{}:e;n.generic[b]&&void 0!=c?system.utility.element.setTransform_XYonly(n.generic[b],c*d-d*g*c,0):n.generic[b]?(n.generic[b].remove(),delete n.generic[b]):(n.generic[b]=part.builder("g","generic_"+b,{x:c*d-g*d/2,style:e}),n.generic[b].append(part.builder("rect","handle",{width:g*d,height:f,style:l[0]})),n.generic[b].append(part.builder("rect","invisibleHandle",
{x:(d*g-v)/2,width:v,height:f,style:"fill:rgba(255,0,0,0);"})),x.append(n.generic[b]))};t.onchange=function(b,c){};t.onrelease=function(b,c){};t.selectionAreaToggle=function(b){};return t};this.button_rect=function(b,e,c,d,f,h,g,m,k,l,p,q,r,u,t,v,n,x,y,w,E,A,L,P,T,V,O,U,W,H,F,J,I){l=void 0===l?.5:l;p=void 0===p?.05:p;q=void 0===q?!0:q;r=void 0===r?!0:r;u=void 0===u?!1:u;t=void 0===t?!0:t;v=void 0===v?"fill:rgba(0,0,0,1); font-size:15; font-family:Helvetica; alignment-baseline:central; pointer-events: none; user-select: none;":
v;n=void 0===n?"fill:rgba(180,180,180,1)":n;x=void 0===x?"fill:rgba(200,200,200,1)":x;y=void 0===y?"fill:rgba(230,230,230,1)":y;w=void 0===w?"fill:rgba(200,200,200,1); stroke:rgba(120,120,120,1); stroke-width:2;":w;E=void 0===E?"fill:rgba(230,230,230,1); stroke:rgba(120,120,120,1); stroke-width:2;":E;A=void 0===A?"fill:rgba(220,220,220,1)":A;L=void 0===L?"fill:rgba(250,250,250,1)":L;P=void 0===P?"fill:rgba(220,220,220,1); stroke:rgba(120,120,120,1); stroke-width:2;":P;T=void 0===T?"fill:rgba(250,250,250,1); stroke:rgba(120,120,120,1); stroke-width:2;":
T;V=void 0===V?"fill:rgba(220,220,220,1)":V;O=void 0===O?"fill:rgba(240,240,240,1)":O;U=void 0===U?"fill:rgba(220,220,220,1); stroke:rgba(120,120,120,1); stroke-width:2;":U;W=void 0===W?"fill:rgba(240,240,240,1); stroke:rgba(120,120,120,1); stroke-width:2;":W;H=void 0===H?"fill:rgba(240,240,240,1)":H;F=void 0===F?"fill:rgba(250,250,250,1)":F;J=void 0===J?"fill:rgba(240,240,240,1); stroke:rgba(120,120,120,1); stroke-width:2;":J;I=void 0===I?"fill:rgba(250,250,250,1); stroke:rgba(120,120,120,1); stroke-width:2;":
I;var z=part.builder("g",void 0===b?"button_rect":b,{x:e,y:c,r:void 0===h?0:h}),D=part.builder("rect",null,{width:d,height:f,style:n});z.appendChild(D);g=part.builder("text",null,{x:d/2,y:f*l,text:g,style:v+"text-anchor:middle;"});z.appendChild(g);m=part.builder("text",null,{x:d*p,y:f*l,text:m,style:v});z.appendChild(m);k=part.builder("text",null,{x:d-d*p,y:f*l,text:k,style:v+"text-anchor:end;"});z.appendChild(k);z.state={hovering:!1,glowing:!1,selected:!1,pressed:!1};z.activateGraphicalState=function(){if(q){var b=
[x,y,w,E,A,L,P,T,V,O,U,W,H,F,J,I];!r&&z.state.hovering&&(z.state.hovering=!1);!u&&z.state.selected&&(z.state.selected=!1);system.utility.element.setStyle(D,b[8*z.state.hovering+4*z.state.glowing+2*z.state.selected+1*(t&&z.state.pressed)])}else system.utility.element.setStyle(D,n)};z.activateGraphicalState();z.onmouseenter=function(b){this.state.hovering=!0;this.activateGraphicalState();if(this.onenter)this.onenter(this,b);if(1==b.buttons)z.onmousedown(b)};z.onmouseleave=function(b){this.state.hovering=
!1;this.release(b);this.activateGraphicalState();if(this.onleave)this.onleave(this,b)};z.onmouseup=function(b){this.release(b)};z.onmousedown=function(b){this.press(b)};z.ondblclick=function(b){if(this.ondblpress)this.ondblpress(this,b)};z.press=function(b){if(!this.state.pressed){this.state.pressed=!0;this.activateGraphicalState();if(this.onpress)this.onpress(this,b);this.select(!this.select(),b)}};z.release=function(b){if(this.state.pressed&&(this.state.pressed=!1,this.activateGraphicalState(),
this.onrelease))this.onrelease(this,b)};z.active=function(b){if(void 0==b)return q;q=b;this.activateGraphicalState()};z.glow=function(b){if(void 0==b)return this.state.glowing;this.state.glowing=b;this.activateGraphicalState()};z.select=function(b,c,d){d=void 0===d?!0:d;if(void 0==b)return this.state.selected;if(u&&this.state.selected!=b&&(this.state.selected=b,this.activateGraphicalState(),d))if(this.state.selected)this.onselect(this,c);else this.ondeselect(this,c)};z.onenter=function(b,c){};z.onleave=
function(b,c){};z.onpress=function(b,c){};z.ondblpress=function(b,c){};z.onrelease=function(b,c){};z.onselect=function(b,c){};z.ondeselect=function(b,c){};return z};this.checkbox_rect=function(b,e,c,d,f,h,g,m,k,l){function p(){q._checked?system.utility.element.setStyle(u,q.styles.check):system.utility.element.setStyle(u,q.styles.uncheck);system.utility.element.setStyle(r,q.styles.backing)}g=void 0===g?"fill:rgba(150,150,150,1)":g;m=void 0===m?"fill:rgba(200,200,200,1)":m;k=void 0===k?"fill:rgba(220,220,220,1)":
k;l=void 0===l?"fill:rgba(220,220,220,1)":l;var q=part.builder("g",void 0===b?"checkbox_rect":b,{x:e,y:c,r:void 0===h?0:h});q._checked=!1;q.styles={check:g,uncheck:"fill:rgba(0,0,0,0)",backing:m};var r=part.builder("rect",null,{width:d,height:f,style:m});q.appendChild(r);var u=part.builder("rect",null,{x:.1*d,y:.1*f,width:.8*d,height:.8*f,style:q.styles.uncheck});q.appendChild(u);q.get=function(){return q._checked};q.set=function(b,c){c=void 0===c?!0:c;q._checked=b;p();if(c&&this.onchange)this.onchange(b)};
q.light=function(b){b?(q.styles.check=k,q.styles.backing=l):(q.styles.check=g,q.styles.backing=m);p()};q.onchange=function(){};q.onclick=function(b){q.set(!q.get())};return q};this.slide=function(b,e,c,d,f,h,g,m,k,l,p,q,r){function u(b,c){b=1<b?1:b;b=0>b?0:b;if(void 0===c||c)n.onchange(b);m=b;y.y.baseVal.valueInSpecifiedUnits=b*f*(1-g);w.y.baseVal.valueInSpecifiedUnits=b*f*(1-g)}function t(b){return b.y*Math.cos(n.__calculationAngle)-b.x*Math.sin(n.__calculationAngle)}h=void 0===h?0:h;g=void 0===
g?.1:g;m=void 0===m?0:m;k=void 0===k?-1:k;l=void 0===l?"fill:rgba(200,200,200,1)":l;p=void 0===p?"fill:rgba(150,150,150,1)":p;q=void 0===q?"fill:rgba(50,50,50,1)":q;r=void 0===r?"fill:rgba(0,0,0,0);":r;var v=!1,n=part.builder("g",void 0===b?"slide":b,{x:e,y:c,r:h}),x=part.builder("g","backingAndSlotGroup",{});n.appendChild(x);b=part.builder("rect","backing",{width:d,height:f,style:p});x.appendChild(b);q=part.builder("rect","slot",{x:.45*d,y:g/2*f,width:.1*d,height:f*(1-g),style:q});x.appendChild(q);
var y=part.builder("rect","handle",{width:d,height:f*g,style:l});n.appendChild(y);l=f*g+.01*f;var w=part.builder("rect","invisibleHandle",{y:(f*g-l)/2,width:d,height:l+g,style:r});n.appendChild(w);n.__calculationAngle=h;n.set=function(b,c){v||u(b,c)};n.smoothSet=function(b,c,d,e){if(!v){var f=system.audio.context.currentTime,g=m,h=system.utility.math.curvePoint.linear;switch(d){case "linear":h=system.utility.math.curvePoint.linear;break;case "sin":h=system.utility.math.curvePoint.sin;break;case "cos":h=
system.utility.math.curvePoint.cos;break;case "exponential":h=system.utility.math.curvePoint.exponential;break;case "s":h=system.utility.math.curvePoint.s}n.smoothSet.interval=setInterval(function(){var d=(system.audio.context.currentTime-f)/c;1<d&&(d=1);u(h(d,g,b),e);system.audio.context.currentTime-f>=c&&clearInterval(n.smoothSet.interval)},1E3/30)}};n.get=function(){return m};n.ondblclick=function(){0>k||v||(n.smoothSet.interval&&clearInterval(n.smoothSet.interval),u(k),n.onrelease(m))};n.onwheel=
function(){if(!v){n.smoothSet.interval&&clearInterval(n.smoothSet.interval);var b=system.mouse.wheelInterpreter(event.deltaY),c=system.utility.workspace.getGlobalScale(n);u(m+b/(10*c));n.onrelease(m)}};x.onclick=function(b){v||(n.smoothSet.interval&&clearInterval(n.smoothSet.interval),b=system.utility.element.getPositionWithinFromMouse(b,x,d,f).y,b+=.5*g*(2*b-1),u(b),n.onrelease(b))};w.onmousedown=function(b){v=!0;n.smoothSet.interval&&clearInterval(n.smoothSet.interval);var c=m,d=t(b),e=f-f*g;system.utility.workspace.mouseInteractionHandler(function(b){b=
d-t(b);var f=system.utility.workspace.getGlobalScale(n);u(c-b/(f*e))},function(b){b=d-t(b);var f=system.utility.workspace.getGlobalScale(n);n.onrelease(c-b/(f*e));v=!1})};n.onchange=function(){};n.onrelease=function(){};u(m);return n};this.dial_continuous=function(b,e,c,d,f,h,g,m,k,l,p,q,r,u,t){f=void 0===f?3*Math.PI/4:f;h=void 0===h?1.5*Math.PI:h;g=void 0===g?"fill:rgba(175,175,175,1)":g;m=void 0===m?"fill:rgba(50,50,50,1)":m;k=void 0===k?"fill:rgba(250,100,100,1)":k;l=void 0===l?"fill:rgba(175,175,175,1)":
l;p=void 0===p?"fill:rgba(254,255,219,1)":p;q=void 0===q?"fill:rgba(250,100,100,1)":q;r=void 0===r?1.35:r;u=void 0===u?"fill:none; stroke:none;":u;t=void 0===t?"fill:none; stroke:none;":t;var v=part.builder("g",void 0===b?"dial_continuous":b,{x:e,y:c});v._value=0;v._data={mux:4*d};b=[];for(e=0;5>e;e++)c=system.utility.math.polar2cartesian(f+h/5*e,d*r),b.push(c),c=system.utility.math.polar2cartesian(f+h/5*(e+.5),1.11*d*r),b.push(c);c=system.utility.math.polar2cartesian(f+h,d*r);b.push(c);var n=part.builder("path",
"arc",{path:b,lineType:"Q",style:u});v.appendChild(n);var x=part.builder("circle","slot",{r:1.1*d,style:m});v.appendChild(x);var y=part.builder("circle","slot",{r:d,style:g});v.appendChild(y);r=d/5;var w=part.builder("rect","needle",{height:r,width:d,style:k});w.x.baseVal.valueInSpecifiedUnits=d/3;w.y.baseVal.valueInSpecifiedUnits=-r/2;v.appendChild(w);v.get=function(){return this._value};v.set=function(b,c,d){c=void 0===c?!1:c;d=void 0===d?!0:d;b=1<b?1:b;this._value=b=0>b?0:b;if(d&&this.onchange)try{this.onchange(b)}catch(P){console.error("Error with dial_continuous:onchange\n",
P)}if(d&&!c&&this.onrelease)try{this.onrelease(b)}catch(P){console.error("Error with dial_continuous:onrelease\n",P)}this.children.needle.rotation(f+h*b)};v.smoothSet=function(b,c,d,e){e=void 0===e?!0:e;var f=system.audio.context.currentTime,g=value,h=system.utility.math.curvePoint.linear;switch(d){case "linear":h=system.utility.math.curvePoint.linear;break;case "sin":h=system.utility.math.curvePoint.sin;break;case "cos":h=system.utility.math.curvePoint.cos;break;case "exponential":h=system.utility.math.curvePoint.exponential;
break;case "s":h=system.utility.math.curvePoint.s}v.smoothSet.interval=setInterval(function(){var d=(system.audio.context.currentTime-f)/c;1<d&&(d=1);v.set(h(d,g,b),!0,e);system.audio.context.currentTime-f>=c&&clearInterval(v.smoothSet.interval)},1E3/30)};v.glow=function(b){b?(system.utility.element.setStyle(n,t),system.utility.element.setStyle(x,p),system.utility.element.setStyle(y,l),system.utility.element.setStyle(w,q)):(system.utility.element.setStyle(n,u),system.utility.element.setStyle(x,m),
system.utility.element.setStyle(y,g),system.utility.element.setStyle(w,k))};v.onchange=function(){};v.onrelease=function(){};v.ondblclick=function(){this.set(.5)};v.onwheel=function(b){b=system.mouse.wheelInterpreter(b.deltaY);var c=system.utility.workspace.getGlobalScale(v);this.set(this.get()-b/(10*c))};v.onmousedown=function(b){system.svgElement.onmousemove_old=system.svgElement.onmousemove;system.svgElement.onmouseleave_old=system.svgElement.onmouseleave;system.svgElement.onmouseup_old=system.svgElement.onmouseup;
system.svgElement.tempRef=this;system.svgElement.tempRef._data.initialValue=this.get();system.svgElement.tempRef._data.initialY=b.y;system.svgElement.tempRef._data.mux=system.svgElement.tempRef._data.mux;system.svgElement.onmousemove=function(b){var c=system.svgElement.tempRef._data.mux,d=system.svgElement.tempRef._data.initialValue;b=b.y-system.svgElement.tempRef._data.initialY;var e=system.utility.workspace.getGlobalScale(v);system.svgElement.tempRef.set(d-b/(e*c),!0)};system.svgElement.onmouseup=
function(){this.tempRef.set(this.tempRef.get(),!1);delete this.tempRef;system.svgElement.onmousemove=system.svgElement.onmousemove_old;system.svgElement.onmouseleave=system.svgElement.onmouseleave_old;system.svgElement.onmouseup=system.svgElement.onmouseup_old;system.svgElement.onmousemove_old=null;system.svgElement.onmouseleave_old=null;system.svgElement.onmouseup_old=null};system.svgElement.onmouseleave=system.svgElement.onmouseup;system.svgElement.onmousemove(b)};v.set(0);return v};this.slidePanel=
function(b,e,c,d,f,h,g,m,k,l,p,q,r){g=void 0===g?0:g;k=void 0===k?0:k;l=void 0===l?.5:l;p=void 0===p?"fill:rgba(180,180,180,1)":p;q=void 0===q?"fill:rgba(150,150,150,1)":q;r=void 0===r?"fill:rgba(50,50,50,1)":r;var u=part.builder("g",void 0===b?"slidePanel":b,{x:e,y:c,r:g});for(b=0;b<h;b++)e=part.builder("slide",b,{x:d/h*b,y:0,width:d/h,height:f,value:k,resetValue:l,style:{handle:p,backing:q,slot:r}}),e.onchange=function(b){u.onchange(this.id,b)},e.onrelease=function(b){u.onrelease(this.id,b)},e.__calculationAngle=
g,u.appendChild(e);u.slide=function(b){return u.children[b]};u.get=function(){for(var b=[],c=0;c<h;c++)b.push(this.slide(c).get());return b};u.set=function(b,c){c=void 0===c?!0:c;for(var d=0;d<b.length;d++)this.slide(d).set(b[d],c)};u.setAll=function(b,c){c=void 0===c?!0:c;this.set(Array.apply(null,Array(h)).map(Number.prototype.valueOf,b),!1);if(c)this.onchange("all",b)};u.smoothSet=function(b,c,d,e){e=void 0===e?!0:e;for(var f=0;f<b.length;f++)this.slide(f).smoothSet(b[f],c,d,e)};u.smoothSetAll=
function(b,c,d,e){e=void 0===e?!0:e;this.smoothSet(Array.apply(null,Array(h)).map(Number.prototype.valueOf,b),c,d,!1);if(e)this.onchange("all",b)};u.onchange=function(b,c){};u.onrelease=function(b,c){};return u};this.sequencer=function(b,e,c,d,f,h,g,m,k,l,p,q,r,u,t,v,n,x,y,w,E,A,L){function P(b,c){if(void 0==b&&void 0==c)return{x:k,y:l};var e=.01;if(void 0!=b&&b!=k&&void 0!=c&&c!=l){e=.01;b=b<e?e:b;c=c<e?e:c;k=1<b?1:b;l=1<c?1:c;H=d/k;F=f/l;N.width.baseVal.value=H;N.height.baseVal.value=F;for(b=0;b<
g;b++)system.utility.element.setTransform_XYonly(C.children["strip_vertical_"+b],d/(g*k)*b,0),C.children["strip_vertical_"+b].width.baseVal.value=d/(g*k),C.children["strip_vertical_"+b].height.baseVal.value=F;for(b=0;b<m;b++)system.utility.element.setTransform_XYonly(C.children["strip_horizontal_"+b],0,f/(m*l)*b),C.children["strip_horizontal_"+b].height.baseVal.value=f/(m*l),C.children["strip_horizontal_"+b].width.baseVal.value=H;for(b=0;b<S.children.length;b++)S.children[b].unit(d/(g*k),f/(m*l));
0<=G.position&&(M.children.playhead.main.y2.baseVal.value=F,M.children.playhead.invisibleHandle.y2.baseVal.value=F,system.utility.element.setTransform_XYonly(M.children.playhead,H/g*G.position,0))}else if(void 0!=b&&b!=k){b=b<e?e:b;k=1<b?1:b;H=d/k;N.width.baseVal.value=H;for(b=0;b<g;b++)system.utility.element.setTransform_XYonly(C.children["strip_vertical_"+b],d/(g*k)*b,0),C.children["strip_vertical_"+b].width.baseVal.value=d/(g*k);for(b=0;b<m;b++)C.children["strip_horizontal_"+b].width.baseVal.value=
H;for(b=0;b<S.children.length;b++)S.children[b].unit(d/(g*k),void 0);0<=G.position&&system.utility.element.setTransform_XYonly(M.children.playhead,H/g*G.position,0)}else if(void 0!=c&&c!=l){c=c<e?e:c;l=1<c?1:c;F=f/l;N.height.baseVal.value=F;for(b=0;b<g;b++)C.children["strip_vertical_"+b].height.baseVal.value=F;for(b=0;b<m;b++)system.utility.element.setTransform_XYonly(C.children["strip_horizontal_"+b],0,f/(m*l)*b),C.children["strip_horizontal_"+b].height.baseVal.value=f/(m*l);for(b=0;b<S.children.length;b++)S.children[b].unit(void 0,
f/(m*l));0<=G.position&&(M.children.playhead.main.y2.baseVal.value=F,M.children.playhead.invisibleHandle.y2.baseVal.value=F)}}function T(b,c,e){e=void 0===e?!0:e;if(void 0==b&&void 0==c)return J;if(void 0==b||isNaN(b))b=J.x;if(void 0==c||isNaN(c))c=J.y;b=0>b?0:b;b=1<b?1:b;c=0>c?0:c;c=1<c?1:c;J.x=b;J.y=c;system.utility.element.setTransform_XYonly(M,-J.x*(H-d),-J.y*(F-f));var g=(H-d)*J.x,h=(F-f)*J.y,k=g+d,m=h+f;Z.setAttribute("clip-path","polygon("+g+"px "+h+"px, "+g+"px "+m+"px, "+k+"px "+m+"px, "+
k+"px "+h+"px)");g=(1-(I.right-I.left))*b;h=(1-(I.bottom-I.top))*c;I={left:g,right:g+(I.right-I.left),top:h,bottom:h+(I.bottom-I.top)};e&&(B.onpan({x:b,y:c}),B.onchangeviewarea(I))}function V(b){return{x:k*(b.x-J.x)+J.x,y:l*(b.y-J.y)+J.y}}function O(b){b.y=Math.floor(b.y*m);b.y>=m&&(b.y=m-1);b.x=Math.round(b.x*g/X)*X;0>b.x&&(b.x=0);return{line:b.y,position:b.x}}function U(b,c,e,h){b=z.add({line:b,position:c,length:e,strength:void 0===h?.5:h});c=z.getNote(b);var p=part.element.control.sequencer.noteBlock(b,
d/(g*k),f/(m*l),c.line,c.position,c.length,c.strength,!1,r,u,t,v);S.append(p);p.select=function(b){b=void 0===b?!1:b;-1!=D.indexOf(this)?b||this.deselect():(this.selected(!0),D.push(this),this.glow(!0))};p.deselect=function(){D.splice(D.indexOf(this),1);this.selected(!1);this.glow(!1)};p.delete=function(){this.deselect();z.remove(parseInt(this.id));this.remove()};p.ondblclick=function(b){b[system.super.keys.ctrl]&&D.map(function(b){b.strength(.5);z.update(b.id,{strength:.5})})};p.body.onmousedown=
function(b){if(system.keyboard.pressedKeys.hasOwnProperty("Space")&&system.keyboard.pressedKeys.Space)N.onmousedown(b);else{if(!b.shiftKey&&!p.selected())for(;0<D.length;)D[0].deselect();p.select(!0);for(var c=[],d=0;d<D.length;d++)c.push({id:parseInt(D[d].id),block:D[d],starting:z.getNote(parseInt(D[d].id))});if(b[system.super.keys.ctrl]){var e=c.map(function(b){return b.block.strength()}),f=b.offsetY;system.utility.workspace.mouseInteractionHandler(function(b){b=(f-b.offsetY)/system.svgElement.clientHeight;
for(var d=0;d<c.length;d++)c[d].block.strength(e[d]+b),z.update(c[d].id,{strength:e[d]+b})})}else{var g=!1,h=O(system.utility.element.getPositionWithinFromMouse(b,N,H,F));system.utility.workspace.mouseInteractionHandler(function(d){if(!g&&(g=!0,b[system.super.keys.alt]))for(var e=0;e<D.length;e++){var f=z.getNote(parseInt(D[e].id));U(f.line,f.position,f.length,f.strength)}e=O(system.utility.element.getPositionWithinFromMouse(d,N,H,F));d=e.line-h.line;e=e.position-h.position;for(f=0;f<c.length;f++){z.update(c[f].id,
{line:c[f].starting.line+d,position:c[f].starting.position+e});var k=z.getNote(c[f].id);c[f].block.line(k.line);c[f].block.position(k.position)}})}}};p.leftHandle.onmousedown=function(b){if(!b.shiftKey&&!p.selected())for(;0<D.length;)D[0].deselect();p.select(!0);for(var c=[],d=0;d<D.length;d++)c.push({id:parseInt(D[d].id),block:D[d],starting:z.getNote(parseInt(D[d].id))});var e=O(system.utility.element.getPositionWithinFromMouse(b,N,H,F));system.utility.workspace.mouseInteractionHandler(function(b){b=
O(system.utility.element.getPositionWithinFromMouse(b,N,H,F));b=e.position-b.position;for(var d=0;d<c.length;d++)if(!(0>c[d].starting.position-b)){z.update(c[d].id,{length:c[d].starting.length+b,position:c[d].starting.position-b});var f=z.getNote(c[d].id);c[d].block.position(f.position);c[d].block.length(f.length)}})};p.rightHandle.onmousedown=function(b){if(!b.shiftKey&&!p.selected())for(;0<D.length;)D[0].deselect();p.select(!0);for(var c=[],d=0;d<D.length;d++)c.push({id:parseInt(D[d].id),block:D[d],
starting:z.getNote(parseInt(D[d].id))});var e=O(system.utility.element.getPositionWithinFromMouse(b,N,H,F));system.utility.workspace.mouseInteractionHandler(function(b){b=O(system.utility.element.getPositionWithinFromMouse(b,N,H,F)).position-e.position;for(var d=0;d<c.length;d++){z.update(c[d].id,{length:c[d].starting.length+b});var f=z.getNote(c[d].id);c[d].block.position(f.position);c[d].block.length(f.length)}})};return{id:b,noteBlock:p}}function W(){var b=part.builder("g","playhead",{});M.appendChild(b);
b.onmousedown=function(){G.held=!0;system.utility.workspace.mouseInteractionHandler(function(b){b=O(system.utility.element.getPositionWithinFromMouse(b,N,H,F));B.playheadPosition(b.position)},function(){G.held=!1})};b.main=part.builder("line","main",{x1:0,y1:0,x2:0,y2:F,style:L+"stroke-width:"+G.width+";"});b.appendChild(b.main);b.invisibleHandle=part.builder("line","invisibleHandle",{x1:0,y1:0,x2:0,y2:F,style:"stroke:rgba(0,0,0,0); cursor: col-resize; stroke-width:"+G.width*G.invisibleHandleMux+
";"});b.appendChild(b.invisibleHandle)}b=void 0===b?"svg_sequencer":b;g=void 0===g?64:g;m=void 0===m?16:m;k=void 0===k?1:k;l=void 0===l?1:l;p=void 0===p?"fill:rgba(20,20,20,1);":p;q=void 0===q?"fill:rgba(209, 189, 222, 0.5);stroke:rgba(225, 217, 234,1);stroke-width:0.5;pointer-events:none;":q;r=void 0===r?"fill:rgba(138,138,138,0.6);stroke:rgba(175,175,175,0.8);stroke-width:0.5;{fill:rgba(130,199,208,0.6);stroke:rgba(130,199,208,0.8);stroke-width:0.5;{fill:rgba(129,209,173,0.6);stroke:rgba(129,209,173,0.8);stroke-width:0.5;{fill:rgba(234,238,110,0.6);stroke:rgba(234,238,110,0.8);stroke-width:0.5;{fill:rgba(249,178,103,0.6);stroke:rgba(249,178,103,0.8);stroke-width:0.5;{fill:rgba(255, 69, 69,0.6);stroke:rgba(255, 69, 69,0.8);stroke-width:0.5;".split("{"):
r;u=void 0===u?"fill:rgba(138,138,138,0.8);stroke:rgba(175,175,175,1);stroke-width:0.5;{fill:rgba(130,199,208,0.8);stroke:rgba(130,199,208,1);stroke-width:0.5;{fill:rgba(129,209,173,0.8);stroke:rgba(129,209,173,1);stroke-width:0.5;{fill:rgba(234,238,110,0.8);stroke:rgba(234,238,110,1);stroke-width:0.5;{fill:rgba(249,178,103,0.8);stroke:rgba(249,178,103,1);stroke-width:0.5;{fill:rgba(255, 69, 69,0.8);stroke:rgba(255, 69, 69,1);stroke-width:0.5;".split("{"):u;t=void 0===t?"fill:rgba(200,0,0,0);cursor:col-resize;":
t;v=void 0===v?3:v;n=void 0===n?[0,1]:n;x=void 0===x?"stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(120,120,120,0.8);":x;y=void 0===y?["stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(120,120,120,0.5);","stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(100,100,100,0);"]:y;w=void 0===w?[0]:w;E=void 0===E?"stroke:rgba(252,244,128,0.5);stroke-width:0.5;fill:rgba(229, 221, 112,0.25);":E;A=void 0===A?["stroke:rgba(120,120,120,1);stroke-width:0.5;fill:rgba(30,30,30,0.5);"]:A;L=void 0===
L?"stroke:rgb(240, 240, 240);":L;var H=d/k;var F=f/l;var J={x:0,y:0},I={left:0,right:k,top:0,bottom:l},z=new part.circuit.sequencing.noteRegistry(g,m),D=[],Q=[],X=1,Y=!1,R={start:0,end:g},G={width:.75,invisibleHandleMux:6,position:-1,held:!1,automoveViewposition:!1},B=part.builder("g",b,{x:e,y:c,r:h}),K=part.builder("rect","backing",{width:d,height:f,style:p});B.appendChild(K);var Z=part.builder("g","viewport",{});Z.setAttribute("clip-path","polygon(0px 0px, "+d+"px 0px, "+d+"px "+f+"px, 0px "+f+
"px)");B.appendChild(Z);var M=part.builder("g","workarea",{});Z.appendChild(M);M.onkeydown=function(b){if("Delete"==b.key||"Backspace"==b.key){for(;0<D.length;)D[0].delete();return!0}};var C=part.builder("g","backgroundDrawArea",{});M.appendChild(C);(function(){C.innerHTML="";for(var b=0;b<m;b++)C.appendChild(part.builder("rect","strip_horizontal_"+b,{x1:0,y:f/(m*l)*b,width:H,height:f/(m*l),style:y[n[b%n.length]]}));for(b=0;b<g;b++)C.appendChild(part.builder("rect","strip_vertical_"+b,{x:d/(g*k)*
b,y:0,width:d/(g*k),height:F,style:A[w[b%w.length]]}))})();var N=part.builder("rect","interactionPlane",{width:H,height:F,style:"fill:rgba(0,0,0,0);"});M.appendChild(N);N.onmousedown=function(b){if(b.shiftKey){var c=system.utility.element.getPositionWithinFromMouse(b,K,d,f),e=system.utility.element.getPositionWithinFromMouse(b,K,d,f),h=part.builder("rect","selectionArea",{x:c.x*d,y:c.y*f,width:0,height:0,style:q});B.appendChild(h);system.utility.workspace.mouseInteractionHandler(function(b){e=system.utility.element.getPositionWithinFromMouse(b,
K,d,f);var g=e.x-c.x;b=e.y-c.y;0>g?(h.width.baseVal.value=-g*d,g=c.x+g):(h.width.baseVal.value=g*d,g=c.x);0>b?(h.height.baseVal.value=-b*f,b=c.y+b):(h.height.baseVal.value=b*f,b=c.y);system.utility.element.setTransform_XYonly(h,g*d,b*f)},function(){h.remove();var b=V(c),d=V(e);b.x*=H;d.y*=F;d.x*=H;b.y*=F;var f=[{},{}];b.x<d.x?(f[0].x=b.x,f[1].x=d.x):(f[0].x=d.x,f[1].x=b.x);b.y<d.y?(f[0].y=b.y,f[1].y=d.y):(f[0].y=d.y,f[1].y=b.y);for(;0<D.length;)D[0].deselect();b=S.getElementsByTagName("g");for(d=
0;d<b.length;d++){var k=z.getNote(parseInt(b[d].id));k=[{x:H/g*k.position,y:F/m*k.line},{x:H/g*(k.position+k.length),y:F/m*(k.line+1)}];system.utility.math.detectOverlap(f,k,f,k)&&b[d].select(!0)}})}else if(b[system.super.keys.alt]){for(;0<D.length;)D[0].deselect();var p=O(system.utility.element.getPositionWithinFromMouse(b,N,H,F));p=U(p.line,p.position,0);p.noteBlock.select();p.noteBlock.rightHandle.onmousedown(b)}else if(system.keyboard.pressedKeys.Space){var n=system.utility.element.getPositionWithinFromMouse(b,
K,d,f),r=J.x,t=J.y;system.utility.workspace.mouseInteractionHandler(function(b){b=system.utility.element.getPositionWithinFromMouse(b,K,d,f);T(r+(n.x-b.x)*g*k/(g-g*k),t+(n.y-b.y)*m*l/(m-m*l))},function(b){})}else for(;0<D.length;)D[0].deselect()};var S=part.builder("g","notePane",{});M.appendChild(S);B.glowHorizontal=function(b,c,d){for(void 0==d&&(d=c+1);c<d;c++)system.utility.element.setStyle(C.children["strip_horizontal_"+c],b?x:y[n[c%n.length]])};B.glowVertical=function(b,c,d){for(void 0==d&&
(d=c+1);c<d;c++)system.utility.element.setStyle(C.children["strip_vertical_"+c],b?E:A[w[c%w.length]])};B.step=function(b){if(void 0==b)return X;X=b};B.viewposition=T;B.viewArea=function(b,c){c=void 0===c?!0:c;if(void 0==b||void 0==b.left&&void 0==b.right&&void 0==b.top&&void 0==b.bottom)return I;void 0==b.left&&(b.left=I.left);void 0==b.right&&(b.right=I.right);void 0==b.top&&(b.top=I.top);void 0==b.bottom&&(b.bottom=I.bottom);var d=I.right-I.left!=b.right-b.left,e=b.bottom-b.top!=I.bottom-I.top;
d&&e?P(b.right-b.left,b.bottom-b.top):d?P(b.right-b.left,void 0):e&&P(void 0,b.bottom-b.top);e=d=0;0!=1-(b.right-b.left)&&(d=b.left+(b.right-b.left)/(1-(b.right-b.left))*b.left);0!=1-(b.bottom-b.top)&&(e=b.top+(b.bottom-b.top)/(1-(b.bottom-b.top))*b.top);T(d,e,c);I={top:b.top,bottom:b.bottom,left:b.left,right:b.right}};B.export=function(){return z.export()};B.import=function(b){z.import(b)};B.eventsBetween=function(b,c){return z.eventsBetween(b,c)};B.getAllNotes=function(){return z.getAllNotes()};
B.addNote=function(b,c,d,e){U(b,c,d,void 0===e?1:e)};B.addNotes=function(b){for(var c=0;c<b.length;c++)this.addNote(b[c].line,b[c].position,b[c].length,b[c].strength)};B.loopActive=function(b){if(void 0==b)return Y;Y=b;B.glowVertical(!1,0,g);Y&&B.glowVertical(!0,0>R.start?0:R.start,R.end>g?g:R.end)};B.loopPeriod=function(b,c){if(void 0==b||void 0==c)return R;b>c||0>b||0>c||(R={start:b,end:c},Y&&(B.glowVertical(!1,0,g),B.glowVertical(!0,0>b?0:b,c>g?g:c)))};B.automove=function(b){if(void 0==b)return G.automoveViewposition;
G.automoveViewposition=b};B.playheadPosition=function(b,c){if(void 0==b)return G.position;G.position=b;if(void 0===c||c){b=[];for(c=0;c<Q.length;c++){var d=z.getNote(Q[c]);null!=d&&b.unshift({noteID:Q[c],line:d.line,position:R.start,strength:0})}Q=[];B.event&&0<b.length&&B.event(b)}0>G.position||G.position>g?M.children.playhead&&M.children.playhead.remove():(M.children.playhead||W(),system.utility.element.setTransform_XYonly(M.children.playhead,H/g*G.position,0),G.automoveViewposition&&(b=g-g*k,(G.position<
Math.floor(J.x*b)||G.position>Math.floor(J.x*b)+g*k)&&B.viewposition((G.position>b?b:G.position)/b)))};B.progress=function(){if(!G.held){0>G.position&&(W(),G.position=0);var b=B.eventsBetween(G.position,G.position+X);if(Y&&G.position==R.start){for(var c=0;c<Q.length;c++){var d=z.getNote(Q[c]);null!=d&&b.unshift({noteID:Q[c],line:d.line,position:R.start,strength:0})}Q=[]}for(c=0;c<b.length;c++)d=Q.indexOf(b[c].noteID),-1!=d&&0==b[c].strength?Q.splice(d):0<b[c].strength&&Q.push(b[c].noteID);G.position=
Y&&G.position+X==R.end?R.start:G.position+X;B.playheadPosition(G.position,!1);B.event&&0<b.length&&B.event(b)}};B.onpan=function(b){};B.onchangeviewarea=function(b){};B.event=function(b){};return B};this.sequencer.noteBlock=function(b,e,c,d,f,h,g,m,k,l,p,q){function r(){A.body.height.baseVal.value=c;A.leftHandle.height.baseVal.value=c;A.rightHandle.height.baseVal.value=c}function u(){A.body.width.baseVal.value=h*e;system.utility.element.setTransform_XYonly(A.rightHandle,h*e-q/2,0)}function t(){system.utility.element.setTransform_XYonly(A,
void 0,d*c)}function v(){system.utility.element.setTransform_XYonly(A,f*e,void 0)}function n(b,c){for(var d=[],e=0;e<b.length;e++)d[e]=system.utility.element.styleExtractor(b[e]);b=d[0];d[0].hasOwnProperty("fill")&&(b.fill=system.utility.misc.multiBlendColours(d.map(function(b){return b.fill}),c));d[0].hasOwnProperty("stroke")&&(b.stroke=system.utility.misc.multiBlendColours(d.map(function(b){return b.stroke}),c));return system.utility.element.stylePacker(b)}g=void 0===g?1:g;m=void 0===m?!1:m;k=void 0===
k?"fill:rgba(138,138,138,0.6);stroke:rgba(175,175,175,0.8);stroke-width:0.5;{fill:rgba(130,199,208,0.6);stroke:rgba(130,199,208,0.8);stroke-width:0.5;{fill:rgba(129,209,173,0.6);stroke:rgba(129,209,173,0.8);stroke-width:0.5;{fill:rgba(234,238,110,0.6);stroke:rgba(234,238,110,0.8);stroke-width:0.5;{fill:rgba(249,178,103,0.6);stroke:rgba(249,178,103,0.8);stroke-width:0.5;{fill:rgba(255, 69, 69,0.6);stroke:rgba(255, 69, 69,0.8);stroke-width:0.5;".split("{"):k;l=void 0===l?"fill:rgba(138,138,138,0.8);stroke:rgba(175,175,175,1);stroke-width:0.5;{fill:rgba(130,199,208,0.8);stroke:rgba(130,199,208,1);stroke-width:0.5;{fill:rgba(129,209,173,0.8);stroke:rgba(129,209,173,1);stroke-width:0.5;{fill:rgba(234,238,110,0.8);stroke:rgba(234,238,110,1);stroke-width:0.5;{fill:rgba(249,178,103,0.8);stroke:rgba(249,178,103,1);stroke-width:0.5;{fill:rgba(255, 69, 69,0.8);stroke:rgba(255, 69, 69,1);stroke-width:0.5;".split("{"):
l;p=void 0===p?"fill:rgba(255,0,255,0);cursor:col-resize;":p;q=void 0===q?5:q;var x=!1,y=q/4,w=n(k,g),E=n(l,g),A=part.builder("g",b,{y:d*c,x:f*e});A.body=part.builder("rect","body",{width:h*e,height:c,style:w});A.leftHandle=part.builder("rect","leftHandle",{x:-q/2,width:q,height:c,style:p});A.rightHandle=part.builder("rect","rightHandle",{x:h*e-q/2,width:q,height:c,style:p});A.append(A.body);A.append(A.leftHandle);A.append(A.rightHandle);A.unit=function(b,g){if(void 0==b&&void 0==g)return{x:e,y:c};
void 0==b?(c=g,r(),t()):void 0==g?(e=b,u(),v()):(e=b,c=g,r(),u(),system.utility.element.setTransform_XYonly(A,f*e,d*c))};A.line=function(b){if(void 0==b)return d;d=b;t()};A.position=function(b){if(void 0==b)return f;f=b;v()};A.length=function(b){if(void 0==b)return h;h=b<y/e?y/e:b;u()};A.strength=function(b){if(void 0==b)return g;b=1<b?1:b;g=0>b?0:b;w=n(k,g);E=n(l,g);A.glow(m)};A.glow=function(b){if(void 0==b)return m;(m=b)?system.utility.element.setStyle(A.body,E):system.utility.element.setStyle(A.body,
w)};A.selected=function(b){if(void 0==b)return x;x=b};return A};this.list=function(b,e,c,d,f,h,g,m,k,l,p,q,r,u,t,v,n,x,y,w,E,A,L,P,T,V,O,U,W,H,F,J,I,z,D,Q,X,Y,R){function G(){B=[];S.innerHTML="";K=[];for(var b=Z=M=0,c=0;c<g.length;c++){if("break"==g[c]){var e=part.builder("rect",c,{x:d*(1-v)*.5,y:b,width:d*v,height:f*t,style:A});b+=f*(t+u)}else"space"==g[c]?(e=part.builder("rect",c,{x:0,y:b,width:d,height:f*n,style:E}),b+=f*(n+u)):(e=part.builder("button_rect",c,{x:0,y:b,width:d,height:f*r,text_centre:g[c].text?
g[c].text:g[c].text_centre,text_left:g[c].text_left,text_right:g[c].text_right,textVerticalOffset:x,textHorizontalOffsetMux:y,active:q,hoverable:l,selectable:m,pressable:p,style:{text:w,off:L,up:P,press:T,select:V,select_press:O,glow:U,glow_press:W,glow_select:H,glow_select_press:F,hover:J,hover_press:I,hover_select:z,hover_select_press:D,hover_glow:Q,hover_glow_press:X,hover_glow_select:Y,hover_glow_select_press:R}}),b+=f*(r+u),e.onenter=function(b){return function(){C.onenter(b)}}(c),e.onleave=
function(b){return function(){C.onleave(b)}}(c),e.onpress=function(b){return function(){C.onpress(b)}}(c),e.ondblpress=function(b){return function(){C.ondblpress(b)}}(c),e.onrelease=function(b){return function(){g[b].function&&g[b].function();C.onrelease(b)}}(c),e.onselect=function(b){return function(c,d){C.select(b,!0,d,!1)}}(c),e.ondeselect=function(b){return function(c,d){C.select(b,!1,d,!1)}}(c));B.push(e);S.appendChild(e)}return b-f*u}g=void 0===g?[{text:"item1",function:function(){console.log("item1 function")}},
{text:"item2",function:function(){console.log("item2 function")}},{text:"item3",function:function(){console.log("item3 function")}},{text:"item4",function:function(){console.log("item4 function")}},"space","break","space",{text:"item5",function:function(){console.log("item5 function")}},{text:"item6",function:function(){console.log("item6 function")}},{text:"item7",function:function(){console.log("item7 function")}},{text:"item8",function:function(){console.log("item8 function")}},{text:"item9",function:function(){console.log("item9 function")}},
{text:"item10",function:function(){console.log("item10 function")}},{text:"item11",function:function(){console.log("item11 function")}},{text:"item12",function:function(){console.log("item12 function")}},{text:"item13",function:function(){console.log("item13 function")}},{text:"item14",function:function(){console.log("item14 function")}},{text:"item15",function:function(){console.log("item15 function")}},{text:"item16",function:function(){console.log("item16 function")}},{text:"item17",function:function(){console.log("item17 function")}},
{text:"item18",function:function(){console.log("item18 function")}},{text:"item19",function:function(){console.log("item19 function")}},{text:"item20",function:function(){console.log("item20 function")}},{text:"item21",function:function(){console.log("item21 function")}},{text:"item22",function:function(){console.log("item22 function")}},{text:"item23",function:function(){console.log("item23 function")}},{text:"item24",function:function(){console.log("item24 function")}},{text:"item25",function:function(){console.log("item25 function")}},
{text:"item26",function:function(){console.log("item26 function")}},{text:"item27",function:function(){console.log("item27 function")}},{text:"item28",function:function(){console.log("item28 function")}},{text:"item29",function:function(){console.log("item29 function")}},{text:"item30",function:function(){console.log("item30 function")}},{text:"item31",function:function(){console.log("item31 function")}},{text:"item32",function:function(){console.log("item32 function")}}]:g;m=void 0===m?!0:m;k=void 0===
k?!0:k;l=void 0===l?!0:l;p=void 0===p?!0:p;q=void 0===q?!0:q;r=void 0===r?.1:r;u=void 0===u?.01:u;t=void 0===t?.0025:t;v=void 0===v?.9:v;n=void 0===n?.005:n;x=void 0===x?.5:x;y=void 0===y?.05:y;w=void 0===w?"fill:rgba(0,0,0,1); font-size:5; font-family:Helvetica; alignment-baseline:central; pointer-events: none; user-select: none;":w;E=void 0===E?"fill:rgba(230,230,230,1)":E;A=void 0===A?"fill:rgba(195,195,195,1)":A;L=void 0===L?"fill:rgba(180,180,180,1)":L;P=void 0===P?"fill:rgba(220,220,220,1)":
P;T=void 0===T?"fill:rgba(230,230,230,1)":T;V=void 0===V?"fill:rgba(200,200,200,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":V;O=void 0===O?"fill:rgba(230,230,230,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":O;U=void 0===U?"fill:rgba(230,230,210,1)":U;W=void 0===W?"fill:rgba(250,250,250,1)":W;H=void 0===H?"fill:rgba(220,220,220,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":H;F=void 0===F?"fill:rgba(250,250,250,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":F;J=void 0===J?"fill:rgba(230,230,230,1)":
J;I=void 0===I?"fill:rgba(240,240,240,1)":I;z=void 0===z?"fill:rgba(220,220,220,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":z;D=void 0===D?"fill:rgba(240,240,240,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":D;Q=void 0===Q?"fill:rgba(240,240,240,1)":Q;X=void 0===X?"fill:rgba(250,250,250,1)":X;Y=void 0===Y?"fill:rgba(240,240,240,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":Y;R=void 0===R?"fill:rgba(250,250,250,1); stroke:rgba(120,120,120,1); stroke-width:0.5;":R;var B=[],K=[],Z=0,
M=0,C=part.builder("g",void 0===b?"list":b,{x:e,y:c,r:void 0===h?0:h});b=part.builder("rect",null,{width:d,height:f,style:E});C.appendChild(b);var N=part.builder("g","viewport",{});N.setAttribute("clip-path","polygon(0px 0px, "+d+"px 0px, "+d+"px "+f+"px, 0px "+f+"px)");C.appendChild(N);var S=part.builder("g","mainList");N.appendChild(S);var aa=G();C.onwheel=function(b){b=system.mouse.wheelInterpreter(b.deltaY);C.position(C.position()+b/10)};C.position=function(b,c){c=void 0===c?!0:c;if(void 0==b)return M;
b=0>b?0:b;M=b=1<b?1:b;if(!(aa<f)){var e=aa-f;system.utility.element.setTransform_XYonly(S,void 0,-b*e);e*=b;var g=e+f;N.setAttribute("clip-path","polygon(0px "+e+"px, "+d+"px "+e+"px, "+d+"px "+g+"px, 0px "+g+"px)");if(c&&this.onpositionchange)this.onpositionchange(b)}};C.select=function(b,c,d,e){e=void 0===e?!0:e;if(m){if(k)if(void 0!=d&&d.shiftKey){c=Math.min(Z,b);b=Math.max(Z,b);K=[];for(d=0;d<B.length;d++)(d>b||d<c)&&B[d].select()&&B[d].select(!1,void 0,!1);for(d=c;d<=b;d++)B[d].select()||(B[d].select(!0,
void 0,!1),K.push(d))}else e&&B[b].select(c),c&&!K.includes(b)?K.push(b):!c&&K.includes(b)&&K.splice(K.indexOf(b),1),Z=b;else if(c&&!K.includes(b)){for(;0<K.length;)B[K[0]].select(!1,void 0,!1),K.shift();K.push(b);e&&B[b].select(!0,void 0,!1)}else!c&&K.includes(b)&&(K.splice(K.indexOf(b),1),e&&B[b].select(!1,void 0,!1));C.onselection(K)}};C.add=function(b){g.push(b);aa=G()};C.remove=function(b){g.splice(b,1);aa=G()};C.onenter=function(b){};C.onleave=function(b){};C.onpress=function(b){};C.ondblpress=
function(b){};C.onrelease=function(b){};C.onselection=function(b){};C.onpositionchange=function(b){};return C};this.grapher_waveWorkspace=function(b,e,c,d,f,h,g,m,k,l,p,q,r,u,t,v){g=void 0===g?"Canvas":g;m=void 0===m?!0:m;k=void 0===k?!0:k;l=void 0===l?["fill:rgba(240, 240, 240, 1);","fill:rgba(255, 231, 114, 1);"]:l;q=void 0===q?["stroke:rgba(0,255,0,1); stroke-width:0.1; stroke-linecap:round;"]:q;r=void 0===r?["fill:rgba(0,255,0,1); font-size:3; font-family:Helvetica;"]:r;u=void 0===u?"stroke:rgba(0,100,0,1); stroke-width:0.25;":
u;t=void 0===t?"fill:rgba(0,100,0,1); font-size:3; font-family:Helvetica;":t;v=void 0===v?"fill:rgba(50,50,50,1)":v;var n=part.builder("g",void 0===b?"grapher_waveWorkspace":b,{x:e,y:c});b=part.builder("grapher"+g,"graph",{x:0,y:0,width:d,height:f,style:{foreground:q,foregroundText:r,background:u,backgroundText:t,backing:v}});n.append(b);d=part.builder("needleOverlay","overlay",{x:0,y:0,width:d,height:f,selectNeedle:m,selectionArea:k,needleStyles:l});n.append(d);n.select=d.select;n.area=d.area;n.draw=
b.draw;n.foregroundLineThickness=b.foregroundLineThickness;n.drawBackground=b.drawBackground;n.area=d.area;n._test=b._test;n.genericNeedle=d.genericNeedle;n.onchange=function(b,c){};d.onchange=function(b,c){if(n.onchange)n.onchange(b,c)};n.onrelease=function(b,c){};d.onrelease=function(b,c){if(n.onrelease)n.onrelease(b,c)};n.selectionAreaToggle=function(b){};d.selectionAreaToggle=function(b){n.selectionAreaToggle&&n.selectionAreaToggle(b)};n.drawBackground();return n};this.dial_discrete=function(b,
e,c,d,f,h,g,m,k,l,p,q,r,u,t,v){f=void 0===f?5:f;h=void 0===h?3*Math.PI/4:h;g=void 0===g?1.5*Math.PI:g;m=void 0===m?"fill:rgba(175,175,175,1)":m;k=void 0===k?"fill:rgba(50,50,50,1)":k;l=void 0===l?"fill:rgba(250,100,100,1)":l;p=void 0===p?"fill:rgba(175,175,175,1)":p;q=void 0===q?"fill:rgba(254,255,219,1)":q;r=void 0===r?"fill:rgba(250,100,100,1)":r;u=void 0===u?1.35:u;t=void 0===t?"fill:none; stroke:none;":t;v=void 0===v?"fill:none; stroke:none;":v;var n=part.builder("g",void 0===b?"dial_discrete":
b,{x:e,y:c});n._value=0;n._selection=0;n._data={optionCount:f,mux:4*d};b=[];for(e=0;5>e;e++)c=system.utility.math.polar2cartesian(h+g/5*e,d*u),b.push(c),c=system.utility.math.polar2cartesian(h+g/5*(e+.5),1.11*d*u),b.push(c);c=system.utility.math.polar2cartesian(h+g,d*u);b.push(c);var x=part.builder("path","arc",{path:b,lineType:"Q",style:t});n.appendChild(x);var y=part.builder("circle","slot",{r:1.1*d,style:k});n.appendChild(y);var w=part.builder("circle","slot",{r:d,style:m});n.appendChild(w);u=
d/5;var E=part.builder("rect","needle",{height:u,width:d,style:l});E.x.baseVal.valueInSpecifiedUnits=d/3;E.y.baseVal.valueInSpecifiedUnits=-u/2;n.appendChild(E);n.select=function(b,c,d){b=void 0===b?null:b;c=void 0===c?!0:c;d=void 0===d?!0:d;if(null==b)return this._selection;b=b>this._data.optionCount-1?this._data.optionCount-1:b;b=0>b?0:b;if(this._selection!=b){this._selection=b;this._set(b/(this._data.optionCount-1));if(d&&this.onchange)this.onchange(b);if(d&&!c&&this.onrelease)this.onrelease(value)}};
n._get=function(){return this._value};n._set=function(b){b=1<b?1:b;this._value=b=0>b?0:b;this.children.needle.rotation(h+g*b)};n.glow=function(b){b?(system.utility.element.setStyle(x,v),system.utility.element.setStyle(y,q),system.utility.element.setStyle(w,p),system.utility.element.setStyle(E,r)):(system.utility.element.setStyle(x,t),system.utility.element.setStyle(y,k),system.utility.element.setStyle(w,m),system.utility.element.setStyle(E,l))};n.onchange=function(){};n.onrelease=function(){};n.ondblclick=
function(){this.select(Math.floor(f/2))};n.onwheel=function(b){b=system.mouse.wheelInterpreter(b.deltaY);var c=system.utility.workspace.getGlobalScale(n);n.onwheel.acc||(n.onwheel.acc=0);n.onwheel.acc+=b/c;1<=Math.abs(n.onwheel.acc)&&(this.select(this.select()-1*Math.sign(n.onwheel.acc)),n.onwheel.acc=0)};n.onmousedown=function(b){system.svgElement.onmousemove_old=system.svgElement.onmousemove;system.svgElement.onmouseleave_old=system.svgElement.onmouseleave;system.svgElement.onmouseup_old=system.svgElement.onmouseup;
system.svgElement.tempRef=this;system.svgElement.tempRef._data.initialValue=this._get();system.svgElement.tempRef._data.initialY=b.y;system.svgElement.tempRef._data.mux=system.svgElement.tempRef._data.mux;system.svgElement.onmousemove=function(b){var c=system.svgElement.tempRef._data.mux,d=system.svgElement.tempRef._data.initialValue;b=b.y-system.svgElement.tempRef._data.initialY;var e=system.utility.workspace.getGlobalScale(n);system.svgElement.tempRef.select(Math.round((system.svgElement.tempRef._data.optionCount-
1)*(d-b/(e*c))))};system.svgElement.onmouseup=function(){this.tempRef.select(this.tempRef.select(),!1);this.tempRef=null;system.svgElement.onmousemove=system.svgElement.onmousemove_old;system.svgElement.onmouseleave=system.svgElement.onmouseleave_old;system.svgElement.onmouseup=system.svgElement.onmouseup_old;system.svgElement.onmousemove_old=null;system.svgElement.onmouseleave_old=null;system.svgElement.onmouseup_old=null};system.svgElement.onmouseleave=system.svgElement.onmouseup;system.svgElement.onmousemove(b)};
n._set(0);return n}};this.dynamic=new function(){this.cable=function(b,e,c,d,f,h,g){e=void 0===e?0:e;c=void 0===c?0:c;d=void 0===d?0:d;f=void 0===f?0:f;h=void 0===h?"fill:none; stroke:rgb(255,0,0); stroke-width:4;":h;g=void 0===g?"fill:none; stroke:rgb(255,100,100); stroke-width:4;":g;b=part.builder("g",void 0===b?null:b,{x:e,y:c});b.points=[{x:e,y:c},{x:d,y:f}];b.styles={normal:h,active:g};var m=part.builder("path",null,{path:b.points,lineType:"L",style:h});b.appendChild(m);b.activate=function(){m.style=
this.styles.active};b.disactivate=function(){m.style=this.styles.normal};b.draw=function(b,c,d,e){this.points=[{x:b,y:c},{x:d,y:e}];m.path(this.points)};b.redraw=function(b,c,d,e){b=void 0===b?null:b;c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;b=null!=b?b:this.x1;c=c?c:this.y1;d=null!=d?d:this.x2;e=e?e:this.y2;this.draw(b,c,d,e)};return b};this.connectionNode_audio=function(b,e,c,d,f,h,g,m,k){e=void 0===e?0:e;k=void 0===k?"fill:rgba(255, 220, 220,1)":k;var l=part.builder("g",void 0===
b?"connectionNode_audio":b,{x:c,y:d,r:void 0===g?0:g});l._type="audio";l._cable=null;l._cableStyle="fill:none; stroke:rgb(242, 119, 84); stroke-width:4;";l._cableActiveStyle="fill:none; stroke:rgb(242, 161, 138); stroke-width:4;";l._boundary={width:f,height:h};l._audioNode=m.createAnalyser();l._portType=e;0!=e&&1!=e&&(e=0);b=part.builder("rect","tab",{x:0,y:0,width:f,height:h,style:k});l.appendChild(b);l.onConnect=function(){};l.onDisconnect=function(){};l.out=function(){return this._audioNode};l.in=
function(){return this._audioNode};l.connectTo=function(b){system.super.enablCableDisconnectionConnection&&b._type&&b._type==this._type&&b._portType!=this._portType&&b!=this&&b!=this.foreignNode&&(this.disconnect(),this.foreignNode=b,1==this._portType&&this._audioNode.connect(this.foreignNode._audioNode),this.foreignNode._receiveConnection(this),this._add_cable(),this.onConnect())};l._receiveConnection=function(b){this.disconnect();this.foreignNode=b;1==this._portType&&this._audioNode.connect(this.foreignNode._audioNode);
this.onConnect()};l.disconnect=function(){system.super.enablCableDisconnectionConnection&&this.foreignNode&&(this._remove_cable(),this.foreignNode._receiveDisconnection(),1==this._portType&&this._audioNode.disconnect(this.foreignNode._audioNode),this.foreignNode=null,this.onDisconnect())};l._receiveDisconnection=function(){1==this._portType&&this._audioNode.disconnect(this.foreignNode._audioNode);this.foreignNode=null;this.onDisconnect()};l.onmousedown=function(b){system.svgElement.tempRef=this;system.svgElement.onmouseup=
function(b){b=document.elementFromPoint(b.x,b.y).parentElement;system.svgElement.tempRef.connectTo(b);this.onmouseup=system.svgElement.tempRef=null}};l.ondblclick=function(){this.disconnect()};l._add_cable=function(){this._cable=part.builder("cable",null,{style:{unactive:this._cableStyle,active:this._cableActiveStyle}});this.foreignNode._receive_cable(this._cable);system.utility.workspace.getPane(this).appendChild(this._cable);this.draw()};l._receive_cable=function(b){this._cable=b};l._remove_cable=
function(){system.utility.workspace.getPane(this).removeChild(this._cable);this.foreignNode._lose_cable();this._cable=null};l._lose_cable=function(){this._cable=null};l.draw=function(){if(l._cable){var b=system.utility.element.getCumulativeTransform(this),c=system.utility.element.getCumulativeTransform(this.foreignNode);this._cable.draw(b.x+this._boundary.width/2,b.y+this._boundary.height/2,c.x+this.foreignNode._boundary.width/2,c.y+this.foreignNode._boundary.height/2)}};l.redraw=function(){if(l._cable){var b=
system.utility.element.getCumulativeTransform(this),c=system.utility.element.getCumulativeTransform(this.foreignNode);this._cable.redraw(b.x+this._boundary.width/2,b.y+this._boundary.height/2,c.x+this.foreignNode._boundary.width/2,c.y+this.foreignNode._boundary.height/2)}};return l};this.connectionNode_data=function(b,e,c,d,f,h,g,m){h=void 0===h?0:h;g=void 0===g?"fill:rgba(220, 244, 255,1)":g;m=void 0===m?"fill:rgba(244, 244, 255, 1)":m;var k=part.builder("g",void 0===b?"connectionNode_data":b,{x:e,
y:c,r:h});k._type="data";k._rotation=h;k._cable=null;k._cableStyle="fill:none; stroke:rgb(84, 146, 247); stroke-width:4;";k._cableActiveStyle="fill:none; stroke:rgb(123, 168, 242); stroke-width:4;";k._boundary={width:d,height:f};var l=part.builder("rect","tab",{x:0,y:0,width:d,height:f,style:g});k.appendChild(l);k.send=function(b,c){c=void 0===c?null:c;k.activate();setTimeout(function(){k&&(k.disactivate(),k._cable&&(k._cable.disactivate(),k.foreignNode.disactivate()))},100);k.foreignNode&&(k.foreignNode.receive&&
k.foreignNode.receive(b,c),k._cable.activate(),k.foreignNode.activate())};k.receive=function(b,c){};k.request=function(b){if(this.foreignNode)return this.foreignNode.give(b)};k.give=function(b){};k.onConnect=function(){};k.onDisconnect=function(){};k.activate=function(){system.utility.element.setStyle(l,m)};k.disactivate=function(){system.utility.element.setStyle(l,g)};k.connectTo=function(b){system.super.enablCableDisconnectionConnection&&b._type&&b._type==this._type&&b!=this&&b!=this.foreignNode&&
(this.disconnect(),this.foreignNode=b,this.foreignNode._receiveConnection(this),this._add_cable(),this.onConnect(),this.foreignNode.onConnect())};k._receiveConnection=function(b){this.disconnect();this.foreignNode=b};k.disconnect=function(){system.super.enablCableDisconnectionConnection&&this.foreignNode&&(this._remove_cable(),this.foreignNode._receiveDisconnection(),this.foreignNode=null,this.onDisconnect())};k._receiveDisconnection=function(){this.foreignNode=null;this.onDisconnect()};k.onmousedown=
function(b){system.svgElement.tempRef=this;system.svgElement.onmouseup=function(b){b=document.elementFromPoint(b.x,b.y).parentElement;system.svgElement.tempRef.connectTo(b);this.onmouseup=system.svgElement.tempRef=null}};k.ondblclick=function(){this.disconnect()};k._add_cable=function(){this._cable=part.builder("cable",null,{style:{unactive:this._cableStyle,active:this._cableActiveStyle}});this.foreignNode._receive_cable(this._cable);system.utility.workspace.getPane(this).appendChild(this._cable);
this.draw()};k._receive_cable=function(b){this._cable=b};k._remove_cable=function(){system.utility.workspace.getPane(this).removeChild(this._cable);this.foreignNode._lose_cable();this._cable=null};k._lose_cable=function(){this._cable=null};k.draw=function(){if(k._cable){var b=system.utility.element.getCumulativeTransform(this),c=system.utility.element.getCumulativeTransform(this.foreignNode),d={x:this._boundary.width/2,y:this._boundary.height/2},e={x:this.foreignNode._boundary.width/2,y:this.foreignNode._boundary.height/
2};if(0!=this._rotation){var f=system.utility.math.cartesian2polar(d.x,d.y);f.ang+=this._rotation;d=system.utility.math.polar2cartesian(f.ang,f.dis)}0!=this.foreignNode._rotation&&(f=system.utility.math.cartesian2polar(e.x,e.y),f.ang+=this.foreignNode._rotation,e=system.utility.math.polar2cartesian(f.ang,f.dis));this._cable.draw(b.x+d.x,b.y+d.y,c.x+e.x,c.y+e.y)}};k.redraw=function(){if(k._cable){var b=system.utility.element.getCumulativeTransform(this),c=system.utility.element.getCumulativeTransform(this.foreignNode),
d={x:this._boundary.width/2,y:this._boundary.height/2},e={x:this.foreignNode._boundary.width/2,y:this.foreignNode._boundary.height/2};if(0!=this._rotation){var f=system.utility.math.cartesian2polar(d.x,d.y);f.ang+=this._rotation;d=system.utility.math.polar2cartesian(f.ang,f.dis)}0!=this.foreignNode._rotation&&(f=system.utility.math.cartesian2polar(e.x,e.y),f.ang+=this.foreignNode._rotation,e=system.utility.math.polar2cartesian(f.ang,f.dis));this._cable.draw(b.x+d.x,b.y+d.y,c.x+e.x,c.y+e.y)}};return k}}}};
part.builder=function(b,e,c){c||(c={});switch(b){case "g":return part.element.basic.g(e,c.x,c.y,c.r,c.style);case "line":return part.element.basic.line(e,c.x1,c.y1,c.x2,c.y2,c.style);case "rect":return part.element.basic.rect(e,c.x,c.y,c.width,c.height,c.angle,c.style);case "path":return part.element.basic.path(e,c.path,c.lineType,c.style);case "text":return part.element.basic.text(e,c.x,c.y,c.text,c.angle,c.style);case "circle":return part.element.basic.circle(e,c.x,c.y,c.r,c.angle,c.style);case "canvas":return part.element.basic.canvas(e,
c.x,c.y,c.width,c.height,c.angle,c.resolution)}void 0==c.style&&(c.style={});switch(b){default:return console.warn("Unknown element: "+b),null;case "label":return part.element.display.label(e,c.x,c.y,c.text,c.style,c.angle);case "level":return part.element.display.level(e,c.x,c.y,c.angle,c.width,c.height,c.style.backing,c.style.level);case "meter_level":return part.element.display.meter_level(e,c.x,c.y,c.angle,c.width,c.height,c.markings,c.style.backing,c.style.levels,c.style.marking);case "audio_meter_level":return part.element.display.audio_meter_level(e,
c.x,c.y,c.angle,c.width,c.height,c.markings,c.style.backing,c.style.levels,c.style.marking);case "sevenSegmentDisplay":return part.element.display.sevenSegmentDisplay(e,c.x,c.y,c.width,c.height,c.style.background,c.style.glow,c.style.dim);case "sixteenSegmentDisplay":return part.element.display.sixteenSegmentDisplay(e,c.x,c.y,c.width,c.height,c.style.background,c.style.glow,c.style.dim);case "readout_sixteenSegmentDisplay":return part.element.display.readout_sixteenSegmentDisplay(e,c.x,c.y,c.width,
c.height,c.count,c.angle,c.style.background,c.style.glow,c.style.dime);case "rastorDisplay":return part.element.display.rastorDisplay(e,c.x,c.y,c.width,c.height,c.xCount,c.yCount,c.xGappage,c.yGappage);case "glowbox_rect":return part.element.display.glowbox_rect(e,c.x,c.y,c.width,c.height,c.angle,c.style.glow,c.style.dim);case "grapherSVG":return part.element.display.grapherSVG(e,c.x,c.y,c.width,c.height,c.style.foreground,c.style.foregroundText,c.style.background,c.style.backgroundText,c.style.backing);
case "grapherCanvas":return part.element.display.grapherCanvas(e,c.x,c.y,c.width,c.height,c.style.foreground,c.style.foregroundText,c.style.background,c.style.backgroundText,c.style.backing);case "grapher_periodicWave":return part.element.display.grapher_periodicWave(e,c.x,c.y,c.width,c.height,c.graphType,c.style.foreground,c.style.foregroundText,c.style.background,c.style.backgroundText,c.style.backing);case "grapher_audioScope":return part.element.display.grapher_audioScope(e,c.x,c.y,c.width,c.height,
c.graphType,c.style.foreground,c.style.foregroundText,c.style.background,c.style.backgroundText,c.style.backing);case "button_rect":return b=part.element.control.button_rect(e,c.x,c.y,c.width,c.height,c.angle,c.text?c.text:c.text_centre,c.text_left,c.text_right,c.textVerticalOffset,c.textHorizontalOffset,c.active,c.hoverable,c.selectable,c.pressable,c.style.text,c.style.off,c.style.up,c.style.press,c.style.select,c.style.select_press,c.style.glow,c.style.glow_press,c.style.glow_select,c.style.glow_select_press,
c.style.hover,c.style.hover_press,c.style.hover_select,c.style.hover_select_press,c.style.hover_glow,c.style.hover_glow_press,c.style.hover_glow_select,c.style.hover_glow_select_press),b.onpress=c.onpress?c.onpress:b.onpress,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b.ondblpress=c.ondblpress?c.ondblpress:b.ondblpress,b.onenter=c.onenter?c.onenter:b.onenter,b.onleave=c.onleave?c.onleave:b.onleave,b.onselect=c.onselect?c.onselect:b.onselect,b.ondeselect=c.ondeselect?c.ondeselect:b.ondeselect,
b;case "checkbox_rect":return b=part.element.control.checkbox_rect(e,c.x,c.y,c.width,c.height,c.angle,c.style.check,c.style.backing,c.style.checkGlow,c.style.backingGlow),b.onchange=c.onchange?c.onchange:b.onchange,b;case "slide":return b=part.element.control.slide(e,c.x,c.y,c.width,c.height,c.angle,c.handleHeight,c.value,c.resetValue,c.style.handle,c.style.backing,c.style.slot,c.style.invisibleHandle),b.onchange=c.onchange?c.onchange:b.onchange,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b;case "slidePanel":return b=
part.element.control.slidePanel(e,c.x,c.y,c.width,c.height,c.count,c.angle,c.handleHeight,c.value,c.resetValue,c.style.handle,c.style.backing,c.style.slot),b.onchange=c.onchange?c.onchange:b.onchange,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b;case "rangeslide":return b=part.element.control.rangeslide(e,c.x,c.y,c.width,c.height,c.angle,c.handleHeight,c.spanWidth,c.values,c.resetValues,c.style.handle,c.style.backing,c.style.slot,c.style.invisibleHandle,c.style.span),b.onchange=c.onchange?c.onchange:
b.onchange,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b;case "dial_continuous":return b=part.element.control.dial_continuous(e,c.x,c.y,c.r,c.startAngle,c.maxAngle,c.style.handle,c.style.slot,c.style.needle,c.style.handle_glow,c.style.slot_glow,c.style.needle_glow,c.arcDistance,c.style.outerArc,c.style.outerArc_glow),b.onchange=c.onchange?c.onchange:b.onchange,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b;case "dial_discrete":return b=part.element.control.dial_discrete(e,c.x,c.y,c.r,c.optionCount,
c.startAngle,c.maxAngle,c.style.handle,c.style.slot,c.style.needle,c.style.handle_glow,c.style.slot_glow,c.style.needle_glow,c.arcDistance,c.style.outerArc,c.style.outerArc_glow),b.onchange=c.onchange?c.onchange:b.onchange,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b;case "rastorgrid":return b=part.element.control.rastorgrid(e,c.x,c.y,c.width,c.height,c.xCount,c.yCount,c.style.backing,c.style.check,c.style.backingGlow,c.style.checkGlow),b.onchange=c.onchange?c.onchange:b.onchange,b;case "sequencer":return b=
part.element.control.sequencer(e,c.x,c.y,c.width,c.height,c.angle,c.xCount,c.yCount,c.zoomLevel_x,c.zoomLevel_y,c.style.backing,c.style.selectionArea,c.style.block_body,c.style.block_bodyGlow,c.style.block_handle,c.style.block_handleWidth,c.style.horizontalStrip_pattern,c.style.horizontalStrip_glow,c.style.horizontalStrip_styles,c.style.verticalStrip_pattern,c.style.verticalStrip_glow,c.style.verticalStrip_styles,c.style.playhead),b.onpan=c.onpan?c.onpan:b.onpan,b.onchangeviewarea=c.onchangeviewarea?
c.onchangeviewarea:b.onchangeviewarea,b.event=c.event?c.event:b.event,b;case "needleOverlay":return b=part.element.control.needleOverlay(e,c.x,c.y,c.width,c.height,c.angle,c.needleWidth,c.selectNeedle,c.selectionArea,c.needleStyles),b.onchange=c.onchange?c.onchange:b.onchange,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b.selectionAreaToggle=c.selectionAreaToggle?c.selectionAreaToggle:b.selectionAreaToggle,b;case "grapher_waveWorkspace":return b=part.element.control.grapher_waveWorkspace(e,c.x,
c.y,c.width,c.height,c.angle,c.graphType,c.selectNeedle,c.selectionArea,c.style.foreground,c.style.foregroundText,c.style.middleground,c.style.middlegroundText,c.style.background,c.style.backgroundText),b.onchange=c.onchange?c.onchange:b.onchange,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b.selectionAreaToggle=c.selectionAreaToggle?c.selectionAreaToggle:b.selectionAreaToggle,b;case "list":return b=part.element.control.list(e,c.x,c.y,c.width,c.height,c.angle,c.list,c.selectable,c.multiSelect,
c.hoverable,c.pressable,c.active,c.itemHeightMux,c.itemSpacingMux,c.breakHeightMux,c.breakWidthMux,c.spaceHeightMux,c.itemTextVerticalOffsetMux,c.itemTextHorizontalOffsetMux,c.style.listItemText,c.style.backing,c.style.break,c.style.background_off,c.style.background_up,c.style.background_press,c.style.background_select,c.style.background_select_press,c.style.background_glow,c.style.background_glow_press,c.style.background_glow_select,c.style.background_glow_select_press,c.style.background_hover,c.style.background_hover_press,
c.style.background_hover_select,c.style.background_hover_select_press,c.style.background_hover_glow,c.style.background_hover_glow_press,c.style.background_hover_glow_select,c.style.background_hover_glow_select_press),b.onenter=c.onenter?c.onenter:b.onenter,b.onleave=c.onleave?c.onleave:b.onleave,b.onpress=c.onpress?c.onpress:b.onpress,b.ondblpress=c.ondblpress?c.ondblpress:b.ondblpress,b.onrelease=c.onrelease?c.onrelease:b.onrelease,b.onselection=c.onselection?c.onselection:b.onselection,b.onpositionchange=
c.onpositionchange?c.onpositionchange:b.onpositionchange,b;case "cable":return part.element.dynamic.cable(e,c.x1,c.y1,c.x2,c.y2,c.style.unactive,c.style.active);case "connectionNode_audio":return 0==Object.keys(c.style).length&&(c.style=void 0),part.element.dynamic.connectionNode_audio(e,c.type,c.x,c.y,c.width,c.height,c.angle,system.audio.context,c.style);case "connectionNode_data":return 0==Object.keys(c.style).length&&(c.style=void 0),b=part.element.dynamic.connectionNode_data(e,c.x,c.y,c.width,
c.height,c.angle,c.style),b.receive=c.receive?c.receive:b.receive,b.give=c.give?c.give:b.give,b}};var object=new function(){this.audio_duplicator=function(b,e){b={type:"audio_duplicator",x:b,y:e,base:{points:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,0);"},elements:[{type:"connectionNode_audio",name:"input",data:{type:0,x:45,y:5,width:20,height:20}},{type:"connectionNode_audio",name:"output_1",data:{type:1,x:-10,y:5,width:20,height:20}},{type:"connectionNode_audio",
name:"output_2",data:{type:1,x:-10,y:30,width:20,height:20}},{type:"path",name:"backing",data:{path:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1);pointer-events:none;"}},{type:"path",name:"upperArrow",data:{path:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"path",name:"lowerArrow",data:{path:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"topHorizontal",
data:{x:5,y:15,width:45,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}}]};e=object.builder(object.audio_duplicator,b);b.connectionNode_audio.input.out().connect(b.connectionNode_audio.output_1.in());b.connectionNode_audio.input.out().connect(b.connectionNode_audio.output_2.in());
return e};this.audio_duplicator.metadata={name:"Audio Duplicator",helpurl:"https://metasophiea.com/curve/help/objects/audioDuplicator/"};this.filterUnit=function(b,e){function c(){for(var b=[],c=[],d=0;d<=Math.floor(Math.log10(f.freqRange.high))+1;d++)for(var e=1;10>e&&!(e/10*Math.pow(10,d)>=f.freqRange.high);e+=1/Math.pow(2,f.graphDetail))b.push(Math.log10(Math.pow(10,d)*e)),c.push(e/10*Math.pow(10,d));return{frequency:c,location:system.utility.math.normalizeStretchArray(b)}}function d(){var b=c();
h.grapherCanvas.graph.draw(g.filterCircuit.measureFrequencyResponse_values(b.frequency)[0],b.location)}var f={freqRange:{low:.1,high:2E4},graphDetail:3},h={type:"filterUnit",x:b,y:e,base:{points:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},{x:0,y:70}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioIn",data:{type:0,x:94.8,y:16,width:10,height:20,angle:-.14}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-2.3,y:16,width:10,
height:20,angle:.144}},{type:"grapherCanvas",name:"graph",data:{x:15,y:5,width:72.5,height:50,style:{foreground:["stroke:rgba(0,200,163,1); stroke-width:0.5; stroke-linecap:round;"],background:"stroke:rgba(0,200,163,0.25); stroke-width:0.25;",backgroundText:"fill:rgba(0,200,163,0.75); font-size:1; font-family:Helvetica;"}}},{type:"label",name:"Q_0",data:{x:74,y:76,text:"0",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"Q_1/2",data:{x:79.5,y:59.5,text:"1/2",
style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"Q_1",data:{x:89,y:76,text:"1",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"Q_title",data:{x:81,y:79,text:"Q",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"Q",data:{x:82.5,y:68.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",
needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:0.5;"},onchange:function(b){g.filterCircuit.Q(10*b);d()}}},{type:"label",name:"gain_0",data:{x:54,y:86,text:"0",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"gain_1/2",data:{x:61.5,y:68.5,text:"5",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},{type:"label",name:"gain_1",data:{x:69,y:86,text:"10",style:"fill:rgba(0,0,0,1); font-size:3px; font-family:Courier New;"}},
{type:"label",name:"gain_title",data:{x:58,y:89,text:"Gain",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"gain",data:{x:62.5,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:0.5;"},onchange:function(b){g.filterCircuit.gain(10*b);d()}}},{type:"label",name:"frequency_0",
data:{x:31.5,y:86,text:"0",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"frequency_100",data:{x:38.25,y:68.5,text:"100",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"frequency_20000",data:{x:46.5,y:86,text:"20000",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"frequency_title",data:{x:35.5,y:89,text:"Freq",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_continuous",name:"frequency",data:{x:40,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:0.5;"},onchange:function(b){g.filterCircuit.frequency(system.utility.math.curvePoint.exponential(b,0,2E4,10.5866095));d()}}},{type:"label",name:"type_lowp",data:{x:10,y:74.5,text:"lowp",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},
{type:"label",name:"type_highp",data:{x:5,y:69,text:"highp",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_band",data:{x:8,y:63,text:"band",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_lows",data:{x:14,y:59,text:"lows",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_highs",data:{x:22.5,y:59.5,text:"highs",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},
{type:"label",name:"type_peak",data:{x:27.5,y:63,text:"peak",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_notch",data:{x:29,y:69,text:"notch",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_all",data:{x:25.5,y:74.5,text:"all",style:"fill:rgba(0,0,0,1); font-size:2px; font-family:Courier New;"}},{type:"label",name:"type_title",data:{x:15.5,y:78.5,text:"Type",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_discrete",name:"type",data:{x:20,y:67.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,optionCount:8,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(b){g.filterCircuit.type("lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ")[b]);d()}}}]},g=object.builder(object.filterUnit,h);g.importData=function(b){h.dial_continuous.Q.set(b.Q);h.dial_continuous.gain.set(b.gain);h.dial_discrete.type.select(b.type);
h.dial_continuous.frequency.set(b.frequency)};g.exportData=function(){return{Q:h.dial_continuous.Q.get(),gain:h.dial_continuous.gain.get(),type:h.dial_discrete.type.select(),frequency:h.dial_continuous.frequency.get()}};g.filterCircuit=new part.circuit.audio.filterUnit(system.audio.context);h.connectionNode_audio.audioIn.out().connect(g.filterCircuit.in());g.filterCircuit.out().connect(h.connectionNode_audio.audioOut.in());b=c();b.frequency=b.frequency.filter(function(b,c){return 0==c%Math.pow(2,
f.graphDetail)});b.location=b.location.filter(function(b,c){return 0==c%Math.pow(2,f.graphDetail)});h.grapherCanvas.graph.viewbox({bottom:0,top:2});h.grapherCanvas.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});h.grapherCanvas.graph.verticalMarkings({points:b.location,printingValues:b.frequency.map(function(b){return 0==Math.log10(b)%1?b:""}).slice(0,b.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});h.grapherCanvas.graph.drawBackground();
h.dial_discrete.type.select(0);h.dial_continuous.Q.set(0);h.dial_continuous.gain.set(.1);h.dial_continuous.frequency.set(.5);setTimeout(d,100);return g};this.filterUnit.metadata={name:"Filter Unit",helpurl:"https://metasophiea.com/curve/help/objects/filterUnit/"};this.reverbUnit=function(b,e){function c(b){0==d.availableTypes.length?console.log("broken or not yet ready"):(b>=d.availableTypes.length?b=d.availableTypes.length-1:0>b&&(b=0),d.reverbTypeSelected=b,h.reverbCircuit.type(d.availableTypes[b],
function(){var b=d.reverbTypeSelected;b=("0"+b).slice(-2);f.sevenSegmentDisplay.ones.enterCharacter(b[0]);f.sevenSegmentDisplay.tens.enterCharacter(b[1])}))}var d={reverbTypeSelected:0,availableTypes:[]},f={type:"reverbUnit",x:b,y:e,base:{points:[{x:0,y:10},{x:51.25,y:0},{x:102.5,y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioIn",data:{type:0,x:102.5,y:16,width:10,height:20}},{type:"connectionNode_audio",
name:"audioOut",data:{type:1,x:-10,y:16,width:10,height:20}},{type:"label",name:"outGain_0",data:{x:7,y:39,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"outGain_1/2",data:{x:16.5,y:10,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"outGain_1",data:{x:30,y:39,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"outGain",data:{x:20,y:25,r:12,
startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){h.reverbCircuit.outGain(b)}}},{type:"label",name:"wetdry_1/2",data:{x:66.5,y:39,text:"wet",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"wetdry_1",data:{x:92.5,y:39,text:"dry",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_continuous",name:"wetdry",data:{x:82.5,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){h.reverbCircuit.wetdry(1-b)}}},{type:"button_rect",name:"raiseByOne",data:{x:51,y:6,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},
onpress:function(){c(d.reverbTypeSelected+1)}}},{type:"button_rect",name:"raiseByTen",data:{x:38.75,y:6,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){c(d.reverbTypeSelected+10)}}},{type:"button_rect",name:"lowerByOne",data:{x:51,y:39,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){c(d.reverbTypeSelected-
1)}}},{type:"button_rect",name:"lowerByTen",data:{x:38.75,y:39,width:10.25,height:5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){c(d.reverbTypeSelected-10)}}},{type:"sevenSegmentDisplay",name:"tens",data:{x:50,y:12.5,width:12.5,height:25}},{type:"sevenSegmentDisplay",name:"ones",data:{x:37.5,y:12.5,width:12.5,height:25}}]},h=object.builder(object.reverbUnit,f);h.importData=function(b){d.reverbTypeSelected=b.selectedType;
f.dial_continuous.wetdry.set(b.wetdry);f.dial_continuous.outGain.set(b.outGain)};h.exportData=function(){return{selectedType:d.reverbTypeSelected,wetdry:f.dial_continuous.wetdry.get(),outGain:f.dial_continuous.outGain.get()}};h.reverbCircuit=new part.circuit.audio.reverbUnit(system.audio.context);f.connectionNode_audio.audioIn.out().connect(h.reverbCircuit.in());h.reverbCircuit.out().connect(f.connectionNode_audio.audioOut.in());h.reverbCircuit.getTypes(function(b){d.availableTypes=b});h.i={gain:function(b){f.dial_continuous.outGain.set(b)},
wetdry:function(b){f.dial_continuous.wetdry.set(b)}};f.dial_continuous.outGain.set(.5);f.dial_continuous.wetdry.set(.5);setTimeout(function(){c(d.reverbTypeSelected)},1E3);return h};this.reverbUnit.metadata={name:"Reverb Unit",helpurl:"https://metasophiea.com/curve/help/objects/reverbUnit/"};this.multibandFilter=function(b,e,c){function d(){for(var b=[],c=[],d=0;d<=Math.floor(Math.log10(h.freqRange.high))+1;d++)for(var e=1;10>e&&!(e/10*Math.pow(10,d)>=h.freqRange.high);e+=1/Math.pow(2,h.graphDetail))b.push(Math.log10(Math.pow(10,
d)*e)),c.push(e/10*Math.pow(10,d));return{frequency:c,location:system.utility.math.normalizeStretchArray(b)}}function f(b){if(h.allowUpdate){var c=d();if(void 0==b){var e=l.filterCircuit_0.measureFrequencyResponse(void 0,c.frequency);for(b=0;b<h.channelCount;b++)m.grapherSVG.graph.draw(e[b][0],c.location,b)}else e=l.filterCircuit_0.measureFrequencyResponse(b,c.frequency),m.grapherSVG.graph.draw(e[0],c.location,b)}}var h={allowUpdate:!1,freqRange:{low:.1,high:2E4},graphDetail:2,channelCount:8,masterGain:1,
gain:[],Q:[],frequency:[],curvePointExponentialSharpness:10.586609649448985,defaultValues:{gain:[.5,.5,.5,.5,.5,.5,.5,.5],Q:[0,.09,.09,.09,.09,.09,.09,0],frequency:[.41416,.479046,.565238,.630592,.717072,.803595,.91345175,.93452845]}};c="fill:rgba(0,200,163,  0.25);  pointer-events:none;{fill:rgba(100,235,131,0.25); pointer-events:none;{fill:rgba(228,255,26, 0.25); pointer-events:none;{fill:rgba(232,170,20, 0.25); pointer-events:none;{fill:rgba(255,87,20,  0.25); pointer-events:none;{fill:rgba(0,191,255,  0.25); pointer-events:none;{fill:rgba(249,99,202, 0.25); pointer-events:none;{fill:rgba(255,255,255,0.25); pointer-events:none;".split("{");
for(var g={handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",arc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},m={type:"multibandFilter",x:b,y:e,base:{points:[{x:0,y:10},{x:10,y:0},{x:185,y:0},{x:195,y:10},{x:195,y:245},{x:185,y:255},{x:10,y:255},{x:0,y:245},{x:0,y:75},{x:-25,y:65},{x:-25,y:10}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioIn_0",data:{type:0,x:195,y:15,width:10,height:20}},
{type:"connectionNode_audio",name:"audioIn_1",data:{type:0,x:195,y:40,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut_0",data:{type:1,x:-35,y:15,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut_1",data:{type:1,x:-35,y:40,width:10,height:20}},{type:"dial_continuous",name:"masterGain",data:{x:-10,y:37.5,r:10,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,style:{handle:g.handle,slot:g.slot,needle:g.needle,outerArc:g.markings},onchange:function(b){return function(b){h.masterGain=
2*b;l.filterCircuit_0.masterGain(h.masterGain);l.filterCircuit_1.masterGain(h.masterGain);f()}}(k)}},{type:"grapherSVG",name:"graph",data:{x:10,y:10,width:175,height:75,style:{foreground:"stroke:rgba(0,200,163,1); stroke-width:0.5; stroke-linecap:round;{stroke:rgba(100,235,131,1); stroke-width:0.5; stroke-linecap:round;{stroke:rgba(228,255,26,1); stroke-width:0.5; stroke-linecap:round;{stroke:rgba(232,170,20,1); stroke-width:0.5; stroke-linecap:round;{stroke:rgba(255,87,20,1); stroke-width:0.5; stroke-linecap:round;{stroke:rgba(0,191,255,1); stroke-width:0.5; stroke-linecap:round;{stroke:rgba(249,99,202,1); stroke-width:0.5; stroke-linecap:round;{stroke:rgba(255,255,255,1); stroke-width:0.5; stroke-linecap:round;".split("{"),
background:"stroke:rgba(0,200,163,0.25); stroke-width:0.25;",backgroundText:"fill:rgba(0,200,163,0.75); font-size:1; font-family:Helvetica;"}}}]},k=0;k<h.channelCount;k++)m.elements.push({type:"rect",name:"backing_"+k,data:{x:13.75+22*k,y:87.5,width:12.5,height:157.5,style:c[k]}},{type:"slide",name:"gainSlide_"+k,data:{x:15+22*k,y:90,width:10,height:80,angle:0,handleHeight:.05,resetValue:.5,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,0)",slot:"fill:rgba(50,50,50,1)"},onchange:function(b){return function(c){h.gain[b]=
2*(1-c);l.filterCircuit_0.gain(b,h.gain[b]);l.filterCircuit_1.gain(b,h.gain[b]);f(b)}}(k)}},{type:"dial_continuous",name:"qDial_"+k,data:{x:20+22*k,y:180,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,style:{handle:g.handle,slot:g.slot,needle:g.needle,outerArc:g.markings},onchange:function(b){return function(c){h.Q[b]=c;l.filterCircuit_0.Q(b,system.utility.math.curvePoint.exponential(h.Q[b],0,2E4,h.curvePointExponentialSharpness));l.filterCircuit_1.Q(b,system.utility.math.curvePoint.exponential(h.Q[b],
0,2E4,h.curvePointExponentialSharpness));f(b)}}(k)}},{type:"dial_continuous",name:"frequencyDial_"+k,data:{x:20+22*k,y:200,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,style:{handle:g.handle,slot:g.slot,needle:g.needle,outerArc:g.markings},onchange:function(b){return function(c){h.frequency[b]=c;m.readout_sixteenSegmentDisplay["frequencyReadout_"+b].text(system.utility.misc.padString(system.utility.math.curvePoint.exponential(c,0,2E4,h.curvePointExponentialSharpness).toFixed(2),
8));m.readout_sixteenSegmentDisplay["frequencyReadout_"+b].print("smart");l.filterCircuit_0.frequency(b,system.utility.math.curvePoint.exponential(h.frequency[b],0,2E4,h.curvePointExponentialSharpness));l.filterCircuit_1.frequency(b,system.utility.math.curvePoint.exponential(h.frequency[b],0,2E4,h.curvePointExponentialSharpness));f(b)}}(k)}},{type:"readout_sixteenSegmentDisplay",name:"frequencyReadout_"+k,data:{x:25+22*k,y:212.5,width:30,height:10,count:8,angle:Math.PI/2}});var l=object.builder(object.multibandFilter,
m);l.exportData=function(){return{masterGain:h.masterGain,freqRange:h.freqRange,channelCount:h.channelCount,gain:h.gain,Q:h.Q,frequency:h.frequency}};l.importData=function(b){};l.filterCircuit_0=new part.circuit.audio.multibandFilter(system.audio.context,h.channelCount,!0);l.filterCircuit_1=new part.circuit.audio.multibandFilter(system.audio.context,h.channelCount,!0);m.connectionNode_audio.audioIn_0.out().connect(l.filterCircuit_0.in());m.connectionNode_audio.audioIn_1.out().connect(l.filterCircuit_1.in());
l.filterCircuit_0.out().connect(m.connectionNode_audio.audioOut_0.in());l.filterCircuit_1.out().connect(m.connectionNode_audio.audioOut_1.in());l.i={gain:function(b,c){if(void 0==c)return m.slide["gainSlide_"+b].get(c);m.slide["gainSlide_"+b].set(c)},Q:function(b,c){if(void 0==c)return m.dial_continuous["qDial_"+b].get(c);m.dial_continuous["qDial_"+b].set(c)},frequency:function(b,c){if(void 0==c)return m.dial_continuous["frequencyDial_"+b].get(c);m.dial_continuous["frequencyDial_"+b].set(c)},reset:function(b){if(void 0==
b){for(b=0;b<h.channelCount;b++)l.i.reset(b);m.dial_continuous.masterGain.set(.5)}else for(b=0;b<h.channelCount;b++)m.slide["gainSlide_"+b].set(h.defaultValues.gain[b]),m.dial_continuous["qDial_"+b].set(h.defaultValues.Q[b]),m.dial_continuous["frequencyDial_"+b].set(h.defaultValues.frequency[b])}};b=d();b.frequency=b.frequency.filter(function(b,c){return 0==c%Math.pow(2,h.graphDetail)});b.location=b.location.filter(function(b,c){return 0==c%Math.pow(2,h.graphDetail)});m.grapherSVG.graph.viewbox({bottom:0,
top:2});m.grapherSVG.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});m.grapherSVG.graph.verticalMarkings({points:b.location,printingValues:b.frequency.map(function(b){return 0==Math.log10(b)%1?b:""}).slice(0,b.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});m.grapherSVG.graph.drawBackground();l.i.reset();h.allowUpdate=!0;f();return l};this.multibandFilter.metadata={name:"Multiband Filter",helpurl:"https://metasophiea.com/curve/help/objects/multibandFilter/"};
this.distortionUnit=function(b,e){var c={type:"distortionUnit",x:b,y:e,base:{points:[{x:0,y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,y:10},{x:102.5*.55,y:10},{x:102.5/3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioIn",data:{type:0,x:102.5,y:61.5,width:10,height:20}},{type:"connectionNode_audio",
name:"audioOut",data:{type:1,x:-10,y:61.5,width:10,height:20}},{type:"label",name:"outGain_title",data:{x:17.5,y:91,text:"out",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"outGain_0",data:{x:9.5,y:85.5,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"outGain_1/2",data:{x:19,y:57,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"outGain_1",data:{x:33,y:85.5,
text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"outGain",data:{x:22.5,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.distortionCircuit.outGain(b)}}},{type:"label",name:"distortionAmount_title",data:{x:15.5,y:41.5,text:"dist",
style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"distortionAmount_0",data:{x:9.5,y:36,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"distortionAmount_50",data:{x:20,y:7.5,text:"50",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"distortionAmount_100",data:{x:33,y:36,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",
name:"distortionAmount",data:{x:22.5,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.distortionCircuit.distortionAmount(100*b)}}},{type:"label",name:"resolution_title",data:{x:47,y:66,text:"res",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"resolution_2",
data:{x:39,y:60,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"resolution_50",data:{x:49,y:32,text:"500",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"resolution_100",data:{x:63,y:60,text:"1000",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"resolution",data:{x:52.5,y:47.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",
slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.distortionCircuit.resolution(Math.round(1E3*b))}}},{type:"label",name:"overSample_title",data:{x:67,y:41.5,text:"overSamp",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"overSample_0",data:{x:61,y:12,text:"none",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"overSample_50",
data:{x:77.5,y:7.5,text:"2x",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"overSample_100",data:{x:90.5,y:12,text:"4x",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_discrete",name:"overSample",data:{x:80,y:23,r:12,startAngle:1.25*Math.PI,maxAngle:.5*Math.PI,arcDistance:1.35,optionCount:3,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(b){d.distortionCircuit.oversample(["none",
"2x","4x"][b])}}},{type:"label",name:"inGain_title",data:{x:76,y:91,text:"in",style:"fill:rgba(0,0,0,1); font-size:6px; font-family:Courier New;"}},{type:"label",name:"inGain_0",data:{x:67,y:85.5,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"inGain_1/2",data:{x:76.5,y:57,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"inGain_1",data:{x:90.5,y:85.5,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"dial_continuous",name:"inGain",data:{x:80,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.distortionCircuit.inGain(2*b)}}}]},d=object.builder(object.distortionUnit,c);d.importData=function(b){c.dial_continuous.outGain.set(b.outGain);c.dial_continuous.distortionAmount.set(b.distortionAmount);
c.dial_continuous.resolution.set(b.resolution);c.dial_discrete.overSample.select(b.overSample);c.dial_continuous.inGain.set(b.inGain)};d.exportData=function(){return{outGain:c.dial_continuous.outGain.get(),distortionAmount:c.dial_continuous.distortionAmount.get(),resolution:c.dial_continuous.resolution.get(),overSample:c.dial_discrete.overSample.select(),inGain:c.dial_continuous.inGain.get()}};d.distortionCircuit=new part.circuit.audio.distortionUnit(system.audio.context);c.connectionNode_audio.audioIn.out().connect(d.distortionCircuit.in());
d.distortionCircuit.out().connect(c.connectionNode_audio.audioOut.in());c.dial_continuous.resolution.set(.5);c.dial_continuous.inGain.set(.5);c.dial_continuous.outGain.set(1);return d};this.distortionUnit.metadata={name:"Distortion Unit",helpurl:"https://metasophiea.com/curve/help/objects/distortionUnit/"};this.audio_sink=function(b,e){var c={background:"fill:rgba(200,200,200,1)",level:{backing:"fill:rgb(10,10,10)",levels:["fill:rgb(250,250,250);","fill:rgb(200,200,200);"],marking:"fill:rgba(220,220,220,1); stroke:none; font-size:1px; font-family:Courier New;"}};
b={type:"audio_sink",x:b,y:e,base:{points:[{x:0,y:0},{x:100,y:0},{x:100,y:55},{x:0,y:55}],style:c.background},elements:[{type:"connectionNode_audio",name:"right",data:{type:0,x:90,y:5,width:20,height:20}},{type:"connectionNode_audio",name:"left",data:{type:0,x:90,y:30,width:20,height:20}},{type:"audio_meter_level",name:"right",data:{x:10,y:5,width:5,height:45,style:{backing:c.backing,levels:c.levels,markings:c.markings}}},{type:"audio_meter_level",name:"left",data:{x:5,y:5,width:5,height:45,style:{backing:c.backing,
levels:c.levels,markings:c.markings}}}]};e=object.builder(object.audio_sink,b);var d=system.audio.destination;c=new ChannelMergerNode(system.audio.context,{numberOfInputs:2});b.connectionNode_audio.left.out().connect(b.audio_meter_level.left.audioIn());b.connectionNode_audio.right.out().connect(b.audio_meter_level.right.audioIn());b.connectionNode_audio.left.out().connect(c,0,0);b.connectionNode_audio.right.out().connect(c,0,1);c.connect(d);b.audio_meter_level.left.start();b.audio_meter_level.right.start();
return e};this.audio_sink.metadata={name:"Audio Sink",helpurl:"https://metasophiea.com/curve/help/objects/audioSink/"};this.audio_scope=function(b,e){var c={type:"audio_scope",x:b,y:e,base:{points:[{x:0,y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],style:"fill:rgba(200,200,200,1);"},elements:[{type:"connectionNode_audio",name:"input",data:{type:0,x:195,y:5,width:10,height:20}},{type:"grapher_audioScope",name:"waveport",data:{x:5,y:5,width:150,height:100}},{type:"button_rect",name:"holdKey",data:{x:160,
y:5,width:30,height:20,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(190,190,190,1)",hover_press:"fill:rgba(170,170,170,1)"},onpress:function(){c.grapher_audioScope.waveport.stop()},onrelease:function(){c.grapher_audioScope.waveport.start()}}},{type:"text",name:"framerate_name",data:{x:161.5,y:70,text:"framerate",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"text",name:"framerate_1",data:{x:159,y:64,text:"1",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},
{type:"text",name:"framerate_15",data:{x:172,y:32,text:"15",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"text",name:"framerate_30",data:{x:188,y:64,text:"30",style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"dial_continuous",name:"framerate",data:{x:175,y:50,r:12,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,250,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(b){c.grapher_audioScope.waveport.refreshRate(1+Math.floor(29*b))}}}]};b=object.builder(object.audio_scope,c);c.connectionNode_audio.input.out().connect(c.grapher_audioScope.waveport.getNode());c.grapher_audioScope.waveport.start();c.dial_continuous.framerate.set(0);return b};this.audio_scope.metadata={name:"Audio Scope",helpurl:"https://metasophiea.com/curve/help/objects/audioScope/"};this.universalreadout=function(b,e,c){var d=object.builder(object.universalreadout,{type:"universalreadout",
x:b,y:e,base:{type:"circle",x:10,y:10,r:20,style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"in",data:{x:0,y:0,width:20,height:20,receive:function(b,c){b="address: "+b+" data: "+JSON.stringify(c);f.unshift(b);f.length>g&&f.pop();for(b=0;b<h.length;b++)h[b].remove();h=[];for(b=0;b<f.length;b++)h[b]=part.builder("text","universalreadout_"+b,{x:40,y:5*b,text:f[b],style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}),d.append(h[b])}}}]}),
f=[],h=[],g=10;return d};this.universalreadout.metadata={name:"Universal Readout",helpurl:"https://metasophiea.com/curve/help/objects/universalReadout/"};this.basicSynthesizer=function(b,e){var c={type:"basicSynthesizer",x:b,y:e,base:{points:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],style:"fill:rgba(200,200,200,1);"},elements:[{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-15,y:5,width:15,height:30}},{type:"connectionNode_data",name:"gain",data:{x:12.5,y:-7.5,
width:15,height:7.5,receive:function(b,e){switch(b){case "%":c.dial_continuous.gain.set(e);break;case "%t":d.__synthesizer.gain(e.target,e.time,e.curve),c.dial_continuous.gain.smoothSet(e.target,e.time,e.curve,!1)}}}},{type:"connectionNode_data",name:"attack",data:{x:52.5,y:-7.5,width:15,height:7.5,receive:function(b,d){"%"==b&&c.dial_continuous.attack.set(d)}}},{type:"connectionNode_data",name:"release",data:{x:92.5,y:-7.5,width:15,height:7.5,receive:function(b,d){"%"==b&&c.dial_continuous.release.set(d)}}},
{type:"connectionNode_data",name:"detune",data:{x:132.5,y:-7.5,width:15,height:7.5,receive:function(b,e){switch(b){case "%":c.dial_continuous.detune.set(e);break;case "%t":d.__synthesizer.detune(200*e.target+-100,e.time,e.curve),c.dial_continuous.detune.smoothSet(e.target,e.time,e.curve,!1)}}}},{type:"connectionNode_data",name:"octave",data:{x:170.5,y:-7.5,width:15,height:7.5,receive:function(b,d){"discrete"==b&&c.dial_discrete.octave.select(d)}}},{type:"connectionNode_data",name:"waveType",data:{x:210.5,
y:-7.5,width:15,height:7.5,receive:function(b,d){"discrete"==b&&c.dial_discrete.waveType.select(d)}}},{type:"connectionNode_data",name:"periodicWave",data:{x:240,y:12.5,width:7.5,height:15,receive:function(b,c){"periodicWave"==b&&d.__synthesizer.periodicWave(c)}}},{type:"connectionNode_data",name:"midiNote",data:{x:225,y:55,width:15,height:30,angle:Math.PI/4,receive:function(b,c){"midinumber"==b&&d.__synthesizer.perform(c)}}},{type:"connectionNode_data",name:"gainWobblePeriod",data:{x:22.5,y:90,width:15,
height:7.5,receive:function(b,d){"%"==b&&c.dial_continuous.gainWobblePeriod.set(d)}}},{type:"connectionNode_data",name:"gainWobbleDepth",data:{x:57.5,y:90,width:15,height:7.5,receive:function(b,d){"%"==b&&c.dial_continuous.gainWobbleDepth.set(d)}}},{type:"connectionNode_data",name:"detuneWobblePeriod",data:{x:107.5,y:90,width:15,height:7.5,receive:function(b,d){"%"==b&&c.dial_continuous.detuneWobblePeriod.set(d)}}},{type:"connectionNode_data",name:"detuneWobbleDepth",data:{x:142.5,y:90,width:15,height:7.5,
receive:function(b,d){"%"==b&&c.dial_continuous.detuneWobbleDepth.set(d)}}},{type:"text",name:"gain_gain",data:{x:11,y:43,text:"gain",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"gain_0",data:{x:7,y:37,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gain_1/2",data:{x:16.5,y:7,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gain_1",data:{x:30,y:37,text:"1",
style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"gain",data:{x:20,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.__synthesizer.gain(b)}}},{type:"text",name:"attack_gain",data:{x:47,y:43,text:"attack",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},
{type:"text",name:"attack_0",data:{x:47,y:37,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"attack_5",data:{x:58.5,y:7,text:"5",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"attack_10",data:{x:70,y:37,text:"10",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"attack",data:{x:60,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",
slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.__synthesizer.attack(b)}}},{type:"text",name:"release_gain",data:{x:85,y:43,text:"release",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"release_0",data:{x:85,y:37,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"release_5",data:{x:98.5,y:7,text:"5",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"release_10",data:{x:110,y:37,text:"10",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"release",data:{x:100,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.__synthesizer.release(b)}}},{type:"text",name:"detune_gain",data:{x:127,
y:43,text:"detune",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"detune_-100",data:{x:122,y:37,text:"-100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detune_0",data:{x:138.5,y:7,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detune_100",data:{x:150,y:37,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"detune",
data:{x:140,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.__synthesizer.detune(200*b+-100)}}},{type:"text",name:"octave_gain",data:{x:167,y:43,text:"octave",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"octave_-3",data:{x:164,y:35,text:"-3",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"octave_-2",data:{x:160,y:24,text:"-2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_-1",data:{x:164,y:13,text:"-1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_0",data:{x:178.75,y:8,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_1",data:{x:190,y:13,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"octave_2",data:{x:195,y:24,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"octave_3",data:{x:190,y:35,text:"3",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_discrete",name:"octave",data:{x:180,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:7,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(b){d.__synthesizer.octave(b-
3)}}},{type:"text",name:"waveType_gain",data:{x:211,y:43,text:"wave",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"waveType_sin",data:{x:202,y:35,text:"sin",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"waveType_tri",data:{x:199,y:21,text:"tri",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"waveType_squ",data:{x:210,y:9,text:"squ",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"waveType_saw",data:{x:227,y:10,text:"saw",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"rect",name:"periodicWaveType",data:{x:230,y:21.75,angle:0,width:10,height:2.5,style:"fill:rgba(50,50,50,1)"}},{type:"dial_discrete",name:"waveType",data:{x:220,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:5*Math.PI/4,optionCount:5,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)"},onchange:function(b){d.__synthesizer.waveType(["sine",
"triangle","square","sawtooth","custom"][b])}}},{type:"text",name:"gainWobble",data:{x:13,y:70,angle:-Math.PI/2,text:"gain",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_gain",data:{x:21,y:84,text:"rate",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_0",data:{x:16,y:77,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_50",
data:{x:27.5,y:49,text:"50",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobblePeriod_100",data:{x:42,y:77,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"gainWobblePeriod",data:{x:30,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},
onchange:function(b){d.__synthesizer.gainWobblePeriod(.01>1-b?.011:1-b)}}},{type:"text",name:"gainWobbleDepth_gain",data:{x:54,y:84,text:"depth",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"gainWobbleDepth_0",data:{x:51,y:77,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobbleDepth_50",data:{x:61,y:49,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"gainWobbleDepth_100",
data:{x:77,y:77,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"gainWobbleDepth",data:{x:65,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.__synthesizer.gainWobbleDepth(b)}}},{type:"text",name:"detuneWobble",data:{x:98,y:70,angle:-Math.PI/
2,text:"detune",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobblePeriod_gain",data:{x:105,y:84,text:"rate",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"detuneWobblePeriod_0",data:{x:100,y:77,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobblePeriod_50",data:{x:111.5,y:49,text:"50",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},
{type:"text",name:"detuneWobblePeriod_100",data:{x:126,y:77,text:"100",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"detuneWobblePeriod",data:{x:114,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.__synthesizer.detuneWobblePeriod(.01>
1-b?.011:1-b)}}},{type:"text",name:"detuneWobbleDepth_gain",data:{x:140,y:84,text:"depth",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;"}},{type:"text",name:"detuneWobbleDepth_0",data:{x:135,y:77,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobbleDepth_50",data:{x:145.5,y:49,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"text",name:"detuneWobbleDepth_100",data:{x:161,y:77,text:"1",
style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"detuneWobbleDepth",data:{x:149,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d.__synthesizer.detuneWobbleDepth(100*b)}}},{type:"button_rect",name:"panicButton",data:{x:197.5,y:47.5,width:20,
height:20,angle:Math.PI/4,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){d.__synthesizer.panic()}}},{type:"path",name:"selectionGlow",data:{path:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],style:"pointer-events:none; fill:none; "}}]},d=object.builder(object.basicSynthesizer,c);d.exportData=function(){return{gain:c.dial_continuous.gain.get(),attack:10*c.dial_continuous.attack.get(),release:10*
c.dial_continuous.release.get(),detune:100*(2*c.dial_continuous.detune.get()-1),octave:c.dial_discrete.octave.select()-3,waveType:["sine","triangle","square","sawtooth","custom"][c.dial_discrete.waveType.select()],gainWobble:{rate:100*c.dial_continuous.gainWobblePeriod.get(),depth:c.dial_continuous.gainWobbleDepth.get()},detuneWobble:{rate:100*c.dial_continuous.detuneWobblePeriod.get(),depth:c.dial_continuous.detuneWobbleDepth.get()}}};d.importData=function(b){c.dial_continuous.gain.set(b.gain);c.dial_continuous.attack.set(b.attack/
10);c.dial_continuous.release.set(b.release/10);c.dial_continuous.detune.set((1+b.detune/100)/2);c.dial_discrete.octave.select(b.octave+3);c.dial_discrete.waveType.select(["sine","triangle","square","sawtooth","custom"].indexOf(b.waveType));c.dial_continuous.gainWobblePeriod.set(b.gainWobble.rate/100);c.dial_continuous.gainWobbleDepth.set(b.gainWobble.depth);c.dial_continuous.detuneWobblePeriod.set(b.detuneWobble.rate/100);c.dial_continuous.detuneWobbleDepth.set(b.detuneWobble.depth)};d.onSelect=
function(){system.utility.element.setStyle(c.path.selectionGlow,"pointer-events:none; fill:none; stroke:rgb(255, 237, 147); stroke-width:2; stroke-linecap:round;")};d.onDeselect=function(){system.utility.element.setStyle(c.path.selectionGlow,"pointer-events:none; fill:none; ")};d.__synthesizer=new part.circuit.audio.synthesizer2(system.audio.context);d.__synthesizer.out().connect(c.connectionNode_audio.audioOut.in());d.i={gain:function(b){c.dial_continuous.gain.set(b)},attack:function(b){c.dial_continuous.attack.set(b)},
release:function(b){c.dial_continuous.release.set(b)},detune:function(b){c.dial_continuous.detune.set(b)},octave:function(b){c.dial_discrete.octave.select(b)},waveType:function(b){c.dial_discrete.waveType.select(b)},periodicWave:function(b){d.__synthesizer.periodicWave(b)},midiNote:function(b){d.__synthesizer.perform(b)},gainWobblePeriod:function(b){c.dial_continuous.gainWobblePeriod.set(b)},gainWobbleDepth:function(b){c.dial_continuous.gainWobbleDepth.set(b)},detuneWobblePeriod:function(b){c.dial_continuous.detuneWobblePeriod.set(b)},
detuneWobbleDepth:function(b){c.dial_continuous.detuneWobbleDepth.set(b)}};c.dial_continuous.gain.set(.5);c.dial_continuous.detune.set(.5);c.dial_discrete.octave.select(3);return d};this.basicSynthesizer.metadata={name:"Basic Synthesizer",helpurl:"https://metasophiea.com/curve/help/objects/basicSynthesizer/"};this.pulseGenerator_hyper=function(b,e,c,d){function f(b){h.readout_sixteenSegmentDisplay.readout.text(system.utility.misc.padString(b,3," ")+"bpm");h.readout_sixteenSegmentDisplay.readout.print();
m&&clearInterval(m);0<b&&(m=setInterval(function(){g.io.out.send("pulse")},60/b*1E3));g.io.out.send("pulse");k=b}c=void 0===c?999:c;var h={type:"pulseGenerator_hyper",x:b,y:e,base:{type:"path",points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,
receive:function(){h.button_rect.sync.press()}}},{type:"button_rect",name:"sync",data:{x:102.5,y:11.25,width:10,height:17.5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",down:"fill:rgba(150,150,150,1)",glow:"fill:rgba(220,200,220,1)"},onclick:function(){f(k)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",
outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){f(Math.round(b*c))}}},{type:"readout_sixteenSegmentDisplay",name:"readout",data:{x:40,y:10,width:60,height:20,count:6}}]},g=object.builder(object.pulseGenerator_hyper,h);g.exportData=function(){return h.dial_continuous.tempo.get()};g.importData=function(b){h.dial_continuous.tempo.set(b)};var m=null,k=120;g.i={setTempo:function(b){h.dial_continuous.tempo.set(b)}};h.dial_continuous.tempo.set(.5);return g};this.pulseGenerator_hyper.metadata=
{name:"Pulse Generator (hyper)",helpurl:"https://metasophiea.com/curve/help/objects/pulseGenerator_hyper/"};this.pulseGenerator=function(b,e,c){function d(b){f.readout_sixteenSegmentDisplay.readout.text(system.utility.misc.padString(b,3," ")+"bpm");f.readout_sixteenSegmentDisplay.readout.print();g&&clearInterval(g);0<b&&(g=setInterval(function(){h.io.out.send("pulse")},60/b*1E3));h.io.out.send("pulse");m=b}var f={type:"pulseGenerator",x:b,y:e,base:{type:"path",points:[{x:0,y:10},{x:10,y:0},{x:100,
y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){f.button_rect.sync.press()}}},{type:"button_rect",name:"sync",data:{x:102.5,y:11.25,width:10,height:17.5,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},
onpress:function(){d(m)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d(Math.round(240*b))}}},{type:"readout_sixteenSegmentDisplay",name:"readout",data:{x:40,y:10,width:60,height:20,count:6}}]},h=object.builder(object.pulseGenerator,f);h.exportData=
function(){return f.dial_continuous.tempo.get()};h.importData=function(b){f.dial_continuous.tempo.set(b)};var g=null,m=120;h.i={setTempo:function(b){f.dial_continuous.tempo.set(b)}};f.dial_continuous.tempo.set(.5);return h};this.pulseGenerator.metadata={name:"Pulse Generator",helpurl:"https://metasophiea.com/curve/help/objects/pulseGenerator/"};this.musicalkeyboard=function(b,e,c){var d=.5,f={type:"musicalkeyboard",x:b,y:e,base:{type:"path",points:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},{x:0,y:62.5}],
style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"midiout",data:{x:-5,y:5,width:5,height:10}},{type:"connectionNode_data",name:"midiin",data:{x:320,y:5,width:5,height:10,receive:function(b,c){"midinumber"==b&&(0<c.velocity?f.button_rect[system.audio.num2name(c.num)].press():f.button_rect[system.audio.num2name(c.num)].release())}}},{type:"label",name:"velocity_title",data:{x:9,y:59,text:"velocity",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",
name:"velocity_0",data:{x:4,y:55,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"velocity_1/2",data:{x:14,y:26.5,text:"1/2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"label",name:"velocity_1",data:{x:28,y:55,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;"}},{type:"dial_continuous",name:"velocity",data:{x:17.5,y:42,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",
slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){d=b}}}]},h="\\azsxcfvgbhnmk,l./1q2w3er5t6yu8i9o0p[".split(""),g="4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C".split(" ");c=35;b=45;for(e=0;e<h.length;e++)"#"!=g[e].slice(-1)&&(f.elements.push({type:"button_rect",name:g[e],data:{x:c,y:12.5,width:12.5,height:50,hoverable:!1,
style:{up:"fill:rgba(250,250,250,1)",press:"fill:rgba(230,230,230,1)",glow:"fill:rgba(220,200,220,1)",glow_press:"fill:rgba(200,150,200,1)"},onpress:function(){m.io.midiout.send("midinumber",{num:system.audio.name2num(this.id),velocity:d})},onrelease:function(){m.io.midiout.send("midinumber",{num:system.audio.name2num(this.id),velocity:0})}}}),c+=12.5);for(e=c=0;e<h.length;e++)"#"==g[e].slice(-1)?(f.elements.push({type:"button_rect",name:g[e],data:{x:b,y:12.5,width:5,height:30,hoverable:!1,style:{up:"fill:rgba(50,50,50,1)",
press:"fill:rgba(100,100,100,1)",glow:"fill:rgba(220,200,220,1)",glow_press:"fill:rgba(200,150,200,1)"},onpress:function(){m.io.midiout.send("midinumber",{num:system.audio.name2num(this.id),velocity:d})},onrelease:function(){m.io.midiout.send("midinumber",{num:system.audio.name2num(this.id),velocity:0})}}}),b+=12.5,c=0):c++,1<c&&(b+=12.5);var m=object.builder(object.musicalkeyboard,f);b=system.keyboard.declareKeycaptureObject(m,{none:h});b.keyPress=function(b){f.button_rect[g[h.indexOf(b)]].press()};
b.keyRelease=function(b){f.button_rect[g[h.indexOf(b)]].release()};m.i={velocity:function(b){f.dial_continuous.velocity.set(b)}};f.dial_continuous.velocity.set(.5);return m};this.musicalkeyboard.metadata={name:"Musical Keyboard",helpurl:"https://metasophiea.com/curve/help/objects/musicalKeyboard/"};this.audioIn=function(b,e,c){function d(b){if(0==f.deviceList.length)m.readout_sixteenSegmentDisplay.index.text(" n/a"),m.readout_sixteenSegmentDisplay.index.print(),m.readout_sixteenSegmentDisplay.text.text("no devices"),
m.readout_sixteenSegmentDisplay.text.print("smart");else if(!(0>b||b>=f.deviceList.length)){f.currentSelection=b;for(selectionNum=""+(b+1);2>selectionNum.length;)selectionNum="0"+selectionNum;for(totalNum=""+f.deviceList.length;2>totalNum.length;)totalNum="0"+totalNum;m.readout_sixteenSegmentDisplay.index.text(selectionNum+"/"+totalNum);m.readout_sixteenSegmentDisplay.index.print();var c=f.deviceList[b].deviceId;0<f.deviceList[b].label.length&&(c=f.deviceList[b].label+" - "+c);m.readout_sixteenSegmentDisplay.text.text(c);
m.readout_sixteenSegmentDisplay.text.print("smart");k.circuitry.unit.selectDevice(f.deviceList[b].deviceId)}}c=void 0===c?!0:c;var f={deviceList:[],currentSelection:0},h={background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",dim:"fill:rgb(20,20,20)"},g={up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(230,230,230,1)",hover_press:"fill:rgba(180,180,180,1)"},m={type:"audioIn",x:b,y:e,base:{points:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},{x:50,y:40},{x:37.5,
y:50},{x:22.5,y:50},{x:10,y:40},{x:0,y:40}],style:"fill:rgba(200,200,200,1); stroke:none;"},elements:[{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-10,y:15,width:20,height:20}},{type:"readout_sixteenSegmentDisplay",name:"index",data:{x:70,y:15,angle:0,width:50,height:20,count:5,style:h}},{type:"readout_sixteenSegmentDisplay",name:"text",data:{x:122.5,y:15,angle:0,width:100,height:20,count:10,style:h}},{type:"button_rect",name:"up",data:{x:225,y:15,width:15,height:10,selectable:!1,style:g,
onpress:function(){d(f.currentSelection+1)}}},{type:"button_rect",name:"down",data:{x:225,y:25,width:15,height:10,selectable:!1,style:g,onpress:function(){d(f.currentSelection-1)}}},{type:"dial_continuous",name:"outputGain",data:{x:30,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){k.circuitry.unit.gain(2*
b)}}},{type:"label",name:"gainLabel_name",data:{x:21.25,y:44,text:"gain",style:"fill:rgba(0,0,0,1); font-size:7px; font-family:Courier New;",angle:0}},{type:"label",name:"gainLabel_0",data:{x:15,y:40,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;",angle:0}},{type:"label",name:"gainLabel_1",data:{x:28.75,y:7,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;",angle:0}},{type:"label",name:"gainLabel_2",data:{x:42.5,y:40,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New;",
angle:0}},{type:"path",name:"upArrow",data:{path:[{x:227.5,y:22.5},{x:232.5,y:17.5},{x:237.5,y:22.5}],style:"fill:none; stroke:rgb(160,160,160); stroke-width:1;pointer-events: none;"}},{type:"path",name:"downArrow",data:{path:[{x:227.5,y:27.5},{x:232.5,y:32.5},{x:237.5,y:27.5}],style:"fill:none; stroke:rgb(160,160,160); stroke-width:1;pointer-events: none;"}},{type:"audio_meter_level",name:"audioIn",data:{x:50,y:15,width:17.5,height:20}}]},k=object.builder(object.audioIn,m);system.keyboard.declareKeycaptureObject(k,
{none:["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"]}).keyPress=function(b){switch(b){case "ArrowUp":m.button_rect.up.press();break;case "ArrowDown":m.button_rect.down.press();break;case "ArrowLeft":m.dial_continuous.outputGain.set(m.dial_continuous.outputGain.get()-.1);break;case "ArrowRight":m.dial_continuous.outputGain.set(m.dial_continuous.outputGain.get()+.1)}};k.circuitry={unit:new part.circuit.audio.audioIn(system.audio.context,c)};k.circuitry.unit.out().connect(m.connectionNode_audio.audioOut.in());
k.circuitry.unit.out().connect(m.audio_meter_level.audioIn.audioIn());k.circuitry.unit.listDevices(function(b){f.deviceList=b});c&&setTimeout(function(){d(0)},500);m.dial_continuous.outputGain.set(.5);m.audio_meter_level.audioIn.start();return k};this.audioIn.metadata={name:"Audio Input",helpurl:"https://metasophiea.com/curve/help/objects/audioInput/"};this.data_duplicator=function(b,e){var c=object.builder(object.data_duplicator,{type:"data_duplicator",x:b,y:e,base:{points:[{x:0,y:0},{x:55,y:0},
{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,0);"},elements:[{type:"connectionNode_data",name:"output_1",data:{x:-10,y:5,width:20,height:20}},{type:"connectionNode_data",name:"output_2",data:{x:-10,y:30,width:20,height:20}},{type:"connectionNode_data",name:"input",data:{x:45,y:5,width:20,height:20,receive:function(b,e){c.io.output_1.send(b,e);c.io.output_2.send(b,e)}}},{type:"path",name:"backing",data:{path:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1);pointer-events:none;"}},
{type:"path",name:"upperArrow",data:{path:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"path",name:"lowerArrow",data:{path:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},{type:"rect",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:"fill:rgba(150,150,150,1); pointer-events:none;"}},
{type:"rect",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:"fill:rgba(150,150,150,1); pointer-events:none;"}}]});return c};this.data_duplicator.metadata={name:"Data Duplicator",helpurl:"https://metasophiea.com/curve/help/objects/dataDuplicator/"};this.recorder=function(b,e,c){function d(b){if("empty"!=g||"save"!=b&&"stop"!=b){if("stop"==b||"save"==b)g="full";"empty"==g&&"rec"==b&&(g="recording");"clear"==b&&(g="empty");"recording"==g&&"pause/resume"==b?g="paused":"paused"!=g||"pause/resume"!=
b&&"rec"!=b||(g="recording");if("empty"==g)f.glowbox_rect.activityLight_empty.on();else f.glowbox_rect.activityLight_empty.off();if("recording"==g)f.glowbox_rect.activityLight_recording.on();else f.glowbox_rect.activityLight_recording.off();if("paused"==g)f.glowbox_rect.activityLight_paused.on();else f.glowbox_rect.activityLight_paused.off();if("full"==g)f.glowbox_rect.activityLight_full.on();else f.glowbox_rect.activityLight_full.off()}}var f={type:"recorder",x:b,y:e,base:{points:[{x:0,y:0},{x:175,
y:0},{x:175,y:40},{x:0,y:40}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"inRight",data:{type:0,x:175,y:2.5,width:10,height:15}},{type:"connectionNode_audio",name:"inLeft",data:{type:0,x:175,y:22.5,width:10,height:15}},{type:"rect",name:"logo_rect",data:{x:135,y:27.5,angle:-.25,width:35,height:10,style:"fill:rgb(230,230,230)"}},{type:"label",name:"logo_label",data:{x:139,y:34.5,angle:-.25,text:"REcorder",style:"fill:rgba(100,100,100,1); font-size:8px; font-family:Bookman; pointer-events: none;"}},
{type:"button_rect",name:"rec",data:{x:5,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){"paused"==g?h.recorder.resume():h.recorder.start();d("rec")}}},{type:"text",name:"button_rect_text",data:{x:10.5,y:31.5,text:"rec",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"button_rect",name:"pause/resume",data:{x:27.5,y:25,width:20,height:10,
style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){"paused"==g?h.recorder.resume():h.recorder.pause();d("pause/resume")}}},{type:"text",name:"button_pause/resume_text",data:{x:30,y:31.5,text:"pause",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"button_rect",name:"stop",data:{x:50,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",
hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){d("stop");h.recorder.stop()}}},{type:"text",name:"button_stop_text",data:{x:54,y:31.5,text:"stop",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"button_rect",name:"save",data:{x:72.5,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){d("save");"empty"!=g&&h.recorder.save()}}},
{type:"text",name:"button_save_text",data:{x:76.5,y:31.5,text:"save",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"button_rect",name:"clear",data:{x:95,y:25,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){d("clear");h.recorder.clear()}}},{type:"text",name:"button_clear_text",data:{x:97.5,y:31.5,text:"clear",angle:0,style:"fill:rgba(100,100,100,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},
{type:"readout_sixteenSegmentDisplay",name:"time",data:{x:70,y:5,angle:0,width:100,height:15,count:11,style:{background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",dim:"fill:rgb(20,20,20)"}}},{type:"glowbox_rect",name:"activityLight_recording",data:{x:5,y:5,width:15,height:15,style:{glow:"fill:rgb(255, 63, 63)",dim:"fill:rgb(25, 6, 6)"}}},{type:"text",name:"activityLight_recording_text",data:{x:8,y:14,text:"rec",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},
{type:"glowbox_rect",name:"activityLight_paused",data:{x:20,y:5,width:15,height:15,style:{glow:"fill:rgb(126, 186, 247)",dim:"fill:rgb(12, 18, 24)"}}},{type:"text",name:"activityLight_paused_text",data:{x:23,y:14,text:"pau",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"glowbox_rect",name:"activityLight_empty",data:{x:35,y:5,width:15,height:15,style:{glow:"fill:rgb(199, 249, 244)",dim:"fill:rgb(19, 24, 24)"}}},{type:"text",name:"activityLight_empty_text",
data:{x:38,y:14,text:"emp",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}},{type:"glowbox_rect",name:"activityLight_full",data:{x:50,y:5,width:15,height:15,style:{glow:"fill:rgb(61, 224, 35)",dim:"fill:rgb(6, 22, 3)"}}},{type:"text",name:"activityLight_full_text",data:{x:53,y:14,text:"ful",angle:0,style:"fill:rgba(0,0,0,1); font-size:5px; font-family:Courier New; pointer-events: none;"}}]},h=object.builder(object.recorder,f);setInterval(function(){var b=
h.recorder.recordingTime(),c=b%1;b=system.utility.math.seconds2time(Math.round(b));f.readout_sixteenSegmentDisplay.time.text(system.utility.misc.padString(b.h,2,"0")+":"+system.utility.misc.padString(b.m,2,"0")+":"+system.utility.misc.padString(b.s,2,"0")+"."+system.utility.misc.padString((""+c).slice(2),2,"0"));f.readout_sixteenSegmentDisplay.time.print()},100);var g="empty";d("clear");f.glowbox_rect.activityLight_empty.on();h.recorder=new part.circuit.audio.recorder(system.audio.context);f.connectionNode_audio.inRight.out().connect(h.recorder.in_right());
f.connectionNode_audio.inLeft.out().connect(h.recorder.in_left());return h};this.recorder.metadata={name:"Recorder",helpurl:"https://metasophiea.com/curve/help/objects/recorder/"};this.looper=function(b,e,c){var d={type:"looper",x:b,y:e,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,
width:10,height:20}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,receive:function(b,c){d.button_rect.fire.press()}}},{type:"circle",name:"symbol_outterCircle1",data:{x:11.5,y:41,r:6,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_outterCircle2",data:{x:18.5,y:41,r:6,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"rect",name:"symbol_blockingrect",data:{x:11.5,
y:34,width:7,height:15,style:"fill:rgba(200,200,200,1)"}},{type:"path",name:"symbol_upperarrow",data:{path:[{x:13.5,y:32.5},{x:16.5,y:35},{x:13.5,y:37.5}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"path",name:"symbol_lowerarrow",data:{path:[{x:16.5,y:44.75},{x:13.5,y:47.25},{x:16.5,y:49.75}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",
hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){f.looper.load("file",function(b){d.grapher_waveWorkspace.grapher_waveWorkspace.draw(f.looper.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",hover_press:"fill:rgba(150,170,150,1)"},onpress:function(){function b(){h&&(d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0),clearTimeout(g));
d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,0,"transition: transform "+c+"s;transition-timing-function: linear;");setTimeout(function(){d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,1)},1);h=!0;g=setTimeout(b,1E3*c)}if(!(0>f.looper.duration())){f.looper.start();var c=f.looper.duration();b()}}}},{type:"button_rect",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",hover_press:"fill:rgba(170,150,150,1)"},
onpress:function(){f.looper.stop();h&&(d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0),h=!1,clearTimeout(g))}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]},f=object.builder(object.looper,d),h=void 0,g=void 0;f.looper=new part.circuit.audio.looper(system.audio.context);f.looper.out_right().connect(d.connectionNode_audio.outRight.in());f.looper.out_left().connect(d.connectionNode_audio.outLeft.in());
return f};this.looper.metadata={name:"Looper",helpurl:"https://metasophiea.com/curve/help/objects/looper/"};this.oneShot_single=function(b,e,c){var d={type:"oneShot_single",x:b,y:e,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}},{type:"connectionNode_data",name:"trigger",
data:{x:220,y:17.5,width:10,height:20,receive:function(b,c){d.button_rect.fire.press();d.button_rect.fire.release()}}},{type:"path",name:"symbol_arrow",data:{path:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"rect",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"circle",name:"symbol_outterCircle",data:{x:10,y:40,r:5.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},
{type:"rect",name:"symbol_1",data:{x:9.5,y:37.5,width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){f.oneShot.load("file",function(b){d.grapher_waveWorkspace.grapher_waveWorkspace.draw(f.oneShot.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:20,height:10,
style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",hover_press:"fill:rgba(150,170,150,1)"},onpress:function(){if(!(0>f.oneShot.duration())){f.oneShot.fire();h&&(d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0),h=!1,clearTimeout(g));var b=f.oneShot.duration();d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,0,"transition: transform "+b+"s;transition-timing-function: linear;");h=!0;setTimeout(function(){d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0,
1)},1);g=setTimeout(function(){d.grapher_waveWorkspace.grapher_waveWorkspace.genericNeedle(0);h=!1},1E3*b)}}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]},f=object.builder(object.oneShot_single,d),h=void 0,g=void 0;f.oneShot=new part.circuit.audio.oneShot_single(system.audio.context);f.oneShot.out_right().connect(d.connectionNode_audio.outRight.in());f.oneShot.out_left().connect(d.connectionNode_audio.outLeft.in());
return f};this.oneShot_single.metadata={name:"One Shot (Single)",helpurl:"https://metasophiea.com/curve/help/objects/oneShot_single/"};this.oneShot_multi=function(b,e,c){var d={type:"oneShot_multi",x:b,y:e,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}},{type:"connectionNode_data",
name:"trigger",data:{x:220,y:17.5,width:10,height:20,receive:function(b,c){d.button_rect.fire.press();d.button_rect.fire.release()}}},{type:"path",name:"symbol_arrow",data:{path:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"rect",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"circle",name:"symbol_outterCircle",data:{x:10,y:40,r:5.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},
{type:"circle",name:"symbol_infCircle1",data:{x:8.5,y:40,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_infCircle2",data:{x:11.5,y:40,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){f.oneShot.load("file",
function(b){d.grapher_waveWorkspace.grapher_waveWorkspace.draw(f.oneShot.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",hover_press:"fill:rgba(150,170,150,1)"},onpress:function(){var b=f.oneShot,c=d.grapher_waveWorkspace.grapher_waveWorkspace;if(!(0>b.duration())){var e=void 0!=c.area().A?c.area().A:0,l=void 0!=c.area().B?c.area().B:1,p=b.duration(),q=e*p;p=l*p-q;b.fire(q,p);for(var r=
0;r in h;)r++;h[r]={};d.glowbox_rect.glowbox_rect.on();setTimeout(function(){d.glowbox_rect.glowbox_rect.off()},100);c.genericNeedle(r,e,"transition: transform "+p+"s; transition-timing-function: linear;");setTimeout(function(b){c.genericNeedle(r,b)},1,l);h[r].timeout=setTimeout(function(){c.genericNeedle(r);delete h[r]},1E3*p)}}}},{type:"button_rect",name:"panic",data:{x:15,y:17.5,width:10,height:10,style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",hover_press:"fill:rgba(170,150,150,1)"},
onpress:function(){var b=d.grapher_waveWorkspace.grapher_waveWorkspace;f.oneShot.panic();for(var c=Object.keys(h),e=0;e<c.length;e++)void 0!=h[e]&&(clearTimeout(h[e].timeout),b.genericNeedle(e),delete h[e])}}},{type:"slide",name:"rate",data:{x:26.25,y:5,width:5,height:45,value:.5,resetValue:.5,style:{handle:"fill:rgba(220,220,220,1)"},onchange:function(b){f.oneShot.rate(2*(1-b))}}},{type:"glowbox_rect",name:"glowbox_rect",data:{x:32.5,y:5,width:2.5,height:45}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",
data:{x:35,y:5,width:180,height:45,selectNeedle:!1,selectionArea:!0}}]},f=object.builder(object.oneShot_multi,d),h={};f.oneShot=new part.circuit.audio.oneShot_multi(system.audio.context);f.oneShot.out_right().connect(d.connectionNode_audio.outRight.in());f.oneShot.out_left().connect(d.connectionNode_audio.outLeft.in());f.i={};f.i.loadURL=function(b,c){f.oneShot.load("url",function(){d.grapher_waveWorkspace.grapher_waveWorkspace.draw(f.oneShot.waveformSegment());void 0!=c&&c()},b)};f.i.area=function(b,
c){d.grapher_waveWorkspace.grapher_waveWorkspace.area(b,c)};return f};this.oneShot_multi.metadata={name:"One Shot (Multi)",helpurl:"https://metasophiea.com/curve/help/objects/oneShot_multi/"};this.oneShot_multi_multiTrack=function(b,e,c){var d={type:"oneShot_multi_multiTrack",x:b,y:e,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",
name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}}]};for(b=0;8>b;b++)d.elements=d.elements.concat([{type:"path",name:"symbol_"+b+"_arrow",data:{path:[{x:19,y:35+47*b},{x:25,y:40+47*b},{x:19,y:45+47*b}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"rect",name:"symbol_"+b+"_line",data:{x:15,y:39.5+47*b,width:6,height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"circle",name:"symbo_"+b+"l_outterCircle",data:{x:10,y:40+47*
b,r:5.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_"+b+"_infCircle1",data:{x:8.5,y:40+47*b,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"circle",name:"symbol_"+b+"_infCircle2",data:{x:11.5,y:40+47*b,r:1.5,style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}}]),d.elements.push({type:"slide",name:"rate_"+b,data:{x:26.25,y:5+47*b,width:5,height:45,
value:.5,resetValue:.5,style:{handle:"fill:rgba(220,220,220,1)"},onchange:function(b){return function(c){f.oneShot_multi_array[b].rate(2*(1-d.slide["rate_"+b].get()))}}(b)}}),d.elements.push({type:"glowbox_rect",name:"glowbox_rect_"+b,data:{x:32.5,y:5+47*b,width:2.5,height:45}}),d.elements.push({type:"grapher_waveWorkspace",name:"grapher_waveWorkspace_"+b,data:{x:35,y:5+47*b,width:180,height:45,selectNeedle:!1,selectionArea:!0}}),d.elements.push({type:"button_rect",name:"loadFile_"+b,data:{x:5,y:5+
47*b,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(b){return function(){f.oneShot_multi_array[b].load("file",function(b){return function(c){d.grapher_waveWorkspace["grapher_waveWorkspace_"+b].draw(f.oneShot_multi_array[b].waveformSegment())}}(b))}}(b)}}),d.elements.push({type:"button_rect",name:"fire_"+b,data:{x:5,y:17.5+47*b,width:10,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",
hover_press:"fill:rgba(150,170,150,1)"},onpress:function(b){return function(){var c=f.oneShot_multi_array[b],e=d.grapher_waveWorkspace["grapher_waveWorkspace_"+b],h=f.playheads[b];if(!(0>c.duration())){var l=void 0!=e.area().A?e.area().A:0,p=void 0!=e.area().B?e.area().B:1;if(l>p){var q=l;l=p;p=q}q=c.duration();var r=l*q;q=p*q-r;c.fire(r,q);for(var u=0;u in h;)u++;h[u]={};d.glowbox_rect["glowbox_rect_"+b].on();setTimeout(function(b){return function(){d.glowbox_rect["glowbox_rect_"+b].off()}}(b),100);
e.genericNeedle(u,l,"transition: transform "+q+"s; transition-timing-function: linear;");setTimeout(function(b){e.genericNeedle(u,b)},1,p);h[u].timeout=setTimeout(function(b){e.genericNeedle(b);delete h[b]},1E3*q,u)}}}(b)}}),d.elements.push({type:"button_rect",name:"panic_"+b,data:{x:15,y:17.5+47*b,width:10,height:10,style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",hover_press:"fill:rgba(170,150,150,1)"},onpress:function(b){return function(c){c=d.grapher_waveWorkspace["grapher_waveWorkspace_"+
b];var e=f.playheads[b];f.oneShot_multi_array[b].panic();for(var g=Object.keys(e),h=0;h<g.length;h++)void 0!=e[h]&&(clearTimeout(e[h].timeout),c.genericNeedle(h),delete e[h])}}(b)}}),d.elements.push({type:"connectionNode_data",name:"trigger_"+b,data:{x:220,y:17.5+47*b,width:10,height:20,receive:function(b){return function(c,e){"pulse"==c?(d.button_rect["fire_"+b].press(),d.button_rect["fire_"+b].release()):"hit"==c&&.5<e.velocity&&(d.button_rect["fire_"+b].press(),d.button_rect["fire_"+b].release())}}(b)}});
var f=object.builder(object.oneShot_multi_multiTrack,d);f.exportData=function(){for(var b={tracks:[],areas:[]},c=0;8>c;c++)b.tracks.push(f.oneShot_multi_array[c].unloadRaw()),b.areas.push(f.i.area(c));return b};f.importData=function(b){for(var c=0;8>c;c++)f.i.loadRaw(c,b.tracks[c]),f.i.area(c,b.areas[c].A,b.areas[c].B)};f.playheads=[];f.oneShot_multi_array=[];for(b=0;8>b;b++)f.oneShot_multi_array.push(new part.circuit.audio.oneShot_multi(system.audio.context)),f.oneShot_multi_array[b].out_right().connect(d.connectionNode_audio.outRight.in()),
f.oneShot_multi_array[b].out_left().connect(d.connectionNode_audio.outLeft.in()),f.playheads.push([]);f.i={loadURL:function(b,c,d){f.oneShot_multi_array[b].load("url",function(b){return function(){document.getElementById("oneShot_multi_multiTrack").children["grapher_waveWorkspace_"+b].draw(document.getElementById("oneShot_multi_multiTrack").oneShot_multi_array[b].waveformSegment())}}(b),c)},loadRaw:function(b,c){f.oneShot_multi_array[b].loadRaw(c);d.grapher_waveWorkspace["grapher_waveWorkspace_"+
b].draw(f.oneShot_multi_array[b].waveformSegment())},area:function(b,c,e){return d.grapher_waveWorkspace["grapher_waveWorkspace_"+b].area(c,e)}};return f};this.oneShot_multi_multiTrack.metadata={name:"One Shot (Multi)(8 Track)",helpurl:"https://metasophiea.com/curve/help/objects/oneShot_multi_multiTrack/"};this.player=function(b,e,c){var d={type:"player",x:b,y:e,base:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:80},{x:0,y:80}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_audio",name:"outRight",
data:{type:1,x:-10,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"outLeft",data:{type:1,x:-10,y:27.5,width:10,height:20}},{type:"rect",name:"symbol_line1",data:{x:3.5,y:38.5,width:1,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line2",data:{x:5.5,y:37,width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line3",data:{x:7.5,y:35.5,width:1,height:8,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},
{type:"rect",name:"symbol_line4",data:{x:9.5,y:34.5,width:1,height:10,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line5",data:{x:11.5,y:35.5,width:1,height:8,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line6",data:{x:13.5,y:37,width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line7",data:{x:15.5,y:39,width:1,height:1,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},
{type:"rect",name:"symbol_line8",data:{x:17.5,y:36,width:1,height:7,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line9",data:{x:19.5,y:32,width:1,height:15,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line10",data:{x:21.5,y:34.5,width:1,height:10,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"symbol_line11",data:{x:23.5,y:37,width:1,height:5,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},
{type:"rect",name:"symbol_line12",data:{x:25.5,y:38.5,width:1,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"readout_sixteenSegmentDisplay",name:"trackNameReadout",data:{x:30,y:5,angle:0,width:100,height:20,count:10,style:{background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",dim:"fill:rgb(20,20,20)"}}},{type:"readout_sixteenSegmentDisplay",name:"time",data:{x:135,y:5,angle:0,width:80,height:20,count:8,style:{background:"fill:rgb(0,0,0)",glow:"fill:rgb(200,200,200)",
dim:"fill:rgb(20,20,20)"}}},{type:"button_rect",name:"load",data:{x:5,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){f.player.load("file",function(b){d.grapher_waveWorkspace.grapher_waveWorkspace.draw(f.player.waveformSegment());d.grapher_waveWorkspace.grapher_waveWorkspace.select(0);d.grapher_waveWorkspace.grapher_waveWorkspace.area(-1,-1);d.readout_sixteenSegmentDisplay.trackNameReadout.text(b.name);
d.readout_sixteenSegmentDisplay.trackNameReadout.print("smart")})}}},{type:"button_rect",name:"start",data:{x:5,y:17.5,width:20,height:10,style:{up:"fill:rgba(175,195,175,1)",hover:"fill:rgba(220,240,220,1)",hover_press:"fill:rgba(150,170,150,1)"},onpress:function(){f.player.start()}}},{type:"button_rect",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{up:"fill:rgba(195,175,175,1)",hover:"fill:rgba(240,220,220,1)",hover_press:"fill:rgba(170,150,150,1)"},onpress:function(){f.player.stop()}}},
{type:"label",name:"rate_label_name",data:{x:10,y:78,text:"rate",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},{type:"label",name:"rate_label_0",data:{x:5,y:75,text:"0",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},{type:"label",name:"rate_label_1",data:{x:13.7,y:54,text:"1",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},{type:"label",name:"rate_label_2",data:{x:23,
y:75,text:"2",style:"fill:rgba(0,0,0,1); font-size:4px; font-family:Courier New; pointer-events: none;"}},{type:"dial_continuous",name:"rate",data:{x:15,y:65,r:9,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.35,style:{outerArc:"stroke:rgba(50,50,50,0.25); fill:none;"},onchange:function(b){f.player.rate(2*b)}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:30,width:185,height:45,selectionAreaToggle:function(b){f.player.loop({active:b})},onchange:function(b,c){if("lead"==
b)f.player.jumpTo(c);else if("selection_A"==b||"selection_B"==b)b=d.grapher_waveWorkspace.grapher_waveWorkspace.area(),b.A<b.B?f.player.loop({start:b.A,end:b.B}):f.player.loop({start:b.B,end:b.A})}}}]},f=object.builder(object.player,d);f.player=new part.circuit.audio.player(system.audio.context);f.player.out_right().connect(d.connectionNode_audio.outRight.in());f.player.out_left().connect(d.connectionNode_audio.outLeft.in());setInterval(function(){if(f.player.isLoaded()){var b=system.utility.math.seconds2time(Math.round(f.player.currentTime()));
d.readout_sixteenSegmentDisplay.time.text(system.utility.misc.padString(b.h,2,"0")+":"+system.utility.misc.padString(b.m,2,"0")+":"+system.utility.misc.padString(b.s,2,"0"));d.readout_sixteenSegmentDisplay.time.print();d.grapher_waveWorkspace.grapher_waveWorkspace.select(f.player.progress())}},1E3/30);f.i={loadByURL:function(b){f.player.load("url",function(b){d.grapher_waveWorkspace.grapher_waveWorkspace.draw(f.player.waveformSegment());d.grapher_waveWorkspace.grapher_waveWorkspace.select(0);d.grapher_waveWorkspace.grapher_waveWorkspace.area(-1,
-1);d.readout_sixteenSegmentDisplay.trackNameReadout.text(b.name);d.readout_sixteenSegmentDisplay.trackNameReadout.print("smart")},b)}};d.dial_continuous.rate.set(.5);return f};this.player.metadata={name:"Player",helpurl:"https://metasophiea.com/curve/help/objects/player/"};this.basicSequencer=function(b,e,c){var d={type:"basicSequencer",x:b,y:e,base:{type:"path",points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"sequencer",
name:"main",data:{x:10,y:20,width:780,height:170,xCount:64,yCount:10,event:function(b){for(var c=0;c<b.length;c++)d.connectionNode_data["output_"+b[c].line].send("hit",{velocity:b[c].strength})},onchangeviewarea:function(b){d.rangeslide.viewselect.set({start:b.left,end:b.right},!1)}}},{type:"rangeslide",name:"viewselect",data:{x:10,y:20,height:780,width:10,angle:-Math.PI/2,handleHeight:.03125,spanWidth:1,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",
invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(220,220,220,1)"},onchange:function(b){d.sequencer.main.viewArea({left:b.start,right:b.end},!1)}}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"fill:rgba(229, 229, 229,1)",check:"fill:rgba(252,252,252,1)"},onchange:function(b){d.sequencer.main.automove(b)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"fill:rgba(229, 221, 112,1)",check:"fill:rgba(252,244,128,1)"},
onchange:function(b){d.sequencer.main.loopActive(b)}}},{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/2,handleHeight:.03125,spanWidth:.75,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(255,247,145,0.5)"},onchange:function(b){var c=Math.round(64*b.start);b=Math.round(64*b.end);0==b&&(b=1);d.sequencer.main.loopPeriod(c,b)}}},{type:"button_rect",name:"progress",
data:{x:10,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",hover_press:"fill:rgba(180,180,180,1)"},onpress:function(){d.sequencer.main.progress()}}},{type:"connectionNode_data",name:"progress",data:{x:800,y:5,width:5,height:20,receive:function(){d.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{path:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"button_rect",
name:"reset",data:{x:40,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",hover_press:"fill:rgba(180,180,180,1)"},onpress:function(){d.sequencer.main.playheadPosition(0)}}},{type:"connectionNode_data",name:"reset",data:{x:800,y:30,width:5,height:20,receive:function(){d.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{path:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},
{type:"path",name:"reset_line",data:{path:[{x:49,y:209},{x:49,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}}]};for(b=0;10>b;b++)d.elements.push({type:"connectionNode_data",name:"output_"+b,data:{x:-5,y:11+18*b,width:5,height:16,receive:function(){d.sequencer.main.playheadPosition(0)}}});var f=object.builder(object.basicSequencer,d);f.exportData=function(){return{loop:{active:d.checkbox_rect.loopActive.get(),range:d.sequencer.main.loopPeriod()},autofollow:d.checkbox_rect.followPlayhead.get(),
notes:d.sequencer.main.getAllNotes()}};f.importData=function(b){d.sequencer.main.addNotes(b.notes);f.i.loopActive(b.loop.active);d.rangeslide.loopSelect.set(b.loop.range);d.checkbox_rect.followPlayhead.set(b.autofollow)};f.i={addNote:function(b,c,e,f){d.sequencer.main.addNote(b,c,e,void 0===f?1:f)},addNotes:function(b){d.sequencer.main.addNotes(b)},getNotes:function(){return d.sequencer.main.getAllNotes()},loopActive:function(b){d.checkbox_rect.loopActive.set(b)}};return f};this.basicSequencer.metadata=
{name:"Basic Sequencer (Multi Pulse Out)",helpurl:"https://metasophiea.com/curve/help/objects/basicSequencer_pulseOut/"};this.launchpad=function(b,e,c){function d(){for(var b=0;b<f.yCount;b++)h.rastorgrid.rastorgrid.light(g.internalCircuits.previousPosition(),b,!1),h.rastorgrid.rastorgrid.light(g.internalCircuits.position(),b,!0)}var f={xCount:8,yCount:8},h={type:"launchpad",x:b,y:e,base:{type:"path",points:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],style:"fill:rgba(200,200,200,1)"},
elements:[{type:"connectionNode_data",name:"pulse",data:{x:125,y:5,width:5,height:10,receive:function(){g.internalCircuits.inc();d()}}},{type:"connectionNode_data",name:"nextPage",data:{x:125,y:22.5,width:5,height:10,receive:function(){g.internalCircuits.incPage()}}},{type:"connectionNode_data",name:"prevPage",data:{x:125,y:35,width:5,height:10,receive:function(){g.internalCircuits.decPage()}}},{type:"button_rect",name:"pulse",data:{x:100,y:5,width:20,height:10,style:{up:"fill:rgba(175,175,175,1)",
hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){g.internalCircuits.inc();d()}}},{type:"rastorgrid",name:"rastorgrid",data:{x:5,y:5,width:90,height:90,xCount:f.xCount,yCount:f.yCount,style:{backing:"fill:rgba(200,175,200,1)",check:"fill:rgba(150,125,150,1)",backingGlow:"fill:rgba(225,175,225,1)",checkGlow:"fill:rgba(200,125,200,1)"},onchange:function(b){g.internalCircuits.importPage(b)}}},{type:"sevenSegmentDisplay",name:"pageNumber",data:{x:100,y:22.5,width:20,
height:22.5,style:{background:"fill:rgba(200,175,200,1)",glow:"fill:rgba(225,225,225,1)",dim:"fill:rgba(150,125,150,1"}}},{type:"button_rect",name:"nextPage",data:{x:102.5,y:17.5,width:15,height:5,selectable:!1,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){g.internalCircuits.incPage()}}},{type:"button_rect",name:"prevPage",data:{x:102.5,y:45,width:15,height:5,selectable:!1,style:{up:"fill:rgba(175,175,175,1)",hover:"fill:rgba(220,220,220,1)",
hover_press:"fill:rgba(150,150,150,1)"},onpress:function(){g.internalCircuits.decPage()}}}]};for(b=0;b<f.yCount;b++)h.elements.push({type:"connectionNode_data",name:"out_"+b,data:{x:-5,y:12.5*b+2.5,width:5,height:7.5}});var g=object.builder(object.launchpad,h);g.exportData=function(){return{currentPage:g.internalCircuits.page(),data:g.internalCircuits.exportPages()}};g.importData=function(b){void 0!=b.data&&g.internalCircuits.importPages(b.data);b.currentPage&&g.internalCircuits.page(b.currentPage)};
g.internalCircuits=new part.circuit.sequencing.launchpad(f.xCount,f.yCount);g.internalCircuits.commands=function(b){for(var c=0;c<f.yCount;c++)b[c]&&g.io["out_"+c].send("pulse")};g.internalCircuits.pageChange=function(b){h.sevenSegmentDisplay.pageNumber.enterCharacter(""+b);b=g.internalCircuits.exportPage();void 0==b?h.rastorgrid.rastorgrid.clear():h.rastorgrid.rastorgrid.set(b)};g.i={importPage:function(b,c){g.internalCircuits.importPage(b,c)},exportPage:function(b){return g.internalCircuits.exportPage(b)},
importPages:function(b){g.internalCircuits.importPages(b)},exportPages:function(){return g.internalCircuits.exportPages()},setPage:function(b){g.internalCircuits.page(b)}};d();h.sevenSegmentDisplay.pageNumber.enterCharacter("0");return g};this.launchpad.metadata={name:"Launchpad",helpurl:"https://metasophiea.com/curve/help/objects/launchpad/"};this.basicSequencer_midiOut=function(b,e,c){c=[0,0,1,0,1,0,1,0,0,1,0,1];var d=c.length-"C C# D D# E F F# G G# A A# B".split(" ").indexOf(system.audio.num2name(131).slice(1));
c=c.slice(d).concat(c.slice(0,d));var f={type:"basicSequencer_midiOut",x:b,y:e,base:{type:"path",points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:"fill:rgba(200,200,200,1)"},elements:[{type:"connectionNode_data",name:"midiout",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"sequencer",name:"main",data:{x:20,y:20,width:770,height:170,xCount:64,yCount:108,event:function(b){for(var c=0;c<b.length;c++)f.connectionNode_data.midiout.send("midinumber",{num:131-b[c].line,
velocity:b[c].strength})},style:{horizontalStrip_pattern:c},onchangeviewarea:function(b){f.rangeslide.viewselect_x.set({start:b.left,end:b.right},!1);f.rangeslide.viewselect_y.set({start:b.top,end:b.bottom},!1)}}},{type:"rangeslide",name:"viewselect_y",data:{x:10,y:20,height:170,width:10,angle:0,handleHeight:.0625,spanWidth:1,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(220,220,220,1)"},
onchange:function(b){f.sequencer.main.viewArea({top:b.start,bottom:b.end},!1)}}},{type:"rangeslide",name:"viewselect_x",data:{x:20,y:20,height:770,width:10,angle:-Math.PI/2,handleHeight:.03125,spanWidth:1,style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(220,220,220,1)"},onchange:function(b){f.sequencer.main.viewArea({left:b.start,right:b.end},!1)}}},{type:"checkbox_rect",name:"followPlayhead",
data:{x:100,y:205,width:15,height:15,style:{backing:"fill:rgba(229, 229, 229,1)",check:"fill:rgba(252,252,252,1)"},onchange:function(b){f.sequencer.main.automove(b)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"fill:rgba(229, 221, 112,1)",check:"fill:rgba(252,244,128,1)"},onchange:function(b){f.sequencer.main.loopActive(b)}}},{type:"rangeslide",name:"loopSelect",data:{x:20,y:200,height:770,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:.75,
style:{handle:"fill:rgba(240,240,240,1)",backing:"fill:rgba(150,150,150,1)",slot:"fill:rgba(50,50,50,1)",invisibleHandle:"fill:rgba(0,0,0,0);",span:"fill:rgba(255,247,145,0.5)"},onchange:function(b){var c=Math.round(64*b.start);b=Math.round(64*b.end);0==b&&(b=1);f.sequencer.main.loopPeriod(c,b)}}},{type:"button_rect",name:"progress",data:{x:10,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",hover_press:"fill:rgba(180,180,180,1)"},onpress:function(){f.sequencer.main.progress()}}},
{type:"connectionNode_data",name:"progress",data:{x:800,y:5,width:5,height:20,receive:function(){f.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{path:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"button_rect",name:"reset",data:{x:40,y:205,width:25,height:15,style:{up:"fill:rgba(220,220,220,1)",hover:"fill:rgba(240,240,240,1)",hover_press:"fill:rgba(180,180,180,1)"},onpress:function(){f.sequencer.main.playheadPosition(0)}}},
{type:"connectionNode_data",name:"reset",data:{x:800,y:30,width:5,height:20,receive:function(){f.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{path:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}},{type:"path",name:"reset_line",data:{path:[{x:49,y:209},{x:49,y:216}],style:"fill:none; stroke:rgba(150,150,150,1); stroke-width:1; pointer-events: none;"}}]},h=object.builder(object.basicSequencer_midiOut,
f);h.exportData=function(){return{loop:{active:f.checkbox_rect.loopActive.get(),range:f.sequencer.main.loopPeriod()},autofollow:f.checkbox_rect.followPlayhead.get(),notes:f.sequencer.main.getAllNotes(),viewArea:f.sequencer.main.viewArea()}};h.importData=function(b){f.sequencer.main.addNotes(b.notes);h.i.loopActive(b.loop.active);f.rangeslide.loopSelect.set(b.loop.range);f.checkbox_rect.followPlayhead.set(b.autofollow);f.sequencer.main.viewArea(b.viewArea)};h.i={addNote:function(b,c,d,e){f.sequencer.main.addNote(131-
b,c,d,void 0===e?1:e)},addNotes:function(b){for(var c=0;c<b.length;c++)this.addNote(b[c].line,b[c].position,b[c].length,b[c].strength)},getNotes:function(){return f.sequencer.main.getAllNotes()},loopActive:function(b){f.checkbox_rect.loopActive.set(b)},stepSize:f.sequencer.main.step};f.rangeslide.viewselect_y.set({start:.3,end:.7});return h};this.basicSequencer_midiOut.metadata={name:"Basic Sequencer (Midi Out)",helpurl:"https://metasophiea.com/curve/help/objects/basicSequencer_midiOut/"};this.basicMixer=
function(b,e){var c={type:"basicMixer",x:b,y:e,base:{points:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],style:"fill:rgba(200,200,200,0);"},elements:[{type:"connectionNode_audio",name:"input_0",data:{type:0,x:90,y:10,width:20,height:20}},{type:"connectionNode_audio",name:"input_1",data:{type:0,x:90,y:35,width:20,height:20}},{type:"connectionNode_audio",name:"input_2",data:{type:0,x:90,y:60,width:20,height:20}},{type:"connectionNode_audio",name:"input_3",data:{type:0,x:90,y:85,width:20,height:20}},
{type:"connectionNode_audio",name:"input_4",data:{type:0,x:90,y:110,width:20,height:20}},{type:"connectionNode_audio",name:"input_5",data:{type:0,x:90,y:135,width:20,height:20}},{type:"connectionNode_audio",name:"input_6",data:{type:0,x:90,y:160,width:20,height:20}},{type:"connectionNode_audio",name:"input_7",data:{type:0,x:90,y:185,width:20,height:20}},{type:"connectionNode_audio",name:"output_0",data:{type:1,x:-10,y:5,width:20,height:20}},{type:"connectionNode_audio",name:"output_1",data:{type:1,
x:-10,y:30,width:20,height:20}},{type:"path",name:"backing",data:{path:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],style:"fill:rgba(200,200,200,1);pointer-events:none;"}},{type:"text",name:"gain",data:{x:80,y:6.5,text:"gain",style:"fill:rgb(150,150,150); font-size:4px; font-family:Courier New;"}},{type:"text",name:"pan",data:{x:56.5,y:6.5,text:"pan",style:"fill:rgb(150,150,150); font-size:4px; font-family:Courier New;"}},{type:"rect",name:"vertical",data:{x:22.5,y:6,width:2,height:190,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},
{type:"rect",name:"overTheTop",data:{x:10,y:6,width:14,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"down",data:{x:10,y:6,width:2,height:35,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"inTo0",data:{x:2,y:14,width:10,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}},{type:"rect",name:"inTo1",data:{x:2,y:39,width:10,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}}]};for(b=0;8>b;b++)c.elements.push({type:"rect",
name:"line_"+b,data:{x:23,y:19.1+25*b,width:75,height:2,style:"fill:rgba(150,150,150,1); pointer-events: none;"}}),c.elements.push({type:"dial_continuous",name:"gain_"+b,data:{x:85,y:20+25*b,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){return function(c){d["splitter_"+b].inGain(c)}}(b)}}),c.elements.push({type:"dial_continuous",
name:"pan_"+b,data:{x:60,y:20+25*b,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"fill:rgba(220,220,220,1)",slot:"fill:rgba(50,50,50,1)",needle:"fill:rgba(250,150,150,1)",outerArc:"fill:none; stroke:rgb(150,150,150); stroke-width:1;"},onchange:function(b){return function(c){d["splitter_"+b].outGain(0,c);d["splitter_"+b].outGain(1,1-c)}}(b)}});var d=object.builder(object.basicMixer,c);for(b=0;8>b;b++)d["splitter_"+b]=new part.circuit.audio.channelMultiplier(system.audio.context,
2),c.connectionNode_audio["input_"+b].out().connect(d["splitter_"+b].in()),d["splitter_"+b].out(0).connect(c.connectionNode_audio.output_0.in()),d["splitter_"+b].out(1).connect(c.connectionNode_audio.output_1.in());d.i={gain:function(b,d){c.dial_continuous["gain_"+b].set(d)},pan:function(b,d){c.dial_continuous["pan_"+b].set(d)}};for(b=0;8>b;b++)d.i.gain(b,.5),d.i.pan(b,.5);return d};this.basicMixer.metadata={name:"Basic Audio Mixer",helpurl:"https://metasophiea.com/curve/help/objects/basicAudioMixer/"}};
object.builder=function(b,e){var c=part.builder("g",e.type,{x:e.x,y:e.y});void 0==e.base.type&&(e.base.type="path");switch(e.base.type){case "rect":e.base.points=[{x:e.x,y:e.y},{x:e.width,y:e.y},{x:e.width,y:e.height},{x:e.x,y:e.height}];system.utility.object.generateSelectionArea(e.base.points,c);e.base=part.builder("rect",null,{x:e.base.x,y:e.base.y,width:e.base.width,height:e.base.height,angle:e.base.angle,style:e.base.style});break;case "circle":var d=2*Math.PI/12;e.base.points=[];for(var f=0;12>
f;f++)e.base.points.push({x:e.base.x-Math.sin(f*d)*e.base.r,y:e.base.y-Math.cos(f*d)*e.base.r});system.utility.object.generateSelectionArea(e.base.points,c);e.base=part.builder("circle",null,{x:e.base.x,y:e.base.y,r:e.base.r,angle:e.base.angle,style:e.base.style});break;case "path":system.utility.object.generateSelectionArea(e.base.points,c);e.base=part.builder("path",null,{path:e.base.points,lineType:"L",style:e.base.style});break;default:console.error("Unknown base type:",e.base.type,'when creating object "'+
e.type+'"');return}c.append(e.base);e.skipGrapple||system.mouse.declareObjectGrapple(e.base,c,b);if(e.elements)for(f=0;f<e.elements.length;f++)e[e.elements[f].type]||(e[e.elements[f].type]={}),e.elements[f].name in e[e.elements[f].type]?console.warn('error: element with the name "'+e.elements[f].name+'" already exists. Element:',e.elements[f],"will not be added"):(e[e.elements[f].type][e.elements[f].name]=part.builder(e.elements[f].type,e.elements[f].name,e.elements[f].data),c.append(e[e.elements[f].type][e.elements[f].name]));
c.io={};if(e.connectionNode_audio)for(b=Object.keys(e.connectionNode_audio),f=0;f<b.length;f++)b[f]in c.io?console.warn('error: connection node with the name "'+b[f]+'" already exists in the .io group. Node ',e.connectionNode_data[b[f]]," will not be added"):c.io[b[f]]=e.connectionNode_audio[b[f]];if(e.connectionNode_data)for(b=Object.keys(e.connectionNode_data),f=0;f<b.length;f++)b[f]in c.io?console.warn('error: connection node with the name "'+b[f]+'" already exists in the .io group. Node ',e.connectionNode_data[b[f]],
" will not be added"):c.io[b[f]]=e.connectionNode_data[b[f]];return c};var control=new function(){this.objects=new function(){this.menubar=function(){for(var b=system.utility.workspace.getViewportDimensions().width,e=void 0,c=void 0,d={type:"menubar",skipGrapple:!0,x:0,y:0,base:{points:[{x:0,y:0},{x:b,y:0},{x:b,y:20},{x:0,y:20}],style:"fill:rgba(240,240,240,1);"},elements:[]},f=b=0;f<this.menubar.dropdowns.length;f++)d.elements.push({type:"button_rect",name:f,data:{x:b,y:0,width:this.menubar.dropdowns[f].width,
height:20,text:this.menubar.dropdowns[f].text,hoverable:!1,pressable:!1,selectable:!0,style:{up:"fill:rgba(240,240,240,1)",select:"fill:rgba(229,167,255,1)"},onpress:function(b){return function(){e=d.button_rect[b].select()?void 0:b}}(f),onenter:function(b){return function(c,f){void 0!=e&&e!=b&&(d.button_rect[e].select(!1),e=b,0==f.buttons&&d.button_rect[e].select(!0))}}(f),onselect:function(b,f,k){return function(){for(var g=0,m=0;m<k.menubar.dropdowns[b].itemList.length;m++)switch(k.menubar.dropdowns[b].itemList[m]){case "break":g+=
k.menubar.dropdowns[b].breakHeight;break;case "space":g+=k.menubar.dropdowns[b].spaceHeight;break;default:g+=k.menubar.dropdowns[b].listItemHeight}c=part.builder("list","createMenu",{x:f,y:20,width:k.menubar.dropdowns[b].listWidth,height:g,itemHeightMux:k.menubar.dropdowns[b].listItemHeight/g,breakHeightMux:k.menubar.dropdowns[b].breakHeight/g,spaceHeightMux:k.menubar.dropdowns[b].spaceHeight/g,itemSpacingMux:0,list:k.menubar.dropdowns[b].itemList,selectable:!1,multiSelect:!1,style:{listItemText:"fill:rgba(0,0,0,1); font-size:15; font-family:Helvetica; alignment-baseline:central; pointer-events: none; user-select: none; white-space: pre;",
background_hover:"fill:rgba(229,167,255,1)",backing:"fill:rgba(240,240,240,1)",background_up:"fill:rgba(240,240,240,1)"}});c.onrelease=function(){d.button_rect[b].select(!1);e=void 0};h.append(c)}}(f,b,this),ondeselect:function(){h.removeChild(c)}}}),this.menubar.dropdowns[f].x=b,b+=this.menubar.dropdowns[f].width;var h=object.builder(object.data_duplicator,d);h.i={report:function(b){void 0!=b&&(d.text.report.innerHTML=b)},closeEverything:function(){void 0!=e&&(d.button_rect[e].select(!1),e=void 0)}};
return h};this.menubar.dropdowns=[{text:"file",width:45,listWidth:175,listItemHeight:22.5,breakHeight:1,spaceHeight:2,itemList:[{text_left:"New Scene",function:function(){confirm("This will clear the current scene! Are you sure?")&&control.i.scene.new()}},{text_left:"Open Scene",text_right:"ctrl-f2",function:function(){control.i.scene.load()}},{text_left:"Save Scene",text_right:"ctrl-f3",function:function(){control.i.scene.save(control.project.name)}}]},{text:"edit",width:45,listWidth:150,listItemHeight:22.5,
breakHeight:1,spaceHeight:2,itemList:[{text_left:"Cut",text_right:"ctrl-x",function:function(){system.selection.cut()}},{text_left:"Copy",text_right:"ctrl-c",function:function(){system.selection.copy()}},{text_left:"Paste",text_right:"ctrl-v",function:function(){system.selection.paste()}},{text_left:"Duplicate",text_right:"ctrl-b",function:function(){system.selection.duplicate()}},{text_left:"Delete",text_right:"del",function:function(){system.selection.delete()}}]},{text:"create",width:65,listWidth:250,
listItemHeight:22.5,breakHeight:1,spaceHeight:2,itemList:function(){var b=[];for(i in object)b.push({text_left:object[i].metadata?object[i].metadata.name:i,function:function(b){return function(){var c=system.utility.workspace.pointConverter.browser2workspace(30,30);system.utility.workspace.placeAndReturnObject(object[b](c.x,c.y))}}(i)});b.sort(function(b,c){return b.text_left.toLowerCase()<c.text_left.toLowerCase()?-1:b.text_left.toLowerCase()>c.text_left.toLowerCase()?1:0});return b}()},{text:"help",
width:50,listWidth:150,listItemHeight:22.5,breakHeight:1,spaceHeight:2,itemList:[{text_left:"Help Docs",text_right:"(empty)",function:function(){system.utility.misc.openURL(system.super.helpFolderLocation)}}]}]};this.mousemove=function(b){};this.mousedown=function(b){null==system.utility.workspace.objectUnderPoint(b.x,b.y)&&control.i.menubar.closeEverything()};this.mousewheel=function(b){};this.keydown=function(b){switch(b.key.toLowerCase()){case "backspace":case "delete":system.selection.delete();
break;case "x":if(!b[system.super.keys.ctrl])break;system.selection.cut();break;case "c":if(!b[system.super.keys.ctrl])break;system.selection.copy();break;case "v":if(!b[system.super.keys.ctrl])break;system.selection.paste();break;case "b":if(!b[system.super.keys.ctrl])break;system.selection.duplicate();break;case "f1":if(b=system.utility.workspace.objectUnderPoint(system.mouse.currentPosition[0],system.mouse.currentPosition[1]))object[b.id].metadata?system.utility.misc.openURL(object[b.id].metadata.helpurl):
console.warn("bad help url, please add metadata to your object file ->",b.id),system.keyboard.releaseAll();break;case "f2":if(!b[system.super.keys.ctrl])break;this.i.scene.load();break;case "f3":b[system.super.keys.ctrl]&&this.i.scene.save(this.project.name)}};this.keyup=function(b){};this.i={scene:{new:function(){system.utility.workspace.clear()},load:function(){system.utility.workspace.saveload.load(function(b){null==b?control.i.menubar.report("invalid file","error"):control.project.name=b.sceneName})},
save:function(b){system.utility.workspace.saveload.save(b)}},menubar:{obj:void 0,report:function(b,e){console.log((void 0===e?"default":e)+" - "+b)},place:function(){void 0!=this.obj&&system.pane.control.remove(this.obj);this.obj=system.utility.workspace.placeAndReturnObject(control.objects.menubar(),"control")},closeEverything:function(){this.obj.i.closeEverything()}},objectPane:{obj:void 0,open:function(){void 0==this.obj&&(this.obj=system.utility.workspace.placeAndReturnObject(control.objects.objectPane(10,
30),"menu"))},close:function(){void 0!=this.objectPane.obj&&(system.utility.object.deleteObject(this.obj),this.obj=void 0)}}};this.project={name:"myProject"}};setTimeout(function(){system.super.enableMenubar&&control.i.menubar.place()},1)};
