var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(g){var f=0;return function(){return f<g.length?{done:!1,value:g[f++]}:{done:!0}}};$jscomp.arrayIterator=function(g){return{next:$jscomp.arrayIteratorImpl(g)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,f,d){g!=Array.prototype&&g!=Object.prototype&&(g[f]=d.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var g=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+g++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.iterator;g||(g=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[g]&&$jscomp.defineProperty(Array.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.asyncIterator;g||(g=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(g){$jscomp.initSymbolIterator();g={next:g};g[$jscomp.global.Symbol.iterator]=function(){return this};return g};
$jscomp.iteratorFromArray=function(g,f){$jscomp.initSymbolIterator();g instanceof String&&(g+="");var d=0,e={next:function(){if(d<g.length){var a=d++;return{value:f(a,g[a]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(g,f,d,e){if(f){d=$jscomp.global;g=g.split(".");for(e=0;e<g.length-1;e++){var a=g[e];a in d||(d[a]={});d=d[a]}g=g[g.length-1];e=d[g];f=f(e);f!=e&&null!=f&&$jscomp.defineProperty(d,g,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.keys",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(f){return f})}},"es6","es3");
$jscomp.polyfill("Array.from",function(g){return g?g:function(f,d,e){d=null!=d?d:function(a){return a};var a=[],b="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];if("function"==typeof b){f=b.call(f);for(var c=0;!(b=f.next()).done;)a.push(d.call(e,b.value,c++))}else for(b=f.length,c=0;c<b;c++)a.push(d.call(e,f[c],c));return a}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var g={},f=Object.create(new $jscomp.global.Proxy(g,{get:function(d,e,a){return d==g&&"q"==e&&a==f}}));return!0===f.q}catch(d){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(g){var f="undefined"!=typeof Symbol&&Symbol.iterator&&g[Symbol.iterator];return f?f.call(g):$jscomp.arrayIterator(g)};
$jscomp.owns=function(g,f){return Object.prototype.hasOwnProperty.call(g,f)};
$jscomp.polyfill("WeakMap",function(g){function f(){if(!g||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),c=new g([[a,2],[b,3]]);if(2!=c.get(a)||3!=c.get(b))return!1;c.delete(a);c.set(b,4);return!c.has(a)&&4==c.get(b)}catch(l){return!1}}function d(){}function e(a){if(!$jscomp.owns(a,b)){var c=new d;$jscomp.defineProperty(a,b,{value:c})}}function a(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof d)return a;e(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(g&&
$jscomp.ES6_CONFORMANCE)return g}else if(f())return g;var b="$jscomp_hidden_"+Math.random();a("freeze");a("preventExtensions");a("seal");var c=0,h=function(a){this.id_=(c+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,c){e(a);if(!$jscomp.owns(a,b))throw Error("WeakMap key fail: "+a);a[b][this.id_]=c;return this};h.prototype.get=function(a){return $jscomp.owns(a,b)?a[b][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,b)&&$jscomp.owns(a[b],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,b)&&$jscomp.owns(a[b],this.id_)?delete a[b][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(g){function f(){if($jscomp.ASSUME_NO_NATIVE_MAP||!g||"function"!=typeof g||!g.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),b=new g($jscomp.makeIterator([[a,"s"]]));if("s"!=b.get(a)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var c=b.entries(),h=c.next();if(h.done||h.value[0]!=a||"s"!=h.value[1])return!1;h=c.next();return h.done||4!=h.value[0].x||"t"!=h.value[1]||!c.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(g&&$jscomp.ES6_CONFORMANCE)return g}else if(f())return g;$jscomp.initSymbolIterator();var d=new WeakMap,e=function(a){this.data_={};this.head_=c();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(b,c){b=0===b?0:b;var k=a(this,b);k.list||(k.list=this.data_[k.id]=[]);k.entry?k.entry.value=c:(k.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,
value:c},k.list.push(k.entry),this.head_.previous.next=k.entry,this.head_.previous=k.entry,this.size++);return this};e.prototype.delete=function(b){b=a(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=c();this.size=0};e.prototype.has=function(b){return!!a(this,b).entry};
e.prototype.get=function(b){return(b=a(this,b).entry)&&b.value};e.prototype.entries=function(){return b(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return b(this,function(a){return a.key})};e.prototype.values=function(){return b(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var c=this.entries(),k;!(k=c.next()).done;)k=k.value,a.call(b,k[1],k[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var a=function(a,b){var c=b&&typeof b;"object"==
c||"function"==c?d.has(b)?c=d.get(b):(c=""+ ++h,d.set(b,c)):c="p_"+b;var k=a.data_[c];if(k&&$jscomp.owns(a.data_,c))for(a=0;a<k.length;a++){var m=k[a];if(b!==b&&m.key!==m.key||b===m.key)return{id:c,list:k,index:a,entry:m}}return{id:c,list:k,index:-1,entry:void 0}},b=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},c=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return e},"es6","es3");
$jscomp.polyfill("Set",function(g){function f(){if($jscomp.ASSUME_NO_NATIVE_SET||!g||"function"!=typeof g||!g.prototype.entries||"function"!=typeof Object.seal)return!1;try{var e=Object.seal({x:4}),a=new g($jscomp.makeIterator([e]));if(!a.has(e)||1!=a.size||a.add(e)!=a||1!=a.size||a.add({x:4})!=a||2!=a.size)return!1;var b=a.entries(),c=b.next();if(c.done||c.value[0]!=e||c.value[1]!=e)return!1;c=b.next();return c.done||c.value[0]==e||4!=c.value[0].x||c.value[1]!=c.value[0]?!1:b.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(g&&$jscomp.ES6_CONFORMANCE)return g}else if(f())return g;$jscomp.initSymbolIterator();var d=function(e){this.map_=new Map;if(e){e=$jscomp.makeIterator(e);for(var a;!(a=e.next()).done;)this.add(a.value)}this.size=this.map_.size};d.prototype.add=function(e){e=0===e?0:e;this.map_.set(e,e);this.size=this.map_.size;return this};d.prototype.delete=function(e){e=this.map_.delete(e);this.size=this.map_.size;return e};d.prototype.clear=function(){this.map_.clear();
this.size=0};d.prototype.has=function(e){return this.map_.has(e)};d.prototype.entries=function(){return this.map_.entries()};d.prototype.values=function(){return this.map_.values()};d.prototype.keys=d.prototype.values;d.prototype[Symbol.iterator]=d.prototype.values;d.prototype.forEach=function(e,a){var b=this;this.map_.forEach(function(c){return e.call(a,c,c,b)})};return d},"es6","es3");
$jscomp.polyfill("Object.entries",function(g){return g?g:function(f){var d=[],e;for(e in f)$jscomp.owns(f,e)&&d.push([e,f[e]]);return d}},"es8","es3");$jscomp.polyfill("Array.prototype.fill",function(g){return g?g:function(f,d,e){var a=this.length||0;0>d&&(d=Math.max(0,a+d));if(null==e||e>a)e=a;e=Number(e);0>e&&(e=Math.max(0,a+e));for(d=Number(d||0);d<e;d++)this[d]=f;return this}},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(g,f){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var a in e)$jscomp.owns(e,a)&&(g[a]=e[a])}return g};$jscomp.polyfill("Object.assign",function(g){return g||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.is",function(g){return g?g:function(f,d){return f===d?0!==f||1/f===1/d:f!==f&&d!==d}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(g){return g?g:function(f,d){var e=this;e instanceof String&&(e=String(e));var a=e.length;d=d||0;for(0>d&&(d=Math.max(d+a,0));d<a;d++){var b=e[d];if(b===f||Object.is(b,f))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(g,f,d){if(null==g)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return g+""};$jscomp.polyfill("String.prototype.includes",function(g){return g?g:function(f,d){return-1!==$jscomp.checkStringArgs(this,f,"includes").indexOf(f,d||0)}},"es6","es3");
$jscomp.polyfill("Math.sign",function(g){return g?g:function(f){f=Number(f);return 0===f||isNaN(f)?f:0<f?1:-1}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(f,d){return d})}},"es8","es3");$jscomp.polyfill("Math.log10",function(g){return g?g:function(f){return Math.log(f)/Math.LN10}},"es6","es3");
for(var __canvasElements=document.getElementsByTagName("canvas"),__canvasElements_count=0;__canvasElements_count<__canvasElements.length;__canvasElements_count++)if(__canvasElements[__canvasElements_count].hasAttribute("workspace")){var workspace=__canvasElements[__canvasElements_count];workspace.library=new function(){};workspace.library.math=new function(){this.averageArray=function(g){return g.reduce(function(f,d){return f+d},0)/g.length};this.distanceBetweenTwoPoints=function(g,f){return Math.pow(Math.pow(g.x-
f.x,2)+Math.pow(g.y-f.y,2),.5)};this.seconds2time=function(g){var f={h:0,m:0,s:0};f.h=Math.floor(g/3600);g-=3600*f.h;f.m=Math.floor(g/60);g-=60*f.m;f.s=g;return f};this.largestValueFound=function(g){return g.reduce(function(f,d){return Math.abs(f)>Math.abs(d)?f:d})};this.smallestValueFound=function(g){return g.reduce(function(f,d){return Math.abs(f)<Math.abs(d)?f:d})};this.cartesian2polar=function(g,f){return{dis:Math.pow(Math.pow(g,2)+Math.pow(f,2),.5),ang:0===g?0===f?0:0<f?.5*Math.PI:1.5*Math.PI:
0===f?0<=g?0:Math.PI:0<=g?Math.atan(f/g):Math.atan(f/g)+Math.PI}};this.polar2cartesian=function(g,f){return{x:f*Math.cos(g),y:f*Math.sin(g)}};this.cartesianAngleAdjust=function(g,f,d){g=this.cartesian2polar(g,f);g.ang+=d;return this.polar2cartesian(g.ang,g.dis)};this.boundingBoxFromPoints=function(g){if(0==g.length)return{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};for(var f=g[0].x,d=g[0].x,e=g[0].y,a=g[0].y,b=1;b<g.length;b++)g[b].x<f?f=g[b].x:g[b].x>d&&(d=g[b].x),g[b].y<e?e=g[b].y:g[b].y>a&&(a=g[b].y);
return{topLeft:{x:f,y:e},bottomRight:{x:d,y:a}}};this.pointsOfRect=function(g,f,d,e,a,b){a=void 0===a?0:a;b=void 0===b?{x:0,y:0}:b;var c=b.x*d,h=b.y*e,k=this.cartesian2polar(c,h);k=this.polar2cartesian(k.ang-a,k.dis);b={x:g-k.x,y:f-k.y};k=this.cartesian2polar(c-d,h);k=this.polar2cartesian(k.ang-a,k.dis);var m={x:g-k.x,y:f-k.y};k=this.cartesian2polar(c-d,h-e);k=this.polar2cartesian(k.ang-a,k.dis);d={x:g-k.x,y:f-k.y};k=this.cartesian2polar(c,h-e);k=this.polar2cartesian(k.ang-a,k.dis);return[b,m,d,{x:g-
k.x,y:f-k.y}]};this.pointsOfCircle=function(g,f,d,e){e=void 0===e?3:e;for(var a=[],b=0;b<e;b++)a.push({x:g+d*Math.sin(b/e*Math.PI*2),y:f+d*Math.cos(b/e*Math.PI*2)});return a};this.pointsOfText=function(g,f,d,e,a,b,c,h){var k=document.createElement("canvas").getContext("2d");k.font=b;k.textAlign=c;k.textBaseline=h;g=k.measureText(g).width/a;b=-b.split("pt")[0].split(" ").pop();isNaN(b)&&(b=-7.5);b/=a;a=[{x:f,y:d},{x:f+g,y:d},{x:f+g,y:d-b},{x:f,y:d-b}];g={start:0,end:0,center:g/2,left:g,right:g};b=
{alphabetic:b,top:0,hanging:0,middle:b/2,ideographic:0,bottom:b};for(k=0;k<a.length;k++)a[k]={x:a[k].x-g[c],y:a[k].y+b[h]};for(k=0;k<a.length;k++)a[k]=this.cartesianAngleAdjust(a[k].x-f,a[k].y-d,e),a[k].x+=f,a[k].y+=d;return a};this.relativeDistance=function(g,f,d,e,a){f=(e-f)/(d-f);if(void 0===a||!a){if(1<f)return g;if(0>f)return 0}return f*g};this.lineCorrecter=function(g,f,d){if(!(0>g.x1||0>g.x2||g.x1>d||g.x2>d||0>g.y1&&0>g.y2||g.y1>f&&g.y2>f))return d=(g.y2-g.y1)/(g.x2-g.x1),0>g.y1?(g.x1=(0-g.y1+
d*g.x1)/d,g.y1=0):0>g.y2&&(g.x2=(0-g.y2+d*g.x2)/d,g.y2=0),g.y1>f?(g.x1=(f-g.y1+d*g.x1)/d,g.y1=f):g.y2>f&&(g.x2=(f-g.y2+d*g.x2)/d,g.y2=f),g};this.normalizeStretchArray=function(g){var f=g.reduce(function(a,b,c,h){return b>h[a]?c:a},0),d=Math.abs(g[f]);g=g.map(function(a){return a/d});if(0==g[0]&&1==g[g.length-1])return g;var e=0!=g[0]?g[0]:g[g.length-1];return g=g.map(function(a){return(a-e)/(1-e)})};this.curvePoint=new function(){this.linear=function(g,f,d){f=void 0===f?0:f;return(void 0===g?.5:g)*
((void 0===d?1:d)-f)+f};this.sin=function(g,f,d){f=void 0===f?0:f;return Math.sin(Math.PI/2*(void 0===g?.5:g))*((void 0===d?1:d)-f)+f};this.cos=function(g,f,d){f=void 0===f?0:f;return(1-Math.cos(Math.PI/2*(void 0===g?.5:g)))*((void 0===d?1:d)-f)+f};this.s=function(g,f,d,e){f=void 0===f?0:f;d=void 0===d?1:d;e=void 0===e?8:e;return workspace.library.math.normalizeStretchArray([1/(1+Math.exp(-.5*-e)),1/(1+Math.exp(-e*((void 0===g?.5:g)-.5))),1/(1+Math.exp(.5*-e))])[1]*(d-f)+f};this.exponential=function(g,
f,d,e){f=void 0===f?0:f;d=void 0===d?1:d;e=void 0===e?2:e;return workspace.library.math.normalizeStretchArray([(Math.exp(0*e)-1)/(Math.E-1),(Math.exp(e*(void 0===g?.5:g))-1)/(Math.E-1),(Math.exp(1*e)-1)/(Math.E-1)])[1]*(d-f)+f}};this.curveGenerator=new function(){this.linear=function(g,f,d){f=void 0===f?0:f;d=void 0===d?1:d;g=Math.abs(void 0===g?2:g)-1;for(var e=[0],a=1;a<g;a++)e.push(a/g);e.push(1);g=d-f;for(a=0;a<e.length;a++)e[a]=e[a]*g+f;return e};this.sin=function(g,f,d){f=void 0===f?0:f;d=void 0===
d?1:d;g=Math.abs(void 0===g?2:g)-1;for(var e=[0],a=1;a<g;a++)e.push(Math.sin(Math.PI/2*(a/g)));e.push(1);g=d-f;for(a=0;a<e.length;a++)e[a]=e[a]*g+f;return e};this.cos=function(g,f,d){f=void 0===f?0:f;d=void 0===d?1:d;g=Math.abs(void 0===g?2:g)-1;for(var e=[0],a=1;a<g;a++)e.push(1-Math.cos(Math.PI/2*(a/g)));e.push(1);g=d-f;for(a=0;a<e.length;a++)e[a]=e[a]*g+f;return e};this.s=function(g,f,d,e){g=void 0===g?2:g;f=void 0===f?0:f;d=void 0===d?1:d;e=void 0===e?8:e;0==e&&(e=1E-6);for(var a=[],b=0;b<g;b++)a.push(1/
(1+Math.exp(-e*(b/g-.5))));g=workspace.library.math.normalizeStretchArray(a);d-=f;for(b=0;b<g.length;b++)g[b]=g[b]*d+f;return g};this.exponential=function(g,f,d,e){f=void 0===f?0:f;d=void 0===d?1:d;e=void 0===e?2:e;g=(void 0===g?2:g)-1;for(var a=[],b=0;b<=g;b++)a.push((Math.exp(b/g*e)-1)/(Math.E-1));a=system.utility.math.normalizeStretchArray(a);g=d-f;for(b=0;b<a.length;b++)a[b]=a[b]*g+f;return a}};this.detectOverlap=new function(){this.boundingBoxes=function(g,f){return!(g.bottomRight.y<f.topLeft.y||
g.topLeft.y>f.bottomRight.y||g.bottomRight.x<f.topLeft.x||g.topLeft.x>f.bottomRight.x)};this.pointWithinBoundingBox=function(g,f){return!(g.x<f.topLeft.x||g.y<f.topLeft.y||g.x>f.bottomRight.x||g.y>f.bottomRight.y)};this.pointWithinPoly=function(g,f){for(var d=!1,e=0,a=f.length-1;e<f.length;a=e++)f[e].y>g.y!=f[a].y>g.y&&g.x<(f[a].x-f[e].x)*(g.y-f[e].y)/(f[a].y-f[e].y)+f[e].x&&(d=!d);return d};this.lineSegments=function(g,f){var d=(f[1].y-f[0].y)*(g[1].x-g[0].x)-(f[1].x-f[0].x)*(g[1].y-g[0].y);if(0==
d)return null;var e=((f[1].x-f[0].x)*(g[0].y-f[0].y)-(f[1].y-f[0].y)*(g[0].x-f[0].x))/d;f=((g[1].x-g[0].x)*(g[0].y-f[0].y)-(g[1].y-g[0].y)*(g[0].x-f[0].x))/d;return{x:g[0].x+e*(g[1].x-g[0].x),y:g[0].y+e*(g[1].y-g[0].y),inSeg1:0<=e&&1>=e,inSeg2:0<=f&&1>=f}};this.overlappingPolygons=function(g,f){for(var d=0;d<g.length;d++)if(this.pointWithinPoly(g[d],f))return!0;for(d=0;d<f.length;d++)if(this.pointWithinPoly(f[d],g))return!0;var e=Array.apply(null,{length:g.length}).map(Number.call,Number).concat([0]),
a=Array.apply(null,{length:f.length}).map(Number.call,Number).concat([0]);for(d=0;d<e.length-1;d++)for(var b=0;b<a.length-1;b++){var c=this.lineSegments([g[e[d]],g[e[d+1]]],[f[a[b]],f[a[b+1]]]);if(null!=c&&c.inSeg1&&c.inSeg2)return!0}return!1}}};workspace.library.structure=new function(){this.functionListRunner=function(g){return function(f,d){for(var e=0;e<g.length;e++){for(var a=!0,b=0;b<g[e].requiredKeys.length;b++){a=!0;for(var c=0;c<g[e].requiredKeys[b].length&&(a=a&&workspace.system.keyboard.pressedKeys[g[e].requiredKeys[b][c]],
a);c++);if(a)break}if(a&&g[e].function(f,d))break}}};this.signalRegistry=function(g,f,d){g=void 0===g?-1:g;f=void 0===f?-1:f;d=void 0===d?-1:d;var e=[],a=[],b=[],c=[],h={},k=[];this.__dump=function(){console.log("---- signalRegistry dump ----");console.log("\tsignals");for(var a=0;a<e.length;a++)console.log("\t\t",a," "+JSON.stringify(e[a]));console.log("\tselectedSignals");for(a=0;a<tselectedSignals.length;a++)console.log("\t\t",a," "+JSON.stringify(tselectedSignals[a]));console.log("\tevents");
for(a=0;a<b.length;a++)console.log("\t\t",a," "+JSON.stringify(b[a]));console.log("\tevents_byID");for(a=0;a<c.length;a++)console.log("\t\t",a," "+JSON.stringify(c[a]));console.log("\tevents_byPosition");var d=Object.keys(h);for(a=0;a<d.length;a++)console.log("\t\t",d[a]," "+JSON.stringify(h[d[a]]));console.log("\tpositions");for(a=0;a<k.length;a++)console.log("\t\t",a," "+JSON.stringify(k[a]))};this.export=function(){return JSON.parse(JSON.stringify({signals:e,selectedSignals:a,events:b,events_byID:c,
events_byPosition:h,positions:k}))};this.import=function(d){e=JSON.parse(JSON.stringify(d.signals));a=JSON.parse(JSON.stringify(d.selectedSignals));b=JSON.parse(JSON.stringify(d.events));c=JSON.parse(JSON.stringify(d.events_byID));h=JSON.parse(JSON.stringify(d.events_byPosition));k=JSON.parse(JSON.stringify(d.positions))};this.getAllSignals=function(){return JSON.parse(JSON.stringify(e))};this.getAllEvents=function(){return JSON.parse(JSON.stringify(b))};this.getSignal=function(a){if(void 0!=e[a])return JSON.parse(JSON.stringify(e[a]))};
this.eventsBetween=function(a,c){for(var e=void 0==c?Array.from(new Set(k.filter(function(b){return b==a}))):Array.from(new Set(k.filter(function(b){return b>=a&&b<c}))),d=[],m=0;m<e.length;m++){e[m]=h[String(e[m])];for(var f=0;f<e[m].length;f++)d.push(b[e[m][f]])}return d.sort(function(a,b){return a.position<b.position?-1:a.position>b.position?1:0})};this.add=function(a,n){if(void 0!=a&&"line"in a&&"position"in a&&"length"in a){"strength"in a||(a.strength=1);0>a.line&&(a.line=0);0>a.length&&(a.length=
0);0>a.position&&(a.position=0);0>a.strength&&(a.strength=0);-1<f&&a.line>f-1&&(a.line=f-1);-1<d&&a.length>d&&(a.length=d);-1<g&&a.position>g&&(a.position=g-a.length);-1<g&&a.position+a.length>g&&(a.length=g-a.position);-1<g&&a.position+a.length>g&&(a.position=g-a.length);1<a.strength&&(a.strength=1);var m=0;if(void 0==n)for(;void 0!=e[m];)m++;else m=n;e[m]=JSON.parse(JSON.stringify(a));a=[{signalID:m,line:a.line,position:a.position,strength:a.strength},{signalID:m,line:a.line,position:a.position+
a.length,strength:0}];for(n=0;void 0!=b[n];)n++;b[n]=a[0];c[m]=[n];void 0==h[a[0].position]?h[a[0].position]=[n]:h[a[0].position].push(n);for(k.push(a[0].position);void 0!=b[n];)n++;b[n]=a[1];c[m]=c[m].concat(n);void 0==h[a[1].position]?h[a[1].position]=[n]:h[a[1].position].push(n);k.push(a[1].position);return m}};this.remove=function(a){if(void 0!=e[a]){delete e[a];for(var d=0;d<c[a].length;d++){var m=c[a][d];h[b[m].position].splice(h[b[m].position].indexOf(m),1);k.splice(k.indexOf(b[m].position),
1);0==h[b[m].position].length&&delete h[b[m].position];delete b[m]}delete c[a]}};this.update=function(a,b){void 0!=b&&("line"in b||(b.line=e[a].line),-1<g&&("position"in b&&"length"in b?b.length+b.position>g&&(b.length=g-b.position):("position"in b?e[a].length+b.position>=g&&(b.position=g-e[a].length):b.position=e[a].position,"length"in b?b.length+b.position>g&&(b.length=g-b.position):b.length=e[a].length)),"strength"in b||(b.strength=e[a].strength),this.remove(a),this.add(b,a))};this.reset=function(){e=
[];a=[];b=[];c=[];h={};k=[]}}};workspace.library.audio=new function(){this.context=new (window.AudioContext||window.webkitAudioContext);this.changeAudioParam=function(a,b,c,h,k,e){e=void 0===e?!0:e;if(null==c)return b.value;e&&b.cancelScheduledValues(a.currentTime);try{switch(k){case "linear":b.linearRampToValueAtTime(c,a.currentTime+h);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");0==c&&(c=1E-4);b.exponentialRampToValueAtTime(c,a.currentTime+
h);break;case "s":for(var d=c-b.value,m=workspace.library.math.curveGenerator.s(10),f=0;f<m.length;f++)m[f]=b.value+m[f]*d;b.setValueCurveAtTime(new Float32Array(m),a.currentTime,h);break;default:b.setTargetAtTime(c,a.currentTime,.001)}}catch(y){console.log("could not change param (possibly due to an overlap, or bad target value)"),console.log("audioParam:",b,"target:",c,"time:",h,"curve:",k,"cancelScheduledValues:",e),console.log(y)}};this.loadAudioFile=function(a,b,c){c=void 0===c?"":c;switch(void 0===
b?"file":b){case "url":b=new XMLHttpRequest;b.open("GET",c,!0);b.responseType="arraybuffer";b.onload=function(){workspace.library.audio.context.decodeAudioData(this.response,function(b){a({buffer:b,name:c.split("/").pop(),duration:b.duration})},function(a){console.warn("Error with decoding audio data"+a.err)})};b.send();break;default:var h=document.createElement("input");h.type="file";h.onchange=function(){var b=this.files[0],c=new FileReader;c.readAsArrayBuffer(b);c.onload=function(c){workspace.library.audio.context.decodeAudioData(c.target.result,
function(c){a({buffer:c,name:b.name,duration:c.duration})});h.remove()}};document.body.appendChild(h);h.click()}};this.waveformSegment=function(a,b,c){b=void 0===b?{start:0,end:1}:b;c=void 0===c?1E4:c;var h=a.getChannelData(0);b.start=b.start?b.start:0;b.end=b.end?b.end:1;var k=a.length*b.start;a=a.length*b.end;c=(a-k)/c;for(b=[];k<a;k+=Math.round(c))b.push(workspace.library.math.largestValueFound(h.slice(k,k+Math.round(c))));return b};this.loadBuffer=function(a,b,c,h){a=a.createBufferSource();a.buffer=
b;a.connect(c);a.onended=h;return a};this.destination=this.context.createGain();this.destination.connect(this.context.destination);this.destination._gain=1;this.destination.masterGain=function(a){if(void 0==a)return this.destination._gain;this._gain=a;workspace.library.audio.changeAudioParam(workspace.library.audio.context,this.gain,this._gain,.01,"instant",!0)};this.names_frequencies_split={0:{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,"A#":29.14,B:30.87},
1:{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},2:{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.8,A:110,"A#":116.5,B:123.5},3:{C:130.8,"C#":138.6,D:146.8,"D#":155.6,E:164.8,F:174.6,"F#":185,G:196,"G#":207.7,A:220,"A#":233.1,B:246.9},4:{C:261.6,"C#":277.2,D:293.7,"D#":311.1,E:329.6,F:349.2,"F#":370,G:392,"G#":415.3,A:440,"A#":466.2,B:493.9},5:{C:523.3,"C#":554.4,D:587.3,"D#":622.3,E:659.3,F:698.5,"F#":740,G:784,
"G#":830.6,A:880,"A#":932.3,B:987.8},6:{C:1047,"C#":1109,D:1175,"D#":1245,E:1319,F:1397,"F#":1480,G:1568,"G#":1661,A:1760,"A#":1865,B:1976},7:{C:2093,"C#":2217,D:2349,"D#":2489,E:2637,F:2794,"F#":2960,G:3136,"G#":3322,A:3520,"A#":3729,B:3951},8:{C:4186,"C#":4435,D:4699,"D#":4978,E:5274,F:5588,"F#":5920,G:6272,"G#":6645,A:7040,"A#":7459,B:7902}};this.names_frequencies={};for(var g=Object.entries(this.names_frequencies_split),f=0;f<g.length;f++)for(var d=Object.entries(this.names_frequencies_split[f]),
e=0;e<d.length;e++)this.names_frequencies[g[f][0]+d[e][0]]=d[e][1];this.frequencies_names={};g=Object.entries(this.names_frequencies);for(f=0;f<g.length;f++)this.frequencies_names[g[f][1]]=g[f][0];g="0C 0C# 0D 0D# 0E 0F 0F# 0G 0G# 0A 0A# 0B 1C 1C# 1D 1D# 1E 1F 1F# 1G 1G# 1A 1A# 1B 2C 2C# 2D 2D# 2E 2F 2F# 2G 2G# 2A 2A# 2B 3C 3C# 3D 3D# 3E 3F 3F# 3G 3G# 3A 3A# 3B 4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C 7C# 7D 7D# 7E 7F 7F# 7G 7G# 7A 7A# 7B 8C 8C# 8D 8D# 8E 8F 8F# 8G 8G# 8A 8A# 8B".split(" ");
this.midinumbers_names={};for(f=0;f<g.length;f++)this.midinumbers_names[f+24]=g[f];this.names_midinumbers={};g=Object.entries(this.midinumbers_names);for(f=0;f<g.length;f++)this.names_midinumbers[g[f][1]]=parseInt(g[f][0]);this.num2name=function(a){return this.midinumbers_names[a]};this.num2freq=function(a){return this.names_frequencies[this.midinumbers_names[a]]};this.name2num=function(a){return this.names_midinumbers[a]};this.name2freq=function(a){return this.names_frequencies[a]};this.freq2num=
function(a){return this.names_midinumbers[this.frequencies_names[a]]};this.freq2name=function(a){return this.frequencies_names[a]}};workspace.library.misc=new function(){this.blendColours=function(g,f,d){function e(a){a=a.split(",");a[0]=a[0].replace("rgba(","");a[3]=a[3].replace(")","");return a.map(function(a){return parseFloat(a)})}g=e(g);f=e(f);for(var a=[],b=0;b<g.length;b++)a[b]=(1-d)*g[b]+d*f[b];return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"};this.multiBlendColours=function(g,f){if(0==f)return g[0];
if(1==f)return g[g.length-1];f*=g.length-1;return workspace.library.misc.blendColours(g[~~f],g[~~f+1],f%1)};this.padString=function(g,f,d){d=void 0===d?" ":d;if(1>d.length)return g;for(g=""+g;g.length<f;)g=d+g;return g};this.compressString=function(g){return workspace.library.thirdparty.lzString.compress(g)};this.decompressString=function(g){return workspace.library.thirdparty.lzString.decompress(g)};this.serialize=function(g,f){f=void 0===f?!0:f;g=JSON.stringify(g,function(d,e){switch({}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()){case "function":return{__uniqueType:"function",
__value:e.toString(),__name:e.name};case "arraybuffer":return{__uniqueType:"arraybuffer",__value:btoa(String.fromCharCode(new Uint8Array(e)))};case "audiobuffer":d=[];for(var a=0;a<e.numberOfChannels;a++)d.push(Array.from(e.getChannelData(a)));return{__uniqueType:"audiobuffer",__channelData:d,__sampleRate:e.sampleRate,__numberOfChannels:e.numberOfChannels,__length:e.length};default:return e}});f&&(g=workspace.library.misc.compressString(g));return g};this.unserialize=function(g,f){if(void 0!==g)return(void 0===
f||f)&&(g=workspace.library.misc.decompressString(g)),JSON.parse(g,function(d,e){if("object"==typeof e&&null!=e&&"__uniqueType"in e)switch(e.__uniqueType){case "function":d=e.__value.substring(0,e.__value.indexOf("{"));d=d.substring(d.indexOf("(")+1,d.lastIndexOf(")"));e=e.__value.substring(e.__value.indexOf("{")+1,e.__value.lastIndexOf("}"));e=Function(d,e);break;case "arraybuffer":e=atob(e.__value);for(d=0;d<e.length;d++)e[d]=e[d].charCodeAt(0);e=new ArrayBuffer(e);break;case "audiobuffer":var a=
workspace.library.audio.context.createBuffer(e.__numberOfChannels,e.__length,e.__sampleRate);for(d=0;d<a.numberOfChannels;d++){workingBuffer=a.getChannelData(d);for(var b=0;b<a.length;b++)workingBuffer[b]=e.__channelData[d][b]}e=a;break;default:e=e.__value}return e})};this.openFile=function(g,f){f=void 0===f?"readAsBinaryString":f;var d=document.createElement("input");d.type="file";d.onchange=function(){var e=new FileReader;switch(f){case "readAsArrayBuffer":e.readAsArrayBuffer(this.files[0]);break;
default:e.readAsBinaryString(this.files[0])}e.onloadend=function(){g&&g(e.result)}};d.click()};this.printFile=function(g,f){var d=document.createElement("a");d.href=URL.createObjectURL(new Blob([f]));d.download=g;d.click()}};workspace.library.thirdparty=new function(){this.lzString=function(){var g=String.fromCharCode,f={},d={compress:function(e){return null==e?"":d._compress(e,6,function(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(a)})},decompress:function(e){if(null==
e)return"";if(""==e)return null;e=e.replace(/ /g,"+");return d._decompress(e.length,32,function(a){a=e.charAt(a);if(!f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]){f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]={};for(var b=0;65>b;b++)f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(b)]=b}return f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"][a]})},
_compress:function(e,a,b){if(null==e)return"";var c,h={},k={},d="",f=2,l=3,p=2,g=[],q=0,r=0,x;for(x=0;x<e.length;x+=1){var u=e.charAt(x);Object.prototype.hasOwnProperty.call(h,u)||(h[u]=l++,k[u]=!0);var w=d+u;if(Object.prototype.hasOwnProperty.call(h,w))d=w;else{if(Object.prototype.hasOwnProperty.call(k,d)){if(256>d.charCodeAt(0)){for(c=0;c<p;c++)q<<=1,r==a-1?(r=0,g.push(b(q)),q=0):r++;var t=d.charCodeAt(0);for(c=0;8>c;c++)q=q<<1|t&1,r==a-1?(r=0,g.push(b(q)),q=0):r++,t>>=1}else{t=1;for(c=0;c<p;c++)q=
q<<1|t,r==a-1?(r=0,g.push(b(q)),q=0):r++,t=0;t=d.charCodeAt(0);for(c=0;16>c;c++)q=q<<1|t&1,r==a-1?(r=0,g.push(b(q)),q=0):r++,t>>=1}f--;0==f&&(f=Math.pow(2,p),p++);delete k[d]}else for(t=h[d],c=0;c<p;c++)q=q<<1|t&1,r==a-1?(r=0,g.push(b(q)),q=0):r++,t>>=1;f--;0==f&&(f=Math.pow(2,p),p++);h[w]=l++;d=String(u)}}if(""!==d){if(Object.prototype.hasOwnProperty.call(k,d)){if(256>d.charCodeAt(0)){for(c=0;c<p;c++)q<<=1,r==a-1?(r=0,g.push(b(q)),q=0):r++;t=d.charCodeAt(0);for(c=0;8>c;c++)q=q<<1|t&1,r==a-1?(r=0,
g.push(b(q)),q=0):r++,t>>=1}else{t=1;for(c=0;c<p;c++)q=q<<1|t,r==a-1?(r=0,g.push(b(q)),q=0):r++,t=0;t=d.charCodeAt(0);for(c=0;16>c;c++)q=q<<1|t&1,r==a-1?(r=0,g.push(b(q)),q=0):r++,t>>=1}f--;0==f&&(f=Math.pow(2,p),p++);delete k[d]}else for(t=h[d],c=0;c<p;c++)q=q<<1|t&1,r==a-1?(r=0,g.push(b(q)),q=0):r++,t>>=1;f--;0==f&&p++}t=2;for(c=0;c<p;c++)q=q<<1|t&1,r==a-1?(r=0,g.push(b(q)),q=0):r++,t>>=1;for(;;)if(q<<=1,r==a-1){g.push(b(q));break}else r++;return g.join("")},_decompress:function(d,a,b){var c=[],
h=4,k=4,e=3,f=[],l,p,y=b(0),q=a,r=1;for(l=0;3>l;l+=1)c[l]=l;var x=0;var u=Math.pow(2,2);for(p=1;p!=u;){var w=y&q;q>>=1;0==q&&(q=a,y=b(r++));x|=(0<w?1:0)*p;p<<=1}switch(x){case 0:x=0;u=Math.pow(2,8);for(p=1;p!=u;)w=y&q,q>>=1,0==q&&(q=a,y=b(r++)),x|=(0<w?1:0)*p,p<<=1;var t=g(x);break;case 1:x=0;u=Math.pow(2,16);for(p=1;p!=u;)w=y&q,q>>=1,0==q&&(q=a,y=b(r++)),x|=(0<w?1:0)*p,p<<=1;t=g(x);break;case 2:return""}l=c[3]=t;for(f.push(t);;){if(r>d)return"";x=0;u=Math.pow(2,e);for(p=1;p!=u;)w=y&q,q>>=1,0==q&&
(q=a,y=b(r++)),x|=(0<w?1:0)*p,p<<=1;switch(t=x){case 0:x=0;u=Math.pow(2,8);for(p=1;p!=u;)w=y&q,q>>=1,0==q&&(q=a,y=b(r++)),x|=(0<w?1:0)*p,p<<=1;c[k++]=g(x);t=k-1;h--;break;case 1:x=0;u=Math.pow(2,16);for(p=1;p!=u;)w=y&q,q>>=1,0==q&&(q=a,y=b(r++)),x|=(0<w?1:0)*p,p<<=1;c[k++]=g(x);t=k-1;h--;break;case 2:return f.join("")}0==h&&(h=Math.pow(2,e),e++);if(c[t])t=c[t];else if(t===k)t=l+l.charAt(0);else return null;f.push(t);c[k++]=l+t.charAt(0);h--;l=t;0==h&&(h=Math.pow(2,e),e++)}}};return d}()};workspace.core=
new function(){var g=new function(){function f(a){for(var b=[];void 0!=(a=a.parent);)b.unshift({x:a.x,y:a.y,a:a.angle});a={x:void 0!=b[0]?b[0].x:0,y:void 0!=b[0]?b[0].y:0,a:void 0!=b[0]?b[0].a:0};for(var d=1;d<b.length;d++){var k=workspace.library.math.cartesianAngleAdjust(b[d].x,b[d].y,b[d-1].a);a.a+=b[d].a;a.x+=k.x;a.y+=k.y}return a}var d=this,e=new function(){this.length=function(a){return a*d.viewport.scale()};this.windowPoint2workspacePoint=function(a,c){var b=d.viewport.position(),k=d.viewport.scale()/
window.devicePixelRatio,e=d.viewport.angle();a=a/k-b.x;c=c/k-b.y;return workspace.library.math.cartesianAngleAdjust(a,c,-e)};this.workspacePoint2windowPoint=function(a,c){var b=d.viewport.position(),k=d.viewport.scale(),e=d.viewport.angle();a=workspace.library.math.cartesianAngleAdjust(a,c,e);return{x:(a.x+b.x)*k,y:(a.y+b.y)*k}}},a=new function(){this.polygon=function(){this.type="polygon";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};
this.points=[];this.style={fill:"rgba(100,255,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,lineJoin:"round",miterLimit:2,shadowColour:"rgba(0,0,0,0)",shadowBlur:20,shadowOffset:{x:20,y:20}};this.parameter={};this.parameter.points=function(a){return function(b){if(void 0==b)return a.points;a.points=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,d=this;void 0!=
(d=d.parent)&&!b;)b=b||d._static;this._static=b;a=void 0==a?f(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=this.points.map(function(b){b=workspace.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",
this,"has no bounding box");var b=!1}else b=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=workspace.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(a,c,h,k){c=void 0===c?{x:0,y:0,a:0}:c;h=void 0===h?!1:h;k=void 0===k?!1:k;var b=this._static?!0:workspace.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),
this.extremities.boundingBox);if(b){b=this.points.map(function(a){a=workspace.library.math.cartesianAngleAdjust(a.x,a.y,c.a);return{x:a.x+c.x,y:a.y+c.y}});var f=this.style.lineWidth,l=this.style.shadowBlur,p=this.style.shadowOffset.x,g=this.style.shadowOffset.y;h||(b=b.map(function(a){return e.workspacePoint2windowPoint(a.x,a.y)}),f=e.length(f),l=e.length(l),p=e.length(p),g=e.length(g));if(k){k=new Path2D;k.moveTo(b[0].x,b[0].y);for(h=1;h<b.length;h++)k.lineTo(b[h].x,b[h].y);a.clip(k)}else{a.fillStyle=
this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=f;a.lineJoin=this.style.lineJoin;a.miterLimit=this.style.miterLimit;a.shadowColor=this.style.shadowColour;a.shadowBlur=l;a.shadowOffsetX=p;a.shadowOffsetY=g;a.beginPath();a.moveTo(b[0].x,b[0].y);for(h=1;h<b.length;h++)a.lineTo(b[h].x,b[h].y);a.closePath();a.fill();a.stroke();if(this.dotFrame){for(h=0;h<this.extremities.points.length;h++)a=e.workspacePoint2windowPoint(this.extremities.points[h].x,this.extremities.points[h].y),d.render.drawDot(a.x,
a.y,4,"rgba(50,50,50,1)");a=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(a.x,a.y);a=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(a.x,a.y)}}}}};this.circle=function(){this.type="circle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.y=this.x=0;this.r=2;this.style=
{fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,shadowColour:"rgba(0,0,0,0)",shadowBlur:2,shadowOffset:{x:1,y:1}};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.r=function(a){return function(b){if(void 0==b)return a.r;a.r=b;a.computeExtremities()}}(this);this.getAddress=function(){var a=
"",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,d=this;void 0!=(d=d.parent)&&!b;)b=b||d._static;this._static=b;a=void 0==a?f(this):a;this.extremities={points:[],boundingBox:{},origin:{}};point=workspace.library.math.cartesianAngleAdjust(this.x,this.y,a.a);this.extremities.origin={x:this.x+a.x,y:this.y+a.y};this.extremities.points=workspace.library.math.pointsOfCircle(this.x,this.y,this.r,10);this.extremities.points=this.extremities.points.map(function(b){b=
workspace.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?workspace.library.math.distanceBetweenTwoPoints({x:a,
y:c},{x:this.x+this.extremities.origin.x,y:this.y+this.extremities.origin.y})<=this.r:!1};this.render=function(a,c,h,k){c=void 0===c?{x:0,y:0,a:0}:c;h=void 0===h?!1:h;k=void 0===k?!1:k;var b=this._static?!0:workspace.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(b){b=workspace.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=b.x-this.x;c.y+=b.y-this.y;c={x:this.x+c.x,y:this.y+c.y};b=this.r;var f=this.style.lineWidth,l=this.style.shadowBlur,
p=this.style.shadowOffset.x,g=this.style.shadowOffset.y;h||(c=e.workspacePoint2windowPoint(c.x,c.y),b=e.length(b),f=e.length(f),l=e.length(l),p=e.length(p),g=e.length(g));if(k)h=new Path2D,h.arc(c.x,c.y,b,0,2*Math.PI,!1),a.clip(h);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=f,a.shadowColor=this.style.shadowColour,a.shadowBlur=l,a.shadowOffsetX=p,a.shadowOffsetY=g,a.beginPath(),a.arc(c.x,c.y,b,0,2*Math.PI,!1),a.closePath(),a.fill(),a.stroke(),this.dotFrame){for(a=
0;a<this.extremities.points.length;a++)h=e.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),d.render.drawDot(h.x,h.y,4,"rgba(50,50,50,1)");h=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(h.x,h.y);h=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(h.x,h.y);h=e.workspacePoint2windowPoint(this.extremities.origin.x,
this.extremities.origin.y);d.render.drawDot(h.x,h.y)}}}};this.canvas=function(){this.type="canvas";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;var a=document.createElement("canvas"),c=1;var h=a.getContext("2d",{alpha:!1});a.setAttribute("width",this.width*c);a.setAttribute("height",this.height*c);this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==
b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);this.parameter.width=function(b){return function(d){if(void 0==d)return b.width;b.width=d;b.computeExtremities();
a.setAttribute("width",b.width*c)}}(this);this.parameter.height=function(b){return function(d){if(void 0==d)return b.height;b.height=d;b.computeExtremities();a.setAttribute("height",b.height*c)}}(this);this.resolution=function(b){if(void 0==b)return c;c=b;a.setAttribute("width",this.width*c);a.setAttribute("height",this.height*c)};this._=h;this.$=function(a){return a*c};this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=
this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?f(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=workspace.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(b){b=workspace.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);
void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=workspace.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=
function(b,c,h){c=void 0===c?{x:0,y:0,a:0}:c;h=void 0===h?!1:h;var k=this._static?!0:workspace.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(k){k=workspace.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=k.x-this.x;c.y+=k.y-this.y;k={x:this.x+c.x,y:this.y+c.y};c=this.angle+c.a;var f=this.width,m=this.height;h||(k=e.workspacePoint2windowPoint(k.x-this.anchor.x*f,k.y-this.anchor.y*m),f=e.length(f),m=e.length(m));k=workspace.library.math.cartesianAngleAdjust(k.x,
k.y,-c);b.save();b.rotate(c);b.drawImage(a,k.x,k.y,f,m);b.restore();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)h=e.workspacePoint2windowPoint(this.extremities.points[b].x,this.extremities.points[b].y),d.render.drawDot(h.x,h.y,4,"rgba(50,50,50,1)");h=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(h.x,h.y);h=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);
d.render.drawDot(h.x,h.y)}}}};this.image=function(){this.type="image";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;this.url="";var a={};this.style={shadowColour:"rgba(0,0,0,0)",shadowBlur:2,shadowOffset:{x:1,y:1}};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=
function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);this.parameter.width=function(a){return function(b){if(void 0==b)return a.width;a.width=b;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(b){if(void 0==
b)return a.height;a.height=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?f(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=workspace.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(b){b=
workspace.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return c?(void 0==
this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=workspace.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(b,h,k){h=void 0===h?{x:0,y:0,a:0}:h;k=void 0===k?!1:k;var c=this._static?!0:workspace.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(c){c=workspace.library.math.cartesianAngleAdjust(this.x,this.y,h.a);h.x+=c.x-this.x;h.y+=c.y-this.y;c={x:this.x+h.x,y:this.y+
h.y};h=this.angle+h.a;var f=this.width,l=this.height;k||(c=e.workspacePoint2windowPoint(c.x-this.anchor.x*f,c.y-this.anchor.y*l),f=e.length(f),l=e.length(l));c=workspace.library.math.cartesianAngleAdjust(c.x,c.y,-h);a.hasOwnProperty(this.url)||(a[this.url]=new Image,a[this.url].src=this.url);b.save();b.rotate(h);b.drawImage(a[this.url],c.x,c.y,f,l);b.restore();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)k=e.workspacePoint2windowPoint(this.extremities.points[b].x,this.extremities.points[b].y),
d.render.drawDot(k.x,k.y,4,"rgba(50,50,50,1)");k=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(k.x,k.y);k=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(k.x,k.y)}}}};this.path=function(){this.type="path";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.points=
[];this.style={stroke:"rgba(0,0,0,0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:2,shadowColour:"rgba(0,0,0,0)",shadowBlur:20,shadowOffset:{x:20,y:20}};this.parameter={};this.parameter.points=function(a){return function(b){if(void 0==b)return a.points;a.points=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,d=this;void 0!=(d=d.parent)&&!b;)b=
b||d._static;this._static=b;a=void 0==a?f(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=this.points.map(function(b){b=workspace.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");
var b=!1}else b=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=workspace.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(a,c,h){c=void 0===c?{x:0,y:0,a:0}:c;h=void 0===h?!1:h;var b=this._static?!0:workspace.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);
if(b){b=this.points.map(function(a){a=workspace.library.math.cartesianAngleAdjust(a.x,a.y,c.a);return{x:a.x+c.x,y:a.y+c.y}});var f=this.style.lineWidth,n=this.style.shadowBlur,l=this.style.shadowOffset.x,p=this.style.shadowOffset.y;h||(b=b.map(function(a){return e.workspacePoint2windowPoint(a.x,a.y)}),f=e.length(f),n=e.length(n),l=e.length(l),p=e.length(p));a.fillStyle=this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=f;a.lineCap=this.style.lineCap;a.lineJoin=this.style.lineJoin;a.miterLimit=
this.style.miterLimit;a.shadowColor=this.style.shadowColour;a.shadowBlur=n;a.shadowOffsetX=l;a.shadowOffsetY=p;a.beginPath();a.moveTo(b[0].x,b[0].y);for(h=1;h<b.length;h++)a.lineTo(b[h].x,b[h].y);a.stroke();if(this.dotFrame){for(h=0;h<this.extremities.points.length;h++)a=e.workspacePoint2windowPoint(this.extremities.points[h].x,this.extremities.points[h].y),d.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);
d.render.drawDot(a.x,a.y);a=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(a.x,a.y)}}}};this.rectangle=function(){this.type="rectangle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;this.style={fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,shadowColour:"rgba(0,0,0,0)",
shadowBlur:2,shadowOffset:{x:1,y:1}};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);
this.parameter.width=function(a){return function(b){if(void 0==b)return a.width;a.width=b;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(b){if(void 0==b)return a.height;a.height=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.getOffset=function(){return f(this)};this.computeExtremities=function(a,c){c=this._static;for(var b=this;void 0!=(b=b.parent)&&!c;)c=c||b._static;this._static=
c;a=void 0==a?f(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=workspace.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(b){b=workspace.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=
function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=workspace.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(a,c,h,k){c=void 0===c?{x:0,y:0,a:0}:c;h=void 0===h?!1:h;k=void 0===
k?!1:k;var b=this._static?!0:workspace.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(b){b=workspace.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=b.x-this.x;c.y+=b.y-this.y;b={x:this.x+c.x,y:this.y+c.y};c=this.angle+c.a;var f=this.width,l=this.height,p=this.style.lineWidth,g=this.style.shadowBlur,q=this.style.shadowOffset.x,r=this.style.shadowOffset.y;h||(b=e.workspacePoint2windowPoint(b.x-this.anchor.x*f,b.y-this.anchor.y*l),f=e.length(f),
l=e.length(l),p=e.length(p),g=e.length(g),q=e.length(q),r=e.length(r));b=workspace.library.math.cartesianAngleAdjust(b.x,b.y,-c);if(k)a.rotate(c),h=new Path2D,h.rect(b.x,b.y,f,l),a.clip(h),a.rotate(-c);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=p,a.shadowColor=this.style.shadowColour,a.shadowBlur=g,a.shadowOffsetX=q,a.shadowOffsetY=r,a.save(),a.rotate(c),a.fillRect(b.x,b.y,f,l),a.strokeRect(b.x,b.y,f,l),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)h=
e.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),d.render.drawDot(h.x,h.y,4,"rgba(50,50,50,1)");h=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(h.x,h.y);h=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(h.x,h.y)}}}};this.group=function(){function a(a,b){if(void 0==b)return a.getAddress()+" >> no element provided";
if(void 0==b.name||""==b.name)return a.getAddress()+" >> element has no name";for(var c=0;c<a.children.length;c++)if(a.children[c].name==b.name)return'element with the name "'+b.name+'" already exists in the '+(void 0==parent?"design root":'group "'+a.name+'"')}this.type="group";this.name="";this.clipActive=this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.children=[];this.clippingStencil;this.parameter={};
this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities(void 0,!0)}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities(void 0,!0)}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities(void 0,!0)}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.clip=function(a){if(void 0==
a)return this.clipActive;this.clipActive=void 0==this.clippingStencil?!1:a;this.computeExtremities()};this.stencil=function(a){if(void 0==a)return this.clippingStencil;this.clippingStencil=a;this.computeExtremities()};this.prepend=function(b){var c=a(this,b);void 0!=c?console.error("element invalid:",c):(this.children.unshift(b),b.parent=this,b.computeExtremities(void 0,!0))};this.append=function(b){var c=a(this,b);void 0!=c?console.error("element invalid:",c):(this.children.push(b),b.parent=this,
b.computeExtremities(void 0,!0))};this.remove=function(a){void 0!=a&&(a=this.children.indexOf(a),0>a||(this.children.splice(a,1),this.computeExtremities()))};this.clear=function(){this.children=[];this.computeExtremities()};this.contains=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b]==a)return!0;return!1};this.getChildByName=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b].name==a)return this.children[b]};this.getElementsWithName=function(a){for(var b=
[],c=0;c<this.children.length;c++)if(this.children[c].name==a&&b.push(this.children[c]),"group"==this.children[c].type)for(var d=this.children[c].getElementsWithName(a),e=0;e<d.length;e++)b.push(d[e]);return b};this.getOffset=function(){return f(this)};this.computeExtremities=function(a,b){b=void 0===b?!1:b;for(var c=void 0==a,d=this._static,e=this;void 0!=(e=e.parent)&&!d;)d=d||e._static;this._static=d;a=void 0==a?f(this):a;if(b)for(b={x:a.x,y:a.y,a:a.a+this.angle},d=workspace.library.math.cartesianAngleAdjust(this.x,
this.y,a.a),b.x+=d.x,b.y+=d.y,d=0;d<this.children.length;d++)this.children[d].computeExtremities(b,!0);this.extremities={points:[],boundingBox:{}};if(this.clipActive)b={x:a.x,y:a.y,a:a.a+this.angle},d=workspace.library.math.cartesianAngleAdjust(this.x,this.y,a.a),b.x+=d.x,b.y+=d.y,this.clippingStencil.computeExtremities(b),this.extremities.points=this.clippingStencil.extremities.points;else{a=[];for(d=0;d<this.children.length;d++)a.push(this.children[d].extremities.boundingBox.topLeft),a.push(this.children[d].extremities.boundingBox.bottomRight);
a=workspace.library.math.boundingBoxFromPoints(a);this.extremities.points=[{x:a.topLeft.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.bottomRight.y},{x:a.topLeft.x,y:a.bottomRight.y}]}this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&c&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(this.clipActive)return this.clippingStencil.isPointWithin(a,b);if(void 0==this.extremities.boundingBox){console.warn("the shape",
this,"has no bounding box");var c=!1}else c=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=workspace.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.getElementUnderPoint=function(a,b,d,f){d=void 0===d?!1:d;f=void 0===f?!1:f;for(var c=[],k=this.children.length-1;0<=k;k--){var h=this.children[k]._static||d?e.workspacePoint2windowPoint(a,
b):{x:a,y:b};if(!this.children[k].ignored&&this.children[k].isPointWithin(h.x,h.y))if("group"==this.children[k].type){if(h=this.children[k].getElementUnderPoint(a,b,this.children[k]._static||d,f),void 0!=h)if(f)c=c.concat(h);else return h}else if(f)c.push(this.children[k]);else return this.children[k]}if(f)return c};this.render=function(a,b,k,f){b=void 0===b?{x:0,y:0,a:0}:b;k=void 0===k?!1:k;f=void 0===f?!1:f;a:if(this._static)var c=!0;else{for(c=0;c<this.children.length;c++)if(this.children[c]._static){c=
!0;break a}c=workspace.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox)}if(c){c=workspace.library.math.cartesianAngleAdjust(this.x,this.y,b.a);b={a:b.a+this.angle,x:b.x+c.x,y:b.y+c.y};if(this.clipActive||f)a.save(),this.clippingStencil.render(a,Object.assign({},b),k||this.clippingStencil._static,f||this.clipActive);for(f=0;f<this.children.length;f++)c=this.children[f],c.render(a,Object.assign({},b),k||c._static);this.clipActive&&a.restore();if(this.dotFrame){for(f=
0;f<this.extremities.points.length;f++)a=e.workspacePoint2windowPoint(this.extremities.points[f].x,this.extremities.points[f].y),d.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(a.x,a.y);a=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(a.x,a.y)}}}};this.text=function(){this.type="text";this.name=
"";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.y=this.x=0;this.text="curve";this.angle=0;this.size=1;this.style={font:"30pt Arial",align:"start",baseline:"alphabetic",fill:"rgba(255,100,100,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,shadowColour:"rgba(0,0,0,0)",shadowBlur:2,shadowOffset:{x:20,y:20}};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=
function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.size=function(a){return function(b){if(void 0==b)return a.size;a.size=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,d=this;void 0!=
(d=d.parent)&&!b;)b=b||d._static;this._static=b;a=void 0==a?f(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=workspace.library.math.pointsOfText(this.text,this.x,this.y,this.angle,1/this.size,this.style.font,this.style.align,this.style.baseline);this.extremities.points=this.extremities.points.map(function(b){b=workspace.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=workspace.library.math.boundingBoxFromPoints(this.extremities.points);
void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=workspace.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=workspace.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=
function(a,c,f,k){c=void 0===c?{x:0,y:0,a:0}:c;f=void 0===f?!1:f;k=void 0===k?!1:k;var b=workspace.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=b.x-this.x;c.y+=b.y-this.y;b={x:this.x+c.x,y:this.y+c.y};var h=this.size;c=this.angle+c.a;var l=this.style.lineWidth,p=this.style.shadowBlur,g=this.style.shadowOffset.x,q=this.style.shadowOffset.y;f||(b=e.workspacePoint2windowPoint(b.x,b.y),h=e.length(h),p=e.length(p),g=e.length(g),q=e.length(q));b=workspace.library.math.cartesianAngleAdjust(b.x,
b.y,-c);if(k)console.warn("no clipping available for text shape");else if(a.font=this.style.font,a.textAlign=this.style.align,a.textBaseline=this.style.baseline,a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=l,a.shadowColor=this.style.shadowColour,a.shadowBlur=p,a.shadowOffsetX=g,a.shadowOffsetY=q,a.save(),a.rotate(c),a.scale(h,h),a.fillText(this.text,b.x/h,b.y/h),a.shadowColor="rgba(0,0,0,0)",a.strokeText(this.text,b.x/h,b.y/h),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)f=
e.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),d.render.drawDot(f.x,f.y,4,"rgba(50,50,50,1)");f=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(f.x,f.y);f=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(f.x,f.y)}}}};this.arrangement=new function(){var b=new a.group;b.name="root";this.createElement=
function(b){return new a[b]};this.clear=function(){b.clear()};this.get=function(){return b};this.set=function(a){b=a};this.prepend=function(a){b.prepend(a)};this.append=function(a){b.append(a)};this.remove=function(a){b.remove(a)};this.getElementUnderPoint=function(a,d,e,f){return b.getElementUnderPoint(a,d,void 0===e?!1:e,void 0===f?!1:f)};this.getElementsWithName=function(a){return b.getElementsWithName(a)}};this.viewport=new function(){function a(){function a(a){var c=a.charAt(0).toUpperCase()+
a.slice(1),e=workspace.getAttribute("workspace"+c);if(d[a]!=e||d["window"+c]!=window["inner"+c])d[a]=e,d["window"+c]=window["inner"+c],void 0==e?(workspace[a]=d.defaultSize[a]*window.devicePixelRatio,workspace.style[a]=d.defaultSize[a]+"px"):e.indexOf("%")==e.length-1?(c=workspace.parentElement["offset"+c],e=parseFloat(e.slice(0,e.length-1))/100,workspace[a]=c*e*window.devicePixelRatio,workspace.style[a]=c*e+"px"):(workspace[a]=e*window.devicePixelRatio,workspace.style[a]=e),b=!0}var b=!1;a("width");
a("height");b&&c()}function c(){k.points.tl=e.windowPoint2workspacePoint(0,0);k.points.tr=e.windowPoint2workspacePoint(workspace.width,0);k.points.bl=e.windowPoint2workspacePoint(0,workspace.height);k.points.br=e.windowPoint2workspacePoint(workspace.width,workspace.height);k.boundingBox=workspace.library.math.boundingBoxFromPoints([k.points.tl,k.points.tr,k.points.br,k.points.bl])}var d={defaultSize:{width:640,height:480},width:0,height:0,windowWidth:0,windowHeight:0},k={position:{x:0,y:0},scale:window.devicePixelRatio,
angle:0,points:{tl:{x:0,y:0},tr:{x:0,y:0},bl:{x:0,y:0},br:{x:0,y:0}},boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}}},f=void 0,n=void 0,l=!1,p=!0;this.position=function(a,b){if(void 0==a||void 0==b)return{x:k.position.x,y:k.position.y};k.position.x=a;k.position.y=b;c()};this.scale=function(a){if(void 0==a)return k.scale;k.scale=0==a?window.devicePixelRatio:a;c()};this.angle=function(a){if(void 0==a)return k.angle;k.angle=a;c()};this.windowPoint2workspacePoint=function(a,b){return e.windowPoint2workspacePoint(a,
b)};this.refresh=function(){a();c();this.allowKeyboardInput(p)};this.getBoundingBox=function(){return k.boundingBox};this.mousePosition=function(a,b){if(void 0==a||void 0==b)return{x:f,y:n};f=a;n=b};this.stopMouseScroll=function(a){if(void 0==a)return l;l=a;a||(document.body.style.overflow="")};this.allowKeyboardInput=function(a){if(void 0==a)return p;(p=a)?workspace.setAttribute("tabIndex",1):workspace.removeAttribute("tabIndex")};this.cursor=function(a){if(void 0==a)return document.body.style.cursor;
document.body.style.cursor=a}};this.render=new function(){function a(a){void 0!==a&&a||(e.fillStyle="rgb(255,255,255)",e.fillRect(0,0,workspace.width,workspace.height));d.arrangement.get().render(e)}function c(b){k=requestAnimationFrame(c);try{a()}catch(n){d.render.active(!1),console.error("major animation error"),console.error(n)}d.stats.collect(b)}var e=workspace.getContext("2d",{alpha:!1}),k=void 0;this.drawDot=function(a,b,c,d){c=void 0===c?2:c;e.fillStyle=void 0===d?"rgba(150,150,255,1)":d;e.beginPath();
e.arc(a,b,c,0,2*Math.PI,!1);e.closePath();e.fill()};this.frame=function(b){a(void 0===b?!1:b)};this.active=function(a){if(void 0==a)return void 0!=k;a?void 0==k&&c():void 0!=k&&(cancelAnimationFrame(k),k=void 0)}};this.stats=new function(){var a=!1,c=0,d={compute:function(a){this.frameTimeArray.push(1E3/(a-c));30<=this.frameTimeArray.length&&this.frameTimeArray.shift();this.rate=workspace.library.math.averageArray(this.frameTimeArray);c=a},counter:0,frameTimeArray:[],rate:0},e={recursiveCount:function(a){void 0==
a&&(this.counts={total:0,canvas:0,circle:0,group:0,image:0,path:0,polygon:0,rectangle:0,text:0},a=workspace.core.arrangement.get());this.counts.total++;switch(a.type){case "canvas":this.counts.canvas++;break;case "circle":this.counts.circle++;break;case "group":this.counts.group++;break;case "image":this.counts.image++;break;case "path":this.counts.path++;break;case "polygon":this.counts.polygon++;break;case "rectangle":this.counts.rectangle++;break;case "text":this.counts.text++}if(void 0!=a.children)for(var b=
0;b<a.children.length;b++)this.recursiveCount(a.children[b])},recursivePrint:function(a,b){b=void 0===b?"":b;void 0==a&&(a=workspace.core.arrangement.get());console.log(b+a.name);if(void 0!=a.children)for(var c=0;c<a.children.length;c++)this.recursivePrint(a.children[c],b+"- ")},counts:{total:0,canvas:0,circle:0,group:0,image:0,path:0,polygon:0,rectangle:0,text:0}};this.collect=function(b){a&&d.compute(b)};this.active=function(b){if(void 0==b)return a;a=b};this.getReport=function(){e.recursiveCount();
return{framesPerSecond:d.rate,shapeCount:e.counts}}};this.callback=new function(){for(var a="onmousedown onmouseup onmousemove onmouseenter onmouseleave onwheel onclick ondblclick onkeydown onkeyup touchstart touchmove touchend touchenter touchleave touchcancel".split(" "),c={},f=0;f<a.length;c={$jscomp$loop$prop$getRelevantShape$8:c.$jscomp$loop$prop$getRelevantShape$8},f++){c.$jscomp$loop$prop$getRelevantShape$8=function(a,b,c){var e=d.arrangement.getElementUnderPoint(a,b);if(void 0!=e&&void 0==
e[c])for(a=d.arrangement.getElementUnderPoint(a,b,void 0,!0),b=0;b<a.length;b++)if(void 0!=a[b][c]){e=a[b];break}return e};this[a[f]]=function(a,b,c){};var k=0,m=0;workspace[a[f]]=function(a){return function(b){return function(c){if(d.callback[b]){var k=e.windowPoint2workspacePoint(c.x,c.y),f=a.$jscomp$loop$prop$getRelevantShape$8(k.x,k.y,b);d.callback[b](k.x,k.y,c,f)}}}}(c)(a[f]);workspace.onmouseover=function(a){return function(b){d.viewport.stopMouseScroll()&&(document.body.style.overflow="hidden");
if(d.callback.onmouseover){var c=e.windowPoint2workspacePoint(b.x,b.y),k=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmouseover");d.callback.onmouseover(c.x,c.y,b,k)}}}(c);workspace.onmouseout=function(a){return function(b){d.viewport.stopMouseScroll()&&(document.body.style.overflow="");if(d.callback.onmouseout){var c=e.windowPoint2workspacePoint(b.x,b.y),k=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmouseout");d.callback.onmouseout(c.x,c.y,b,k)}}}(c);workspace.onmousemove=function(a){return function(b){var c=
e.windowPoint2workspacePoint(b.x,b.y);d.viewport.mousePosition(c.x,c.y);if(d.callback.onmousemove){var f=a.$jscomp$loop$prop$getRelevantShape$8(k,m,"onmouseleave"),h=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmouseenter"),l=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmousemove");f!=h&&(d.callback.onmouseleave(c.x,c.y,b,f),d.callback.onmouseenter(c.x,c.y,b,h));d.callback.onmousemove(c.x,c.y,b,l);k=c.x;m=c.y}}}(c);workspace.onkeydown=function(a){return function(b){if(d.callback.onkeydown){var c=
d.viewport.mousePosition(),e=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onkeydown");d.callback.onkeydown(c.x,c.y,b,e)}}}(c);workspace.onkeyup=function(a){return function(b){if(d.callback.onkeyup){var c=d.viewport.mousePosition(),e=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onkeyup");d.callback.onkeyup(c.x,c.y,b,e)}}}(c)}};d.viewport.refresh();d.arrangement.clear()};this.arrangement=new function(){this.get=function(){return g.arrangement.get()};this.set=function(f){return g.arrangement.set(f)};
this.createElement=function(f){return g.arrangement.createElement(f)};this.append=function(f){return g.arrangement.append(f)};this.prepend=function(f){return g.arrangement.prepend(f)};this.remove=function(f){return g.arrangement.remove(f)};this.getElementUnderPoint=function(f,d){return g.arrangement.getElementUnderPoint(f,d)};this.getElementsWithName=function(f){return g.arrangement.getElementsWithName(f)};this.forceRefresh=function(f){return g.arrangement.forceRefresh(f)}};this.viewport=new function(){this.position=
function(f,d){return g.viewport.position(f,d)};this.scale=function(f){return g.viewport.scale(f)};this.angle=function(f){return g.viewport.angle(f)};this.windowPoint2workspacePoint=function(f,d){return g.viewport.windowPoint2workspacePoint(f,d)};this.refresh=function(){g.viewport.refresh()};this.mousePosition=function(){return g.viewport.mousePosition()};this.stopMouseScroll=function(f){return g.viewport.stopMouseScroll(f)};this.allowKeyboardInput=function(f){return g.viewport.allowKeyboardInput(f)};
this.cursor=function(f){return g.viewport.cursor(f)}};this.render=new function(){this.frame=function(f){return g.render.frame(void 0===f?!1:f)};this.active=function(f){return g.render.active(f)}};this.stats=new function(){this.active=function(f){return g.stats.active(f)};this.getReport=function(){return g.stats.getReport()}};this.callback=new function(){this.onmousedown=function(f,d,e,a){};g.callback.onmousedown=function(f){return function(d,e,a,b){f.onmousedown(d,e,a,b)}}(this);this.onmouseup=function(f,
d,e,a){};g.callback.onmouseup=function(f){return function(d,e,a,b){f.onmouseup(d,e,a,b)}}(this);this.onmousemove=function(f,d,e,a){};g.callback.onmousemove=function(f){return function(d,e,a,b){f.onmousemove(d,e,a,b)}}(this);this.onmouseenter=function(f,d,e,a){};g.callback.onmouseenter=function(f){return function(d,e,a,b){f.onmouseenter(d,e,a,b)}}(this);this.onmouseleave=function(f,d,e,a){};g.callback.onmouseleave=function(f){return function(d,e,a,b){f.onmouseleave(d,e,a,b)}}(this);this.onwheel=function(f,
d,e,a){};g.callback.onwheel=function(f){return function(d,e,a,b){f.onwheel(d,e,a,b)}}(this);this.onclick=function(f,d,e,a){};g.callback.onclick=function(f){return function(d,e,a,b){f.onclick(d,e,a,b)}}(this);this.ondblclick=function(f,d,e,a){};g.callback.ondblclick=function(f){return function(d,e,a,b){f.ondblclick(d,e,a,b)}}(this);this.onkeydown=function(f,d,e,a){};g.callback.onkeydown=function(f){return function(d,e,a,b){f.onkeydown(d,e,a,b)}}(this);this.onkeyup=function(f,d,e,a){};g.callback.onkeyup=
function(f){return function(d,e,a,b){f.onkeyup(d,e,a,b)}}(this);this.touchstart=function(f,d,e){};g.callback.touchstart=function(f){return function(d,e,a,b){f.touchstart(d,e,a)}}(this);this.touchmove=function(f,d,e){};g.callback.touchmove=function(f){return function(d,e,a,b){f.touchmove(d,e,a)}}(this);this.touchend=function(f,d,e){};g.callback.touchend=function(f){return function(d,e,a,b){f.touchend(d,e,a)}}(this);this.touchenter=function(f,d,e){};g.callback.touchenter=function(f){return function(d,
e,a,b){f.touchenter(d,e,a)}}(this);this.touchleave=function(f,d,e){};g.callback.touchleave=function(f){return function(d,e,a,b){f.touchleave(d,e,a)}}(this);this.touchcancel=function(f,d,e){};g.callback.touchcancel=function(f){return function(d,e,a,b){f.touchcancel(d,e,a)}}(this)}};workspace.system=new function(){};workspace.system.mouse=new function(){function g(f,d,e,a,b){if(void 0==b)return!1;do if(void 0!=b[f])return b[f](d,e,a),!0;while(void 0!=(b=b.parent));return!1}this.tmp={};this.functionList=
{};this.mouseInteractionHandler=function(f,d){workspace.system.mouse.tmp.onmousemove_old=workspace.onmousemove;workspace.system.mouse.tmp.onmouseleave_old=workspace.onmouseleave;workspace.system.mouse.tmp.onmouseup_old=workspace.onmouseup;workspace.onmousemove=function(d){void 0!=f&&f(d)};workspace.onmouseup=function(e){void 0!=d&&d(e);workspace.onmousemove=workspace.system.mouse.tmp.onmousemove_old;workspace.onmouseleave=workspace.system.mouse.tmp.onmouseleave_old;workspace.onmouseup=workspace.system.mouse.tmp.onmouseup_old};
workspace.onmouseleave=workspace.onmouseup};this.forceMouseUp=function(){workspace.onmouseup()};workspace.core.callback.onmousedown=function(f,d,e,a){g("onmousedown",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.onmousedown)({event:e,x:f,y:d})};workspace.core.callback.onmousemove=function(f,d,e,a){g("onmousemove",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.onmousemove)({event:e,x:f,y:d})};workspace.core.callback.onmouseup=
function(f,d,e,a){g("onmouseup",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.onmouseup)({event:e,x:f,y:d})};workspace.core.callback.onmouseleave=function(f,d,e,a){g("onmouseleave",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.onmouseleave)({event:e,x:f,y:d})};workspace.core.callback.onmouseenter=function(f,d,e,a){g("onmouseenter",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.onmouseenter)({event:e,
x:f,y:d})};workspace.core.callback.onwheel=function(f,d,e,a){g("onwheel",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.onwheel)({event:e,x:f,y:d})};workspace.core.callback.onclick=function(f,d,e,a){g("onclick",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.onclick)({event:e,x:f,y:d})};workspace.core.callback.ondblclick=function(f,d,e,a){g("ondblclick",f,d,e,a)||workspace.library.structure.functionListRunner(workspace.system.mouse.functionList.ondblclick)({event:e,
x:f,y:d})};this.functionList.onmousedown=[];this.functionList.onmousemove=[];this.functionList.onmouseup=[];this.functionList.onmouseleave=[];this.functionList.onmouseenter=[];this.functionList.onwheel=[];this.functionList.onclick=[];this.functionList.ondblclick=[]};workspace.system.keyboard=new function(){function g(d,e,a,b,c){if(void 0==c)return!1;do if(void 0!=c[d])return c[d](e,a,b),!0;while(void 0!=(c=c.parent));return!1}function f(d,e){var a=workspace.system.keyboard.pressedKeys;if("ControlLeft"==
d.code||"ControlRight"==d.code)a.control=e;else if("AltLeft"==d.code||"AltRight"==d.code)a.alt=e;else if("MetaLeft"==d.code||"MetaRight"==d.code)a.meta=e;else if("ShiftLeft"==d.code||"ShiftRight"==d.code)a.shift=e;-1!=window.navigator.platform.indexOf("Mac")&&(a.option=a.alt,a.command=a.meta)}workspace.core.callback.onkeydown=function(d,e,a,b){workspace.system.keyboard.pressedKeys[a.code]||(workspace.system.keyboard.pressedKeys[a.code]=!0,f(a,!0),g("onkeydown",d,e,a,b)||workspace.library.structure.functionListRunner(workspace.system.keyboard.functionList.onkeydown)({event:a,
x:d,y:e}))};workspace.core.callback.onkeyup=function(d,e,a,b){workspace.system.keyboard.pressedKeys[a.code]&&(delete workspace.system.keyboard.pressedKeys[a.code],f(a,!1),g("onkeyup",d,e,a,b)||workspace.library.structure.functionListRunner(workspace.system.keyboard.functionList.onkeyup)({event:a,x:d,y:e}))};this.releaseAll=function(){for(var d=0;d<this.pressedKeys.length;d++)this.releaseKey(this.pressedKeys[d])};this.releaseKey=function(d){workspace.onkeyup(new KeyboardEvent("keyup",{code:d}))};this.pressedKeys=
{control:!1,alt:!1,meta:!1};this.functionList={};this.functionList.onkeydown=[];this.functionList.onkeyup=[]};workspace.system.pane={};workspace.system.pane.background=workspace.core.arrangement.createElement("group");workspace.system.pane.background.name="background";workspace.system.pane.background._static=!0;workspace.system.pane.background.ignored=!0;workspace.core.arrangement.append(workspace.system.pane.background);workspace.system.pane.middleground=workspace.core.arrangement.createElement("group");
workspace.system.pane.middleground.name="middleground";workspace.core.arrangement.append(workspace.system.pane.middleground);workspace.system.pane.middleground.back=workspace.core.arrangement.createElement("group");workspace.system.pane.middleground.back.name="back";workspace.system.pane.middleground.append(workspace.system.pane.middleground.back);workspace.system.pane.middleground.middle=workspace.core.arrangement.createElement("group");workspace.system.pane.middleground.middle.name="middle";workspace.system.pane.middleground.append(workspace.system.pane.middleground.middle);
workspace.system.pane.middleground.front=workspace.core.arrangement.createElement("group");workspace.system.pane.middleground.front.name="front";workspace.system.pane.middleground.append(workspace.system.pane.middleground.front);workspace.system.pane.foreground=workspace.core.arrangement.createElement("group");workspace.system.pane.foreground.name="foreground";workspace.system.pane.foreground._static=!0;workspace.core.arrangement.append(workspace.system.pane.foreground);workspace.system.pane.b=workspace.system.pane.background;
workspace.system.pane.mb=workspace.system.pane.middleground.back;workspace.system.pane.mm=workspace.system.pane.middleground.middle;workspace.system.pane.mf=workspace.system.pane.middleground.front;workspace.system.pane.f=workspace.system.pane.foreground;workspace.system.pane.getMiddlegroundPane=function(g){do{if(g==workspace.system.pane.mb)return workspace.system.pane.mb;if(g==workspace.system.pane.mm)return workspace.system.pane.mm;if(g==workspace.system.pane.mf)return workspace.system.pane.mf}while(void 0!=
(g=g.parent))};workspace._interface=new function(){var g=this;this.circuit=new function(){this.alpha=new function(){this.recorder=function(f){function d(){switch(a.recordingNode.node.state){case "inactive":case "paused":return e.recordingLength;case "recording":return f.currentTime-e.recordingStartTime}}var e={recordedChunks:[],recordingStartTime:-1,recordingLength:0},a={leftIn:{},rightIn:{},recordingNode:{},leftOut:{},rightOut:{}};a.leftIn.node=f.createAnalyser();a.rightIn.node=f.createAnalyser();
a.recordingNode.audioDest=new MediaStreamAudioDestinationNode(f);a.recordingNode.node=new MediaRecorder(a.recordingNode.audioDest.stream,{mimeType:"audio/webm"});a.recordingNode.node.onstart=function(){};a.recordingNode.node.ondataavailable=function(a){e.recordedChunks.push(a.data)};a.recordingNode.node.onpause=function(){};a.recordingNode.node.onresume=function(){};a.recordingNode.node.onerror=function(a){console.log(a)};a.recordingNode.node.onstop=function(){};a.leftIn.node.connect(a.recordingNode.audioDest);
a.rightIn.node.connect(a.recordingNode.audioDest);a.leftOut.node=f.createAnalyser();a.leftIn.node.connect(a.leftOut.node);a.rightOut.node=f.createAnalyser();a.rightIn.node.connect(a.rightOut.node);this.clear=function(){this.stop();e.recordedChunks=[];e.recordingStartTime=-1;e.recordingLength=0};this.start=function(){this.clear();a.recordingNode.node.start();e.recordingStartTime=f.currentTime};this.pause=function(){"inactive"!=this.state()&&(e.recordingLength=d(),a.recordingNode.node.pause())};this.resume=
function(){a.recordingNode.node.resume();e.recordingStartTime=f.currentTime-e.recordingLength};this.stop=function(){"inactive"!=this.state()&&(e.recordingLength=d(),a.recordingNode.node.stop())};this.export=function(){return new Blob(e.recordedChunks,{type:"audio/ogg; codecs=opus"})};this.save=function(a){a=void 0===a?"output":a;var b=document.createElement("a");b.href=URL.createObjectURL(this.export());b.download=a+".ogg";document.body.appendChild(b);b.click();document.body.removeChild(b)};this.state=
function(){return a.recordingNode.node.state};this.recordingTime=function(){return d()};this.getTrack=function(){return this.export()};this.in_left=function(){return a.leftIn.node};this.in_right=function(){return a.rightIn.node};this.out_left=function(){return a.leftOut.node};this.out_right=function(){return a.rightOut.node}};this.audioIn=function(f,d){d=void 0===d?!0:d;var e=1;var a=f.createGain();workspace.library.audio.changeAudioParam(f,a.gain,e);this.out=function(){return a};this.listDevices=
function(a){navigator.mediaDevices.enumerateDevices().then(function(b){a(b.filter(function(a){return"audioinput"===a.kind}))})};this.selectDevice=function(b){navigator.mediaDevices.getUserMedia({audio:{deviceId:b}}).then(function(b){audioDevice=b;workspace.library.audio.context.createMediaStreamSource(b).connect(a)},function(a){console.warn('could not find audio input device: "'+b+'"');console.warn("\terror:",a)})};this.gain=function(b){if(null==b)return e;e=b;workspace.library.audio.changeAudioParam(f,
a.gain,b)};d&&this.selectDevice("default")};this.looper=function(f){var d=this,e=!1,a=1,b=!0,c=0,h=1,k={},m=null,n={};n=f.createChannelSplitter(2);var l=f.createGain();l.gain.setTargetAtTime(1,f.currentTime,0);n.connect(l,0);var p=f.createGain();p.gain.setTargetAtTime(1,f.currentTime,0);n.connect(p,1);this.out_left=function(){return l};this.out_right=function(){return p};this.load=function(a,b,c){e=!1;workspace.library.audio.loadAudioFile(function(a){d.stop();k=a;e=!0;b(a)},a,void 0===c?"":c)};this.start=
function(){e&&(m&&(m.onended=function(){},m.stop(0)),m=workspace.library.audio.loadBuffer(f,k.buffer,n),m.playbackRate.value=a,m.loop=b,m.loopStart=c*this.duration(),m.loopEnd=h*this.duration(),m.start(0,0),m.onended=function(){m=null})};this.stop=function(){e&&m&&(m.stop(0),m=void 0)};this.rate=function(){a=value};this.duration=function(){return e?k.duration:-1};this.title=function(){return e?k.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&e?workspace.library.audio.waveformSegment(k.buffer,
a):[]};this.loop=function(a){if(void 0==data)return data;b=void 0===a?!1:a};this.loopBounds=function(a){a=void 0===a?{start:0,end:1}:a;if(void 0==a)return a;c=void 0!=a.start?a.start:c;h=void 0!=a.end?a.end:h}};this.oneShot_single=function(f){var d=this,e=!1,a=1,b={},c=null,h={};h=f.createChannelSplitter(2);var k=f.createGain();k.gain.setTargetAtTime(1,f.currentTime,0);h.connect(k,0);var m=f.createGain();m.gain.setTargetAtTime(1,f.currentTime,0);h.connect(m,1);this.out_left=function(){return k};this.out_right=
function(){return m};this.load=function(a,c,k){e=!1;workspace.library.audio.loadAudioFile(function(a){d.stop();b=a;e=!0;c(a)},a,void 0===k?"":k)};this.fire=function(){e&&(c&&(c.onended=function(){},c.stop(0)),c=workspace.library.audio.loadBuffer(f,b.buffer,h),c.playbackRate.value=a,c.start(0,0),c.onended=function(){c=null})};this.stop=function(){e&&(c.stop(0),c=void 0)};this.rate=function(){a=value};this.duration=function(){return e?b.duration:-1};this.title=function(){return e?b.name:""};this.waveformSegment=
function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&e?workspace.library.audio.waveformSegment(b.buffer,a):[]}};this.oneShot_multi=function(f){var d=this,e=!1,a=1,b={},c=[],h={};h=f.createChannelSplitter(2);var k=f.createGain();k.gain.setTargetAtTime(1,f.currentTime,0);h.connect(k,0);var m=f.createGain();m.gain.setTargetAtTime(1,f.currentTime,0);h.connect(m,1);this.audioOut=function(a){switch(a){case "r":return m;case "l":return k;default:console.error('"part.circuit.alpha.oneShot_multi.audioOut" unknown channel "'+
a+'"')}};this.out_left=function(){return this.audioOut("l")};this.out_right=function(){return this.audioOut("r")};this.loadRaw=function(a){0!==Object.keys(a).length&&(b=a,e=!0)};this.load=function(a,b,c){e=!1;workspace.library.audio.loadAudioFile(function(a){d.loadRaw(a);void 0!=b&&b(a)},a,c)};this.unloadRaw=function(){return b};this.fire=function(d,k){d=void 0===d?0:d;if(e){var l=workspace.library.audio.loadBuffer(f,b.buffer,h,function(){c.splice(c.indexOf(this),1)});l.playbackRate.value=a;l.start(0,
d*a,k*a);c.push(l)}};this.panic=function(){for(;0<c.length;)c.shift().stop(0)};this.rate=function(b){if(void 0==b)return a;0==b&&(b=1E-6);a=b};this.duration=function(){return e?b.duration/a:-1};this.title=function(){return e?b.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&e?workspace.library.audio.waveformSegment(b.buffer,a):[]}};this.audio2percentage=function(){return new function(){var f=null,d=null;var e=workspace.library.audio.context.createAnalyser();
e.fftSize=128;f=new Uint8Array(e.fftSize);new Uint8Array(e.fftSize);this.__render=function(){e.getByteTimeDomainData(f);for(var a=[],b=0;b<f.length;b++)a.push(f[b]/128-1);var c=0;a.forEach(function(a){Math.abs(a)>c&&(c=Math.abs(a))});this.newValue(c)};this.audioIn=function(){return e};this.start=function(){d=setInterval(function(a){a.__render()},1E3/30,this)};this.stop=function(){clearInterval(d)};this.newValue=function(a){}}};this.reverbUnit=function(f){function d(b,c,d){var e=new XMLHttpRequest;
e.open("GET",b+c,!0);e.responseType="arraybuffer";e.onload=function(){a.reverbNode.node.disconnect();a.reverbNode.node=f.createConvolver();a.reverbGain.node.connect(a.reverbNode.node);a.reverbNode.node.connect(a.outAggregator.node);f.decodeAudioData(e.response,function(b){a.reverbNode.node.buffer=b},function(a){console.warn("Error with decoding audio data"+a.err)});d&&d()};e.send()}function e(a,c){c=void 0===c?null:c;var b=new XMLHttpRequest;b.open("GET",a+"available2.list",!0);b.onload=function(){var a=
b.response.split("\n");a[a.length-1]=a[a.length-1].split("");a[a.length-1].pop();a[a.length-1]=a[a.length-1].join("");a.splice(-1,1);null==c?console.log(a):c(a)};b.send()}var a={inAggregator:{},reverbGain:{},bypassGain:{},reverbNode:{},outAggregator:{}};a.inAggregator.gain=1;a.inAggregator.node=f.createGain();workspace.library.audio.changeAudioParam(f,a.inAggregator.node.gain,a.inAggregator.gain,.01,"instant",!0);a.reverbGain.gain=.5;a.bypassGain.gain=.5;a.reverbGain.node=f.createGain();a.bypassGain.node=
f.createGain();workspace.library.audio.changeAudioParam(f,a.reverbGain.node.gain,a.reverbGain.gain,.01,"instant",!0);workspace.library.audio.changeAudioParam(f,a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0);a.reverbNode.impulseResponseRepoURL="https://metasophiea.com/lib/audio/impulseResponse/";a.reverbNode.selectedReverbType="Musikvereinsaal.wav";a.reverbNode.node=f.createConvolver();a.outAggregator.gain=1;a.outAggregator.node=f.createGain();workspace.library.audio.changeAudioParam(f,
a.outAggregator.node.gain,a.outAggregator.gain,.01,"instant",!0);a.inAggregator.node.connect(a.reverbGain.node);a.inAggregator.node.connect(a.bypassGain.node);a.reverbGain.node.connect(a.reverbNode.node);a.bypassGain.node.connect(a.outAggregator.node);a.reverbNode.node.connect(a.outAggregator.node);this.in=function(){return a.inAggregator.node};this.out=function(){return a.outAggregator.node};this.getTypes=function(b){e(a.reverbNode.impulseResponseRepoURL,b)};this.type=function(b,c){if(null==b)return a.reverbNode.selectedReverbType;
a.reverbNode.selectedReverbType=b;d(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType,c)};this.outGain=function(b){if(null==b)return a.outAggregator.gain;a.outAggregator.gain=b;workspace.library.audio.changeAudioParam(f,a.outAggregator.node.gain,b,.01,"instant",!0)};this.wetdry=function(b){if(null==b)return a.reverbGain.gain;a.reverbGain.gain=b;a.bypassGain.gain=1-b;workspace.library.audio.changeAudioParam(f,a.reverbGain.node.gain,a.reverbGain.gain,.01,"instant",!0);workspace.library.audio.changeAudioParam(f,
a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0)};d(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType)};this.multibandFilter=function(f,d,e){function a(a){var b={frequency:110,Q:.1,node:f.createBiquadFilter()};b.node.type=a;workspace.library.audio.changeAudioParam(f,b.node.frequency,110,.01,"instant",!0);workspace.library.audio.changeAudioParam(f,b.node.Q,.1,.01,"instant",!0);return b}e=void 0===e?!1:e;var b=[],c=[],h=[],k=[];var m=f.createGain();workspace.library.audio.changeAudioParam(f,
m.gain,1,.01,"instant",!0);if(e){2>d&&(d=2);h.push(a("lowpass"));for(e=1;e<d-1;e++)h.push(a("bandpass"));h.push(a("highpass"))}else for(e=0;e<d;e++)h.push(a("bandpass"));for(e=0;e<d;e++){var n={gain:1,node:f.createGain()};workspace.library.audio.changeAudioParam(f,n.node.gain,n.gain,.01,"instant",!0);k.push(n);b[e]={Q:.1,gain:1,frequency:110,fresh:!0}}var l=1;var p=f.createGain();workspace.library.audio.changeAudioParam(f,p.gain,l,.01,"instant",!0);for(e=0;e<d;e++)m.connect(h[e].node),h[e].node.connect(k[e].node),
k[e].node.connect(p);this.in=function(){return m};this.out=function(){return p};this.masterGain=function(a){if(void 0==a)return l;l=a;workspace.library.audio.changeAudioParam(f,p.gain,l,.01,"instant",!0)};this.gain=function(a,c){if(void 0==c)return k[a].gain;k[a].gain=c;workspace.library.audio.changeAudioParam(f,k[a].node.gain,k[a].gain,.01,"instant",!0);b[a].gain=c;b[a].fresh=!0};this.frequency=function(a,c){if(void 0==c)return h[a].frequency;h[a].frequency=c;workspace.library.audio.changeAudioParam(f,
h[a].node.frequency,h[a].frequency,.01,"instant",!0);b[a].frequency=c;b[a].fresh=!0};this.Q=function(a,c){if(void 0==c)return h[a].Q;h[a].Q=c;workspace.library.audio.changeAudioParam(f,h[a].node.Q,h[a].Q,.01,"instant",!0);b[a].Q=c;b[a].fresh=!0};this.measureFrequencyResponse=function(a,e){var f=this;if(void 0==a)return Array(d).fill(0).map(function(a,b){return f.measureFrequencyResponse(b,e)});if(!b[a].fresh)return[c[a].magResponse.map(function(a){return a*l}),c[a].requencyArray];var m=new Float32Array(e),
p=new Float32Array(m.length),n=new Float32Array(m.length);h[a].node.getFrequencyResponse(m,p,n);c[a]={magResponse:p.map(function(b){return b*k[a].gain}),phaseResponse:n,frequencyArray:e};b[a].fresh=!1;return[p.map(function(b){return b*k[a].gain*l}),e]}};this.distortionUnit=function(f){function d(){e.inAggregator.node.disconnect();e.distortionNode.node&&e.distortionNode.node.disconnect();e.distortionNode.node=f.createWaveShaper();e.distortionNode.curve=new Float32Array(workspace.library.math.curveGenerator.s(e.distortionNode.resolution,
-1,1,e.distortionNode.distortionAmount));e.distortionNode.node.curve=e.distortionNode.curve;e.distortionNode.node.oversample=e.distortionNode.oversample;e.inAggregator.node.connect(e.distortionNode.node);e.distortionNode.node.connect(e.outAggregator.node)}var e={inAggregator:{},distortionNode:{},outAggregator:{}};e.inAggregator.gain=0;e.inAggregator.node=f.createGain();workspace.library.audio.changeAudioParam(f,e.inAggregator.node.gain,e.inAggregator.gain,.01,"instant",!0);e.distortionNode.distortionAmount=
0;e.distortionNode.oversample="none";e.distortionNode.resolution=100;e.outAggregator.gain=0;e.outAggregator.node=f.createGain();workspace.library.audio.changeAudioParam(f,e.outAggregator.node.gain,e.outAggregator.gain,.01,"instant",!0);this.in=function(){return e.inAggregator.node};this.out=function(){return e.outAggregator.node};this.inGain=function(a){if(null==a)return e.inAggregator.gain;e.inAggregator.gain=a;workspace.library.audio.changeAudioParam(f,e.inAggregator.node.gain,a,.01,"instant",!0)};
this.outGain=function(a){if(null==a)return e.outAggregator.gain;e.outAggregator.gain=a;workspace.library.audio.changeAudioParam(f,e.outAggregator.node.gain,a,.01,"instant",!0)};this.distortionAmount=function(a){if(null==a)return e.distortionNode.distortionAmount;e.distortionNode.distortionAmount=a;d()};this.oversample=function(a){if(null==a)return e.distortionNode.oversample;e.distortionNode.oversample=a;d()};this.resolution=function(a){if(null==a)return e.distortionNode.resolution;e.distortionNode.resolution=
2<=a?a:2;d()};d()};this.player=function(f){function d(){clearInterval(a.loop.timeout);a.playhead.position=a.itself.currentTime();a.playhead.lastSightingTime=f.currentTime;if(a.loop.active&&a.playing){var b=a.loop.end-a.itself.currentTime();0>b&&(b=0);a.loop.timeout=setTimeout(function(){a.itself.jumpTo(a.loop.start,!1);d()},1E3*b/a.rate)}}function e(b){a.fileLoaded&&(a.playing?(a.loop.active&&b>a.loop.end&&(b=a.loop.start),a.itself.stop(function(){a.playhead.position=b;a.playhead.lastSightingTime=
f.currentTime;a.itself.start()})):(a.playhead.position=b,a.playhead.lastSightingTime=f.currentTime))}var a={itself:this,fileLoaded:!1,playing:!1,playhead:{position:0,lastSightingTime:0},loop:{active:!1,start:0,end:1,timeout:null},rate:1},b={},c=null,h={};h=f.createChannelSplitter(2);var k=f.createGain();k.gain.setTargetAtTime(1,f.currentTime,0);h.connect(k,0);var m=f.createGain();m.gain.setTargetAtTime(1,f.currentTime,0);h.connect(m,1);this.out_left=function(){return k};this.out_right=function(){return m};
this.unloadRaw=function(){return b};this.loadRaw=function(c,d){0!==Object.keys(c).length&&(a.itself.stop(),b=c,a.fileLoaded=!0,a.playhead.position=0,d(c))};this.load=function(c,d,e){a.fileLoaded=!1;workspace.library.audio.loadAudioFile(function(c){a.itself.stop();b=c;a.fileLoaded=!0;a.playhead.position=0;d(c)},c,void 0===e?"":e)};this.start=function(){!a.playing&&a.fileLoaded&&(c=workspace.library.audio.loadBuffer(f,b.buffer,h,function(b){a.itself.stop()}),c.loop=a.loop.active,c.loopStart=a.loop.start,
c.loopEnd=a.loop.end,c.playbackRate.value=a.rate,c.start(0,a.playhead.position),a.playhead.lastSightingTime=f.currentTime,a.playing=!0,d())};this.stop=function(b){a.playing&&(b&&(c.onended=function(){b()}),c.stop(0),c=void 0,d(),a.playing=!1)};this.jumpTo=function(a,b){a=void 0===a?0:a;void 0===b||b?(a=1<a?1:a,a=0>a?0:a,e(this.duration()*a)):e(a);d()};this.loop=function(b,e){b=void 0===b?{active:!1,start:0,end:1}:b;e=void 0===e?!0:e;if(void 0==b)return a.loop;void 0!=b.active&&(a.loop.active=b.active,
c&&(c.loop=b.active));if(void 0!=b.start||void 0!=b.end)e=e?this.duration():1,a.loop.start=void 0!=b.start?b.start*e:a.loop.start,a.loop.end=void 0!=b.end?b.end*e:a.loop.end,c&&(c.loopStart=a.loop.start,c.loopEnd=a.loop.end);d()};this.rate=function(b){b=void 0===b?1:b;a.rate=b;c&&(c.playbackRate.value=b);d()};this.isLoaded=function(){return a.fileLoaded};this.duration=function(){return a.fileLoaded?b.duration:-1};this.title=function(){return a.fileLoaded?b.name:""};this.currentTime=function(){return a.fileLoaded?
a.playing?a.playhead.position+a.rate*(f.currentTime-a.playhead.lastSightingTime):a.playhead.position:-1};this.progress=function(){return this.currentTime()/this.duration()};this.waveformSegment=function(c,d){c=void 0===c?{start:0,end:1}:c;return void 0!=c&&a.fileLoaded?workspace.library.audio.waveformSegment(b.buffer,c,d):[]}};this.channelMultiplier=function(f,d){d=void 0===d?2:d;var e=[];var a=1;var b=f.createGain();workspace.library.audio.changeAudioParam(f,b.gain,a,.01,"instant",!0);for(var c=
0;c<d;c++){var h={gain:.5,node:f.createGain()};workspace.library.audio.changeAudioParam(f,h.node.gain,h.gain,.01,"instant",!0);e.push(h);b.connect(h.node)}this.in=function(){return b};this.out=function(a){return e[a].node};this.inGain=function(c){if(void 0==c)return a;a=c;workspace.library.audio.changeAudioParam(f,b.gain,a,.01,"instant",!0)};this.outGain=function(a,b){if(void 0==b)return e[a].gain;e[a].gain=b;workspace.library.audio.changeAudioParam(f,e[a].node.gain,e[a].gain,.01,"instant",!0)}};
this.filterUnit=function(f){var d=f.createGain();workspace.library.audio.changeAudioParam(f,d.gain,1,.01,"instant",!0);var e=f.createBiquadFilter();e.type="lowpass";workspace.library.audio.changeAudioParam(f,e.frequency,110,.01,"instant",!0);workspace.library.audio.changeAudioParam(f,e.gain,1,.01,"instant",!0);workspace.library.audio.changeAudioParam(f,e.Q,.1,.01,"instant",!0);var a=f.createGain();workspace.library.audio.changeAudioParam(f,a.gain,1,.01,"instant",!0);d.connect(e);e.connect(a);this.in=
function(){return d};this.out=function(){return a};this.type=function(a){e.type=a};this.frequency=function(a){workspace.library.audio.changeAudioParam(f,e.frequency,a,.01,"instant",!0)};this.gain=function(a){workspace.library.audio.changeAudioParam(f,e.gain,a,.01,"instant",!0)};this.Q=function(a){workspace.library.audio.changeAudioParam(f,e.Q,a,.01,"instant",!0)};this.measureFrequencyResponse=function(a,c,d){for(var b=[];a<c;a+=d)b.push(a);return this.measureFrequencyResponse_values(b)};this.measureFrequencyResponse_values=
function(a){var b=new Float32Array(a),d=new Float32Array(b.length),f=new Float32Array(b.length);e.getFrequencyResponse(b,d,f);return[d,a]}};this.synthesizer=function(f,d,e,a,b,c,h,k,m,g,l,p,y,q,r,x){e=void 0===e?{sin:[0,1],cos:[0,0]}:e;a=void 0===a?1:a;b=void 0===b?0:b;c=void 0===c?0:c;h=void 0===h?.01:h;k=void 0===k?1:k;m=void 0===m?{time:.01,curve:"linear"}:m;g=void 0===g?{time:.05,curve:"linear"}:g;r=void 0===r?.01:r;x=void 0===x?1:x;var n={},w={},t={},v={};n.waveType=void 0===d?"sine":d;n.periodicWave=
e;n.attack=m;n.release=g;n.octave=void 0===l?0:l;n.detune=void 0===p?0:p;n.func=function(a,b,c,d,e,f,k,h,l,m){return new function(){this.generator=a.createOscillator();"custom"==d?this.generator.setPeriodicWave(a.createPeriodicWave(new Float32Array(e.cos),new Float32Array(e.sin))):this.generator.type=d;this.generator.frequency.setTargetAtTime(workspace.library.audio.num2freq(c+12*m),a.currentTime,0);this.generator.detune.setTargetAtTime(l,a.currentTime,0);this.generator.start(0);this.gain=a.createGain();
this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,a.currentTime,0);workspace.library.audio.changeAudioParam(a,this.gain.gain,f,k.time,k.curve,!1);this.gain.connect(b);this.detune=function(b,c,d){workspace.library.audio.changeAudioParam(a,this.generator.detune,b,c,d)};this.changeVelocity=function(b){workspace.library.audio.changeAudioParam(a,this.gain.gain,b,k.time,k.curve)};this.stop=function(){workspace.library.audio.changeAudioParam(a,this.gain.gain,0,h.time,h.curve,!1);setTimeout(function(a){a.gain.disconnect();
a.generator.stop();a.generator.disconnect();a.gain=null;a.generator=null},1E3*h.time,this)}}};t.depth=void 0===y?0:y;t.period=void 0===q?0:q;t.phase=!0;t.wave="s";t.interval=null;t.start=function(){t.period<r||t.period>=x||(t.interval=setInterval(function(){var a=Object.keys(w);if(t.phase)for(var b=0;b<a.length;b++)w[a[b]].detune(t.depth,.9*t.period,t.wave);else for(b=0;b<a.length;b++)w[a[b]].detune(-t.depth,.9*t.period,t.wave);t.phase=!t.phase},1E3*t.period))};t.stop=function(){clearInterval(t.interval)};
var z=f.createGain();z.gain.setTargetAtTime(1,f.currentTime,0);v.depth=b;v.period=c;v.phase=!0;v.wave="s";v.interval=null;v.start=function(){v.period<h||v.period>=k?workspace.library.audio.changeAudioParam(f,v.node.gain,1,.01,v.wave):v.interval=setInterval(function(){v.phase?workspace.library.audio.changeAudioParam(f,v.node.gain,1,.9*v.period,v.wave):workspace.library.audio.changeAudioParam(f,v.node.gain,1-v.depth,.9*v.period,v.wave);v.phase=!v.phase},1E3*v.period)};v.stop=function(){clearInterval(v.interval)};
v.node=f.createGain();v.node.gain.setTargetAtTime(1,f.currentTime,0);z.connect(v.node);var B=f.createGain();B.gain.setTargetAtTime(a,f.currentTime,0);v.node.connect(B);this.out=function(){return B};this.perform=function(a){if(w[a.num]||0!=a.velocity)w[a.num]?0==a.velocity?(w[a.num].stop(),delete w[a.num]):w[a.num].changeVelocity(a.velocity):w[a.num]=n.func(f,z,a.num,n.waveType,n.periodicWave,a.velocity,n.attack,n.release,n.detune,n.octave)};this.panic=function(){for(var a=Object.keys(w),b=0;b<a.length;b++)this.perform({num:a[b],
velocity:0})};this.waveType=function(a){if(null==a)return n.waveType;n.waveType=a};this.periodicWave=function(a){if(null==a)return n.periodicWave;n.periodicWave=a};this.gain=function(a,b,c){return workspace.library.audio.changeAudioParam(f,B.gain,a,b,c)};this.attack=function(a,b){if(null==a&&null==b)return n.attack;n.attack.time=a?a:n.attack.time;n.attack.curve=b?b:n.attack.curve};this.release=function(a,b){if(null==a&&null==b)return n.release;n.release.time=a?a:n.release.time;n.release.curve=b?b:
n.release.curve};this.octave=function(a){if(null==a)return n.octave;n.octave=a};this.detune=function(a,b,c){if(null==a)return n.detune;var d=n.detune,e=a-d,f=Math.round(Math.abs(e)),k=f*b,h=[1];switch(c){case "linear":h=system.utility.math.curveGenerator.linear(k);break;case "exponential":h=system.utility.math.curveGenerator.exponential(k);break;case "s":h=system.utility.math.curveGenerator.s(k,8)}if(0!=h.length)var l=setInterval(function(){n.detune=d+h.shift()*e;0==h.length&&clearInterval(l)},1E3/
f);f=Object.keys(w);for(k=0;k<f.length;k++)w[f[k]].detune(a,b,c)};this.gainWobbleDepth=function(a){if(null==a)return v.depth;v.depth=a;v.stop();v.start()};this.gainWobblePeriod=function(a){if(null==a)return v.period;v.period=a;v.stop();v.start()};this.detuneWobbleDepth=function(a){if(null==a)return t.depth;t.depth=a;t.stop();t.start()};this.detuneWobblePeriod=function(a){if(null==a)return t.period;t.period=a;t.stop();t.start()}}}};this.part=new function(){this.alpha=new function(){var f=this;this.basic=
new function(){this.polygon=function(d,e,a,b,c,f,k,m,n,l,p){d=void 0===d?null:d;e=void 0===e?[]:e;a=void 0===a?!1:a;b=void 0===b?"rgba(255,100,255,1)":b;c=void 0===c?"rgba(0,0,0,0)":c;f=void 0===f?1:f;k=void 0===k?"round":k;m=void 0===m?2:m;n=void 0===n?"rgba(0,0,0,0)":n;l=void 0===l?20:l;p=void 0===p?{x:20,y:20}:p;var h=workspace.core.arrangement.createElement("polygon");h.name=d;h.points=e;h.ignored=a;h.style.fill=b;h.style.stroke=c;h.style.lineWidth=f;h.style.lineJoin=k;h.style.miterLimit=m;h.style.shadowColour=
n;h.style.shadowBlur=l;h.style.shadowOffset=p;return h};this.advancedPolygon=function(d,e,a,b,c,f,k,m,n,l){d=void 0===d?null:d;e=void 0===e?[]:e;a=void 0===a?"rgba(255,100,255,1)":a;b=void 0===b?"rgba(0,0,0,1)":b;c=void 0===c?1:c;f=void 0===f?"round":f;k=void 0===k?2:k;m=void 0===m?"rgba(0,0,0,0)":m;n=void 0===n?20:n;l=void 0===l?{x:20,y:20}:l;var h=workspace.core.arrangement.createElement("advancedPolygon");h.name=d;h.points=e;h.style.fill=a;h.style.stroke=b;h.style.lineWidth=c;h.style.lineJoin=
f;h.style.miterLimit=k;h.style.shadowColour=m;h.style.shadowBlur=n;h.style.shadowOffset=l;return h};this.circle=function(d,e,a,b,c,f,k,m,n,l,p,g,q){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?2:b;c=void 0===c?!1:c;f=void 0===f?"rgba(255,100,255,1)":f;k=void 0===k?"rgba(0,0,0,0)":k;m=void 0===m?1:m;n=void 0===n?"round":n;l=void 0===l?2:l;p=void 0===p?"rgba(0,0,0,0)":p;g=void 0===g?20:g;q=void 0===q?{x:20,y:20}:q;var h=workspace.core.arrangement.createElement("circle");h.name=
d;h.x=e;h.y=a;h.r=b;h.ignored=c;h.style.fill=f;h.style.stroke=k;h.style.lineWidth=m;h.style.lineJoin=n;h.style.miterLimit=l;h.style.shadowColour=p;h.style.shadowBlur=g;h.style.shadowOffset=q;return h};this.canvas=function(d,e,a,b,c,f,k,m,n){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?10:b;c=void 0===c?10:c;f=void 0===f?0:f;k=void 0===k?{x:0,y:0}:k;m=void 0===m?!1:m;n=void 0===n?1:n;var h=workspace.core.arrangement.createElement("canvas");h.name=d;h.x=e;h.y=a;h.parameter.width(b);
h.parameter.height(c);h.resolution(n);h.angle=f;h.anchor=k;h.ignored=m;return h};this.image=function(d,e,a,b,c,f,k,m,n){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?10:b;c=void 0===c?10:c;f=void 0===f?0:f;k=void 0===k?{x:0,y:0}:k;m=void 0===m?!1:m;n=void 0===n?"":n;var h=workspace.core.arrangement.createElement("image");h.name=d;h.x=e;h.y=a;h.width=b;h.height=c;h.angle=f;h.anchor=k;h.ignored=m;h.url=n;return h};this.path=function(d,e,a,b,c,f,k,m,n,l,p){d=void 0===d?null:d;e=
void 0===e?[]:e;a=void 0===a?!1:a;b=void 0===b?"rgba(0,0,0,1)":b;c=void 0===c?1:c;f=void 0===f?"butt":f;k=void 0===k?"miter":k;m=void 0===m?2:m;n=void 0===n?"rgba(0,0,0,0)":n;l=void 0===l?20:l;p=void 0===p?{x:20,y:20}:p;var h=workspace.core.arrangement.createElement("path");h.name=d;h.points=e;h.ignored=a;h.style.stroke=b;h.style.lineWidth=c;h.style.lineCap=f;h.style.lineJoin=k;h.style.miterLimit=m;h.style.shadowColour=n;h.style.shadowBlur=l;h.style.shadowOffset=p;return h};this.rectangle=function(d,
e,a,b,c,f,k,m,n,l,p,g,q,r,x,u){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?10:b;c=void 0===c?10:c;f=void 0===f?0:f;k=void 0===k?{x:0,y:0}:k;m=void 0===m?!1:m;n=void 0===n?"rgba(255,100,255,1)":n;l=void 0===l?"rgba(0,0,0,0)":l;p=void 0===p?1:p;g=void 0===g?"round":g;q=void 0===q?2:q;r=void 0===r?"rgba(0,0,0,0)":r;x=void 0===x?20:x;u=void 0===u?{x:20,y:20}:u;var h=workspace.core.arrangement.createElement("rectangle");h.name=d;h.x=e;h.y=a;h.width=b;h.height=c;h.angle=f;h.anchor=
k;h.ignored=m;h.style.fill=n;h.style.stroke=l;h.style.lineWidth=p;h.style.lineJoin=g;h.style.miterLimit=q;h.style.shadowColour=r;h.style.shadowBlur=x;h.style.shadowOffset=u;return h};this.group=function(d,e,a,b,c){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===c?!1:c;var f=workspace.core.arrangement.createElement("group");f.name=d;f.x=e;f.y=a;f.angle=b;f.ignored=c;return f};this.text=function(d,e,a,b,c,f,k,m,n,l,p,g,q,r,x,u,w,t,v){d=void 0===d?null:d;e=void 0===
e?0:e;a=void 0===a?0:a;b=void 0===b?"Hello":b;c=void 0===c?0:c;f=void 0===f?{x:0,y:0}:f;k=void 0===k?1:k;m=void 0===m?!1:m;n=void 0===n?"30pt Arial":n;l=void 0===l?"start":l;p=void 0===p?"alphabetic":p;g=void 0===g?"rgba(255,100,255,1)":g;q=void 0===q?"rgba(0,0,0,0)":q;r=void 0===r?1:r;x=void 0===x?"round":x;u=void 0===u?2:u;w=void 0===w?"rgba(0,0,0,0)":w;t=void 0===t?20:t;v=void 0===v?{x:20,y:20}:v;var h=workspace.core.arrangement.createElement("text");h.name=d;h.x=e;h.y=a;h.text=b;h.angle=c;h.anchor=
f;h.size=k;h.ignored=m;h.style.font=n;h.style.align=l;h.style.baseline=p;h.style.fill=g;h.style.stroke=q;h.style.lineWidth=r;h.style.lineJoin=x;h.style.miterLimit=u;h.style.shadowColour=w;h.style.shadowBlur=t;h.style.shadowOffset=v;return h}};this.display=new function(){this.rastorDisplay=function(d,e,a,b,c,h,k,m,g,l,p,y){function n(){for(var a=0;a<k;a++)for(var b=0;b<m;b++)r[a][b].style.fill="rgb("+255*x[a][b][0]+","+255*x[a][b][1]+","+255*x[a][b][2]+")"}c=void 0===c?60:c;h=void 0===h?60:h;k=void 0===
k?8:k;m=void 0===m?8:m;g=void 0===g?.1:g;l=void 0===l?.1:l;p=void 0===p?"rgba(50,50,50)":p;y=void 0===y?"rgba(0,0,0)":y;d=f.builder("group",void 0===d?"rastorDisplay":d,{x:e,y:a,angle:void 0===b?0:b});p=f.builder("rectangle","backing",{width:c,height:h,style:{fill:p}});d.append(p);b=f.builder("group","pixels");d.append(b);var r=[],x=[];c/=k;h/=m;for(e=0;e<k;e++){var u=[],w=[];for(a=0;a<m;a++)p=f.builder("rectangle",e+"_"+a,{x:e*c+g/2,y:a*h+l/2,width:c-g,height:h-l,style:{fill:y}}),u.push(p),w.push([0,
0,0]),b.append(p);r.push(u);x.push(w)}d.get=function(a,b){return x[a][b]};d.set=function(a,b,c){x[a][b]=c;n()};d.import=function(a){for(var b=0;b<k;b++)for(var c=0;c<m;c++)this.set(b,c,a[b][c]);n()};d.export=function(){return x};d.setAll=function(a){for(var b=0;b<k;b++)for(var c=0;c<m;c++)this.set(b,c,a)};d.test=function(){this.setAll([1,1,1]);this.set(1,1,[1,.5,.5]);this.set(2,2,[.5,1,.5]);this.set(3,3,[.5,.5,1]);this.set(4,4,[1,.5,1]);n()};return d};this.grapher_audioScope=function(d,e,a,b,c,h,
k,m,g,l,p,y,q,r){d=void 0===d?"grapher_audioScope":d;b=void 0===b?120:b;c=void 0===c?60:c;h=void 0===h?0:h;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:k;m=void 0===m?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:m;g=void 0===g?"rgba(0,100,0,1)":g;l=void 0===l?.25:l;p=void 0===p?"rgba(0,150,0,1)":p;y=void 0===y?.1:y;q=void 0===q?"Helvetica":q;r=void 0===r?"rgba(50,50,50,1)":r;var n=workspace.library.audio.context.createAnalyser(),u=null,w=10,t=null,v=256;n.fftSize=
v;u=new Uint8Array(n.fftSize);new Uint8Array(n.fftSize);e=f.builder("group",d,{x:e,y:a,angle:h});var z=f.builder("grapher",d,{x:0,y:0,width:b,height:c,foregroundStyles:[k],foregroundTextStyles:[m],backgroundStyle_stroke:g,backgroundStyle_lineWidth:l,backgroundTextStyle_fill:p,backgroundTextStyle_size:y,backgroundTextStyle_font:q,backingStyle:r});e.append(z);e.start=function(){null==t&&(t=setInterval(function(){var a=[];n.getByteTimeDomainData(u);for(var b=0;b<u.length;b++)a.push(u[b]/128-1);z.draw(a)},
1E3/w))};e.stop=function(){clearInterval(t);t=null};e.getNode=function(){return n};e.resolution=function(a){a=void 0===a?null:a;if(null==a)return v;v=a;this.stop();this.start()};e.refreshRate=function(a){if(null==a)return w;w=a;this.stop();this.start()};z.viewbox({l:-1.1,h:1.1});z.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});z.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});z.drawBackground();return e};this.sevenSegmentDisplay=function(d,e,a,b,c,
h,k,m,g){b=void 0===b?20:b;c=void 0===c?30:c;k=void 0===k?"rgb(0,0,0)":k;m=void 0===m?"rgb(200,200,200)":m;g=void 0===g?"rgb(20,20,20)":g;var l=b/8,p=b/8;h=[{x:1*p+l,y:1*p+l},{x:.5*p+l,y:.5*p+l},{x:1*p+l,y:0*p+l},{x:0*p+l,y:1*p+l}];var n=[{x:b-1*p-l,y:0*p+l},{x:b-.5*p-l,y:.5*p+l},{x:b-1*p-l,y:1*p+l},{x:b-0*p-l,y:1*p+l}],q=[{x:1*p+l,y:.5*c-1*p+.5*l},{x:.5*p+l,y:.5*c-.5*p+.5*l},{x:1*p+l,y:.5*c-0*p+.5*l},{x:0*p+l,y:.5*c-1*p+.5*l},{x:0*p+l,y:.5*c-0*p+.5*l}],r=[{x:b-1*p-l,y:.5*c-0*p+.5*l},{x:b-.5*p-l,
y:.5*c-.5*p+.5*l},{x:b-1*p-l,y:.5*c-1*p+.5*l},{x:b-0*p-l,y:.5*c-1*p+.5*l},{x:b-0*p-l,y:.5*c-0*p+.5*l}],x=[{x:1*p+l,y:c-1*p-l},{x:.5*p+l,y:c-.5*p-l},{x:1*p+l,y:c-0*p-l},{x:0*p+l,y:c-1*p-l}];l=[{x:b-1*p-l,y:c-0*p-l},{x:b-.5*p-l,y:c-.5*p-l},{x:b-1*p-l,y:c-1*p-l},{x:b-0*p-l,y:c-1*p-l}];d=f.builder("group",void 0===d?"sevenSegmentDisplay":d,{x:e,y:a});b=f.builder("rectangle","backing",{width:b,height:c,style:{fill:k}});d.append(b);var u=[];b=[[h[0],n[2],n[1],n[0],h[2],h[1]],[h[1],h[3],q[3],q[1],q[0],h[0]],
[n[1],n[3],r[3],r[1],r[2],n[2]],[q[0],r[2],r[1],r[0],q[2],q[1]],[q[1],q[4],x[3],x[1],x[0],q[2]],[r[1],r[4],l[3],l[1],l[2],r[0]],[x[0],l[2],l[1],l[0],x[2],x[1]]];for(c=0;c<b.length;c++)k={segment:f.builder("polygon","segment_"+c,{points:b[c],style:{fill:g}}),state:!1},u.push(k),d.append(k.segment);d.set=function(a,b){u[a].state=b;u[a].segment.style.fill=b?m:g};d.get=function(a){return u[a].state};d.clear=function(){for(var a=0;a<u.length;a++)this.set(a,!1)};d.enterCharacter=function(a){switch(a){case 0:case "0":a=
[1,1,1,0,1,1,1];break;case 1:case "1":a=[0,0,1,0,0,1,0];break;case 2:case "2":a=[1,0,1,1,1,0,1];break;case 3:case "3":a=[1,0,1,1,0,1,1];break;case 4:case "4":a=[0,1,1,1,0,1,0];break;case 5:case "5":a=[1,1,0,1,0,1,1];break;case 6:case "6":a=[1,1,0,1,1,1,1];break;case 7:case "7":a=[1,0,1,0,0,1,0];break;case 8:case "8":a=[1,1,1,1,1,1,1];break;case 9:case "9":a=[1,1,1,1,0,1,1];break;default:a=[0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,1==a[b])};return d};this.sixteenSegmentDisplay=function(d,
e,a,b,c,h,k,m,g){b=void 0===b?20:b;c=void 0===c?30:c;k=void 0===k?"rgb(0,0,0)":k;m=void 0===m?"rgb(200,200,200)":m;g=void 0===g?"rgb(20,20,20)":g;var l=b/8,p=b/8;h=[{x:.5*p+l,y:.5*p+l},{x:1*p+l,y:0*p+l},{x:0*p+l,y:1*p+l},{x:1*p+l,y:1*p+l},{x:1.75*p+l,y:1*p+l},{x:1*p+l,y:1.75*p+l}];var n=[{x:b/2,y:.5*p+l},{x:b/2-.5*p,y:1*p+l},{x:b/2+.5*p,y:1*p+l},{x:b/2-.5*p,y:0*p+l},{x:b/2+.5*p,y:0*p+l}],q=[{x:b-.5*p-l,y:.5*p+l},{x:b-1*p-l,y:0*p+l},{x:b-0*p-l,y:1*p+l},{x:b-1*p-l,y:1*p+l},{x:b-1*p-l,y:1.75*p+l},{x:b-
1.75*p-l,y:1*p+l}],r=[{x:0*p+l,y:.5*c-.5*p},{x:1*p+l,y:.5*c-.5*p},{x:.5*p+l,y:.5*c-0*p},{x:0*p+l,y:.5*c+.5*p},{x:1*p+l,y:.5*c+.5*p}],x=[{x:b/2,y:c/2},{x:b/2-.5*p,y:.5*p+c/2},{x:b/2-.25*p,y:1.25*p+c/2},{x:b/2-1*p,y:.5*p+c/2},{x:b/2+.5*p,y:.5*p+c/2},{x:b/2+.5*p,y:1.75*p+c/2},{x:b/2+1*p,y:.5*p+c/2},{x:b/2-.5*p,y:.5*-p+c/2},{x:b/2-.25*p,y:1.25*-p+c/2},{x:b/2-1*p,y:.25*-p+c/2},{x:b/2+.5*p,y:.5*-p+c/2},{x:b/2+.5*p,y:1.75*-p+c/2},{x:b/2+1*p,y:.25*-p+c/2}],u=[{x:b-1*p-l,y:.5*c-.5*p},{x:b-0*p-l,y:.5*c-.5*
p},{x:b-.5*p-l,y:.5*c-0*p},{x:b-1*p-l,y:.5*c+.5*p},{x:b-0*p-l,y:.5*c+.5*p}],w=[{x:.5*p+l,y:c-.5*p-l},{x:0*p+l,y:c-1*p-l},{x:1*p+l,y:c-0*p-l},{x:1*p+l,y:c-1*p-l},{x:1*p+l,y:c-1.75*p-l},{x:1.75*p+l,y:c-1*p-l}],t=[{x:b/2-.5*p,y:c-1*p-l},{x:b/2+.5*p,y:c-1*p-l},{x:b/2,y:c-.5*p-l},{x:b/2-.5*p,y:c-0*p-l},{x:b/2+.5*p,y:c-0*p-l}];l=[{x:b-.5*p-l,y:c-.5*p-l},{x:b-0*p-l,y:c-1*p-l},{x:b-1*p-l,y:c-0*p-l},{x:b-1*p-l,y:c-1*p-l},{x:b-1*p-l,y:c-1.75*p-l},{x:b-1.75*p-l,y:c-1*p-l}];d=f.builder("group",void 0===d?"sixteenSegmentDisplay":
d,{x:e,y:a});b=f.builder("rectangle","backing",{width:b,height:c,style:{fill:k}});d.append(b);var v=[];b=[[h[1],h[0],h[3],n[1],n[0],n[3]],[n[4],n[0],n[2],q[3],q[0],q[1]],[h[0],h[2],r[0],r[2],r[1],h[3]],[h[4],h[3],h[5],x[9],x[7],x[8]],[n[0],n[1],x[7],x[0],x[10],n[2]],[q[4],q[3],q[5],x[11],x[10],x[12]],[q[0],q[2],u[1],u[2],u[0],q[3]],[r[4],r[2],r[1],x[7],x[0],x[1]],[u[3],u[2],u[0],x[10],x[0],x[4]],[w[0],w[1],r[3],r[2],r[4],w[3]],[w[4],w[3],w[5],x[2],x[1],x[3]],[t[0],t[2],t[1],x[4],x[0],x[1]],[l[4],
l[3],l[5],x[5],x[4],x[6]],[l[3],u[3],u[2],u[4],l[1],l[0]],[w[2],w[0],w[3],t[0],t[2],t[3]],[l[2],l[0],l[3],t[1],t[2],t[4]]];for(c=0;c<b.length;c++)k={segment:f.builder("polygon","segment_"+c,{points:b[c],style:{fill:g}}),state:!1},v.push(k),d.append(k.segment);d.set=function(a,b){v[a].state=b;v[a].segment.style.fill=b?m:g};d.get=function(a){return v[a].state};d.clear=function(){for(var a=0;a<v.length;a++)this.set(a,!1)};d.enterCharacter=function(a){switch(a){case "!":a=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,
1,1];break;case "?":a=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":a=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":a=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":a=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':a=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":a=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":a=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":a=[0,0,0,0,0,1,0,0,0,
0,1,0,0,0,0,0];break;case "*":a=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":a=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":a=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":a=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":a=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":a=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":a=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":a=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":a=[1,1,0,0,0,
1,0,0,1,0,0,0,1,0,1,1];break;case "0":a=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":a=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":a=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":a=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":a=[1,
1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":a=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":a=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":a=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":a=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":a=[0,0,1,0,0,0,1,1,1,1,0,0,
0,1,0,0];break;case "i":case "I":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":a=[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":a=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":a=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":a=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":a=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":a=
[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":a=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":a=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":a=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":a=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":a=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":a=[0,0,0,1,0,1,0,0,0,0,
0,1,0,0,0,0];break;case "z":case "Z":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":a=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,1==a[b])};return d};this.glowbox_rect=function(d,e,a,b,c,h,k,m){b=void 0===b?30:b;c=void 0===c?30:c;h=void 0===h?0:h;k=void 0===k?"rgba(244,234,141,1)":k;m=void 0===m?"rgba(80,80,80,1)":m;d=f.builder("group",void 0===d?"glowbox_rect":d,{x:e,y:a});var g=f.builder("rectangle","light",{width:b,
height:c,angle:h,style:{fill:m}});d.append(g);d.on=function(){g.style.fill=k};d.off=function(){g.style.fill=m};return d};this.audio_meter_level=function(d,e,a,b,c,h,k,m,n,l,p){c=void 0===c?20:c;h=void 0===h?60:h;k=void 0===k?[.125,.25,.375,.5,.625,.75,.875]:k;m=void 0===m?"rgb(10,10,10)":m;n=void 0===n?["rgba(250,250,250,1)","rgb(100,100,100)"]:n;l=void 0===l?"rgba(220,220,220,1)":l;p=void 0===p?"1pt Courier New":p;d=f.builder("group",void 0===d?"audio_meter_level":d,{x:e,y:a,angle:void 0===b?0:b});
var y=f.builder("meter_level","meter",{width:c,height:h,markings:k,style:{backing:m,levels:n,markingStyle_fill:l,markingStyle_font:p}});d.append(y);var q=g.circuit.alpha.audio2percentage();q.newValue=function(a){y.set(a)};d.audioIn=function(){return q.audioIn()};d.start=function(){q.start()};d.stop=function(){q.stop()};return d};this.grapher__static=function(d,e,a,b,c,h,k,m,g,l,p,y,q,r){function n(){A._.fillStyle=r;A._.fillRect(0,0,A.$(b),A.$(c))}function u(){for(var a=workspace.library.math.relativeDistance(b,
t.left,t.right,v.mappedPosition),d=0;d<v.points.length;d++)if(v.points[d]<t.top||v.points[d]>t.bottom){var e=c-workspace.library.math.relativeDistance(c,t.bottom,t.top,v.points[d]);A._.fillStyle=l;A._.fillRect(0,A.$(e),A.$(b),A.$(p));v.printText&&(A._.fillStyle=y,A._.font=q,A._.fillText(v.printingValues&&void 0!=v.printingValues[d]?v.printingValues[d]:v.points[d],A.$(a+v.textPositionOffset.x),A.$(e+v.textPositionOffset.y)))}e=c-workspace.library.math.relativeDistance(c,t.bottom,t.top,z.mappedPosition);
for(d=0;d<z.points.length;d++)z.points[d]<t.left||z.points[d]>t.right||(a=workspace.library.math.relativeDistance(b,t.left,t.right,z.points[d]),A._.fillStyle=l,A._.fillRect(A.$(a),0,A.$(p),A.$(c)),z.printText&&(A._.fillStyle=y,A._.font=q,A._.fillText(z.printingValues&&void 0!=z.printingValues[d]?z.printingValues[d]:z.points[d],A.$(a+z.textPositionOffset.x),A.$(e+z.textPositionOffset.y))))}function w(a,e,f){f=void 0===f?0:f;B[f]=void 0==a&&void 0==e?void 0:{x:e,y:a};if(void 0!=B[f]&&void 0==B[f].y)console.warn("grapher__static error",
d,"attempting to add line with no y component"),console.warn("x:",B[f].x),console.warn("y:",B[f].y);else for(a=0;a<B.length;a++)if(void 0!=B[a]){f=B[a];A._.strokeStyle=m[a].stroke;A._.lineWidth=A.$(m[a].lineWidth);A._.lineJoin=m[a].lineJoin;A._.lineCap=m[a].lineJoin;A._.beginPath();if(void 0!=f.y&&void 0==f.x)for(A._.moveTo(0,A.$(c-workspace.library.math.relativeDistance(c,t.bottom,t.top,f.y[0],!0))),e=1;e<f.y.length;e++)A._.lineTo(A.$(b/(f.y.length-1)*e),A.$(c-workspace.library.math.relativeDistance(c,
t.bottom,t.top,f.y[e],!0)));else if(f.y.length==f.x.length)for(e=0;e<f.y.length;e++)for(A._.moveTo(A.$(workspace.library.math.relativeDistance(b,t.left,t.right,f.x[0],!0)),A.$(c-workspace.library.math.relativeDistance(c,t.bottom,t.top,f.y[0],!0))),e=1;e<f.y.length;e++)A._.lineTo(A.$(workspace.library.math.relativeDistance(b,t.left,t.right,f.x[e],!0)),A.$(c-workspace.library.math.relativeDistance(c,t.bottom,t.top,f.y[e],!0)));else console.error("grapher__static::"+d,":layers are of different length:",
f.y,f.x);A._.stroke()}}d=void 0===d?"grapher__static":d;b=void 0===b?120:b;c=void 0===c?60:c;k=void 0===k?5:k;m=void 0===m?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:m;l=void 0===l?"rgba(0,100,0,1)":l;p=void 0===p?.25:p;y=void 0===y?"rgba(0,150,0,1)":y;q=void 0===q?"7.5pt Helvetica":q;r=void 0===r?"rgba(50,50,50,1)":r;var t={bottom:-1,top:1,left:-1,right:1},v={points:[.75,
.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},z={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},B=[];e=f.builder("group",d,{x:e,y:a,angle:void 0===h?0:h});var A=f.builder("canvas","backing",{width:b,height:c,resolution:k});e.append(A);e.resolution=function(a){return A.resolution(a)};e.viewbox=function(a){if(null==a)return t;void 0!=a.bottom&&(t.bottom=a.bottom);void 0!=a.top&&
(t.top=a.top);void 0!=a.left&&(t.left=a.left);void 0!=a.right&&(t.right=a.right)};e.horizontalMarkings=function(a){if(null==a)return v;void 0!=a.points&&(v.points=a.points);void 0!=a.printingValues&&(v.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(v.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(v.printText=a.printText)};e.verticalMarkings=function(a){if(null==a)return z;void 0!=a.points&&(z.points=a.points);void 0!=a.printingValues&&(z.printingValues=a.printingValues);
void 0!=a.textPositionOffset&&(z.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(z.printText=a.printText)};e.drawBackground=function(){n();u()};e.drawForeground=function(a,b,c){w(a,b,void 0===c?0:c)};e.draw=function(a,b,c){c=void 0===c?0:c;n();u();w(a,b,c)};return e};this.grapher_periodicWave__static=function(d,e,a,b,c,h,k,m,g,l,p,y,q,r){d=void 0===d?"grapher_periodicWave__static":d;b=void 0===b?120:b;c=void 0===c?60:c;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:
k;m=void 0===m?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:m;g=void 0===g?"rgba(0,100,0,1)":g;l=void 0===l?.25:l;p=void 0===p?"rgba(0,150,0,1)":p;y=void 0===y?.1:y;q=void 0===q?"Helvetica":q;r=void 0===r?"rgba(50,50,50,1)":r;var n={sin:[],cos:[]},u=100;e=f.builder("group",d,{x:e,y:a,angle:void 0===h?0:h});var w=f.builder("grapher__static",d,{x:0,y:0,width:b,height:c,foregroundStyles:[k],foregroundTextStyles:[m],backgroundStyle_stroke:g,backgroundStyle_lineWidth:l,backgroundTextStyle_fill:p,
backgroundTextStyle_size:y,backgroundTextStyle_font:q,backingStyle:r});e.append(w);e.wave=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;if(null==a){for(;n.sin.length<n.cos.length;)n.sin.push(0);for(;n.sin.length>n.cos.length;)n.cos.push(0);for(a=0;a<n.sin.length;a++)n.sin[a]||(n.sin[a]=0),n.cos[a]||(n.cos[a]=0);return n}null==b&&(n=a);switch(b){case "sin":n.sin=a;break;case "cos":n.cos=a}};e.waveElement=function(a,b,c){if(null==c)return n[a][b];n[a][b]=c};e.resolution=function(a){a=void 0===
a?null:a;if(null==a)return u;u=a};e.updateBackground=function(){w.viewbox({bottom:-1.1,top:1.1,left:0});w.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});w.verticalMarkings({points:[0,.25,.5,.75],printText:!0});w.drawBackground()};e.draw=function(){for(var a=[],b,c=0;c<=u;c++){for(var d=b=0;d<n.sin.length;d++)n.sin[d]||(n.sin[d]=0),b+=Math.sin(c/u*d*Math.PI*2)*n.sin[d];for(d=0;d<n.cos.length;d++)n.cos[d]||(n.cos[d]=0),b+=Math.cos(c/u*d*Math.PI*2)*n.cos[d];a.push(b)}w.draw(a)};
e.reset=function(){this.wave({sin:[],cos:[]});this.resolution(100);this.updateBackground()};return e};this.grapher=function(d,e,a,b,c,h,k,m,g,l,p,y,q){function n(){z.clear();for(var a=workspace.library.math.relativeDistance(b,u.left,u.right,w.mappedPosition),d=0;d<w.points.length;d++)if(w.points[d]<u.top||w.points[d]>u.bottom){var e=c-workspace.library.math.relativeDistance(c,u.bottom,u.top,w.points[d]),k=f.builder("rectangle","horizontal_line_"+d,{x:0,y:e,width:b,height:l,style:{fill:g}});z.append(k);
w.printText&&(k=f.builder("text","horizontal_text_"+d,{x:a+w.textPositionOffset.x,y:e+w.textPositionOffset.y,text:w.printingValues&&void 0!=w.printingValues[d]?w.printingValues[d]:w.points[d],style:{fill:p,font:y}}),z.append(k))}e=c-workspace.library.math.relativeDistance(c,u.bottom,u.top,t.mappedPosition);for(d=0;d<t.points.length;d++)t.points[d]<u.left||t.points[d]>u.right||(a=workspace.library.math.relativeDistance(b,u.left,u.right,t.points[d]),k=f.builder("rectangle","vertical_line_"+d,{x:a,y:0,
width:l,height:c,style:{fill:g}}),z.append(k),t.printText&&(k=f.builder("text","vertical_text_"+d,{x:a+t.textPositionOffset.x,y:e+t.textPositionOffset.y,text:t.printingValues&&void 0!=t.printingValues[d]?t.printingValues[d]:t.points[d],style:{fill:p,font:y}}),z.append(k)))}function x(a,e,h){h=void 0===h?0:h;B.clear();v[h]=void 0==a&&void 0==e?void 0:{x:e,y:a};if(void 0!=v[h]&&void 0==v[h].y)console.warn("grapher error",d,"attempting to add line with no y component"),console.warn("x:",v[h].x),console.warn("y:",
v[h].y);else for(a=0;a<v.length;a++)if(void 0!=v[a]){h=v[a];e=[];if(void 0!=h.y&&void 0==h.x)for(var m=0;m<h.y.length;m++)e.push({x:b/(h.y.length-1)*m,y:c-workspace.library.math.relativeDistance(c,u.bottom,u.top,h.y[m],!0)});else if(h.y.length==h.x.length)for(m=0;m<h.y.length;m++)e.push({x:workspace.library.math.relativeDistance(b,u.left,u.right,h.x[m],!0),y:c-workspace.library.math.relativeDistance(c,u.bottom,u.top,h.y[m],!0)});else console.error("grapher::"+d,":layers are of differnt length:",h.y,
h.x);B.append(f.builder("path","layer_"+a,{points:e,style:{stroke:k[a].stroke,lineWidth:k[a].lineWidth,lineJoin:k[a].lineJoin,lineCap:k[a].lineJoin}}))}}d=void 0===d?"grapher":d;b=void 0===b?120:b;c=void 0===c?60:c;k=void 0===k?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:k;g=void 0===g?"rgba(0,100,0,1)":g;l=void 0===l?.25:l;p=void 0===p?"rgba(0,150,0,1)":p;y=void 0===
y?"1.5pt Helvetica":y;q=void 0===q?"rgba(50,50,50,1)":q;var u={bottom:-1,top:1,left:-1,right:1},w={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},t={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},v=[];e=f.builder("group",d,{x:e,y:a,angle:void 0===h?0:h});q=f.builder("rectangle","backing",{width:b,height:c,style:{fill:q}});e.append(q);var z=f.builder("group","background");
e.append(z);var B=f.builder("group","foreground");e.append(B);q=f.builder("rectangle","stencil",{width:b,height:c});e.stencil(q);e.clip(!0);e.viewbox=function(a){if(null==a)return u;void 0!=a.bottom&&(u.bottom=a.bottom);void 0!=a.top&&(u.top=a.top);void 0!=a.left&&(u.left=a.left);void 0!=a.right&&(u.right=a.right)};e.horizontalMarkings=function(a){if(null==a)return w;void 0!=a.points&&(w.points=a.points);void 0!=a.printingValues&&(w.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(w.textPositionOffset=
a.textPositionOffset);void 0!=a.printText&&(w.printText=a.printText)};e.verticalMarkings=function(a){if(null==a)return t;void 0!=a.points&&(t.points=a.points);void 0!=a.printingValues&&(t.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(t.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(t.printText=a.printText)};e.drawBackground=function(){n()};e.drawForeground=function(a,b,c){x(a,b,void 0===c?0:c)};e.draw=function(a,b,c){c=void 0===c?0:c;n();x(a,b,c)};return e};this.meter_level=
function(d,e,a,b,c,h,k,m,g,l,p){function n(a){return f.builder("polygon","mark_"+a,{points:[{x:c,y:a-.1},{x:c-c/4,y:a-.1},{x:c-c/4,y:a+.1},{x:c,y:a+.1}],style:{fill:l}})}function q(a,b){return f.builder("text","text_"+b,{x:.5,y:a+.3,text:b,style:{fill:l,font:p}})}c=void 0===c?20:c;h=void 0===h?60:h;k=void 0===k?[.125,.25,.375,.5,.625,.75,.875]:k;m=void 0===m?"rgb(10,10,10)":m;g=void 0===g?["rgba(250,250,250,1)","fill:rgb(100,100,100)"]:g;l=void 0===l?"rgba(220,220,220,1)":l;p=void 0===p?"1pt Courier New":
p;d=f.builder("group",void 0===d?"meter_level":d,{x:e,y:a,angle:void 0===b?0:b});var r=f.builder("level","level",{width:c,height:h,style:{backing:m,levels:g}});d.append(r);m=f.builder("group","markings");d.append(m);for(g=0;g<k.length;g++)m.append(n(h*(1-k[g]))),m.append(q(h*(1-k[g]),k[g]));var x=0,u=0;setInterval(function(){r.layer(u,0);0<x&&(x-=.005);r.layer(x,1);u>x&&(x=u)},1E3/15);d.set=function(a){u=a};return d};this.sevenSegmentDisplay__static=function(d,e,a,b,c,h,k,m,g,l){function p(){A._.fillStyle=
m;A._.fillRect(0,0,A.$(b),A.$(c))}function n(){for(var a=0;a<z.length;a++){A._.beginPath();A._.moveTo(A.$(z[a][0].x),A.$(z[a][0].y));for(var b=1;b<z[a].length;b++)A._.lineTo(A.$(z[a][b].x),A.$(z[a][b].y));A._.closePath();A._.fillStyle=0==B[a]?l:g;A._.fill()}}b=void 0===b?20:b;c=void 0===c?30:c;k=void 0===k?5:k;m=void 0===m?"rgb(0,0,0)":m;g=void 0===g?"rgb(200,200,200)":g;l=void 0===l?"rgb(20,20,20)":l;var q=b/8,r=b/8,x=[{x:1*r+q,y:1*r+q},{x:.5*r+q,y:.5*r+q},{x:1*r+q,y:0*r+q},{x:0*r+q,y:1*r+q}],u=
[{x:b-1*r-q,y:0*r+q},{x:b-.5*r-q,y:.5*r+q},{x:b-1*r-q,y:1*r+q},{x:b-0*r-q,y:1*r+q}],w=[{x:1*r+q,y:.5*c-1*r+.5*q},{x:.5*r+q,y:.5*c-.5*r+.5*q},{x:1*r+q,y:.5*c-0*r+.5*q},{x:0*r+q,y:.5*c-1*r+.5*q},{x:0*r+q,y:.5*c-0*r+.5*q}],t=[{x:b-1*r-q,y:.5*c-0*r+.5*q},{x:b-.5*r-q,y:.5*c-.5*r+.5*q},{x:b-1*r-q,y:.5*c-1*r+.5*q},{x:b-0*r-q,y:.5*c-1*r+.5*q},{x:b-0*r-q,y:.5*c-0*r+.5*q}],v=[{x:1*r+q,y:c-1*r-q},{x:.5*r+q,y:c-.5*r-q},{x:1*r+q,y:c-0*r-q},{x:0*r+q,y:c-1*r-q}];q=[{x:b-1*r-q,y:c-0*r-q},{x:b-.5*r-q,y:c-.5*r-q},
{x:b-1*r-q,y:c-1*r-q},{x:b-0*r-q,y:c-1*r-q}];var z=[[x[0],u[2],u[1],u[0],x[2],x[1]],[x[1],x[3],w[3],w[1],w[0],x[0]],[u[1],u[3],t[3],t[1],t[2],u[2]],[w[0],t[2],t[1],t[0],w[2],w[1]],[w[1],w[4],v[3],v[1],v[0],w[2]],[t[1],t[4],q[3],q[1],q[2],t[0]],[v[0],q[2],q[1],q[0],v[2],v[1]]],B=[0,0,0,0,0,0,0];d=f.builder("group",void 0===d?"sevenSegmentDisplay__static":d,{x:e,y:a,angle:void 0===h?0:h});var A=f.builder("canvas","subcanvas",{width:b,height:c,resolution:k});d.append(A);d.set=function(a,b){B[a].state=
b;n()};d.get=function(a){return B[a].state};d.clear=function(){for(var a=0;a<B.length;a++)this.set(a,!1)};d.enterCharacter=function(a){switch(a){case 0:case "0":B=[1,1,1,0,1,1,1];break;case 1:case "1":B=[0,0,1,0,0,1,0];break;case 2:case "2":B=[1,0,1,1,1,0,1];break;case 3:case "3":B=[1,0,1,1,0,1,1];break;case 4:case "4":B=[0,1,1,1,0,1,0];break;case 5:case "5":B=[1,1,0,1,0,1,1];break;case 6:case "6":B=[1,1,0,1,1,1,1];break;case 7:case "7":B=[1,0,1,0,0,1,0];break;case 8:case "8":B=[1,1,1,1,1,1,1];break;
case 9:case "9":B=[1,1,1,1,0,1,1];break;default:B=[0,0,0,0,0,0,0]}p();n()};p();n();return d};this.grapher_periodicWave=function(d,e,a,b,c,h,k,m,g,l,p,y,q,r){d=void 0===d?"grapher_periodicWave":d;b=void 0===b?120:b;c=void 0===c?60:c;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:k;m=void 0===m?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:m;g=void 0===g?"rgba(0,100,0,1)":g;l=void 0===l?.25:l;p=void 0===p?"rgba(0,150,0,1)":p;y=void 0===y?.1:y;q=void 0===q?"Helvetica":
q;r=void 0===r?"rgba(50,50,50,1)":r;var n={sin:[],cos:[]},u=100;e=f.builder("group",d,{x:e,y:a,angle:void 0===h?0:h});var w=f.builder("grapher",d,{x:0,y:0,width:b,height:c,foregroundStyles:[k],foregroundTextStyles:[m],backgroundStyle_stroke:g,backgroundStyle_lineWidth:l,backgroundTextStyle_fill:p,backgroundTextStyle_size:y,backgroundTextStyle_font:q,backingStyle:r});e.append(w);e.wave=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;if(null==a){for(;n.sin.length<n.cos.length;)n.sin.push(0);for(;n.sin.length>
n.cos.length;)n.cos.push(0);for(a=0;a<n.sin.length;a++)n.sin[a]||(n.sin[a]=0),n.cos[a]||(n.cos[a]=0);return n}null==b&&(n=a);switch(b){case "sin":n.sin=a;break;case "cos":n.cos=a}};e.waveElement=function(a,b,c){if(null==c)return n[a][b];n[a][b]=c};e.resolution=function(a){a=void 0===a?null:a;if(null==a)return u;u=a};e.updateBackground=function(){w.viewbox({bottom:-1.1,top:1.1,left:0});w.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});w.verticalMarkings({points:[0,.25,.5,
.75],printText:!0});w.drawBackground()};e.draw=function(){for(var a=[],b,c=0;c<=u;c++){for(var d=b=0;d<n.sin.length;d++)n.sin[d]||(n.sin[d]=0),b+=Math.sin(c/u*d*Math.PI*2)*n.sin[d];for(d=0;d<n.cos.length;d++)n.cos[d]||(n.cos[d]=0),b+=Math.cos(c/u*d*Math.PI*2)*n.cos[d];a.push(b)}w.draw(a)};e.reset=function(){this.wave({sin:[],cos:[]});this.resolution(100);this.updateBackground()};return e};this.sixteenSegmentDisplay__static=function(d,e,a,b,c,h,k,m,g,l){function p(){E._.fillStyle=m;E._.fillRect(0,
0,E.$(b),E.$(c))}function n(){for(var a=0;a<I.length;a++){E._.beginPath();E._.moveTo(E.$(I[a][0].x),E.$(I[a][0].y));for(var b=1;b<I[a].length;b++)E._.lineTo(E.$(I[a][b].x),E.$(I[a][b].y));E._.closePath();E._.fillStyle=0==stamp[a]?l:g;E._.fill()}}b=void 0===b?20:b;c=void 0===c?30:c;k=void 0===k?5:k;m=void 0===m?"rgb(0,0,0)":m;g=void 0===g?"rgb(200,200,200)":g;l=void 0===l?"rgb(20,20,20)":l;var q=b/8,r=b/8,x=[{x:.5*r+q,y:.5*r+q},{x:1*r+q,y:0*r+q},{x:0*r+q,y:1*r+q},{x:1*r+q,y:1*r+q},{x:1.75*r+q,y:1*
r+q},{x:1*r+q,y:1.75*r+q}],u=[{x:b/2,y:.5*r+q},{x:b/2-.5*r,y:1*r+q},{x:b/2+.5*r,y:1*r+q},{x:b/2-.5*r,y:0*r+q},{x:b/2+.5*r,y:0*r+q}],w=[{x:b-.5*r-q,y:.5*r+q},{x:b-1*r-q,y:0*r+q},{x:b-0*r-q,y:1*r+q},{x:b-1*r-q,y:1*r+q},{x:b-1*r-q,y:1.75*r+q},{x:b-1.75*r-q,y:1*r+q}],t=[{x:0*r+q,y:.5*c-.5*r},{x:1*r+q,y:.5*c-.5*r},{x:.5*r+q,y:.5*c-0*r},{x:0*r+q,y:.5*c+.5*r},{x:1*r+q,y:.5*c+.5*r}],v=[{x:b/2,y:c/2},{x:b/2-.5*r,y:.5*r+c/2},{x:b/2-.25*r,y:1.25*r+c/2},{x:b/2-1*r,y:.5*r+c/2},{x:b/2+.5*r,y:.5*r+c/2},{x:b/2+.5*
r,y:1.75*r+c/2},{x:b/2+1*r,y:.5*r+c/2},{x:b/2-.5*r,y:.5*-r+c/2},{x:b/2-.25*r,y:1.25*-r+c/2},{x:b/2-1*r,y:.25*-r+c/2},{x:b/2+.5*r,y:.5*-r+c/2},{x:b/2+.5*r,y:1.75*-r+c/2},{x:b/2+1*r,y:.25*-r+c/2}],z=[{x:b-1*r-q,y:.5*c-.5*r},{x:b-0*r-q,y:.5*c-.5*r},{x:b-.5*r-q,y:.5*c-0*r},{x:b-1*r-q,y:.5*c+.5*r},{x:b-0*r-q,y:.5*c+.5*r}],B=[{x:.5*r+q,y:c-.5*r-q},{x:0*r+q,y:c-1*r-q},{x:1*r+q,y:c-0*r-q},{x:1*r+q,y:c-1*r-q},{x:1*r+q,y:c-1.75*r-q},{x:1.75*r+q,y:c-1*r-q}],A=[{x:b/2-.5*r,y:c-1*r-q},{x:b/2+.5*r,y:c-1*r-q},{x:b/
2,y:c-.5*r-q},{x:b/2-.5*r,y:c-0*r-q},{x:b/2+.5*r,y:c-0*r-q}];q=[{x:b-.5*r-q,y:c-.5*r-q},{x:b-0*r-q,y:c-1*r-q},{x:b-1*r-q,y:c-0*r-q},{x:b-1*r-q,y:c-1*r-q},{x:b-1*r-q,y:c-1.75*r-q},{x:b-1.75*r-q,y:c-1*r-q}];var I=[[x[1],x[0],x[3],u[1],u[0],u[3]],[u[4],u[0],u[2],w[3],w[0],w[1]],[x[0],x[2],t[0],t[2],t[1],x[3]],[x[4],x[3],x[5],v[9],v[7],v[8]],[u[0],u[1],v[7],v[0],v[10],u[2]],[w[4],w[3],w[5],v[11],v[10],v[12]],[w[0],w[2],z[1],z[2],z[0],w[3]],[t[4],t[2],t[1],v[7],v[0],v[1]],[z[3],z[2],z[0],v[10],v[0],v[4]],
[B[0],B[1],t[3],t[2],t[4],B[3]],[B[4],B[3],B[5],v[2],v[1],v[3]],[A[0],A[2],A[1],v[4],v[0],v[1]],[q[4],q[3],q[5],v[5],v[4],v[6]],[q[3],z[3],z[2],z[4],q[1],q[0]],[B[2],B[0],B[3],A[0],A[2],A[3]],[q[2],q[0],q[3],A[1],A[2],A[4]]];stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];d=f.builder("group",void 0===d?"sixteenSegmentDisplay__static":d,{x:e,y:a,angle:void 0===h?0:h});var E=f.builder("canvas","subcanvas",{width:b,height:c,resolution:k});d.append(E);d.set=function(a,b){stamp[a].state=b;n()};d.get=function(a){return segments[a].state};
d.clear=function(){for(var a=0;a<segments.length;a++)this.set(a,!1)};d.enterCharacter=function(a){switch(a){case "!":stamp=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":stamp=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":stamp=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":stamp=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":stamp=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':stamp=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":stamp=
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":stamp=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":stamp=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":stamp=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":stamp=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":stamp=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":stamp=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":stamp=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":stamp=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":stamp=[1,0,
0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":stamp=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":stamp=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":stamp=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":stamp=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":case 0:stamp=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":case 1:stamp=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":case 2:stamp=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":case 3:stamp=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;
case "4":case 4:stamp=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":case 5:stamp=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":case 6:stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":case 7:stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":case 8:stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":case 9:stamp=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":stamp=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":stamp=
[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":stamp=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":stamp=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":stamp=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":stamp=
[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":stamp=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":stamp=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":stamp=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":stamp=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":stamp=[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":stamp=
[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":stamp=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":stamp=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":stamp=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":stamp=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":stamp=[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":stamp=
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}p();n()};p();n();return d};this.readout_sixteenSegmentDisplay__static=function(d,e,a,b,c,h,k,m,g,l,p){b=void 0===b?100:b;c=void 0===c?30:c;h=void 0===h?5:h;m=void 0===m?5:m;g=void 0===g?"rgb(0,0,0)":g;l=void 0===l?"rgb(200,200,200)":l;p=void 0===p?"rgb(20,20,20)":p;var n="",q=null;d=f.builder("group",void 0===d?"readout_sixteenSegmentDisplay__static":d,{x:e,y:a,angle:void 0===k?0:k});var r=[];for(e=0;e<h;e++)a=
f.builder("sixteenSegmentDisplay__static",""+e,{x:b/h*e,width:b/h,height:c,resolution:m,style:{background:g,glow:l,dim:p}}),d.append(a),r.push(a);d.text=function(a){if(null==a)return n;n=a};d.print=function(a){clearInterval(q);switch(a){case "smart":n.length>r.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;q=setInterval(function(){for(var a=r.length-1;0<=a;a--)r[a].enterCharacter(n[b-(r.length-1-a)]);b++;b>r.length+n.length-1&&(b=0)},150);break;default:for(a=0;a<
r.length;a++)r[a].enterCharacter(n[a])}};return d};this.readout_sixteenSegmentDisplay=function(d,e,a,b,c,h,k,m,g,l){b=void 0===b?100:b;c=void 0===c?30:c;h=void 0===h?5:h;m=void 0===m?"rgb(0,0,0)":m;g=void 0===g?"rgb(200,200,200)":g;l=void 0===l?"rgb(20,20,20)":l;var p="",n=null;d=f.builder("group",void 0===d?"readout_sixteenSegmentDisplay":d,{x:e,y:a,angle:void 0===k?0:k});var q=[];for(e=0;e<h;e++)a=f.builder("sixteenSegmentDisplay",""+e,{x:b/h*e,width:b/h,height:c,style:{background:m,glow:g,dim:l}}),
d.append(a),q.push(a);d.text=function(a){if(null==a)return p;p=a};d.print=function(a){clearInterval(n);switch(a){case "smart":p.length>q.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;n=setInterval(function(){for(var a=q.length-1;0<=a;a--)q[a].enterCharacter(p[b-(q.length-1-a)]);b++;b>q.length+p.length-1&&(b=0)},150);break;default:for(a=0;a<q.length;a++)q[a].enterCharacter(p[a])}};return d};this.grapher_audioScope__static=function(d,e,a,b,c,h,k,m,g,l,p,y,q,r){d=
void 0===d?"grapher_audioScope__static":d;b=void 0===b?120:b;c=void 0===c?60:c;h=void 0===h?0:h;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:k;m=void 0===m?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:m;g=void 0===g?"rgba(0,100,0,1)":g;l=void 0===l?.25:l;p=void 0===p?"rgba(0,150,0,1)":p;y=void 0===y?.1:y;q=void 0===q?"Helvetica":q;r=void 0===r?"rgba(50,50,50,1)":r;var n=workspace.library.audio.context.createAnalyser(),u=null,w=10,t=null,v=256;n.fftSize=v;u=new Uint8Array(n.fftSize);
new Uint8Array(n.fftSize);e=f.builder("group",d,{x:e,y:a,angle:h});var z=f.builder("grapher__static",d,{x:0,y:0,width:b,height:c,foregroundStyles:[k],foregroundTextStyles:[m],backgroundStyle_stroke:g,backgroundStyle_lineWidth:l,backgroundTextStyle_fill:p,backgroundTextStyle_size:y,backgroundTextStyle_font:q,backingStyle:r});e.append(z);e.start=function(){null==t&&(t=setInterval(function(){var a=[];n.getByteTimeDomainData(u);for(var b=0;b<u.length;b++)a.push(u[b]/128-1);z.draw(a)},1E3/w))};e.stop=
function(){clearInterval(t);t=null};e.getNode=function(){return n};e.resolution=function(a){a=void 0===a?null:a;if(null==a)return v;v=a;this.stop();this.start()};e.refreshRate=function(a){if(null==a)return w;w=a;this.stop();this.start()};z.viewbox({l:-1.1,h:1.1});z.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});z.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});z.drawBackground();return e};this.level=function(d,e,a,b,c,h,k,m){c=void 0===c?20:c;h=void 0===
h?60:h;k=void 0===k?"rgb(10,10,10)":k;m=void 0===m?["rgb(250,250,250)","rgb(200,200,200)"]:m;var g=[];d=f.builder("group",void 0===d?"level":d,{x:e,y:a,angle:void 0===b?0:b});k=f.builder("rectangle","backing",{width:c,height:h,style:{fill:k}});d.append(k);k=f.builder("group","levels");d.append(k);var l=[];for(e=0;e<m.length;e++)g.push(0),l.push(f.builder("rectangle","movingRect_"+e,{y:h,width:c,height:0,style:{fill:m[e]}})),k.prepend(l[e]);d.layer=function(a,b){b=void 0===b?0:b;if(void 0==b)return g;
if(null==a)return g[b];a=1<a?1:a;a=0>a?0:a;g[b]=a;l[b].parameter.height(h*a);l[b].parameter.y(h-h*a)};return d}};this.control=new function(){this.rastorgrid=function(d,e,a,b,c,h,k,m,g,l,p,y,q){b=void 0===b?80:b;c=void 0===c?80:c;k=void 0===k?5:k;m=void 0===m?5:m;g=void 0===g?"rgba(200,200,200,1)":g;l=void 0===l?"rgba(150,150,150,1)":l;p=void 0===p?"rgba(220,220,220,1)":p;y=void 0===y?"rgba(220,220,220,1)":y;q=void 0===q?function(){}:q;var n=f.builder("group",void 0===d?"rastorgrid":d,{x:e,y:a,angle:void 0===
h?0:h});for(a=0;a<m;a++)for(e=0;e<k;e++)d=f.builder("checkbox_rect",a+"_"+e,{x:b/k*e,y:c/m*a,width:b/k,height:c/m,style:{check:l,backing:g,checkGlow:y,backingGlow:p},onchange:function(){if(n.onchange)n.onchange(n.get())}}),n.append(d);n.box=function(a,b){return n.getChildByName(b+"_"+a)};n.get=function(){for(var a=[],b=0;b<m;b++){for(var c=[],d=0;d<k;d++)c.push(this.box(d,b).get());a.push(c)}return a};n.set=function(a,b){for(b=0;b<m;b++)for(var c=0;c<k;c++)n.box(c,b).set(a[b][c],!1)};n.clear=function(){for(var a=
0;a<m;a++)for(var b=0;b<k;b++)n.box(b,a).set(!1,!1)};n.light=function(a,b,c){n.box(a,b).light(c)};n.onchange=q;return n};this.needleOverlay=function(d,e,a,b,c,h,k,g,n,l,p,y,q){function m(a){return a.x*Math.cos(z.__calculationAngle)-a.y*Math.sin(z.__calculationAngle)}function x(a){var d=workspace.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=d.x-B.extremities.points[0].x;d=d.y-B.extremities.points[0].y;return{x:(a*Math.cos(z.__calculationAngle)-d*Math.sin(z.__calculationAngle))/b,y:(d*Math.cos(z.__calculationAngle)-
a*Math.sin(z.__calculationAngle))/c}}function u(a,c){var d="lead"==a?I:A;void 0==c||0>c||1<c?(d.remove(E[a]),delete v[a]):(d.contains(E[a])||d.append(E[a]),E[a].parameter.x(c*b-b*k*c),v[a]=c)}function w(a,b){b=void 0===b?!0:b;if(g){if(void 0==a)return v.lead;1<a||0>a?u("lead"):u("lead",a);if(b&&void 0!=z.onchange)z.onchange("lead",a)}}function t(a,c,d){d=void 0===d?!0:d;if(n){if(void 0==a||void 0==c)return{A:v.selection_A,B:v.selection_B};1<a||0>a||1<c||0>c?(u("selection_A"),u("selection_B")):(u("selection_A",
a),u("selection_B",c));if(void 0==v.selection_A||void 0==v.selection_B||v.selection_A==v.selection_B)A.remove(E.selection_area),z.selectionAreaToggle&&z.selectionAreaToggle(!1),delete v.selection_area;else{A.contains(E.selection_area)||(A.append(E.selection_area),z.selectionAreaToggle&&z.selectionAreaToggle(!0));if(v.selection_A<v.selection_B)var e=v.selection_A,f=v.selection_B;else e=v.selection_B,f=v.selection_A;e=e-k*e+k;f=f-k*f-e;0>f&&(f=0);E.selection_area.parameter.x(b*e);E.selection_area.parameter.width(b*
f)}if(d&&void 0!=z.onchange)z.onchange("selection_A",a);if(d&&void 0!=z.onchange)z.onchange("selection_B",c)}}b=void 0===b?120:b;c=void 0===c?60:c;h=void 0===h?0:h;k=void 0===k?1/512:k;g=void 0===g?!0:g;n=void 0===n?!0:n;l=void 0===l?["rgba(240, 240, 240, 1)","rgba(255, 231, 114, 1)"]:l;p=void 0===p?function(a,b){}:p;y=void 0===y?function(a,b){}:y;q=void 0===q?function(a){}:q;var v={},z=f.builder("group",void 0===d?"needleOverlay":d,{x:e,y:a,angle:h}),B=f.builder("rectangle","backing",{width:b,height:c,
style:{fill:"rgba(0,0,0,0)"}});z.append(B);d=f.builder("group","controlObjectsGroup");z.append(d);var A=f.builder("group","back");d.append(A);var I=f.builder("group","front");d.append(I);d=b*k+.005*b;var E={};E.lead=f.builder("group","lead");E.lead.append(f.builder("rectangle","handle",{width:k*b,height:c,style:{fill:l[0]}}));E.lead.append(f.builder("rectangle","invisibleHandle",{x:(b*k-d)/2,width:d,height:c,style:{fill:"rgba(255,0,0,0)"}}));E.selection_A=f.builder("group","selection_A");E.selection_A.append(f.builder("rectangle",
"handle",{width:k*b,height:c,style:{fill:l[1]}}));E.selection_A.append(f.builder("rectangle","invisibleHandle",{x:(b*k-d)/2,width:d,height:c,style:{fill:"rgba(255,0,0,0)"}}));E.selection_B=f.builder("group","selection_B");E.selection_B.append(f.builder("rectangle","handle",{width:k*b,height:c,style:{fill:l[1]}}));E.selection_B.append(f.builder("rectangle","invisibleHandle",{x:(b*k-d)/2,width:d,height:c,style:{fill:"rgba(255,0,0,0)"}}));E.selection_area=f.builder("rectangle","selection_area",{height:c,
style:{fill:workspace.library.misc.blendColours(l[1],"rgba(0,0,0,0)",.5)}});E.markGroup=f.builder("group","markGroup");A.append(E.markGroup);z.__calculationAngle=h;var M=!1,K=!1,X=!1,N=!1;B.onmousedown=function(a,b,c){if(workspace.system.keyboard.pressedKeys.shift){var d=x(c).x;workspace.system.mouse.mouseInteractionHandler(function(a){z.area(d,x(a).x)})}else z.select(x(c).x)};E.lead.getChildByName("invisibleHandle").onmouseenter=function(a,b,c){workspace.core.viewport.cursor("col-resize")};E.lead.getChildByName("invisibleHandle").onmouseleave=
function(a,b,c){workspace.core.viewport.cursor("default")};E.lead.getChildByName("invisibleHandle").onmousedown=function(a,c,d){M=!0;var e=v.lead,f=m(d),h=(b-b*k)/2;workspace.system.mouse.mouseInteractionHandler(function(a){a=f-m(a);var b=workspace.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;w(1<a?1:a)},function(a){a=f-m(a);var b=workspace.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;M=!1;w(a);if(void 0!=z.onrelease)z.onrelease("lead",a)})};E.selection_A.getChildByName("invisibleHandle").onmouseenter=
function(a,b,c){workspace.core.viewport.cursor("col-resize")};E.selection_A.getChildByName("invisibleHandle").onmouseleave=function(a,b,c){workspace.core.viewport.cursor("default")};E.selection_A.getChildByName("invisibleHandle").onmousedown=function(a,c,d){X=!0;var e=v.selection_A,f=m(d),h=(b-b*k)/2;workspace.system.mouse.mouseInteractionHandler(function(a){a=f-m(a);var b=workspace.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;t(1<a?1:a,v.selection_B)},function(a){a=f-m(a);var b=workspace.core.viewport.scale();
a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;X=!1;t(a,v.selection_B);if(void 0!=z.onrelease)z.onrelease("selection_A",a)})};E.selection_B.getChildByName("invisibleHandle").onmouseenter=function(a,b,c){workspace.core.viewport.cursor("col-resize")};E.selection_B.getChildByName("invisibleHandle").onmouseleave=function(a,b,c){workspace.core.viewport.cursor("default")};E.selection_B.getChildByName("invisibleHandle").onmousedown=function(a,c,d){N=!0;var e=v.selection_B,f=m(d),h=(b-b*k)/2;workspace.system.mouse.mouseInteractionHandler(function(a){a=
f-m(a);var b=workspace.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;t(v.selection_A,1<a?1:a)},function(a){a=f-m(a);var b=workspace.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;N=!1;t(v.selection_A,a);if(void 0!=z.onrelease)z.onrelease("selection_B",a)})};E.selection_area.onmouseenter=function(a,b,c){workspace.core.viewport.cursor("grab")};E.selection_area.onmouseleave=function(a,b,c){workspace.core.viewport.cursor("default")};E.selection_area.onmousedown=function(a,c,d){workspace.core.viewport.cursor("grabbing");
K=!0;var e=v.selection_B-v.selection_A,f=v.selection_A,h=v.selection_B,g=m(d),l=(b-b*k)/2;workspace.system.mouse.mouseInteractionHandler(function(a){var b=g-m(a),c=workspace.core.viewport.scale();a=f-b/(c*l);b=h-b/(c*l);1<a&&(a=1,b=1+e);1<b&&(b=1,a=1-e);0>a&&(a=0,b=e);0>b&&(b=0,a=-e);t(a,b)},function(a){workspace.core.viewport.cursor("grab");var b=g-m(a),c=workspace.core.viewport.scale();a=f-b/(c*l);b=h-b/(c*l);1<a&&(a=1,b=1+e);1<b&&(b=1,a=1-e);0>a&&(a=0,b=e);0>b&&(b=0,a=-e);K=!1;t(a,b);if(void 0!=
z.onrelease)z.onrelease("selection_A",a);if(void 0!=z.onrelease)z.onrelease("selection_B",b)})};E.selection_A.ondblclick=function(a,b,c,d){t(-1,-1);workspace.core.viewport.cursor("default")};E.selection_B.ondblclick=E.selection_A.ondblclick;E.selection_area.ondblclick=E.selection_A.ondblclick;z.mark=function(a){var d=E.markGroup.getChildByName(""+a);void 0==d?(E.markGroup.append(f.builder("rectangle",""+a,{x:a*b,width:k*b,height:c,style:{fill:l[0]}})),a=!0):(E.markGroup.remove(d),a=!1);return a};
z.removeAllMarks=function(){E.markGroup.clear()};z.select=function(a,b){b=void 0===b?!0:b;if(void 0==a)return w();M||w(a,b)};z.area=function(a,b,c){c=void 0===c?!0:c;if(void 0==a&&void 0==b)return t();K||void 0!=a&&X||void 0!=b&&N||t(a,b,c)};z.onchange=p;z.onrelease=y;z.selectionAreaToggle=q;return z};this.button_rect=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r,x,u,w,t,v,z,B,A,I,E,M,K,X,N,da,T,Y,Z,aa,ha,ia,D,C,V,R,H,F,ba,L,O,P,S,Q,U,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,
Ha,Ia,Ja,Ka,La,Ma){function m(){if(y){var a=[{fill:E,stroke:M,lineWidth:K},{fill:X,stroke:N,lineWidth:da},{fill:T,stroke:Y,lineWidth:Z},{fill:aa,stroke:ha,lineWidth:ia},{fill:D,stroke:C,lineWidth:V},{fill:R,stroke:H,lineWidth:F},{fill:ba,stroke:L,lineWidth:O},{fill:P,stroke:S,lineWidth:Q},{fill:U,stroke:ja,lineWidth:ka},{fill:la,stroke:ma,lineWidth:na},{fill:oa,stroke:pa,lineWidth:qa},{fill:ra,stroke:sa,lineWidth:ta},{fill:ua,stroke:va,lineWidth:wa},{fill:xa,stroke:ya,lineWidth:za},{fill:Aa,stroke:Ba,
lineWidth:Ca},{fill:Da,stroke:Ea,lineWidth:Fa}];!q&&G.state.hovering&&(G.state.hovering=!1);!r&&G.state.selected&&(G.state.selected=!1);var b=8*G.state.hovering+4*G.state.glowing+2*G.state.selected+1*(x&&G.state.pressed);ea.style.fill=a[b].fill;ea.style.stroke=a[b].stroke;ea.style.lineWidth=a[b].lineWidth}else ea.style.fill=B,ea.style.stroke=A,ea.style.lineWidth=I}b=void 0===b?30:b;c=void 0===c?20:c;k=void 0===k?"":k;g=void 0===g?"":g;n=void 0===n?"":n;l=void 0===l?.5:l;p=void 0===p?.05:p;y=void 0===
y?!0:y;q=void 0===q?!0:q;r=void 0===r?!1:r;x=void 0===x?!0:x;u=void 0===u?"5pt Arial":u;w=void 0===w?"alphabetic":w;t=void 0===t?"rgba(0,0,0,1)":t;v=void 0===v?"rgba(0,0,0,0)":v;z=void 0===z?1:z;B=void 0===B?"rgba(180,180,180,1)":B;A=void 0===A?"rgba(0,0,0,0)":A;I=void 0===I?0:I;E=void 0===E?"rgba(200,200,200,1)":E;M=void 0===M?"rgba(0,0,0,0)":M;K=void 0===K?0:K;X=void 0===X?"rgba(230,230,230,1)":X;N=void 0===N?"rgba(0,0,0,0)":N;da=void 0===da?0:da;T=void 0===T?"rgba(200,200,200,1)":T;Y=void 0===
Y?"rgba(120,120,120,1)":Y;Z=void 0===Z?.75:Z;aa=void 0===aa?"rgba(230,230,230,1)":aa;ha=void 0===ha?"rgba(120,120,120,1)":ha;ia=void 0===ia?.75:ia;D=void 0===D?"rgba(220,220,220,1)":D;C=void 0===C?"rgba(0,0,0,0)":C;V=void 0===V?0:V;R=void 0===R?"rgba(250,250,250,1)":R;H=void 0===H?"rgba(0,0,0,0)":H;F=void 0===F?0:F;ba=void 0===ba?"rgba(220,220,220,1)":ba;L=void 0===L?"rgba(120,120,120,1)":L;O=void 0===O?.75:O;P=void 0===P?"rgba(250,250,250,1)":P;S=void 0===S?"rgba(120,120,120,1)":S;Q=void 0===Q?.75:
Q;U=void 0===U?"rgba(220,220,220,1)":U;ja=void 0===ja?"rgba(0,0,0,0)":ja;ka=void 0===ka?0:ka;la=void 0===la?"rgba(240,240,240,1)":la;ma=void 0===ma?"rgba(0,0,0,0)":ma;na=void 0===na?0:na;oa=void 0===oa?"rgba(220,220,220,1)":oa;pa=void 0===pa?"rgba(120,120,120,1)":pa;qa=void 0===qa?.75:qa;ra=void 0===ra?"rgba(240,240,240,1)":ra;sa=void 0===sa?"rgba(120,120,120,1)":sa;ta=void 0===ta?.75:ta;ua=void 0===ua?"rgba(240,240,240,1)":ua;va=void 0===va?"rgba(0,0,0,0)":va;wa=void 0===wa?0:wa;xa=void 0===xa?"rgba(250,250,250,1)":
xa;ya=void 0===ya?"rgba(0,0,0,0)":ya;za=void 0===za?0:za;Aa=void 0===Aa?"rgba(240,240,240,1)":Aa;Ba=void 0===Ba?"rgba(120,120,120,1)":Ba;Ca=void 0===Ca?.75:Ca;Da=void 0===Da?"rgba(250,250,250,1)":Da;Ea=void 0===Ea?"rgba(120,120,120,1)":Ea;Fa=void 0===Fa?.75:Fa;Ga=void 0===Ga?function(a){}:Ga;Ha=void 0===Ha?function(a){}:Ha;Ia=void 0===Ia?function(a){}:Ia;Ja=void 0===Ja?function(a){}:Ja;Ka=void 0===Ka?function(a){}:Ka;La=void 0===La?function(a){}:La;Ma=void 0===Ma?function(a){}:Ma;var G=f.builder("group",
void 0===d?"button_rect":d,{x:e,y:a,angle:void 0===h?0:h}),ea=f.builder("rectangle","backing",{width:b,height:c,style:{fill:B,stroke:A,lineWidth:I}});G.append(ea);k=f.builder("text","centre",{x:b/2,y:c*l,text:k,style:{font:u,testBaseline:w,fill:t,stroke:v,lineWidth:z,textAlign:"center",textBaseline:"middle"}});G.append(k);g=f.builder("text","left",{x:b*p,y:c*l,text:g,style:{font:u,testBaseline:w,fill:t,stroke:v,lineWidth:z,textAlign:"left",textBaseline:"middle"}});G.append(g);n=f.builder("text","right",
{x:b-b*p,y:c*l,text:n,style:{font:u,testBaseline:w,fill:t,stroke:v,lineWidth:z,textAlign:"right",textBaseline:"middle"}});G.append(n);var fa=f.builder("rectangle","cover",{width:b,height:c,style:{fill:"rgba(0,0,0,0)"}});G.append(fa);G.state={hovering:!1,glowing:!1,selected:!1,pressed:!1};m();G.press=function(a){if(y){if(x){if(this.state.pressed)return;this.state.pressed=!0;if(this.onpress)this.onpress(this,a)}this.select(!this.select(),a);m()}};G.release=function(a){if(y&&x&&this.state.pressed&&(this.state.pressed=
!1,m(),this.onrelease))this.onrelease(this,a)};G.active=function(a){if(void 0==a)return y;y=a;m()};G.glow=function(a){if(void 0==a)return this.state.glowing;this.state.glowing=a;m()};G.select=function(a,b,c){c=void 0===c?!0:c;if(y){if(void 0==a)return this.state.selected;if(r&&this.state.selected!=a&&(this.state.selected=a,m(),c))if(this.state.selected)this.onselect(this,b);else this.ondeselect(this,b)}};G.forceMouseLeave=function(){G.state.hovering=!1;G.release("forced");m();if(G.onleave)G.onleave("forced")};
fa.onmouseenter=function(a,b,c){G.state.hovering=!0;m();if(G.onenter)G.onenter(c);if(1==c.buttons)fa.onmousedown(c)};fa.onmouseleave=function(a,b,c){G.state.hovering=!1;G.release(c);m();if(G.onleave)G.onleave(c)};fa.onmouseup=function(a,b,c){G.release(c)};fa.onmousedown=function(a,b,c){G.press(c)};fa.ondblclick=function(a,b,c){if(y&&G.ondblpress)G.ondblpress(c)};G.onenter=Ga;G.onleave=Ha;G.onpress=Ia;G.ondblpress=Ja;G.onrelease=Ka;G.onselect=La;G.ondeselect=Ma;return G};this.checkbox_rect=function(d,
e,a,b,c,h,k,g,n,l,p){function m(){u.glowing?(r.style.fill=l,x.style.fill=u.checked?n:"rgba(0,0,0,0)"):(r.style.fill=g,x.style.fill=u.checked?k:"rgba(0,0,0,0)")}b=void 0===b?20:b;c=void 0===c?20:c;k=void 0===k?"rgba(150,150,150,1)":k;g=void 0===g?"rgba(200,200,200,1)":g;n=void 0===n?"rgba(220,220,220,1)":n;l=void 0===l?"rgba(220,220,220,1)":l;p=void 0===p?function(){}:p;var q=f.builder("group",void 0===d?"checkbox_rect":d,{x:e,y:a,angle:void 0===h?0:h}),r=f.builder("rectangle","backing",{width:b,height:c,
style:{fill:g}});q.append(r);var x=f.builder("rectangle","checkrect",{x:.1*b,y:.1*c,width:.8*b,height:.8*c,style:{fill:"rgba(0,0,0,0)"}});q.append(x);d=f.builder("rectangle","cover",{width:b,height:c,style:{fill:"rgba(0,0,0,0)"}});q.append(d);var u={checked:!1,glowing:!1};q.get=function(){return u.checked};q.set=function(a,b){b=void 0===b?!0:b;u.checked=a;m();if(b&&this.onchange)this.onchange(a)};q.light=function(a){if(void 0==a)return a.glowing;a.glowing=a;m()};d.onclick=function(a){q.set(!q.get())};
d.onmousedown=function(){};q.onchange=p;return q};this.slide=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r,x){function m(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=t.onchange)t.onchange(a);g=a;B.y=a*c*(1-k);A.y=a*c*(1-k);B.computeExtremities();A.computeExtremities()}function w(a){return a.y*Math.cos(t.__calculationAngle)-a.x*Math.sin(t.__calculationAngle)}b=void 0===b?10:b;c=void 0===c?95:c;h=void 0===h?0:h;k=void 0===k?.1:k;g=void 0===g?0:g;n=void 0===n?-1:n;l=void 0===l?"rgba(200,200,200,1)":l;
p=void 0===p?"rgba(150,150,150,1)":p;y=void 0===y?"rgba(50,50,50,1)":y;q=void 0===q?"rgba(255,0,0,0)":q;r=void 0===r?function(){}:r;x=void 0===x?function(){}:x;var t=f.builder("group",void 0===d?"slide":d,{x:e,y:a,angle:h}),v=f.builder("group","backingAndSlotGroup");t.append(v);d=f.builder("rectangle","backing",{width:b,height:c,style:{fill:p}});v.append(d);y=f.builder("rectangle","slot",{x:.45*b,y:k/2*c,width:.1*b,height:c*(1-k),style:{fill:y}});v.append(y);var z=f.builder("rectangle","backingAndSlotCover",
{width:b,height:c,style:{fill:"rgba(0,0,0,0)"}});v.append(z);var B=f.builder("rectangle","handle",{width:b,height:c*k,style:{fill:l}});t.append(B);l=c*k+.01*c;var A=f.builder("rectangle","invisibleHandle",{y:(c*k-l)/2,width:b,height:l+k,style:{fill:q}});t.append(A);t.__calculationAngle=h;var I=!1;t.set=function(a,b){I||m(a,b)};t.get=function(){return g};t.ondblclick=function(){if(!(0>n||I)&&(m(n),void 0!=t.onrelease))t.onrelease(g)};t.onwheel=function(){if(!I){var a=event.deltaY/100,b=workspace.core.viewport.scale();
m(g+a/(10*b));if(void 0!=t.onrelease)t.onrelease(g)}};v.onmousedown=function(a,b,c){};v.onclick=function(a,b,c){if(!I&&(c=v.getOffset(),a=workspace.library.math.cartesianAngleAdjust(a-(v.x+c.x),b-(v.y+c.y),0-(v.angle+c.a)).y/z.height,a+=.5*k*(2*a-1),m(a),void 0!=t.onrelease))t.onrelease(a)};A.onmousedown=function(a,b,d){I=!0;var e=g,f=w(d),h=c-c*k;workspace.system.mouse.mouseInteractionHandler(function(a){a=f-w(a);var b=workspace.core.viewport.scale();m(e-a/(b*h)*window.devicePixelRatio)},function(a){a=
f-w(a);var b=workspace.core.viewport.scale();t.onrelease(e-a/(b*h)*window.devicePixelRatio);I=!1})};m(g);t.onchange=r;t.onrelease=x;return t};this.dial_continuous=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r){function m(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=u.onchange)u.onchange(a);h=a;w.parameter.angle(g+n*h)}b=void 0===b?15:b;h=void 0===h?0:h;k=void 0===k?-1:k;g=void 0===g?3*Math.PI/4:g;n=void 0===n?1.5*Math.PI:n;l=void 0===l?"rgba(200,200,200,1)":l;p=void 0===p?"rgba(50,50,50,1)":p;y=void 0===
y?"rgba(250,100,100,1)":y;q=void 0===q?function(){}:q;r=void 0===r?function(){}:r;var u=f.builder("group",void 0===d?"dial_continuous":d,{x:e,y:a,angle:void 0===c?0:c});d=f.builder("circle","slot",{r:1.1*b,style:{fill:p}});u.append(d);l=f.builder("circle","handle",{r:b,style:{fill:l}});u.append(l);var w=f.builder("group","needleGroup",{ignored:!0});u.append(w);d=b/5;e=b;y=f.builder("rectangle","needle",{x:e/3,y:-d/2,height:d,width:e,style:{fill:y}});w.append(y);var t=!1;u.set=function(a,b){t||m(a,
b)};u.get=function(){return h};var v=4*b;l.ondblclick=function(){if(!(0>k||t)&&(m(k),void 0!=u.onrelease))u.onrelease(h)};l.onwheel=function(a,b,c){if(!t&&(a=c.deltaY/100,b=workspace.core.viewport.scale(),m(h-a/(10*b)),void 0!=u.onrelease))u.onrelease(h)};l.onmousedown=function(a,b,c){var d=h,e=c.y;t=!0;workspace.system.mouse.mouseInteractionHandler(function(a){a=a.y-e;var b=workspace.core.viewport.scale();m(d-a/(b*v)*window.devicePixelRatio,!0)},function(a){t=!1;if(void 0!=u.onrelease)u.onrelease(h)})};
u.onchange=q;u.onrelease=r;m(h);return u};this.slidePanel=function(d,e,a,b,c,h,k,g,n,l,p,y,q){b=void 0===b?80:b;c=void 0===c?95:c;h=void 0===h?0:h;g=void 0===g?8:g;n=void 0===n?0:n;l=void 0===l?.5:l;p=void 0===p?"rgba(200,200,200,1)":p;y=void 0===y?"rgba(150,150,150,1)":y;q=void 0===q?"rgba(50,50,50,1)":q;var m=f.builder("group",void 0===d?"slidePanel":d,{x:e,y:a,angle:h});for(d=0;d<g;d++)e=f.builder("slide","slide_"+d,{x:b/g*d,y:0,width:b/g,height:c,value:n,resetValue:l,style:{handle:p,backing:y,
slot:q},onchange:function(a){m.onchange(this.id,a)},onrelease:function(a){m.onrelease(this.id,a)}}),e.__calculationAngle=h,m.append(e);return m};this.sequencer=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r,x,u,w,t,v,z,B,A,I,E,M,K){function m(a){var d=workspace.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=d.x-ba.extremities.points[0].x;d=d.y-ba.extremities.points[0].y;return{x:(a*Math.cos(F.__calculationAngle)-d*Math.sin(F.__calculationAngle))/b,y:(d*Math.cos(F.__calculationAngle)-a*Math.sin(F.__calculationAngle))/
c}}function N(a){return{x:D.viewArea.topLeft.x+a.x*n,y:D.viewArea.topLeft.y+a.y*l}}function da(a){return{x:n*(a.x-D.viewposition.x)+D.viewposition.x,y:l*(a.y-D.viewposition.y)+D.viewposition.y}}function T(a){a.y=Math.floor(a.y*g);a.y>=g&&(a.y=g-1);a.x=C.snapping?Math.round(a.x*k/C.step)*C.step:a.x*k;0>a.x&&(a.x=0);return{line:a.y,position:a.x}}function Y(a,d,e){if(void 0==a&&void 0==d)return D.viewposition;if(void 0==a||isNaN(a))a=D.viewposition.x;if(void 0==d||isNaN(d))d=D.viewposition.y;a=0>a?0:
a;a=1<a?1:a;d=0>d?0:d;d=1<d?1:d;D.viewposition.x=a;D.viewposition.y=d;L.parameter.x(-D.viewposition.x*(D.totalSize.width-b));L.parameter.y(-D.viewposition.y*(D.totalSize.height-c));D.viewArea={topLeft:{x:a-n*a,y:d-l*d},bottomRight:{x:a+n*(1-a),y:d+l*(1-d)}}}function Z(a,d){if(void 0==a&&void 0==d)return{x:n,y:l};if(void 0!=a&&a!=n&&void 0!=d&&d!=l){a=.01>a?.01:a;d=.01>d?.01:d;n=1<a?1:a;l=1<d?1:d;D.totalSize.width=b/n;D.totalSize.height=c/l;S.parameter.width(D.totalSize.width);S.parameter.height(D.totalSize.width);
U.parameter.width(D.totalSize.width);U.parameter.height(D.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.x(b/(k*n)*a),P.children[a].parameter.width(b/(k*n)),P.children[a].parameter.height(D.totalSize.height);for(a=0;a<g;a++)O.children[a].parameter.y(c/(g*l)*a),O.children[a].parameter.height(c/(g*l)),O.children[a].parameter.width(D.totalSize.width);for(a=0;a<Q.children.length;a++)Q.children[a].unit(b/(k*n),c/(g*l));H.present&&(L.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(D.totalSize.height),
L.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(D.totalSize.height),L.getElementsWithName("playhead")[0].parameter.x(D.totalSize.width/k*H.position))}else if(void 0!=a&&a!=n){a=.01>a?.01:a;n=1<a?1:a;D.totalSize.width=b/n;S.parameter.width(D.totalSize.width);U.parameter.width(D.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.x(b/(k*n)*a),P.children[a].parameter.width(b/(k*n));for(a=0;a<g;a++)O.children[a].parameter.width(D.totalSize.width);for(a=
0;a<Q.children.length;a++)Q.children[a].unit(b/(k*n),void 0);H.present&&L.getElementsWithName("playhead")[0].parameter.x(D.totalSize.width/k*H.position)}else if(void 0!=d&&d!=l){d=.01>d?.01:d;l=1<d?1:d;D.totalSize.height=c/l;S.parameter.height(D.totalSize.width);U.parameter.height(D.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.height(D.totalSize.height);for(a=0;a<g;a++)O.children[a].parameter.y(c/(g*l)*a),O.children[a].parameter.height(c/(g*l));for(a=0;a<Q.children.length;a++)Q.children[a].unit(void 0,
c/(g*l));H.present&&(L.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(D.totalSize.height),L.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(D.totalSize.height))}}function aa(a,d,e,f){f=void 0===f?C.defaultStrength:f;a=C.signalRegistry.add({line:a,position:d,length:e,strength:f});d=C.signalRegistry.getSignal(a);var h=ia.sequencer.signalBlock(a,b/(k*n),c/(g*l),d.line,d.position,d.length,d.strength,!1,q,r,x,u);Q.append(h);
h.select=function(a){a=void 0===a?!1:a;-1!=C.selectedSignals.indexOf(this)?a||this.deselect():(this.selected(!0),C.selectedSignals.push(this),this.glow(!0))};h.deselect=function(){C.selectedSignals.splice(C.selectedSignals.indexOf(this),1);this.selected(!1);this.glow(!1)};h.delete=function(){this.deselect();C.signalRegistry.remove(parseInt(this.name));this.parent.remove(this)};h.ondblclick=function(a,b,c){if(workspace.system.keyboard.pressedKeys.control||workspace.system.keyboard.pressedKeys.command)for(a=
0;a<C.selectedSignals.length;a++)C.selectedSignals[a].strength(C.defaultStrength),C.signalRegistry.update(parseInt(C.selectedSignals[a].name),{strength:C.defaultStrength})};h.body.onmousedown=function(a,b,d){if(workspace.system.keyboard.pressedKeys.Space)S.onmousedown(a,b,d);else{if(!workspace.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<C.selectedSignals.length;)C.selectedSignals[0].deselect();h.select(!0);var e=[];for(a=0;a<C.selectedSignals.length;a++)e.push({name:parseInt(C.selectedSignals[a].name),
block:C.selectedSignals[a],starting:C.signalRegistry.getSignal(parseInt(C.selectedSignals[a].name))});if(workspace.system.keyboard.pressedKeys.control||workspace.system.keyboard.pressedKeys.command){var f=e.map(function(a){return a.block.strength()}),k=d.offsetY;workspace.system.mouse.mouseInteractionHandler(function(a){workspace.system.keyboard.pressedKeys.ControlLeft||workspace.system.keyboard.pressedKeys.ControlRight||workspace.system.keyboard.pressedKeys.command||workspace.system.mouse.forceMouseUp();
a=(k-a.offsetY)/(workspace.core.viewport.scale()*c*4);for(var b=0;b<e.length;b++)e[b].block.strength(f[b]+a),C.signalRegistry.update(e[b].name,{strength:f[b]+a})})}else{var g=!1,l=T(N(m(d)));workspace.system.mouse.mouseInteractionHandler(function(a){if(!g&&(g=!0,workspace.system.keyboard.pressedKeys.alt))for(var b=0;b<C.selectedSignals.length;b++){var c=C.signalRegistry.getSignal(parseInt(C.selectedSignals[b].name));aa(c.line,c.position,c.length,c.strength)}b=T(N(m(a)));a=b.line-l.line;b=b.position-
l.position;for(c=0;c<e.length;c++){C.signalRegistry.update(e[c].name,{line:e[c].starting.line+a,position:e[c].starting.position+b});var d=C.signalRegistry.getSignal(e[c].name);e[c].block.line(d.line);e[c].block.position(d.position)}})}}};h.body.onmousemove=function(a,b,c){a=workspace.system.keyboard.pressedKeys;b="default";a.alt?b="copy":a.Space&&(b="grab");workspace.core.viewport.cursor(b)};h.body.onkeydown=function(a,b,c){workspace.system.keyboard.pressedKeys.alt&&workspace.core.viewport.cursor("copy")};
h.body.onkeyup=function(a,b,c){workspace.system.keyboard.pressedKeys.alt||workspace.core.viewport.cursor("default")};h.leftHandle.onmousedown=function(a,b,c){if(workspace.system.keyboard.pressedKeys.Space)S.onmousedown(a,b,c);else if(workspace.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,c);else{if(!workspace.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<C.selectedSignals.length;)C.selectedSignals[0].deselect();h.select(!0);var d=[];for(a=0;a<C.selectedSignals.length;a++)d.push({name:parseInt(C.selectedSignals[a].name),
block:C.selectedSignals[a],starting:C.signalRegistry.getSignal(parseInt(C.selectedSignals[a].name))});var e=T(N(m(c)));workspace.system.mouse.mouseInteractionHandler(function(a){a=T(N(m(a)));a=e.position-a.position;for(var b=0;b<d.length;b++)if(!(0>d[b].starting.position-a)){C.signalRegistry.update(d[b].name,{length:d[b].starting.length+a,position:d[b].starting.position-a});var c=C.signalRegistry.getSignal(d[b].name);d[b].block.position(c.position);d[b].block.length(c.length)}})}};h.leftHandle.onmousemove=
function(a,b,c){a=workspace.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");workspace.core.viewport.cursor(b)};h.leftHandle.onmouseleave=function(a,b,c){workspace.core.viewport.cursor("default")};h.rightHandle.onmousedown=function(a,b,c,d){d=void 0===d?!1:d;if(workspace.system.keyboard.pressedKeys.Space)S.onmousedown(a,b,c);else if(!d&&workspace.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,c);else{if(!workspace.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<
C.selectedSignals.length;)C.selectedSignals[0].deselect();h.select(!0);var e=[];for(a=0;a<C.selectedSignals.length;a++)e.push({name:parseInt(C.selectedSignals[a].name),block:C.selectedSignals[a],starting:C.signalRegistry.getSignal(parseInt(C.selectedSignals[a].name))});var f=T(N(m(c)));workspace.system.mouse.mouseInteractionHandler(function(a){a=T(N(m(a))).position-f.position;for(var b=0;b<e.length;b++){C.signalRegistry.update(e[b].name,{length:e[b].starting.length+a});var c=C.signalRegistry.getSignal(e[b].name);
e[b].block.position(c.position);e[b].block.length(c.length)}})}};h.rightHandle.onmousemove=function(a,b,c){a=workspace.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");workspace.core.viewport.cursor(b)};h.rightHandle.onmouseleave=function(a,b,c){workspace.core.viewport.cursor("default")};return{id:a,signalBlock:h}}function ha(){var a=f.builder("group","playhead");L.append(a);a.main=f.builder("rectangle","main",{x:-H.width/2,width:H.width,height:D.totalSize.height,style:{fill:I}});
a.append(a.main);a.invisibleHandle=f.builder("rectangle","invisibleHandle",{x:-H.width*H.invisibleHandleMux/2+H.width/2,width:H.width*H.invisibleHandleMux,height:D.totalSize.height,style:{fill:"rgba(255,0,0,0)"}});a.append(a.invisibleHandle);a.invisibleHandle.onmousedown=function(){H.held=!0;workspace.system.mouse.mouseInteractionHandler(function(a){F.playheadPosition(T(N(m(a))).position)},function(){H.held=!1})};a.invisibleHandle.onmouseenter=function(a,b,c){workspace.core.viewport.cursor("col-resize")};
a.invisibleHandle.onmousemove=function(a,b,c){workspace.core.viewport.cursor("col-resize")};a.invisibleHandle.onmouseleave=function(a,b,c){workspace.core.viewport.cursor("default")};H.present=!0;return a}d=void 0===d?"sequencer":d;b=void 0===b?300:b;c=void 0===c?100:c;h=void 0===h?0:h;k=void 0===k?64:k;g=void 0===g?16:g;n=void 0===n?1:n;l=void 0===l?1:l;p=void 0===p?"rgba(20,20,20,1)":p;y=void 0===y?"rgba(209, 189, 222, 0.5)":y;q=void 0===q?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.95)",
lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.95)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",stroke:"rgba(129,209,173,0.95)",lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.95)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.95)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.95)",lineWidth:.5}]:q;r=void 0===r?[{fill:"rgba(138,138,138,0.8)",stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",
stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},{fill:"rgba(234,238,110,0.8)",stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:r;x=void 0===x?"rgba(200,0,0,0)":x;u=void 0===u?3:u;w=void 0===w?[0,1]:w;t=void 0===t?{fill:"rgba(120,120,120,0.8)",stroke:"rgba(120,120,120,1)",lineWidth:.5}:t;v=void 0===
v?[{fill:"rgba(120,120,120,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5},{fill:"rgba(100,100,100,  0)",stroke:"rgba(120,120,120,1)",lineWidth:.5}]:v;z=void 0===z?[0]:z;B=void 0===B?{fill:"rgba(229, 221, 112,0.25)",stroke:"rgba(252,244,128,0.5)",lineWidth:.5}:B;A=void 0===A?[{fill:"rgba(30,30,30,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5}]:A;I=void 0===I?"rgb(240, 240, 240)":I;E=void 0===E?function(a){}:E;M=void 0===M?function(a){}:M;K=void 0===K?function(a){}:K;var ia=this,D={totalSize:{width:b/
n,height:c/l},viewposition:{x:0,y:0},viewArea:{topLeft:{x:0,y:0},bottomRight:{x:n,y:l}}},C={step:1,snapping:!0,defaultStrength:.5,selectedSignals:[],activeSignals:[],signalRegistry:new workspace.library.structure.signalRegistry(k,g)},V=!1,R={start:0,end:k},H={present:!1,width:.75,invisibleHandleMux:4,position:-1,held:!1,automoveViewposition:!1},F=f.builder("group",d,{x:e,y:a,angle:h}),ba=f.builder("rectangle","backing",{width:b,height:c,style:{fill:p}});F.append(ba);d=f.builder("rectangle","stencil",
{width:b,height:c});F.stencil(d);F.clip(!0);var L=f.builder("group","workarea");F.append(L);d=f.builder("group","backgroundDrawArea");L.append(d);var O=f.builder("group","backgroundDrawArea_horizontal");d.append(O);var P=f.builder("group","backgroundDrawArea_vertical");d.append(P);var S=f.builder("rectangle","interactionPlane_back",{width:D.totalSize.width,height:D.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});L.append(S);S.onwheel=function(a,b,c){};var Q=f.builder("group","signalPane");L.append(Q);
var U=f.builder("rectangle","interactionPlane_front",{width:D.totalSize.width,height:D.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});L.append(U);U.onwheel=function(a,b,c){};F.__calculationAngle=h;F.viewposition=Y;F.viewarea=function(a,b){b=void 0===b?!0:b;if(void 0==a||void 0==a.topLeft&&void 0==a.bottomRight)return D.viewArea;void 0==a.topLeft?a.topLeft={x:D.viewArea.topLeft.x,y:D.viewArea.topLeft.y}:(void 0==a.topLeft.x&&(a.topLeft.x=D.viewArea.topLeft.x),void 0==a.topLeft.y&&(a.topLeft.y=D.viewArea.topLeft.y));
void 0==a.bottomRight?a.bottomRight={x:D.bottomRight.topLeft.x,y:D.bottomRight.topLeft.ys}:(void 0==a.bottomRight.x&&(a.bottomRight.x=D.viewArea.bottomRight.x),void 0==a.bottomRight.y&&(a.bottomRight.y=D.viewArea.bottomRight.y));var c=D.viewArea.bottomRight.x-D.viewArea.topLeft.x!=a.bottomRight.x-a.topLeft.x,d=a.bottomRight.y-a.topLeft.y!=D.viewArea.bottomRight.y-D.viewArea.topLeft.y;c&&d?Z(a.bottomRight.x-a.topLeft.x,a.bottomRight.y-a.topLeft.y):c?Z(a.bottomRight.x-a.topLeft.x,void 0):d&&Z(void 0,
a.bottomRight.y-a.topLeft.y);d=c=0;0!=1-(a.bottomRight.x-a.topLeft.x)&&(c=a.topLeft.x+(a.bottomRight.x-a.topLeft.x)/(1-(a.bottomRight.x-a.topLeft.x))*a.topLeft.x);0!=1-(a.bottomRight.y-a.topLeft.y)&&(d=a.topLeft.y+(a.bottomRight.y-a.topLeft.y)/(1-(a.bottomRight.y-a.topLeft.y))*a.topLeft.y);Y(c,d,b);D.viewArea=Object.assign(a,{})};F.step=function(a){if(void 0==a)return C.step;C.step=a};F.glowHorizontal=function(a,b,c){for(void 0==c&&(c=b+1);b<=c;b++){var d=a?t:v[w[b%w.length]];O.children[b].style.fill=
d.fill;O.children[b].style.stroke=d.stroke;O.children[b].style.lineWidth=d.lineWidth}};F.glowVertical=function(a,b,c){for(void 0==c&&(c=b+1);b<c;b++){var d=a?B:A[z[b%z.length]];P.children[b].style.fill=d.fill;P.children[b].style.stroke=d.stroke;P.children[b].style.lineWidth=d.lineWidth}};F.loopActive=function(a){if(void 0==a)return V;V=a;F.glowVertical(!1,0,k);V&&F.glowVertical(!0,0>R.start?0:R.start,R.end>k?k:R.end)};F.loopPeriod=function(a,b){if(void 0==a||void 0==b)return R;a>b||0>a||0>b||(R={start:a,
end:b},V&&(F.glowVertical(!1,0,k),F.glowVertical(!0,0>a?0:a,b>k?k:b)))};F.export=function(){return C.signalRegistry.export()};F.import=function(a){C.signalRegistry.import(a)};F.getAllSignals=function(){return C.signalRegistry.getAllSignals()};F.addSignal=function(a,b,c,d){aa(a,b,c,void 0===d?1:d)};F.addSignals=function(a){for(var b=0;b<a.length;b++)void 0!=a[b]&&null!=a[b]&&this.addSignal(a[b].line,a[b].position,a[b].length,a[b].strength)};F.eventsBetween=function(a,b){return C.signalRegistry.eventsBetween(a,
b)};F.automove=function(a){if(void 0==a)return H.automoveViewposition;H.automoveViewposition=a};F.playheadPosition=function(a,b){if(void 0==a)return H.position;H.position=a;if(void 0===b||b){a=[];for(b=0;b<C.activeSignals.length;b++){var c=C.signalRegistry.getSignal(C.activeSignals[b]);null!=c&&a.unshift({signalID:C.activeSignals[b],line:c.line,position:R.start,strength:0})}C.activeSignals=[];F.event&&0<a.length&&F.event(a)}a=L.getElementsWithName("playhead")[0];0>H.position||H.position>k?void 0!=
a&&a.parent.remove(a):(void 0==a&&(a=ha()),a.parameter.x(D.totalSize.width/k*H.position),H.automoveViewposition&&(a=k-k*n,(H.position<Math.floor(D.viewposition.x*a)||H.position>Math.floor(D.viewposition.x*a)+k*n)&&F.viewposition((H.position>a?a:H.position)/a)))};F.progress=function(){if(!H.held){var a=F.eventsBetween(H.position,H.position+C.step);if(V&&H.position==R.start){for(var b=0;b<C.activeSignals.length;b++){var c=C.signalRegistry.getSignal(C.activeSignals[b]);null!=c&&a.unshift({signalID:C.activeSignals[b],
line:c.line,position:R.start,strength:0})}C.activeSignals=[]}for(b=0;b<a.length;b++)c=C.activeSignals.indexOf(a[b].signalID),-1!=c&&0==a[b].strength?C.activeSignals.splice(c):0<a[b].strength&&C.activeSignals.push(a[b].signalID);H.position=V&&H.position+C.step==R.end?R.start:H.position+C.step;F.playheadPosition(H.position,!1);F.event&&0<a.length&&F.event(a)}};S.onmousedown=function(a,d,e){a=workspace.system.keyboard.pressedKeys;if(!a.alt||!a.Space)if(a.shift){var h=m(e),p=m(e),q=f.builder("rectangle",
"selectionArea",{x:h.x*b,y:h.y*c,width:0,height:0,style:{fill:y}});F.append(q);workspace.system.mouse.mouseInteractionHandler(function(a){p=m(a);p.x=0>p.x?0:p.x;p.y=0>p.y?0:p.y;p.x=1<p.x?1:p.x;p.y=1<p.y?1:p.y;a=p.x-h.x;var d=p.y-h.y,e=h.x,f=h.y,k=1,g=1;0>a&&(k=-1,e+=a);0>d&&(g=-1,f+=d);q.parameter.x(e*b);q.parameter.y(f*c);q.parameter.width(k*a*b);q.parameter.height(g*d*c)},function(a){q.parent.remove(q);var b=da(h),c=da(p);b.x*=D.totalSize.width;c.y*=D.totalSize.height;c.x*=D.totalSize.width;b.y*=
D.totalSize.height;a={topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};b.x<c.x?(a.topLeft.x=b.x,a.bottomRight.x=c.x):(a.topLeft.x=c.x,a.bottomRight.x=b.x);b.y<c.y?(a.topLeft.y=b.y,a.bottomRight.y=c.y):(a.topLeft.y=c.y,a.bottomRight.y=b.y);for(;0<C.selectedSignals.length;)C.selectedSignals[0].deselect();for(b=0;b<Q.children.length;b++)c=C.signalRegistry.getSignal(parseInt(Q.children[b].name)),workspace.library.math.detectOverlap.boundingBoxes({topLeft:{x:D.totalSize.width/k*c.position,y:D.totalSize.height/
g*c.line},bottomRight:{x:D.totalSize.width/k*(c.position+c.length),y:D.totalSize.height/g*(c.line+1)}},a)&&Q.children[b].select(!0)})}else if(a.alt){for(;0<C.selectedSignals.length;)C.selectedSignals[0].deselect();a=T(N(m(e)));a=aa(a.line,a.position,0);a.signalBlock.select();a.signalBlock.rightHandle.onmousedown(void 0,void 0,e,!0)}else if(a.Space){workspace.core.viewport.cursor("grabbing");var r=m(e),t=D.viewposition.x,u=D.viewposition.y;workspace.system.mouse.mouseInteractionHandler(function(a){a=
m(a);Y(t-(r.x-a.x)*n/(n-1),u-(r.y-a.y)*l/(l-1))},function(a){workspace.library.math.detectOverlap.pointWithinBoundingBox(N(m(a)),D.viewArea)&&workspace.system.keyboard.pressedKeys.Space?workspace.core.viewport.cursor("grab"):workspace.core.viewport.cursor("default")})}else for(;0<C.selectedSignals.length;)C.selectedSignals[0].deselect()};S.onmousemove=function(a,b,c){a=workspace.system.keyboard.pressedKeys;a.alt?workspace.core.viewport.cursor("crosshair"):a.Space?workspace.core.viewport.cursor("grab"):
workspace.core.viewport.cursor("default")};U.onkeydown=function(a,b,c){c=workspace.system.keyboard.pressedKeys;if(c.Backspace||c.Delete)for(;0<C.selectedSignals.length;)C.selectedSignals[0].delete();c.Space&&workspace.core.viewport.cursor("grab");c.alt&&(void 0!=Q.getElementUnderPoint(a,b)?workspace.core.viewport.cursor("copy"):workspace.core.viewport.cursor("crosshair"))};U.onkeyup=function(a,b,c){workspace.core.viewport.cursor("default")};F.onpan=E;F.onchangeviewarea=M;F.event=K;(function(){O.clear();
for(var a=0;a<g;a++){var d=v[w[a%w.length]];O.append(f.builder("rectangle","strip_horizontal_"+a,{x:0,y:c/(g*l)*a,width:D.totalSize.width,height:c/(g*l),style:{fill:d.fill,stroke:d.stroke,lineWidth:d.lineWidth}}))}P.clear();for(a=0;a<k;a++)d=A[z[a%z.length]],P.append(f.builder("rectangle","strip_vertical_"+a,{x:b/(k*n)*a,y:0,width:b/(k*n),height:D.totalSize.height,style:{fill:d.fill,stroke:d.stroke,lineWidth:d.lineWidth}}))})();return F};this.sequencer.signalBlock=function(d,e,a,b,c,h,k,g,n,l,p,y){function m(){B.body.parameter.height(a);
B.leftHandle.parameter.height(a);B.rightHandle.parameter.height(a)}function r(){B.body.parameter.width(h*e);B.rightHandle.parameter.x(h*e-y/2)}function x(){B.parameter.y(b*a)}function u(a,b){var c=Object.assign({},a[0]);a[0].hasOwnProperty("fill")&&(c.fill=workspace.library.misc.multiBlendColours(a.map(function(a){return a.fill}),b));a[0].hasOwnProperty("stroke")&&(c.stroke=workspace.library.misc.multiBlendColours(a.map(function(a){return a.stroke}),b));return c}k=void 0===k?1:k;g=void 0===g?!1:g;
n=void 0===n?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.8)",lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.8)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",stroke:"rgba(129,209,173,0.8)",lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.8)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.8)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.8)",lineWidth:.5}]:n;l=void 0===l?[{fill:"rgba(138,138,138,0.8)",
stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},{fill:"rgba(234,238,110,0.8)",stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:l;p=void 0===p?"rgba(255,0,255,0)":p;y=void 0===y?5:y;var w=!1,t=y/4,v=u(n,k),z=u(l,k),B=f.builder("group",
String(d),{x:c*e,y:b*a});B.body=f.builder("rectangle","body",{width:h*e,height:a,style:{fill:v.fill,stroke:v.stroke,lineWidth:v.lineWidth}});B.leftHandle=f.builder("rectangle","leftHandle",{x:-y/2,width:y,height:a,style:{fill:p}});B.rightHandle=f.builder("rectangle","rightHandle",{x:h*e-y/2,width:y,height:a,style:{fill:p}});B.append(B.body);B.append(B.leftHandle);B.append(B.rightHandle);B.unit=function(b,d){if(void 0==b&&void 0==d)return{x:e,y:a};void 0==b?(a=d,m(),x()):(void 0==d?(e=b,r()):(e=b,
a=d,r(),m(),x()),B.parameter.x(c*e))};B.line=function(a){if(void 0==a)return b;b=a;x()};B.position=function(a){if(void 0==a)return c;c=a;B.parameter.x(c*e)};B.length=function(a){if(void 0==a)return h;h=a<t/e?t/e:a;r()};B.strength=function(a){if(void 0==a)return k;a=1<a?1:a;k=0>a?0:a;v=u(n,k);z=u(l,k);B.glow(g)};B.glow=function(a){if(void 0==a)return g;(g=a)?(B.body.style.fill=z.fill,B.body.style.stroke=z.stroke,B.body.style.lineWidth=z.lineWidth):(B.body.style.fill=v.fill,B.body.style.stroke=v.stroke,
B.body.style.lineWidth=v.lineWidth)};B.selected=function(a){if(void 0==a)return w;w=a};return B};this.list=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r,x,u,w,t,v,z,B,A,I,E,M,K,X,N,da,T,Y,Z,aa,ha,ia,D,C,V,R,H,F,ba,L,O,P,S,Q,U,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Oa,G,ea,fa,Pa,Qa,Ra){function m(){ca=[];Na.clear();W=[];for(var a=Sa=Ua=0,d=0;d<k.length;d++)if("space"==k[d]){var e=f.builder("rectangle",""+d,{x:0,y:a,width:b,height:c*z,style:{fill:"rgba(255,0,0,0)"}});
a+=c*(z+w);Na.append(e)}else"break"==k[d]?(e=f.builder("rectangle",""+d,{x:b*(1-v)*.5,y:a,width:b*v,height:c*t,style:{fill:A}}),a+=c*(t+w),Na.append(e)):(e=f.builder("button_rect",""+d,{x:b*(1-u)*.5,y:a,width:b*u,height:c*x,text_left:k[d].text_left,text_centre:k[d].text?k[d].text:k[d].text_centre,text_right:k[d].text_right,textVerticalOffset:g,textHorizontalOffsetMux:n,active:l,hoverable:y,selectable:q,pressable:r,style:{text_font:I,text_textBaseline:E,text_fill:M,text_stroke:K,text_lineWidth:X,background__off__fill:N,
background__off__stroke:da,background__off__lineWidth:T,background__up__fill:Y,background__up__stroke:Z,background__up__lineWidth:aa,background__press__fill:ha,background__press__stroke:ia,background__press__lineWidth:D,background__select__fill:C,background__select__stroke:V,background__select__lineWidth:R,background__select_press__fill:H,background__select_press__stroke:F,background__select_press__lineWidth:ba,background__glow__fill:L,background__glow__stroke:O,background__glow__lineWidth:P,background__glow_press__fill:S,
background__glow_press__stroke:Q,background__glow_press__lineWidth:U,background__glow_select__fill:ja,background__glow_select__stroke:ka,background__glow_select__lineWidth:la,background__glow_select_press__fill:ma,background__glow_select_press__stroke:na,background__glow_select_press__lineWidth:oa,background__hover__fill:pa,background__hover__stroke:qa,background__hover__lineWidth:ra,background__hover_press__fill:sa,background__hover_press__stroke:ta,background__hover_press__lineWidth:ua,background__hover_select__fill:va,
background__hover_select__stroke:wa,background__hover_select__lineWidth:xa,background__hover_select_press__fill:ya,background__hover_select_press__stroke:za,background__hover_select_press__lineWidth:Aa,background__hover_glow__fill:Ba,background__hover_glow__stroke:Ca,background__hover_glow__lineWidth:Da,background__hover_glow_press__fill:Ea,background__hover_glow_press__stroke:Fa,background__hover_glow_press__lineWidth:Ga,background__hover_glow_select__fill:Ha,background__hover_glow_select__stroke:Ia,
background__hover_glow_select__lineWidth:Ja,background__hover_glow_select_press__fill:Ka,background__hover_glow_select_press__stroke:La,background__hover_glow_select_press__lineWidth:Ma}}),e.onenter=function(a){return function(){J.onenter(a)}}(d),e.onleave=function(a){return function(){J.onleave(a)}}(d),e.onpress=function(a){return function(){J.onpress(a)}}(d),e.ondblpress=function(a){return function(){J.ondblpress(a)}}(d),e.onrelease=function(a){return function(){k[a].function&&k[a].function();J.onrelease(a)}}(d),
e.onselect=function(a){return function(b,c){J.select(a,!0,c,!1)}}(d),e.ondeselect=function(a){return function(b,c){J.select(a,!1,c,!1)}}(d),a+=c*(x+w),Na.append(e),ca.push(e));return a-c*w}b=void 0===b?50:b;c=void 0===c?100:c;k=void 0===k?[]:k;g=void 0===g?.5:g;n=void 0===n?.05:n;l=void 0===l?!0:l;p=void 0===p?!0:p;y=void 0===y?!0:y;q=void 0===q?!0:q;r=void 0===r?!0:r;x=void 0===x?.1:x;u=void 0===u?.95:u;w=void 0===w?.01:w;t=void 0===t?.0025:t;v=void 0===v?.9:v;z=void 0===z?.005:z;B=void 0===B?"rgba(230,230,230,1)":
B;A=void 0===A?"rgba(195,195,195,1)":A;I=void 0===I?"5pt Arial":I;E=void 0===E?"alphabetic":E;M=void 0===M?"rgba(0,0,0,1)":M;K=void 0===K?"rgba(0,0,0,0)":K;X=void 0===X?1:X;N=void 0===N?"rgba(180,180,180,1)":N;da=void 0===da?"rgba(0,0,0,0)":da;T=void 0===T?0:T;Y=void 0===Y?"rgba(200,200,200,1)":Y;Z=void 0===Z?"rgba(0,0,0,0)":Z;aa=void 0===aa?0:aa;ha=void 0===ha?"rgba(230,230,230,1)":ha;ia=void 0===ia?"rgba(0,0,0,0)":ia;D=void 0===D?0:D;C=void 0===C?"rgba(200,200,200,1)":C;V=void 0===V?"rgba(120,120,120,1)":
V;R=void 0===R?2:R;H=void 0===H?"rgba(230,230,230,1)":H;F=void 0===F?"rgba(120,120,120,1)":F;ba=void 0===ba?2:ba;L=void 0===L?"rgba(220,220,220,1)":L;O=void 0===O?"rgba(0,0,0,0)":O;P=void 0===P?0:P;S=void 0===S?"rgba(250,250,250,1)":S;Q=void 0===Q?"rgba(0,0,0,0)":Q;U=void 0===U?0:U;ja=void 0===ja?"rgba(220,220,220,1)":ja;ka=void 0===ka?"rgba(120,120,120,1)":ka;la=void 0===la?2:la;ma=void 0===ma?"rgba(250,250,250,1)":ma;na=void 0===na?"rgba(120,120,120,1)":na;oa=void 0===oa?2:oa;pa=void 0===pa?"rgba(220,220,220,1)":
pa;qa=void 0===qa?"rgba(0,0,0,0)":qa;ra=void 0===ra?0:ra;sa=void 0===sa?"rgba(240,240,240,1)":sa;ta=void 0===ta?"rgba(0,0,0,0)":ta;ua=void 0===ua?0:ua;va=void 0===va?"rgba(220,220,220,1)":va;wa=void 0===wa?"rgba(120,120,120,1)":wa;xa=void 0===xa?2:xa;ya=void 0===ya?"rgba(240,240,240,1)":ya;za=void 0===za?"rgba(120,120,120,1)":za;Aa=void 0===Aa?2:Aa;Ba=void 0===Ba?"rgba(240,240,240,1)":Ba;Ca=void 0===Ca?"rgba(0,0,0,0)":Ca;Da=void 0===Da?0:Da;Ea=void 0===Ea?"rgba(250,250,250,1)":Ea;Fa=void 0===Fa?"rgba(0,0,0,0)":
Fa;Ga=void 0===Ga?0:Ga;Ha=void 0===Ha?"rgba(240,240,240,1)":Ha;Ia=void 0===Ia?"rgba(120,120,120,1)":Ia;Ja=void 0===Ja?2:Ja;Ka=void 0===Ka?"rgba(250,250,250,1)":Ka;La=void 0===La?"rgba(120,120,120,1)":La;Ma=void 0===Ma?2:Ma;Oa=void 0===Oa?function(){}:Oa;G=void 0===G?function(){}:G;ea=void 0===ea?function(){}:ea;fa=void 0===fa?function(){}:fa;Pa=void 0===Pa?function(){}:Pa;Qa=void 0===Qa?function(){}:Qa;Ra=void 0===Ra?function(){}:Ra;var ca=[],W=[],Sa=0,Ua=0,J=f.builder("group",void 0===d?"list":d,
{x:e,y:a,angle:void 0===h?0:h});d=f.builder("rectangle","backing",{width:b,height:c,style:{fill:B}});J.append(d);var Na=f.builder("group","itemCollection");J.append(Na);var Ta=m();d=f.builder("rectangle","cover",{width:b,height:c,style:{fill:"rgba(0,0,0,0)"}});J.append(d);e=f.builder("rectangle","stencil",{width:b,height:c,style:{fill:"rgba(0,0,0,0)"}});J.stencil(e);J.clip(!0);d.onwheel=function(a,b,c){a=c.deltaY/100;J.position(J.position()+a/10);for(a=0;a<ca.length;a++)ca[a].forceMouseLeave()};J.position=
function(a,b){b=void 0===b?!0:b;if(void 0==a)return Ua;a=0>a?0:a;Ua=a=1<a?1:a;if(!(Ta<c)&&(Na.parameter.y(-a*(Ta-c)),b&&this.onpositionchange))this.onpositionchange(a)};J.select=function(a,b,c,d){d=void 0===d?!0:d;if(q){if(p)if(void 0!=c&&c.shiftKey){b=Math.min(Sa,a);a=Math.max(Sa,a);for(c=0;c<ca.length;c++)ca[c].name==""+b&&(b=c),ca[c].name==""+a&&(a=c);W=[];for(c=0;c<ca.length;c++)(c>a||c<b)&&ca[c].select()&&ca[c].select(!1,void 0,!1);for(c=b;c<=a;c++)ca[c].select()||(ca[c].select(!0,void 0,!1),
W.push(c))}else d&&ca[a].select(b),b&&!W.includes(a)?W.push(a):!b&&W.includes(a)&&W.splice(W.indexOf(a),1),Sa=a;else{if(b&&!W.includes(a)){for(;0<W.length;)Na.children[W[0]].select(!1,void 0,!1),W.shift();W.push(a)}else!b&&W.includes(a)&&(W=[]);d&&Na.children[a].select(!0,void 0,!1)}J.onselection(W)}};J.add=function(a){k.push(a);Ta=m()};J.remove=function(a){k.splice(a,1);Ta=m()};J.onenter=Oa;J.onleave=G;J.onpress=ea;J.ondblpress=fa;J.onrelease=Pa;J.onselection=Qa;J.onpositionchange=Ra;return J};this.grapher_waveWorkspace=
function(d,e,a,b,c,h,k,g,n,l,p,y,q,r,x,u,w,t){b=void 0===b?120:b;c=void 0===c?60:c;k=void 0===k?!0:k;g=void 0===g?!0:g;n=void 0===n?[{stroke:"rgba(0,255,0,1)",lineWidth:.25,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.25,lineJoin:"round"}]:n;l=void 0===l?[{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"},{fill:"rgba(255,255,100,1)",size:.75,font:"Helvetica"}]:l;p=void 0===p?"rgba(0,100,0,1)":p;y=void 0===y?.25:y;q=void 0===q?"rgba(0,150,0,1)":q;r=void 0===r?"10pt Helvetica":r;x=void 0===
x?"rgba(50,50,50,1)":x;u=void 0===u?function(a,b){}:u;w=void 0===w?function(a,b){}:w;t=void 0===t?function(a){}:t;var m=f.builder("group",void 0===d?"grapher_waveWorkspace":d,{x:e,y:a,angle:void 0===h?0:h});d=f.builder("grapher__static","graph",{width:b,height:c,style:{foregrounds:n,foregroundText:l,background_stroke:p,background_lineWidth:y,backgroundText_fill:q,backgroundText_font:r,backing:x}});d.resolution(10);m.append(d);b=f.builder("needleOverlay","overlay",{width:b,height:c,selectNeedle:k,
selectionArea:g,needleStyles:n.map(function(a){return a.stroke})});m.append(b);m.horizontalMarkings=d.horizontalMarkings;m.verticalMarkings=d.verticalMarkings;m.drawBackground=d.drawBackground;m.drawForeground=d.drawForeground;m.draw=d.draw;m.mark=b.mark;m.removeAllMarks=b.removeAllMarks;m.select=b.select;m.area=b.area;m.onchange=u;m.onrelease=w;m.selectionAreaToggle=t;b.onchange=function(a,b){if(m.onchange)m.onchange(a,b)};b.onrelease=function(a,b){if(m.onrelease)m.onrelease(a,b)};b.selectionAreaToggle=
function(a){m.selectionAreaToggle&&m.selectionAreaToggle(a)};d.viewbox({left:0});d.drawBackground();b.select(0);return m};this.dial_discrete=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r,x){function m(a,b){a=a>g-1?g-1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=w.onchange)w.onchange(a);h=a=Math.round(a);t.set(h/(g-1))}d=void 0===d?"dial_discrete":d;b=void 0===b?15:b;h=void 0===h?0:h;k=void 0===k?0:k;g=void 0===g?5:g;n=void 0===n?3*Math.PI/4:n;l=void 0===l?1.5*Math.PI:l;p=void 0===p?"rgba(200,200,200,1)":p;y=void 0===
y?"rgba(50,50,50,1)":y;q=void 0===q?"rgba(250,100,100,1)":q;r=void 0===r?function(){}:r;x=void 0===x?function(){}:x;var w=f.builder("group",d,{x:e,y:a,angle:void 0===c?0:c}),t=f.builder("dial_continuous",d,{x:0,y:0,r:b,angle:0,startAngle:n,maxAngle:l,style:{handle:p,slot:y,needle:q}});t.getChildByName("handle").ondblclick=void 0;t.getChildByName("handle").onwheel=void 0;t.getChildByName("handle").onmousedown=void 0;w.append(t);var v=!1;w.set=function(a,b){v||m(a,b)};w.get=function(){return h};var z=
0;t.getChildByName("handle").ondblclick=function(){if(!(0>k||v)&&(m(k),void 0!=w.onrelease))w.onrelease(h)};t.getChildByName("handle").onwheel=function(a,b,c){if(!v&&(z+=c.deltaY/100,1<=Math.abs(z)&&(m(h-1*Math.sign(z)),z=0,void 0!=w.onrelease)))w.onrelease(h)};t.getChildByName("handle").onmousedown=function(a,b,c){var d=h,e=c.y;v=!0;workspace.system.mouse.mouseInteractionHandler(function(a){m(d-Math.round((a.y-e)/25));if(void 0!=w.onchange)w.onchange(h)},function(a){v=!1;if(void 0!=w.onrelease)w.onrelease(h)})};
w.onchange=r;w.onrelease=x;m(h);return w};this.rangeslide=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r,x,u,w){function m(a,b,d){d=void 0===d?!0:d;a=1<a?1:a;a=0>a?0:a;switch(b){default:console.error("unknown handle to adjust");break;case "start":1<=a/(1-k/(1-k))&&(a=1-k/(1-k));var e=a+(1-a)*k,f=n.end-n.end*k;e>=f&&(n.end=e/(1-k));break;case "end":1>=a/(k/(1-k))&&(a=k/(1-k)),e=n.start+(1-n.start)*k,f=a-a*k,e>=f&&(n.start=(f-k)/(1-k))}n[b]=a;K.start.parameter.y(n.start*c*(1-k));K.end.parameter.y(n.end*c*(1-
k));M.parameter.y(c*(k+n.start-k*(n.start+.1)));M.parameter.height(c*(n.end-n.start+k*(n.start-n.end-1+.2)));if(d&&A.onchange)A.onchange(n)}function v(a,b){var c=I.getOffset();return workspace.library.math.cartesianAngleAdjust(a-(I.x+c.x),b-(I.y+c.y),0-(I.angle+c.a)).y/E.height}b=void 0===b?10:b;c=void 0===c?95:c;k=void 0===k?.1:k;g=void 0===g?.75:g;n=void 0===n?{start:0,end:1}:n;l=void 0===l?{start:-1,end:-1}:l;p=void 0===p?"rgba(200,200,200,1)":p;y=void 0===y?"rgba(150,150,150,1)":y;q=void 0===
q?"rgba(50,50,50,1)":q;r=void 0===r?"rgba(255,0,0,0)":r;x=void 0===x?"rgba(200,0,200,0.5)":x;u=void 0===u?function(){}:u;w=void 0===w?function(){}:w;var z=!1,B=["start","end"],A=f.builder("group",void 0===d?"rangeslide":d,{x:e,y:a,angle:void 0===h?0:h}),I=f.builder("group","backingAndSlotGroup");A.append(I);d=f.builder("rectangle","backing",{width:b,height:c,style:{fill:y}});I.append(d);q=f.builder("rectangle","slot",{x:.45*b,y:k/2*c,width:.1*b,height:c*(1-k),style:{fill:q}});I.append(q);var E=f.builder("rectangle",
"backingAndSlotCover",{width:b,height:c,style:{fill:"rgba(0,0,0,0)"}});I.append(E);var M=f.builder("rectangle","span",{x:(1-g)/2*b,y:c*k,width:b*g,height:c-2*c*k,style:{fill:x}});A.append(M);var K={};for(g=0;g<B.length;g++)K[B[g]]=f.builder("group","handle_"+g,{}),A.append(K[B[g]]),x=f.builder("rectangle","handle",{width:b,height:c*k,style:{fill:p}}),K[B[g]].append(x),x=c*k+.01*c,x=f.builder("rectangle","invisibleHandle",{y:(c*k-x)/2,width:b,height:x+k,style:{fill:r}}),K[B[g]].append(x);A.get=function(){return n};
A.set=function(a,b){z||(void 0!=a.start&&m(a.start,"start",b),void 0!=a.end&&m(a.end,"end",b))};I.onmousedown=function(a,b,c){};I.onclick=function(a,b,c){z||(a=v(a,b),a+=.5*k*(2*a-1),Math.abs(n.start-a)<Math.abs(n.end-a)?m(a,"start"):m(a,"end"))};A.ondblclick=function(){0>l.start||0>l.end||z||(m(l.start,"start"),m(l.end,"end"),A.onrelease(n))};A.onwheel=function(){if(!z){var a=event.deltaY/100,b=workspace.core.viewport.scale();a/=10*b;m(n.start-a,"start");m(n.end+a,"end")}};M.onmousedown=function(a,
b,c){z=!0;var d=n.start,e=v(a,b);workspace.system.mouse.mouseInteractionHandler(function(a){a=workspace.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=v(a.x,a.y);a=d+(a-e);a=[a,a+(n.end-n.start)];0>=a[0]?(a[1]-=a[0],a[0]=0):1<=a[1]&&(a[0]-=a[1]-1,a[1]=1);m(a[0],"start");m(a[1],"end");A.onchange(n)},function(a){A.onrelease(n);z=!1})};for(g=0;g<B.length;g++)K[B[g]].children[1].onmousedown=function(a){return function(b,c,d){z=!0;var e=n[B[a]],f=v(b,c);workspace.system.mouse.mouseInteractionHandler(function(b){b=
workspace.core.viewport.windowPoint2workspacePoint(b.x,b.y);b=v(b.x,b.y);m(e+(b-f)/(1-k),B[a]);A.onchange(n)},function(a){A.onrelease(n);z=!1})}}(g);A.onchange=u;A.onrelease=w;m(0,"start");m(1,"end");return A}};this.dynamic=new function(){this.connectionNode_voltage=function(d,e,a,b,c,h,k,g,n,l,p,y,q){p=void 0===p?function(a){}:p;y=void 0===y?function(a){}:y;q=void 0===q?function(a){}:q;var m=f.builder("connectionNode",void 0===d?"connectionNode_voltage":d,{x:e,y:a,angle:void 0===b?0:b,width:void 0===
c?20:c,height:void 0===h?20:h,type:"voltage",style:{dim:void 0===k?"rgb(222, 255, 220)":k,glow:void 0===g?"rgb(240, 252, 239)":g,cable_dim:void 0===n?"rgb(84, 247, 111)":n,cable_glow:void 0===l?"rgb(159, 252, 174)":l}}),x=0;m._getLocalValue=function(){return x};m._update=function(a){0<a?m.activate():m.deactivate();p(a)};m.set=function(a){x=a;a=m.read();m._update(a);void 0!=m.getForeignNode()&&m.getForeignNode()._update(a)};m.read=function(){return x+(void 0!=m.getForeignNode()?m.getForeignNode()._getLocalValue():
!1)};m.onconnect=function(a){y&&y(a);m._update(m.read())};m.ondisconnect=function(a){q&&q(a);m._update(x)};return m};this.cable=function(d,e,a,b,c,h,k){e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===c?0:c;h=void 0===h?"rgb(255,0,0)":h;k=void 0===k?"rgb(255,100,100)":k;d=f.builder("group",void 0===d?"path":d);var g=f.builder("path","cable",{points:[{x:e,y:a},{x:b,y:c}],style:{stroke:h,lineWidth:5}});d.append(g);d.activate=function(){g.style.stroke=k};d.deactivate=function(){g.style.stroke=
h};d.draw=function(d,f,h,k){e=void 0!=d?d:e;a=void 0!=f?f:a;b=void 0!=h?h:b;c=void 0!=k?k:c;g.parameter.points([{x:e,y:a},{x:b,y:c}])};d._isCable=!0;return d};this.connectionNode_audio=function(d,e,a,b,c,h,k,g,n,l,p,y,q,r){k=void 0===k?!1:k;q=void 0===q?function(){}:q;r=void 0===r?function(){}:r;var m=f.builder("connectionNode",void 0===d?"connectionNode_audio":d,{x:e,y:a,angle:void 0===b?0:b,width:void 0===c?20:c,height:void 0===h?20:h,type:"audio",direction:k?"out":"in",style:{dim:void 0===n?"rgba(255, 244, 220, 1)":
n,glow:void 0===l?"rgba(255, 244, 244, 1)":l,cable_dim:void 0===p?"rgb(247, 146, 84)":p,cable_glow:void 0===y?"rgb(242, 168, 123)":y}});m._direction=k?"out":"in";m.audioNode=g.createAnalyser();m.out=function(){return m.audioNode};m.in=function(){return m.audioNode};m.onconnect=function(a){"out"==m._direction&&m.audioNode.connect(m.getForeignNode().audioNode);q&&q(a)};m.ondisconnect=function(a){"out"==m._direction&&m.audioNode.disconnect(m.getForeignNode().audioNode);r&&r(a)};return m};this.connectionNode_data=
function(d,e,a,b,c,h,k,g,n,l,p,y,q,r){function m(a){a.activate();setTimeout(function(){void 0!=a&&a.deactivate()},100);void 0!=a.getForeignNode()&&(a.getForeignNode().activate(),setTimeout(function(){void 0!=a&&void 0!=a.getForeignNode()&&a.getForeignNode().deactivate()},100))}p=void 0===p?function(a,b){}:p;y=void 0===y?function(a){}:y;var u=f.builder("connectionNode",void 0===d?"connectionNode_data":d,{x:e,y:a,angle:void 0===b?0:b,width:void 0===c?20:c,height:void 0===h?20:h,type:"data",style:{dim:void 0===
k?"rgba(220, 244, 255,1)":k,glow:void 0===g?"rgba(244, 244, 255, 1)":g,cable_dim:void 0===n?"rgb(84, 146, 247)":n,cable_glow:void 0===l?"rgb(123, 168, 242)":l},onconnect:void 0===q?function(){}:q,ondisconnect:void 0===r?function(){}:r});u.send=function(a,b){m(u);if(void 0!=u.getForeignNode())u.getForeignNode().onreceivedata(a,b)};u.request=function(a){m(u);if(void 0!=u.getForeignNode())u.getForeignNode().ongivedata(a)};u.onreceivedata=p;u.ongivedata=y;return u};this.connectionNode=function(d,e,a,
b,c,h,k,g,n,l,p,y,q,r){c=void 0===c?20:c;h=void 0===h?20:h;k=void 0===k?"none":k;g=void 0===g?"":g;n=void 0===n?"rgb(220, 220, 220)":n;l=void 0===l?"rgb(244, 244, 244)":l;p=void 0===p?"rgb(146, 146, 146)":p;y=void 0===y?"rgb(215, 215, 215)":y;q=void 0===q?function(a){}:q;r=void 0===r?function(a){}:r;var m=f.builder("group",void 0===d?"connectionNode":d,{x:e,y:a,angle:void 0===b?0:b});m._connectionNode=!0;m._type=k;m._direction=g;var u=f.builder("rectangle","node",{width:c,height:h,style:{fill:n}});
m.append(u);var w=void 0;m.connectTo=function(a){if(void 0!=a&&a!=this&&a._type==this._type&&(""!=this._direction&&""!=a._direction||this._direction==a._direction)&&(""==this._direction||a._direction!=this._direction)&&a!=w){this.disconnect();w=a;if(void 0!=q)this.onconnect(!0);w._receiveConnection(this);this._addCable(this)}};m._receiveConnection=function(a){this.disconnect();w=a;if(void 0!=q)this.onconnect(!1)};m.disconnect=function(){if(void 0!=w){this._removeCable();if(void 0!=r)this.ondisconnect(!0);
w._receiveDisconnection();w=null}};m._receiveDisconnection=function(){if(void 0!=r)this.ondisconnect(!1);w=null};m.getForeignNode=function(){return w};u.onmousedown=function(a,b,c){workspace.system.mouse.mouseInteractionHandler(void 0,function(a){a=workspace.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=workspace.core.arrangement.getElementUnderPoint(a.x,a.y);void 0!=a&&(a=a.parent,a._connectionNode&&m.connectTo(a))})};u.ondblclick=function(a,b,c){m.disconnect()};var t;m._addCable=function(){t=
f.builder("cable","cable-"+this.getAddress(),{x1:0,y1:0,x2:100,y2:100,style:{dim:p,glow:y}});w._receiveCable(t);workspace.system.pane.getMiddlegroundPane(this).append(t);this.draw()};m._receiveCable=function(a){t=a};m._removeCable=function(){t.parent.remove(t);t=void 0;w._loseCable()};m._loseCable=function(){t=void 0};m.getCablePoint=function(){var b=this.getOffset(),d=workspace.library.math.cartesianAngleAdjust(e+c/2,a+h/2,b.a);d.x+=b.x;d.y+=b.y;return d};m.draw=function(){if(void 0!=t){var a=this.getCablePoint(),
b=w.getCablePoint();t.draw(a.x,a.y,b.x,b.y)}};m.activate=function(){u.style.fill=l;void 0!=t&&t.activate()};m.deactivate=function(){u.style.fill=n;void 0!=t&&t.deactivate()};m.onconnect=q;m.ondisconnect=r;return m};this.connectionNode_signal=function(d,e,a,b,c,h,k,g,n,l,p,y,q){p=void 0===p?function(a){}:p;y=void 0===y?function(a){}:y;q=void 0===q?function(a){}:q;var m=f.builder("connectionNode",void 0===d?"connectionNode_signal":d,{x:e,y:a,angle:void 0===b?0:b,width:void 0===c?20:c,height:void 0===
h?20:h,type:"signal",style:{dim:void 0===k?"rgb(255, 220, 244)":k,glow:void 0===g?"rgb(255, 244, 244)":g,cable_dim:void 0===n?"rgb(247, 84, 146)":n,cable_glow:void 0===l?"rgb(247, 195, 215)":l}}),x=!1;m._getLocalValue=function(){return x};m._update=function(){var a=m.read();a?m.activate():m.deactivate();p(a)};m.set=function(a){x=a;m._update();void 0!=m.getForeignNode()&&m.getForeignNode()._update()};m.read=function(){return x||(void 0!=m.getForeignNode()?m.getForeignNode()._getLocalValue():!1)};m.onconnect=
function(a){y&&y(a);m._update()};m.ondisconnect=function(a){q&&q(a);m._update()};return m}};this.builder=function(d,e,a){a||(a={});void 0==a.style&&(a.style={});switch(d){default:return console.warn("Unknown element: "+d),null;case "group":return this.basic.group(e,a.x,a.y,a.angle,a.ignored);case "rectangle":return this.basic.rectangle(e,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,
a.style.shadowOffset);case "image":return this.basic.image(e,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.url);case "canvas":return this.basic.canvas(e,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.resolution);case "polygon":return this.basic.polygon(e,a.points,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "text":return this.basic.text(e,a.x,a.y,a.text,a.angle,a.anchor,
a.size,a.ignored,a.style.font,a.style.textAlign,a.style.textBaseline,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "circle":return this.basic.circle(e,a.x,a.y,a.r,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "path":return this.basic.path(e,a.points,a.ignored,a.style.stroke,a.style.lineWidth,
a.style.lineCap,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "glowbox_rect":return this.display.glowbox_rect(e,a.x,a.y,a.width,a.height,a.angle,a.style.glow,a.style.dim);case "sevenSegmentDisplay":return this.display.sevenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,a.style.dim);case "sevenSegmentDisplay__static":return this.display.sevenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,
a.style.background,a.style.glow,a.style.dim);case "sixteenSegmentDisplay":return this.display.sixteenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,a.style.dim);case "sixteenSegmentDisplay__static":return this.display.sixteenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "readout_sixteenSegmentDisplay":return this.display.readout_sixteenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.count,a.angle,
a.style.background,a.style.glow,a.style.dim);case "readout_sixteenSegmentDisplay__static":return this.display.readout_sixteenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.count,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "level":return this.display.level(e,a.x,a.y,a.angle,a.width,a.height,a.style.backing,a.style.levels);case "meter_level":return this.display.meter_level(e,a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,
a.style.markingStyle_font);case "audio_meter_level":return this.display.audio_meter_level(e,a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,a.style.markingStyle_font);case "rastorDisplay":return this.display.rastorDisplay(e,a.x,a.y,a.angle,a.width,a.height,a.xCount,a.yCount,a.xGappage,a.yGappage);case "grapher":return this.display.grapher(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,
a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher__static":return this.display.grapher__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave":return this.display.grapher_periodicWave(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,
a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave__static":return this.display.grapher_periodicWave__static(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_audioScope":return this.display.grapher_audioScope(e,
a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_audioScope__static":return this.display.grapher_audioScope__static(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,
a.style.backgroundText_font,a.style.backing);case "slide":return this.control.slide(e,a.x,a.y,a.width,a.height,a.angle,a.handleHeight,a.value,a.resetValue,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "slidePanel":return this.control.slidePanel(e,a.x,a.y,a.width,a.height,a.angle,a.handleHeight,a.count,a.value,a.resetValue,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "rangeslide":return this.control.rangeslide(e,
a.x,a.y,a.width,a.height,a.angle,a.handleHeight,a.spanWidth,a.values,a.resetValues,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.style.span,a.onchange,a.onrelease);case "dial_continuous":return this.control.dial_continuous(e,a.x,a.y,a.r,a.angle,a.value,a.resetValue,a.startAngle,a.maxAngle,a.style.handle,a.style.slot,a.style.needle,a.onchange,a.onrelease);case "dial_discrete":return this.control.dial_discrete(e,a.x,a.y,a.r,a.angle,a.value,a.resetValue,a.optionCount,a.startAngle,
a.maxAngle,a.style.handle,a.style.slot,a.style.needle,a.onchange,a.onrelease);case "button_rect":return this.control.button_rect(e,a.x,a.y,a.width,a.height,a.angle,a.text_centre,a.text_left,a.text_right,a.textVerticalOffsetMux,a.textHorizontalOffsetMux,a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,
a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,a.style.background__select__fill,a.style.background__select__stroke,a.style.background__select__strokeWidth,a.style.background__select_press__fill,a.style.background__select_press__stroke,a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,
a.style.background__glow_press__fill,a.style.background__glow_press__stroke,a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,a.style.background__glow_select__strokeWidth,a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,a.style.background__glow_select_press__strokeWidth,a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,
a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,a.style.background__hover_select_press__fill,a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,a.style.background__hover_glow__fill,a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,
a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,a.style.background__hover_glow_select_press__fill,a.style.background__hover_glow_select_press__stroke,a.style.background__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "list":return this.control.list(e,
a.x,a.y,a.width,a.height,a.angle,a.list,a.itemTextVerticalOffsetMux,a.itemTextHorizontalOffsetMux,a.active,a.multiSelect,a.hoverable,a.selectable,a.pressable,a.itemHeightMux,a.itemWidthMux,a.itemSpacingMux,a.breakHeightMux,a.breakWidthMux,a.spacingHeightMux,a.style.backing,a.style.break,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.item__off__fill,a.style.item__off__stroke,a.style.item__off__strokeWidth,a.style.item__up__fill,a.style.item__up__stroke,
a.style.item__up__strokeWidth,a.style.item__press__fill,a.style.item__press__stroke,a.style.item__press__strokeWidth,a.style.item__select__fill,a.style.item__select__stroke,a.style.item__select__strokeWidth,a.style.item__select_press__fill,a.style.item__select_press__stroke,a.style.item__select_press__strokeWidth,a.style.item__glow__fill,a.style.item__glow__stroke,a.style.item__glow__strokeWidth,a.style.item__glow_press__fill,a.style.item__glow_press__stroke,a.style.item__glow_press__strokeWidth,
a.style.item__glow_select__fill,a.style.item__glow_select__stroke,a.style.item__glow_select__strokeWidth,a.style.item__glow_select_press__fill,a.style.item__glow_select_press__stroke,a.style.item__glow_select_press__strokeWidth,a.style.item__hover__fill,a.style.item__hover__stroke,a.style.item__hover__strokeWidth,a.style.item__hover_press__fill,a.style.item__hover_press__stroke,a.style.item__hover_press__strokeWidth,a.style.item__hover_select__fill,a.style.item__hover_select__stroke,a.style.item__hover_select__strokeWidth,
a.style.item__hover_select_press__fill,a.style.item__hover_select_press__stroke,a.style.item__hover_select_press__strokeWidth,a.style.item__hover_glow__fill,a.style.item__hover_glow__stroke,a.style.item__hover_glow__strokeWidth,a.style.item__hover_glow_press__fill,a.style.item__hover_glow_press__stroke,a.style.item__hover_glow_press__strokeWidth,a.style.item__hover_glow_select__fill,a.style.item__hover_glow_select__stroke,a.style.item__hover_glow_select__strokeWidth,a.style.item__hover_glow_select_press__fill,
a.style.item__hover_glow_select_press__stroke,a.style.item__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselection,a.onpositionchange);case "checkbox_rect":return this.control.checkbox_rect(e,a.x,a.y,a.width,a.height,a.angle,a.style.check,a.style.backing,a.style.checkGlow,a.style.backingGlow,a.onchange);case "rastorgrid":return this.control.rastorgrid(e,a.x,a.y,a.width,a.height,a.angle,a.xCount,a.yCount,a.style.backing,a.style.check,a.style.backingGlow,
a.style.checkGlow,a.onchange);case "needleOverlay":return this.control.needleOverlay(e,a.x,a.y,a.width,a.height,a.angle,a.needleWidth,a.selectNeedle,a.selectionArea,a.style.needles,a.onchange,a.onrelease,a.selectionAreaToggle);case "grapher_waveWorkspace":return this.control.grapher_waveWorkspace(e,a.x,a.y,a.width,a.height,a.angle,a.selectNeedle,a.selectionArea,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,
a.style.backing,a.onchange,a.onrelease,a.selectionAreaToggle);case "sequencer":return this.control.sequencer(e,a.x,a.y,a.width,a.height,a.angle,a.xCount,a.yCount,a.zoomLevel_x,a.zoomLevel_y,a.backingStyle,a.selectionAreaStyle,a.blockStyle_body,a.blockStyle_bodyGlow,a.blockStyle_handle,a.blockStyle_handleWidth,a.horizontalStripStyle_pattern,a.horizontalStripStyle_glow,a.horizontalStripStyle_styles,a.verticalStripStyle_pattern,a.verticalStripStyle_glow,a.verticalStripStyle_styles,a.playheadStyle,a.onpan,
a.onchangeviewarea,a.event);case "cable":return this.dynamic.cable(e,a.x1,a.y1,a.x2,a.y2,a.style.dim,a.style.glow);case "connectionNode":return this.dynamic.connectionNode(e,a.x,a.y,a.angle,a.width,a.height,a.type,a.direction,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect);case "connectionNode_signal":return this.dynamic.connectionNode_signal(e,a.x,a.y,a.angle,a.width,a.height,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,
a.ondisconnect);case "connectionNode_voltage":return this.dynamic.connectionNode_voltage(e,a.x,a.y,a.angle,a.width,a.height,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,a.ondisconnect);case "connectionNode_data":return this.dynamic.connectionNode_data(e,a.x,a.y,a.angle,a.width,a.height,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onreceive,a.ongive,a.onconnect,a.ondisconnect);case "connectionNode_audio":return this.dynamic.connectionNode_audio(e,
a.x,a.y,a.angle,a.width,a.height,a.isAudioOutput,workspace.library.audio.context,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect)}}}};this.unit=new function(){this.alpha=new function(){var f=this;this.audioEffectUnits=new function(){this.filterUnit=function(d,e,a){function b(){for(var a=[],b=[],c=0;c<=Math.floor(Math.log10(h.freqRange.high))+1;c++)for(var d=1;10>d&&!(d/10*Math.pow(10,c)>=h.freqRange.high);d+=1/Math.pow(2,h.graphDetail))a.push(Math.log10(Math.pow(10,
c)*d)),b.push(d/10*Math.pow(10,c));return{frequency:b,location:workspace.library.math.normalizeStretchArray(a)}}function c(){var a=b();l.elements.grapher__static.graph.draw(l.filterCircuit.measureFrequencyResponse_values(a.frequency)[0],a.location)}var h={freqRange:{low:.1,high:2E4},graphDetail:3},k={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},m={fill:"rgba(0,0,0,1)",font:"2pt Courier New"},n={fill:"rgba(0,0,0,1)",font:"1.5pt Courier New"},l=f.builder(this.filterUnit,{name:"filterUnit",category:"audioEffectUnits",
collection:"alpha",x:d,y:e,a:a,space:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},{x:0,y:70}],elements:[{type:"polygon",name:"backing",data:{points:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},{x:0,y:70}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:94.8,y:16,width:10,height:20,angle:-.14}},{type:"connectionNode_audio",name:"audioOut",data:{x:-2.3,y:16,width:10,height:20,angle:.144,isAudioOutput:!0}},{type:"grapher__static",name:"graph",
data:{x:15,y:5,width:72.5,height:50,resolution:5,style:{foregrounds:[{stroke:"rgba(0,200,163,1)",lineWidth:.5,lineJoin:"round"}],background_stroke:"rgba(0,200,163,0.25)",background_lineWidth:.25,backgroundText_fill:"rgba(0,200,163,0.75)",backgroundText_font:"6pt Helvetica"}}},{type:"text",name:"Q_0",data:{x:74,y:76,text:"0",style:m}},{type:"text",name:"Q_1/2",data:{x:80,y:59.5,text:"1/2",style:m}},{type:"text",name:"Q_1",data:{x:89,y:76,text:"1",style:m}},{type:"text",name:"Q_title",data:{x:81,y:79,
text:"Q",style:k}},{type:"dial_continuous",name:"Q_dial",data:{x:82.5,y:68.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"gain_0",data:{x:54,y:86,text:"0",style:m}},{type:"text",name:"gain_1/2",data:{x:61.75,y:68.5,text:"5",style:m}},{type:"text",name:"gain_1",data:{x:69,y:86,text:"10",style:m}},{type:"text",name:"gain_title",data:{x:58,y:89,text:"Gain",style:k}},{type:"dial_continuous",
name:"gain_dial",data:{x:62.5,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"frequency_0",data:{x:31.5,y:86,text:"0",style:m}},{type:"text",name:"frequency_100",data:{x:37.5,y:68.5,text:"100",style:m}},{type:"text",name:"frequency_20000",data:{x:46.5,y:86,text:"20k",style:m}},{type:"text",name:"frequency_title",data:{x:35.5,y:89,text:"Freq",style:k}},{type:"dial_continuous",name:"frequency_dial",
data:{x:40,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"type_lowp",data:{x:9,y:74.5,text:"lowp",style:n}},{type:"text",name:"type_highp",data:{x:6,y:69,text:"highp",style:n}},{type:"text",name:"type_band",data:{x:8,y:63,text:"band",style:n}},{type:"text",name:"type_lows",data:{x:14,y:59,text:"lows",style:n}},{type:"text",name:"type_highs",data:{x:22.5,y:59.5,text:"highs",style:n}},
{type:"text",name:"type_peak",data:{x:27.5,y:63,text:"peak",style:n}},{type:"text",name:"type_notch",data:{x:29,y:69,text:"notch",style:n}},{type:"text",name:"type_all",data:{x:25.5,y:74.5,text:"all",style:n}},{type:"text",name:"type_title",data:{x:15.5,y:78.5,text:"Type",style:k}},{type:"dial_discrete",name:"type_dial",data:{x:20,y:67.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:8,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});l.importData=
function(a){l.elements.dial_continuous.Q_dial.set(a.Q);l.elements.dial_continuous.gain_dial.set(a.gain);l.elements.dial_discrete.type_dial.set(a.type);l.elements.dial_continuous.frequency_dial.set(a.frequency)};l.exportData=function(){return{Q:l.elements.dial_continuous.Q_dial.get(),gain:l.elements.dial_continuous.gain_dial.get(),type:l.elements.dial_discrete.type_dial.get(),frequency:l.elements.dial_continuous.frequency_dial.get()}};l.filterCircuit=new g.circuit.alpha.filterUnit(workspace.library.audio.context);
l.elements.connectionNode_audio.audioIn.out().connect(l.filterCircuit.in());l.filterCircuit.out().connect(l.elements.connectionNode_audio.audioOut.in());l.elements.dial_continuous.Q_dial.onchange=function(a){l.filterCircuit.Q(10*a);c()};l.elements.dial_continuous.gain_dial.onchange=function(a){l.filterCircuit.gain(10*a);c()};l.elements.dial_continuous.frequency_dial.onchange=function(a){l.filterCircuit.frequency(workspace.library.math.curvePoint.exponential(a,0,2E4,10.5866095));c()};l.elements.dial_discrete.type_dial.onchange=
function(a){l.filterCircuit.type("lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ")[a]);c()};d=b();d.frequency=d.frequency.filter(function(a,b){return 0==b%Math.pow(2,h.graphDetail)});d.location=d.location.filter(function(a,b){return 0==b%Math.pow(2,h.graphDetail)});l.elements.grapher__static.graph.viewbox({bottom:0,top:2,left:0,right:1});l.elements.grapher__static.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});
l.elements.grapher__static.graph.verticalMarkings({points:d.location,printingValues:d.frequency.map(function(a){return 0==Math.log10(a)%1?a:""}).slice(0,d.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});l.elements.dial_discrete.type_dial.set(0);l.elements.dial_continuous.Q_dial.set(0);l.elements.dial_continuous.gain_dial.set(.1);l.elements.dial_continuous.frequency_dial.set(.5);setTimeout(c,100);return l};this.filterUnit.metadata={name:"Filter Unit",helpURL:"https://metasophiea.com/curve/help/units/alpha/filterUnit/"};
this.reverbUnit=function(d,e){function a(a){0==b.availableTypes.length?console.log("broken or not yet ready"):(a>=b.availableTypes.length?a=b.availableTypes.length-1:0>a&&(a=0),b.reverbTypeSelected=a,k.reverbCircuit.type(b.availableTypes[a],function(){var a=b.reverbTypeSelected;a=("0"+a).slice(-2);k.elements.sevenSegmentDisplay__static.ones.enterCharacter(a[0]);k.elements.sevenSegmentDisplay__static.tens.enterCharacter(a[1])}))}var b={reverbTypeSelected:0,availableTypes:[]},c={fill:"rgba(0,0,0,1)",
font:"3pt Courier New"},h={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},k=f.builder(this.reverbUnit,{name:"reverbUnit",category:"audioEffectUnits",collection:"alpha",x:d,y:e,space:[{x:0,y:10},{x:51.25,y:0},{x:102.5,y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:51.25,y:0},{x:102.5,y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},
{type:"connectionNode_audio",name:"audioIn",data:{x:102.5,y:16,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:16,width:10,height:20,isAudioOutput:!0}},{type:"text",name:"outGain_0",data:{x:8,y:38,text:"0",style:c}},{type:"text",name:"outGain_1/2",data:{x:16.5,y:11,text:"1/2",style:c}},{type:"text",name:"outGain_1",data:{x:29,y:38,text:"1",style:c}},{type:"dial_continuous",name:"outGain_dial",data:{x:20,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",
slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"wetdry_1/2",data:{x:66.5,y:39,text:"wet",style:c}},{type:"text",name:"wetdry_1",data:{x:91.5,y:39,text:"dry",style:c}},{type:"dial_continuous",name:"wetdry_dial",data:{x:82.5,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"button_rect",name:"raiseByOne",data:{x:51,y:6,width:10.25,height:5,style:h,onpress:function(){a(b.reverbTypeSelected+
1)}}},{type:"button_rect",name:"raiseByTen",data:{x:38.75,y:6,width:10.25,height:5,style:h,onpress:function(){a(b.reverbTypeSelected+10)}}},{type:"button_rect",name:"lowerByOne",data:{x:51,y:39,width:10.25,height:5,style:h,onpress:function(){a(b.reverbTypeSelected-1)}}},{type:"button_rect",name:"lowerByTen",data:{x:38.75,y:39,width:10.25,height:5,style:h,onpress:function(){a(b.reverbTypeSelected-10)}}},{type:"sevenSegmentDisplay__static",name:"tens",data:{x:50,y:12.5,width:12.5,height:25}},{type:"sevenSegmentDisplay__static",
name:"ones",data:{x:37.5,y:12.5,width:12.5,height:25}}]});k.importData=function(a){b.reverbTypeSelected=a.selectedType;k.elements.dial_continuous.wetdry_dial.set(a.wetdry);k.elements.dial_continuous.outGain_dial.set(a.outGain)};k.exportData=function(){return{selectedType:b.reverbTypeSelected,wetdry:k.elements.dial_continuous.wetdry_dial.get(),outGain:k.elements.dial_continuous.outGain_dial.get()}};k.reverbCircuit=new g.circuit.alpha.reverbUnit(workspace.library.audio.context);k.elements.connectionNode_audio.audioIn.out().connect(k.reverbCircuit.in());
k.reverbCircuit.out().connect(k.elements.connectionNode_audio.audioOut.in());k.reverbCircuit.getTypes(function(a){b.availableTypes=a});k.elements.dial_continuous.outGain_dial.onchange=function(a){k.reverbCircuit.outGain(a)};k.elements.dial_continuous.wetdry_dial.onchange=function(a){k.reverbCircuit.wetdry(1-a)};k.i={gain:function(a){k.elements.dial_continuous.outGain_dial.set(a)},wetdry:function(a){k.elements.dial_continuous.wetdry_dial.set(a)}};k.elements.dial_continuous.outGain_dial.set(.5);k.elements.dial_continuous.wetdry_dial.set(.5);
setTimeout(function(){a(b.reverbTypeSelected)},1E3);return k};this.reverbUnit.metadata={name:"Reverb Unit",helpURL:"https://metasophiea.com/curve/help/units/alpha/reverbUnit/"};this.multibandFilter=function(d,e,a){function b(){for(var a=[],b=[],c=0;c<=Math.floor(Math.log10(h.freqRange.high))+1;c++)for(var d=1;10>d&&!(d/10*Math.pow(10,c)>=h.freqRange.high);d+=1/Math.pow(2,h.graphDetail))a.push(Math.log10(Math.pow(10,c)*d)),b.push(d/10*Math.pow(10,c));return{frequency:b,location:workspace.library.math.normalizeStretchArray(a)}}
function c(a){if(h.allowUpdate){var c=b();if(void 0==a){var d=l.filterCircuit_0.measureFrequencyResponse(void 0,c.frequency);for(a=0;a<h.channelCount;a++)l.elements.grapher__static.graph.draw(d[a][0],c.location,a)}else d=l.filterCircuit_0.measureFrequencyResponse(a,c.frequency),l.elements.grapher__static.graph.draw(d[0],c.location,a)}}var h={allowUpdate:!1,freqRange:{low:.1,high:2E4},graphDetail:2,channelCount:8,masterGain:1,gain:[],Q:[],frequency:[],curvePointExponentialSharpness:10.586609649448985,
defaultValues:{gain:[.5,.5,.5,.5,.5,.5,.5,.5],Q:[0,.09,.09,.09,.09,.09,.09,0],frequency:[.41416,.479046,.565238,.630592,.717072,.803595,.91345175,.93452845]}},k=[{fill:"rgba(0,200,163,  0.5)"},{fill:"rgba(100,235,131,0.5)"},{fill:"rgba(228,255,26, 0.5)"},{fill:"rgba(232,170,20, 0.5)"},{fill:"rgba(255,87,20,  0.5)"},{fill:"rgba(0,191,255,  0.5)"},{fill:"rgba(249,99,202, 0.5)"},{fill:"rgba(255,255,255,0.5)"}],m={handle:"rgba(240,240,240,1)",backing:"rgba(200,200,200,0.5)",slot:"rgba(50,50,50,1)"},n=
{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"};d={name:"multibandFilter",category:"audioEffectUnits",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:10},{x:10,y:0},{x:185,y:0},{x:195,y:10},{x:195,y:245},{x:185,y:255},{x:10,y:255},{x:0,y:245},{x:0,y:75},{x:-25,y:65},{x:-25,y:10}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:185,y:0},{x:195,y:10},{x:195,y:245},{x:185,y:255},{x:10,y:255},{x:0,y:245},{x:0,y:75},{x:-25,y:65},{x:-25,y:10}],
style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn_0",data:{x:195,y:15,width:10,height:20}},{type:"connectionNode_audio",name:"audioIn_1",data:{x:195,y:40,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut_0",data:{x:-35,y:15,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"audioOut_1",data:{x:-35,y:40,width:10,height:20,isAudioOutput:!0}},{type:"dial_continuous",name:"masterGain",data:{x:-10,y:37.5,r:10,startAngle:3*Math.PI/4,maxAngle:1.5*
Math.PI,resetValue:.5,style:n}},{type:"grapher__static",name:"graph",data:{x:10,y:10,width:175,height:75,style:{foregrounds:[{stroke:"rgba(0,200,163,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(100,235,131,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(228,255,26,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(232,170,20,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,87,20,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,191,255,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(249,99,202,1)",
lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,255,1)",lineWidth:.5,lineJoin:"round"}],background_stroke:"rgba(0,200,163,0.25)",background_lineWidth:.25,backgroundText_fill:"rgba(0,200,163,0.75)",backgroundText_font:"8pt Helvetica"},resolution:5}}]};for(a=0;a<h.channelCount;a++)d.elements.push({type:"rectangle",name:"backing_"+a,data:{x:13.75+22*a,y:87.5,width:12.5,height:157.5,style:k[a]}},{type:"slide",name:"gainSlide_"+a,data:{x:15+22*a,y:90,width:10,height:80,angle:0,handleHeight:.05,resetValue:.5,
style:m}},{type:"dial_continuous",name:"qDial_"+a,data:{x:20+22*a,y:180,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:n}},{type:"dial_continuous",name:"frequencyDial_"+a,data:{x:20+22*a,y:200,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:n}},{type:"readout_sixteenSegmentDisplay__static",name:"frequencyReadout_"+a,data:{x:25+22*a,y:212.5,width:30,height:10,count:8,angle:Math.PI/2,resolution:10}});var l=f.builder(this.multibandFilter,d);l.exportData=function(){return{masterGain:h.masterGain,
freqRange:h.freqRange,channelCount:h.channelCount,gain:h.gain,Q:h.Q,frequency:h.frequency}};l.importData=function(a){};l.filterCircuit_0=new g.circuit.alpha.multibandFilter(workspace.library.audio.context,h.channelCount,!0);l.filterCircuit_1=new g.circuit.alpha.multibandFilter(workspace.library.audio.context,h.channelCount,!0);l.elements.connectionNode_audio.audioIn_0.out().connect(l.filterCircuit_0.in());l.elements.connectionNode_audio.audioIn_1.out().connect(l.filterCircuit_1.in());l.filterCircuit_0.out().connect(l.elements.connectionNode_audio.audioOut_0.in());
l.filterCircuit_1.out().connect(l.elements.connectionNode_audio.audioOut_1.in());l.elements.dial_continuous.masterGain.onchange=function(a){h.masterGain=2*a;l.filterCircuit_0.masterGain(h.masterGain);l.filterCircuit_1.masterGain(h.masterGain);c()};for(a=0;a<h.channelCount;a++)l.elements.slide["gainSlide_"+a].onchange=function(a){return function(b){h.gain[a]=2*(1-b);l.filterCircuit_0.gain(a,h.gain[a]);l.filterCircuit_1.gain(a,h.gain[a]);c(a)}}(a),l.elements.dial_continuous["qDial_"+a].onchange=function(a){return function(b){h.Q[a]=
b;l.filterCircuit_0.Q(a,workspace.library.math.curvePoint.exponential(h.Q[a],0,2E4,h.curvePointExponentialSharpness));l.filterCircuit_1.Q(a,workspace.library.math.curvePoint.exponential(h.Q[a],0,2E4,h.curvePointExponentialSharpness));c(a)}}(a),l.elements.dial_continuous["frequencyDial_"+a].onchange=function(a){return function(b){h.frequency[a]=b;l.elements.readout_sixteenSegmentDisplay__static["frequencyReadout_"+a].text(workspace.library.misc.padString(workspace.library.math.curvePoint.exponential(b,
0,2E4,h.curvePointExponentialSharpness).toFixed(2),8));l.elements.readout_sixteenSegmentDisplay__static["frequencyReadout_"+a].print("smart");l.filterCircuit_0.frequency(a,workspace.library.math.curvePoint.exponential(h.frequency[a],0,2E4,h.curvePointExponentialSharpness));l.filterCircuit_1.frequency(a,workspace.library.math.curvePoint.exponential(h.frequency[a],0,2E4,h.curvePointExponentialSharpness));c(a)}}(a);l.i={gain:function(a,b){if(void 0==b)return l.elements.slide["gainSlide_"+a].get(b);l.elements.slide["gainSlide_"+
a].set(b)},Q:function(a,b){if(void 0==b)return l.elements.dial_continuous["qDial_"+a].get(b);l.elements.dial_continuous["qDial_"+a].set(b)},frequency:function(a,b){if(void 0==b)return l.elements.dial_continuous["frequencyDial_"+a].get(b);l.elements.dial_continuous["frequencyDial_"+a].set(b)},reset:function(a){if(void 0==a){for(a=0;a<h.channelCount;a++)l.i.reset(a);l.elements.dial_continuous.masterGain.set(.5)}else for(a=0;a<h.channelCount;a++)l.elements.slide["gainSlide_"+a].set(h.defaultValues.gain[a]),
l.elements.dial_continuous["qDial_"+a].set(h.defaultValues.Q[a]),l.elements.dial_continuous["frequencyDial_"+a].set(h.defaultValues.frequency[a])}};a=b();a.frequency=a.frequency.filter(function(a,b){return 0==b%Math.pow(2,h.graphDetail)});a.location=a.location.filter(function(a,b){return 0==b%Math.pow(2,h.graphDetail)});l.elements.grapher__static.graph.viewbox({bottom:0,top:2,left:0,right:1});l.elements.grapher__static.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,
y:.075},printText:!0});l.elements.grapher__static.graph.verticalMarkings({points:a.location,printingValues:a.frequency.map(function(a){return 0==Math.log10(a)%1?a:""}).slice(0,a.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});l.i.reset();setTimeout(function(){l.i.reset()},1);h.allowUpdate=!0;c();return l};this.multibandFilter.metadata={name:"Multiband Filter",helpURL:"https://metasophiea.com/curve/help/units/alpha/multibandFilter/"};this.distortionUnit=function(d,e,a){var b=
{fill:"rgba(0,0,0,1)",font:"4pt Courier New"},c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},h=f.builder(this.distortionUnit,{name:"distortionUnit",category:"audioEffectUnits",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,y:10},{x:102.5*.55,y:10},{x:102.5/3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,
y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,y:10},{x:102.5*.55,y:10},{x:102.5/3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:102.5,y:61.5,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:61.5,width:10,height:20,isAudioOutput:!0}},{type:"text",name:"outGain_title",data:{x:17.5,
y:91,text:"out",style:b}},{type:"text",name:"outGain_0",data:{x:9.5,y:85.5,text:"0",style:c}},{type:"text",name:"outGain_1/2",data:{x:19,y:57,text:"1/2",style:c}},{type:"text",name:"outGain_1",data:{x:33,y:85.5,text:"1",style:c}},{type:"dial_continuous",name:"outGain_dial",data:{x:22.5,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"distortionAmount_title",data:{x:16.5,
y:41.5,text:"dist",style:b}},{type:"text",name:"distortionAmount_0",data:{x:9.5,y:36,text:"0",style:c}},{type:"text",name:"distortionAmount_50",data:{x:20,y:7.5,text:"50",style:c}},{type:"text",name:"distortionAmount_100",data:{x:33,y:36,text:"100",style:c}},{type:"dial_continuous",name:"distortionAmount_dial",data:{x:22.5,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"resolution_title",
data:{x:47,y:66,text:"res",style:b}},{type:"text",name:"resolution_2",data:{x:39,y:60,text:"2",style:c}},{type:"text",name:"resolution_50",data:{x:49,y:32,text:"500",style:c}},{type:"text",name:"resolution_100",data:{x:63,y:60,text:"1000",style:c}},{type:"dial_continuous",name:"resolution_dial",data:{x:52.5,y:47.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"overSample_title",
data:{x:67,y:41.5,text:"overSamp",style:b}},{type:"text",name:"overSample_0",data:{x:61,y:12,text:"none",style:c}},{type:"text",name:"overSample_50",data:{x:77.5,y:7.5,text:"2x",style:c}},{type:"text",name:"overSample_100",data:{x:90.5,y:12,text:"4x",style:c}},{type:"dial_discrete",name:"overSample_dial",data:{x:80,y:23,r:12,startAngle:1.25*Math.PI,maxAngle:.5*Math.PI,arcDistance:1.35,optionCount:3,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",
name:"inGain_title",data:{x:76,y:91,text:"in",style:b}},{type:"text",name:"inGain_0",data:{x:67,y:85.5,text:"0",style:c}},{type:"text",name:"inGain_1/2",data:{x:76.5,y:57,text:"1/2",style:c}},{type:"text",name:"inGain_1",data:{x:90.5,y:85.5,text:"1",style:c}},{type:"dial_continuous",name:"inGain_dial",data:{x:80,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});h.importData=function(a){h.elements.dial_continuous.outGain_dial.set(a.outGain);
h.elements.dial_continuous.distortionAmount_dial.set(a.distortionAmount);h.elements.dial_continuous.resolution_dial.set(a.resolution);h.elements.dial_discrete.overSample_dial.set(a.overSample);h.elements.dial_continuous.inGain_dial.set(a.inGain)};h.exportData=function(){return{outGain:h.elements.dial_continuous.outGain_dial.get(),distortionAmount:h.elements.dial_continuous.distortionAmount_dial.get(),resolution:h.elements.dial_continuous.resolution_dial.get(),overSample:h.elements.dial_discrete.overSample_dial.get(),
inGain:h.elements.dial_continuous.inGain_dial.get()}};h.distortionCircuit=new g.circuit.alpha.distortionUnit(workspace.library.audio.context);h.elements.connectionNode_audio.audioIn.out().connect(h.distortionCircuit.in());h.distortionCircuit.out().connect(h.elements.connectionNode_audio.audioOut.in());h.elements.dial_continuous.outGain_dial.onchange=function(a){h.distortionCircuit.outGain(a)};h.elements.dial_continuous.distortionAmount_dial.onchange=function(a){h.distortionCircuit.distortionAmount(100*
a)};h.elements.dial_continuous.resolution_dial.onchange=function(a){h.distortionCircuit.resolution(Math.round(1E3*a))};h.elements.dial_discrete.overSample_dial.onchange=function(a){h.distortionCircuit.oversample(["none","2x","4x"][a])};h.elements.dial_continuous.inGain_dial.onchange=function(a){h.distortionCircuit.inGain(2*a)};h.elements.dial_continuous.resolution_dial.set(.5);h.elements.dial_continuous.inGain_dial.set(.5);h.elements.dial_continuous.outGain_dial.set(1);return h};this.distortionUnit.metadata=
{name:"Distortion Unit",helpURL:"https://metasophiea.com/curve/help/units/alpha/distortionUnit/"}};this.audioFile=new function(){this.recorder=function(d,e,a){function b(a){if("empty"!=g||"save"!=a&&"stop"!=a){if("stop"==a||"save"==a)g="full";"empty"==g&&"rec"==a&&(g="recording");"clear"==a&&(g="empty");"recording"==g&&"pause/resume"==a?g="paused":"paused"!=g||"pause/resume"!=a&&"rec"!=a||(g="recording");if("empty"==g)k.elements.glowbox_rect.activityLight_empty.on();else k.elements.glowbox_rect.activityLight_empty.off();
if("recording"==g)k.elements.glowbox_rect.activityLight_recording.on();else k.elements.glowbox_rect.activityLight_recording.off();if("paused"==g)k.elements.glowbox_rect.activityLight_paused.on();else k.elements.glowbox_rect.activityLight_paused.off();if("full"==g)k.elements.glowbox_rect.activityLight_full.on();else k.elements.glowbox_rect.activityLight_full.off()}}var c={fill:"rgba(0,0,0,1)",font:"4pt Courier New"},f={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",
background__hover_press__fill:"rgba(150,150,150,1)"},k=workspace._interface.unit.alpha.builder(this.recorder,{name:"recorder",category:"audioFile",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:175,y:0},{x:175,y:40},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:175,y:0},{x:175,y:40},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"inRight",data:{x:175,y:2.5,width:10,height:15}},{type:"connectionNode_audio",name:"inLeft",data:{x:175,
y:22.5,width:10,height:15}},{type:"rectangle",name:"logo_rect",data:{x:135,y:27.5,angle:-.25,width:35,height:10,style:{fill:"rgb(230,230,230)"}}},{type:"text",name:"logo_label",data:{x:139,y:34.5,angle:-.25,text:"REcorder",style:{fill:"rgba(100,100,100,1)",font:"6pt Bookman"}}},{type:"button_rect",name:"rec",data:{x:5,y:25,width:20,height:10,style:f,onpress:function(){"paused"==g?k.recorder.resume():k.recorder.start();b("rec")}}},{type:"text",name:"button_rect_text",data:{x:10.5,y:31.5,text:"rec",
angle:0,style:c}},{type:"button_rect",name:"pause/resume",data:{x:27.5,y:25,width:20,height:10,style:f,onpress:function(){"paused"==g?k.recorder.resume():k.recorder.pause();b("pause/resume")}}},{type:"text",name:"button_pause/resume_text",data:{x:30,y:31.5,text:"pause",angle:0,style:c}},{type:"button_rect",name:"stop",data:{x:50,y:25,width:20,height:10,style:f,onpress:function(){b("stop");k.recorder.stop()}}},{type:"text",name:"button_stop_text",data:{x:54,y:31.5,text:"stop",angle:0,style:c}},{type:"button_rect",
name:"save",data:{x:72.5,y:25,width:20,height:10,style:f,onpress:function(){b("save");"empty"!=g&&k.recorder.save()}}},{type:"text",name:"button_save_text",data:{x:76.5,y:31.5,text:"save",angle:0,style:c}},{type:"button_rect",name:"clear",data:{x:95,y:25,width:20,height:10,style:f,onpress:function(){b("clear");k.recorder.clear()}}},{type:"text",name:"button_clear_text",data:{x:97.5,y:31.5,text:"clear",angle:0,style:c}},{type:"readout_sixteenSegmentDisplay__static",name:"time",data:{x:70,y:5,angle:0,
width:100,height:15,count:11,style:{background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"}}},{type:"glowbox_rect",name:"activityLight_recording",data:{x:5,y:5,width:15,height:15,style:{glow:"rgb(255, 63, 63)",dim:"rgb(25, 6, 6)"}}},{type:"text",name:"activityLight_recording_text",data:{x:8,y:14,text:"rec",angle:0,style:c}},{type:"glowbox_rect",name:"activityLight_paused",data:{x:20,y:5,width:15,height:15,style:{glow:"rgb(126, 186, 247)",dim:"rgb(12, 18, 24)"}}},{type:"text",name:"activityLight_paused_text",
data:{x:23,y:14,text:"pau",angle:0,style:c}},{type:"glowbox_rect",name:"activityLight_empty",data:{x:35,y:5,width:15,height:15,style:{glow:"rgb(199, 249, 244)",dim:"rgb(19, 24, 24)"}}},{type:"text",name:"activityLight_empty_text",data:{x:38,y:14,text:"emp",angle:0,style:c}},{type:"glowbox_rect",name:"activityLight_full",data:{x:50,y:5,width:15,height:15,style:{glow:"rgb(61, 224, 35)",dim:"rgb(6, 22, 3)"}}},{type:"text",name:"activityLight_full_text",data:{x:53,y:14,text:"ful",angle:0,style:c}}]});
setInterval(function(){var a=k.recorder.recordingTime(),b=a%1;a=workspace.library.math.seconds2time(Math.round(a));k.elements.readout_sixteenSegmentDisplay__static.time.text(workspace.library.misc.padString(a.h,2,"0")+":"+workspace.library.misc.padString(a.m,2,"0")+":"+workspace.library.misc.padString(a.s,2,"0")+"."+workspace.library.misc.padString((""+b).slice(2),2,"0"));k.elements.readout_sixteenSegmentDisplay__static.time.print()},100);var g="empty";b("clear");k.elements.glowbox_rect.activityLight_empty.on();
k.recorder=new workspace._interface.circuit.alpha.recorder(workspace.library.audio.context);k.elements.connectionNode_audio.inRight.out().connect(k.recorder.in_right());k.elements.connectionNode_audio.inLeft.out().connect(k.recorder.in_left());return k};this.recorder.metadata={name:"Recorder",helpURL:"https://metasophiea.com/curve/help/units/alpha/recorder/"};this.looper=function(d,e,a){var b={fill:"rgba(200,200,200,1)"},c={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},f=workspace._interface.unit.alpha.builder(this.looper,
{name:"looper",category:"audioFile",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:b}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,
height:20,onreceive:function(a,b){f.elements.button_rect.fire.press()}}},{type:"circle",name:"symbol_outterCircle1",data:{x:11.5,y:41,r:6,style:c}},{type:"circle",name:"symbol_outterCircle2",data:{x:18.5,y:41,r:6,style:c}},{type:"rectangle",name:"symbol_blockingrect",data:{x:11.5,y:34,width:7,height:15,style:b}},{type:"path",name:"symbol_upperarrow",data:{points:[{x:13.5,y:32.5},{x:16.5,y:35},{x:13.5,y:37.5}],style:c}},{type:"path",name:"symbol_lowerarrow",data:{points:[{x:16.5,y:44.75},{x:13.5,y:47.25},
{x:16.5,y:49.75}],style:c}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){f.looper.load("file",function(a){f.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(f.looper.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(175,195,175,1)",
background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){if(!(0>f.looper.duration())){f.looper.start();var a=f.looper.duration();k&&(f.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n),clearTimeout(g));l=void 0;n=0;var b=Math.floor(a),c=b/(1E3*a);g=setInterval(function(){void 0!=l&&f.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n);l=n;n+=c;f.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n);1<n&&(f.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n),
n=0,l=void 0)},b);k=!0}}}},{type:"button_rect",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){f.looper.stop();k&&(f.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n),k=!1,n=void 0,clearTimeout(g))}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]}),
k=!1,g=void 0,n=void 0,l=void 0;f.looper=new workspace._interface.circuit.alpha.looper(workspace.library.audio.context);f.looper.out_right().connect(f.elements.connectionNode_audio.outRight.in());f.looper.out_left().connect(f.elements.connectionNode_audio.outLeft.in());return f};this.looper.metadata={name:"Looper",helpURL:"https://metasophiea.com/curve/help/units/alpha/looper/"};this.oneShot_single=function(d,e,a){var b={fill:"rgba(150,150,150,1)"},c={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",
lineWidth:1},h=f.builder(this.oneShot_single,{name:"oneShot_single",category:"audioFile",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},
{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,onreceive:function(a,b){h.elements.button_rect.fire.press();h.elements.button_rect.fire.release()}}},{type:"path",name:"symbol_arrow",data:{points:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:c}},{type:"rectangle",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:b}},{type:"circle",name:"symbol_outerCircle",data:{x:10,y:40,r:5.5,style:c}},{type:"rectangle",name:"symbol_1",data:{x:9.5,y:37.5,width:1,height:5,
style:b}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){h.oneShot.load("file",function(a){h.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(h.oneShot.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:20,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",
background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){if(!(0>h.oneShot.duration())){h.oneShot.fire();var a=h.oneShot.duration();k&&(h.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n),clearTimeout(g));l=void 0;n=0;var b=10/(1E3*a);g=setInterval(function(){void 0!=l&&h.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n);l=n;n+=b;h.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n);1<n&&(h.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(n),n=
0,l=void 0,clearInterval(g))},10);k=!0}}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]}),k=void 0,g=void 0,n=void 0,l=void 0;h.oneShot=new workspace._interface.circuit.alpha.oneShot_single(workspace.library.audio.context);h.oneShot.out_right().connect(h.elements.connectionNode_audio.outRight.in());h.oneShot.out_left().connect(h.elements.connectionNode_audio.outLeft.in());return h};this.oneShot_single.metadata={name:"One Shot (Single)",
helpURL:"https://metasophiea.com/curve/help/objects/units/oneShot_single/"};this.oneShot_multi=function(d,e,a){var b={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},c=f.builder(this.oneShot_multi,{name:"oneShot_multi",category:"audioFile",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",
name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,onreceive:function(a,b){c.elements.button_rect.fire.press();c.elements.button_rect.fire.release()}}},{type:"path",name:"symbol_arrow",data:{points:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:b}},{type:"rectangle",name:"symbol_line",data:{x:15,y:39.5,
width:6,height:1,style:{fill:"rgba(150,150,150,1)"}}},{type:"circle",name:"symbol_outterCircle",data:{x:10,y:40,r:5.5,style:b}},{type:"circle",name:"symbol_infCircle1",data:{x:8.5,y:40,r:1.5,style:b}},{type:"circle",name:"symbol_infCircle2",data:{x:11.5,y:40,r:1.5,style:b}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){c.oneShot.load("file",
function(a){c.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(c.oneShot.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){var a=c.oneShot,b=c.elements.grapher_waveWorkspace.grapher_waveWorkspace;if(!(0>a.duration())){var d=void 0!=b.area().A?b.area().A:0,e=void 0!=b.area().B?b.area().B:
1,f=a.duration();d*=f;e=e*f-d;a.fire(d,e);for(var g=0;g in h;)g++;h[g]={};c.elements.glowbox_rect.glowbox_rect.on();setTimeout(function(){c.elements.glowbox_rect.glowbox_rect.off()},100);h[g].previousPosition=void 0;h[g].currentPosition=d/f;h[g].endPosition=d/f+e/f;var q=10/(1E3*e);h[g].needleInterval=setInterval(function(){void 0!=h[g].previousPosition&&b.mark(h[g].currentPosition);h[g].previousPosition=h[g].currentPosition;h[g].currentPosition+=q;b.mark(h[g].currentPosition);h[g].currentPosition>
h[g].endPosition&&(b.mark(h[g].currentPosition),clearInterval(h[g].needleInterval))},10)}}}},{type:"button_rect",name:"panic",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){var a=c.elements.grapher_waveWorkspace.grapher_waveWorkspace;c.oneShot.panic();for(var b=Object.keys(h),d=0;d<b.length;d++)void 0!=h[d]&&(clearTimeout(h[d].needleInterval),
delete h[d]);a.removeAllMarks()}}},{type:"slide",name:"rate",data:{x:26.25,y:5,width:5,height:45,value:.5,resetValue:.5,style:{handle:"rgba(220,220,220,1)"},onchange:function(a){c.oneShot.rate(2*(1-a))}}},{type:"glowbox_rect",name:"glowbox_rect",data:{x:32.5,y:5,width:2.5,height:45}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:35,y:5,width:180,height:45,selectNeedle:!1,selectionArea:!0}}]}),h=[];c.oneShot=new workspace._interface.circuit.alpha.oneShot_multi(workspace.library.audio.context);
c.oneShot.out_right().connect(c.elements.connectionNode_audio.outRight.in());c.oneShot.out_left().connect(c.elements.connectionNode_audio.outLeft.in());c.i={};c.i.loadURL=function(a,b){c.oneShot.load("url",function(){c.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(c.oneShot.waveformSegment());void 0!=b&&b()},a)};c.i.area=function(a,b){c.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(a,b)};return c};this.oneShot_multi.metadata={name:"One Shot (Multi)",helpURL:"https://metasophiea.com/curve/help/units/alpha/oneShot_multi/"};
this.oneShot_multi_multiTrack=function(d,e,a){var b={fill:"rgba(150,150,150,1)"},c={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},h={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},k={background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},g={background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",
background__hover_press__fill:"rgba(170,150,150,1)"},n={handle:"rgba(220,220,220,1)"};d={name:"oneShot_multi_multiTrack",category:"audioFile",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",
data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}}]};for(a=0;8>a;a++)d.elements=d.elements.concat([{type:"path",name:"symbol_"+a+"_arrow",data:{points:[{x:19,y:35+47*a},{x:25,y:40+47*a},{x:19,y:45+47*a}],style:c}},{type:"rectangle",name:"symbol_"+a+"_line",data:{x:15,y:39.5+47*a,width:6,height:1,style:b}},{type:"circle",name:"symbol_"+a+"l_outerCircle",data:{x:10,y:40+47*a,r:5.5,style:c}},{type:"circle",name:"symbol_"+a+"_infCircle1",data:{x:8.5,y:40+47*a,r:1.5,style:c}},{type:"circle",name:"symbol_"+
a+"_infCircle2",data:{x:11.5,y:40+47*a,r:1.5,style:c}}]),d.elements.push({type:"slide",name:"rate_"+a,data:{x:26.25,y:5+47*a,width:5,height:45,value:.5,resetValue:.5,style:n,onchange:function(a){return function(b){l.oneShot_multi_array[a].rate(2*(1-b))}}(a)}}),d.elements.push({type:"glowbox_rect",name:"glowbox_rect_"+a,data:{x:32.5,y:5+47*a,width:2.5,height:45}}),d.elements.push({type:"grapher_waveWorkspace",name:"grapher_waveWorkspace_"+a,data:{x:35,y:5+47*a,width:180,height:45,selectNeedle:!1,selectionArea:!0}}),
d.elements.push({type:"button_rect",name:"loadFile_"+a,data:{x:5,y:5+47*a,width:20,height:10,style:h,onpress:function(a){return function(){l.oneShot_multi_array[a].load("file",function(a){return function(b){l.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a].draw(l.oneShot_multi_array[a].waveformSegment())}}(a))}}(a)}}),d.elements.push({type:"button_rect",name:"fire_"+a,data:{x:5,y:17.5+47*a,width:10,height:10,style:k,onpress:function(a){return function(){var b=l.oneShot_multi_array[a],c=
l.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a],d=l.players[a];if(!(0>b.duration())){var e=void 0!=c.area().A?c.area().A:0,f=void 0!=c.area().B?c.area().B:1;if(e>f){var h=e;e=f;f=h}h=b.duration();e*=h;f=f*h-e;b.fire(e,f);for(var k=0;k in d;)k++;d[k]={};l.elements.glowbox_rect["glowbox_rect_"+a].on();setTimeout(function(a){return function(){l.elements.glowbox_rect["glowbox_rect_"+a].off()}}(a),100);d[k].previousPosition=void 0;d[k].currentPosition=e/h;d[k].endPosition=e/h+f/h;var g=10/
(1E3*f);d[k].needleInterval=setInterval(function(){void 0!=d[k].previousPosition&&c.mark(d[k].currentPosition);d[k].previousPosition=d[k].currentPosition;d[k].currentPosition+=g;c.mark(d[k].currentPosition);d[k].currentPosition>d[k].endPosition&&(c.mark(d[k].currentPosition),clearInterval(d[k].needleInterval))},10)}}}(a)}}),d.elements.push({type:"button_rect",name:"panic_"+a,data:{x:15,y:17.5+47*a,width:10,height:10,style:g,onpress:function(a){return function(b){b=l.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+
a];var c=l.players[a];l.oneShot_multi_array[a].panic();for(var d=Object.keys(c),e=0;e<d.length;e++)void 0!=c[e]&&(clearTimeout(c[e].needleInterval),delete c[e]);b.removeAllMarks()}}(a)}}),d.elements.push({type:"connectionNode_data",name:"trigger_"+a,data:{x:220,y:17.5+47*a,width:10,height:20,onreceive:function(a){return function(b,c){"pulse"==b?(l.elements.button_rect["fire_"+a].press(),l.elements.button_rect["fire_"+a].release()):"hit"==b&&.49<c.velocity&&(l.elements.button_rect["fire_"+a].press(),
l.elements.button_rect["fire_"+a].release())}}(a)}});var l=f.builder(this.oneShot_multi_multiTrack,d);l.exportData=function(){for(var a={tracks:[],areas:[]},b=0;8>b;b++)a.tracks.push(l.oneShot_multi_array[b].unloadRaw()),a.areas.push(l.i.area(b));return a};l.importData=function(a){for(var b=0;8>b;b++)l.i.loadRaw(b,a.tracks[b]),l.i.area(b,a.areas[b].A,a.areas[b].B)};l.players=[];l.oneShot_multi_array=[];for(a=0;8>a;a++)l.oneShot_multi_array.push(new workspace._interface.circuit.alpha.oneShot_multi(workspace.library.audio.context)),
l.oneShot_multi_array[a].out_right().connect(l.elements.connectionNode_audio.outRight.in()),l.oneShot_multi_array[a].out_left().connect(l.elements.connectionNode_audio.outLeft.in()),l.players.push([]);l.i={loadURL:function(a,b,c){l.oneShot_multi_array[a].load("url",function(a){return function(){document.getElementById("oneShot_multi_multiTrack").children["grapher_waveWorkspace_"+a].draw(document.getElementById("oneShot_multi_multiTrack").oneShot_multi_array[a].waveformSegment())}}(a),b)},loadRaw:function(a,
b){l.oneShot_multi_array[a].loadRaw(b);l.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a].draw(l.oneShot_multi_array[a].waveformSegment())},area:function(a,b,c){return l.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a].area(b,c)}};return l};this.oneShot_multi_multiTrack.metadata={name:"One Shot (Multi)(8 Track)",helpURL:"https://metasophiea.com/curve/help/units/alpha/oneShot_multi_multiTrack/"};this.player=function(d,e,a){function b(a){m.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(m.player.waveformSegment());
m.elements.grapher_waveWorkspace.grapher_waveWorkspace.select(0);m.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(-1,-1);m.elements.readout_sixteenSegmentDisplay__static.trackNameReadout.text(a.name);m.elements.readout_sixteenSegmentDisplay__static.trackNameReadout.print("smart")}var c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},h={fill:"rgba(150,150,150,1)"},k={background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"},m=f.builder(this.player,{name:"player",category:"audioFile",
collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:220,y:0},{x:220,y:80},{x:0,y:80}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:80},{x:0,y:80}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"rectangle",name:"symbol_line1",data:{x:3.5,y:38.5,width:1,height:2,style:h}},
{type:"rectangle",name:"symbol_line2",data:{x:5.5,y:37,width:1,height:5,style:h}},{type:"rectangle",name:"symbol_line3",data:{x:7.5,y:35.5,width:1,height:8,style:h}},{type:"rectangle",name:"symbol_line4",data:{x:9.5,y:34.5,width:1,height:10,style:h}},{type:"rectangle",name:"symbol_line5",data:{x:11.5,y:35.5,width:1,height:8,style:h}},{type:"rectangle",name:"symbol_line6",data:{x:13.5,y:37,width:1,height:5,style:h}},{type:"rectangle",name:"symbol_line7",data:{x:15.5,y:39,width:1,height:1,style:h}},
{type:"rectangle",name:"symbol_line8",data:{x:17.5,y:36,width:1,height:7,style:h}},{type:"rectangle",name:"symbol_line9",data:{x:19.5,y:32,width:1,height:15,style:h}},{type:"rectangle",name:"symbol_line10",data:{x:21.5,y:34.5,width:1,height:10,style:h}},{type:"rectangle",name:"symbol_line11",data:{x:23.5,y:37,width:1,height:5,style:h}},{type:"rectangle",name:"symbol_line12",data:{x:25.5,y:38.5,width:1,height:2,style:h}},{type:"readout_sixteenSegmentDisplay__static",name:"trackNameReadout",data:{x:30,
y:5,angle:0,width:100,height:20,count:10,style:k}},{type:"readout_sixteenSegmentDisplay__static",name:"time",data:{x:135,y:5,angle:0,width:80,height:20,count:8,style:k}},{type:"button_rect",name:"load",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){m.i.loadByFile()}}},{type:"button_rect",name:"start",data:{x:5,y:17.5,width:20,height:10,style:{background__up__fill:"rgba(175,195,175,1)",
background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){m.player.start()}}},{type:"button_rect",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){m.player.stop()}}},{type:"text",name:"rate_label_name",data:{x:8.5,y:79,text:"rate",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},
{type:"text",name:"rate_label_0",data:{x:5,y:75,text:"0",style:c}},{type:"text",name:"rate_label_1",data:{x:13.7,y:54,text:"1",style:c}},{type:"text",name:"rate_label_2",data:{x:23,y:75,text:"2",style:c}},{type:"dial_continuous",name:"rate_dial",data:{x:15,y:65,r:9,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,resetValue:.5}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:30,width:185,height:45,selectionArea:!1,selectionAreaToggle:function(a){m.player.loop({active:a})}}}]});
m.player=new g.circuit.alpha.player(workspace.library.audio.context);m.player.out_right().connect(m.elements.connectionNode_audio.outRight.in());m.player.out_left().connect(m.elements.connectionNode_audio.outLeft.in());setInterval(function(){if(m.player.isLoaded()){var a=workspace.library.math.seconds2time(Math.round(m.player.currentTime()));m.elements.readout_sixteenSegmentDisplay__static.time.text(workspace.library.misc.padString(a.h,2,"0")+":"+workspace.library.misc.padString(a.m,2,"0")+":"+workspace.library.misc.padString(a.s,
2,"0"));m.elements.readout_sixteenSegmentDisplay__static.time.print();m.elements.grapher_waveWorkspace.grapher_waveWorkspace.select(m.player.progress(),!1)}},1E3/30);m.exportData=function(){return{track:m.player.unloadRaw()}};m.importData=function(a){m.i.loadRaw(a.track)};m.elements.dial_continuous.rate_dial.onchange=function(a){m.player.rate(2*a)};m.elements.grapher_waveWorkspace.grapher_waveWorkspace.onchange=function(a,b){if("lead"==a)m.player.jumpTo(b);else if("selection_A"==a||"selection_B"==
a)a=m.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(),a.A<a.B?m.player.loop({start:a.A,end:a.B}):m.player.loop({start:a.B,end:a.A})};m.i={loadRaw:function(a){m.player.loadRaw(a,b)},loadByFile:function(){m.player.load("file",b)},loadByURL:function(a){m.player.load("url",b,a)}};m.elements.dial_continuous.rate_dial.set(.5);return m};this.player.metadata={name:"Player",helpURL:"https://metasophiea.com/curve/help/units/alpha/player/"}};this.humanInputDevices=new function(){this.audioIn=function(d,
e,a,b){function c(a){if(0==h.deviceList.length)p.elements.readout_sixteenSegmentDisplay__static.index.text(" n/a"),p.elements.readout_sixteenSegmentDisplay__static.index.print(),p.elements.readout_sixteenSegmentDisplay__static.text.text("no devices"),p.elements.readout_sixteenSegmentDisplay__static.text.print("smart");else if(!(0>a||a>=h.deviceList.length)){h.currentSelection=a;for(selectionNum=""+(a+1);2>selectionNum.length;)selectionNum="0"+selectionNum;for(totalNum=""+h.deviceList.length;2>totalNum.length;)totalNum=
"0"+totalNum;p.elements.readout_sixteenSegmentDisplay__static.index.text(selectionNum+"/"+totalNum);p.elements.readout_sixteenSegmentDisplay__static.index.print();var b=h.deviceList[a].deviceId;0<h.deviceList[a].label.length&&(b=h.deviceList[a].label+" - "+b);p.elements.readout_sixteenSegmentDisplay__static.text.text(b);p.elements.readout_sixteenSegmentDisplay__static.text.print("smart");p.circuitry.unit.selectDevice(h.deviceList[a].deviceId)}}b=void 0===b?!0:b;var h={deviceList:[],currentSelection:0},
k={stroke:"rgb(160,160,160)",lineWidth:1},m={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},n={background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"},l={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(230,230,230,1)",background__hover_press__fill:"rgba(180,180,180,1)"},p=f.builder(this.audioIn,{name:"audioIn",category:"humanInputDevices",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},
{x:50,y:40},{x:37.5,y:50},{x:22.5,y:50},{x:10,y:40},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},{x:50,y:40},{x:37.5,y:50},{x:22.5,y:50},{x:10,y:40},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:15,width:10,height:20,isAudioOutput:!0}},{type:"readout_sixteenSegmentDisplay__static",name:"index",data:{x:70,y:15,angle:0,width:50,height:20,
count:5,style:n}},{type:"readout_sixteenSegmentDisplay__static",name:"text",data:{x:122.5,y:15,angle:0,width:100,height:20,count:10,style:n}},{type:"button_rect",name:"up",data:{x:225,y:15,width:15,height:10,selectable:!1,style:l,onpress:function(){c(h.currentSelection+1)}}},{type:"button_rect",name:"down",data:{x:225,y:25,width:15,height:10,selectable:!1,style:l,onpress:function(){c(h.currentSelection-1)}}},{type:"text",name:"gainLabel_name",data:{x:21.25,y:44,text:"gain",style:{fill:"rgba(0,0,0,1)",
font:"5pt Courier New"},angle:0}},{type:"text",name:"gainLabel_0",data:{x:17,y:39,text:"0",style:m,angle:0}},{type:"text",name:"gainLabel_1",data:{x:28.75,y:10,text:"1",style:m,angle:0}},{type:"text",name:"gainLabel_2",data:{x:40.5,y:39,text:"2",style:m,angle:0}},{type:"dial_continuous",name:"outputGain",data:{x:30,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},resetValue:.5}},{type:"path",name:"upArrow",
data:{points:[{x:227.5,y:22.5},{x:232.5,y:17.5},{x:237.5,y:22.5}],style:k}},{type:"path",name:"downArrow",data:{points:[{x:227.5,y:27.5},{x:232.5,y:32.5},{x:237.5,y:27.5}],style:k}},{type:"audio_meter_level",name:"audioIn",data:{x:50,y:15,width:17.5,height:20}}]});p.onkeydown=function(a,b,c){switch(c.key){case "ArrowUp":p.elements.button_rect.up.press();break;case "ArrowDown":p.elements.button_rect.down.press();break;case "ArrowLeft":p.elements.dial_continuous.outputGain.set(p.elements.dial_continuous.outputGain.get()-
.1);break;case "ArrowRight":p.elements.dial_continuous.outputGain.set(p.elements.dial_continuous.outputGain.get()+.1)}};p.circuitry={unit:new g.circuit.alpha.audioIn(workspace.library.audio.context,b)};p.circuitry.unit.out().connect(p.elements.connectionNode_audio.audioOut.in());p.circuitry.unit.out().connect(p.elements.audio_meter_level.audioIn.audioIn());p.elements.dial_continuous.outputGain.onchange=function(a){p.circuitry.unit.gain(2*a)};p.circuitry.unit.listDevices(function(a){h.deviceList=a});
b&&setTimeout(function(){c(0)},500);p.elements.dial_continuous.outputGain.set(.5);p.elements.audio_meter_level.audioIn.start();return p};this.audioIn.metadata={name:"Audio Input",helpURL:"https://metasophiea.com/curve/help/units/alpha/audioInput/"};this.musicalKeyboard=function(d,e,a){var b=.5,c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},h={background__up__fill:"rgba(250,250,250,1)",background__press__fill:"rgba(230,230,230,1)",background__glow__fill:"rgba(220,200,220,1)",background__glow_press__fill:"rgba(200,150,200,1)"},
k={background__up__fill:"rgba(50,50,50,1)",background__press__fill:"rgba(100,100,100,1)",background__glow__fill:"rgba(220,200,220,1)",background__glow_press__fill:"rgba(200,150,200,1)"};d={name:"musicalKeyboard",category:"humanInputDevices",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},{x:0,y:62.5}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},{x:0,y:62.5}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",
name:"midiout",data:{x:-5,y:5,width:5,height:10}},{type:"connectionNode_data",name:"midiin",data:{x:320,y:5,width:5,height:10,onreceive:function(a,b){"midinumber"==a&&(0<b.velocity?l.elements.button_rect[workspace.library.audio.num2name(b.num)].press():l.elements.button_rect[workspace.library.audio.num2name(b.num)].release())}}},{type:"text",name:"velocity_title",data:{x:5,y:59,text:"velocity",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},{type:"text",name:"velocity_0",data:{x:4,y:55,text:"0",
style:c}},{type:"text",name:"velocity_1/2",data:{x:14,y:26.5,text:"1/2",style:c}},{type:"text",name:"velocity_1",data:{x:29,y:55,text:"1",style:c}},{type:"dial_continuous",name:"velocity_dial",data:{x:17.5,y:42,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,resetValue:.5,value:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},onchange:function(a){b=a}}}]};var g="\\azsxcfvgbhnmk,l./1q2w3er5t6yu8i9o0p[".split(""),n="4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C".split(" ");
c=35;e=45;for(a=0;a<g.length;a++)"#"!=n[a].slice(-1)&&(d.elements.push({type:"button_rect",name:n[a],data:{x:c,y:12.5,width:12.5,height:50,hoverable:!1,style:h,onpress:function(){l.io.data.midiout.send("midinumber",{num:workspace.library.audio.name2num(this.name),velocity:b})},onrelease:function(){l.io.data.midiout.send("midinumber",{num:workspace.library.audio.name2num(this.name),velocity:0})}}}),c+=12.5);for(a=h=0;a<g.length;a++)"#"==n[a].slice(-1)?(d.elements.push({type:"button_rect",name:n[a],
data:{x:e,y:12.5,width:5,height:30,hoverable:!1,style:k,onpress:function(){l.io.data.midiout.send("midinumber",{num:workspace.library.audio.name2num(this.name),velocity:b})},onrelease:function(){l.io.data.midiout.send("midinumber",{num:workspace.library.audio.name2num(this.name),velocity:0})}}}),e+=12.5,h=0):h++,1<h&&(e+=12.5);var l=f.builder(this.musicalKeyboard,d);l.onkeydown=function(a,b,c){g.includes(c.key)&&l.elements.button_rect[n[g.indexOf(c.key)]].press()};l.onkeyup=function(a,b,c){g.includes(c.key)&&
l.elements.button_rect[n[g.indexOf(c.key)]].release()};l.i={velocity:function(a){l.elements.dial_continuous.velocity.set(a)}};return l};this.musicalKeyboard.metadata={name:"Musical Keyboard",helpURL:"https://metasophiea.com/curve/help/units/alpha/musicalKeyboard/"}};this.humanOutputDevices=new function(){this.audioScope=function(d,e,a){var b={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},c=f.builder(this.audioScope,{name:"audioScope",category:"humanOutputDevices",collection:"alpha",x:d,y:e,a:a,space:[{x:0,
y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"input",data:{x:195,y:5,width:10,height:20}},{type:"grapher_audioScope__static",name:"waveport",data:{x:5,y:5,width:150,height:100}},{type:"button_rect",name:"holdKey",data:{x:160,y:5,width:30,height:20,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(190,190,190,1)",
background__hover_press__fill:"rgba(170,170,170,1)"}}},{type:"text",name:"framerate_name",data:{x:161.5,y:68,text:"framerate",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},{type:"text",name:"framerate_1",data:{x:162,y:62,text:"1",style:b}},{type:"text",name:"framerate_15",data:{x:172.5,y:32,text:"15",style:b}},{type:"text",name:"framerate_30",data:{x:186,y:62,text:"30",style:b}},{type:"dial_continuous",name:"framerate",data:{x:175,y:47.5,r:12,resetValue:.5,style:{handle:"rgba(220,220,220,1)",
slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});c.elements.button_rect.holdKey.onpress=function(){c.elements.grapher_audioScope__static.waveport.stop()};c.elements.button_rect.holdKey.onrelease=function(){c.elements.grapher_audioScope__static.waveport.start()};c.elements.connectionNode_audio.input.out().connect(c.elements.grapher_audioScope__static.waveport.getNode());c.elements.dial_continuous.framerate.onchange=function(a){c.elements.grapher_audioScope__static.waveport.refreshRate(1+
Math.floor(29*a))};c.elements.grapher_audioScope__static.waveport.start();c.elements.dial_continuous.framerate.set(0);return c};this.audioScope.metadata={name:"Audio Scope",helpURL:"https://metasophiea.com/curve/help/units/alpha/audioScope/"};this.audioSink=function(d,e,a){var b={backing:"rgba(10,10,10,1)",levels:["rgb(250,250,250)","rgb(200,200,200)"],markingStyle_fill:"rgba(220,220,220,1)",markingStyle_font:"1pt Courier New"};d=f.builder(this.audioSink,{name:"audioSink",category:"humanOutputDevices",
collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:30,y:0},{x:30,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:30,y:0},{x:30,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioInput_right",data:{x:30,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"audioInput_left",data:{x:30,y:30,width:10,height:20}},{type:"audio_meter_level",name:"audioLevel_right",data:{x:15,y:5,width:10,height:45,style:b}},{type:"audio_meter_level",
name:"audioLevel_left",data:{x:5,y:5,width:10,height:45,style:b}}]});a=workspace.library.audio.destination;e=new ChannelMergerNode(workspace.library.audio.context,{numberOfInputs:2});d.elements.connectionNode_audio.audioInput_left.out().connect(d.elements.audio_meter_level.audioLevel_left.audioIn());d.elements.connectionNode_audio.audioInput_right.out().connect(d.elements.audio_meter_level.audioLevel_right.audioIn());d.elements.connectionNode_audio.audioInput_left.out().connect(e,0,0);d.elements.connectionNode_audio.audioInput_right.out().connect(e,
0,1);e.connect(a);d.elements.audio_meter_level.audioLevel_left.start();d.elements.audio_meter_level.audioLevel_right.start();return d};this.audioSink.metadata={name:"Audio Sink",helpURL:"https://metasophiea.com/curve/help/units/alpha/audioSink/"}};this.sequencers=new function(){this.basicSequencer=function(d,e,a){var b={stroke:"rgba(150,150,150,1)",lineWidth:1},c={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(240,240,240,1)",background__hover_press__fill:"rgba(180,180,180,1)"};
d={name:"basicSequencer",category:"sequencers",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:{fill:"rgba(200,200,200,1)"}}},{type:"sequencer",name:"main",data:{x:10,y:20,width:780,height:170,xCount:64,yCount:10,event:function(a){for(var b=0;b<a.length;b++)h.elements.connectionNode_data["output_"+
a[b].line].send("hit",{velocity:a[b].strength})},onchangeviewarea:function(a){h.elements.rangeslide.viewselect.set({start:a.left,end:a.right},!1)}}},{type:"rangeslide",name:"viewselect",data:{x:10,y:20,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:1,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",invisibleHandle:"rgba(0,0,0,0)",span:"rgba(220,220,220,1)"}}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,
style:{backing:"rgba(229, 229, 229,1)",check:"rgba(252,252,252,1)"},onchange:function(a){h.elements.sequencer.main.automove(a)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"rgba(229, 221, 112,1)",check:"rgba(252,244,128,1)"},onchange:function(a){h.elements.sequencer.main.loopActive(a)}}},{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:.75,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",
slot:"rgba(50,50,50,1)",span:"rgba(255,247,145,0.5)"}}},{type:"connectionNode_data",name:"progress_input",data:{x:800,y:5,width:5,height:20,onreceive:function(){h.elements.sequencer.main.progress()}}},{type:"button_rect",name:"progress_button",data:{x:10,y:205,width:25,height:15,style:c,onpress:function(){h.elements.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{points:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:b}},{type:"connectionNode_data",name:"reset_input",data:{x:800,
y:30,width:5,height:20,onreceive:function(){h.elements.sequencer.main.playheadPosition(0)}}},{type:"button_rect",name:"reset_button",data:{x:40,y:205,width:25,height:15,style:c,onpress:function(){h.elements.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{points:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:b}},{type:"path",name:"reset_line",data:{points:[{x:49,y:209},{x:49,y:216}],style:b}}]};for(a=0;10>a;a++)d.elements.push({type:"connectionNode_data",name:"output_"+
a,data:{x:-5,y:11+18*a,width:5,height:16,onreceive:function(){h.elements.sequencer.main.playheadPosition(0)}}});var h=f.builder(this.basicSequencer,d);h.elements.rangeslide.viewselect.onchange=function(a){h.elements.sequencer.main.viewarea({topLeft:{x:a.start,y:0},bottomRight:{x:a.end,y:1}},!1)};h.elements.rangeslide.loopSelect.onchange=function(a){var b=Math.round(64*a.start);a=Math.round(64*a.end);0==a&&(a=1);h.elements.sequencer.main.loopPeriod(b,a)};h.exportData=function(){return{loop:{active:h.elements.checkbox_rect.loopActive.get(),
range:h.elements.rangeslide.loopSelect.get()},autofollow:h.elements.checkbox_rect.followPlayhead.get(),notes:h.elements.sequencer.main.getAllSignals(),viewarea:{horizontal:h.elements.rangeslide.viewselect.get()}}};h.importData=function(a){h.elements.sequencer.main.addSignals(a.notes);h.i.loopActive(a.loop.active);h.elements.rangeslide.loopSelect.set(a.loop.range);h.elements.checkbox_rect.followPlayhead.set(a.autofollow);h.elements.rangeslide.viewselect.set(a.viewarea.horizontal)};h.i={addNote:function(a,
b,c,d){h.elements.sequencer.main.addSignal(a,b,c,void 0===d?1:d)},addNotes:function(a){h.elements.sequencer.main.addSignal(a)},getNotes:function(){return h.elements.sequencer.main.getAllSignals()},loopActive:function(a){h.elements.checkbox_rect.loopActive.set(a)},step:h.elements.sequencer.step};return h};this.basicSequencer.metadata={name:"Basic Sequencer (Multi Pulse Out)",helpURL:"https://metasophiea.com/curve/help/units/alpha/basicSequencer_pulseOut/"};this.launchpad=function(d,e,a){function b(){for(var a=
0;a<c.yCount;a++)g.elements.rastorgrid.rastorgrid.light(g.internalCircuits.previousPosition(),a,!1),g.elements.rastorgrid.rastorgrid.light(g.internalCircuits.position(),a,!0)}var c={xCount:8,yCount:8},h={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},k={backing:"rgba(200,175,200,1)",check:"rgba(150,125,150,1)",backingGlow:"rgba(225,175,225,1)",checkGlow:"rgba(200,125,200,1)"};d={name:"launchpad",category:"sequencers",
collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"pulse_input",data:{x:125,y:5,width:5,height:10}},{type:"connectionNode_data",name:"nextPage_input",data:{x:125,y:22.5,width:5,height:10}},{type:"connectionNode_data",name:"prevPage_input",
data:{x:125,y:35,width:5,height:10}},{type:"button_rect",name:"pulse_button",data:{x:100,y:5,width:20,height:10,style:h}},{type:"rectangle",name:"rastorBacking",data:{x:5,y:5,width:90,height:90,style:{fill:k.backing}}},{type:"rastorgrid",name:"rastorgrid",data:{x:5,y:5,width:90,height:90,xCount:c.xCount,yCount:c.yCount,style:k}},{type:"sevenSegmentDisplay",name:"pageNumber",data:{x:100,y:22.5,width:20,height:22.5,style:h}},{type:"button_rect",name:"nextPage",data:{x:102.5,y:17.5,width:15,height:5,
style:h}},{type:"button_rect",name:"prevPage",data:{x:102.5,y:45,width:15,height:5,style:h}}]};for(a=0;a<c.yCount;a++)d.elements.push({type:"connectionNode_data",name:"out_"+a,data:{x:-5,y:12.5*a+2.5,width:5,height:7.5}});var g=f.builder(this.launchpad,d);g.exportData=function(){return{currentPage:g.internalCircuits.page(),data:g.internalCircuits.exportPages()}};g.importData=function(a){void 0!=a.data&&g.internalCircuits.importPages(a.data);a.currentPage&&g.internalCircuits.page(a.currentPage)};g.internalCircuits=
new this.launchpad.sequencer(c.xCount,c.yCount);g.internalCircuits.commands=function(a){for(var b=0;b<c.yCount;b++)a[b]&&g.io["out_"+b].send("pulse")};g.internalCircuits.pageChange=function(a){g.elements.sevenSegmentDisplay.pageNumber.enterCharacter(""+a);a=g.internalCircuits.exportPage();void 0==a?g.elements.rastorgrid.rastorgrid.clear():g.elements.rastorgrid.rastorgrid.set(a)};g.elements.connectionNode_data.pulse_input.onreceive=function(){g.internalCircuits.inc();b()};g.elements.connectionNode_data.nextPage_input.onreceive=
function(){g.internalCircuits.incPage()};g.elements.connectionNode_data.prevPage_input.onreceive=function(){g.internalCircuits.decPage()};g.elements.button_rect.pulse_button.onreceive=function(){g.internalCircuits.inc();b()};g.elements.rastorgrid.rastorgrid.onchange=function(a){g.internalCircuits.importPage(a)};g.elements.button_rect.nextPage.onpress=function(){g.internalCircuits.incPage()};g.elements.button_rect.prevPage.onpress=function(){g.internalCircuits.decPage()};g.i={importPage:function(a,
b){g.internalCircuits.importPage(a,b)},exportPage:function(a){return g.internalCircuits.exportPage(a)},importPages:function(a){g.internalCircuits.importPages(a)},exportPages:function(){return g.internalCircuits.exportPages()},setPage:function(a){g.internalCircuits.page(a)}};b();g.elements.sevenSegmentDisplay.pageNumber.enterCharacter("0");return g};this.launchpad.metadata={name:"Launchpad",helpURL:"https://metasophiea.com/curve/help/units/alpha/launchpad/"};this.launchpad.sequencer=function(d,e){var a=
[],b=0,c=0,f=d-1;this.square=function(c,f,h){0>c?c=0:c>d-1&&(c=d-1);0>f?f=0:c>e-1&&(c=e-1);if(void 0==h)return a[b][f][c];a[b][f][c]=h};this.line=function(d,f){if(void 0==f){f=[];for(d=0;d<e;d++)void 0==a[b]||void 0==a[b][d]||void 0==a[b][d][c]?f.push(!1):f.push(a[b][d][c]);return f}for(d=0;d<e;d++)a[b][d][c]=f[d]};this.position=function(a,b){if(void 0==a)return c;f=c;a>d-1?a=0:0>a&&(a=d-1);c=a;(void 0===b||b)&&this.commands(this.line())};this.previousPosition=function(){return f};this.inc=function(){this.position(c+
1)};this.dec=function(){this.position(c-1)};this.page=function(a){if(void 0==a)return b;-1==a?a=9:0>a?a=0:10==a?a=0:10<=a&&(a=9);b=a;void 0!=this.pageChange&&this.pageChange(b)};this.incPage=function(){this.page(b+1)};this.decPage=function(){this.page(b-1)};this.exportPages=function(){return JSON.parse(JSON.stringify(a))};this.importPages=function(c){a=c;this.pageChange(b)};this.exportPage=function(c){void 0==c&&(c=b);return void 0==a[c]?Array(d).fill(Array(e).fill(!1)):JSON.parse(JSON.stringify(a[c]))};
this.importPage=function(c,d){void 0==d&&(d=b);a[d]=c;void 0!=this.pageChange&&this.pageChange(b)};this.commands=function(){};this.pageChange=function(){}};this.basicSequencer_midiOut=function(d,e,a){var b=void 0,c=[0,0,1,0,1,0,1,0,0,1,0,1];b=108;var h=c.length-"C C# D D# E F F# G G# A A# B".split(" ").indexOf(workspace.library.audio.num2name(131).slice(1));c=c.slice(h).concat(c.slice(0,h));h={stroke:"rgba(150,150,150,1)",lineWidth:1};var g={handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",
slot:"rgba(50,50,50,1)",invisibleHandle:"rgba(0,0,0,0)",span:"rgba(220,220,220,1)"},m={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(240,240,240,1)",background__hover_press__fill:"rgba(180,180,180,1)"},n=f.builder(this.basicSequencer,{name:"basicSequencer_midiOut",category:"sequencers",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:800,
y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"midiout",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"sequencer",name:"main",data:{x:20,y:20,width:770,height:170,xCount:64,yCount:b,horizontalStripStyle_pattern:c,event:function(a){for(var b=0;b<a.length;b++)n.elements.connectionNode_data.midiout.send("midinumber",{num:131-a[b].line,velocity:a[b].strength})},onchangeviewarea:function(a){n.elements.rangeslide.viewselect.set({start:a.left,
end:a.right},!1)}}},{type:"rangeslide",name:"viewselect_y",data:{x:10,y:20,height:170,width:10,angle:0,handleHeight:.0625,spanWidth:1,style:g}},{type:"rangeslide",name:"viewselect_x",data:{x:20,y:20,height:770,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:1,style:g}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"rgba(229, 229, 229,1)",check:"rgba(252,252,252,1)"},onchange:function(a){n.elements.sequencer.main.automove(a)}}},{type:"checkbox_rect",
name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"rgba(229, 221, 112,1)",check:"rgba(252,244,128,1)"},onchange:function(a){n.elements.sequencer.main.loopActive(a)}}},{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:.75,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",span:"rgba(255,247,145,0.5)"}}},{type:"connectionNode_data",name:"progress_input",data:{x:800,y:5,width:5,
height:20,onreceive:function(){n.elements.sequencer.main.progress()}}},{type:"button_rect",name:"progress_button",data:{x:10,y:205,width:25,height:15,style:m,onpress:function(){n.elements.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{points:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:h}},{type:"connectionNode_data",name:"reset_input",data:{x:800,y:30,width:5,height:20,onreceive:function(){n.elements.sequencer.main.playheadPosition(0)}}},{type:"button_rect",name:"reset_button",
data:{x:40,y:205,width:25,height:15,style:m,onpress:function(){n.elements.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{points:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:h}},{type:"path",name:"reset_line",data:{points:[{x:49,y:209},{x:49,y:216}],style:h}}]});n.elements.rangeslide.viewselect_y.onchange=function(a){n.elements.sequencer.main.viewarea({topLeft:{y:a.start},bottomRight:{y:a.end}},!1)};n.elements.rangeslide.viewselect_x.onchange=function(a){n.elements.sequencer.main.viewarea({topLeft:{x:a.start},
bottomRight:{x:a.end}},!1)};n.elements.rangeslide.loopSelect.onchange=function(a){var b=Math.round(64*a.start);a=Math.round(64*a.end);0==a&&(a=1);n.elements.sequencer.main.loopPeriod(b,a)};n.exportData=function(){return{loop:{active:n.elements.checkbox_rect.loopActive.get(),range:n.elements.rangeslide.loopSelect.get()},autofollow:n.elements.checkbox_rect.followPlayhead.get(),notes:n.elements.sequencer.main.getAllSignals(),viewarea:{horizontal:n.elements.rangeslide.viewselect_y.get(),vertical:n.elements.rangeslide.viewselect_x.get()}}};
n.importData=function(a){n.elements.sequencer.main.addSignals(a.notes);n.i.loopActive(a.loop.active);n.elements.rangeslide.loopSelect.set(a.loop.range);n.elements.checkbox_rect.followPlayhead.set(a.autofollow);n.elements.rangeslide.viewselect_y.set(a.viewarea.horizontal);n.elements.rangeslide.viewselect_x.set(a.viewarea.vertical)};n.i={addNote:function(a,b,c,d){n.elements.sequencer.main.addSignal(131-a,b,c,void 0===d?1:d)},addNotes:function(a){for(var b=0;b<a.length;b++)this.addSignal(a[b].line,a[b].position,
a[b].length,a[b].strength)},getNotes:function(){return n.elements.sequencer.main.getAllSignals()},loopActive:function(a){n.elements.checkbox_rect.loopActive.set(a)},step:n.elements.sequencer.step};n.elements.rangeslide.viewselect_y.set({start:.3,end:.7});return n};this.basicSequencer_midiOut.metadata={name:"Basic Sequencer (Midi Out)",helpURL:"https://metasophiea.com/curve/help/units/alpha/basicSequencer_midiOut/"}};this.synthesizers=new function(){this.basicSynthesizer=function(d,e,a){var b={fill:"rgba(0,0,0,1)",
font:"4pt Courier New"},c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},h={fill:"rgba(50,50,50,1)"},k=f.builder(this.basicSynthesizer,{name:"basicSynthesizer",category:"synthesizers",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,
x:-15,y:5,width:15,height:30,isAudioOutput:!0}},{type:"connectionNode_data",name:"port_gain",data:{x:12.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":k.elements.dial_continuous.gain.set(b);break;case "%t":k.__synthesizer.gain(b.target,b.time,b.curve),k.elements.dial_continuous.gain.smoothSet(b.target,b.time,b.curve,!1)}}}},{type:"connectionNode_data",name:"port_attack",data:{x:52.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&k.elements.dial_continuous.attack.set(b)}}},
{type:"connectionNode_data",name:"port_release",data:{x:92.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&k.elements.dial_continuous.release.set(b)}}},{type:"connectionNode_data",name:"port_detune",data:{x:132.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":k.elements.dial_continuous.detune.set(b);break;case "%t":k.__synthesizer.detune(200*b.target+-100,b.time,b.curve),k.elements.dial_continuous.detune.smoothSet(b.target,b.time,b.curve,!1)}}}},{type:"connectionNode_data",
name:"port_octave",data:{x:170.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&k.elements.dial_discrete.octave.select(b)}}},{type:"connectionNode_data",name:"port_waveType",data:{x:210.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&k.elements.dial_discrete.waveType.select(b)}}},{type:"connectionNode_data",name:"port_periodicWave",data:{x:240,y:12.5,width:7.5,height:15,onreceive:function(a,b){"periodicWave"==a&&k.__synthesizer.periodicWave(b)}}},{type:"connectionNode_data",
name:"port_midiNote",data:{x:225,y:55,width:15,height:30,angle:Math.PI/4,onreceive:function(a,b){"midinumber"==a&&k.__synthesizer.perform(b)}}},{type:"connectionNode_data",name:"port_gainWobblePeriod",data:{x:22.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&k.elements.dial_continuous.gainWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_gainWobbleDepth",data:{x:57.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&k.elements.dial_continuous.gainWobbleDepth.set(b)}}},
{type:"connectionNode_data",name:"port_detuneWobblePeriod",data:{x:107.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&k.elements.dial_continuous.detuneWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_detuneWobbleDepth",data:{x:142.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&k.elements.dial_continuous.detuneWobbleDepth.set(b)}}},{type:"text",name:"gain_gain",data:{x:13,y:43,text:"gain",size:b.size,style:b}},{type:"text",name:"gain_0",data:{x:7,y:37,text:"0",
size:c.size,style:c}},{type:"text",name:"gain_1/2",data:{x:16.5,y:8,text:"1/2",size:c.size,style:c}},{type:"text",name:"gain_1",data:{x:31,y:37,text:"1",size:c.size,style:c}},{type:"dial_continuous",name:"dial_gain",data:{x:20,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"attack_gain",data:{x:50,y:43,text:"attack",size:b.size,style:b}},{type:"text",name:"attack_0",
data:{x:47,y:37,text:"0",size:c.size,style:c}},{type:"text",name:"attack_5",data:{x:58.75,y:8,text:"5",size:c.size,style:c}},{type:"text",name:"attack_10",data:{x:71,y:37,text:"10",size:c.size,style:c}},{type:"dial_continuous",name:"dial_attack",data:{x:60,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"release_gain",data:{x:89,y:43,text:"release",style:b}},{type:"text",
name:"release_0",data:{x:87,y:37,text:"0",size:c.size,style:c}},{type:"text",name:"release_5",data:{x:98.75,y:8,text:"5",size:c.size,style:c}},{type:"text",name:"release_10",data:{x:111,y:37,text:"10",size:c.size,style:c}},{type:"dial_continuous",name:"dial_release",data:{x:100,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"detune_gain",data:{x:131,y:43,text:"detune",
style:b}},{type:"text",name:"detune_-100",data:{x:122,y:37,text:"-100",style:c}},{type:"text",name:"detune_0",data:{x:138.75,y:8,text:"0",style:c}},{type:"text",name:"detune_100",data:{x:148,y:37,text:"100",style:c}},{type:"dial_continuous",name:"dial_detune",data:{x:140,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,value:.5,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"octave_gain",data:{x:170,y:43,text:"octave",
style:b}},{type:"text",name:"octave_-3",data:{x:165,y:35,text:"-3",style:c}},{type:"text",name:"octave_-2",data:{x:161,y:24,text:"-2",style:c}},{type:"text",name:"octave_-1",data:{x:165,y:13,text:"-1",style:c}},{type:"text",name:"octave_0",data:{x:178.75,y:8,text:"0",style:c}},{type:"text",name:"octave_1",data:{x:190,y:13,text:"1",style:c}},{type:"text",name:"octave_2",data:{x:195,y:24,text:"2",style:c}},{type:"text",name:"octave_3",data:{x:190,y:35,text:"3",style:c}},{type:"dial_discrete",name:"dial_octave",
data:{x:180,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:7,value:3,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"waveType_gain",data:{x:214,y:43,text:"wave",style:b}},{type:"text",name:"waveType_sin",data:{x:202,y:35,text:"sin",style:c}},{type:"text",name:"waveType_tri",data:{x:199,y:21,text:"tri",style:c}},{type:"text",name:"waveType_squ",data:{x:210,y:9,text:"squ",style:c}},{type:"text",name:"waveType_saw",data:{x:227,y:10,
text:"saw",style:c}},{type:"rectangle",name:"periodicWaveType",data:{x:230,y:21.75,angle:0,width:10,height:2.5,style:h}},{type:"dial_discrete",name:"dial_waveType",data:{x:220,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:5*Math.PI/4,optionCount:5,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"gainWobble",data:{x:13,y:70,angle:-Math.PI/2,text:"gain",style:c}},{type:"text",name:"gainWobblePeriod_gain",data:{x:23,y:84,text:"rate",style:b}},{type:"text",
name:"gainWobblePeriod_0",data:{x:17,y:79,text:"0",style:c}},{type:"text",name:"gainWobblePeriod_50",data:{x:27.5,y:50,text:"50",style:c}},{type:"text",name:"gainWobblePeriod_100",data:{x:41,y:79,text:"100",style:c}},{type:"dial_continuous",name:"dial_gainWobblePeriod",data:{x:30,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"gainWobbleDepth_gain",data:{x:57,y:84,text:"depth",
style:b}},{type:"text",name:"gainWobbleDepth_0",data:{x:52,y:79,text:"0",style:c}},{type:"text",name:"gainWobbleDepth_50",data:{x:61,y:50,text:"1/2",style:c}},{type:"text",name:"gainWobbleDepth_100",data:{x:76,y:79,text:"1",style:c}},{type:"dial_continuous",name:"dial_gainWobbleDepth",data:{x:65,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"detuneWobble",data:{x:98,y:70,angle:-Math.PI/
2,text:"detune",style:c}},{type:"text",name:"detuneWobblePeriod_gain",data:{x:108,y:84,text:"rate",style:b}},{type:"text",name:"detuneWobblePeriod_0",data:{x:101,y:79,text:"0",style:c}},{type:"text",name:"detuneWobblePeriod_50",data:{x:111.5,y:50,text:"50",style:c}},{type:"text",name:"detuneWobblePeriod_100",data:{x:125,y:79,text:"100",style:c}},{type:"dial_continuous",name:"dial_detuneWobblePeriod",data:{x:114,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",
slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"detuneWobbleDepth_gain",data:{x:141,y:84,text:"depth",style:b}},{type:"text",name:"detuneWobbleDepth_0",data:{x:136,y:79,text:"0",style:c}},{type:"text",name:"detuneWobbleDepth_50",data:{x:145.5,y:50,text:"1/2",style:c}},{type:"text",name:"detuneWobbleDepth_100",data:{x:160,y:79,text:"1",style:c}},{type:"dial_continuous",name:"dial_detuneWobbleDepth",data:{x:149,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",
slot:h.fill,needle:"rgba(250,150,150,1)"}}},{type:"button_rect",name:"panicButton",data:{x:197.5,y:47.5,width:20,height:20,angle:Math.PI/4,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"}}}]});k.exportData=function(){return{gain:k.elements.dial_continuous.dial_gain.get(),attack:10*k.elements.dial_continuous.dial_attack.get(),release:10*k.elements.dial_continuous.dial_release.get(),detune:100*(2*k.elements.dial_continuous.dial_detune.get()-
1),octave:k.elements.dial_discrete.dial_octave.get()-3,waveType:["sine","triangle","square","sawtooth","custom"][k.elements.dial_discrete.dial_waveType.get()],gainWobble:{rate:100*k.elements.dial_continuous.dial_gainWobblePeriod.get(),depth:k.elements.dial_continuous.dial_gainWobbleDepth.get()},detuneWobble:{rate:100*k.elements.dial_continuous.dial_detuneWobblePeriod.get(),depth:k.elements.dial_continuous.dial_detuneWobbleDepth.get()}}};k.importData=function(a){void 0!=a&&(k.elements.dial_continuous.dial_gain.set(a.gain),
k.elements.dial_continuous.dial_attack.set(a.attack/10),k.elements.dial_continuous.dial_release.set(a.release/10),k.elements.dial_continuous.dial_detune.set((1+a.detune/100)/2),k.elements.dial_discrete.dial_octave.set(a.octave+3),k.elements.dial_discrete.dial_waveType.set(["sine","triangle","square","sawtooth","custom"].indexOf(a.waveType)),k.elements.dial_continuous.dial_gainWobblePeriod.set(a.gainWobble.rate/100),k.elements.dial_continuous.dial_gainWobbleDepth.set(a.gainWobble.depth),k.elements.dial_continuous.dial_detuneWobblePeriod.set(a.detuneWobble.rate/
100),k.elements.dial_continuous.dial_detuneWobbleDepth.set(a.detuneWobble.depth))};k.__synthesizer=new g.circuit.alpha.synthesizer(workspace.library.audio.context);k.__synthesizer.out().connect(k.elements.connectionNode_audio.audioOut.in());k.elements.dial_continuous.dial_gain.onchange=function(a){k.__synthesizer.gain(a)};k.elements.dial_continuous.dial_attack.onchange=function(a){k.__synthesizer.attack(a)};k.elements.dial_continuous.dial_release.onchange=function(a){k.__synthesizer.release(a)};k.elements.dial_continuous.dial_detune.onchange=
function(a){k.__synthesizer.detune(200*a+-100)};k.elements.dial_discrete.dial_octave.onchange=function(a){k.__synthesizer.octave(a-3)};k.elements.dial_discrete.dial_waveType.onchange=function(a){k.__synthesizer.waveType(["sine","triangle","square","sawtooth","custom"][a])};k.elements.dial_continuous.dial_gainWobblePeriod.onchange=function(a){k.__synthesizer.gainWobblePeriod(.01>1-a?.011:1-a)};k.elements.dial_continuous.dial_gainWobbleDepth.onchange=function(a){k.__synthesizer.gainWobbleDepth(a)};
k.elements.dial_continuous.dial_detuneWobblePeriod.onchange=function(a){k.__synthesizer.detuneWobblePeriod(.01>1-a?.011:1-a)};k.elements.dial_continuous.dial_detuneWobbleDepth.onchange=function(a){k.__synthesizer.detuneWobbleDepth(100*a)};k.elements.button_rect.panicButton.onpress=function(){k.__synthesizer.panic()};k.i={gain:function(a){k.elements.dial_continuous.dial_gain.set(a)},attack:function(a){k.elements.dial_continuous.dial_attack.set(a)},release:function(a){k.elements.dial_continuous.dial_release.set(a)},
detune:function(a){k.elements.dial_continuous.dial_detune.set(a)},octave:function(a){k.elements.dial_discrete.dial_octave.set(a)},waveType:function(a){k.elements.dial_discrete.dial_waveType.set(a)},periodicWave:function(a){k.__synthesizer.periodicWave(a)},midiNote:function(a){k.__synthesizer.perform(a)},gainWobblePeriod:function(a){k.elements.dial_continuous.dial_gainWobblePeriod.set(a)},gainWobbleDepth:function(a){k.elements.dial_continuous.dial_gainWobbleDepth.set(a)},detuneWobblePeriod:function(a){k.elements.dial_continuous.dial_detuneWobblePeriod.set(a)},
detuneWobbleDepth:function(a){k.elements.dial_continuous.dial_detuneWobbleDepth.set(a)}};k.elements.dial_continuous.dial_gain.set(.5);k.elements.dial_continuous.dial_detune.set(.5);k.elements.dial_discrete.dial_octave.set(3);return k};this.basicSynthesizer.metadata={name:"Basic Synthesizer",helpURL:"https://metasophiea.com/curve/help/units/alpha/basicSynthesizer/"}};this.misc=new function(){this.audio_duplicator=function(d,e,a){var b={fill:"rgba(150,150,150,1)"};d=f.builder(workspace._interface.unit.alpha.misc.audio_duplicator,
{name:"audio_duplicator",category:"misc",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],elements:[{type:"connectionNode_audio",name:"input",data:{type:0,x:55,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"output_1",data:{type:1,x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"output_2",data:{type:1,x:-10,y:30,width:10,height:20,isAudioOutput:!0}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:55,y:0},{x:55,
y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"polygon",name:"upperArrow",data:{points:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:b}},{type:"polygon",name:"lowerArrow",data:{points:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:b}},{type:"rectangle",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:b}},{type:"rectangle",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:b}},{type:"rectangle",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:b}}]});
d.elements.connectionNode_audio.input.out().connect(d.elements.connectionNode_audio.output_1.in());d.elements.connectionNode_audio.input.out().connect(d.elements.connectionNode_audio.output_2.in());return d};this.audio_duplicator.metadata={name:"Audio Duplicator",helpURL:"https://metasophiea.com/curve/help/units/alpha/audioDuplicator/"};this.universalreadout=function(d,e,a){var b={fill:"rgba(0,0,0,1)",size:.75,font:"Courier New"},c=f.builder(this.universalreadout,{name:"universalreadout",category:"misc",
collection:"alpha",x:d,y:e,a:a,space:[{x:-5,y:-5},{x:10,y:-10},{x:25,y:-5},{x:30,y:10},{x:25,y:25},{x:10,y:30},{x:-5,y:25},{x:-10,y:10}],elements:[{type:"circle",name:"base",data:{x:10,y:10,r:20,style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"in",data:{x:0,y:0,width:20,height:20,onreceive:function(a,d){a="address: "+a+" data: "+JSON.stringify(d);a=n++ +"> "+a;h.unshift(a);h.length>m&&h.pop();for(a=0;a<g.length;a++)g[a].parent.remove(g[a]);g=[];for(a=0;a<h.length;a++)g[a]=workspace._interface.part.alpha.builder("text",
"universalreadout_"+a,{x:40,y:5*a,size:b.size,text:h[a],style:b}),c.append(g[a])}}}]}),h=[],g=[],m=10,n=0;return c};this.universalreadout.metadata={name:"Universal Readout",helpURL:"https://metasophiea.com/curve/help/units/alpha/universalReadout/"};this.testObject=function(d,e,a){d=f.builder(this.testObject,{name:"testObject",category:"misc",collection:"alpha",x:d,y:e,a:a,space:[{x:-5,y:-5},{x:65,y:-5},{x:65,y:5},{x:290,y:5},{x:290,y:40},{x:615,y:40},{x:615,y:130},{x:715,y:130},{x:715,y:220},{x:255,
y:220},{x:255,y:335},{x:440,y:335},{x:440,y:445},{x:-5,y:455}],elements:[{type:"rectangle",name:"testRectangle",data:{x:5,y:5,width:30,height:30,style:{fill:"rgba(255,0,0,1)"}}},{type:"circle",name:"testCircle",data:{x:20,y:55,r:15}},{type:"image",name:"testImage",data:{x:40,y:40,width:30,height:30,url:"https://t2.genius.com/unsafe/300x300/https%3A%2F%2Fimages.genius.com%2F72ee0b753f056baa410c17a6ad9fea70.588x588x1.jpg"}},{type:"polygon",name:"testPolygon",data:{points:[{x:55,y:5},{x:70,y:35},{x:40,
y:35}],style:{fill:"rgba(0,255,0,1)"}}},{type:"text",name:"testText",data:{x:7.5,y:95,text:"Hello",style:{font:"20pt Arial",fill:"rgba(150,150,255,1)"}}},{type:"path",name:"testPath",data:{points:[{x:0,y:0},{x:0,y:90},{x:2.5,y:90},{x:2.5,y:72.5},{x:75,y:72.5}]}},{type:"glowbox_rect",name:"test_glowbox_rect",data:{x:90,y:0}},{type:"sevenSegmentDisplay",name:"test_sevenSegmentDisplay",data:{x:125,y:0}},{type:"sixteenSegmentDisplay",name:"test_sixteenSegmentDisplay",data:{x:150,y:0}},{type:"readout_sixteenSegmentDisplay",
name:"test_readout_sixteenSegmentDisplay",data:{x:175,y:0}},{type:"level",name:"test_level1",data:{x:90,y:35}},{type:"meter_level",name:"test_meterLevel1",data:{x:115,y:35}},{type:"audio_meter_level",name:"test_audioMeterLevel1",data:{x:140,y:35}},{type:"rastorDisplay",name:"test_rastorDisplay1",data:{x:165,y:35}},{type:"grapher",name:"test_grapher1",data:{x:230,y:35}},{type:"grapher_periodicWave",name:"test_grapher_periodicWave1",data:{x:355,y:35}},{type:"grapher_audioScope",name:"test_grapher_audioScope1",
data:{x:480,y:35}},{type:"slide",name:"test_slide1",data:{x:0,y:110}},{type:"slidePanel",name:"test_slidePanel1",data:{x:15,y:110}},{type:"slide",name:"test_slide2",data:{x:0,y:220,angle:-Math.PI/2}},{type:"slidePanel",name:"test_slidePanel2",data:{x:0,y:305,angle:-Math.PI/2}},{type:"rangeslide",name:"test_rangeslide1",data:{x:100,y:110}},{type:"rangeslide",name:"test_rangeslide2",data:{x:100,y:220,angle:-Math.PI/2}},{type:"dial_continuous",name:"test_dial_continuous1",data:{x:130,y:125}},{type:"dial_discrete",
name:"test_dial_discrete1",data:{x:170,y:125}},{type:"button_rect",name:"test_button_rect1",data:{x:115,y:145}},{type:"list",name:"test_list1",data:{x:185,y:225,list:["space",{text_left:"item1",text_centre:"",text_right:"",function:function(){console.log("item1 function")}},{text_left:"item2",text_centre:"",text_right:"",function:function(){console.log("item2 function")}},{text_left:"item3",text_centre:"",text_right:"",function:function(){console.log("item3 function")}},{text_left:"item4",text_centre:"",
text_right:"",function:function(){console.log("item4 function")}},{text_left:"item5",text_centre:"",text_right:"",function:function(){console.log("item5 function")}},"break",{text_left:"item6",text_centre:"",text_right:"",function:function(){console.log("item6 function")}},{text_left:"item7",text_centre:"",text_right:"",function:function(){console.log("item7 function")}},{text_left:"item8",text_centre:"",text_right:"",function:function(){console.log("item8 function")}},{text_left:"item9",text_centre:"",
text_right:"",function:function(){console.log("item9 function")}},{text_left:"item10",text_centre:"",text_right:"",function:function(){console.log("item10 function")}},"break",{text_left:"item11",text_centre:"",text_right:"",function:function(){console.log("item11 function")}},{text_left:"item12",text_centre:"",text_right:"",function:function(){console.log("item12 function")}},{text_left:"item13",text_centre:"",text_right:"",function:function(){console.log("item13 function")}},{text_left:"item14",
text_centre:"",text_right:"",function:function(){console.log("item14 function")}},{text_left:"item15",text_centre:"",text_right:"",function:function(){console.log("item15 function")}},"space"]}},{type:"checkbox_rect",name:"test_checkbox_rect1",data:{x:150,y:145}},{type:"rastorgrid",name:"test_rastorgrid1",data:{x:100,y:225}},{type:"needleOverlay",name:"test_needleOverlay1",data:{x:0,y:310}},{type:"grapher_waveWorkspace",name:"test_grapher_waveWorkspace1",data:{x:0,y:375}},{type:"sequencer",name:"test_sequencer1",
data:{x:125,y:330}},{type:"connectionNode",name:"test_connectionNode1",data:{x:255,y:135}},{type:"connectionNode",name:"test_connectionNode2",data:{x:230,y:185}},{type:"connectionNode",name:"test_connectionNode3",data:{x:280,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal1",data:{x:355,y:135}},{type:"connectionNode_signal",name:"test_connectionNode_signal2",data:{x:330,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal3",data:{x:380,y:185}},{type:"connectionNode_voltage",
name:"test_connectionNode_voltage1",data:{x:455,y:135}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage2",data:{x:430,y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage3",data:{x:480,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data1",data:{x:555,y:135}},{type:"connectionNode_data",name:"test_connectionNode_data2",data:{x:530,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data3",data:{x:580,y:185}},{type:"connectionNode_audio",
name:"test_connectionNode_audio1",data:{x:655,y:135,isAudioOutput:!0}},{type:"connectionNode_audio",name:"test_connectionNode_audio2",data:{x:630,y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio3",data:{x:680,y:185}}]});d.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.text("hello");d.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.print();d.elements.grapher.test_grapher1.draw([0,-2,1,-1,2],[0,.25,.5,.75,1]);d.elements.grapher.test_grapher1.draw([0,
.25,1],void 0,1);d.elements.grapher_periodicWave.test_grapher_periodicWave1.updateBackground();d.elements.grapher_periodicWave.test_grapher_periodicWave1.wave({sin:[0,1,0,1/3,0,.2,0,1/7,0,1/9,0,1/11,0,1/13,0,1/15],cos:[0,0]});d.elements.grapher_periodicWave.test_grapher_periodicWave1.draw();d.elements.needleOverlay.test_needleOverlay1.select(.25);d.elements.needleOverlay.test_needleOverlay1.area(.5,.75);d.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.select(.25);d.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.area(.5,
.75);d.elements.sequencer.test_sequencer1.addSignal(0,0,10,0);d.elements.sequencer.test_sequencer1.addSignal(1,1,10,.1);d.elements.sequencer.test_sequencer1.addSignal(2,2,10,.2);d.elements.sequencer.test_sequencer1.addSignal(3,3,10,.3);d.elements.sequencer.test_sequencer1.addSignal(4,4,10,.4);d.elements.sequencer.test_sequencer1.addSignal(5,5,10,.5);d.elements.sequencer.test_sequencer1.addSignal(6,6,10,.6);d.elements.sequencer.test_sequencer1.addSignal(7,7,10,.7);d.elements.sequencer.test_sequencer1.addSignal(8,
8,10,.8);d.elements.sequencer.test_sequencer1.addSignal(9,9,10,.9);d.elements.sequencer.test_sequencer1.addSignal(10,10,10,1);return d};this.testObject.devUnit=!0;this.testObject.metadata={name:"Test Object",helpURL:"https://metasophiea.com/curve/help/units/alpha/testObject/"};this.pulseGenerator_hyper=function(d,e,a){function b(a){h.elements.readout_sixteenSegmentDisplay__static.readout.text(workspace.library.misc.padString(a,3," ")+"bpm");h.elements.readout_sixteenSegmentDisplay__static.readout.print();
g&&clearInterval(g);0<a&&(g=setInterval(function(){h.io.data.out.send("pulse")},60/a*1E3));h.io.data.out.send("pulse");m=a}var c={handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},h=f.builder(this.pulseGenerator_hyper,{name:"pulseGenerator_hyper",category:"misc",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,
height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){h.elements.button_rect.sync.press()}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:{fill:"rgba(200,200,200,1)"}}},{type:"button_rect",name:"syncButton",data:{x:102.5,y:11.25,width:10,height:17.5,selectable:!1,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",
background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){b(m)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:c.handle,slot:c.slot,needle:c.needle,outerArc:c.arc}}},{type:"readout_sixteenSegmentDisplay__static",name:"readout",data:{x:35,y:10,width:65,height:20,count:6}}]});h.elements.dial_continuous.tempo.onchange=function(a){b(Math.round(999*a))};h.exportData=function(){return h.elements.dial_continuous.tempo.get()};
h.importData=function(a){h.elements.dial_continuous.tempo.set(a)};var g=null,m=120;h.i={setTempo:function(a){h.elements.dial_continuous.tempo.set(a)}};h.elements.dial_continuous.tempo.set(.5);return h};this.pulseGenerator_hyper.metadata={name:"Pulse Generator (Hyper)",helpURL:"https://metasophiea.com/curve/help/objectects/alpha/pulseGenerator_hyper/"};this.pulseGenerator=function(d,e,a){function b(a){h.elements.readout_sixteenSegmentDisplay__static.readout.text(workspace.library.misc.padString(a,
3," ")+"bpm");h.elements.readout_sixteenSegmentDisplay__static.readout.print();g&&clearInterval(g);0<a&&(g=setInterval(function(){h.io.data.out.send("pulse")},60/a*1E3));h.io.data.out.send("pulse");m=a}var c={handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},h=f.builder(this.pulseGenerator,{name:"pulseGenerator",category:"misc",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],elements:[{type:"connectionNode_data",
name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){h.elements.button_rect.sync.press()}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:{fill:"rgba(200,200,200,1)"}}},{type:"button_rect",name:"syncButton",data:{x:102.5,y:11.25,width:10,height:17.5,selectable:!1,style:{background__up__fill:"rgba(175,175,175,1)",
background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){b(m)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:c.handle,slot:c.slot,needle:c.needle,outerArc:c.arc}}},{type:"readout_sixteenSegmentDisplay__static",name:"readout",data:{x:35,y:10,width:65,height:20,count:6}}]});h.elements.dial_continuous.tempo.onchange=function(a){b(Math.round(240*a))};h.exportData=
function(){return h.elements.dial_continuous.tempo.get()};h.importData=function(a){h.elements.dial_continuous.tempo.set(a)};var g=null,m=120;h.i={setTempo:function(a){h.elements.dial_continuous.tempo.set(a)}};h.elements.dial_continuous.tempo.set(.5);return h};this.pulseGenerator.metadata={name:"Pulse Generator",helpURL:"https://metasophiea.com/curve/help/objectects/alpha/pulseGenerator/"};this.data_duplicator=function(d,e,a){var b={fill:"rgba(150,150,150,1)"},c=f.builder(this.data_duplicator,{name:"data_duplicator",
category:"misc",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],elements:[{type:"connectionNode_data",name:"output_1",data:{x:-10,y:5,width:20,height:20}},{type:"connectionNode_data",name:"output_2",data:{x:-10,y:30,width:20,height:20}},{type:"connectionNode_data",name:"input",data:{x:45,y:5,width:20,height:20,onreceive:function(a,b){c.io.data.output_1.send(a,b);c.io.data.output_2.send(a,b)}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:55,y:0},{x:55,
y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"polygon",name:"upperArrow",data:{points:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:b}},{type:"polygon",name:"lowerArrow",data:{points:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:b}},{type:"rectangle",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:b}},{type:"rectangle",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:b}},{type:"rectangle",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:b}}]});
return c};this.data_duplicator.metadata={name:"Data Duplicator",helpURL:"https://metasophiea.com/curve/help/units/alpha/dataDuplicator/"};this.basicMixer=function(d,e,a){var b={fill:"rgba(150,150,150,1)"},c={fill:"rgb(150,150,150)",font:"5pt Courier New"};d={name:"basicMixer",category:"misc",collection:"alpha",x:d,y:e,a:a,space:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],elements:[{type:"connectionNode_audio",name:"output_0",data:{x:-10,y:5,width:20,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",
name:"output_1",data:{x:-10,y:30,width:20,height:20,isAudioOutput:!0}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],style:{fill:"rgba(200,200,200,1)"}}},{type:"text",name:"gain",data:{x:77.5,y:8,text:"gain",style:c}},{type:"text",name:"pan",data:{x:54,y:8,text:"pan",style:c}},{type:"rectangle",name:"vertical",data:{x:22.5,y:6,width:2,height:190,style:b}},{type:"rectangle",name:"overTheTop",data:{x:10,y:6,width:14,height:2,style:b}},{type:"rectangle",
name:"down",data:{x:10,y:6,width:2,height:35,style:b}},{type:"rectangle",name:"inTo0",data:{x:2,y:14,width:10,height:2,style:b}},{type:"rectangle",name:"inTo1",data:{x:2,y:39,width:10,height:2,style:b}}]};for(a=0;8>a;a++)d.elements.unshift({type:"connectionNode_audio",name:"input_"+a,data:{x:90,y:10+25*a,width:20,height:20}}),d.elements.push({type:"rectangle",name:"line_"+a,data:{x:23,y:19.1+25*a,width:75,height:2,style:b}}),d.elements.push({type:"dial_continuous",name:"gain_"+a,data:{x:85,y:20+25*
a,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}),d.elements.push({type:"dial_continuous",name:"pan_"+a,data:{x:60,y:20+25*a,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}});var h=f.builder(this.basicMixer,d);for(a=0;8>a;a++)h["splitter_"+a]=new g.circuit.alpha.channelMultiplier(workspace.library.audio.context,
2),h.elements.connectionNode_audio["input_"+a].out().connect(h["splitter_"+a].in()),h["splitter_"+a].out(0).connect(h.elements.connectionNode_audio.output_0.in()),h["splitter_"+a].out(1).connect(h.elements.connectionNode_audio.output_1.in()),h.elements.dial_continuous["gain_"+a].onchange=function(a){return function(b){h["splitter_"+a].inGain(b)}}(a),h.elements.dial_continuous["gain_"+a].onchange=function(a){return function(b){h["splitter_"+a].outGain(0,b);h["splitter_"+a].outGain(1,1-b)}}(a);h.i=
{gain:function(a,b){h.elements.dial_continuous["gain_"+a].set(b)},pan:function(a,b){h.elements.dial_continuous["pan_"+a].set(b)}};for(a=0;8>a;a++)h.i.gain(a,.5),h.i.pan(a,.5);return h};this.basicMixer.metadata={name:"Basic Audio Mixer",helpURL:"https://metasophiea.com/curve/help/units/alpha/basicAudioMixer/"}};this.builder=function(d,e){function a(){b.space={points:Object.assign([],e.space).map(function(a){return{x:e.x+a.x,y:e.y+a.y}})};b.space.box=workspace.library.math.boundingBoxFromPoints(b.space.points)}
if(d){var b=g.part.alpha.builder("group",e.name,{x:e.x,y:e.y,angle:e.a});b.model=e.name;b.category=e.category;b.collection=e.collection;b.creatorMethod=d;b.elements={};for(d=0;d<e.elements.length;d++)if(void 0!=b.getChildByName(e.elements[d].name))console.warn('error: part with the name "'+e.elements[d].name+'" already exists. Part:',e.elements[d],"will not be added");else{var c=g.part.alpha.builder(e.elements[d].type,e.elements[d].name,e.elements[d].data);b.append(c);void 0==b.elements[e.elements[d].type]&&
(b.elements[e.elements[d].type]={});b.elements[e.elements[d].type][e.elements[d].name]=c}b.io={};[{key:"_",name:"connectionNode"},{key:"signal",name:"connectionNode_signal"},{key:"voltage",name:"connectionNode_voltage"},{key:"data",name:"connectionNode_data"},{key:"audio",name:"connectionNode_audio"}].forEach(function(a){if(b.elements[a.name])for(var c=Object.keys(b.elements[a.name]),d=0;d<c.length;d++){var e=b.elements[a.name][c[d]];void 0==b.io[a.key]&&(b.io[a.key]={});b.io[a.key][e.name]=e}});
b.disconnectEverything=function(){for(var a=Object.keys(b.io),c=0;c<a.length;c++)for(var d=Object.keys(b.io[a[c]]),e=0;e<d.length;e++)b.io[a[c]][d[e]].disconnect()};a();for(d="spaceShape";void 0!=b.getChildByName(d);)d+=Math.floor(10*Math.random());c=g.part.alpha.builder("polygon",d,{points:e.space,style:{fill:"rgba(0,0,0,0)"}});b.prepend(c);e.spaceOutline&&b.append(g.part.alpha.builder("polygon",d+"Outline",{points:e.space,style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,1)"}}));b._parameter={};b._parameter.x=
b.parameter.x;b._parameter.y=b.parameter.y;b._parameter.angle=b.parameter.angle;b.parameter.x=function(c){if(void 0!=b._parameter.x(c))return b.x;e.x=c;a()};b.parameter.y=function(c){if(void 0!=b._parameter.y(c))return b.y;e.y=c;a()};b.parameter.angle=function(c){if(void 0!=b._parameter.angle(c))return b.angle;e.angle=c;a()};return b}console.error("workspace unit\u00a0builder:: creatorMethod missing")}}}};workspace.system.mouse.functionList.onmousedown.push({requiredKeys:[],function:function(g){workspace.control.gui.closeAllDropdowns()}});
workspace.system.mouse.functionList.onmousedown.push({requiredKeys:[["shift"]],function:function(g){if(workspace.control.switch.mouseGroupSelect)return workspace.system.mouse.tmp.selectionRectangle=workspace._interface.part.alpha.builder("rectangle","selectionRectangle",{x:g.x,y:g.y,width:0,height:0,style:{fill:"rgba(224, 184, 252, 0.25)"}}),workspace.system.pane.mf.append(workspace.system.mouse.tmp.selectionRectangle),workspace.system.mouse.tmp.start={x:g.x,y:g.y},workspace.system.mouse.mouseInteractionHandler(function(f){var d=
workspace.system.mouse.tmp.start;f=workspace.core.viewport.windowPoint2workspacePoint(f.x,f.y);workspace.system.mouse.tmp.selectionRectangle.parameter.width(f.x-d.x);workspace.system.mouse.tmp.selectionRectangle.parameter.height(f.y-d.y)},function(f){workspace.system.pane.mf.remove(workspace.system.mouse.tmp.selectionRectangle);var d=workspace.system.mouse.tmp.start;f=workspace.core.viewport.windowPoint2workspacePoint(f.x,f.y);workspace.control.selection.selectUnits(workspace.control.scene.getUnitsWithinPoly([{x:d.x,
y:d.y},{x:f.x,y:d.y},{x:f.x,y:f.y},{x:d.x,y:f.y}]))}),!0}});workspace.system.mouse.functionList.onmousedown.push({requiredKeys:[],function:function(g){if(workspace.control.switch.mouseGripPanningEnabled)return workspace.control.selection.deselectEverything(),workspace.system.mouse.tmp.oldPosition=workspace.core.viewport.position(),workspace.system.mouse.tmp.clickPosition={x:g.event.x,y:g.event.y},workspace.system.mouse.mouseInteractionHandler(function(f){workspace.core.viewport.position(workspace.system.mouse.tmp.oldPosition.x-
(workspace.system.mouse.tmp.clickPosition.x-f.x)/workspace.core.viewport.scale()*window.devicePixelRatio,workspace.system.mouse.tmp.oldPosition.y-(workspace.system.mouse.tmp.clickPosition.y-f.y)/workspace.core.viewport.scale()*window.devicePixelRatio)},function(f){}),!0}});workspace.system.mouse.functionList.onwheel.push({requiredKeys:[],function:function(g){if(workspace.control.switch.mouseWheelZoomEnabled){var f=g.x,d=g.y,e=workspace.core.viewport.scale();e-=g.event.deltaY/100*e;20<e&&(e=20);.1>
e&&(e=.1);workspace.core.viewport.scale(e);g=workspace.core.viewport.windowPoint2workspacePoint(g.event.x,g.event.y);f=workspace.library.math.cartesianAngleAdjust(g.x-f,g.y-d,workspace.core.viewport.angle());d=workspace.core.viewport.position();workspace.core.viewport.position(d.x+f.x,d.y+f.y);return!0}}});workspace.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","F2"],["command","F2"]],function:function(g){workspace.control.scene.load(void 0,void 0,!0);return!0}});workspace.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control",
"F3"],["command","F3"]],function:function(g){workspace.control.scene.save();return!0}});workspace.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyX"],["command","KeyX"]],function:function(g){workspace.control.selection.cut();return!0}});workspace.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyC"],["command","KeyC"]],function:function(g){workspace.system.keyboard.releaseKey("KeyC");workspace.control.selection.copy();return!0}});workspace.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control",
"KeyV"],["command","KeyV"]],function:function(g){workspace.system.keyboard.releaseKey("KeyV");workspace.control.selection.paste();return!0}});workspace.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyB"],["command","KeyB"]],function:function(g){workspace.control.selection.duplicate();return!0}});workspace.system.keyboard.functionList.onkeydown.push({requiredKeys:[["Delete"],["Backspace"]],function:function(g){workspace.control.selection.delete();return!0}});workspace.control=
new function(){var g=this;this.switch={devMode:null!=(new URL(window.location.href)).searchParams.get("dev"),mouseWheelZoomEnabled:!0,mouseGripPanningEnabled:!0,mouseGroupSelect:!0,enableSceneSave:!0,enableSceneLoad:!0,enableMenubar:!0,enableWindowScrollbarAutomaticRemoval:!0,enableUnitSelection:!0,enableSceneModification:!0};this.gui=new function(){var f=workspace.system.pane.f,d=void 0;this.refresh=function(){void 0!=d&&d.refresh()};this.showMenubar=function(){workspace.control.switch.enableMenubar?
void 0==d&&(d=g.gui.elements.menubar(0,0),f.append(d)):this.hideMenubar()};this.hideMenubar=function(){void 0!=d&&(f.remove(d),d=void 0)};this.closeAllDropdowns=function(){void 0!=d&&d.closeAllDropdowns()};this.elements=new function(){this.menubar=function(d,a){workspace.control.viewport.width();var b=void 0,c=void 0;d={text_fill:"rgba(0,0,0,1)",text_font:"22.5pt Helvetica",background__up__fill:"rgba(240,240,240,1)",background__press__fill:"rgba(240,240,240,1)",background__select_press__fill:"rgba(229,167,255,1)",
background__press__stroke:"rgba(0,0,0,0)",background__select__fill:"rgba(229,167,255,1)",background__select__stroke:"rgba(0,0,0,0)",background__select_press__stroke:"rgba(0,0,0,0)"};var e={text_font:"22.5pt Helvetica",item__up__fill:"rgba(240,240,240,1)",item__hover__fill:"rgba(229,167,255,1)"},f=workspace._interface.part.alpha.builder("group","menubar",{}),g=workspace._interface.part.alpha.builder("rectangle","rectangle",{x:0,y:0,width:40,height:40,style:{fill:"rgba(240,240,240,1)"}});f.append(g);
for(var n=a=0;n<this.menubar.dropdowns.length;n++){var l=workspace._interface.part.alpha.builder("button_rect","dropdownButton_"+n,{x:a,y:0,width:this.menubar.dropdowns[n].width,height:40,hoverable:!1,selectable:!0,text_centre:this.menubar.dropdowns[n].text,style:d});f.append(l);l.onpress=function(a){return function(){b=f.getChildByName("dropdownButton_"+a).select()?void 0:a}}(n);l.onenter=function(a){return function(c){void 0!=b&&b!=a&&(f.getChildByName("dropdownButton_"+b).select(!1),b=a,0==c.buttons&&
f.getChildByName("dropdownButton_"+b).select(!0))}}(n);l.onselect=function(a,d,g){return function(){for(var h=0,k=0;k<g.menubar.dropdowns[a].itemList.length;k++)switch(g.menubar.dropdowns[a].itemList[k]){case "break":h+=g.menubar.dropdowns[a].breakHeight;break;case "space":h+=g.menubar.dropdowns[a].spaceHeight;break;default:h+=g.menubar.dropdowns[a].listItemHeight}h>workspace.control.viewport.height()&&(h=workspace.control.viewport.height());c=workspace._interface.part.alpha.builder("list","dropdown",
{x:d,y:40,style:e,width:g.menubar.dropdowns[a].listWidth,height:h,multiSelect:!1,selectable:!1,itemWidthMux:1,itemHeightMux:g.menubar.dropdowns[a].listItemHeight/h,breakHeightMux:g.menubar.dropdowns[a].breakHeight/h,spaceHeightMux:g.menubar.dropdowns[a].spaceHeight/h,itemSpacingMux:0,list:g.menubar.dropdowns[a].itemList});c.onrelease=function(){f.getChildByName("dropdownButton_"+a).select(!1);b=void 0};f.append(c)}}(n,a,this);l.ondeselect=function(){f.remove(c)};this.menubar.dropdowns[n].x=a;a+=this.menubar.dropdowns[n].width}f.closeAllDropdowns=
function(){if(void 0!=c)c.onrelease()};f.refresh=function(){g.parameter.width(workspace.control.viewport.width())};f.refresh();return f};this.menubar.dropdowns=[{text:"file",width:90,listWidth:300,listItemHeight:45,breakHeight:1,spaceHeight:2,itemList:[{text_left:"New Scene",function:function(){g.scene.new(!0)}},{text_left:"Open Scene",text_right:"ctrl-f2",function:function(){g.scene.load(void 0,void 0,!0)}},{text_left:"Save Scene",text_right:"ctrl-f3",function:function(){g.scene.save("project.crv")}}]},
{text:"edit",width:90,listWidth:300,listItemHeight:45,breakHeight:1,spaceHeight:2,itemList:[{text_left:"Cut",text_right:"ctrl-x",function:function(){g.selection.cut()}},{text_left:"Copy",text_right:"ctrl-c",function:function(){g.selection.copy()}},{text_left:"Paste",text_right:"ctrl-v",function:function(){g.selection.paste()}},{text_left:"Duplicate",text_right:"ctrl-b",function:function(){g.selection.duplicate()}},{text_left:"Delete",text_right:"del",function:function(){g.selection.delete()}}]},{text:"create",
width:130,listWidth:500,listItemHeight:45,breakHeight:1,spaceHeight:2,itemList:function(){var d=[];for(category in workspace._interface.unit.alpha)if("builder"!=category){for(model in workspace._interface.unit.alpha[category])workspace._interface.unit.alpha[category][model].devUnit||d.push({text_left:workspace._interface.unit.alpha[category][model].metadata.name,function:function(a,b){return function(){var c=workspace.core.viewport.windowPoint2workspacePoint(30,30);workspace.control.scene.addUnit(c.x,
c.y,0,a,b,"alpha")}}(model,category)});d.push("break")}d.pop();return d}()},{text:"help",width:100,listWidth:300,listItemHeight:45,breakHeight:1,spaceHeight:2,itemList:[{text_left:"Help Docs",text_right:"(empty)",function:function(){console.log("go to help site")}}]}]}};this.viewport=new function(){this.width=function(){return workspace.width};this.height=function(){return workspace.height};this.scale=function(f){return workspace.core.viewport.scale(f)};this.position=function(f,d){return workspace.core.viewport.position(f,
d)};this.refresh=function(){workspace.core.viewport.refresh();g.gui.refresh()};this.stopMouseScroll=function(f){return workspace.control.switch.enableWindowScrollbarAutomaticRemoval?workspace.core.viewport.stopMouseScroll(f):(workspace.core.viewport.stopMouseScroll(!1),!1)};this.activeRender=function(f){return workspace.core.render.active(f)}};this.scene=new function(){var f=workspace.system.pane.mm,d=0;this.new=function(e){if(void 0===e||!e||confirm("This will clear the current scene! Are you sure?"))g.selection.selectEverything(),
g.selection.delete(),d=0,g.viewport.position(0,0),g.viewport.scale(0)};this.documentUnits=function(d){for(var a=[],b=0;b<d.length;b++){var c=d[b],e={};e.position={x:c.parameter.x(),y:c.parameter.y(),angle:c.parameter.angle()};e.details={collection:c.collection,category:c.category,model:c.model};e.data=c.exportData?c.exportData():null;e.connections=[];for(var f in c.io)for(var g in c.io[f]){var n=c.io[f][g].getForeignNode();if(void 0!=n){var l={};l.typeAndNameOfSourcePort={type:f,name:g};l.indexOfDestinationUnit=
d.indexOf(n.parent);l.typeAndNameOfDestinationPort={type:f,name:n.name};e.connections.push(l)}}a.push(e)}return a};this.printUnits=function(d){for(var a=[],b=0;b<d.length;b++){var c=d[b],e=g.scene.addUnit(c.position.x,c.position.y,c.position.angle,c.details.model,c.details.category,c.details.collection);a.push(e);e.importData&&e.importData(c.data);g.selection.selectUnit(e);for(var f=0;f<c.connections.length;f++){var m=c.connections[f],n=g.selection.selectedUnits[m.indexOfDestinationUnit];void 0!=
n&&e.io[m.typeAndNameOfSourcePort.type][m.typeAndNameOfSourcePort.name].connectTo(n.io[m.typeAndNameOfDestinationPort.type][m.typeAndNameOfDestinationPort.name])}}return a};this.export=function(){return this.documentUnits(Array.from(f.children).filter(function(d){return!d._isCable}))};this.import=function(d){this.printUnits(d)};this.save=function(d,a){d=void 0===d?"project":d;a=void 0===a?!0:a;if(workspace.control.switch.enableSceneSave){var b={filename:d,viewportLocation:{xy:workspace.control.viewport.position(),
scale:workspace.control.viewport.scale()}};workspace.library.audio.destination.masterGain(0);b.units=this.export();b=workspace.library.misc.serialize(b,a);b={compressed:a,data:b};b=workspace.library.misc.serialize(b,!1);workspace.library.misc.printFile(d,b);workspace.library.audio.destination.masterGain(1)}};this.load=function(d,a,b){function c(a,b){workspace.library.audio.destination.masterGain(0);try{a=workspace.library.misc.unserialize(a,!1)}catch(n){console.error("Major error unserializing first layer of file");
console.error(n);return}var c=a.compressed;try{a=workspace.library.misc.unserialize(a.data,c)}catch(n){console.error("Major error unserializing second layer of file");console.error(n);return}g.scene.new();g.scene.import(a.units);g.viewport.position(a.viewportLocation.xy.x,a.viewportLocation.xy.y);g.viewport.scale(a.viewportLocation.scale);workspace.library.audio.destination.masterGain(1);g.selection.deselectEverything();b&&b(metadata)}!workspace.control.switch.enableSceneLoad||void 0!==b&&b&&!confirm("This will clear the current scene! Are you sure?")||
(void 0==d?workspace.library.misc.openFile(function(b){c(b,a)}):(b=new XMLHttpRequest,b.open("GET",d,!0),b.responseType="text",b.onload=function(){c(this.response,a)},b.send()))};this.generateUnitName=function(){return d++};this.addUnit=function(d,a,b,c,g,k){k=void 0===k?"alpha":k;if(workspace.control.switch.enableSceneModification){var e=this.generateUnitName();d=void 0==g?workspace._interface.unit[k][c](d,a,b):workspace._interface.unit[k][g][c](d,a,b);d.name=""+e;d=workspace.control.grapple.declare(d);
this.rectifyUnitPosition(d);f.append(d);return d}};this.removeUnit=function(d){workspace.control.switch.enableSceneModification&&f.remove(d)};this.getUnitByName=function(d){return f.getChildByName(d)};this.getUnitsByType=function(d){return f.children.filter(function(a){return a.unitType==d})};this.getUnitUnderPoint=function(d,a){for(var b=0;b<f.children.length;b++)if(workspace.library.math.detectOverlap.boundingBoxes({bottomRight:{x:d,y:a},topLeft:{x:d,y:a}},f.children[b].space.box)&&workspace.library.math.detectOverlap.pointWithinPoly({x:d,
y:a},f.children[b].space.points))return f.children[b]};this.getUnitsWithinPoly=function(d){var a=workspace.library.math.boundingBoxFromPoints(d);return f.children.filter(function(b){return!b._isCable&&workspace.library.math.detectOverlap.boundingBoxes(a,b.space.box)&&workspace.library.math.detectOverlap.overlappingPolygons(d,b.space.points)})};this.rectifyUnitPosition=function(d){return!1}};this.selection=new function(){this.selectedUnits=[];this.lastSelectedUnits=null;this.clipboard=[];this.selectUnit=
function(f,d){d=void 0===d?!0:d;if(workspace.control.switch.enableUnitSelection&&-1==this.selectedUnits.indexOf(f)){d&&(d=workspace.system.pane.getMiddlegroundPane(f),d.remove(f),d.append(f));d=workspace._interface.part.alpha.builder("polygon","selectionGlow-"+f.getAddress(),{points:f.space.points.map(function(d){return{x:d.x-f.x,y:d.y-f.y}}),style:{fill:"rgba(244, 226, 66, 0.25)",stroke:"rgba(244, 226, 66, 1)"}});f.append(d);if(f.onselect)object.onselect();this.selectedUnits.push(f);this.lastSelectedUnits=
f}};this.selectUnits=function(f){for(var d=0;d<f.length;d++)this.selectUnit(f[d])};this.deselectUnit=function(f){f.remove(f.getChildByName("selectionGlow-"+f.getAddress()));this.selectedUnits.splice(this.selectedUnits.indexOf(f),1);if(f.ondeselect)f.ondeselect()};this.selectEverything=function(){this.deselectEverything();for(var f=0;f<workspace.system.pane.mm.children.length;f++)workspace.system.pane.mm.children[f]._isCable||this.selectUnit(workspace.system.pane.mm.children[f],!1)};this.deselectEverything=
function(){for(;0<this.selectedUnits.length;)this.deselectUnit(this.selectedUnits[0])};this.cut=function(){workspace.control.switch.enableSceneModification&&(this.copy(),this.delete())};this.copy=function(){workspace.control.switch.enableSceneModification&&(this.clipboard=workspace.control.scene.documentUnits(this.selectedUnits))};this.paste=function(f){if(workspace.control.switch.enableSceneModification&&0!=this.clipboard.length){this.deselectEverything();if("duplicate"!=f){var d=[];this.clipboard.forEach(function(a){return d.push(a.position)});
var e=workspace.library.math.boundingBoxFromPoints(d).topLeft;void 0==f&&(f=workspace.core.viewport.mousePosition(),void 0==f.x||void 0==f.y)&&(f=workspace.core.viewport.windowPoint2workspacePoint(0,0));this.clipboard.forEach(function(a){a.position.x+=f.x-e.x;a.position.y+=f.y-e.y})}workspace.control.scene.printUnits(this.clipboard)}};this.duplicate=function(){workspace.control.switch.enableSceneModification&&(this.copy(),this.paste("duplicate"),this.clipboard=[])};this.delete=function(){if(workspace.control.switch.enableSceneModification){for(;0<
this.selectedUnits.length;){var f=this.selectedUnits[0];if(f.ondelete)f.ondelete();f.disconnectEverything();workspace.system.pane.getMiddlegroundPane(f).remove(f);this.selectedUnits.shift()}this.lastSelectedUnits=null}}}};workspace.control.grapple={tmpdata:{},tmpunit:void 0,functionList:{onmousedown:[],onmouseup:[]},declare:function(g){function f(d){return function(e,a,b){0==b.button&&(workspace.control.grapple.tmpunit=this,workspace.library.structure.functionListRunner(d)({event:b,x:e,y:a}))}}g.onmousedown=
f(this.functionList.onmousedown);g.onmouseup=f(this.functionList.onmouseup);return g}};workspace.control.grapple.functionList.onmousedown.push({requiredKeys:[],function:function(g){var f=workspace.control;f.selection.selectedUnits.includes(f.grapple.tmpunit)||(g.event.shiftKey||f.selection.deselectEverything(),f.selection.selectUnit(f.grapple.tmpunit))}});workspace.control.grapple.functionList.onmousedown.push({requiredKeys:[["shift","alt"]],function:function(g){var f=workspace.control;f.grapple.tmpdata.oldClickPosition=
{x:g.x,y:g.y};f.grapple.tmpdata.oldUnitsPositions=[];f.grapple.tmpdata.oldUnitsSelectionArea=[];for(g=0;g<f.selection.selectedUnits.length;g++)f.grapple.tmpdata.oldUnitsPositions.push({x:f.selection.selectedUnits[g].x,y:f.selection.selectedUnits[g].y,angle:f.selection.selectedUnits[g].angle}),f.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},f.selection.selectedUnits[g].selectionArea));workspace.system.mouse.mouseInteractionHandler(function(d){for(var e=0;e<f.selection.selectedUnits.length;e++){var a=
f.selection.selectedUnits[e],b=f.grapple.tmpdata.oldClickPosition,c=workspace.core.viewport.windowPoint2workspacePoint(d.x,d.y);a.parameter.angle(f.grapple.tmpdata.oldUnitsPositions[e].angle+(c.y-b.y)/100);workspace.control.scene.rectifyUnitPosition(a);if(a.onrotate)a.onrotate();if(a.io)for(b=Object.keys(a.io),c=0;c<b.length;c++)for(var g=a.io[b[c]],k=Object.keys(g),m=0;m<k.length;m++)g[k[m]].draw()}},function(d){});return!0}});workspace.control.grapple.functionList.onmousedown.push({requiredKeys:[["alt"]],
function:function(g){workspace.control.selection.duplicate()}});workspace.control.grapple.functionList.onmousedown.push({requiredKeys:[],function:function(g){var f=workspace.control;f.grapple.tmpdata.oldClickPosition={x:g.x,y:g.y};f.grapple.tmpdata.oldUnitsPositions=[];f.grapple.tmpdata.oldUnitsSelectionArea=[];for(g=0;g<f.selection.selectedUnits.length;g++)f.grapple.tmpdata.oldUnitsPositions.push({x:f.selection.selectedUnits[g].x,y:f.selection.selectedUnits[g].y}),f.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},
f.selection.selectedUnits[g].selectionArea));workspace.system.mouse.mouseInteractionHandler(function(d){for(var e=0;e<f.selection.selectedUnits.length;e++){var a=f.selection.selectedUnits[e],b=f.grapple.tmpdata.oldClickPosition,c=workspace.core.viewport.windowPoint2workspacePoint(d.x,d.y),g=f.grapple.tmpdata.oldUnitsPositions[e],k=g.y+(c.y-b.y);a.parameter.x(g.x+(c.x-b.x));a.parameter.y(k);workspace.control.scene.rectifyUnitPosition(a);if(a.onmove)a.onmove();if(a.io)for(b=Object.keys(a.io),c=0;c<
b.length;c++){g=a.io[b[c]];k=Object.keys(g);for(var m=0;m<k.length;m++)g[k[m]].draw()}}},function(d){})}});workspace.control.grapple.functionList.onmouseup.push({requiredKeys:[],function:function(g){var f=workspace.control;f.selection.selectedUnits.includes(f.grapple.tmpunit)&&(g.event.shiftKey&&f.selection.lastSelectedUnits!=f.grapple.tmpunit&&f.selection.deselectUnit(f.grapple.tmpunit),f.selection.lastSelectedUnits=null);return!0}});window.onresize=workspace.control.viewport.refresh;workspace.control.switch.devMode||
(window.onbeforeunload=function(){return"Unsaved work will be lost"});workspace.control.gui.showMenubar();workspace.control.viewport.stopMouseScroll(!0);workspace.control.viewport.activeRender(!0)};
