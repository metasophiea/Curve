<!DOCTYPE html>
<html lang="en">
    
    <head>
        <title>curve</title>
        <meta charset="utf-8"></meta>
        <style>
            html, body{
                margin:0px;
                width:100%; height:100%;
                /* overflow: hidden; */
            }
        </style>
    </head>

    <body>
        <canvas 
            id='coreSystemCanvas' 
            coreSystem 
            coreSystemElementWidth='100%' 
            coreSystemElementHeight='100%' 
            style='display: block;'
        ></canvas>
    </body>

</html>


<script type='text/javascript' src='js/coreSystem.js'></script>
<!-- <script type='text/javascript' src='js/coreSystem.min.js'></script> -->

<!-- detect demo request -->
<script>
    var demoNumber = parseInt((new URL(window.location.href)).searchParams.get("demo"));
    if( isNaN(demoNumber) ){ demoNumber = 0; }
</script>


<!-- shows the flexibility of the selected drawing space, by adding min/max attributes to the canvas -->
<!-- uses onclick listeners to create a basic UI -->
<script>
    (function() { if(demoNumber != 0){return;}
        var CC = document.getElementById('coreSystemCanvas');
        CC.setAttribute('coreSystemElementMinWidth','420');
        CC.setAttribute('coreSystemElementMinHeight','575');
        CC.setAttribute('coreSystemElementMaxWidth','500');
        CC.setAttribute('coreSystemElementMaxHeight','650');

        var colourList = [
            {r:0,g:0,b:0,a:1},
            {r:1,g:0,b:0,a:1},
            {r:0,g:1,b:0,a:1},
            {r:1,g:1,b:0,a:1},
            {r:0,g:0,b:1,a:1},
            {r:1,g:0,b:1,a:1},
            {r:0,g:1,b:1,a:1},
            {r:1,g:1,b:1,a:1},
        ];
        var colourListLocation = 0;

        var shapeList = [];

        window.onresize = function(){
            CC.core.viewport.refresh();
            shapeList.forEach(shape => shape.resize());
            CC.core.render.frame();
        };

        var rectangle1 = CC.core.shape.create('rectangle');
            rectangle1.name = 'rectangle1';
            rectangle1.colour = {r:0.8,g:0.8,b:0.8,a:1};
            rectangle1.resize = function(){
                var w = CC.core.viewport.getWidth();
                this.x(0);
                this.y(0);
                this.width(w/2);
                this.height(30);
            };
            rectangle1.resize();
            rectangle1.onclick = function(){
                rectangle3.colour = colourList[colourListLocation=0];
                CC.core.render.frame();
            };
            CC.core.arrangement.append(rectangle1);
            shapeList.push(rectangle1);

        var rectangle2 = CC.core.shape.create('rectangle');
            rectangle2.name = 'rectangle2';
            rectangle2.colour = {r:0.8,g:0.1,b:0.8,a:1};
            rectangle2.resize = function(){
                var w = CC.core.viewport.getWidth();
                this.x(w/2);
                this.y(0);
                this.width(w/2);
                this.height(30);
            };
            rectangle2.resize();
            rectangle2.onclick = function(){
                rectangle3.colour = colourList[colourListLocation=Math.floor(Math.random()*colourList.length)];
                CC.core.render.frame();
            };
            CC.core.arrangement.append(rectangle2);
            shapeList.push(rectangle2);

        var rectangle3 = CC.core.shape.create('rectangle');
            rectangle3.name = 'rectangle3';
            rectangle3.colour = colourList[colourListLocation];
            rectangle3.resize = function(){
                var h = CC.core.viewport.getHeight();
                var w = CC.core.viewport.getWidth();
                this.x(0);
                this.y(30);
                this.width(w);
                this.height(h-30);
            };
            rectangle3.resize();
            rectangle3.onclick = function(){ console.log('background'); };
            CC.core.arrangement.append(rectangle3);
            shapeList.push(rectangle3);

        var rectangle4 = CC.core.shape.create('rectangle');
            rectangle4.name = 'rectangle4';
            rectangle4.colour = {r:0.8,g:0.8,b:0.8,a:1};
            rectangle4.resize = function(){
                var height = 90;
                var h = CC.core.viewport.getHeight();
                var w = CC.core.viewport.getWidth();
                this.x(0);
                this.y((h - height)/2);
                this.width(30);
                this.height(height);
            };
            rectangle4.resize();
            rectangle4.onclick = function(){
                if(--colourListLocation < 0){colourListLocation = colourList.length-1;}
                rectangle3.colour = colourList[colourListLocation];
                CC.core.render.frame();
            };
            CC.core.arrangement.append(rectangle4);
            shapeList.push(rectangle4);

        var rectangle5 = CC.core.shape.create('rectangle');
            rectangle5.name = 'rectangle5';
            rectangle5.colour = {r:0.8,g:0.8,b:0.8,a:1};
            rectangle5.resize = function(){
                var height = 90;
                var h = CC.core.viewport.getHeight();
                var w = CC.core.viewport.getWidth();
                this.x(w-30);
                this.y((h - height)/2);
                this.width(30);
                this.height(height);
            };
            rectangle5.resize();
            rectangle5.onclick = function(){
                if(++colourListLocation >= colourList.length){colourListLocation = 0;}
                rectangle3.colour = colourList[colourListLocation];
                CC.core.render.frame();
            };
            CC.core.arrangement.append(rectangle5);
            shapeList.push(rectangle5);

        window.onresize();
    })();
</script>








<!-- attempt 1 at recreating the main website-->
<script>
    (function() { if(demoNumber != 1){return;}
        var CC = document.getElementById('coreSystemCanvas');
        CC.core.render.active(true);

        var resizeListenerList = [];
        window.onresize = function(){
            CC.core.viewport.refresh();
            resizeListenerList.forEach(shape => shape.resize());
        };
        setTimeout(function(){window.onresize();},1);

        var menuOpen = false;








        var backgroundRectangle = CC.core.shape.create('rectangle');
            backgroundRectangle.name = 'backgroundRectangle';
            backgroundRectangle.colour = {r:20/255,g:20/255,b:20/255,a:1};
            backgroundRectangle.resize = function(){
                var h = CC.core.viewport.getHeight();
                var w = CC.core.viewport.getWidth();
                this.width(w);
                this.height(h);
            };
            CC.core.arrangement.append(backgroundRectangle);
            resizeListenerList.push(backgroundRectangle);

        var rectangle1 = CC.core.shape.create('rectangle');
            rectangle1.name = 'rectangle1';
            rectangle1.colour = {r:20/255,g:20/255,b:20/255,a:1};
            rectangle1.anchor({x:0.5,y:0.5});
            rectangle1.resize = function(){
                if(menuOpen){return;}
                var h = CC.core.viewport.getHeight();
                var w = CC.core.viewport.getWidth();
                var s = w > h ? h : w;

                var div = 5;
                this.width(s/div);
                this.height(s/div);
                this.x(w/2);
                this.y(h/2);
            };
            rectangle1.onclick = function(){
                if(menuOpen){
                    menuOpen = false;
                    rectangle1.resize();
                    activateChangingSquare();
                }else{
                    menuOpen = true;
                    var h = CC.core.viewport.getHeight();
                    var w = CC.core.viewport.getWidth();
                    var s = w < h ? h : w;
                    this.width(s*2);
                    this.height(s*2);
                    this.x(w/2);
                    this.y(h/2);
                    stopChangingSquare();
                }
            };
            CC.core.arrangement.append(rectangle1);
            resizeListenerList.push(rectangle1);








        var ang = 0;
        var destinationColour = {r:255/255,g:0/255,b:20/255,a:1};
        var destinationColourJourneyPercent = 0;
        var rate = 0.01;
        var rotationIntervalID;
        var colourChangeIntervalID;
        function stopChangingSquare(){
            clearInterval(rotationIntervalID);
            clearInterval(colourChangeIntervalID);
            rectangle1.colour = {r:255/255,g:255/255,b:255/255,a:1};
        }
        function activateChangingSquare(){
            rotationIntervalID = setInterval(function(){
                rectangle1.angle( ang+=0.0333 );
                destinationColourJourneyPercent = destinationColourJourneyPercent > 1-rate ? 1 : destinationColourJourneyPercent + rate;
                rectangle1.colour = CC.library.math.blendColours(rectangle1.colour,destinationColour,destinationColourJourneyPercent);
            },1000/40);
            colourChangeIntervalID = setInterval(function(){
                destinationColour = {r:Math.random(),g:Math.random(),b:Math.random(),a:1};
                destinationColourJourneyPercent = 0;
            },1250);
        }
        activateChangingSquare();




    })();
</script>

<!-- attempt 2 at recreating the main website-->
<script>
    (function() { if(demoNumber != 2){return;}
    

        var menuObject = new function(){
            var CC = document.getElementById('coreSystemCanvas');
            var resizeListenerList = [];
            var menuOpen = false;
            var opencloseAnimationInProgress = false;

            CC.core.render.active(true);
            window.onresize = function(){
                CC.core.viewport.refresh();
                resizeListenerList.forEach(shape => shape.resize());
            };
            setTimeout(function(){window.onresize();},1);

            //phase 1
                //shapes            
                    function resetGraphics(){
                        CC.core.arrangement.clear();
                        resizeListenerList = [];

                        var backgroundRectangle = CC.core.shape.create('rectangle');
                            backgroundRectangle.name = 'backgroundRectangle';
                            backgroundRectangle.colour = {r:20/255,g:20/255,b:20/255,a:1};
                            backgroundRectangle.resize = function(){
                                var h = CC.core.viewport.getHeight();
                                var w = CC.core.viewport.getWidth();
                                this.width(w);
                                this.height(h);
                            };
                            CC.core.arrangement.append(backgroundRectangle);
                            resizeListenerList.push(backgroundRectangle);

                        var spinningSquare = CC.core.shape.create('rectangle');
                            spinningSquare.name = 'spinningSquare';
                            spinningSquare.colour = {r:200/255,g:20/255,b:20/255,a:1};
                            spinningSquare.anchor({x:0.5,y:0.5});
                            spinningSquare.angle(1);
                            spinningSquare.resize = function(){
                                var h = CC.core.viewport.getHeight();
                                var w = CC.core.viewport.getWidth();
                                var s = w > h ? h : w;

                                var div = 5;
                                this.width(s/div);
                                this.height(s/div);
                                this.x(w/2);
                                this.y(h/2);
                            };
                            CC.core.arrangement.append(spinningSquare);
                            resizeListenerList.push(spinningSquare);
                    }
                    resetGraphics();
                //animation
                    var spinningSquare_ang = 1;
                    var spinningSquare_destinationColour = {r:255/255,g:0/255,b:20/255,a:1};
                    var spinningSquare_destinationColourJourneyPercent = 0;
                    var spinningSquare_rate = 0.01;
                    var spinningSquare_rotationIntervalID;
                    var spinningSquare_colourChangeIntervalID;
                    function stopChangingSquare(){
                        clearInterval(spinningSquare_rotationIntervalID);
                        clearInterval(spinningSquare_colourChangeIntervalID);
                        CC.core.arrangement.getElementByAddress('/spinningSquare').colour = {r:255/255,g:255/255,b:255/255,a:1};
                    }
                    function startChangingSquare(){
                        spinningSquare_rotationIntervalID = setInterval(function(){
                            var spinningSquare = CC.core.arrangement.getElementByAddress('/spinningSquare');

                            spinningSquare.angle( spinningSquare_ang+=1/30 );
                            spinningSquare_destinationColourJourneyPercent = spinningSquare_destinationColourJourneyPercent > 1-spinningSquare_rate ? 1 : spinningSquare_destinationColourJourneyPercent + spinningSquare_rate;
                            spinningSquare.colour = CC.library.math.blendColours(spinningSquare.colour,spinningSquare_destinationColour,spinningSquare_destinationColourJourneyPercent);
                        },1000/40);
                        spinningSquare_colourChangeIntervalID = setInterval(function(){
                            spinningSquare_destinationColour = {r:Math.random(),g:Math.random(),b:Math.random(),a:1};
                            spinningSquare_destinationColourJourneyPercent = 0;
                        },1250);
                    }        
                    function openMenu(){
                        if(menuOpen || opencloseAnimationInProgress){return;}
                        opencloseAnimationInProgress = true;

                        clearInterval(spinningSquare_colourChangeIntervalID);
                        spinningSquare_destinationColour = {r:1,g:1,b:1,a:1};
                        spinningSquare_destinationColourJourneyPercent = 0;

                        var h = CC.core.viewport.getHeight();
                        var w = CC.core.viewport.getWidth();
                        var maxSize =  (w < h ? h : w)*1.5;
                        spinningSquare_expansionIntervalID = setInterval(function(){
                            var spinningSquare = CC.core.arrangement.getElementByAddress('/spinningSquare');

                            var mux = 1 - spinningSquare.width()/maxSize; if(mux < 0.01){mux = 0.01;}
                            var newSize = spinningSquare.width()*(1+(mux/10));
                            spinningSquare.width( newSize );
                            spinningSquare.height( newSize );

                            if(spinningSquare.width() >= maxSize){
                                clearInterval(spinningSquare_expansionIntervalID);
                                clearInterval(spinningSquare_rotationIntervalID);
                                menuOpen = true;
                                opencloseAnimationInProgress = false;
                            }
                        },1000/40);
                    }
                    function closeMenu(){
                        if(!menuOpen || opencloseAnimationInProgress){return;}
                        opencloseAnimationInProgress = true;

                        startChangingSquare();

                        var h = CC.core.viewport.getHeight();
                        var w = CC.core.viewport.getWidth();
                        var s = w > h ? h : w;
                        var div = 5;
                        var destinationSize = s/div;
                        spinningSquare_reductionIntervalID = setInterval(function(){
                            var spinningSquare = CC.core.arrangement.getElementByAddress('/spinningSquare');

                            var mux = spinningSquare.width()/destinationSize; if(mux < 1){mux = 1;}
                            var newSize = spinningSquare.width() / (1+(mux/100));

                            spinningSquare.width( newSize );
                            spinningSquare.height( newSize );

                            if(spinningSquare.width() <= destinationSize){
                                clearInterval(spinningSquare_reductionIntervalID);
                                menuOpen = false;
                                opencloseAnimationInProgress = false;
                            }
                        },1000/40);
                    }
                    startChangingSquare();
                //interaction
                    CC.core.arrangement.getElementByAddress('/spinningSquare').onclick = function(){ menuOpen ? closeMenu() : openMenu(); };

            //phase 2
                function createCard(){
                    var card = CC.core.shape.create('rectangle');
                        card.name = 'backgroundRectangle';
                        card.colour = {r:20/255,g:20/255,b:20/255,a:1};
                        card.resize = function(){
                            var h = CC.core.viewport.getHeight();
                            var w = CC.core.viewport.getWidth();
                            this.width(w/1.5);
                            this.height(h/3);
                        };
                        card.resize();

                    return card;
                }
                function addCardListGroup(){
                    var cardListGroup = CC.core.shape.create('group');
                        cardListGroup.name = 'cardListGroup';
                        CC.core.arrangement.append(cardListGroup);

                    cardListGroup.append( createCard() );
                }


            // openMenu();
            // setTimeout(addCardListGroup,3000);
        };


    })();
</script>

<!-- attempt 3 at recreating the main website-->
<script>
    (function() { if(demoNumber != 3){return;}

        var CC = document.getElementById('coreSystemCanvas');
        var resizeListenerList = [];
        var state = {
            squareOpen: false,
            squareAnimationInProgress: false,
        };
        var spinningSquareAnimation = {
            ang: 1,
            angChangeRate: 1/30,

            destinationColour: {r:255/255,g:0/255,b:20/255,a:1},
            destinationColourJourneyPercent: 0,
            colourChangeRate: 0.01,

            originSizeMux: 1/5,
            destinationSizeMux: 1/5,
            destinationSizeJourneyPercent: 0,
            sizeChangeRate: 1/40,

            spinningSquareTickIntervalID: undefined,
            colourChangeIntervalID: undefined,
        };

        CC.core.render.clearColour({r:0,g:0,b:0,a:1});
        CC.core.arrangement.clear();
        CC.core.render.active(true);

        window.onresize = function(){
            CC.core.viewport.refresh();
            resizeListenerList.forEach(shape => shape.resize());
        };
        setTimeout(function(){window.onresize();},1);


        var spinningSquareGroup = CC.core.shape.create('group');
            spinningSquareGroup.name = 'spinningSquareGroup';
            spinningSquareGroup.resize = function(){ this.children().forEach(child => { if(child.resize){child.resize();} }); };
            CC.core.arrangement.append(spinningSquareGroup);
            resizeListenerList.push(spinningSquareGroup);

            var spinningSquare = CC.core.shape.create('rectangle');
                spinningSquare.name = 'spinningSquare';
                spinningSquare.colour = {r:200/255,g:20/255,b:20/255,a:1};
                spinningSquare.anchor({x:0.5,y:0.5});
                spinningSquare.angle(-1/4);
                spinningSquare.resize = function(){
                    var CC = document.getElementById('coreSystemCanvas');
                    var h = CC.core.viewport.getHeight();
                    var w = CC.core.viewport.getWidth();

                    this.x(w/2);
                    this.y(h/2);

                    if(state.squareOpen){
                        var s = w < h ? h : w;
                        this.height(s*2);
                        this.width(s*2);
                    }
                };
                spinningSquareGroup.append(spinningSquare);

        var cardListGroup = CC.core.shape.create('group');
            cardListGroup.name = 'cardListGroup';
            cardListGroup.resize = function(){ this.children().forEach(child => { if(child.resize){child.resize();} }); };
            CC.core.arrangement.append(cardListGroup);
            spinningSquareGroup.append(cardListGroup);



        spinningSquareAnimation.spinningSquareTickIntervalID = setInterval(function(){
            var spinningSquare = document.getElementById('coreSystemCanvas').core.arrangement.getElementByAddress('/spinningSquareGroup/spinningSquare');

            //tick angle
                spinningSquare.angle( spinningSquareAnimation.ang+=spinningSquareAnimation.angChangeRate );

            //tick colour
                spinningSquareAnimation.destinationColourJourneyPercent = spinningSquareAnimation.destinationColourJourneyPercent > 1-spinningSquareAnimation.colourChangeRate ? 1 : spinningSquareAnimation.destinationColourJourneyPercent + spinningSquareAnimation.colourChangeRate;
                spinningSquare.colour = document.getElementById('coreSystemCanvas').library.math.blendColours(spinningSquare.colour,spinningSquareAnimation.destinationColour,spinningSquareAnimation.destinationColourJourneyPercent);
        
            //tick size
                if(spinningSquareAnimation.destinationSizeJourneyPercent != 1){
                    var CC = document.getElementById('coreSystemCanvas');
                    var h = CC.core.viewport.getHeight();
                    var w = CC.core.viewport.getWidth();
                    var s = w > h ? h : w;

                    spinningSquareAnimation.destinationSizeJourneyPercent = spinningSquareAnimation.destinationSizeJourneyPercent > 1-spinningSquareAnimation.sizeChangeRate ? 1 : spinningSquareAnimation.destinationSizeJourneyPercent + spinningSquareAnimation.sizeChangeRate;
                    var percent = CC.library.math.curvePoint.s(spinningSquareAnimation.destinationSizeJourneyPercent);
                    var mux = spinningSquareAnimation.originSizeMux + percent*(spinningSquareAnimation.destinationSizeMux - spinningSquareAnimation.originSizeMux);
                    
                    spinningSquare.width(s*mux);
                    spinningSquare.height(s*mux);

                    if(spinningSquareAnimation.destinationSizeJourneyPercent == 1){
                        spinningSquareAnimation.originSizeMux = spinningSquareAnimation.destinationSizeMux;
                        state.squareAnimationInProgress = false;
                    }else{
                        state.squareAnimationInProgress = true;
                    }
                }
        },1000/40);
        spinningSquareAnimation.colourChangeIntervalID = setInterval(function(){
            spinningSquareAnimation.destinationColour = {r:Math.random(),g:Math.random(),b:Math.random(),a:1};
            spinningSquareAnimation.destinationColourJourneyPercent = 0;
        },1250);
        spinningSquare.onclick = function(){ state.squareOpen ? closeSquare() : openSquare(); };
        



        function openSquare(){
            if(state.squareOpen || state.squareAnimationInProgress){return;}

            //set colour to white
                clearInterval(spinningSquareAnimation.colourChangeIntervalID);
                spinningSquareAnimation.destinationColour = {r:1,g:1,b:1,a:1};
                spinningSquareAnimation.destinationColourJourneyPercent = 0;
            //change square size
                spinningSquareAnimation.destinationSizeMux = 2;
                spinningSquareAnimation.destinationSizeJourneyPercent = 0;

            state.squareOpen = true;
        }
        function closeSquare(){
            if(!state.squareOpen || state.squareAnimationInProgress){return;}

            //change square size
                spinningSquareAnimation.destinationSizeMux = 1/5;
                spinningSquareAnimation.destinationSizeJourneyPercent = 0;
            //reactivate random colouring
                spinningSquareAnimation.colourChangeIntervalID = setInterval(function(){
                    spinningSquareAnimation.destinationColour = {r:Math.random(),g:Math.random(),b:Math.random(),a:1};
                    spinningSquareAnimation.destinationColourJourneyPercent = 0;
                },1250);

            state.squareOpen = false;
        }





        CC.core.arrangement.printTree();


    })();
</script>