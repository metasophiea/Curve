<!DOCTYPE html>
<html lang="en">
    
    <head>
        <title>curve</title>
        <meta charset="utf-8"></meta>
        <style>
            html, body{
                margin:0px;
                width:100%; height:100%;
                overflow-x: hidden; overflow-y: hidden;
            }
        </style>
    </head>

    <body>
        <section style='width:100%; height:100%;'>
            <svg workspace style='width:100%; height:100%;'></svg>
        </section>
    </body>

</html>

<script type='text/javascript' src='../../workspace.js'></script>


<script>
    //create objects
        var pulseGenerator = __globals.utility.workspace.placeAndReturnObject( objects.pulseGenerator(830, 200) );
        var launchpad = __globals.utility.workspace.placeAndReturnObject( objects.launchpad(645, 215) );
        var oneShot_multi_multiTrack = __globals.utility.workspace.placeAndReturnObject( objects.oneShot_multi_multiTrack(330, 15) );
        var audio_sink = __globals.utility.workspace.placeAndReturnObject( objects.audio_sink(20,20) );
        var reverbUnit_1 = __globals.utility.workspace.placeAndReturnObject( objects.reverbUnit(170, 20) );
        var reverbUnit_2 = __globals.utility.workspace.placeAndReturnObject( objects.reverbUnit(170, 80) );

    //connect obejcts
        pulseGenerator.io.out.connectTo(launchpad.io.pulse);
        for(var a = 0; a < 8; a++){ launchpad.io['out_'+a].connectTo(oneShot_multi_multiTrack.io['trigger_'+a]); }
        oneShot_multi_multiTrack.io.outRight.connectTo( reverbUnit_1.io.audioIn );
        oneShot_multi_multiTrack.io.outLeft.connectTo( reverbUnit_2.io.audioIn );
        reverbUnit_1.io.audioOut.connectTo( audio_sink.io.right );
        reverbUnit_2.io.audioOut.connectTo( audio_sink.io.left );

    //load sounds from urls into the multi track
        var libURL = 'https://metasophiea.com/curve/demos/1/sounds/';
        var sounds = [ libURL+'bass.mp3', libURL+'snare.mp3', libURL+'openHiHat.mp3', libURL+'closeHiHat.mp3', libURL+'crash.mp3' ];
        for(var a = 0; a < sounds.length; a++){ oneShot_multi_multiTrack.i.loadURL(a, sounds[a]); }

    //load performance data into the launchpad
        launchpad.importData({
            data:[
                [
                    [true, false,false,true, false,true, false,false],
                    [false,false,true, false,false,false,true, false],
                    [false,false,false,false,false,false,false,true ],
                    [false,true, true, false,true, true, false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                ],
                [
                    [true, false,false,true, true, false,false,false],
                    [false,false,true, false,false,false,true, false],
                    [false,false,false,false,false,false,false,false],
                    [true, false,true, false,true, false,true, false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                ],
                [
                    [true, false,false,true, true, true, false,false],
                    [false,false,true, false,false,true, false,false],
                    [false,false,false,false,false,false,true, false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                    [false,false,false,false,false,false,false,false],
                ],
            ]
        });

    //adjust the tempo of the pulse generator
        pulseGenerator.i.setTempo(1);

    //set the play-areas in the multi track
        oneShot_multi_multiTrack.i.area(0,0.022635858200536246, 0.3112601773120755);
        oneShot_multi_multiTrack.i.area(1,0.024827894657491516, 0.14734331790792068);
        oneShot_multi_multiTrack.i.area(2,0.008972957530965352, 0.18193590800215986);
        oneShot_multi_multiTrack.i.area(3,0.01041431545155863,  0.12139887533724177);

</script>