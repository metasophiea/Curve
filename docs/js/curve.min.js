var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(w){var K=0;return function(){return K<w.length?{done:!1,value:w[K++]}:{done:!0}}};$jscomp.arrayIterator=function(w){return{next:$jscomp.arrayIteratorImpl(w)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(w,K,g){w!=Array.prototype&&w!=Object.prototype&&(w[K]=g.value)};$jscomp.getGlobal=function(w){return"undefined"!=typeof window&&window===w?w:"undefined"!=typeof global&&null!=global?global:w};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var w=0;return function(K){return $jscomp.SYMBOL_PREFIX+(K||"")+w++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var w=$jscomp.global.Symbol.iterator;w||(w=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[w]&&$jscomp.defineProperty(Array.prototype,w,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var w=$jscomp.global.Symbol.asyncIterator;w||(w=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(w){$jscomp.initSymbolIterator();w={next:w};w[$jscomp.global.Symbol.iterator]=function(){return this};return w};
$jscomp.iteratorFromArray=function(w,K){$jscomp.initSymbolIterator();w instanceof String&&(w+="");var g=0,m={next:function(){if(g<w.length){var e=g++;return{value:K(e,w[e]),done:!1}}m.next=function(){return{done:!0,value:void 0}};return m.next()}};m[Symbol.iterator]=function(){return m};return m};
$jscomp.polyfill=function(w,K,g,m){if(K){g=$jscomp.global;w=w.split(".");for(m=0;m<w.length-1;m++){var e=w[m];e in g||(g[e]={});g=g[e]}w=w[w.length-1];m=g[w];K=K(m);K!=m&&null!=K&&$jscomp.defineProperty(g,w,{configurable:!0,writable:!0,value:K})}};$jscomp.polyfill("Array.prototype.keys",function(w){return w?w:function(){return $jscomp.iteratorFromArray(this,function(w){return w})}},"es6","es3");
$jscomp.polyfill("Array.from",function(w){return w?w:function(w,g,m){g=null!=g?g:function(a){return a};var e=[],c="undefined"!=typeof Symbol&&Symbol.iterator&&w[Symbol.iterator];if("function"==typeof c){w=c.call(w);for(var f=0;!(c=w.next()).done;)e.push(g.call(m,c.value,f++))}else for(c=w.length,f=0;f<c;f++)e.push(g.call(m,w[f],f));return e}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var w={},K=Object.create(new $jscomp.global.Proxy(w,{get:function(g,m,e){return g==w&&"q"==m&&e==K}}));return!0===K.q}catch(g){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(w){var K="undefined"!=typeof Symbol&&Symbol.iterator&&w[Symbol.iterator];return K?K.call(w):$jscomp.arrayIterator(w)};
$jscomp.owns=function(w,K){return Object.prototype.hasOwnProperty.call(w,K)};
$jscomp.polyfill("WeakMap",function(w){function K(){if(!w||!Object.seal)return!1;try{var a=Object.seal({}),d=Object.seal({}),c=new w([[a,2],[d,3]]);if(2!=c.get(a)||3!=c.get(d))return!1;c.delete(a);c.set(d,4);return!c.has(a)&&4==c.get(d)}catch(l){return!1}}function g(){}function m(a){if(!$jscomp.owns(a,c)){var b=new g;$jscomp.defineProperty(a,c,{value:b})}}function e(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof g)return a;m(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(w&&
$jscomp.ES6_CONFORMANCE)return w}else if(K())return w;var c="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var f=0,a=function(a){this.id_=(f+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};a.prototype.set=function(a,d){m(a);if(!$jscomp.owns(a,c))throw Error("WeakMap key fail: "+a);a[c][this.id_]=d;return this};a.prototype.get=function(a){return $jscomp.owns(a,c)?a[c][this.id_]:void 0};a.prototype.has=
function(a){return $jscomp.owns(a,c)&&$jscomp.owns(a[c],this.id_)};a.prototype.delete=function(a){return $jscomp.owns(a,c)&&$jscomp.owns(a[c],this.id_)?delete a[c][this.id_]:!1};return a},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(w){function K(){if($jscomp.ASSUME_NO_NATIVE_MAP||!w||"function"!=typeof w||!w.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),d=new w($jscomp.makeIterator([[a,"s"]]));if("s"!=d.get(a)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var c=d.entries(),f=c.next();if(f.done||f.value[0]!=a||"s"!=f.value[1])return!1;f=c.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!c.next().done?!1:!0}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(w&&$jscomp.ES6_CONFORMANCE)return w}else if(K())return w;$jscomp.initSymbolIterator();var g=new WeakMap,m=function(a){this.data_={};this.head_=f();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};m.prototype.set=function(a,d){a=0===a?0:a;var b=e(this,a);b.list||(b.list=this.data_[b.id]=[]);b.entry?b.entry.value=d:(b.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:d},b.list.push(b.entry),this.head_.previous.next=b.entry,this.head_.previous=b.entry,this.size++);return this};m.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};m.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};m.prototype.has=function(a){return!!e(this,a).entry};
m.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};m.prototype.entries=function(){return c(this,function(a){return[a.key,a.value]})};m.prototype.keys=function(){return c(this,function(a){return a.key})};m.prototype.values=function(){return c(this,function(a){return a.value})};m.prototype.forEach=function(a,d){for(var b=this.entries(),c;!(c=b.next()).done;)c=c.value,a.call(d,c[1],c[0],this)};m.prototype[Symbol.iterator]=m.prototype.entries;var e=function(b,d){var c=d&&typeof d;"object"==
c||"function"==c?g.has(d)?c=g.get(d):(c=""+ ++a,g.set(d,c)):c="p_"+d;var f=b.data_[c];if(f&&$jscomp.owns(b.data_,c))for(b=0;b<f.length;b++){var k=f[b];if(d!==d&&k.key!==k.key||d===k.key)return{id:c,list:f,index:b,entry:k}}return{id:c,list:f,index:-1,entry:void 0}},c=function(a,d){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:d(b)};b=null}return{done:!0,value:void 0}})},f=function(){var a={};return a.previous=
a.next=a.head=a},a=0;return m},"es6","es3");
$jscomp.polyfill("Set",function(w){function K(){if($jscomp.ASSUME_NO_NATIVE_SET||!w||"function"!=typeof w||!w.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),e=new w($jscomp.makeIterator([g]));if(!e.has(g)||1!=e.size||e.add(g)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var c=e.entries(),f=c.next();if(f.done||f.value[0]!=g||f.value[1]!=g)return!1;f=c.next();return f.done||f.value[0]==g||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:c.next().done}catch(a){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(w&&$jscomp.ES6_CONFORMANCE)return w}else if(K())return w;$jscomp.initSymbolIterator();var g=function(g){this.map_=new Map;if(g){g=$jscomp.makeIterator(g);for(var e;!(e=g.next()).done;)this.add(e.value)}this.size=this.map_.size};g.prototype.add=function(g){g=0===g?0:g;this.map_.set(g,g);this.size=this.map_.size;return this};g.prototype.delete=function(g){g=this.map_.delete(g);this.size=this.map_.size;return g};g.prototype.clear=function(){this.map_.clear();
this.size=0};g.prototype.has=function(g){return this.map_.has(g)};g.prototype.entries=function(){return this.map_.entries()};g.prototype.values=function(){return this.map_.values()};g.prototype.keys=g.prototype.values;g.prototype[Symbol.iterator]=g.prototype.values;g.prototype.forEach=function(g,e){var c=this;this.map_.forEach(function(f){return g.call(e,f,f,c)})};return g},"es6","es3");
$jscomp.polyfill("Object.entries",function(w){return w?w:function(w){var g=[],m;for(m in w)$jscomp.owns(w,m)&&g.push([m,w[m]]);return g}},"es8","es3");$jscomp.polyfill("Array.prototype.fill",function(w){return w?w:function(w,g,m){var e=this.length||0;0>g&&(g=Math.max(0,e+g));if(null==m||m>e)m=e;m=Number(m);0>m&&(m=Math.max(0,e+m));for(g=Number(g||0);g<m;g++)this[g]=w;return this}},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(w,K){for(var g=1;g<arguments.length;g++){var m=arguments[g];if(m)for(var e in m)$jscomp.owns(m,e)&&(w[e]=m[e])}return w};$jscomp.polyfill("Object.assign",function(w){return w||$jscomp.assign},"es6","es3");$jscomp.polyfill("Math.sign",function(w){return w?w:function(w){w=Number(w);return 0===w||isNaN(w)?w:0<w?1:-1}},"es6","es3");
$jscomp.polyfill("Object.is",function(w){return w?w:function(w,g){return w===g?0!==w||1/w===1/g:w!==w&&g!==g}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(w){return w?w:function(w,g){var m=this;m instanceof String&&(m=String(m));var e=m.length;g=g||0;for(0>g&&(g=Math.max(g+e,0));g<e;g++){var c=m[g];if(c===w||Object.is(c,w))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(w,K,g){if(null==w)throw new TypeError("The 'this' value for String.prototype."+g+" must not be null or undefined");if(K instanceof RegExp)throw new TypeError("First argument to String.prototype."+g+" must not be a regular expression");return w+""};$jscomp.polyfill("String.prototype.includes",function(w){return w?w:function(w,g){return-1!==$jscomp.checkStringArgs(this,w,"includes").indexOf(w,g||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(w){return w?w:function(){return $jscomp.iteratorFromArray(this,function(w,g){return g})}},"es8","es3");$jscomp.polyfill("Math.log10",function(w){return w?w:function(w){return Math.log(w)/Math.LN10}},"es6","es3");
(function(){for(var w=document.getElementsByTagName("canvas"),K=0;K<w.length;K++)if(w[K].hasAttribute("workspace")){var g=w[K];g.library=new function(){var m=this;this.math=new function(){this.averageArray=function(e){return e.reduce(function(c,f){return c+f},0)/e.length};this.averagePoint=function(e){var c=e.reduce(function(c,a){return{x:c.x+a.x,y:c.y+a.y}});return{x:c.x/e.length,y:c.y/e.length}};this.distanceBetweenTwoPoints=function(e,c){return Math.pow(Math.pow(e.x-c.x,2)+Math.pow(e.y-c.y,2),
.5)};this.seconds2time=function(e){var c={h:0,m:0,s:0};c.h=Math.floor(e/3600);e-=3600*c.h;c.m=Math.floor(e/60);e-=60*c.m;c.s=e;return c};this.largestValueFound=function(e){return e.reduce(function(c,f){return Math.abs(c)>Math.abs(f)?c:f})};this.smallestValueFound=function(e){return e.reduce(function(c,f){return Math.abs(c)<Math.abs(f)?c:f})};this.cartesian2polar=function(e,c){return{dis:Math.pow(Math.pow(e,2)+Math.pow(c,2),.5),ang:0===e?0===c?0:0<c?.5*Math.PI:1.5*Math.PI:0===c?0<=e?0:Math.PI:0<=e?
Math.atan(c/e):Math.atan(c/e)+Math.PI}};this.polar2cartesian=function(e,c){return{x:c*Math.cos(e),y:c*Math.sin(e)}};this.cartesianAngleAdjust=function(e,c,f){if(0==f||0==f%Math.PI*2)return{x:e,y:c};e=this.cartesian2polar(e,c);e.ang+=f;return this.polar2cartesian(e.ang,e.dis)};this.applyOffsetToPoints=function(e,c){return c.map(function(c){return{x:c.x+e.x,y:c.y+e.y}})};this.applyOffsetToPolygon=function(e,c){e={points:this.applyOffsetToPoints(e,c.points),boundingBox:{}};e.boundingBox=this.boundingBoxFromPoints(e.points);
return e};this.boundingBoxFromPoints=function(e){if(0==e.length)return{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};for(var c=e[0].x,f=e[0].x,a=e[0].y,b=e[0].y,d=1;d<e.length;d++)e[d].x<c?c=e[d].x:e[d].x>f&&(f=e[d].x),e[d].y<a?a=e[d].y:e[d].y>b&&(b=e[d].y);return{topLeft:{x:c,y:a},bottomRight:{x:f,y:b}}};this.pointsOfRect=function(e,c,f,a,b,d){b=void 0===b?0:b;d=void 0===d?{x:0,y:0}:d;var h=d.x*f,l=d.y*a,k=this.cartesian2polar(h,l);k=this.polar2cartesian(k.ang-b,k.dis);d={x:e-k.x,y:c-k.y};k=this.cartesian2polar(h-
f,l);k=this.polar2cartesian(k.ang-b,k.dis);var q={x:e-k.x,y:c-k.y};k=this.cartesian2polar(h-f,l-a);k=this.polar2cartesian(k.ang-b,k.dis);f={x:e-k.x,y:c-k.y};k=this.cartesian2polar(h,l-a);k=this.polar2cartesian(k.ang-b,k.dis);return[d,q,f,{x:e-k.x,y:c-k.y}]};this.pointsOfCircle=function(e,c,f,a){a=void 0===a?3:a;for(var b=[],d=0;d<a;d++)b.push({x:e+f*Math.sin(d/a*Math.PI*2),y:c+f*Math.cos(d/a*Math.PI*2)});return b};this.pointsOfText=function(e,c,f,a,b,d,h,l){var k=document.createElement("canvas").getContext("2d");
k.font=d;k.textAlign=h;k.textBaseline=l;e=k.measureText(e).width/b;d=-d.split("pt")[0].split(" ").pop();isNaN(d)&&(d=-7.5);d/=b;b=[{x:c,y:f},{x:c+e,y:f},{x:c+e,y:f-d},{x:c,y:f-d}];e={start:0,end:0,center:e/2,left:e,right:e};d={alphabetic:d,top:0,hanging:0,middle:d/2,ideographic:0,bottom:d};for(k=0;k<b.length;k++)b[k]={x:b[k].x-e[h],y:b[k].y+d[l]};for(k=0;k<b.length;k++)b[k]=this.cartesianAngleAdjust(b[k].x-c,b[k].y-f,a),b[k].x+=c,b[k].y+=f;return b};this.relativeDistance=function(e,c,f,a,b){c=(a-
c)/(f-c);if(void 0===b||!b){if(1<c)return e;if(0>c)return 0}return c*e};this.lineCorrecter=function(e,c,f){if(!(0>e.x1||0>e.x2||e.x1>f||e.x2>f||0>e.y1&&0>e.y2||e.y1>c&&e.y2>c))return f=(e.y2-e.y1)/(e.x2-e.x1),0>e.y1?(e.x1=(0-e.y1+f*e.x1)/f,e.y1=0):0>e.y2&&(e.x2=(0-e.y2+f*e.x2)/f,e.y2=0),e.y1>c?(e.x1=(c-e.y1+f*e.x1)/f,e.y1=c):e.y2>c&&(e.x2=(c-e.y2+f*e.x2)/f,e.y2=c),e};this.normalizeStretchArray=function(e){var c=e.reduce(function(a,d,c,f){return d>f[a]?c:a},0),f=Math.abs(e[c]);e=e.map(function(a){return a/
f});if(0==e[0]&&1==e[e.length-1])return e;var a=0!=e[0]?e[0]:e[e.length-1];return e=e.map(function(b){return(b-a)/(1-a)})};this.curvePoint=new function(){this.linear=function(e,c,f){c=void 0===c?0:c;return(void 0===e?.5:e)*((void 0===f?1:f)-c)+c};this.sin=function(e,c,f){c=void 0===c?0:c;return Math.sin(Math.PI/2*(void 0===e?.5:e))*((void 0===f?1:f)-c)+c};this.cos=function(e,c,f){c=void 0===c?0:c;return(1-Math.cos(Math.PI/2*(void 0===e?.5:e)))*((void 0===f?1:f)-c)+c};this.s=function(e,c,f,a){c=void 0===
c?0:c;f=void 0===f?1:f;a=void 0===a?8:a;return m.math.normalizeStretchArray([1/(1+Math.exp(-.5*-a)),1/(1+Math.exp(-a*((void 0===e?.5:e)-.5))),1/(1+Math.exp(.5*-a))])[1]*(f-c)+c};this.exponential=function(e,c,f,a){c=void 0===c?0:c;f=void 0===f?1:f;a=void 0===a?2:a;return m.math.normalizeStretchArray([(Math.exp(0*a)-1)/(Math.E-1),(Math.exp(a*(void 0===e?.5:e))-1)/(Math.E-1),(Math.exp(1*a)-1)/(Math.E-1)])[1]*(f-c)+c}};this.curveGenerator=new function(){this.linear=function(e,c,f){c=void 0===c?0:c;f=
void 0===f?1:f;e=Math.abs(void 0===e?2:e)-1;for(var a=[0],b=1;b<e;b++)a.push(b/e);a.push(1);e=f-c;for(b=0;b<a.length;b++)a[b]=a[b]*e+c;return a};this.sin=function(e,c,f){c=void 0===c?0:c;f=void 0===f?1:f;e=Math.abs(void 0===e?2:e)-1;for(var a=[0],b=1;b<e;b++)a.push(Math.sin(Math.PI/2*(b/e)));a.push(1);e=f-c;for(b=0;b<a.length;b++)a[b]=a[b]*e+c;return a};this.cos=function(e,c,f){c=void 0===c?0:c;f=void 0===f?1:f;e=Math.abs(void 0===e?2:e)-1;for(var a=[0],b=1;b<e;b++)a.push(1-Math.cos(Math.PI/2*(b/
e)));a.push(1);e=f-c;for(b=0;b<a.length;b++)a[b]=a[b]*e+c;return a};this.s=function(e,c,f,a){e=void 0===e?2:e;c=void 0===c?0:c;f=void 0===f?1:f;a=void 0===a?8:a;0==a&&(a=1E-6);for(var b=[],d=0;d<e;d++)b.push(1/(1+Math.exp(-a*(d/e-.5))));e=m.math.normalizeStretchArray(b);f-=c;for(d=0;d<e.length;d++)e[d]=e[d]*f+c;return e};this.exponential=function(e,c,f,a){c=void 0===c?0:c;f=void 0===f?1:f;a=void 0===a?2:a;e=(void 0===e?2:e)-1;for(var b=[],d=0;d<=e;d++)b.push((Math.exp(d/e*a)-1)/(Math.E-1));b=system.utility.math.normalizeStretchArray(b);
e=f-c;for(d=0;d<b.length;d++)b[d]=b[d]*e+c;return b}};this.detectOverlap=new function(){this.boundingBoxes=function(e,c){return!(e.bottomRight.y<c.topLeft.y||e.topLeft.y>c.bottomRight.y||e.bottomRight.x<c.topLeft.x||e.topLeft.x>c.bottomRight.x)};this.pointWithinBoundingBox=function(e,c){return!(e.x<c.topLeft.x||e.y<c.topLeft.y||e.x>c.bottomRight.x||e.y>c.bottomRight.y)};this.pointWithinPoly=function(e,c){for(var f=!1,a=0,b=c.length-1;a<c.length;b=a++)c[a].y>e.y!=c[b].y>e.y&&e.x<(c[b].x-c[a].x)*(e.y-
c[a].y)/(c[b].y-c[a].y)+c[a].x&&(f=!f);return f};this.lineSegments=function(e,c){var f=(c[1].y-c[0].y)*(e[1].x-e[0].x)-(c[1].x-c[0].x)*(e[1].y-e[0].y);if(0==f)return null;var a=((c[1].x-c[0].x)*(e[0].y-c[0].y)-(c[1].y-c[0].y)*(e[0].x-c[0].x))/f;c=((e[1].x-e[0].x)*(e[0].y-c[0].y)-(e[1].y-e[0].y)*(e[0].x-c[0].x))/f;return{x:e[0].x+a*(e[1].x-e[0].x),y:e[0].y+a*(e[1].y-e[0].y),inSeg1:0<=a&&1>=a,inSeg2:0<=c&&1>=c}};this.overlappingPolygons=function(e,c){for(var f=0;f<e.length;f++)if(this.pointWithinPoly(e[f],
c))return!0;for(f=0;f<c.length;f++)if(this.pointWithinPoly(c[f],e))return!0;var a=Array.apply(null,{length:e.length}).map(Number.call,Number).concat([0]),b=Array.apply(null,{length:c.length}).map(Number.call,Number).concat([0]);for(f=0;f<a.length-1;f++)for(var d=0;d<b.length-1;d++){var h=this.lineSegments([e[a[f]],e[a[f+1]]],[c[b[d]],c[b[d+1]]]);if(null!=h&&h.inSeg1&&h.inSeg2)return!0}return!1};this.overlappingPolygonWithPolygons=function(e,c){for(var f=0;f<c.length;f++)if(this.boundingBoxes(e.boundingBox,
c[f].boundingBox)&&this.overlappingPolygons(e.points,c[f].points))return!0;return!1}};this.fitPolyIn=function(e,c,f){f=void 0===f?!1:f;var a,b=[[],[],[]],d=g.library.math.averagePoint(e.points),h=100,l=[];for(a=1;a<h+1;a++){l=[];for(var k=2*a+1,q=2*Math.PI/k,r=Math.pow(a,2),n=0;n<k;n++){var v=m.math.polar2cartesian(q*n,r);f&&b[0].push({x:v.x+d.x,y:v.y+d.y});this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon(v,e),c)||l.push({ang:q*n,dis:r})}if(0!=l.length)break}h=10;if(1==
l.length)var t=l[0];else{k=Math.pow(a,2);q=Math.pow(a-1,2);r=[];for(a=0;a<h;a++){var p=[],z=(k-q)/2+q;for(n=0;n<l.length;n++)v=m.math.polar2cartesian(l[n].ang,z),f&&b[1].push({x:v.x+d.x,y:v.y+d.y}),this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon(v,e),c)||(p.push({ang:l[n].ang,dis:z}),r.push({ang:l[n].ang,dis:z}));if(1==p.length){t=p[0];break}0==p.length?q=z:k=z}void 0==t&&(t=r.pop())}h=10;a=m.math.polar2cartesian(t.ang,t.dis);f&&b[2].push({x:a.x+d.x,y:a.y+d.y});l=a.x;n=
a.y;for(a=t=v=0;a<h;a++)k=(l-v)/2+v,q=(n-t)/2+t,f&&b[2].push({x:k+d.x,y:n+d.y}),this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon({x:k,y:n},e),c)?v=k:l=k,f&&b[2].push({x:l+d.x,y:q+d.y}),this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon({x:l,y:q},e),c)?t=q:n=q;a={x:l,y:n};return f?{offset:a,paths:b}:a}};this.structure=new function(){this.functionListRunner=function(e,c){return function(f,a){for(var b=0;b<e.length;b++){for(var d=!0,h=0;h<e[b].requiredKeys.length;h++){d=
!0;for(var l=0;l<e[b].requiredKeys[h].length&&(d=d&&c[e[b].requiredKeys[h][l]],d);l++);if(d)break}if(d&&e[b].function(f,a))break}}};this.signalRegistry=function(e,c,f){e=void 0===e?-1:e;c=void 0===c?-1:c;f=void 0===f?-1:f;var a=[],b=[],d=[],h=[],l={},k=[];this.__dump=function(){console.log("---- signalRegistry dump ----");console.log("\tsignals");for(var b=0;b<a.length;b++)console.log("\t\t",b," "+JSON.stringify(a[b]));console.log("\tselectedSignals");for(b=0;b<tselectedSignals.length;b++)console.log("\t\t",
b," "+JSON.stringify(tselectedSignals[b]));console.log("\tevents");for(b=0;b<d.length;b++)console.log("\t\t",b," "+JSON.stringify(d[b]));console.log("\tevents_byID");for(b=0;b<h.length;b++)console.log("\t\t",b," "+JSON.stringify(h[b]));console.log("\tevents_byPosition");var c=Object.keys(l);for(b=0;b<c.length;b++)console.log("\t\t",c[b]," "+JSON.stringify(l[c[b]]));console.log("\tpositions");for(b=0;b<k.length;b++)console.log("\t\t",b," "+JSON.stringify(k[b]))};this.export=function(){return JSON.parse(JSON.stringify({signals:a,
selectedSignals:b,events:d,events_byID:h,events_byPosition:l,positions:k}))};this.import=function(c){a=JSON.parse(JSON.stringify(c.signals));b=JSON.parse(JSON.stringify(c.selectedSignals));d=JSON.parse(JSON.stringify(c.events));h=JSON.parse(JSON.stringify(c.events_byID));l=JSON.parse(JSON.stringify(c.events_byPosition));k=JSON.parse(JSON.stringify(c.positions))};this.getAllSignals=function(){return JSON.parse(JSON.stringify(a))};this.getAllEvents=function(){return JSON.parse(JSON.stringify(d))};this.getSignal=
function(b){if(void 0!=a[b])return JSON.parse(JSON.stringify(a[b]))};this.eventsBetween=function(a,b){for(var c=void 0==b?Array.from(new Set(k.filter(function(b){return b==a}))):Array.from(new Set(k.filter(function(d){return d>=a&&d<b}))),f=[],e=0;e<c.length;e++){c[e]=l[String(c[e])];for(var h=0;h<c[e].length;h++)f.push(d[c[e][h]])}return f.sort(function(a,b){return a.position<b.position?-1:a.position>b.position?1:0})};this.add=function(b,r){if(void 0!=b&&"line"in b&&"position"in b&&"length"in b){"strength"in
b||(b.strength=1);0>b.line&&(b.line=0);0>b.length&&(b.length=0);0>b.position&&(b.position=0);0>b.strength&&(b.strength=0);-1<c&&b.line>c-1&&(b.line=c-1);-1<f&&b.length>f&&(b.length=f);-1<e&&b.position>e&&(b.position=e-b.length);-1<e&&b.position+b.length>e&&(b.length=e-b.position);-1<e&&b.position+b.length>e&&(b.position=e-b.length);1<b.strength&&(b.strength=1);var q=0;if(void 0==r)for(;void 0!=a[q];)q++;else q=r;a[q]=JSON.parse(JSON.stringify(b));b=[{signalID:q,line:b.line,position:b.position,strength:b.strength},
{signalID:q,line:b.line,position:b.position+b.length,strength:0}];for(r=0;void 0!=d[r];)r++;d[r]=b[0];h[q]=[r];void 0==l[b[0].position]?l[b[0].position]=[r]:l[b[0].position].push(r);for(k.push(b[0].position);void 0!=d[r];)r++;d[r]=b[1];h[q]=h[q].concat(r);void 0==l[b[1].position]?l[b[1].position]=[r]:l[b[1].position].push(r);k.push(b[1].position);return q}};this.remove=function(b){if(void 0!=a[b]){delete a[b];for(var c=0;c<h[b].length;c++){var f=h[b][c];l[d[f].position].splice(l[d[f].position].indexOf(f),
1);k.splice(k.indexOf(d[f].position),1);0==l[d[f].position].length&&delete l[d[f].position];delete d[f]}delete h[b]}};this.update=function(b,d){void 0!=d&&("line"in d||(d.line=a[b].line),-1<e&&("position"in d&&"length"in d?d.length+d.position>e&&(d.length=e-d.position):("position"in d?a[b].length+d.position>=e&&(d.position=e-a[b].length):d.position=a[b].position,"length"in d?d.length+d.position>e&&(d.length=e-d.position):d.length=a[b].length)),"strength"in d||(d.strength=a[b].strength),this.remove(b),
this.add(d,b))};this.reset=function(){a=[];b=[];d=[];h=[];l={};k=[]}}};this.audio=new function(){this.context=new (window.AudioContext||window.webkitAudioContext);this.changeAudioParam=function(a,d,c,f,k,e){e=void 0===e?!0:e;if(null==c)return d.value;e&&d.cancelScheduledValues(a.currentTime);try{switch(k){case "linear":d.linearRampToValueAtTime(c,a.currentTime+f);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");0==c&&(c=1E-4);d.exponentialRampToValueAtTime(c,
a.currentTime+f);break;case "s":for(var b=c-d.value,l=m.math.curveGenerator.s(10),h=0;h<l.length;h++)l[h]=d.value+l[h]*b;d.setValueCurveAtTime(new Float32Array(l),a.currentTime,f);break;default:d.setTargetAtTime(c,a.currentTime,.001)}}catch(t){console.log("could not change param (possibly due to an overlap, or bad target value)"),console.log("audioParam:",d,"target:",c,"time:",f,"curve:",k,"cancelScheduledValues:",e),console.log(t)}};this.loadAudioFile=function(a,d,c){c=void 0===c?"":c;switch(void 0===
d?"file":d){case "url":d=new XMLHttpRequest;d.open("GET",c,!0);d.responseType="arraybuffer";d.onload=function(){m.audio.context.decodeAudioData(this.response,function(b){a({buffer:b,name:c.split("/").pop(),duration:b.duration})},function(a){console.warn("Error with decoding audio data"+a.err)})};d.send();break;default:var b=document.createElement("input");b.type="file";b.onchange=function(){var d=this.files[0],c=new FileReader;c.readAsArrayBuffer(d);c.onload=function(c){m.audio.context.decodeAudioData(c.target.result,
function(b){a({buffer:b,name:d.name,duration:b.duration})});b.remove()}};document.body.appendChild(b);b.click()}};this.waveformSegment=function(a,d,c){d=void 0===d?{start:0,end:1}:d;c=void 0===c?1E4:c;var b=a.getChannelData(0);d.start=d.start?d.start:0;d.end=d.end?d.end:1;var f=a.length*d.start;a=a.length*d.end;c=(a-f)/c;for(d=[];f<a;f+=Math.round(c))d.push(m.math.largestValueFound(b.slice(f,f+Math.round(c))));return d};this.loadBuffer=function(a,d,c,f){a=a.createBufferSource();a.buffer=d;a.connect(c);
a.onended=f;return a};this.destination=this.context.createGain();this.destination.connect(this.context.destination);this.destination._gain=1;this.destination.masterGain=function(a){if(void 0==a)return this.destination._gain;this._gain=a;m.audio.changeAudioParam(m.audio.context,this.gain,this._gain,.01,"instant",!0)};this.names_frequencies_split={0:{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,"A#":29.14,B:30.87},1:{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,
F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},2:{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.8,A:110,"A#":116.5,B:123.5},3:{C:130.8,"C#":138.6,D:146.8,"D#":155.6,E:164.8,F:174.6,"F#":185,G:196,"G#":207.7,A:220,"A#":233.1,B:246.9},4:{C:261.6,"C#":277.2,D:293.7,"D#":311.1,E:329.6,F:349.2,"F#":370,G:392,"G#":415.3,A:440,"A#":466.2,B:493.9},5:{C:523.3,"C#":554.4,D:587.3,"D#":622.3,E:659.3,F:698.5,"F#":740,G:784,"G#":830.6,A:880,"A#":932.3,B:987.8},6:{C:1047,
"C#":1109,D:1175,"D#":1245,E:1319,F:1397,"F#":1480,G:1568,"G#":1661,A:1760,"A#":1865,B:1976},7:{C:2093,"C#":2217,D:2349,"D#":2489,E:2637,F:2794,"F#":2960,G:3136,"G#":3322,A:3520,"A#":3729,B:3951},8:{C:4186,"C#":4435,D:4699,"D#":4978,E:5274,F:5588,"F#":5920,G:6272,"G#":6645,A:7040,"A#":7459,B:7902}};this.names_frequencies={};for(var e=Object.entries(this.names_frequencies_split),c=0;c<e.length;c++)for(var f=Object.entries(this.names_frequencies_split[c]),a=0;a<f.length;a++)this.names_frequencies[e[c][0]+
f[a][0]]=f[a][1];this.frequencies_names={};e=Object.entries(this.names_frequencies);for(c=0;c<e.length;c++)this.frequencies_names[e[c][1]]=e[c][0];e="0C 0C# 0D 0D# 0E 0F 0F# 0G 0G# 0A 0A# 0B 1C 1C# 1D 1D# 1E 1F 1F# 1G 1G# 1A 1A# 1B 2C 2C# 2D 2D# 2E 2F 2F# 2G 2G# 2A 2A# 2B 3C 3C# 3D 3D# 3E 3F 3F# 3G 3G# 3A 3A# 3B 4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C 7C# 7D 7D# 7E 7F 7F# 7G 7G# 7A 7A# 7B 8C 8C# 8D 8D# 8E 8F 8F# 8G 8G# 8A 8A# 8B".split(" ");
this.midinumbers_names={};for(c=0;c<e.length;c++)this.midinumbers_names[c+24]=e[c];this.names_midinumbers={};e=Object.entries(this.midinumbers_names);for(c=0;c<e.length;c++)this.names_midinumbers[e[c][1]]=parseInt(e[c][0]);this.num2name=function(a){return this.midinumbers_names[a]};this.num2freq=function(a){return this.names_frequencies[this.midinumbers_names[a]]};this.name2num=function(a){return this.names_midinumbers[a]};this.name2freq=function(a){return this.names_frequencies[a]};this.freq2num=
function(a){return this.names_midinumbers[this.frequencies_names[a]]};this.freq2name=function(a){return this.frequencies_names[a]}};this.misc=new function(){this.blendColours=function(e,c,f){function a(a){a=a.split(",");a[0]=a[0].replace("rgba(","");a[3]=a[3].replace(")","");return a.map(function(a){return parseFloat(a)})}e=a(e);c=a(c);for(var b=[],d=0;d<e.length;d++)b[d]=(1-f)*e[d]+f*c[d];return"rgba("+b[0]+","+b[1]+","+b[2]+","+b[3]+")"};this.multiBlendColours=function(e,c){if(0==c)return e[0];
if(1==c)return e[e.length-1];c*=e.length-1;return m.misc.blendColours(e[~~c],e[~~c+1],c%1)};this.padString=function(e,c,f){f=void 0===f?" ":f;if(1>f.length)return e;for(e=""+e;e.length<c;)e=f+e;return e};this.compressString=function(e){return m.thirdparty.lzString.compress(e)};this.decompressString=function(e){return m.thirdparty.lzString.decompress(e)};this.serialize=function(e,c){c=void 0===c?!0:c;e=JSON.stringify(e,function(c,a){switch({}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()){case "function":return{__uniqueType:"function",
__value:a.toString(),__name:a.name};case "arraybuffer":return{__uniqueType:"arraybuffer",__value:btoa(String.fromCharCode(new Uint8Array(a)))};case "audiobuffer":c=[];for(var b=0;b<a.numberOfChannels;b++)c.push(Array.from(a.getChannelData(b)));return{__uniqueType:"audiobuffer",__channelData:c,__sampleRate:a.sampleRate,__numberOfChannels:a.numberOfChannels,__length:a.length};default:return a}});c&&(e=m.misc.compressString(e));return e};this.unserialize=function(e,c){if(void 0!==e)return(void 0===c||
c)&&(e=m.misc.decompressString(e)),JSON.parse(e,function(c,a){if("object"==typeof a&&null!=a&&"__uniqueType"in a)switch(a.__uniqueType){case "function":c=a.__value.substring(0,a.__value.indexOf("{"));c=c.substring(c.indexOf("(")+1,c.lastIndexOf(")"));a=a.__value.substring(a.__value.indexOf("{")+1,a.__value.lastIndexOf("}"));a=Function(c,a);break;case "arraybuffer":a=atob(a.__value);for(c=0;c<a.length;c++)a[c]=a[c].charCodeAt(0);a=new ArrayBuffer(a);break;case "audiobuffer":var b=m.audio.context.createBuffer(a.__numberOfChannels,
a.__length,a.__sampleRate);for(c=0;c<b.numberOfChannels;c++){workingBuffer=b.getChannelData(c);for(var d=0;d<b.length;d++)workingBuffer[d]=a.__channelData[c][d]}a=b;break;default:a=a.__value}return a})};this.openFile=function(e,c){c=void 0===c?"readAsBinaryString":c;var f=document.createElement("input");f.type="file";f.onchange=function(){var a=new FileReader;switch(c){case "readAsArrayBuffer":a.readAsArrayBuffer(this.files[0]);break;default:a.readAsBinaryString(this.files[0])}a.onloadend=function(){e&&
e(a.result)}};f.click()};this.printFile=function(e,c){var f=document.createElement("a");f.href=URL.createObjectURL(new Blob([c]));f.download=e;f.click()}};this.thirdparty=new function(){this.lzString=function(){var e=String.fromCharCode,c={},f={compress:function(a){return null==a?"":f._compress(a,6,function(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(a)})},decompress:function(a){if(null==a)return"";if(""==a)return null;a=a.replace(/ /g,"+");return f._decompress(a.length,
32,function(b){b=a.charAt(b);if(!c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]){c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]={};for(var d=0;65>d;d++)c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(d)]=d}return c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"][b]})},_compress:function(a,b,d){if(null==a)return"";var c,f={},k={},e="",
r=2,g=3,v=2,t=[],p=0,z=0,y;for(y=0;y<a.length;y+=1){var A=a.charAt(y);Object.prototype.hasOwnProperty.call(f,A)||(f[A]=g++,k[A]=!0);var x=e+A;if(Object.prototype.hasOwnProperty.call(f,x))e=x;else{if(Object.prototype.hasOwnProperty.call(k,e)){if(256>e.charCodeAt(0)){for(c=0;c<v;c++)p<<=1,z==b-1?(z=0,t.push(d(p)),p=0):z++;var u=e.charCodeAt(0);for(c=0;8>c;c++)p=p<<1|u&1,z==b-1?(z=0,t.push(d(p)),p=0):z++,u>>=1}else{u=1;for(c=0;c<v;c++)p=p<<1|u,z==b-1?(z=0,t.push(d(p)),p=0):z++,u=0;u=e.charCodeAt(0);
for(c=0;16>c;c++)p=p<<1|u&1,z==b-1?(z=0,t.push(d(p)),p=0):z++,u>>=1}r--;0==r&&(r=Math.pow(2,v),v++);delete k[e]}else for(u=f[e],c=0;c<v;c++)p=p<<1|u&1,z==b-1?(z=0,t.push(d(p)),p=0):z++,u>>=1;r--;0==r&&(r=Math.pow(2,v),v++);f[x]=g++;e=String(A)}}if(""!==e){if(Object.prototype.hasOwnProperty.call(k,e)){if(256>e.charCodeAt(0)){for(c=0;c<v;c++)p<<=1,z==b-1?(z=0,t.push(d(p)),p=0):z++;u=e.charCodeAt(0);for(c=0;8>c;c++)p=p<<1|u&1,z==b-1?(z=0,t.push(d(p)),p=0):z++,u>>=1}else{u=1;for(c=0;c<v;c++)p=p<<1|u,
z==b-1?(z=0,t.push(d(p)),p=0):z++,u=0;u=e.charCodeAt(0);for(c=0;16>c;c++)p=p<<1|u&1,z==b-1?(z=0,t.push(d(p)),p=0):z++,u>>=1}r--;0==r&&(r=Math.pow(2,v),v++);delete k[e]}else for(u=f[e],c=0;c<v;c++)p=p<<1|u&1,z==b-1?(z=0,t.push(d(p)),p=0):z++,u>>=1;r--;0==r&&v++}u=2;for(c=0;c<v;c++)p=p<<1|u&1,z==b-1?(z=0,t.push(d(p)),p=0):z++,u>>=1;for(;;)if(p<<=1,z==b-1){t.push(d(p));break}else z++;return t.join("")},_decompress:function(a,b,d){var c=[],f=4,k=4,q=3,r=[],g,v,t=d(0),p=b,z=1;for(g=0;3>g;g+=1)c[g]=g;var y=
0;var A=Math.pow(2,2);for(v=1;v!=A;){var x=t&p;p>>=1;0==p&&(p=b,t=d(z++));y|=(0<x?1:0)*v;v<<=1}switch(y){case 0:y=0;A=Math.pow(2,8);for(v=1;v!=A;)x=t&p,p>>=1,0==p&&(p=b,t=d(z++)),y|=(0<x?1:0)*v,v<<=1;var u=e(y);break;case 1:y=0;A=Math.pow(2,16);for(v=1;v!=A;)x=t&p,p>>=1,0==p&&(p=b,t=d(z++)),y|=(0<x?1:0)*v,v<<=1;u=e(y);break;case 2:return""}g=c[3]=u;for(r.push(u);;){if(z>a)return"";y=0;A=Math.pow(2,q);for(v=1;v!=A;)x=t&p,p>>=1,0==p&&(p=b,t=d(z++)),y|=(0<x?1:0)*v,v<<=1;switch(u=y){case 0:y=0;A=Math.pow(2,
8);for(v=1;v!=A;)x=t&p,p>>=1,0==p&&(p=b,t=d(z++)),y|=(0<x?1:0)*v,v<<=1;c[k++]=e(y);u=k-1;f--;break;case 1:y=0;A=Math.pow(2,16);for(v=1;v!=A;)x=t&p,p>>=1,0==p&&(p=b,t=d(z++)),y|=(0<x?1:0)*v,v<<=1;c[k++]=e(y);u=k-1;f--;break;case 2:return r.join("")}0==f&&(f=Math.pow(2,q),q++);if(c[u])u=c[u];else if(u===k)u=g+g.charAt(0);else return null;r.push(u);c[k++]=g+u.charAt(0);f--;g=u;0==f&&(f=Math.pow(2,q),q++)}}};return f}()}};g.core=new function(){var m=new function(){function e(a){for(var b=[];void 0!=(a=
a.parent);)b.unshift({x:a.x,y:a.y,a:a.angle});a={x:void 0!=b[0]?b[0].x:0,y:void 0!=b[0]?b[0].y:0,a:void 0!=b[0]?b[0].a:0};for(var c=1;c<b.length;c++){var f=g.library.math.cartesianAngleAdjust(b[c].x,b[c].y,b[c-1].a);a.a+=b[c].a;a.x+=f.x;a.y+=f.y}return a}var c=this,f=new function(){this.length=function(a){return a*c.viewport.scale()};this.windowPoint2workspacePoint=function(a,d){var b=c.viewport.position(),f=c.viewport.scale()/window.devicePixelRatio,e=c.viewport.angle();a=a/f-b.x;d=d/f-b.y;return g.library.math.cartesianAngleAdjust(a,
d,-e)};this.workspacePoint2windowPoint=function(a,d){var b=c.viewport.position(),f=c.viewport.scale(),e=c.viewport.angle();a=g.library.math.cartesianAngleAdjust(a,d,e);return{x:(a.x+b.x)*f,y:(a.y+b.y)*f}}},a=new function(){this.polygon=function(){this.type="polygon";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.points=[];this.style={fill:"rgba(100,255,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,lineJoin:"round",miterLimit:2};
this.parameter={};this.parameter.points=function(a){return function(b){if(void 0==b)return a.points;a.points=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",d=this;do a=d.name+"/"+a;while(void 0!=(d=d.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?e(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=this.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,
b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,d){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:d},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),
a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:d},this.extremities.points),a):!1};this.render=function(a,d,e,l){d=void 0===d?{x:0,y:0,a:0}:d;e=void 0===e?!1:e;l=void 0===l?!1:l;var b=this._static?!0:g.library.math.detectOverlap.boundingBoxes(c.viewport.getBoundingBox(),this.extremities.boundingBox);if(b){b=this.points.map(function(a){a=g.library.math.cartesianAngleAdjust(a.x,a.y,d.a);return{x:a.x+d.x,y:a.y+d.y}});var h=this.style.lineWidth;e||(b=b.map(function(a){return f.workspacePoint2windowPoint(a.x,
a.y)}),h=f.length(h));if(l){l=new Path2D;l.moveTo(b[0].x,b[0].y);for(e=1;e<b.length;e++)l.lineTo(b[e].x,b[e].y);a.clip(l)}else{a.fillStyle=this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=h;a.lineJoin=this.style.lineJoin;a.miterLimit=this.style.miterLimit;a.beginPath();a.moveTo(b[0].x,b[0].y);for(e=1;e<b.length;e++)a.lineTo(b[e].x,b[e].y);a.closePath();a.fill();a.stroke();if(this.dotFrame){for(e=0;e<this.extremities.points.length;e++)a=f.workspacePoint2windowPoint(this.extremities.points[e].x,
this.extremities.points[e].y),c.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);c.render.drawDot(a.x,a.y);a=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);c.render.drawDot(a.x,a.y)}}}}};this.circle=function(){this.type="circle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],
boundingBox:{}};this.y=this.x=0;this.r=2;this.style={fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.r=function(a){return function(b){if(void 0==b)return a.r;a.r=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",d=this;
do a=d.name+"/"+a;while(void 0!=(d=d.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?e(this):a;this.extremities={points:[],boundingBox:{},origin:{}};point=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a);this.extremities.origin={x:this.x+a.x,y:this.y+a.y};this.extremities.points=g.library.math.pointsOfCircle(this.x,this.y,this.r,10);this.extremities.points=this.extremities.points.map(function(b){b=
g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,d){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:d},this.extremities.boundingBox);return b?g.library.math.distanceBetweenTwoPoints({x:a,
y:d},{x:this.x+this.extremities.origin.x,y:this.y+this.extremities.origin.y})<=this.r:!1};this.render=function(a,d,e,l){d=void 0===d?{x:0,y:0,a:0}:d;e=void 0===e?!1:e;l=void 0===l?!1:l;var b=this._static?!0:g.library.math.detectOverlap.boundingBoxes(c.viewport.getBoundingBox(),this.extremities.boundingBox);if(b){b=g.library.math.cartesianAngleAdjust(this.x,this.y,d.a);d.x+=b.x-this.x;d.y+=b.y-this.y;d={x:this.x+d.x,y:this.y+d.y};b=this.r;var h=this.style.lineWidth;e||(d=f.workspacePoint2windowPoint(d.x,
d.y),b=f.length(b),h=f.length(h));if(l)e=new Path2D,e.arc(d.x,d.y,b,0,2*Math.PI,!1),a.clip(e);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=h,a.beginPath(),a.arc(d.x,d.y,b,0,2*Math.PI,!1),a.closePath(),a.fill(),a.stroke(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)e=f.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),c.render.drawDot(e.x,e.y,4,"rgba(50,50,50,1)");e=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,
this.extremities.boundingBox.topLeft.y);c.render.drawDot(e.x,e.y);e=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);c.render.drawDot(e.x,e.y);e=f.workspacePoint2windowPoint(this.extremities.origin.x,this.extremities.origin.y);c.render.drawDot(e.x,e.y)}}}};this.canvas=function(){this.type="canvas";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=
this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;var a=document.createElement("canvas"),d=1;var h=a.getContext("2d",{alpha:!1});a.setAttribute("width",this.width*d);a.setAttribute("height",this.height*d);this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==
b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);this.parameter.width=function(b){return function(c){if(void 0==c)return b.width;b.width=c;b.computeExtremities();a.setAttribute("width",b.width*d)}}(this);this.parameter.height=function(b){return function(c){if(void 0==c)return b.height;b.height=c;b.computeExtremities();a.setAttribute("height",b.height*d)}}(this);this.resolution=
function(b){if(void 0==b)return d;d=b;a.setAttribute("width",this.width*d);a.setAttribute("height",this.height*d)};this._=h;this.$=function(a){return a*d};this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,d=this;void 0!=(d=d.parent)&&!b;)b=b||d._static;this._static=b;a=void 0==a?e(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,
this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var d=!1}else d=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,
y:b},this.extremities.boundingBox);return d?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(b,d,e){d=void 0===d?{x:0,y:0,a:0}:d;e=void 0===e?!1:e;var k=this._static?!0:g.library.math.detectOverlap.boundingBoxes(c.viewport.getBoundingBox(),this.extremities.boundingBox);if(k){k=g.library.math.cartesianAngleAdjust(this.x,this.y,d.a);d.x+=k.x-this.x;d.y+=
k.y-this.y;k={x:this.x+d.x,y:this.y+d.y};d=this.angle+d.a;var l=this.width,h=this.height;e||(k=f.workspacePoint2windowPoint(k.x-this.anchor.x*l,k.y-this.anchor.y*h),l=f.length(l),h=f.length(h));k=g.library.math.cartesianAngleAdjust(k.x,k.y,-d);b.save();b.rotate(d);b.drawImage(a,k.x,k.y,l,h);b.restore();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)e=f.workspacePoint2windowPoint(this.extremities.points[b].x,this.extremities.points[b].y),c.render.drawDot(e.x,e.y,4,"rgba(50,50,50,1)");
e=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);c.render.drawDot(e.x,e.y);e=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);c.render.drawDot(e.x,e.y)}}}};this.image=function(){this.type="image";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=
this.width=10;this.url="";var a={};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);
this.parameter.width=function(a){return function(b){if(void 0==b)return a.width;a.width=b;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(b){if(void 0==b)return a.height;a.height=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,d=this;void 0!=(d=d.parent)&&!b;)b=b||d._static;this._static=b;a=void 0==a?e(this):a;this.extremities=
{points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",
this,"has no bounding box");var d=!1}else d=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return d?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(b,e,l){e=void 0===e?{x:0,y:0,a:0}:e;l=void 0===l?!1:l;var d=this._static?!0:g.library.math.detectOverlap.boundingBoxes(c.viewport.getBoundingBox(),this.extremities.boundingBox);
if(d){d=g.library.math.cartesianAngleAdjust(this.x,this.y,e.a);e.x+=d.x-this.x;e.y+=d.y-this.y;d=this.angle+e.a;var h=this.width,r=this.height;e={x:this.x+e.x-this.anchor.x*(this.width*Math.cos(d)+this.height*Math.sin(-d)),y:this.y+e.y-this.anchor.y*(this.width*Math.sin(d)+this.height*Math.cos(-d))};l||(e=f.workspacePoint2windowPoint(e.x,e.y),h=f.length(h),r=f.length(r));e=g.library.math.cartesianAngleAdjust(e.x,e.y,-d);a.hasOwnProperty(this.url)||(a[this.url]=new Image,a[this.url].src=this.url);
b.save();b.rotate(d);b.drawImage(a[this.url],e.x,e.y,h,r);b.restore();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)l=f.workspacePoint2windowPoint(this.extremities.points[b].x,this.extremities.points[b].y),c.render.drawDot(l.x,l.y,4,"rgba(50,50,50,1)");l=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);c.render.drawDot(l.x,l.y);l=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);
c.render.drawDot(l.x,l.y)}}}};this.path=function(){this.type="path";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.points=[];this.style={stroke:"rgba(0,0,0,0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:2};this.parameter={};this.parameter.points=function(a){return function(b){if(void 0==b)return a.points;a.points=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",d=this;do a=d.name+"/"+a;
while(void 0!=(d=d.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?e(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=this.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};
this.isPointWithin=function(a,d){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:d},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:d},this.extremities.points),a):!1};this.render=function(a,d,e){d=void 0===d?{x:0,y:0,a:0}:d;e=void 0===e?!1:e;var b=
this._static?!0:g.library.math.detectOverlap.boundingBoxes(c.viewport.getBoundingBox(),this.extremities.boundingBox);if(b){b=this.points.map(function(a){a=g.library.math.cartesianAngleAdjust(a.x,a.y,d.a);return{x:a.x+d.x,y:a.y+d.y}});var k=this.style.lineWidth;e||(b=b.map(function(a){return f.workspacePoint2windowPoint(a.x,a.y)}),k=f.length(k));a.fillStyle=this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=k;a.lineCap=this.style.lineCap;a.lineJoin=this.style.lineJoin;a.miterLimit=this.style.miterLimit;
a.beginPath();a.moveTo(b[0].x,b[0].y);for(e=1;e<b.length;e++)a.lineTo(b[e].x,b[e].y);a.stroke();if(this.dotFrame){for(e=0;e<this.extremities.points.length;e++)a=f.workspacePoint2windowPoint(this.extremities.points[e].x,this.extremities.points[e].y),c.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);c.render.drawDot(a.x,a.y);a=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,
this.extremities.boundingBox.bottomRight.y);c.render.drawDot(a.x,a.y)}}}};this.rectangle=function(){this.type="rectangle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;this.style={fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);
this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);this.parameter.width=function(a){return function(b){if(void 0==b)return a.width;a.width=b;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(b){if(void 0==
b)return a.height;a.height=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",d=this;do a=d.name+"/"+a;while(void 0!=(d=d.parent));return"/"+a};this.getOffset=function(){return e(this)};this.computeExtremities=function(a,d){d=this._static;for(var b=this;void 0!=(b=b.parent)&&!d;)d=d||b._static;this._static=d;a=void 0==a?e(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);
this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,d){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:d},this.extremities.boundingBox);
return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:d},this.extremities.points),a):!1};this.render=function(a,d,e,l){d=void 0===d?{x:0,y:0,a:0}:d;e=void 0===e?!1:e;l=void 0===l?!1:l;var b=this._static?!0:g.library.math.detectOverlap.boundingBoxes(c.viewport.getBoundingBox(),this.extremities.boundingBox);if(b){b=g.library.math.cartesianAngleAdjust(this.x,this.y,d.a);d.x+=b.x-this.x;d.y+=b.y-this.y;b=this.angle+
d.a;var h=this.width,r=this.height,n=this.style.lineWidth;d={x:this.x+d.x-this.anchor.x*(this.width*Math.cos(b)+this.height*Math.sin(-b)),y:this.y+d.y-this.anchor.y*(this.width*Math.sin(b)+this.height*Math.cos(-b))};e||(d=f.workspacePoint2windowPoint(d.x,d.y),h=f.length(h),r=f.length(r),n=f.length(n));d=g.library.math.cartesianAngleAdjust(d.x,d.y,-b);if(l)a.rotate(b),e=new Path2D,e.rect(d.x,d.y,h,r),a.clip(e),a.rotate(-b);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=
n,a.save(),a.rotate(b),a.fillRect(d.x,d.y,h,r),a.strokeRect(d.x,d.y,h,r),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)e=f.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),c.render.drawDot(e.x,e.y,4,"rgba(50,50,50,1)");e=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);c.render.drawDot(e.x,e.y);e=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);
c.render.drawDot(e.x,e.y)}}}};this.group=function(){function a(a,b){if(void 0==b)return a.getAddress()+" >> no element provided";if(void 0==b.name||""==b.name)return a.getAddress()+" >> element has no name";for(var d=0;d<a.children.length;d++)if(a.children[d].name==b.name)return'element with the name "'+b.name+'" already exists in the '+(void 0==parent?"design root":'group "'+a.name+'"')}this.type="group";this.name="";this.clipActive=this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;
this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.children=[];this.clippingStencil;this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities(void 0,!0)}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities(void 0,!0)}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities(void 0,!0)}}(this);this.getAddress=
function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.clip=function(a){if(void 0==a)return this.clipActive;this.clipActive=void 0==this.clippingStencil?!1:a;this.computeExtremities()};this.stencil=function(a){if(void 0==a)return this.clippingStencil;this.clippingStencil=a;this.computeExtremities()};this.prepend=function(b){var d=a(this,b);void 0!=d?console.error("element invalid:",d):(this.children.unshift(b),b.parent=this,b.computeExtremities(void 0,!0))};this.append=
function(b){var d=a(this,b);void 0!=d?console.error("element invalid:",d):(this.children.push(b),b.parent=this,b.computeExtremities(void 0,!0))};this.remove=function(a){void 0!=a&&(a=this.children.indexOf(a),0>a||(this.children.splice(a,1),this.computeExtremities()))};this.clear=function(){this.children=[];this.computeExtremities()};this.contains=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b]==a)return!0;return!1};this.getChildByName=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b].name==
a)return this.children[b]};this.getElementsWithName=function(a){for(var b=[],d=0;d<this.children.length;d++)if(this.children[d].name==a&&b.push(this.children[d]),"group"==this.children[d].type)for(var c=this.children[d].getElementsWithName(a),e=0;e<c.length;e++)b.push(c[e]);return b};this.getOffset=function(){return e(this)};this.computeExtremities=function(a,b){b=void 0===b?!1:b;for(var d=void 0==a,c=this._static,f=this;void 0!=(f=f.parent)&&!c;)c=c||f._static;this._static=c;a=void 0==a?e(this):
a;if(b)for(b={x:a.x,y:a.y,a:a.a+this.angle},c=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a),b.x+=c.x,b.y+=c.y,c=0;c<this.children.length;c++)this.children[c].computeExtremities(b,!0);this.extremities={points:[],boundingBox:{}};if(this.clipActive)b={x:a.x,y:a.y,a:a.a+this.angle},c=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a),b.x+=c.x,b.y+=c.y,this.clippingStencil.computeExtremities(b),this.extremities.points=this.clippingStencil.extremities.points;else{a=[];for(c=0;c<this.children.length;c++)a.push(this.children[c].extremities.boundingBox.topLeft),
a.push(this.children[c].extremities.boundingBox.bottomRight);a=g.library.math.boundingBoxFromPoints(a);this.extremities.points=[{x:a.topLeft.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.bottomRight.y},{x:a.topLeft.x,y:a.bottomRight.y}]}this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&d&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(this.clipActive)return this.clippingStencil.isPointWithin(a,
b);if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var d=!1}else d=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return d?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.getElementUnderPoint=function(a,b,c,e){c=void 0===c?!1:c;e=void 0===e?!1:e;for(var d=[],k=this.children.length-
1;0<=k;k--){var l=this.children[k]._static||c?f.workspacePoint2windowPoint(a,b):{x:a,y:b};if(!this.children[k].ignored&&this.children[k].isPointWithin(l.x,l.y))if("group"==this.children[k].type){if(l=this.children[k].getElementUnderPoint(a,b,this.children[k]._static||c,e),void 0!=l)if(e)d=d.concat(l);else return l}else if(e)d.push(this.children[k]);else return this.children[k]}if(e)return d};this.render=function(a,b,e,k){b=void 0===b?{x:0,y:0,a:0}:b;e=void 0===e?!1:e;k=void 0===k?!1:k;a:if(this._static)var d=
!0;else{for(d=0;d<this.children.length;d++)if(this.children[d]._static){d=!0;break a}d=g.library.math.detectOverlap.boundingBoxes(c.viewport.getBoundingBox(),this.extremities.boundingBox)}if(d){d=g.library.math.cartesianAngleAdjust(this.x,this.y,b.a);b={a:b.a+this.angle,x:b.x+d.x,y:b.y+d.y};if(this.clipActive||k)a.save(),this.clippingStencil.render(a,Object.assign({},b),e||this.clippingStencil._static,k||this.clipActive);for(k=0;k<this.children.length;k++)d=this.children[k],d.render(a,Object.assign({},
b),e||d._static);this.clipActive&&a.restore();if(this.dotFrame){for(k=0;k<this.extremities.points.length;k++)a=f.workspacePoint2windowPoint(this.extremities.points[k].x,this.extremities.points[k].y),c.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);c.render.drawDot(a.x,a.y);a=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);c.render.drawDot(a.x,
a.y)}}}};this.text=function(){this.type="text";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.y=this.x=0;this.text="curve";this.angle=0;this.size=1;this.style={font:"30pt Arial",align:"start",baseline:"alphabetic",fill:"rgba(255,100,100,1)",stroke:"rgba(0,0,0,0)",lineWidth:1};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=
function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.size=function(a){return function(b){if(void 0==b)return a.size;a.size=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",d=this;do a=d.name+"/"+a;while(void 0!=(d=d.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=
(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?e(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfText(this.text,this.x,this.y,this.angle,1/this.size,this.style.font,this.style.align,this.style.baseline);this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);
void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,d){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:d},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:d},this.extremities.points),a):!1};this.render=function(a,d,e,
l){d=void 0===d?{x:0,y:0,a:0}:d;e=void 0===e?!1:e;l=void 0===l?!1:l;var b=g.library.math.cartesianAngleAdjust(this.x,this.y,d.a);d.x+=b.x-this.x;d.y+=b.y-this.y;b={x:this.x+d.x,y:this.y+d.y};var q=this.size;d=this.angle+d.a;var r=this.style.lineWidth;e||(b=f.workspacePoint2windowPoint(b.x,b.y),q=f.length(q));b=g.library.math.cartesianAngleAdjust(b.x,b.y,-d);if(l)console.warn("no clipping available for text shape");else if(a.font=this.style.font,a.textAlign=this.style.align,a.textBaseline=this.style.baseline,
a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=r,a.save(),a.rotate(d),a.scale(q,q),a.fillText(this.text,b.x/q,b.y/q),a.strokeText(this.text,b.x/q,b.y/q),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)e=f.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),c.render.drawDot(e.x,e.y,4,"rgba(50,50,50,1)");e=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);c.render.drawDot(e.x,
e.y);e=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);c.render.drawDot(e.x,e.y)}}}};this.arrangement=new function(){var b=new a.group;b.name="root";this.createElement=function(b){return new a[b]};this.clear=function(){b.clear()};this.get=function(){return b};this.set=function(a){b=a};this.prepend=function(a){b.prepend(a)};this.append=function(a){b.append(a)};this.remove=function(a){b.remove(a)};this.getElementUnderPoint=function(a,
c,e,f){return b.getElementUnderPoint(a,c,void 0===e?!1:e,void 0===f?!1:f)};this.getElementsWithName=function(a){return b.getElementsWithName(a)}};this.viewport=new function(){function a(){function a(a){var d=a.charAt(0).toUpperCase()+a.slice(1),e=g.getAttribute("workspace"+d);if(c[a]!=e||c["window"+d]!=window["inner"+d])c[a]=e,c["window"+d]=window["inner"+d],void 0==e?(g[a]=c.defaultSize[a]*window.devicePixelRatio,g.style[a]=c.defaultSize[a]+"px"):e.indexOf("%")==e.length-1?(d=g.parentElement["offset"+
d],e=parseFloat(e.slice(0,e.length-1))/100,g[a]=d*e*window.devicePixelRatio,g.style[a]=d*e+"px"):(g[a]=e*window.devicePixelRatio,g.style[a]=e+"px"),b=!0}var b=!1;a("height");a("width");b&&d()}function d(){e.points.tl=f.windowPoint2workspacePoint(0,0);e.points.tr=f.windowPoint2workspacePoint(g.width,0);e.points.bl=f.windowPoint2workspacePoint(0,g.height);e.points.br=f.windowPoint2workspacePoint(g.width,g.height);e.boundingBox=g.library.math.boundingBoxFromPoints([e.points.tl,e.points.tr,e.points.br,
e.points.bl])}var c={defaultSize:{width:640,height:480},width:0,height:0,windowWidth:0,windowHeight:0},e={position:{x:0,y:0},scale:window.devicePixelRatio,angle:0,points:{tl:{x:0,y:0},tr:{x:0,y:0},bl:{x:0,y:0},br:{x:0,y:0}},boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}}},k=void 0,q=void 0,r=!1,n=!0;this.position=function(a,b){if(void 0==a||void 0==b)return{x:e.position.x,y:e.position.y};e.position.x=a;e.position.y=b;d()};this.scale=function(a){if(void 0==a)return e.scale;e.scale=0==a?window.devicePixelRatio:
a;d()};this.angle=function(a){if(void 0==a)return e.angle;e.angle=a;d()};this.windowPoint2workspacePoint=function(a,b){return f.windowPoint2workspacePoint(a,b)};this.refresh=function(){a();d();this.allowKeyboardInput(n)};this.getBoundingBox=function(){return e.boundingBox};this.mousePosition=function(a,b){if(void 0==a||void 0==b)return{x:k,y:q};k=a;q=b};this.stopMouseScroll=function(a){if(void 0==a)return r;r=a;a||(document.body.style.overflow="")};this.allowKeyboardInput=function(a){if(void 0==a)return n;
(n=a)?g.setAttribute("tabIndex",1):g.removeAttribute("tabIndex")};this.cursor=function(a){if(void 0==a)return document.body.style.cursor;document.body.style.cursor=a}};this.render=new function(){function a(a){void 0!==a&&a||(e.fillStyle=k,e.fillRect(0,0,g.width,g.height));c.arrangement.get().render(e)}function d(b){f=requestAnimationFrame(d);try{a()}catch(r){c.render.active(!1),console.error("major animation error"),console.error(r)}c.stats.collect(b)}var e=g.getContext("2d",{alpha:!1}),f=void 0,
k="rgb(255,255,255)";this.clearColour=function(a){if(void 0==a)return k;k=a};this.drawDot=function(a,b,d,c){d=void 0===d?2:d;e.fillStyle=void 0===c?"rgba(150,150,255,1)":c;e.beginPath();e.arc(a,b,d,0,2*Math.PI,!1);e.closePath();e.fill()};this.frame=function(b){a(void 0===b?!1:b)};this.active=function(a){if(void 0==a)return void 0!=f;a?void 0==f&&d():void 0!=f&&(cancelAnimationFrame(f),f=void 0)}};this.stats=new function(){var a=!1,d=0,c={compute:function(a){this.frameTimeArray.push(1E3/(a-d));30<=
this.frameTimeArray.length&&this.frameTimeArray.shift();this.rate=g.library.math.averageArray(this.frameTimeArray);d=a},counter:0,frameTimeArray:[],rate:0},e={recursiveCount:function(a){void 0==a&&(this.counts={total:0,canvas:0,circle:0,group:0,image:0,path:0,polygon:0,rectangle:0,text:0},a=g.core.arrangement.get());this.counts.total++;switch(a.type){case "canvas":this.counts.canvas++;break;case "circle":this.counts.circle++;break;case "group":this.counts.group++;break;case "image":this.counts.image++;
break;case "path":this.counts.path++;break;case "polygon":this.counts.polygon++;break;case "rectangle":this.counts.rectangle++;break;case "text":this.counts.text++}if(void 0!=a.children)for(var b=0;b<a.children.length;b++)this.recursiveCount(a.children[b])},recursivePrint:function(a,b){b=void 0===b?"":b;void 0==a&&(a=g.core.arrangement.get());console.log(b+a.name);if(void 0!=a.children)for(var d=0;d<a.children.length;d++)this.recursivePrint(a.children[d],b+"- ")},counts:{total:0,canvas:0,circle:0,
group:0,image:0,path:0,polygon:0,rectangle:0,text:0}};this.collect=function(b){a&&c.compute(b)};this.active=function(b){if(void 0==b)return a;a=b};this.getReport=function(){e.recursiveCount();return{framesPerSecond:c.rate,shapeCount:e.counts}}};this.callback=new function(){for(var a="onmousedown onmouseup onmousemove onmouseenter onmouseleave onwheel onclick ondblclick onkeydown onkeyup touchstart touchmove touchend touchenter touchleave touchcancel".split(" "),d={},e=0;e<a.length;d={$jscomp$loop$prop$getRelevantShape$8:d.$jscomp$loop$prop$getRelevantShape$8},
e++){d.$jscomp$loop$prop$getRelevantShape$8=function(a,b,d){var e=c.arrangement.getElementUnderPoint(a,b);if(void 0!=e&&void 0==e[d])for(a=c.arrangement.getElementUnderPoint(a,b,void 0,!0),b=0;b<a.length;b++)if(void 0!=a[b][d]){e=a[b];break}return e};this[a[e]]=function(a,b,d){};var l=0,k=0;g[a[e]]=function(a){return function(b){return function(d){if(c.callback[b]){var e=f.windowPoint2workspacePoint(d.x,d.y),k=a.$jscomp$loop$prop$getRelevantShape$8(e.x,e.y,b);c.callback[b](e.x,e.y,d,k)}}}}(d)(a[e]);
g.onmouseover=function(a){return function(b){c.viewport.stopMouseScroll()&&(document.body.style.overflow="hidden");if(c.callback.onmouseover){var d=f.windowPoint2workspacePoint(b.x,b.y),e=a.$jscomp$loop$prop$getRelevantShape$8(d.x,d.y,"onmouseover");c.callback.onmouseover(d.x,d.y,b,e)}}}(d);g.onmouseout=function(a){return function(b){c.viewport.stopMouseScroll()&&(document.body.style.overflow="");if(c.callback.onmouseout){var d=f.windowPoint2workspacePoint(b.x,b.y),e=a.$jscomp$loop$prop$getRelevantShape$8(d.x,
d.y,"onmouseout");c.callback.onmouseout(d.x,d.y,b,e)}}}(d);g.onmousemove=function(a){return function(b){var d=f.windowPoint2workspacePoint(b.x,b.y);c.viewport.mousePosition(d.x,d.y);if(c.callback.onmousemove){var e=a.$jscomp$loop$prop$getRelevantShape$8(l,k,"onmouseleave"),g=a.$jscomp$loop$prop$getRelevantShape$8(d.x,d.y,"onmouseenter"),q=a.$jscomp$loop$prop$getRelevantShape$8(d.x,d.y,"onmousemove");e!=g&&(c.callback.onmouseleave(d.x,d.y,b,e),c.callback.onmouseenter(d.x,d.y,b,g));c.callback.onmousemove(d.x,
d.y,b,q);l=d.x;k=d.y}}}(d);g.onkeydown=function(a){return function(b){if(c.callback.onkeydown){var d=c.viewport.mousePosition(),e=a.$jscomp$loop$prop$getRelevantShape$8(d.x,d.y,"onkeydown");c.callback.onkeydown(d.x,d.y,b,e)}}}(d);g.onkeyup=function(a){return function(b){if(c.callback.onkeyup){var d=c.viewport.mousePosition(),e=a.$jscomp$loop$prop$getRelevantShape$8(d.x,d.y,"onkeyup");c.callback.onkeyup(d.x,d.y,b,e)}}}(d)}};c.viewport.refresh();c.arrangement.clear()};this.arrangement=new function(){this.get=
function(){return m.arrangement.get()};this.set=function(e){return m.arrangement.set(e)};this.createElement=function(e){return m.arrangement.createElement(e)};this.append=function(e){return m.arrangement.append(e)};this.prepend=function(e){return m.arrangement.prepend(e)};this.remove=function(e){return m.arrangement.remove(e)};this.getElementUnderPoint=function(e,c){return m.arrangement.getElementUnderPoint(e,c)};this.getElementsWithName=function(e){return m.arrangement.getElementsWithName(e)};this.forceRefresh=
function(e){return m.arrangement.forceRefresh(e)}};this.viewport=new function(){this.position=function(e,c){return m.viewport.position(e,c)};this.scale=function(e){return m.viewport.scale(e)};this.angle=function(e){return m.viewport.angle(e)};this.windowPoint2workspacePoint=function(e,c){return m.viewport.windowPoint2workspacePoint(e,c)};this.refresh=function(){m.viewport.refresh()};this.mousePosition=function(){return m.viewport.mousePosition()};this.stopMouseScroll=function(e){return m.viewport.stopMouseScroll(e)};
this.allowKeyboardInput=function(e){return m.viewport.allowKeyboardInput(e)};this.cursor=function(e){return m.viewport.cursor(e)}};this.render=new function(){this.clearColour=function(e){return m.render.clearColour(e)};this.frame=function(e){return m.render.frame(void 0===e?!1:e)};this.active=function(e){return m.render.active(e)}};this.stats=new function(){this.active=function(e){return m.stats.active(e)};this.getReport=function(){return m.stats.getReport()}};this.callback=new function(){this.onmousedown=
function(e,c,f,a){};m.callback.onmousedown=function(e){return function(c,f,a,b){e.onmousedown(c,f,a,b)}}(this);this.onmouseup=function(e,c,f,a){};m.callback.onmouseup=function(e){return function(c,f,a,b){e.onmouseup(c,f,a,b)}}(this);this.onmousemove=function(e,c,f,a){};m.callback.onmousemove=function(e){return function(c,f,a,b){e.onmousemove(c,f,a,b)}}(this);this.onmouseenter=function(e,c,f,a){};m.callback.onmouseenter=function(e){return function(c,f,a,b){e.onmouseenter(c,f,a,b)}}(this);this.onmouseleave=
function(e,c,f,a){};m.callback.onmouseleave=function(e){return function(c,f,a,b){e.onmouseleave(c,f,a,b)}}(this);this.onwheel=function(e,c,f,a){};m.callback.onwheel=function(e){return function(c,f,a,b){e.onwheel(c,f,a,b)}}(this);this.onclick=function(e,c,f,a){};m.callback.onclick=function(e){return function(c,f,a,b){e.onclick(c,f,a,b)}}(this);this.ondblclick=function(e,c,f,a){};m.callback.ondblclick=function(e){return function(c,f,a,b){e.ondblclick(c,f,a,b)}}(this);this.onkeydown=function(e,c,f,a){};
m.callback.onkeydown=function(e){return function(c,f,a,b){e.onkeydown(c,f,a,b)}}(this);this.onkeyup=function(e,c,f,a){};m.callback.onkeyup=function(e){return function(c,f,a,b){e.onkeyup(c,f,a,b)}}(this);this.touchstart=function(e,c,f){};m.callback.touchstart=function(e){return function(c,f,a,b){e.touchstart(c,f,a)}}(this);this.touchmove=function(e,c,f){};m.callback.touchmove=function(e){return function(c,f,a,b){e.touchmove(c,f,a)}}(this);this.touchend=function(e,c,f){};m.callback.touchend=function(e){return function(c,
f,a,b){e.touchend(c,f,a)}}(this);this.touchenter=function(e,c,f){};m.callback.touchenter=function(e){return function(c,f,a,b){e.touchenter(c,f,a)}}(this);this.touchleave=function(e,c,f){};m.callback.touchleave=function(e){return function(c,f,a,b){e.touchleave(c,f,a)}}(this);this.touchcancel=function(e,c,f){};m.callback.touchcancel=function(e){return function(c,f,a,b){e.touchcancel(c,f,a)}}(this)}};g.system=new function(){};g.system.mouse=new function(){function m(e,c,f,a,b){if(void 0==b)return!1;
do if(void 0!=b[e])return b[e](c,f,a),!0;while(void 0!=(b=b.parent));return!1}this.tmp={};this.functionList={};this.mouseInteractionHandler=function(e,c){g.system.mouse.tmp.onmousemove_old=g.onmousemove;g.system.mouse.tmp.onmouseleave_old=g.onmouseleave;g.system.mouse.tmp.onmouseup_old=g.onmouseup;g.onmousemove=function(c){void 0!=e&&e(c)};g.onmouseup=function(e){void 0!=c&&c(e);g.onmousemove=g.system.mouse.tmp.onmousemove_old;g.onmouseleave=g.system.mouse.tmp.onmouseleave_old;g.onmouseup=g.system.mouse.tmp.onmouseup_old};
g.onmouseleave=g.onmouseup};this.forceMouseUp=function(){g.onmouseup()};g.core.callback.onmousedown=function(e,c,f,a){m("onmousedown",e,c,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmousedown,g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};g.core.callback.onmousemove=function(e,c,f,a){m("onmousemove",e,c,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmousemove,g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};g.core.callback.onmouseup=
function(e,c,f,a){m("onmouseup",e,c,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseup,g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};g.core.callback.onmouseleave=function(e,c,f,a){m("onmouseleave",e,c,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseleave,g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};g.core.callback.onmouseenter=function(e,c,f,a){m("onmouseenter",e,c,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseenter,
g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};g.core.callback.onwheel=function(e,c,f,a){m("onwheel",e,c,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onwheel,g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};g.core.callback.onclick=function(e,c,f,a){m("onclick",e,c,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onclick,g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};g.core.callback.ondblclick=function(e,c,f,a){m("ondblclick",e,c,f,a)||
g.library.structure.functionListRunner(g.system.mouse.functionList.ondblclick,g.system.keyboard.pressedKeys)({event:f,x:e,y:c})};this.functionList.onmousedown=[];this.functionList.onmousemove=[];this.functionList.onmouseup=[];this.functionList.onmouseleave=[];this.functionList.onmouseenter=[];this.functionList.onwheel=[];this.functionList.onclick=[];this.functionList.ondblclick=[]};g.system.keyboard=new function(){function m(c,e,a,b,d){if(void 0==d)return!1;do if(void 0!=d[c])return d[c](e,a,b),!0;
while(void 0!=(d=d.parent));return!1}function e(c,e){var a=g.system.keyboard.pressedKeys;if("ControlLeft"==c.code||"ControlRight"==c.code)a.control=e;else if("AltLeft"==c.code||"AltRight"==c.code)a.alt=e;else if("MetaLeft"==c.code||"MetaRight"==c.code)a.meta=e;else if("ShiftLeft"==c.code||"ShiftRight"==c.code)a.shift=e;-1!=window.navigator.platform.indexOf("Mac")&&(a.option=a.alt,a.command=a.meta)}g.core.callback.onkeydown=function(c,f,a,b){g.system.keyboard.pressedKeys[a.code]||(g.system.keyboard.pressedKeys[a.code]=
!0,e(a,!0),m("onkeydown",c,f,a,b)||g.library.structure.functionListRunner(g.system.keyboard.functionList.onkeydown,g.system.keyboard.pressedKeys)({event:a,x:c,y:f}))};g.core.callback.onkeyup=function(c,f,a,b){g.system.keyboard.pressedKeys[a.code]&&(delete g.system.keyboard.pressedKeys[a.code],e(a,!1),m("onkeyup",c,f,a,b)||g.library.structure.functionListRunner(g.system.keyboard.functionList.onkeyup,g.system.keyboard.pressedKeys)({event:a,x:c,y:f}))};this.releaseAll=function(){for(var c=0;c<this.pressedKeys.length;c++)this.releaseKey(this.pressedKeys[c])};
this.releaseKey=function(c){g.onkeyup(new KeyboardEvent("keyup",{code:c}))};this.pressedKeys={control:!1,alt:!1,meta:!1};this.functionList={};this.functionList.onkeydown=[];this.functionList.onkeyup=[]};g.system.pane={};g.system.pane.background=g.core.arrangement.createElement("group");g.system.pane.background.name="background";g.system.pane.background._static=!0;g.system.pane.background.ignored=!0;g.core.arrangement.append(g.system.pane.background);g.system.pane.middleground=g.core.arrangement.createElement("group");
g.system.pane.middleground.name="middleground";g.core.arrangement.append(g.system.pane.middleground);g.system.pane.middleground.back=g.core.arrangement.createElement("group");g.system.pane.middleground.back.name="back";g.system.pane.middleground.append(g.system.pane.middleground.back);g.system.pane.middleground.middle=g.core.arrangement.createElement("group");g.system.pane.middleground.middle.name="middle";g.system.pane.middleground.append(g.system.pane.middleground.middle);g.system.pane.middleground.front=
g.core.arrangement.createElement("group");g.system.pane.middleground.front.name="front";g.system.pane.middleground.append(g.system.pane.middleground.front);g.system.pane.foreground=g.core.arrangement.createElement("group");g.system.pane.foreground.name="foreground";g.system.pane.foreground._static=!0;g.core.arrangement.append(g.system.pane.foreground);g.system.pane.b=g.system.pane.background;g.system.pane.mb=g.system.pane.middleground.back;g.system.pane.mm=g.system.pane.middleground.middle;g.system.pane.mf=
g.system.pane.middleground.front;g.system.pane.f=g.system.pane.foreground;g.system.pane.getMiddlegroundPane=function(m){do{if(m==g.system.pane.mb)return g.system.pane.mb;if(m==g.system.pane.mm)return g.system.pane.mm;if(m==g.system.pane.mf)return g.system.pane.mf}while(void 0!=(m=m.parent))};g._interface=new function(){var m=this;this.circuit=new function(){this.recorder=function(e){function c(){switch(a.recordingNode.node.state){case "inactive":case "paused":return f.recordingLength;case "recording":return e.currentTime-
f.recordingStartTime}}var f={recordedChunks:[],recordingStartTime:-1,recordingLength:0},a={leftIn:{},rightIn:{},recordingNode:{},leftOut:{},rightOut:{}};a.leftIn.node=e.createAnalyser();a.rightIn.node=e.createAnalyser();a.recordingNode.audioDest=new MediaStreamAudioDestinationNode(e);a.recordingNode.node=new MediaRecorder(a.recordingNode.audioDest.stream,{mimeType:"audio/webm"});a.recordingNode.node.onstart=function(){};a.recordingNode.node.ondataavailable=function(a){f.recordedChunks.push(a.data)};
a.recordingNode.node.onpause=function(){};a.recordingNode.node.onresume=function(){};a.recordingNode.node.onerror=function(a){console.log(a)};a.recordingNode.node.onstop=function(){};a.leftIn.node.connect(a.recordingNode.audioDest);a.rightIn.node.connect(a.recordingNode.audioDest);a.leftOut.node=e.createAnalyser();a.leftIn.node.connect(a.leftOut.node);a.rightOut.node=e.createAnalyser();a.rightIn.node.connect(a.rightOut.node);this.clear=function(){this.stop();f.recordedChunks=[];f.recordingStartTime=
-1;f.recordingLength=0};this.start=function(){this.clear();a.recordingNode.node.start();f.recordingStartTime=e.currentTime};this.pause=function(){"inactive"!=this.state()&&(f.recordingLength=c(),a.recordingNode.node.pause())};this.resume=function(){a.recordingNode.node.resume();f.recordingStartTime=e.currentTime-f.recordingLength};this.stop=function(){"inactive"!=this.state()&&(f.recordingLength=c(),a.recordingNode.node.stop())};this.export=function(){return new Blob(f.recordedChunks,{type:"audio/ogg; codecs=opus"})};
this.save=function(a){a=void 0===a?"output":a;var b=document.createElement("a");b.href=URL.createObjectURL(this.export());b.download=a+".ogg";document.body.appendChild(b);b.click();document.body.removeChild(b)};this.state=function(){return a.recordingNode.node.state};this.recordingTime=function(){return c()};this.getTrack=function(){return this.export()};this.in_left=function(){return a.leftIn.node};this.in_right=function(){return a.rightIn.node};this.out_left=function(){return a.leftOut.node};this.out_right=
function(){return a.rightOut.node}};this.audioIn=function(e,c){c=void 0===c?!0:c;var f=1;var a=e.createGain();g.library.audio.changeAudioParam(e,a.gain,f);this.out=function(){return a};this.listDevices=function(a){navigator.mediaDevices.enumerateDevices().then(function(b){a(b.filter(function(a){return"audioinput"===a.kind}))})};this.selectDevice=function(b){navigator.mediaDevices.getUserMedia({audio:{deviceId:b}}).then(function(b){audioDevice=b;g.library.audio.context.createMediaStreamSource(b).connect(a)},
function(a){console.warn('could not find audio input device: "'+b+'"');console.warn("\terror:",a)})};this.gain=function(b){if(null==b)return f;f=b;g.library.audio.changeAudioParam(e,a.gain,b)};c&&this.selectDevice("default")};this.looper=function(e){var c=this,f=!1,a=1,b=!0,d=0,h=1,l={},k=null,q={};q=e.createChannelSplitter(2);var r=e.createGain();r.gain.setTargetAtTime(1,e.currentTime,0);q.connect(r,0);var n=e.createGain();n.gain.setTargetAtTime(1,e.currentTime,0);q.connect(n,1);this.out_left=function(){return r};
this.out_right=function(){return n};this.load=function(a,b,d){f=!1;g.library.audio.loadAudioFile(function(a){c.stop();l=a;f=!0;b(a)},a,void 0===d?"":d)};this.start=function(){f&&(k&&(k.onended=function(){},k.stop(0)),k=g.library.audio.loadBuffer(e,l.buffer,q),k.playbackRate.value=a,k.loop=b,k.loopStart=d*this.duration(),k.loopEnd=h*this.duration(),k.start(0,0),k.onended=function(){k=null})};this.stop=function(){f&&k&&(k.stop(0),k=void 0)};this.rate=function(){a=value};this.duration=function(){return f?
l.duration:-1};this.title=function(){return f?l.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&f?g.library.audio.waveformSegment(l.buffer,a):[]};this.loop=function(a){if(void 0==data)return data;b=void 0===a?!1:a};this.loopBounds=function(a){a=void 0===a?{start:0,end:1}:a;if(void 0==a)return a;d=void 0!=a.start?a.start:d;h=void 0!=a.end?a.end:h}};this.oneShot_single=function(e){var c=this,f=!1,a=1,b={},d=null,h={};h=e.createChannelSplitter(2);var l=e.createGain();
l.gain.setTargetAtTime(1,e.currentTime,0);h.connect(l,0);var k=e.createGain();k.gain.setTargetAtTime(1,e.currentTime,0);h.connect(k,1);this.out_left=function(){return l};this.out_right=function(){return k};this.load=function(a,d,e){f=!1;g.library.audio.loadAudioFile(function(a){c.stop();b=a;f=!0;d(a)},a,void 0===e?"":e)};this.fire=function(){f&&(d&&(d.onended=function(){},d.stop(0)),d=g.library.audio.loadBuffer(e,b.buffer,h),d.playbackRate.value=a,d.start(0,0),d.onended=function(){d=null})};this.stop=
function(){f&&(d.stop(0),d=void 0)};this.rate=function(){a=value};this.duration=function(){return f?b.duration:-1};this.title=function(){return f?b.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&f?g.library.audio.waveformSegment(b.buffer,a):[]}};this.oneShot_multi=function(e){var c=this,f=!1,a=1,b={},d=[],h={};h=e.createChannelSplitter(2);var l=e.createGain();l.gain.setTargetAtTime(1,e.currentTime,0);h.connect(l,0);var k=e.createGain();k.gain.setTargetAtTime(1,
e.currentTime,0);h.connect(k,1);this.audioOut=function(a){switch(a){case "r":return k;case "l":return l;default:console.error('"part.circuit.alpha.oneShot_multi.audioOut" unknown channel "'+a+'"')}};this.out_left=function(){return this.audioOut("l")};this.out_right=function(){return this.audioOut("r")};this.loadRaw=function(a){0!==Object.keys(a).length&&(b=a,f=!0)};this.load=function(a,b,d){f=!1;g.library.audio.loadAudioFile(function(a){c.loadRaw(a);void 0!=b&&b(a)},a,d)};this.unloadRaw=function(){return b};
this.fire=function(c,k){c=void 0===c?0:c;if(f){var l=g.library.audio.loadBuffer(e,b.buffer,h,function(){d.splice(d.indexOf(this),1)});l.playbackRate.value=a;l.start(0,c*a,k*a);d.push(l)}};this.panic=function(){for(;0<d.length;)d.shift().stop(0)};this.rate=function(b){if(void 0==b)return a;0==b&&(b=1E-6);a=b};this.duration=function(){return f?b.duration/a:-1};this.title=function(){return f?b.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&f?g.library.audio.waveformSegment(b.buffer,
a):[]}};this.audio2percentage=function(){return new function(){var e=null,c=null;var f=g.library.audio.context.createAnalyser();f.fftSize=128;e=new Uint8Array(f.fftSize);new Uint8Array(f.fftSize);this.__render=function(){f.getByteTimeDomainData(e);for(var a=[],b=0;b<e.length;b++)a.push(e[b]/128-1);var d=0;a.forEach(function(a){Math.abs(a)>d&&(d=Math.abs(a))});this.newValue(d)};this.audioIn=function(){return f};this.start=function(){c=setInterval(function(a){a.__render()},1E3/30,this)};this.stop=function(){clearInterval(c)};
this.newValue=function(a){}}};this.reverbUnit=function(e){function c(b,d,c){var f=new XMLHttpRequest;f.open("GET",b+d,!0);f.responseType="arraybuffer";f.onload=function(){a.reverbNode.node.disconnect();a.reverbNode.node=e.createConvolver();a.reverbGain.node.connect(a.reverbNode.node);a.reverbNode.node.connect(a.outAggregator.node);e.decodeAudioData(f.response,function(b){a.reverbNode.node.buffer=b},function(a){console.warn("Error with decoding audio data"+a.err)});c&&c()};f.send()}function f(a,d){d=
void 0===d?null:d;var b=new XMLHttpRequest;b.open("GET",a+"available2.list",!0);b.onload=function(){var a=b.response.split("\n");a[a.length-1]=a[a.length-1].split("");a[a.length-1].pop();a[a.length-1]=a[a.length-1].join("");a.splice(-1,1);null==d?console.log(a):d(a)};b.send()}var a={inAggregator:{},reverbGain:{},bypassGain:{},reverbNode:{},outAggregator:{}};a.inAggregator.gain=1;a.inAggregator.node=e.createGain();g.library.audio.changeAudioParam(e,a.inAggregator.node.gain,a.inAggregator.gain,.01,
"instant",!0);a.reverbGain.gain=.5;a.bypassGain.gain=.5;a.reverbGain.node=e.createGain();a.bypassGain.node=e.createGain();g.library.audio.changeAudioParam(e,a.reverbGain.node.gain,a.reverbGain.gain,.01,"instant",!0);g.library.audio.changeAudioParam(e,a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0);a.reverbNode.impulseResponseRepoURL="https://metasophiea.com/lib/audio/impulseResponse/";a.reverbNode.selectedReverbType="Musikvereinsaal.wav";a.reverbNode.node=e.createConvolver();a.outAggregator.gain=
1;a.outAggregator.node=e.createGain();g.library.audio.changeAudioParam(e,a.outAggregator.node.gain,a.outAggregator.gain,.01,"instant",!0);a.inAggregator.node.connect(a.reverbGain.node);a.inAggregator.node.connect(a.bypassGain.node);a.reverbGain.node.connect(a.reverbNode.node);a.bypassGain.node.connect(a.outAggregator.node);a.reverbNode.node.connect(a.outAggregator.node);this.in=function(){return a.inAggregator.node};this.out=function(){return a.outAggregator.node};this.getTypes=function(b){f(a.reverbNode.impulseResponseRepoURL,
b)};this.type=function(b,d){if(null==b)return a.reverbNode.selectedReverbType;a.reverbNode.selectedReverbType=b;c(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType,d)};this.outGain=function(b){if(null==b)return a.outAggregator.gain;a.outAggregator.gain=b;g.library.audio.changeAudioParam(e,a.outAggregator.node.gain,b,.01,"instant",!0)};this.wetdry=function(b){if(null==b)return a.reverbGain.gain;a.reverbGain.gain=b;a.bypassGain.gain=1-b;g.library.audio.changeAudioParam(e,a.reverbGain.node.gain,
a.reverbGain.gain,.01,"instant",!0);g.library.audio.changeAudioParam(e,a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0)};c(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType)};this.multibandFilter=function(e,c,f){function a(a){var b={frequency:110,Q:.1,node:e.createBiquadFilter()};b.node.type=a;g.library.audio.changeAudioParam(e,b.node.frequency,110,.01,"instant",!0);g.library.audio.changeAudioParam(e,b.node.Q,.1,.01,"instant",!0);return b}f=void 0===f?!1:f;var b=[],d=[],
h=[],l=[];var k=e.createGain();g.library.audio.changeAudioParam(e,k.gain,1,.01,"instant",!0);if(f){2>c&&(c=2);h.push(a("lowpass"));for(f=1;f<c-1;f++)h.push(a("bandpass"));h.push(a("highpass"))}else for(f=0;f<c;f++)h.push(a("bandpass"));for(f=0;f<c;f++){var q={gain:1,node:e.createGain()};g.library.audio.changeAudioParam(e,q.node.gain,q.gain,.01,"instant",!0);l.push(q);b[f]={Q:.1,gain:1,frequency:110,fresh:!0}}var r=1;var n=e.createGain();g.library.audio.changeAudioParam(e,n.gain,r,.01,"instant",!0);
for(f=0;f<c;f++)k.connect(h[f].node),h[f].node.connect(l[f].node),l[f].node.connect(n);this.in=function(){return k};this.out=function(){return n};this.masterGain=function(a){if(void 0==a)return r;r=a;g.library.audio.changeAudioParam(e,n.gain,r,.01,"instant",!0)};this.gain=function(a,d){if(void 0==d)return l[a].gain;l[a].gain=d;g.library.audio.changeAudioParam(e,l[a].node.gain,l[a].gain,.01,"instant",!0);b[a].gain=d;b[a].fresh=!0};this.frequency=function(a,d){if(void 0==d)return h[a].frequency;h[a].frequency=
d;g.library.audio.changeAudioParam(e,h[a].node.frequency,h[a].frequency,.01,"instant",!0);b[a].frequency=d;b[a].fresh=!0};this.Q=function(a,d){if(void 0==d)return h[a].Q;h[a].Q=d;g.library.audio.changeAudioParam(e,h[a].node.Q,h[a].Q,.01,"instant",!0);b[a].Q=d;b[a].fresh=!0};this.measureFrequencyResponse=function(a,e){var f=this;if(void 0==a)return Array(c).fill(0).map(function(a,b){return f.measureFrequencyResponse(b,e)});if(!b[a].fresh)return[d[a].magResponse.map(function(a){return a*r}),d[a].requencyArray];
var k=new Float32Array(e),g=new Float32Array(k.length),q=new Float32Array(k.length);h[a].node.getFrequencyResponse(k,g,q);d[a]={magResponse:g.map(function(b){return b*l[a].gain}),phaseResponse:q,frequencyArray:e};b[a].fresh=!1;return[g.map(function(b){return b*l[a].gain*r}),e]}};this.distortionUnit=function(e){function c(){f.inAggregator.node.disconnect();f.distortionNode.node&&f.distortionNode.node.disconnect();f.distortionNode.node=e.createWaveShaper();f.distortionNode.curve=new Float32Array(g.library.math.curveGenerator.s(f.distortionNode.resolution,
-1,1,f.distortionNode.distortionAmount));f.distortionNode.node.curve=f.distortionNode.curve;f.distortionNode.node.oversample=f.distortionNode.oversample;f.inAggregator.node.connect(f.distortionNode.node);f.distortionNode.node.connect(f.outAggregator.node)}var f={inAggregator:{},distortionNode:{},outAggregator:{}};f.inAggregator.gain=0;f.inAggregator.node=e.createGain();g.library.audio.changeAudioParam(e,f.inAggregator.node.gain,f.inAggregator.gain,.01,"instant",!0);f.distortionNode.distortionAmount=
0;f.distortionNode.oversample="none";f.distortionNode.resolution=100;f.outAggregator.gain=0;f.outAggregator.node=e.createGain();g.library.audio.changeAudioParam(e,f.outAggregator.node.gain,f.outAggregator.gain,.01,"instant",!0);this.in=function(){return f.inAggregator.node};this.out=function(){return f.outAggregator.node};this.inGain=function(a){if(null==a)return f.inAggregator.gain;f.inAggregator.gain=a;g.library.audio.changeAudioParam(e,f.inAggregator.node.gain,a,.01,"instant",!0)};this.outGain=
function(a){if(null==a)return f.outAggregator.gain;f.outAggregator.gain=a;g.library.audio.changeAudioParam(e,f.outAggregator.node.gain,a,.01,"instant",!0)};this.distortionAmount=function(a){if(null==a)return f.distortionNode.distortionAmount;f.distortionNode.distortionAmount=a;c()};this.oversample=function(a){if(null==a)return f.distortionNode.oversample;f.distortionNode.oversample=a;c()};this.resolution=function(a){if(null==a)return f.distortionNode.resolution;f.distortionNode.resolution=2<=a?a:
2;c()};c()};this.player=function(e){function c(){clearInterval(a.loop.timeout);a.playhead.position=a.itself.currentTime();a.playhead.lastSightingTime=e.currentTime;if(a.loop.active&&a.playing){var b=a.loop.end-a.itself.currentTime();0>b&&(b=0);a.loop.timeout=setTimeout(function(){a.itself.jumpTo(a.loop.start,!1);c()},1E3*b/a.rate)}}function f(b){a.fileLoaded&&(a.playing?(a.loop.active&&b>a.loop.end&&(b=a.loop.start),a.itself.stop(function(){a.playhead.position=b;a.playhead.lastSightingTime=e.currentTime;
a.itself.start()})):(a.playhead.position=b,a.playhead.lastSightingTime=e.currentTime))}var a={itself:this,fileLoaded:!1,playing:!1,playhead:{position:0,lastSightingTime:0},loop:{active:!1,start:0,end:1,timeout:null},rate:1},b={},d=null,h={};h=e.createChannelSplitter(2);var l=e.createGain();l.gain.setTargetAtTime(1,e.currentTime,0);h.connect(l,0);var k=e.createGain();k.gain.setTargetAtTime(1,e.currentTime,0);h.connect(k,1);this.out_left=function(){return l};this.out_right=function(){return k};this.unloadRaw=
function(){return b};this.loadRaw=function(d,c){0!==Object.keys(d).length&&(a.itself.stop(),b=d,a.fileLoaded=!0,a.playhead.position=0,c(d))};this.load=function(d,c,e){a.fileLoaded=!1;g.library.audio.loadAudioFile(function(d){a.itself.stop();b=d;a.fileLoaded=!0;a.playhead.position=0;c(d)},d,void 0===e?"":e)};this.start=function(){!a.playing&&a.fileLoaded&&(d=g.library.audio.loadBuffer(e,b.buffer,h,function(b){a.itself.stop()}),d.loop=a.loop.active,d.loopStart=a.loop.start,d.loopEnd=a.loop.end,d.playbackRate.value=
a.rate,d.start(0,a.playhead.position),a.playhead.lastSightingTime=e.currentTime,a.playing=!0,c())};this.stop=function(b){a.playing&&(b&&(d.onended=function(){b()}),d.stop(0),d=void 0,c(),a.playing=!1)};this.jumpTo=function(a,b){a=void 0===a?0:a;void 0===b||b?(a=1<a?1:a,a=0>a?0:a,f(this.duration()*a)):f(a);c()};this.loop=function(b,e){b=void 0===b?{active:!1,start:0,end:1}:b;e=void 0===e?!0:e;if(void 0==b)return a.loop;void 0!=b.active&&(a.loop.active=b.active,d&&(d.loop=b.active));if(void 0!=b.start||
void 0!=b.end)e=e?this.duration():1,a.loop.start=void 0!=b.start?b.start*e:a.loop.start,a.loop.end=void 0!=b.end?b.end*e:a.loop.end,d&&(d.loopStart=a.loop.start,d.loopEnd=a.loop.end);c()};this.rate=function(b){b=void 0===b?1:b;a.rate=b;d&&(d.playbackRate.value=b);c()};this.isLoaded=function(){return a.fileLoaded};this.duration=function(){return a.fileLoaded?b.duration:-1};this.title=function(){return a.fileLoaded?b.name:""};this.currentTime=function(){return a.fileLoaded?a.playing?a.playhead.position+
a.rate*(e.currentTime-a.playhead.lastSightingTime):a.playhead.position:-1};this.progress=function(){return this.currentTime()/this.duration()};this.waveformSegment=function(d,c){d=void 0===d?{start:0,end:1}:d;return void 0!=d&&a.fileLoaded?g.library.audio.waveformSegment(b.buffer,d,c):[]}};this.channelMultiplier=function(e,c){c=void 0===c?2:c;var f=[];var a=1;var b=e.createGain();g.library.audio.changeAudioParam(e,b.gain,a,.01,"instant",!0);for(var d=0;d<c;d++){var h={gain:.5,node:e.createGain()};
g.library.audio.changeAudioParam(e,h.node.gain,h.gain,.01,"instant",!0);f.push(h);b.connect(h.node)}this.in=function(){return b};this.out=function(a){return f[a].node};this.inGain=function(d){if(void 0==d)return a;a=d;g.library.audio.changeAudioParam(e,b.gain,a,.01,"instant",!0)};this.outGain=function(a,b){if(void 0==b)return f[a].gain;f[a].gain=b;g.library.audio.changeAudioParam(e,f[a].node.gain,f[a].gain,.01,"instant",!0)}};this.filterUnit=function(e){var c=e.createGain();g.library.audio.changeAudioParam(e,
c.gain,1,.01,"instant",!0);var f=e.createBiquadFilter();f.type="lowpass";g.library.audio.changeAudioParam(e,f.frequency,110,.01,"instant",!0);g.library.audio.changeAudioParam(e,f.gain,1,.01,"instant",!0);g.library.audio.changeAudioParam(e,f.Q,.1,.01,"instant",!0);var a=e.createGain();g.library.audio.changeAudioParam(e,a.gain,1,.01,"instant",!0);c.connect(f);f.connect(a);this.in=function(){return c};this.out=function(){return a};this.type=function(a){f.type=a};this.frequency=function(a){g.library.audio.changeAudioParam(e,
f.frequency,a,.01,"instant",!0)};this.gain=function(a){g.library.audio.changeAudioParam(e,f.gain,a,.01,"instant",!0)};this.Q=function(a){g.library.audio.changeAudioParam(e,f.Q,a,.01,"instant",!0)};this.measureFrequencyResponse=function(a,d,c){for(var b=[];a<d;a+=c)b.push(a);return this.measureFrequencyResponse_values(b)};this.measureFrequencyResponse_values=function(a){var b=new Float32Array(a),c=new Float32Array(b.length),e=new Float32Array(b.length);f.getFrequencyResponse(b,c,e);return[c,a]}};this.synthesizer=
function(e,c,f,a,b,d,h,l,k,q,r,n,v,t,p,z){f=void 0===f?{sin:[0,1],cos:[0,0]}:f;a=void 0===a?1:a;b=void 0===b?0:b;d=void 0===d?0:d;h=void 0===h?.01:h;l=void 0===l?1:l;k=void 0===k?{time:.01,curve:"linear"}:k;q=void 0===q?{time:.05,curve:"linear"}:q;p=void 0===p?.01:p;z=void 0===z?1:z;var y={},A={},x={},u={};y.waveType=void 0===c?"sine":c;y.periodicWave=f;y.attack=k;y.release=q;y.octave=void 0===r?0:r;y.detune=void 0===n?0:n;y.func=function(a,b,d,c,e,f,k,l,h,r){return new function(){this.generator=
a.createOscillator();"custom"==c?this.generator.setPeriodicWave(a.createPeriodicWave(new Float32Array(e.cos),new Float32Array(e.sin))):this.generator.type=c;this.generator.frequency.setTargetAtTime(g.library.audio.num2freq(d+12*r),a.currentTime,0);this.generator.detune.setTargetAtTime(h,a.currentTime,0);this.generator.start(0);this.gain=a.createGain();this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,a.currentTime,0);g.library.audio.changeAudioParam(a,this.gain.gain,f,k.time,k.curve,
!1);this.gain.connect(b);this.detune=function(b,d,c){g.library.audio.changeAudioParam(a,this.generator.detune,b,d,c)};this.changeVelocity=function(b){g.library.audio.changeAudioParam(a,this.gain.gain,b,k.time,k.curve)};this.stop=function(){g.library.audio.changeAudioParam(a,this.gain.gain,0,l.time,l.curve,!1);setTimeout(function(a){a.gain.disconnect();a.generator.stop();a.generator.disconnect();a.gain=null;a.generator=null},1E3*l.time,this)}}};x.depth=void 0===v?0:v;x.period=void 0===t?0:t;x.phase=
!0;x.wave="s";x.interval=null;x.start=function(){x.period<p||x.period>=z||(x.interval=setInterval(function(){var a=Object.keys(A);if(x.phase)for(var b=0;b<a.length;b++)A[a[b]].detune(x.depth,.9*x.period,x.wave);else for(b=0;b<a.length;b++)A[a[b]].detune(-x.depth,.9*x.period,x.wave);x.phase=!x.phase},1E3*x.period))};x.stop=function(){clearInterval(x.interval)};var E=e.createGain();E.gain.setTargetAtTime(1,e.currentTime,0);u.depth=b;u.period=d;u.phase=!0;u.wave="s";u.interval=null;u.start=function(){u.period<
h||u.period>=l?g.library.audio.changeAudioParam(e,u.node.gain,1,.01,u.wave):u.interval=setInterval(function(){u.phase?g.library.audio.changeAudioParam(e,u.node.gain,1,.9*u.period,u.wave):g.library.audio.changeAudioParam(e,u.node.gain,1-u.depth,.9*u.period,u.wave);u.phase=!u.phase},1E3*u.period)};u.stop=function(){clearInterval(u.interval)};u.node=e.createGain();u.node.gain.setTargetAtTime(1,e.currentTime,0);E.connect(u.node);var B=e.createGain();B.gain.setTargetAtTime(a,e.currentTime,0);u.node.connect(B);
this.out=function(){return B};this.perform=function(a){if(A[a.num]||0!=a.velocity)A[a.num]?0==a.velocity?(A[a.num].stop(),delete A[a.num]):A[a.num].changeVelocity(a.velocity):A[a.num]=y.func(e,E,a.num,y.waveType,y.periodicWave,a.velocity,y.attack,y.release,y.detune,y.octave)};this.panic=function(){for(var a=Object.keys(A),b=0;b<a.length;b++)this.perform({num:a[b],velocity:0})};this.waveType=function(a){if(null==a)return y.waveType;y.waveType=a};this.periodicWave=function(a){if(null==a)return y.periodicWave;
y.periodicWave=a};this.gain=function(a,b,d){return g.library.audio.changeAudioParam(e,B.gain,a,b,d)};this.attack=function(a,b){if(null==a&&null==b)return y.attack;y.attack.time=a?a:y.attack.time;y.attack.curve=b?b:y.attack.curve};this.release=function(a,b){if(null==a&&null==b)return y.release;y.release.time=a?a:y.release.time;y.release.curve=b?b:y.release.curve};this.octave=function(a){if(null==a)return y.octave;y.octave=a};this.detune=function(a,b,d){if(null==a)return y.detune;var c=y.detune,e=a-
c,f=Math.round(Math.abs(e)),k=f*b,l=[1];switch(d){case "linear":l=system.utility.math.curveGenerator.linear(k);break;case "exponential":l=system.utility.math.curveGenerator.exponential(k);break;case "s":l=system.utility.math.curveGenerator.s(k,8)}if(0!=l.length)var g=setInterval(function(){y.detune=c+l.shift()*e;0==l.length&&clearInterval(g)},1E3/f);f=Object.keys(A);for(k=0;k<f.length;k++)A[f[k]].detune(a,b,d)};this.gainWobbleDepth=function(a){if(null==a)return u.depth;u.depth=a;u.stop();u.start()};
this.gainWobblePeriod=function(a){if(null==a)return u.period;u.period=a;u.stop();u.start()};this.detuneWobbleDepth=function(a){if(null==a)return x.depth;x.depth=a;x.stop();x.start()};this.detuneWobblePeriod=function(a){if(null==a)return x.period;x.period=a;x.stop();x.start()}}};this.part=new function(){var e=this;this.collection=new function(){this.basic=new function(){this.polygon=function(c,e,a,b,d,h,l,k){c=void 0===c?null:c;e=void 0===e?[]:e;a=void 0===a?!1:a;b=void 0===b?"rgba(255,100,255,1)":
b;d=void 0===d?"rgba(0,0,0,0)":d;h=void 0===h?1:h;l=void 0===l?"round":l;k=void 0===k?2:k;var f=g.core.arrangement.createElement("polygon");f.name=c;f.points=e;f.ignored=a;f.style.fill=b;f.style.stroke=d;f.style.lineWidth=h;f.style.lineJoin=l;f.style.miterLimit=k;return f};this.circle=function(c,e,a,b,d,h,l,k,q,r){c=void 0===c?null:c;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?2:b;d=void 0===d?!1:d;h=void 0===h?"rgba(255,100,255,1)":h;l=void 0===l?"rgba(0,0,0,0)":l;k=void 0===k?1:k;q=void 0===
q?"round":q;r=void 0===r?2:r;var f=g.core.arrangement.createElement("circle");f.name=c;f.x=e;f.y=a;f.r=b;f.ignored=d;f.style.fill=h;f.style.stroke=l;f.style.lineWidth=k;f.style.lineJoin=q;f.style.miterLimit=r;return f};this.canvas=function(c,e,a,b,d,h,l,k,q){c=void 0===c?null:c;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?10:b;d=void 0===d?10:d;h=void 0===h?0:h;l=void 0===l?{x:0,y:0}:l;k=void 0===k?!1:k;q=void 0===q?1:q;var f=g.core.arrangement.createElement("canvas");f.name=c;f.x=e;f.y=a;f.parameter.width(b);
f.parameter.height(d);f.resolution(q);f.angle=h;f.anchor=l;f.ignored=k;return f};this.image=function(c,e,a,b,d,h,l,k,q){c=void 0===c?null:c;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?10:b;d=void 0===d?10:d;h=void 0===h?0:h;l=void 0===l?{x:0,y:0}:l;k=void 0===k?!1:k;q=void 0===q?"":q;var f=g.core.arrangement.createElement("image");f.name=c;f.x=e;f.y=a;f.width=b;f.height=d;f.angle=h;f.anchor=l;f.ignored=k;f.url=q;return f};this.path=function(c,e,a,b,d,h,l,k){c=void 0===c?null:c;e=void 0===e?[]:
e;a=void 0===a?!1:a;b=void 0===b?"rgba(0,0,0,1)":b;d=void 0===d?1:d;h=void 0===h?"butt":h;l=void 0===l?"miter":l;k=void 0===k?2:k;var f=g.core.arrangement.createElement("path");f.name=c;f.points=e;f.ignored=a;f.style.stroke=b;f.style.lineWidth=d;f.style.lineCap=h;f.style.lineJoin=l;f.style.miterLimit=k;return f};this.rectangle=function(c,e,a,b,d,h,l,k,q,r,n,v,t){c=void 0===c?null:c;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?10:b;d=void 0===d?10:d;h=void 0===h?0:h;l=void 0===l?{x:0,y:0}:l;k=void 0===
k?!1:k;q=void 0===q?"rgba(255,100,255,1)":q;r=void 0===r?"rgba(0,0,0,0)":r;n=void 0===n?1:n;v=void 0===v?"round":v;t=void 0===t?2:t;var f=g.core.arrangement.createElement("rectangle");f.name=c;f.x=e;f.y=a;f.width=b;f.height=d;f.angle=h;f.anchor=l;f.ignored=k;f.style.fill=q;f.style.stroke=r;f.style.lineWidth=n;f.style.lineJoin=v;f.style.miterLimit=t;return f};this.group=function(c,e,a,b,d){c=void 0===c?null:c;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?0:b;d=void 0===d?!1:d;var f=g.core.arrangement.createElement("group");
f.name=c;f.x=e;f.y=a;f.angle=b;f.ignored=d;return f};this.text=function(c,e,a,b,d,h,l,k,q,r,n,v,t,p,z,y){c=void 0===c?null:c;e=void 0===e?0:e;a=void 0===a?0:a;b=void 0===b?"Hello":b;d=void 0===d?0:d;h=void 0===h?{x:0,y:0}:h;l=void 0===l?1:l;k=void 0===k?!1:k;q=void 0===q?"30pt Arial":q;r=void 0===r?"start":r;n=void 0===n?"alphabetic":n;v=void 0===v?"rgba(255,100,255,1)":v;t=void 0===t?"rgba(0,0,0,0)":t;p=void 0===p?1:p;z=void 0===z?"round":z;y=void 0===y?2:y;var f=g.core.arrangement.createElement("text");
f.name=c;f.x=e;f.y=a;f.text=b;f.angle=d;f.anchor=h;f.size=l;f.ignored=k;f.style.font=q;f.style.align=r;f.style.baseline=n;f.style.fill=v;f.style.stroke=t;f.style.lineWidth=p;f.style.lineJoin=z;f.style.miterLimit=y;return f}};this.control=new function(){this.rastorgrid=function(c,f,a,b,d,g,l,k,q,r,n,v,t,p){b=void 0===b?80:b;d=void 0===d?80:d;l=void 0===l?!0:l;k=void 0===k?5:k;q=void 0===q?5:q;r=void 0===r?"rgba(200,200,200,1)":r;n=void 0===n?"rgba(150,150,150,1)":n;v=void 0===v?"rgba(220,220,220,1)":
v;t=void 0===t?"rgba(220,220,220,1)":t;p=void 0===p?function(){}:p;var h=e.builder("group",void 0===c?"rastorgrid":c,{x:f,y:a,angle:void 0===g?0:g});for(a=0;a<q;a++)for(f=0;f<k;f++)c=e.builder("checkbox_rect",a+"_"+f,{x:b/k*f,y:d/q*a,width:b/k,height:d/q,interactable:l,style:{check:n,backing:r,checkGlow:t,backingGlow:v},onchange:function(){if(h.onchange)h.onchange(h.get())}}),h.append(c);h.box=function(a,b){return h.getChildByName(b+"_"+a)};h.get=function(){for(var a=[],b=0;b<q;b++){for(var d=[],
c=0;c<k;c++)d.push(this.box(c,b).get());a.push(d)}return a};h.set=function(a,b){for(b=0;b<q;b++)for(var d=0;d<k;d++)h.box(d,b).set(a[b][d],!1)};h.clear=function(){for(var a=0;a<q;a++)for(var b=0;b<k;b++)h.box(b,a).set(!1,!1)};h.light=function(a,b,d){h.box(a,b).light(d)};h.interactable=function(a){if(void 0==a)return l;l=a;for(var b=0;b<q;b++)for(var d=0;d<k;d++)h.getChildByName(b+"_"+d).interactable(a)};h.onchange=p;return h};this.needleOverlay=function(c,f,a,b,d,h,l,k,q,r,n,v,t,p){function z(a){return a.x*
Math.cos(B.__calculationAngle)-a.y*Math.sin(B.__calculationAngle)}function y(a){var c=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=c.x-m.extremities.points[0].x;c=c.y-m.extremities.points[0].y;return{x:(a*Math.cos(B.__calculationAngle)-c*Math.sin(B.__calculationAngle))/b,y:(c*Math.cos(B.__calculationAngle)-a*Math.sin(B.__calculationAngle))/d}}function A(a,d){var c="lead"==a?D:H;void 0==d||0>d||1<d?(c.remove(I[a]),delete E[a]):(c.contains(I[a])||c.append(I[a]),I[a].parameter.x(d*b-b*k*d),
E[a]=d)}function x(a,b){b=void 0===b?!0:b;if(q){if(void 0==a)return E.lead;1<a||0>a?A("lead"):A("lead",a);if(b&&void 0!=B.onchange)B.onchange("lead",a)}}function u(a,d,c){c=void 0===c?!0:c;if(r){if(void 0==a||void 0==d)return{A:E.selection_A,B:E.selection_B};1<a||0>a||1<d||0>d?(A("selection_A"),A("selection_B")):(A("selection_A",a),A("selection_B",d));if(void 0==E.selection_A||void 0==E.selection_B||E.selection_A==E.selection_B)H.remove(I.selection_area),B.selectionAreaToggle&&B.selectionAreaToggle(!1),
delete E.selection_area;else{H.contains(I.selection_area)||(H.append(I.selection_area),B.selectionAreaToggle&&B.selectionAreaToggle(!0));if(E.selection_A<E.selection_B)var e=E.selection_A,f=E.selection_B;else e=E.selection_B,f=E.selection_A;e=e-k*e+k;f=f-k*f-e;0>f&&(f=0);I.selection_area.parameter.x(b*e);I.selection_area.parameter.width(b*f)}if(c&&void 0!=B.onchange)B.onchange("selection_A",a);if(c&&void 0!=B.onchange)B.onchange("selection_B",d)}}b=void 0===b?120:b;d=void 0===d?60:d;h=void 0===h?
0:h;l=void 0===l?!0:l;k=void 0===k?1/512:k;q=void 0===q?!0:q;r=void 0===r?!0:r;n=void 0===n?["rgba(240, 240, 240, 1)","rgba(255, 231, 114, 1)"]:n;v=void 0===v?function(a,b){}:v;t=void 0===t?function(a,b){}:t;p=void 0===p?function(a){}:p;var E={},B=e.builder("group",void 0===c?"needleOverlay":c,{x:f,y:a,angle:h}),m=e.builder("rectangle","backing",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});B.append(m);c=e.builder("group","controlObjectsGroup");B.append(c);var H=e.builder("group","back");c.append(H);
var D=e.builder("group","front");c.append(D);c=b*k+.005*b;var I={};I.lead=e.builder("group","lead");I.lead.append(e.builder("rectangle","handle",{width:k*b,height:d,style:{fill:n[0]}}));I.lead.append(e.builder("rectangle","invisibleHandle",{x:(b*k-c)/2,width:c,height:d,style:{fill:"rgba(255,0,0,0)"}}));I.selection_A=e.builder("group","selection_A");I.selection_A.append(e.builder("rectangle","handle",{width:k*b,height:d,style:{fill:n[1]}}));I.selection_A.append(e.builder("rectangle","invisibleHandle",
{x:(b*k-c)/2,width:c,height:d,style:{fill:"rgba(255,0,0,0)"}}));I.selection_B=e.builder("group","selection_B");I.selection_B.append(e.builder("rectangle","handle",{width:k*b,height:d,style:{fill:n[1]}}));I.selection_B.append(e.builder("rectangle","invisibleHandle",{x:(b*k-c)/2,width:c,height:d,style:{fill:"rgba(255,0,0,0)"}}));I.selection_area=e.builder("rectangle","selection_area",{height:d,style:{fill:g.library.misc.blendColours(n[1],"rgba(0,0,0,0)",.5)}});I.markGroup=e.builder("group","markGroup");
H.append(I.markGroup);B.__calculationAngle=h;var w=!1,M=!1,aa=!1,V=!1;m.onmousedown=function(a,b,d){if(l)if(g.system.keyboard.pressedKeys.shift){var c=y(d).x;g.system.mouse.mouseInteractionHandler(function(a){B.area(c,y(a).x)})}else B.select(y(d).x)};I.lead.getChildByName("invisibleHandle").onmouseenter=function(a,b,d){g.core.viewport.cursor("col-resize")};I.lead.getChildByName("invisibleHandle").onmouseleave=function(a,b,d){g.core.viewport.cursor("default")};I.lead.getChildByName("invisibleHandle").onmousedown=
function(a,d,c){if(l){w=!0;var e=E.lead,f=z(c),h=b-b*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-z(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;x(1<a?1:a)},function(a){a=f-z(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;w=!1;x(a);if(void 0!=B.onrelease)B.onrelease("lead",a)})}};I.selection_A.getChildByName("invisibleHandle").onmouseenter=function(a,b,d){g.core.viewport.cursor("col-resize")};I.selection_A.getChildByName("invisibleHandle").onmouseleave=function(a,
b,d){g.core.viewport.cursor("default")};I.selection_A.getChildByName("invisibleHandle").onmousedown=function(a,d,c){if(l){aa=!0;var e=E.selection_A,f=z(c),h=b-b*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-z(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;u(1<a?1:a,E.selection_B)},function(a){a=f-z(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;aa=!1;u(a,E.selection_B);if(void 0!=B.onrelease)B.onrelease("selection_A",a)})}};I.selection_B.getChildByName("invisibleHandle").onmouseenter=
function(a,b,d){g.core.viewport.cursor("col-resize")};I.selection_B.getChildByName("invisibleHandle").onmouseleave=function(a,b,d){g.core.viewport.cursor("default")};I.selection_B.getChildByName("invisibleHandle").onmousedown=function(a,d,c){if(l){V=!0;var e=E.selection_B,f=z(c),h=b-b*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-z(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;u(E.selection_A,1<a?1:a)},function(a){a=f-z(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=
1<a?1:a;V=!1;u(E.selection_A,a);if(void 0!=B.onrelease)B.onrelease("selection_B",a)})}};I.selection_area.onmouseenter=function(a,b,d){g.core.viewport.cursor("grab")};I.selection_area.onmouseleave=function(a,b,d){g.core.viewport.cursor("default")};I.selection_area.onmousedown=function(a,d,c){function e(a){a=r-z(a);var b=g.core.viewport.scale();a={A:h.A-a/(b*q),B:h.B-a/(b*q)};1<a.A&&(a.A=1,a.B=1+f);1<a.B&&(a.B=1,a.A=1-f);0>a.A&&(a.A=0,a.B=f);0>a.B&&(a.B=0,a.A=-f);return a}if(l){g.core.viewport.cursor("grabbing");
M=!0;var f=E.selection_B-E.selection_A,h={A:E.selection_A,B:E.selection_B},r=z(c),q=b-b*k;g.system.mouse.mouseInteractionHandler(function(a){a=e(a);u(a.A,a.B)},function(a){g.core.viewport.cursor("grab");a=e(a);M=!1;u(a.A,a.B);if(void 0!=B.onrelease)B.onrelease("selection_A",a.A);if(void 0!=B.onrelease)B.onrelease("selection_B",a.B)})}};I.selection_A.ondblclick=function(a,b,d,c){l&&(u(-1,-1),g.core.viewport.cursor("default"))};I.selection_B.ondblclick=I.selection_A.ondblclick;I.selection_area.ondblclick=
I.selection_A.ondblclick;B.mark=function(a){var c=I.markGroup.getChildByName(""+a);void 0==c?(I.markGroup.append(e.builder("rectangle",""+a,{x:a*b,width:k*b,height:d,style:{fill:n[0]}})),a=!0):(I.markGroup.remove(c),a=!1);return a};B.removeAllMarks=function(){I.markGroup.clear()};B.select=function(a,b){b=void 0===b?!0:b;if(void 0==a)return x();w||x(a,b)};B.area=function(a,b,d){d=void 0===d?!0:d;if(void 0==a&&void 0==b)return u();M||void 0!=a&&aa||void 0!=b&&V||u(a,b,d)};B.interactable=function(a){if(void 0==
a)return l;l=a};B.onchange=v;B.onrelease=t;B.selectionAreaToggle=p;return B};this.slidePanel=function(c,f,a,b,d,g,l,k,q,r,n,v,t,p,z,y,A){b=void 0===b?80:b;d=void 0===d?95:d;g=void 0===g?0:g;l=void 0===l?!0:l;k=void 0===k?.1:k;q=void 0===q?8:q;r=void 0===r?0:r;n=void 0===n?.5:n;var h=e.builder("group",void 0===c?"slidePanel":c,{x:f,y:a,angle:g});for(c=0;c<q;c++)f=e.builder("slide_image","slide_"+c,{x:b/q*c,y:0,width:b/q,height:d,interactable:l,handleHeight:k,value:r,resetValue:n,handleURL:v,backingURL:t,
slotURL:p,onchange:function(a){if(h.onchange)h.onchange(this.id,a)},onrelease:function(a){if(h.onrelease)h.onrelease(this.id,a)}}),f.__calculationAngle=g,h.append(f);void 0!=z&&(b=e.builder("image","overlay",{width:b,height:d,url:z}),h.append(b));h.interactable=function(a){if(void 0==a)return l;l=a;for(var b=0;b<q;b++)h.children[b].interactable(a)};return h};this.rangeslide_image=function(c,f,a,b,d,h,l,k,q,r,n,v,t,p,z,y,A,x){function u(a,b,c){c=void 0===c?!0:c;a=1<a?1:a;a=0>a?0:a;switch(b){default:console.error("unknown handle to adjust");
break;case "start":1<=a/(1-k/(1-k))&&(a=1-k/(1-k));var e=a+(1-a)*k,f=r.end-r.end*k;e>=f&&(r.end=e/(1-k));break;case "end":1>=a/(k/(1-k))&&(a=k/(1-k)),e=r.start+(1-r.start)*k,f=a-a*k,e>=f&&(r.start=(f-k)/(1-k))}r[b]=a;M.start.parameter.y(r.start*d*(1-k));M.end.parameter.y(r.end*d*(1-k));w.parameter.y(d*(k+r.start-k*(r.start+.1)));w.parameter.height(d*(r.end-r.start+k*(r.start-r.end-1+.2)));if(c&&H.onchange)H.onchange(r)}function m(a,b){var d=D.getOffset();return g.library.math.cartesianAngleAdjust(a-
(D.x+d.x),b-(D.y+d.y),0-(D.angle+d.a)).y/I.height}c=void 0===c?"rangeslide_image":c;b=void 0===b?10:b;d=void 0===d?95:d;h=void 0===h?0:h;l=void 0===l?!0:l;k=void 0===k?.1:k;q=void 0===q?.75:q;r=void 0===r?{start:0,end:1}:r;n=void 0===n?{start:-1,end:-1}:n;z=void 0===z?"rgba(255,0,0,0)":z;A=void 0===A?function(){}:A;x=void 0===x?function(){}:x;if(void 0==v||void 0==t||void 0==p||void 0==y)return this.rangeslide(c,f,a,b,d,h,l,k,q,r,n,v,t,p,z,y,A,x);var B=!1,C=["start","end"],H=e.builder("group",c,{x:f,
y:a,angle:h}),D=e.builder("group","backingAndSlotGroup");H.append(D);c=e.builder("image","backing",{width:b,height:d,url:t});D.append(c);c=e.builder("image","slot",{x:.45*b,y:k/2*d,width:.1*b,height:d*(1-k),url:p});D.append(c);var I=e.builder("rectangle","backingAndSlotCover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});D.append(I);var w=e.builder("image","span",{x:(1-q)/2*b,y:d*k,width:b*q,height:d-2*d*k,url:p});H.append(w);var M={};for(q=0;q<C.length;q++)M[C[q]]=e.builder("group","handle_"+
q,{}),H.append(M[C[q]]),p=e.builder("image","handle",{width:b,height:d*k,url:v}),M[C[q]].append(p),p=d*k+.01*d,p=e.builder("rectangle","invisibleHandle",{y:(d*k-p)/2,width:b,height:p+k,style:{fill:z}}),M[C[q]].append(p);b=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});H.append(b);H.get=function(){return r};H.set=function(a,b){B||(void 0!=a.start&&u(a.start,"start",b),void 0!=a.end&&u(a.end,"end",b))};H.interactable=function(a){if(void 0==a)return l;l=a};w.onmousedown=
function(){};w.onclick=function(){};I.onmousedown=function(a,b,d){};I.onclick=function(a,b,d){l&&!B&&(a=m(a,b),a+=.5*k*(2*a-1),Math.abs(r.start-a)<Math.abs(r.end-a)?u(a,"start"):u(a,"end"))};b.ondblclick=function(){!l||0>n.start||0>n.end||B||(u(n.start,"start"),u(n.end,"end"),H.onrelease(r))};b.onwheel=function(){if(l&&!B){var a=event.deltaY/100,b=g.core.viewport.scale();a/=10*b;u(r.start-a,"start");u(r.end+a,"end")}};w.onmousedown=function(a,b,d){if(l){B=!0;var c=r.start,e=m(a,b);g.system.mouse.mouseInteractionHandler(function(a){a=
g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=m(a.x,a.y);a=c+(a-e);a=[a,a+(r.end-r.start)];0>=a[0]?(a[1]-=a[0],a[0]=0):1<=a[1]&&(a[0]-=a[1]-1,a[1]=1);u(a[0],"start");u(a[1],"end");H.onchange(r)},function(a){H.onrelease(r);B=!1})}};for(q=0;q<C.length;q++)M[C[q]].children[1].onmousedown=function(a){return function(b,d,c){if(l){B=!0;var e=r[C[a]],f=m(b,d);g.system.mouse.mouseInteractionHandler(function(b){b=g.core.viewport.windowPoint2workspacePoint(b.x,b.y);b=m(b.x,b.y);u(e+(b-f)/(1-k),C[a]);
H.onchange(r)},function(a){H.onrelease(r);B=!1})}}}(q);H.onchange=A;H.onrelease=x;u(0,"start");u(1,"end");return H};this.slide=function(c,f,a,b,d,h,l,k,q,r,n,v,t,p,z,y){function A(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=u.onchange)u.onchange(a);q=a;C.y=a*d*(1-k);H.y=C.y-.01*d/2;C.computeExtremities();H.computeExtremities()}function x(a){return a.y*Math.cos(u.__calculationAngle)-a.x*Math.sin(u.__calculationAngle)}b=void 0===b?10:b;d=void 0===d?95:d;h=void 0===h?0:h;l=void 0===l?!0:l;k=
void 0===k?.1:k;q=void 0===q?0:q;r=void 0===r?-1:r;n=void 0===n?"rgba(200,200,200,1)":n;v=void 0===v?"rgba(150,150,150,1)":v;t=void 0===t?"rgba(50,50,50,1)":t;p=void 0===p?"rgba(255,0,0,0)":p;z=void 0===z?function(){}:z;y=void 0===y?function(){}:y;var u=e.builder("group",void 0===c?"slide":c,{x:f,y:a,angle:h}),m=e.builder("group","backingAndSlotGroup");u.append(m);c=e.builder("rectangle","backing",{width:b,height:d,style:{fill:v}});m.append(c);t=e.builder("rectangle","slot",{x:.45*b,y:k/2*d,width:.1*
b,height:d*(1-k),style:{fill:t}});m.append(t);var B=e.builder("rectangle","backingAndSlotCover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});m.append(B);var C=e.builder("rectangle","handle",{width:b,height:d*k,style:{fill:n}});u.append(C);var H=e.builder("rectangle","invisibleHandle",{y:-(.01*d)/2,width:b,height:d*(k+.01)+k,style:{fill:p}});u.append(H);b=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});u.append(b);u.__calculationAngle=h;var D=!1;u.set=function(a,
b){D||A(a,b)};u.get=function(){return q};u.interactable=function(a){if(void 0==a)return l;l=a};b.ondblclick=function(){if(l&&!(0>r||D)&&(A(r),void 0!=u.onrelease))u.onrelease(q)};b.onwheel=function(){if(l&&!D){var a=event.deltaY/100,b=g.core.viewport.scale();A(q+a/(10*b));if(void 0!=u.onrelease)u.onrelease(q)}};B.onmousedown=function(a,b,d){};B.onclick=function(a,b,d){if(l&&!D&&(d=m.getOffset(),a=g.library.math.cartesianAngleAdjust(a-(m.x+d.x),b-(m.y+d.y),0-(m.angle+d.a)).y/B.height,a+=.5*k*(2*a-
1),A(a),void 0!=u.onrelease))u.onrelease(a)};H.onmousedown=function(a,b,c){if(l){D=!0;var e=q,f=x(c),h=d-d*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-x(a);var b=g.core.viewport.scale();A(e-a/(b*h)*window.devicePixelRatio)},function(a){a=f-x(a);var b=g.core.viewport.scale();u.onrelease(e-a/(b*h)*window.devicePixelRatio);D=!1})}};A(q);u.onchange=z;u.onrelease=y;return u};this.slidePanel=function(c,f,a,b,d,g,l,k,q,r,n,v,t,p,z,y){b=void 0===b?80:b;d=void 0===d?95:d;g=void 0===g?0:g;l=void 0===
l?!0:l;k=void 0===k?.1:k;q=void 0===q?8:q;r=void 0===r?0:r;n=void 0===n?.5:n;v=void 0===v?"rgba(200,200,200,1)":v;t=void 0===t?"rgba(150,150,150,1)":t;p=void 0===p?"rgba(50,50,50,1)":p;var h=e.builder("group",void 0===c?"slidePanel":c,{x:f,y:a,angle:g});for(c=0;c<q;c++)f=e.builder("slide","slide_"+c,{x:b/q*c,y:0,width:b/q,height:d,interactable:l,handleHeight:k,value:r,resetValue:n,style:{handle:v,backing:t,slot:p},onchange:function(a){if(h.onchange)h.onchange(this.id,a)},onrelease:function(a){if(h.onrelease)h.onrelease(this.id,
a)}}),f.__calculationAngle=g,h.append(f);h.interactable=function(a){if(void 0==a)return l;l=a;for(var b=0;b<q;b++)h.children[b].interactable(a)};return h};this.slide_image=function(c,f,a,b,d,h,l,k,q,r,n,v,t,p,z,y){function A(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=u.onchange)u.onchange(a);q=a;C.y=a*d*(1-k);H.y=C.y-.01*d/2;C.computeExtremities();H.computeExtremities()}function x(a){return a.y*Math.cos(u.__calculationAngle)-a.x*Math.sin(u.__calculationAngle)}c=void 0===c?"slide_image":
c;b=void 0===b?10:b;d=void 0===d?95:d;h=void 0===h?0:h;l=void 0===l?!0:l;k=void 0===k?.1:k;q=void 0===q?0:q;r=void 0===r?-1:r;p=void 0===p?"rgba(255,0,0,0)":p;z=void 0===z?function(){}:z;y=void 0===y?function(){}:y;if(void 0==n||void 0==v||void 0==t)return this.slide(c,f,a,b,d,h,l,k,q,r,n,v,t,p,z,y);var u=e.builder("group",c,{x:f,y:a,angle:h}),m=e.builder("group","backingAndSlotGroup");u.append(m);c=e.builder("image","backing",{width:b,height:d,url:v});m.append(c);t=e.builder("image","slot",{x:.45*
b,y:k/2*d,width:.1*b,height:d*(1-k),url:t});m.append(t);var B=e.builder("rectangle","backingAndSlotCover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});m.append(B);var C=e.builder("image","handle",{width:b,height:d*k,url:n});u.append(C);var H=e.builder("rectangle","invisibleHandle",{y:-(.01*d)/2,width:b,height:d*(k+.01)+k,style:{fill:p}});u.append(H);b=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});u.append(b);u.__calculationAngle=h;var D=!1;u.set=function(a,b){D||
A(a,b)};u.get=function(){return q};u.interactable=function(a){if(void 0==a)return l;l=a};b.ondblclick=function(){if(l&&!(0>r||D)&&(A(r),void 0!=u.onrelease))u.onrelease(q)};b.onwheel=function(){if(l&&!D){var a=event.deltaY/100,b=g.core.viewport.scale();A(q+a/(10*b));if(void 0!=u.onrelease)u.onrelease(q)}};B.onmousedown=function(a,b,d){};B.onclick=function(a,b,d){if(l&&!D&&(d=m.getOffset(),a=g.library.math.cartesianAngleAdjust(a-(m.x+d.x),b-(m.y+d.y),0-(m.angle+d.a)).y/B.height,a+=.5*k*(2*a-1),A(a),
void 0!=u.onrelease))u.onrelease(a)};H.onmousedown=function(a,b,c){if(l){D=!0;var e=q,f=x(c),h=d-d*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-x(a);var b=g.core.viewport.scale();A(e-a/(b*h)*window.devicePixelRatio)},function(a){a=f-x(a);var b=g.core.viewport.scale();u.onrelease(e-a/(b*h)*window.devicePixelRatio);D=!1})}};A(q);u.onchange=z;u.onrelease=y;return u};this.rangeslide=function(c,f,a,b,d,h,l,k,q,r,n,v,t,p,z,m,A,x){function u(a,b,c){c=void 0===c?!0:c;a=1<a?1:a;a=0>a?0:a;switch(b){default:console.error("unknown handle to adjust");
break;case "start":1<=a/(1-k/(1-k))&&(a=1-k/(1-k));var e=a+(1-a)*k,f=r.end-r.end*k;e>=f&&(r.end=e/(1-k));break;case "end":1>=a/(k/(1-k))&&(a=k/(1-k)),e=r.start+(1-r.start)*k,f=a-a*k,e>=f&&(r.start=(f-k)/(1-k))}r[b]=a;M.start.parameter.y(r.start*d*(1-k));M.end.parameter.y(r.end*d*(1-k));w.parameter.y(d*(k+r.start-k*(r.start+.1)));w.parameter.height(d*(r.end-r.start+k*(r.start-r.end-1+.2)));if(c&&H.onchange)H.onchange(r)}function y(a,b){var d=D.getOffset();return g.library.math.cartesianAngleAdjust(a-
(D.x+d.x),b-(D.y+d.y),0-(D.angle+d.a)).y/I.height}b=void 0===b?10:b;d=void 0===d?95:d;l=void 0===l?!0:l;k=void 0===k?.1:k;q=void 0===q?.75:q;r=void 0===r?{start:0,end:1}:r;n=void 0===n?{start:-1,end:-1}:n;v=void 0===v?"rgba(200,200,200,1)":v;t=void 0===t?"rgba(150,150,150,1)":t;p=void 0===p?"rgba(50,50,50,1)":p;z=void 0===z?"rgba(255,0,0,0)":z;m=void 0===m?"rgba(200,0,200,0.5)":m;A=void 0===A?function(){}:A;x=void 0===x?function(){}:x;var B=!1,C=["start","end"],H=e.builder("group",void 0===c?"rangeslide":
c,{x:f,y:a,angle:void 0===h?0:h}),D=e.builder("group","backingAndSlotGroup");H.append(D);c=e.builder("rectangle","backing",{width:b,height:d,style:{fill:t}});D.append(c);p=e.builder("rectangle","slot",{x:.45*b,y:k/2*d,width:.1*b,height:d*(1-k),style:{fill:p}});D.append(p);var I=e.builder("rectangle","backingAndSlotCover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});D.append(I);var w=e.builder("rectangle","span",{x:(1-q)/2*b,y:d*k,width:b*q,height:d-2*d*k,style:{fill:m}});H.append(w);var M={};
for(q=0;q<C.length;q++)M[C[q]]=e.builder("group","handle_"+q,{}),H.append(M[C[q]]),m=e.builder("rectangle","handle",{width:b,height:d*k,style:{fill:v}}),M[C[q]].append(m),m=d*k+.01*d,m=e.builder("rectangle","invisibleHandle",{y:(d*k-m)/2,width:b,height:m+k,style:{fill:z}}),M[C[q]].append(m);b=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});H.append(b);H.get=function(){return r};H.set=function(a,b){B||(void 0!=a.start&&u(a.start,"start",b),void 0!=a.end&&u(a.end,"end",
b))};H.interactable=function(a){if(void 0==a)return l;l=a};w.onmousedown=function(){};w.onclick=function(){};I.onmousedown=function(a,b,d){};I.onclick=function(a,b,d){l&&!B&&(a=y(a,b),a+=.5*k*(2*a-1),Math.abs(r.start-a)<Math.abs(r.end-a)?u(a,"start"):u(a,"end"))};b.ondblclick=function(){!l||0>n.start||0>n.end||B||(u(n.start,"start"),u(n.end,"end"),H.onrelease(r))};b.onwheel=function(){if(l&&!B){var a=event.deltaY/100,b=g.core.viewport.scale();a/=10*b;u(r.start-a,"start");u(r.end+a,"end")}};w.onmousedown=
function(a,b,d){if(l){B=!0;var c=r.start,e=y(a,b);g.system.mouse.mouseInteractionHandler(function(a){a=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=y(a.x,a.y);a=c+(a-e);a=[a,a+(r.end-r.start)];0>=a[0]?(a[1]-=a[0],a[0]=0):1<=a[1]&&(a[0]-=a[1]-1,a[1]=1);u(a[0],"start");u(a[1],"end");H.onchange(r)},function(a){H.onrelease(r);B=!1})}};for(q=0;q<C.length;q++)M[C[q]].children[1].onmousedown=function(a){return function(b,d,c){if(l){B=!0;var e=r[C[a]],f=y(b,d);g.system.mouse.mouseInteractionHandler(function(b){b=
g.core.viewport.windowPoint2workspacePoint(b.x,b.y);b=y(b.x,b.y);u(e+(b-f)/(1-k),C[a]);H.onchange(r)},function(a){H.onrelease(r);B=!1})}}}(q);H.onchange=A;H.onrelease=x;u(0,"start");u(1,"end");return H};this.checkbox_rectangle=function(c,f,a,b,d,g,l,k,q,r,n,v){c=void 0===c?"checkbox_rectangle":c;b=void 0===b?20:b;d=void 0===d?20:d;g=void 0===g?0:g;l=void 0===l?!0:l;k=void 0===k?"rgba(150,150,150,1)":k;q=void 0===q?"rgba(200,200,200,1)":q;r=void 0===r?"rgba(220,220,220,1)":r;n=void 0===n?"rgba(220,220,220,1)":
n;v=void 0===v?function(){}:v;var h=e.builder("group",c+"subGroup",{}),p=e.builder("rectangle","backing",{width:b,height:d,style:{fill:q}});h.append(p);var m=e.builder("rectangle","checkrect",{x:.1*b,y:.1*d,width:.8*b,height:.8*d,style:{fill:"rgba(0,0,0,0)"}});h.append(m);h.cover=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);c=e.builder("checkbox_",c,{x:f,y:a,angle:g,interactable:l,onchange:v,subject:h});c.updateGraphics=function(a){a.glowing?(p.style.fill=
n,m.style.fill=a.checked?r:"rgba(0,0,0,0)"):(p.style.fill=q,m.style.fill=a.checked?k:"rgba(0,0,0,0)")};c.updateGraphics({checked:!1,glowing:!1});return c};this.checkbox_image=function(c,f,a,b,d,g,l,k,q,r,n,v){c=void 0===c?"checkbox_image":c;b=void 0===b?20:b;d=void 0===d?20:d;g=void 0===g?0:g;l=void 0===l?!0:l;v=void 0===v?function(){}:v;n=e.builder("group",c+"subGroup",{});var h=e.builder("image","backing",{width:b,height:d,url:k});n.append(h);n.cover=e.builder("rectangle","cover",{width:b,height:d,
style:{fill:"rgba(0,0,0,0)"}});n.append(n.cover);c=e.builder("checkbox_",c,{x:f,y:a,angle:g,interactable:l,onchange:v,subject:n});c.updateGraphics=function(a){h.url=a.glowing?a.checked?r:uncheckGlowURL:a.checked?q:k};c.updateGraphics({checked:!1,glowing:!1});return c};this.checkbox_=function(c,f,a,b,d,g,l){c=void 0===c?"checkbox_":c;b=void 0===b?0:b;d=void 0===d?!0:d;g=void 0===g?function(){}:g;void 0==l&&console.warn("checkbox_ : No subject provided");var k=e.builder("group",c,{x:f,y:a,angle:b});
k.append(l);var h={checked:!1,glowing:!1};k.get=function(){return h.checked};k.set=function(a,b){b=void 0===b?!0:b;h.checked=a;k.updateGraphics(h);if(b&&this.onchange)this.onchange(a)};k.light=function(a){if(void 0==a)return a.glowing;a.glowing=a;k.updateGraphics(a)};k.interactable=function(a){if(void 0==a)return d;d=a};l.cover.onclick=function(a){d&&k.set(!k.get())};l.cover.onmousedown=function(){};k.onchange=g;return k};this.checkbox_polygon=function(c,f,a,b,d,g,l,k,q,r,n,v){c=void 0===c?"checkbox_polygon":
c;b=void 0===b?[{x:0,y:4},{x:4,y:0},{x:16,y:0},{x:20,y:4},{x:20,y:16},{x:16,y:20},{x:4,y:20},{x:0,y:16}]:b;d=void 0===d?[{x:2,y:4},{x:4,y:2},{x:16,y:2},{x:18,y:4},{x:18,y:16},{x:16,y:18},{x:4,y:18},{x:2,y:16}]:d;g=void 0===g?0:g;l=void 0===l?!0:l;k=void 0===k?"rgba(150,150,150,1)":k;q=void 0===q?"rgba(200,200,200,1)":q;r=void 0===r?"rgba(220,220,220,1)":r;n=void 0===n?"rgba(220,220,220,1)":n;v=void 0===v?function(){}:v;var h=e.builder("group",c+"subGroup",{}),p=e.builder("polygon","backing",{points:b,
style:{fill:q}});h.append(p);var m=e.builder("polygon","checkrect",{points:d,style:{fill:"rgba(0,0,0,0)"}});h.append(m);h.cover=e.builder("polygon","cover",{points:b,style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);c=e.builder("checkbox_",c,{x:f,y:a,angle:g,interactable:l,onchange:v,subject:h});c.updateGraphics=function(a){a.glowing?(p.style.fill=n,m.style.fill=a.checked?r:"rgba(0,0,0,0)"):(p.style.fill=q,m.style.fill=a.checked?k:"rgba(0,0,0,0)")};c.updateGraphics({checked:!1,glowing:!1});return c};
this.checkbox_circle=function(c,f,a,b,d,g,l,k,q,r,n){c=void 0===c?"checkbox_circle":c;b=void 0===b?10:b;d=void 0===d?0:d;g=void 0===g?!0:g;l=void 0===l?"rgba(150,150,150,1)":l;k=void 0===k?"rgba(200,200,200,1)":k;q=void 0===q?"rgba(220,220,220,1)":q;r=void 0===r?"rgba(220,220,220,1)":r;n=void 0===n?function(){}:n;var h=e.builder("group",c+"subGroup",{}),t=e.builder("circle","backing",{r:b,style:{fill:k}});h.append(t);var p=e.builder("circle","checkrect",{r:.8*b,style:{fill:"rgba(0,0,0,0)"}});h.append(p);
h.cover=e.builder("circle","cover",{r:b,style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);c=e.builder("checkbox_",c,{x:f,y:a,angle:d,interactable:g,onchange:n,subject:h});c.updateGraphics=function(a){a.glowing?(t.style.fill=r,p.style.fill=a.checked?q:"rgba(0,0,0,0)"):(t.style.fill=k,p.style.fill=a.checked?l:"rgba(0,0,0,0)")};c.updateGraphics({checked:!1,glowing:!1});return c};this.sequencer=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p,z,y,A,x,u,E,B,C,H,D,w,Ga,M){function v(a){var c=g.core.viewport.windowPoint2workspacePoint(a.x,
a.y);a=c.x-ca.extremities.points[0].x;c=c.y-ca.extremities.points[0].y;return{x:(a*Math.cos(J.__calculationAngle)-c*Math.sin(J.__calculationAngle))/b,y:(c*Math.cos(J.__calculationAngle)-a*Math.sin(J.__calculationAngle))/d}}function I(a){return{x:G.viewArea.topLeft.x+a.x*r,y:G.viewArea.topLeft.y+a.y*n}}function K(a){return{x:r*(a.x-G.viewposition.x)+G.viewposition.x,y:n*(a.y-G.viewposition.y)+G.viewposition.y}}function R(a){a.y=Math.floor(a.y*q);a.y>=q&&(a.y=q-1);a.x=F.snapping?Math.round(a.x*k/F.step)*
F.step:a.x*k;0>a.x&&(a.x=0);return{line:a.y,position:a.x}}function W(a,c,e){if(void 0==a&&void 0==c)return G.viewposition;if(void 0==a||isNaN(a))a=G.viewposition.x;if(void 0==c||isNaN(c))c=G.viewposition.y;a=0>a?0:a;a=1<a?1:a;c=0>c?0:c;c=1<c?1:c;G.viewposition.x=a;G.viewposition.y=c;O.parameter.x(-G.viewposition.x*(G.totalSize.width-b));O.parameter.y(-G.viewposition.y*(G.totalSize.height-d));G.viewArea={topLeft:{x:a-r*a,y:c-n*c},bottomRight:{x:a+r*(1-a),y:c+n*(1-c)}}}function X(a,c){if(void 0==a&&
void 0==c)return{x:r,y:n};if(void 0!=a&&a!=r&&void 0!=c&&c!=n){a=.01>a?.01:a;c=.01>c?.01:c;r=1<a?1:a;n=1<c?1:c;G.totalSize.width=b/r;G.totalSize.height=d/n;S.parameter.width(G.totalSize.width);S.parameter.height(G.totalSize.width);da.parameter.width(G.totalSize.width);da.parameter.height(G.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.x(b/(k*r)*a),P.children[a].parameter.width(b/(k*r)),P.children[a].parameter.height(G.totalSize.height);for(a=0;a<q;a++)Q.children[a].parameter.y(d/(q*n)*
a),Q.children[a].parameter.height(d/(q*n)),Q.children[a].parameter.width(G.totalSize.width);for(a=0;a<U.children.length;a++)U.children[a].unit(b/(k*r),d/(q*n));L.present&&(O.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(G.totalSize.height),O.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(G.totalSize.height),O.getElementsWithName("playhead")[0].parameter.x(G.totalSize.width/k*L.position))}else if(void 0!=a&&a!=r){a=
.01>a?.01:a;r=1<a?1:a;G.totalSize.width=b/r;S.parameter.width(G.totalSize.width);da.parameter.width(G.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.x(b/(k*r)*a),P.children[a].parameter.width(b/(k*r));for(a=0;a<q;a++)Q.children[a].parameter.width(G.totalSize.width);for(a=0;a<U.children.length;a++)U.children[a].unit(b/(k*r),void 0);L.present&&O.getElementsWithName("playhead")[0].parameter.x(G.totalSize.width/k*L.position)}else if(void 0!=c&&c!=n){c=.01>c?.01:c;n=1<c?1:c;G.totalSize.height=
d/n;S.parameter.height(G.totalSize.width);da.parameter.height(G.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.height(G.totalSize.height);for(a=0;a<q;a++)Q.children[a].parameter.y(d/(q*n)*a),Q.children[a].parameter.height(d/(q*n));for(a=0;a<U.children.length;a++)U.children[a].unit(void 0,d/(q*n));L.present&&(O.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(G.totalSize.height),O.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(G.totalSize.height))}}
function Y(a,c,e,f){f=void 0===f?F.defaultStrength:f;a=F.signalRegistry.add({line:a,position:c,length:e,strength:f});c=F.signalRegistry.getSignal(a);var h=ka.sequencer.signalBlock(a,b/(k*r),d/(q*n),c.line,c.position,c.length,c.strength,!1,p,z,y,A);U.append(h);h.select=function(a){a=void 0===a?!1:a;-1!=F.selectedSignals.indexOf(this)?a||this.deselect():(this.selected(!0),F.selectedSignals.push(this),this.glow(!0))};h.deselect=function(){F.selectedSignals.splice(F.selectedSignals.indexOf(this),1);this.selected(!1);
this.glow(!1)};h.delete=function(){this.deselect();F.signalRegistry.remove(parseInt(this.name));this.parent.remove(this)};h.ondblclick=function(a,b,d){if(g.system.keyboard.pressedKeys.control||g.system.keyboard.pressedKeys.command)for(a=0;a<F.selectedSignals.length;a++)F.selectedSignals[a].strength(F.defaultStrength),F.signalRegistry.update(parseInt(F.selectedSignals[a].name),{strength:F.defaultStrength})};h.body.onmousedown=function(a,b,c){if(l)if(g.system.keyboard.pressedKeys.Space)S.onmousedown(a,
b,c);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<F.selectedSignals.length;)F.selectedSignals[0].deselect();h.select(!0);var e=[];for(a=0;a<F.selectedSignals.length;a++)e.push({name:parseInt(F.selectedSignals[a].name),block:F.selectedSignals[a],starting:F.signalRegistry.getSignal(parseInt(F.selectedSignals[a].name))});if(g.system.keyboard.pressedKeys.control||g.system.keyboard.pressedKeys.command){var f=e.map(function(a){return a.block.strength()}),k=c.offsetY;g.system.mouse.mouseInteractionHandler(function(a){g.system.keyboard.pressedKeys.ControlLeft||
g.system.keyboard.pressedKeys.ControlRight||g.system.keyboard.pressedKeys.command||g.system.mouse.forceMouseUp();a=(k-a.offsetY)/(g.core.viewport.scale()*d*4);for(var b=0;b<e.length;b++)e[b].block.strength(f[b]+a),F.signalRegistry.update(e[b].name,{strength:f[b]+a})})}else{var r=!1,q=R(I(v(c)));g.system.mouse.mouseInteractionHandler(function(a){if(!r&&(r=!0,g.system.keyboard.pressedKeys.alt))for(var b=0;b<F.selectedSignals.length;b++){var d=F.signalRegistry.getSignal(parseInt(F.selectedSignals[b].name));
Y(d.line,d.position,d.length,d.strength)}b=R(I(v(a)));a=b.line-q.line;b=b.position-q.position;for(d=0;d<e.length;d++){F.signalRegistry.update(e[d].name,{line:e[d].starting.line+a,position:e[d].starting.position+b});var c=F.signalRegistry.getSignal(e[d].name);e[d].block.line(c.line);e[d].block.position(c.position)}})}}};h.body.onmousemove=function(a,b,d){a=g.system.keyboard.pressedKeys;b="default";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.body.onkeydown=function(a,b,d){l&&g.system.keyboard.pressedKeys.alt&&
g.core.viewport.cursor("copy")};h.body.onkeyup=function(a,b,d){l&&(g.system.keyboard.pressedKeys.alt||g.core.viewport.cursor("default"))};h.leftHandle.onmousedown=function(a,b,d){if(l)if(g.system.keyboard.pressedKeys.Space)S.onmousedown(a,b,d);else if(g.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,d);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<F.selectedSignals.length;)F.selectedSignals[0].deselect();h.select(!0);var c=[];for(a=0;a<F.selectedSignals.length;a++)c.push({name:parseInt(F.selectedSignals[a].name),
block:F.selectedSignals[a],starting:F.signalRegistry.getSignal(parseInt(F.selectedSignals[a].name))});var e=R(I(v(d)));g.system.mouse.mouseInteractionHandler(function(a){a=R(I(v(a)));a=e.position-a.position;for(var b=0;b<c.length;b++)if(!(0>c[b].starting.position-a)){F.signalRegistry.update(c[b].name,{length:c[b].starting.length+a,position:c[b].starting.position-a});var d=F.signalRegistry.getSignal(c[b].name);c[b].block.position(d.position);c[b].block.length(d.length)}})}};h.leftHandle.onmousemove=
function(a,b,d){a=g.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.leftHandle.onmouseleave=function(a,b,d){g.core.viewport.cursor("default")};h.rightHandle.onmousedown=function(a,b,d,c){c=void 0===c?!1:c;if(l)if(g.system.keyboard.pressedKeys.Space)S.onmousedown(a,b,d);else if(!c&&g.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,d);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<F.selectedSignals.length;)F.selectedSignals[0].deselect();
h.select(!0);var e=[];for(a=0;a<F.selectedSignals.length;a++)e.push({name:parseInt(F.selectedSignals[a].name),block:F.selectedSignals[a],starting:F.signalRegistry.getSignal(parseInt(F.selectedSignals[a].name))});var f=R(I(v(d)));g.system.mouse.mouseInteractionHandler(function(a){a=R(I(v(a))).position-f.position;for(var b=0;b<e.length;b++){F.signalRegistry.update(e[b].name,{length:e[b].starting.length+a});var d=F.signalRegistry.getSignal(e[b].name);e[b].block.position(d.position);e[b].block.length(d.length)}})}};
h.rightHandle.onmousemove=function(a,b,d){a=g.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.rightHandle.onmouseleave=function(a,b,d){g.core.viewport.cursor("default")};return{id:a,signalBlock:h}}function Z(){var a=e.builder("group","playhead");O.append(a);a.main=e.builder("rectangle","main",{x:-L.width/2,width:L.width,height:G.totalSize.height,style:{fill:D}});a.append(a.main);a.invisibleHandle=e.builder("rectangle","invisibleHandle",{x:-L.width*
L.invisibleHandleMux/2+L.width/2,width:L.width*L.invisibleHandleMux,height:G.totalSize.height,style:{fill:"rgba(255,0,0,0)"}});a.append(a.invisibleHandle);a.invisibleHandle.onmousedown=function(){l&&(L.held=!0,g.system.mouse.mouseInteractionHandler(function(a){J.playheadPosition(R(I(v(a))).position)},function(){L.held=!1}))};a.invisibleHandle.onmouseenter=function(a,b,d){g.core.viewport.cursor("col-resize")};a.invisibleHandle.onmousemove=function(a,b,d){g.core.viewport.cursor("col-resize")};a.invisibleHandle.onmouseleave=
function(a,b,d){g.core.viewport.cursor("default")};L.present=!0;return a}c=void 0===c?"sequencer":c;b=void 0===b?300:b;d=void 0===d?100:d;h=void 0===h?0:h;l=void 0===l?!0:l;k=void 0===k?64:k;q=void 0===q?16:q;r=void 0===r?1:r;n=void 0===n?1:n;m=void 0===m?"rgba(20,20,20,1)":m;t=void 0===t?"rgba(209, 189, 222, 0.5)":t;p=void 0===p?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.95)",lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.95)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",
stroke:"rgba(129,209,173,0.95)",lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.95)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.95)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.95)",lineWidth:.5}]:p;z=void 0===z?[{fill:"rgba(138,138,138,0.8)",stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},
{fill:"rgba(234,238,110,0.8)",stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:z;y=void 0===y?"rgba(200,0,0,0)":y;A=void 0===A?3:A;x=void 0===x?[0,1]:x;u=void 0===u?{fill:"rgba(120,120,120,0.8)",stroke:"rgba(120,120,120,1)",lineWidth:.5}:u;E=void 0===E?[{fill:"rgba(120,120,120,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5},{fill:"rgba(100,100,100,  0)",stroke:"rgba(120,120,120,1)",
lineWidth:.5}]:E;B=void 0===B?[0]:B;C=void 0===C?{fill:"rgba(229, 221, 112,0.25)",stroke:"rgba(252,244,128,0.5)",lineWidth:.5}:C;H=void 0===H?[{fill:"rgba(30,30,30,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5}]:H;D=void 0===D?"rgb(240, 240, 240)":D;w=void 0===w?function(a){}:w;Ga=void 0===Ga?function(a){}:Ga;M=void 0===M?function(a){}:M;var ka=this,G={totalSize:{width:b/r,height:d/n},viewposition:{x:0,y:0},viewArea:{topLeft:{x:0,y:0},bottomRight:{x:r,y:n}}},F={step:1,snapping:!0,defaultStrength:.5,
selectedSignals:[],activeSignals:[],signalRegistry:new g.library.structure.signalRegistry(k,q)},ba=!1,T={start:0,end:k},L={present:!1,width:.75,invisibleHandleMux:4,position:-1,held:!1,automoveViewposition:!1},J=e.builder("group",c,{x:f,y:a,angle:h}),ca=e.builder("rectangle","backing",{width:b,height:d,style:{fill:m}});J.append(ca);c=e.builder("rectangle","stencil",{width:b,height:d});J.stencil(c);J.clip(!0);var O=e.builder("group","workarea");J.append(O);c=e.builder("group","backgroundDrawArea");
O.append(c);var Q=e.builder("group","backgroundDrawArea_horizontal");c.append(Q);var P=e.builder("group","backgroundDrawArea_vertical");c.append(P);var S=e.builder("rectangle","interactionPlane_back",{width:G.totalSize.width,height:G.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});O.append(S);S.onwheel=function(a,b,d){};var U=e.builder("group","signalPane");O.append(U);var da=e.builder("rectangle","interactionPlane_front",{width:G.totalSize.width,height:G.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});
O.append(da);da.onwheel=function(a,b,d){};J.__calculationAngle=h;J.viewposition=W;J.viewarea=function(a,b){b=void 0===b?!0:b;if(void 0==a||void 0==a.topLeft&&void 0==a.bottomRight)return G.viewArea;void 0==a.topLeft?a.topLeft={x:G.viewArea.topLeft.x,y:G.viewArea.topLeft.y}:(void 0==a.topLeft.x&&(a.topLeft.x=G.viewArea.topLeft.x),void 0==a.topLeft.y&&(a.topLeft.y=G.viewArea.topLeft.y));void 0==a.bottomRight?a.bottomRight={x:G.bottomRight.topLeft.x,y:G.bottomRight.topLeft.ys}:(void 0==a.bottomRight.x&&
(a.bottomRight.x=G.viewArea.bottomRight.x),void 0==a.bottomRight.y&&(a.bottomRight.y=G.viewArea.bottomRight.y));var d=G.viewArea.bottomRight.x-G.viewArea.topLeft.x!=a.bottomRight.x-a.topLeft.x,c=a.bottomRight.y-a.topLeft.y!=G.viewArea.bottomRight.y-G.viewArea.topLeft.y;d&&c?X(a.bottomRight.x-a.topLeft.x,a.bottomRight.y-a.topLeft.y):d?X(a.bottomRight.x-a.topLeft.x,void 0):c&&X(void 0,a.bottomRight.y-a.topLeft.y);c=d=0;0!=1-(a.bottomRight.x-a.topLeft.x)&&(d=a.topLeft.x+(a.bottomRight.x-a.topLeft.x)/
(1-(a.bottomRight.x-a.topLeft.x))*a.topLeft.x);0!=1-(a.bottomRight.y-a.topLeft.y)&&(c=a.topLeft.y+(a.bottomRight.y-a.topLeft.y)/(1-(a.bottomRight.y-a.topLeft.y))*a.topLeft.y);W(d,c,b);G.viewArea=Object.assign(a,{})};J.step=function(a){if(void 0==a)return F.step;F.step=a};J.interactable=function(a){if(void 0==a)return l;l=a};J.glowHorizontal=function(a,b,d){for(void 0==d&&(d=b+1);b<=d;b++){var c=a?u:E[x[b%x.length]];Q.children[b].style.fill=c.fill;Q.children[b].style.stroke=c.stroke;Q.children[b].style.lineWidth=
c.lineWidth}};J.glowVertical=function(a,b,d){for(void 0==d&&(d=b+1);b<d;b++){var c=a?C:H[B[b%B.length]];P.children[b].style.fill=c.fill;P.children[b].style.stroke=c.stroke;P.children[b].style.lineWidth=c.lineWidth}};J.loopActive=function(a){if(void 0==a)return ba;ba=a;J.glowVertical(!1,0,k);ba&&J.glowVertical(!0,0>T.start?0:T.start,T.end>k?k:T.end)};J.loopPeriod=function(a,b){if(void 0==a||void 0==b)return T;a>b||0>a||0>b||(T={start:a,end:b},ba&&(J.glowVertical(!1,0,k),J.glowVertical(!0,0>a?0:a,b>
k?k:b)))};J.export=function(){return F.signalRegistry.export()};J.import=function(a){F.signalRegistry.import(a)};J.getAllSignals=function(){return F.signalRegistry.getAllSignals()};J.addSignal=function(a,b,d,c){Y(a,b,d,void 0===c?1:c)};J.addSignals=function(a){for(var b=0;b<a.length;b++)void 0!=a[b]&&null!=a[b]&&this.addSignal(a[b].line,a[b].position,a[b].length,a[b].strength)};J.eventsBetween=function(a,b){return F.signalRegistry.eventsBetween(a,b)};J.automove=function(a){if(void 0==a)return L.automoveViewposition;
L.automoveViewposition=a};J.playheadPosition=function(a,b){if(void 0==a)return L.position;L.position=a;if(void 0===b||b){a=[];for(b=0;b<F.activeSignals.length;b++){var d=F.signalRegistry.getSignal(F.activeSignals[b]);null!=d&&a.unshift({signalID:F.activeSignals[b],line:d.line,position:T.start,strength:0})}F.activeSignals=[];J.event&&0<a.length&&J.event(a)}a=O.getElementsWithName("playhead")[0];0>L.position||L.position>k?void 0!=a&&a.parent.remove(a):(void 0==a&&(a=Z()),a.parameter.x(G.totalSize.width/
k*L.position),L.automoveViewposition&&(a=k-k*r,(L.position<Math.floor(G.viewposition.x*a)||L.position>Math.floor(G.viewposition.x*a)+k*r)&&J.viewposition((L.position>a?a:L.position)/a)))};J.progress=function(){if(!L.held){var a=J.eventsBetween(L.position,L.position+F.step);if(ba&&L.position==T.start){for(var b=0;b<F.activeSignals.length;b++){var d=F.signalRegistry.getSignal(F.activeSignals[b]);null!=d&&a.unshift({signalID:F.activeSignals[b],line:d.line,position:T.start,strength:0})}F.activeSignals=
[]}for(b=0;b<a.length;b++)d=F.activeSignals.indexOf(a[b].signalID),-1!=d&&0==a[b].strength?F.activeSignals.splice(d):0<a[b].strength&&F.activeSignals.push(a[b].signalID);L.position=ba&&L.position+F.step==T.end?T.start:L.position+F.step;J.playheadPosition(L.position,!1);J.event&&0<a.length&&J.event(a)}};S.onmousedown=function(a,c,f){if(l&&(a=g.system.keyboard.pressedKeys,!a.alt||!a.Space))if(a.shift){var h=v(f),p=v(f),x=e.builder("rectangle","selectionArea",{x:h.x*b,y:h.y*d,width:0,height:0,style:{fill:t}});
J.append(x);g.system.mouse.mouseInteractionHandler(function(a){p=v(a);p.x=0>p.x?0:p.x;p.y=0>p.y?0:p.y;p.x=1<p.x?1:p.x;p.y=1<p.y?1:p.y;a=p.x-h.x;var c=p.y-h.y,e=h.x,f=h.y,k=1,l=1;0>a&&(k=-1,e+=a);0>c&&(l=-1,f+=c);x.parameter.x(e*b);x.parameter.y(f*d);x.parameter.width(k*a*b);x.parameter.height(l*c*d)},function(a){x.parent.remove(x);var b=K(h),d=K(p);b.x*=G.totalSize.width;d.y*=G.totalSize.height;d.x*=G.totalSize.width;b.y*=G.totalSize.height;a={topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};b.x<d.x?(a.topLeft.x=
b.x,a.bottomRight.x=d.x):(a.topLeft.x=d.x,a.bottomRight.x=b.x);b.y<d.y?(a.topLeft.y=b.y,a.bottomRight.y=d.y):(a.topLeft.y=d.y,a.bottomRight.y=b.y);for(;0<F.selectedSignals.length;)F.selectedSignals[0].deselect();for(b=0;b<U.children.length;b++)d=F.signalRegistry.getSignal(parseInt(U.children[b].name)),g.library.math.detectOverlap.boundingBoxes({topLeft:{x:G.totalSize.width/k*d.position,y:G.totalSize.height/q*d.line},bottomRight:{x:G.totalSize.width/k*(d.position+d.length),y:G.totalSize.height/q*(d.line+
1)}},a)&&U.children[b].select(!0)})}else if(a.alt){for(;0<F.selectedSignals.length;)F.selectedSignals[0].deselect();a=R(I(v(f)));a=Y(a.line,a.position,0);a.signalBlock.select();a.signalBlock.rightHandle.onmousedown(void 0,void 0,f,!0)}else if(a.Space){g.core.viewport.cursor("grabbing");var u=v(f),m=G.viewposition.x,z=G.viewposition.y;g.system.mouse.mouseInteractionHandler(function(a){a=v(a);W(m-(u.x-a.x)*r/(r-1),z-(u.y-a.y)*n/(n-1))},function(a){g.library.math.detectOverlap.pointWithinBoundingBox(I(v(a)),
G.viewArea)&&g.system.keyboard.pressedKeys.Space?g.core.viewport.cursor("grab"):g.core.viewport.cursor("default")})}else for(;0<F.selectedSignals.length;)F.selectedSignals[0].deselect()};S.onmousemove=function(a,b,d){l&&(a=g.system.keyboard.pressedKeys,a.alt?g.core.viewport.cursor("crosshair"):a.Space?g.core.viewport.cursor("grab"):g.core.viewport.cursor("default"))};da.onkeydown=function(a,b,d){if(l){d=g.system.keyboard.pressedKeys;if(d.Backspace||d.Delete)for(;0<F.selectedSignals.length;)F.selectedSignals[0].delete();
d.Space&&g.core.viewport.cursor("grab");d.alt&&(void 0!=U.getElementUnderPoint(a,b)?g.core.viewport.cursor("copy"):g.core.viewport.cursor("crosshair"))}};da.onkeyup=function(a,b,d){l&&g.core.viewport.cursor("default")};J.onpan=w;J.onchangeviewarea=Ga;J.event=M;(function(){Q.clear();for(var a=0;a<q;a++){var c=E[x[a%x.length]];Q.append(e.builder("rectangle","strip_horizontal_"+a,{x:0,y:d/(q*n)*a,width:G.totalSize.width,height:d/(q*n),style:{fill:c.fill,stroke:c.stroke,lineWidth:c.lineWidth}}))}P.clear();
for(a=0;a<k;a++)c=H[B[a%B.length]],P.append(e.builder("rectangle","strip_vertical_"+a,{x:b/(k*r)*a,y:0,width:b/(k*r),height:G.totalSize.height,style:{fill:c.fill,stroke:c.stroke,lineWidth:c.lineWidth}}))})();return J};this.sequencer.signalBlock=function(c,f,a,b,d,h,l,k,q,r,n,v){function t(){B.body.parameter.height(a);B.leftHandle.parameter.height(a);B.rightHandle.parameter.height(a)}function p(){B.body.parameter.width(h*f);B.rightHandle.parameter.x(h*f-v/2)}function m(){B.parameter.y(b*a)}function y(a,
b){var d=Object.assign({},a[0]);a[0].hasOwnProperty("fill")&&(d.fill=g.library.misc.multiBlendColours(a.map(function(a){return a.fill}),b));a[0].hasOwnProperty("stroke")&&(d.stroke=g.library.misc.multiBlendColours(a.map(function(a){return a.stroke}),b));return d}l=void 0===l?1:l;k=void 0===k?!1:k;q=void 0===q?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.8)",lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.8)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",stroke:"rgba(129,209,173,0.8)",
lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.8)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.8)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.8)",lineWidth:.5}]:q;r=void 0===r?[{fill:"rgba(138,138,138,0.8)",stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},{fill:"rgba(234,238,110,0.8)",
stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:r;n=void 0===n?"rgba(255,0,255,0)":n;v=void 0===v?5:v;var A=!1,x=v/4,u=y(q,l),E=y(r,l),B=e.builder("group",String(c),{x:d*f,y:b*a});B.body=e.builder("rectangle","body",{width:h*f,height:a,style:{fill:u.fill,stroke:u.stroke,lineWidth:u.lineWidth}});B.leftHandle=e.builder("rectangle","leftHandle",{x:-v/2,width:v,
height:a,style:{fill:n}});B.rightHandle=e.builder("rectangle","rightHandle",{x:h*f-v/2,width:v,height:a,style:{fill:n}});B.append(B.body);B.append(B.leftHandle);B.append(B.rightHandle);B.unit=function(b,c){if(void 0==b&&void 0==c)return{x:f,y:a};void 0==b?(a=c,t(),m()):(void 0==c?(f=b,p()):(f=b,a=c,p(),t(),m()),B.parameter.x(d*f))};B.line=function(a){if(void 0==a)return b;b=a;m()};B.position=function(a){if(void 0==a)return d;d=a;B.parameter.x(d*f)};B.length=function(a){if(void 0==a)return h;h=a<x/
f?x/f:a;p()};B.strength=function(a){if(void 0==a)return l;a=1<a?1:a;l=0>a?0:a;u=y(q,l);E=y(r,l);B.glow(k)};B.glow=function(a){if(void 0==a)return k;(k=a)?(B.body.style.fill=E.fill,B.body.style.stroke=E.stroke,B.body.style.lineWidth=E.lineWidth):(B.body.style.fill=u.fill,B.body.style.stroke=u.stroke,B.body.style.lineWidth=u.lineWidth)};B.selected=function(a){if(void 0==a)return A;A=a};return B};this.dial_continuous_image=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p,z){function v(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===
b||b)&&void 0!=A.onchange)A.onchange(a);l=a;u.parameter.angle(q+r*l);x.parameter.angle(q+r*l)}c=void 0===c?"dial_continuous_image":c;b=void 0===b?15:b;d=void 0===d?0:d;h=void 0===h?!0:h;l=void 0===l?0:l;k=void 0===k?-1:k;q=void 0===q?3*Math.PI/4:q;r=void 0===r?1.5*Math.PI:r;p=void 0===p?function(){}:p;z=void 0===z?function(){}:z;if(void 0==n||void 0==m||void 0==t)return this.dial_continuous(c,f,a,b,d,h,l,k,q,r,void 0,void 0,void 0,p,z);var A=e.builder("group",c,{x:f,y:a,angle:d});c=e.builder("image",
"slot",{width:2.2*b,height:2.2*b,anchor:{x:.5,y:.5},url:m});A.append(c);var x=e.builder("image","handle",{width:2*b,height:2*b,anchor:{x:.5,y:.5},url:n});A.append(x);var u=e.builder("group","needleGroup",{ignored:!0});A.append(u);n=b/5;c=b;t=e.builder("image","needle",{x:c/3,y:-n/2,height:n,width:c,url:t});u.append(t);var E=!1;A.set=function(a,b){E||v(a,b)};A.get=function(){return l};A.interactable=function(a){if(void 0==a)return h;h=a};var B=4*b;x.ondblclick=function(){if(h&&!(0>k||E)&&(v(k),void 0!=
A.onrelease))A.onrelease(l)};x.onwheel=function(a,b,d){if(h&&!E&&(a=d.deltaY/100,b=g.core.viewport.scale(),v(l-a/(10*b)),void 0!=A.onrelease))A.onrelease(l)};x.onmousedown=function(a,b,d){if(h){var c=l,e=d.y;E=!0;g.system.mouse.mouseInteractionHandler(function(a){a=a.y-e;var b=g.core.viewport.scale();v(c-a/(b*B)*window.devicePixelRatio,!0)},function(a){E=!1;if(void 0!=A.onrelease)A.onrelease(l)})}};A.onchange=p;A.onrelease=z;v(l);return A};this.dial_continuous=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p,
z){function v(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=A.onchange)A.onchange(a);l=a;x.parameter.angle(q+r*l)}b=void 0===b?15:b;h=void 0===h?!0:h;l=void 0===l?0:l;k=void 0===k?-1:k;q=void 0===q?3*Math.PI/4:q;r=void 0===r?1.5*Math.PI:r;n=void 0===n?{fill:"rgba(200,200,200,1)"}:n;m=void 0===m?{fill:"rgba(50,50,50,1)"}:m;t=void 0===t?{fill:"rgba(250,100,100,1)"}:t;p=void 0===p?function(){}:p;z=void 0===z?function(){}:z;var A=e.builder("group",void 0===c?"dial_continuous":c,{x:f,y:a,angle:void 0===
d?0:d});c=e.builder("circle","slot",{r:1.1*b,style:{fill:m.fill,stroke:m.stroke,lineWidth:m.lineWidth,lineJoin:m.lineJoin,miterLimit:m.miterLimit}});A.append(c);n=e.builder("circle","handle",{r:b,style:{fill:n.fill,stroke:n.stroke,lineWidth:n.lineWidth,lineJoin:n.lineJoin,miterLimit:n.miterLimit}});A.append(n);var x=e.builder("group","needleGroup",{ignored:!0});A.append(x);c=b/5;f=b;t=e.builder("rectangle","needle",{x:f/3,y:-c/2,height:c,width:f,style:{fill:t.fill,stroke:t.stroke,lineWidth:t.lineWidth,
lineJoin:t.lineJoin,miterLimit:t.miterLimit}});x.append(t);var u=!1;A.set=function(a,b){u||v(a,b)};A.get=function(){return l};A.interactable=function(a){if(void 0==a)return h;h=a};var E=4*b;n.ondblclick=function(){if(h&&!(0>k||u)&&(v(k),void 0!=A.onrelease))A.onrelease(l)};n.onwheel=function(a,b,d){if(h&&!u&&(a=d.deltaY/100,b=g.core.viewport.scale(),v(l-a/(10*b)),void 0!=A.onrelease))A.onrelease(l)};n.onmousedown=function(a,b,d){if(h){var c=l,e=d.y;u=!0;g.system.mouse.mouseInteractionHandler(function(a){a=
a.y-e;var b=g.core.viewport.scale();v(c-a/(b*E)*window.devicePixelRatio,!0)},function(a){u=!1;if(void 0!=A.onrelease)A.onrelease(l)})}};A.onchange=p;A.onrelease=z;v(l);return A};this.dial_discrete_image=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p,z,y){function v(a,b){a=a>q-1?q-1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=x.onchange)x.onchange(a);l=a=Math.round(a);u.set(l/(q-1))}c=void 0===c?"dial_discrete_image":c;b=void 0===b?15:b;h=void 0===h?!0:h;l=void 0===l?0:l;k=void 0===k?0:k;q=void 0===q?5:q;r=void 0===
r?3*Math.PI/4:r;n=void 0===n?1.5*Math.PI:n;z=void 0===z?function(){}:z;y=void 0===y?function(){}:y;var x=e.builder("group",c,{x:f,y:a,angle:void 0===d?0:d}),u=e.builder("dial_continuous_image",c,{x:0,y:0,r:b,angle:0,interactable:h,startAngle:r,maxAngle:n,handleURL:m,slotURL:t,needleURL:p});u.getChildByName("handle").ondblclick=void 0;u.getChildByName("handle").onwheel=void 0;u.getChildByName("handle").onmousedown=void 0;x.append(u);var E=!1;x.set=function(a,b){E||v(a,b)};x.get=function(){return l};
x.interactable=function(a){if(void 0==a)return h;h=a};var B=0;u.getChildByName("handle").ondblclick=function(){if(h&&!(0>k||E)&&(v(k),void 0!=x.onrelease))x.onrelease(l)};u.getChildByName("handle").onwheel=function(a,b,d){if(h&&!E&&(B+=d.deltaY/100,1<=Math.abs(B)&&(v(l-1*Math.sign(B)),B=0,void 0!=x.onrelease)))x.onrelease(l)};u.getChildByName("handle").onmousedown=function(a,b,d){if(h){var c=l,e=d.y;E=!0;g.system.mouse.mouseInteractionHandler(function(a){v(c-Math.round((a.y-e)/25));if(void 0!=x.onchange)x.onchange(l)},
function(a){E=!1;if(void 0!=x.onrelease)x.onrelease(l)})}};x.onchange=z;x.onrelease=y;v(l);return x};this.dial_discrete=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p,z,y){function v(a,b){a=a>q-1?q-1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=x.onchange)x.onchange(a);l=a=Math.round(a);u.set(l/(q-1))}c=void 0===c?"dial_discrete":c;b=void 0===b?15:b;h=void 0===h?!0:h;l=void 0===l?0:l;k=void 0===k?0:k;q=void 0===q?5:q;r=void 0===r?3*Math.PI/4:r;n=void 0===n?1.5*Math.PI:n;m=void 0===m?{fill:"rgba(200,200,200,1)"}:
m;t=void 0===t?{fill:"rgba(50,50,50,1)"}:t;p=void 0===p?{fill:"rgba(250,100,100,1)"}:p;z=void 0===z?function(){}:z;y=void 0===y?function(){}:y;var x=e.builder("group",c,{x:f,y:a,angle:void 0===d?0:d}),u=e.builder("dial_continuous",c,{x:0,y:0,r:b,angle:0,interactable:h,startAngle:r,maxAngle:n,style:{handle:m,slot:t,needle:p}});u.getChildByName("handle").ondblclick=void 0;u.getChildByName("handle").onwheel=void 0;u.getChildByName("handle").onmousedown=void 0;x.append(u);var E=!1;x.set=function(a,b){E||
v(a,b)};x.get=function(){return l};x.interactable=function(a){if(void 0==a)return h;h=a};var B=0;u.getChildByName("handle").ondblclick=function(){if(h&&!(0>k||E)&&(v(k),void 0!=x.onrelease))x.onrelease(l)};u.getChildByName("handle").onwheel=function(a,b,d){if(h&&!E&&(B+=d.deltaY/100,1<=Math.abs(B)&&(v(l-1*Math.sign(B)),B=0,void 0!=x.onrelease)))x.onrelease(l)};u.getChildByName("handle").onmousedown=function(a,b,d){if(h){var c=l,e=d.y;E=!0;g.system.mouse.mouseInteractionHandler(function(a){v(c-Math.round((a.y-
e)/25));if(void 0!=x.onchange)x.onchange(l)},function(a){E=!1;if(void 0!=x.onrelease)x.onrelease(l)})}};x.onchange=z;x.onrelease=y;v(l);return x};this.button_circle=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y,A,x,u,E,B,C,H,D,w,K,M,aa,V,ha,R,W,X,Y,Z,ka,G,F,ba,T,L,J,ca,O,Q,P,S,U,da,ma,ia,la,N,ea,ja,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa){c=void 0===c?"button_circle":c;b=void 0===b?15:b;d=void 0===d?0:d;g=void 0===g?!0:g;l=void 0===l?"":l;k=void 0===k?!0:k;q=void 0===q?!0:q;r=void 0===
r?!1:r;n=void 0===n?!0:n;m=void 0===m?"5pt Arial":m;t=void 0===t?"alphabetic":t;p=void 0===p?"rgba(0,0,0,1)":p;z=void 0===z?"rgba(0,0,0,0)":z;y=void 0===y?1:y;A=void 0===A?"rgba(180,180,180,1)":A;x=void 0===x?"rgba(0,0,0,0)":x;u=void 0===u?0:u;E=void 0===E?"rgba(200,200,200,1)":E;B=void 0===B?"rgba(0,0,0,0)":B;C=void 0===C?0:C;H=void 0===H?"rgba(230,230,230,1)":H;D=void 0===D?"rgba(0,0,0,0)":D;w=void 0===w?0:w;K=void 0===K?"rgba(200,200,200,1)":K;M=void 0===M?"rgba(120,120,120,1)":M;aa=void 0===aa?
.75:aa;V=void 0===V?"rgba(230,230,230,1)":V;ha=void 0===ha?"rgba(120,120,120,1)":ha;R=void 0===R?.75:R;W=void 0===W?"rgba(220,220,220,1)":W;X=void 0===X?"rgba(0,0,0,0)":X;Y=void 0===Y?0:Y;Z=void 0===Z?"rgba(250,250,250,1)":Z;ka=void 0===ka?"rgba(0,0,0,0)":ka;G=void 0===G?0:G;F=void 0===F?"rgba(220,220,220,1)":F;ba=void 0===ba?"rgba(120,120,120,1)":ba;T=void 0===T?.75:T;L=void 0===L?"rgba(250,250,250,1)":L;J=void 0===J?"rgba(120,120,120,1)":J;ca=void 0===ca?.75:ca;O=void 0===O?"rgba(220,220,220,1)":
O;Q=void 0===Q?"rgba(0,0,0,0)":Q;P=void 0===P?0:P;S=void 0===S?"rgba(240,240,240,1)":S;U=void 0===U?"rgba(0,0,0,0)":U;da=void 0===da?0:da;ma=void 0===ma?"rgba(220,220,220,1)":ma;ia=void 0===ia?"rgba(120,120,120,1)":ia;la=void 0===la?.75:la;N=void 0===N?"rgba(240,240,240,1)":N;ea=void 0===ea?"rgba(120,120,120,1)":ea;ja=void 0===ja?.75:ja;na=void 0===na?"rgba(240,240,240,1)":na;oa=void 0===oa?"rgba(0,0,0,0)":oa;pa=void 0===pa?0:pa;ra=void 0===ra?"rgba(250,250,250,1)":ra;sa=void 0===sa?"rgba(0,0,0,0)":
sa;ua=void 0===ua?0:ua;va=void 0===va?"rgba(240,240,240,1)":va;qa=void 0===qa?"rgba(120,120,120,1)":qa;ta=void 0===ta?.75:ta;wa=void 0===wa?"rgba(250,250,250,1)":wa;xa=void 0===xa?"rgba(120,120,120,1)":xa;ya=void 0===ya?.75:ya;za=void 0===za?function(a){}:za;Aa=void 0===Aa?function(a){}:Aa;Ba=void 0===Ba?function(a){}:Ba;Ca=void 0===Ca?function(a){}:Ca;Da=void 0===Da?function(a){}:Da;Ea=void 0===Ea?function(a){}:Ea;Fa=void 0===Fa?function(a){}:Fa;var h=e.builder("group",c+"subGroup",{}),v=e.builder("circle",
"backing",{r:b,style:{fill:A,stroke:x,lineWidth:u}});h.append(v);l=e.builder("text","centre",{text:l,style:{font:m,testBaseline:t,fill:p,stroke:z,lineWidth:y,textAlign:"center",textBaseline:"middle"}});h.append(l);h.cover=e.builder("circle","cover",{r:b,style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);c=e.builder("button_",c,{x:f,y:a,angle:d,interactable:g,active:k,hoverable:q,selectable:r,pressable:n,onenter:za,onleave:Aa,onpress:Ba,ondblpress:Ca,onrelease:Da,onselect:Ea,ondeselect:Fa,subject:h});
c.activateGraphicalState=function(a){if(k){var b=[{fill:E,stroke:B,lineWidth:C},{fill:H,stroke:D,lineWidth:w},{fill:K,stroke:M,lineWidth:aa},{fill:V,stroke:ha,lineWidth:R},{fill:W,stroke:X,lineWidth:Y},{fill:Z,stroke:ka,lineWidth:G},{fill:F,stroke:ba,lineWidth:T},{fill:L,stroke:J,lineWidth:ca},{fill:O,stroke:Q,lineWidth:P},{fill:S,stroke:U,lineWidth:da},{fill:ma,stroke:ia,lineWidth:la},{fill:N,stroke:ea,lineWidth:ja},{fill:na,stroke:oa,lineWidth:pa},{fill:ra,stroke:sa,lineWidth:ua},{fill:va,stroke:qa,
lineWidth:ta},{fill:wa,stroke:xa,lineWidth:ya}];!q&&a.hovering&&(a.hovering=!1);!r&&a.selected&&(a.selected=!1);a=8*a.hovering+4*a.glowing+2*a.selected+1*(n&&a.pressed);v.style.fill=b[a].fill;v.style.stroke=b[a].stroke;v.style.lineWidth=b[a].lineWidth}else v.style.fill=A,v.style.stroke=x,v.style.lineWidth=u};c.activateGraphicalState({hovering:!1,glowing:!1,selected:!1,pressed:!1});return c};this.button_rectangle=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y,A,x,u,E,B,C,H,w,I,K,M,aa,V,ha,R,W,X,Y,Z,ka,G,
F,ba,T,L,J,ca,O,Q,P,S,U,da,ma,ia,la,N,ea,ja,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ia,Ja,Ha,Ka,La){c=void 0===c?"button_rectangle":c;b=void 0===b?30:b;d=void 0===d?20:d;g=void 0===g?0:g;l=void 0===l?!0:l;k=void 0===k?"":k;q=void 0===q?"":q;r=void 0===r?"":r;n=void 0===n?.5:n;m=void 0===m?.05:m;t=void 0===t?!0:t;p=void 0===p?!0:p;z=void 0===z?!1:z;y=void 0===y?!0:y;A=void 0===A?"5pt Arial":A;x=void 0===x?"alphabetic":x;u=void 0===u?"rgba(0,0,0,1)":u;E=void 0===E?"rgba(0,0,0,0)":E;
B=void 0===B?1:B;C=void 0===C?"rgba(180,180,180,1)":C;H=void 0===H?"rgba(0,0,0,0)":H;w=void 0===w?0:w;I=void 0===I?"rgba(200,200,200,1)":I;K=void 0===K?"rgba(0,0,0,0)":K;M=void 0===M?0:M;aa=void 0===aa?"rgba(230,230,230,1)":aa;V=void 0===V?"rgba(0,0,0,0)":V;ha=void 0===ha?0:ha;R=void 0===R?"rgba(200,200,200,1)":R;W=void 0===W?"rgba(120,120,120,1)":W;X=void 0===X?.75:X;Y=void 0===Y?"rgba(230,230,230,1)":Y;Z=void 0===Z?"rgba(120,120,120,1)":Z;ka=void 0===ka?.75:ka;G=void 0===G?"rgba(220,220,220,1)":
G;F=void 0===F?"rgba(0,0,0,0)":F;ba=void 0===ba?0:ba;T=void 0===T?"rgba(250,250,250,1)":T;L=void 0===L?"rgba(0,0,0,0)":L;J=void 0===J?0:J;ca=void 0===ca?"rgba(220,220,220,1)":ca;O=void 0===O?"rgba(120,120,120,1)":O;Q=void 0===Q?.75:Q;P=void 0===P?"rgba(250,250,250,1)":P;S=void 0===S?"rgba(120,120,120,1)":S;U=void 0===U?.75:U;da=void 0===da?"rgba(220,220,220,1)":da;ma=void 0===ma?"rgba(0,0,0,0)":ma;ia=void 0===ia?0:ia;la=void 0===la?"rgba(240,240,240,1)":la;N=void 0===N?"rgba(0,0,0,0)":N;ea=void 0===
ea?0:ea;ja=void 0===ja?"rgba(220,220,220,1)":ja;na=void 0===na?"rgba(120,120,120,1)":na;oa=void 0===oa?.75:oa;pa=void 0===pa?"rgba(240,240,240,1)":pa;ra=void 0===ra?"rgba(120,120,120,1)":ra;sa=void 0===sa?.75:sa;ua=void 0===ua?"rgba(240,240,240,1)":ua;va=void 0===va?"rgba(0,0,0,0)":va;qa=void 0===qa?0:qa;ta=void 0===ta?"rgba(250,250,250,1)":ta;wa=void 0===wa?"rgba(0,0,0,0)":wa;xa=void 0===xa?0:xa;ya=void 0===ya?"rgba(240,240,240,1)":ya;za=void 0===za?"rgba(120,120,120,1)":za;Aa=void 0===Aa?.75:Aa;
Ba=void 0===Ba?"rgba(250,250,250,1)":Ba;Ca=void 0===Ca?"rgba(120,120,120,1)":Ca;Da=void 0===Da?.75:Da;Ea=void 0===Ea?function(a){}:Ea;Fa=void 0===Fa?function(a){}:Fa;Ia=void 0===Ia?function(a){}:Ia;Ja=void 0===Ja?function(a){}:Ja;Ha=void 0===Ha?function(a){}:Ha;Ka=void 0===Ka?function(a){}:Ka;La=void 0===La?function(a){}:La;var h=e.builder("group",c+"subGroup",{}),v=e.builder("rectangle","backing",{width:b,height:d,style:{fill:C,stroke:H,lineWidth:w}});h.append(v);k=e.builder("text","centre",{x:b/
2,y:d*n,text:k,style:{font:A,testBaseline:x,fill:u,stroke:E,lineWidth:B,textAlign:"center",textBaseline:"middle"}});h.append(k);q=e.builder("text","left",{x:b*m,y:d*n,text:q,style:{font:A,testBaseline:x,fill:u,stroke:E,lineWidth:B,textAlign:"left",textBaseline:"middle"}});h.append(q);r=e.builder("text","right",{x:b-b*m,y:d*n,text:r,style:{font:A,testBaseline:x,fill:u,stroke:E,lineWidth:B,textAlign:"right",textBaseline:"middle"}});h.append(r);h.cover=e.builder("rectangle","cover",{width:b,height:d,
style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);c=e.builder("button_",c,{x:f,y:a,angle:g,interactable:l,active:t,hoverable:p,selectable:z,pressable:y,onenter:Ea,onleave:Fa,onpress:Ia,ondblpress:Ja,onrelease:Ha,onselect:Ka,ondeselect:La,subject:h});c.activateGraphicalState=function(a){if(t){var b=[{fill:I,stroke:K,lineWidth:M},{fill:aa,stroke:V,lineWidth:ha},{fill:R,stroke:W,lineWidth:X},{fill:Y,stroke:Z,lineWidth:ka},{fill:G,stroke:F,lineWidth:ba},{fill:T,stroke:L,lineWidth:J},{fill:ca,stroke:O,
lineWidth:Q},{fill:P,stroke:S,lineWidth:U},{fill:da,stroke:ma,lineWidth:ia},{fill:la,stroke:N,lineWidth:ea},{fill:ja,stroke:na,lineWidth:oa},{fill:pa,stroke:ra,lineWidth:sa},{fill:ua,stroke:va,lineWidth:qa},{fill:ta,stroke:wa,lineWidth:xa},{fill:ya,stroke:za,lineWidth:Aa},{fill:Ba,stroke:Ca,lineWidth:Da}];!p&&a.hovering&&(a.hovering=!1);!z&&a.selected&&(a.selected=!1);a=8*a.hovering+4*a.glowing+2*a.selected+1*(y&&a.pressed);v.style.fill=b[a].fill;v.style.stroke=b[a].stroke;v.style.lineWidth=b[a].lineWidth}else v.style.fill=
C,v.style.stroke=H,v.style.lineWidth=w};c.activateGraphicalState({hovering:!1,glowing:!1,selected:!1,pressed:!1});return c};this.button_=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y,A){c=void 0===c?"":c;b=void 0===b?0:b;d=void 0===d?!0:d;g=void 0===g?!0:g;k=void 0===k?!1:k;q=void 0===q?!0:q;r=void 0===r?function(a){}:r;n=void 0===n?function(a){}:n;m=void 0===m?function(a){}:m;t=void 0===t?function(a){}:t;p=void 0===p?function(a){}:p;z=void 0===z?function(a){}:z;y=void 0===y?function(a){}:y;void 0==A&&
console.warn("button_ : No subject provided");var h=e.builder("group",c,{x:f,y:a,angle:b});h.append(A);h.state={hovering:!1,glowing:!1,selected:!1,pressed:!1};h.press=function(a){if(g){if(q){if(this.state.pressed)return;this.state.pressed=!0;if(this.onpress)this.onpress(this,a)}this.select(!this.select(),a);h.activateGraphicalState(h.state)}};h.release=function(a){if(g&&q&&this.state.pressed&&(this.state.pressed=!1,h.activateGraphicalState(h.state),this.onrelease))this.onrelease(this,a)};h.active=
function(a){if(void 0==a)return g;g=a;h.activateGraphicalState(h.state)};h.glow=function(a){if(void 0==a)return this.state.glowing;this.state.glowing=a;h.activateGraphicalState(h.state)};h.select=function(a,b,d){d=void 0===d?!0:d;if(g){if(void 0==a)return this.state.selected;if(k&&this.state.selected!=a&&(this.state.selected=a,h.activateGraphicalState(h.state),d))if(this.state.selected)this.onselect(this,b);else this.ondeselect(this,b)}};h.interactable=function(a){if(void 0==a)return d;d=a};h.forceMouseLeave=
function(){h.state.hovering=!1;h.release("forced");h.activateGraphicalState(h.state);if(h.onleave)h.onleave("forced")};A.cover.onmouseenter=function(a,b,d){h.state.hovering=!0;h.activateGraphicalState(h.state);if(h.onenter)h.onenter(d);if(1==d.buttons)A.cover.onmousedown(d)};A.cover.onmouseleave=function(a,b,d){h.state.hovering=!1;h.release(d);h.activateGraphicalState(h.state);if(h.onleave)h.onleave(d)};A.cover.onmouseup=function(a,b,c){d&&h.release(c)};A.cover.onmousedown=function(a,b,c){d&&h.press(c)};
A.cover.ondblclick=function(a,b,c){if(g&&d&&h.ondblpress)h.ondblpress(c)};h.onenter=r;h.onleave=n;h.onpress=m;h.ondblpress=t;h.onrelease=p;h.onselect=z;h.ondeselect=y;return h};this.button_polygon=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p,z,y,A,x,u,E,B,C,H,w,I,K,M,aa,V,ha,R,W,X,Y,Z,ka,G,F,ba,T,L,J,ca,O,Q,P,S,U,da,ma,ia,la,N,ea,ja,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa){c=void 0===c?"button_polygon":c;b=void 0===b?[{x:0,y:5},{x:5,y:0},{x:25,y:0},{x:30,y:5},{x:30,y:25},{x:25,y:30},{x:5,
y:30},{x:0,y:25}]:b;d=void 0===d?0:d;h=void 0===h?!0:h;l=void 0===l?"":l;k=void 0===k?!0:k;q=void 0===q?!0:q;r=void 0===r?!1:r;n=void 0===n?!0:n;m=void 0===m?"5pt Arial":m;t=void 0===t?"alphabetic":t;p=void 0===p?"rgba(0,0,0,1)":p;z=void 0===z?"rgba(0,0,0,0)":z;y=void 0===y?1:y;A=void 0===A?"rgba(180,180,180,1)":A;x=void 0===x?"rgba(0,0,0,0)":x;u=void 0===u?0:u;E=void 0===E?"rgba(200,200,200,1)":E;B=void 0===B?"rgba(0,0,0,0)":B;C=void 0===C?0:C;H=void 0===H?"rgba(230,230,230,1)":H;w=void 0===w?"rgba(0,0,0,0)":
w;I=void 0===I?0:I;K=void 0===K?"rgba(200,200,200,1)":K;M=void 0===M?"rgba(120,120,120,1)":M;aa=void 0===aa?.75:aa;V=void 0===V?"rgba(230,230,230,1)":V;ha=void 0===ha?"rgba(120,120,120,1)":ha;R=void 0===R?.75:R;W=void 0===W?"rgba(220,220,220,1)":W;X=void 0===X?"rgba(0,0,0,0)":X;Y=void 0===Y?0:Y;Z=void 0===Z?"rgba(250,250,250,1)":Z;ka=void 0===ka?"rgba(0,0,0,0)":ka;G=void 0===G?0:G;F=void 0===F?"rgba(220,220,220,1)":F;ba=void 0===ba?"rgba(120,120,120,1)":ba;T=void 0===T?.75:T;L=void 0===L?"rgba(250,250,250,1)":
L;J=void 0===J?"rgba(120,120,120,1)":J;ca=void 0===ca?.75:ca;O=void 0===O?"rgba(220,220,220,1)":O;Q=void 0===Q?"rgba(0,0,0,0)":Q;P=void 0===P?0:P;S=void 0===S?"rgba(240,240,240,1)":S;U=void 0===U?"rgba(0,0,0,0)":U;da=void 0===da?0:da;ma=void 0===ma?"rgba(220,220,220,1)":ma;ia=void 0===ia?"rgba(120,120,120,1)":ia;la=void 0===la?.75:la;N=void 0===N?"rgba(240,240,240,1)":N;ea=void 0===ea?"rgba(120,120,120,1)":ea;ja=void 0===ja?.75:ja;na=void 0===na?"rgba(240,240,240,1)":na;oa=void 0===oa?"rgba(0,0,0,0)":
oa;pa=void 0===pa?0:pa;ra=void 0===ra?"rgba(250,250,250,1)":ra;sa=void 0===sa?"rgba(0,0,0,0)":sa;ua=void 0===ua?0:ua;va=void 0===va?"rgba(240,240,240,1)":va;qa=void 0===qa?"rgba(120,120,120,1)":qa;ta=void 0===ta?.75:ta;wa=void 0===wa?"rgba(250,250,250,1)":wa;xa=void 0===xa?"rgba(120,120,120,1)":xa;ya=void 0===ya?.75:ya;za=void 0===za?function(a){}:za;Aa=void 0===Aa?function(a){}:Aa;Ba=void 0===Ba?function(a){}:Ba;Ca=void 0===Ca?function(a){}:Ca;Da=void 0===Da?function(a){}:Da;Ea=void 0===Ea?function(a){}:
Ea;Fa=void 0===Fa?function(a){}:Fa;var v=e.builder("group",c+"subGroup",{}),D=e.builder("polygon","backing",{points:b,style:{fill:A,stroke:x,lineWidth:u}});v.append(D);var Ga=g.library.math.averagePoint(b);l=e.builder("text","centre",{x:Ga.x,y:Ga.y,text:l,style:{font:m,testBaseline:t,fill:p,stroke:z,lineWidth:y,textAlign:"center",textBaseline:"middle"}});v.append(l);v.cover=e.builder("polygon","cover",{points:b,style:{fill:"rgba(0,0,0,0)"}});v.append(v.cover);c=e.builder("button_",c,{x:f,y:a,angle:d,
interactable:h,active:k,hoverable:q,selectable:r,pressable:n,onenter:za,onleave:Aa,onpress:Ba,ondblpress:Ca,onrelease:Da,onselect:Ea,ondeselect:Fa,subject:v});c.activateGraphicalState=function(a){if(k){var b=[{fill:E,stroke:B,lineWidth:C},{fill:H,stroke:w,lineWidth:I},{fill:K,stroke:M,lineWidth:aa},{fill:V,stroke:ha,lineWidth:R},{fill:W,stroke:X,lineWidth:Y},{fill:Z,stroke:ka,lineWidth:G},{fill:F,stroke:ba,lineWidth:T},{fill:L,stroke:J,lineWidth:ca},{fill:O,stroke:Q,lineWidth:P},{fill:S,stroke:U,
lineWidth:da},{fill:ma,stroke:ia,lineWidth:la},{fill:N,stroke:ea,lineWidth:ja},{fill:na,stroke:oa,lineWidth:pa},{fill:ra,stroke:sa,lineWidth:ua},{fill:va,stroke:qa,lineWidth:ta},{fill:wa,stroke:xa,lineWidth:ya}];!q&&a.hovering&&(a.hovering=!1);!r&&a.selected&&(a.selected=!1);a=8*a.hovering+4*a.glowing+2*a.selected+1*(n&&a.pressed);D.style.fill=b[a].fill;D.style.stroke=b[a].stroke;D.style.lineWidth=b[a].lineWidth}else D.style.fill=A,D.style.stroke=x,D.style.lineWidth=u};c.activateGraphicalState({hovering:!1,
glowing:!1,selected:!1,pressed:!1});return c};this.button_image=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y,A,x,u,E,B,C,H,w,I,K,M,aa,V,ha,R,W,X,Y,Z){c=void 0===c?"button_image":c;b=void 0===b?30:b;d=void 0===d?20:d;g=void 0===g?0:g;l=void 0===l?!0:l;k=void 0===k?!0:k;q=void 0===q?!0:q;r=void 0===r?!1:r;n=void 0===n?!0:n;V=void 0===V?function(a){}:V;ha=void 0===ha?function(a){}:ha;R=void 0===R?function(a){}:R;W=void 0===W?function(a){}:W;X=void 0===X?function(a){}:X;Y=void 0===Y?function(a){}:Y;Z=void 0===
Z?function(a){}:Z;if(void 0==m||void 0==t||void 0==p||void 0==z||void 0==y||void 0==A||void 0==x||void 0==u||void 0==E||void 0==B||void 0==C||void 0==H||void 0==w||void 0==I||void 0==K||void 0==M||void 0==aa)return this.button_rectangle(c,f,a,b,d,g,l,void 0,void 0,void 0,void 0,void 0,k,q,r,n,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,V,ha,R,W,X,Y,Z);var h=e.builder("group",c+"subGroup",{}),v=e.builder("image","backing",{width:b,height:d,url:m});h.append(v);h.cover=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);c=e.builder("button_",c,{x:f,y:a,angle:g,interactable:l,active:k,hoverable:q,selectable:r,
pressable:n,onenter:V,onleave:ha,onpress:R,ondblpress:W,onrelease:X,onselect:Y,ondeselect:Z,subject:h});c.activateGraphicalState=function(a){k?(!q&&a.hovering&&(a.hovering=!1),!r&&a.selected&&(a.selected=!1),v.url=[t,p,z,y,A,x,u,E,B,C,H,w,I,K,M,aa][8*a.hovering+4*a.glowing+2*a.selected+1*(n&&a.pressed)]):(v.style.fill=backing__off__fill,v.style.stroke=backing__off__stroke,v.style.lineWidth=backing__off__lineWidth)};c.activateGraphicalState({hovering:!1,glowing:!1,selected:!1,pressed:!1});return c};
this.grapher_waveWorkspace=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y,A,x,u){b=void 0===b?120:b;d=void 0===d?60:d;l=void 0===l?!0:l;k=void 0===k?!0:k;q=void 0===q?!0:q;r=void 0===r?[{stroke:"rgba(0,255,0,1)",lineWidth:.25,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.25,lineJoin:"round"}]:r;n=void 0===n?[{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"},{fill:"rgba(255,255,100,1)",size:.75,font:"Helvetica"}]:n;m=void 0===m?"rgba(0,100,0,1)":m;t=void 0===t?.25:t;p=void 0===p?"rgba(0,150,0,1)":
p;z=void 0===z?"10pt Helvetica":z;y=void 0===y?"rgba(50,50,50,1)":y;A=void 0===A?function(a,b){}:A;x=void 0===x?function(a,b){}:x;u=void 0===u?function(a){}:u;var h=e.builder("group",void 0===c?"grapher_waveWorkspace":c,{x:f,y:a,angle:void 0===g?0:g});c=e.builder("grapher__static","graph",{width:b,height:d,style:{foregrounds:r,foregroundText:n,background_stroke:m,background_lineWidth:t,backgroundText_fill:p,backgroundText_font:z,backing:y}});c.resolution(10);h.append(c);b=e.builder("needleOverlay",
"overlay",{width:b,height:d,interactable:l,selectNeedle:k,selectionArea:q,needleStyles:r.map(function(a){return a.stroke})});h.append(b);h.horizontalMarkings=c.horizontalMarkings;h.verticalMarkings=c.verticalMarkings;h.drawBackground=c.drawBackground;h.drawForeground=c.drawForeground;h.draw=c.draw;h.mark=b.mark;h.removeAllMarks=b.removeAllMarks;h.select=b.select;h.area=b.area;h.interactable=b.interactable;h.onchange=A;h.onrelease=x;h.selectionAreaToggle=u;b.onchange=function(a,b){if(h.onchange)h.onchange(a,
b)};b.onrelease=function(a,b){if(h.onrelease)h.onrelease(a,b)};b.selectionAreaToggle=function(a){h.selectionAreaToggle&&h.selectionAreaToggle(a)};c.viewbox({left:0});c.drawBackground();b.select(0);return h};this.list_image=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y,A,x,u,E,B,C,H,w,I,K,M,aa,V,ha,R,W,X,Y,Z,ka,G,F,ba,T,L,J,ca,O,Q,P,S){function h(){v=[];ea.clear();D=[];for(var a=ia=la=0,c=0;c<k.length;c++)if("space"==k[c]){var f=e.builder("rectangle",""+c,{x:0,y:a,width:b,height:d*B,style:{fill:"rgba(255,0,0,0)"}});
a+=d*(B+x);ea.append(f)}else"break"==k[c]?(f=e.builder("image",""+c,{x:b*(1-E)*.5,y:a,width:b*E,height:d*u,url:H}),a+=d*(u+x),ea.append(f)):(f=e.builder("button_image",""+c,{x:b*(1-A)*.5,y:a,width:b*A,height:d*y,interactable:l,active:n,hoverable:t,selectable:p,pressable:z,backingURL__off:w,backingURL__up:I,backingURL__press:K,backingURL__select:M,backingURL__select_press:aa,backingURL__glow:V,backingURL__glow_press:ha,backingURL__glow_select:R,backingURL__glow_select_press:W,backingURL__hover:X,backingURL__hover_press:Y,
backingURL__hover_select:Z,backingURL__hover_select_press:ka,backingURL__hover_glow:G,backingURL__hover_glow_press:F,backingURL__hover_glow_select:ba,backingURL__hover_glow_select_press:T}),f.onenter=function(a){return function(){N.onenter(a)}}(c),f.onleave=function(a){return function(){N.onleave(a)}}(c),f.onpress=function(a){return function(){N.onpress(a)}}(c),f.ondblpress=function(a){return function(){N.ondblpress(a)}}(c),f.onrelease=function(a){return function(){k[a].function&&k[a].function();
N.onrelease(a)}}(c),f.onselect=function(a){return function(b,d){N.select(a,!0,d,!1)}}(c),f.ondeselect=function(a){return function(b,d){N.select(a,!1,d,!1)}}(c),a+=d*(y+x),ea.append(f),v.push(f));return a-d*x}b=void 0===b?50:b;d=void 0===d?100:d;l=void 0===l?!0:l;k=void 0===k?[]:k;n=void 0===n?!0:n;m=void 0===m?!0:m;t=void 0===t?!0:t;p=void 0===p?!0:p;z=void 0===z?!0:z;y=void 0===y?.1:y;A=void 0===A?.95:A;x=void 0===x?.01:x;u=void 0===u?.0025:u;E=void 0===E?.9:E;B=void 0===B?.005:B;L=void 0===L?function(){}:
L;J=void 0===J?function(){}:J;ca=void 0===ca?function(){}:ca;O=void 0===O?function(){}:O;Q=void 0===Q?function(){}:Q;P=void 0===P?function(){}:P;S=void 0===S?function(){}:S;var v=[],D=[],ia=0,la=0,N=e.builder("group",void 0===c?"list_image":c,{x:f,y:a,angle:void 0===g?0:g});c=e.builder("image","backing",{width:b,height:d,url:C});N.append(c);var ea=e.builder("group","itemCollection");N.append(ea);var ja=h();c=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});N.append(c);
f=e.builder("rectangle","stencil",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});N.stencil(f);N.clip(!0);c.onwheel=function(a,b,d){if(l)for(a=d.deltaY/100,N.position(N.position()+a/10),a=0;a<v.length;a++)v[a].forceMouseLeave()};N.position=function(a,b){b=void 0===b?!0:b;if(void 0==a)return la;a=0>a?0:a;la=a=1<a?1:a;if(!(ja<d)&&(ea.parameter.y(-a*(ja-d)),b&&this.onpositionchange))this.onpositionchange(a)};N.select=function(a,b,d,c){c=void 0===c?!0:c;if(p){if(m)if(void 0!=d&&d.shiftKey){b=Math.min(ia,
a);a=Math.max(ia,a);for(d=0;d<v.length;d++)v[d].name==""+b&&(b=d),v[d].name==""+a&&(a=d);D=[];for(d=0;d<v.length;d++)(d>a||d<b)&&v[d].select()&&v[d].select(!1,void 0,!1);for(d=b;d<=a;d++)v[d].select()||(v[d].select(!0,void 0,!1),D.push(d))}else c&&v[a].select(b),b&&!D.includes(a)?D.push(a):!b&&D.includes(a)&&D.splice(D.indexOf(a),1),ia=a;else{if(b&&!D.includes(a)){for(;0<D.length;)ea.children[D[0]].select(!1,void 0,!1),D.shift();D.push(a)}else!b&&D.includes(a)&&(D=[]);c&&ea.children[a].select(!0,
void 0,!1)}N.onselection(D)}};N.add=function(a){k.push(a);ja=h()};N.remove=function(a){k.splice(a,1);ja=h()};N.interactable=function(a){if(void 0==a)return l;l=a;h()};N.onenter=L;N.onleave=J;N.onpress=ca;N.ondblpress=O;N.onrelease=Q;N.onselection=P;N.onpositionchange=S;return N};this.list=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y,A,x,u,E,B,C,H,w,I,K,M,aa,V,ha,R,W,X,Y,Z,ka,G,F,ba,T,L,J,ca,O,Q,P,S,U,da,ma,ia,la,N,ea,ja,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ia,Ja,Ha,Ka,La,Oa,Pa,Na,
Qa,Ra,Sa,Ta){function h(){v=[];Ma.clear();D=[];for(var a=Ga=Va=0,c=0;c<k.length;c++)if("space"==k[c]){var f=e.builder("rectangle",""+c,{x:0,y:a,width:b,height:d*B,style:{fill:"rgba(255,0,0,0)"}});a+=d*(B+x);Ma.append(f)}else"break"==k[c]?(f=e.builder("rectangle",""+c,{x:b*(1-E)*.5,y:a,width:b*E,height:d*u,style:{fill:H}}),a+=d*(u+x),Ma.append(f)):(f=e.builder("button_rectangle",""+c,{x:b*(1-A)*.5,y:a,width:b*A,height:d*y,interactable:l,text_left:k[c].text_left,text_centre:k[c].text?k[c].text:k[c].text_centre,
text_right:k[c].text_right,textVerticalOffset:q,textHorizontalOffsetMux:r,active:n,hoverable:t,selectable:p,pressable:z,style:{text_font:w,text_textBaseline:I,text_fill:K,text_stroke:M,text_lineWidth:aa,background__off__fill:V,background__off__stroke:ha,background__off__lineWidth:R,background__up__fill:W,background__up__stroke:X,background__up__lineWidth:Y,background__press__fill:Z,background__press__stroke:ka,background__press__lineWidth:G,background__select__fill:F,background__select__stroke:ba,
background__select__lineWidth:T,background__select_press__fill:L,background__select_press__stroke:J,background__select_press__lineWidth:ca,background__glow__fill:O,background__glow__stroke:Q,background__glow__lineWidth:P,background__glow_press__fill:S,background__glow_press__stroke:U,background__glow_press__lineWidth:da,background__glow_select__fill:ma,background__glow_select__stroke:ia,background__glow_select__lineWidth:la,background__glow_select_press__fill:N,background__glow_select_press__stroke:ea,
background__glow_select_press__lineWidth:ja,background__hover__fill:na,background__hover__stroke:oa,background__hover__lineWidth:pa,background__hover_press__fill:ra,background__hover_press__stroke:sa,background__hover_press__lineWidth:ua,background__hover_select__fill:va,background__hover_select__stroke:qa,background__hover_select__lineWidth:ta,background__hover_select_press__fill:wa,background__hover_select_press__stroke:xa,background__hover_select_press__lineWidth:ya,background__hover_glow__fill:za,
background__hover_glow__stroke:Aa,background__hover_glow__lineWidth:Ba,background__hover_glow_press__fill:Ca,background__hover_glow_press__stroke:Da,background__hover_glow_press__lineWidth:Ea,background__hover_glow_select__fill:Fa,background__hover_glow_select__stroke:Ia,background__hover_glow_select__lineWidth:Ja,background__hover_glow_select_press__fill:Ha,background__hover_glow_select_press__stroke:Ka,background__hover_glow_select_press__lineWidth:La}}),f.onenter=function(a){return function(){fa.onenter(a)}}(c),
f.onleave=function(a){return function(){fa.onleave(a)}}(c),f.onpress=function(a){return function(){fa.onpress(a)}}(c),f.ondblpress=function(a){return function(){fa.ondblpress(a)}}(c),f.onrelease=function(a){return function(){k[a].function&&k[a].function();fa.onrelease(a)}}(c),f.onselect=function(a){return function(b,d){fa.select(a,!0,d,!1)}}(c),f.ondeselect=function(a){return function(b,d){fa.select(a,!1,d,!1)}}(c),a+=d*(y+x),Ma.append(f),v.push(f));return a-d*x}b=void 0===b?50:b;d=void 0===d?100:
d;l=void 0===l?!0:l;k=void 0===k?[]:k;q=void 0===q?.5:q;r=void 0===r?.05:r;n=void 0===n?!0:n;m=void 0===m?!0:m;t=void 0===t?!0:t;p=void 0===p?!0:p;z=void 0===z?!0:z;y=void 0===y?.1:y;A=void 0===A?.95:A;x=void 0===x?.01:x;u=void 0===u?.0025:u;E=void 0===E?.9:E;B=void 0===B?.005:B;C=void 0===C?"rgba(230,230,230,1)":C;H=void 0===H?"rgba(195,195,195,1)":H;w=void 0===w?"5pt Arial":w;I=void 0===I?"alphabetic":I;K=void 0===K?"rgba(0,0,0,1)":K;M=void 0===M?"rgba(0,0,0,0)":M;aa=void 0===aa?1:aa;V=void 0===
V?"rgba(180,180,180,1)":V;ha=void 0===ha?"rgba(0,0,0,0)":ha;R=void 0===R?0:R;W=void 0===W?"rgba(200,200,200,1)":W;X=void 0===X?"rgba(0,0,0,0)":X;Y=void 0===Y?0:Y;Z=void 0===Z?"rgba(230,230,230,1)":Z;ka=void 0===ka?"rgba(0,0,0,0)":ka;G=void 0===G?0:G;F=void 0===F?"rgba(200,200,200,1)":F;ba=void 0===ba?"rgba(120,120,120,1)":ba;T=void 0===T?2:T;L=void 0===L?"rgba(230,230,230,1)":L;J=void 0===J?"rgba(120,120,120,1)":J;ca=void 0===ca?2:ca;O=void 0===O?"rgba(220,220,220,1)":O;Q=void 0===Q?"rgba(0,0,0,0)":
Q;P=void 0===P?0:P;S=void 0===S?"rgba(250,250,250,1)":S;U=void 0===U?"rgba(0,0,0,0)":U;da=void 0===da?0:da;ma=void 0===ma?"rgba(220,220,220,1)":ma;ia=void 0===ia?"rgba(120,120,120,1)":ia;la=void 0===la?2:la;N=void 0===N?"rgba(250,250,250,1)":N;ea=void 0===ea?"rgba(120,120,120,1)":ea;ja=void 0===ja?2:ja;na=void 0===na?"rgba(220,220,220,1)":na;oa=void 0===oa?"rgba(0,0,0,0)":oa;pa=void 0===pa?0:pa;ra=void 0===ra?"rgba(240,240,240,1)":ra;sa=void 0===sa?"rgba(0,0,0,0)":sa;ua=void 0===ua?0:ua;va=void 0===
va?"rgba(220,220,220,1)":va;qa=void 0===qa?"rgba(120,120,120,1)":qa;ta=void 0===ta?2:ta;wa=void 0===wa?"rgba(240,240,240,1)":wa;xa=void 0===xa?"rgba(120,120,120,1)":xa;ya=void 0===ya?2:ya;za=void 0===za?"rgba(240,240,240,1)":za;Aa=void 0===Aa?"rgba(0,0,0,0)":Aa;Ba=void 0===Ba?0:Ba;Ca=void 0===Ca?"rgba(250,250,250,1)":Ca;Da=void 0===Da?"rgba(0,0,0,0)":Da;Ea=void 0===Ea?0:Ea;Fa=void 0===Fa?"rgba(240,240,240,1)":Fa;Ia=void 0===Ia?"rgba(120,120,120,1)":Ia;Ja=void 0===Ja?2:Ja;Ha=void 0===Ha?"rgba(250,250,250,1)":
Ha;Ka=void 0===Ka?"rgba(120,120,120,1)":Ka;La=void 0===La?2:La;Oa=void 0===Oa?function(){}:Oa;Pa=void 0===Pa?function(){}:Pa;Na=void 0===Na?function(){}:Na;Qa=void 0===Qa?function(){}:Qa;Ra=void 0===Ra?function(){}:Ra;Sa=void 0===Sa?function(){}:Sa;Ta=void 0===Ta?function(){}:Ta;var v=[],D=[],Ga=0,Va=0,fa=e.builder("group",void 0===c?"list":c,{x:f,y:a,angle:void 0===g?0:g});c=e.builder("rectangle","backing",{width:b,height:d,style:{fill:C}});fa.append(c);var Ma=e.builder("group","itemCollection");
fa.append(Ma);var Ua=h();c=e.builder("rectangle","cover",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});fa.append(c);f=e.builder("rectangle","stencil",{width:b,height:d,style:{fill:"rgba(0,0,0,0)"}});fa.stencil(f);fa.clip(!0);c.onwheel=function(a,b,d){if(l)for(a=d.deltaY/100,fa.position(fa.position()+a/10),a=0;a<v.length;a++)v[a].forceMouseLeave()};fa.position=function(a,b){b=void 0===b?!0:b;if(void 0==a)return Va;a=0>a?0:a;Va=a=1<a?1:a;if(!(Ua<d)&&(Ma.parameter.y(-a*(Ua-d)),b&&this.onpositionchange))this.onpositionchange(a)};
fa.select=function(a,b,d,c){c=void 0===c?!0:c;if(p){if(m)if(void 0!=d&&d.shiftKey){b=Math.min(Ga,a);a=Math.max(Ga,a);for(d=0;d<v.length;d++)v[d].name==""+b&&(b=d),v[d].name==""+a&&(a=d);D=[];for(d=0;d<v.length;d++)(d>a||d<b)&&v[d].select()&&v[d].select(!1,void 0,!1);for(d=b;d<=a;d++)v[d].select()||(v[d].select(!0,void 0,!1),D.push(d))}else c&&v[a].select(b),b&&!D.includes(a)?D.push(a):!b&&D.includes(a)&&D.splice(D.indexOf(a),1),Ga=a;else{if(b&&!D.includes(a)){for(;0<D.length;)Ma.children[D[0]].select(!1,
void 0,!1),D.shift();D.push(a)}else!b&&D.includes(a)&&(D=[]);c&&Ma.children[a].select(!0,void 0,!1)}fa.onselection(D)}};fa.add=function(a){k.push(a);Ua=h()};fa.remove=function(a){k.splice(a,1);Ua=h()};fa.interactable=function(a){if(void 0==a)return l;l=a;h()};fa.onenter=Oa;fa.onleave=Pa;fa.onpress=Na;fa.ondblpress=Qa;fa.onrelease=Ra;fa.onselection=Sa;fa.onpositionchange=Ta;return fa}};this.display=new function(){this.rastorDisplay=function(c,f,a,b,d,g,l,k,q,r,n,m){function h(){for(var a=0;a<l;a++)for(var b=
0;b<k;b++)p[a][b].style.fill="rgb("+255*v[a][b][0]+","+255*v[a][b][1]+","+255*v[a][b][2]+")"}d=void 0===d?60:d;g=void 0===g?60:g;l=void 0===l?8:l;k=void 0===k?8:k;q=void 0===q?.1:q;r=void 0===r?.1:r;n=void 0===n?"rgba(50,50,50)":n;m=void 0===m?"rgba(0,0,0)":m;c=e.builder("group",void 0===c?"rastorDisplay":c,{x:f,y:a,angle:void 0===b?0:b});n=e.builder("rectangle","backing",{width:d,height:g,style:{fill:n}});c.append(n);b=e.builder("group","pixels");c.append(b);var p=[],v=[];d/=l;g/=k;for(f=0;f<l;f++){var y=
[],A=[];for(a=0;a<k;a++)n=e.builder("rectangle",f+"_"+a,{x:f*d+q/2,y:a*g+r/2,width:d-q,height:g-r,style:{fill:m}}),y.push(n),A.push([0,0,0]),b.append(n);p.push(y);v.push(A)}c.get=function(a,b){return v[a][b]};c.set=function(a,b,d){v[a][b]=d;h()};c.import=function(a){for(var b=0;b<l;b++)for(var d=0;d<k;d++)this.set(b,d,a[b][d]);h()};c.export=function(){return v};c.setAll=function(a){for(var b=0;b<l;b++)for(var d=0;d<k;d++)this.set(b,d,a)};c.test=function(){this.setAll([1,1,1]);this.set(1,1,[1,.5,.5]);
this.set(2,2,[.5,1,.5]);this.set(3,3,[.5,.5,1]);this.set(4,4,[1,.5,1]);h()};return c};this.grapher_audioScope=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p){c=void 0===c?"grapher_audioScope":c;b=void 0===b?120:b;d=void 0===d?60:d;h=void 0===h?0:h;l=void 0===l?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:l;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;q=void 0===q?"rgba(0,100,0,1)":q;r=void 0===r?.25:r;n=void 0===n?"rgba(0,150,0,1)":n;m=void 0===m?.1:m;t=void 0===t?"Helvetica":
t;p=void 0===p?"rgba(50,50,50,1)":p;var v=g.library.audio.context.createAnalyser(),y=null,A=10,x=null,u=256;v.fftSize=u;y=new Uint8Array(v.fftSize);new Uint8Array(v.fftSize);f=e.builder("group",c,{x:f,y:a,angle:h});var E=e.builder("grapher",c,{x:0,y:0,width:b,height:d,foregroundStyles:[l],foregroundTextStyles:[k],backgroundStyle_stroke:q,backgroundStyle_lineWidth:r,backgroundTextStyle_fill:n,backgroundTextStyle_size:m,backgroundTextStyle_font:t,backingStyle:p});f.append(E);f.start=function(){null==
x&&(x=setInterval(function(){var a=[];v.getByteTimeDomainData(y);for(var b=0;b<y.length;b++)a.push(y[b]/128-1);E.draw(a)},1E3/A))};f.stop=function(){clearInterval(x);x=null};f.getNode=function(){return v};f.resolution=function(a){a=void 0===a?null:a;if(null==a)return u;u=a;this.stop();this.start()};f.refreshRate=function(a){if(null==a)return A;A=a;this.stop();this.start()};E.viewbox({l:-1.1,h:1.1});E.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});E.verticalMarkings({points:[-.25,
-.5,-.75,0,.25,.5,.75],printText:!1});E.drawBackground();return f};this.sevenSegmentDisplay=function(c,f,a,b,d,g,l,k,q){b=void 0===b?20:b;d=void 0===d?30:d;l=void 0===l?"rgb(0,0,0)":l;k=void 0===k?"rgb(200,200,200)":k;q=void 0===q?"rgb(20,20,20)":q;var h=b/8,n=b/8;g=[{x:1*n+h,y:1*n+h},{x:.5*n+h,y:.5*n+h},{x:1*n+h,y:0*n+h},{x:0*n+h,y:1*n+h}];var m=[{x:b-1*n-h,y:0*n+h},{x:b-.5*n-h,y:.5*n+h},{x:b-1*n-h,y:1*n+h},{x:b-0*n-h,y:1*n+h}],t=[{x:1*n+h,y:.5*d-1*n+.5*h},{x:.5*n+h,y:.5*d-.5*n+.5*h},{x:1*n+h,y:.5*
d-0*n+.5*h},{x:0*n+h,y:.5*d-1*n+.5*h},{x:0*n+h,y:.5*d-0*n+.5*h}],p=[{x:b-1*n-h,y:.5*d-0*n+.5*h},{x:b-.5*n-h,y:.5*d-.5*n+.5*h},{x:b-1*n-h,y:.5*d-1*n+.5*h},{x:b-0*n-h,y:.5*d-1*n+.5*h},{x:b-0*n-h,y:.5*d-0*n+.5*h}],z=[{x:1*n+h,y:d-1*n-h},{x:.5*n+h,y:d-.5*n-h},{x:1*n+h,y:d-0*n-h},{x:0*n+h,y:d-1*n-h}];h=[{x:b-1*n-h,y:d-0*n-h},{x:b-.5*n-h,y:d-.5*n-h},{x:b-1*n-h,y:d-1*n-h},{x:b-0*n-h,y:d-1*n-h}];c=e.builder("group",void 0===c?"sevenSegmentDisplay":c,{x:f,y:a});b=e.builder("rectangle","backing",{width:b,height:d,
style:{fill:l}});c.append(b);var y=[];b=[[g[0],m[2],m[1],m[0],g[2],g[1]],[g[1],g[3],t[3],t[1],t[0],g[0]],[m[1],m[3],p[3],p[1],p[2],m[2]],[t[0],p[2],p[1],p[0],t[2],t[1]],[t[1],t[4],z[3],z[1],z[0],t[2]],[p[1],p[4],h[3],h[1],h[2],p[0]],[z[0],h[2],h[1],h[0],z[2],z[1]]];for(d=0;d<b.length;d++)l={segment:e.builder("polygon","segment_"+d,{points:b[d],style:{fill:q}}),state:!1},y.push(l),c.append(l.segment);c.set=function(a,b){y[a].state=b;y[a].segment.style.fill=b?k:q};c.get=function(a){return y[a].state};
c.clear=function(){for(var a=0;a<y.length;a++)this.set(a,!1)};c.enterCharacter=function(a){switch(a){case 0:case "0":a=[1,1,1,0,1,1,1];break;case 1:case "1":a=[0,0,1,0,0,1,0];break;case 2:case "2":a=[1,0,1,1,1,0,1];break;case 3:case "3":a=[1,0,1,1,0,1,1];break;case 4:case "4":a=[0,1,1,1,0,1,0];break;case 5:case "5":a=[1,1,0,1,0,1,1];break;case 6:case "6":a=[1,1,0,1,1,1,1];break;case 7:case "7":a=[1,0,1,0,0,1,0];break;case 8:case "8":a=[1,1,1,1,1,1,1];break;case 9:case "9":a=[1,1,1,1,0,1,1];break;
default:a=[0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,1==a[b])};return c};this.sixteenSegmentDisplay=function(c,f,a,b,d,h,g,k,q){b=void 0===b?20:b;d=void 0===d?30:d;g=void 0===g?"rgb(0,0,0)":g;k=void 0===k?"rgb(200,200,200)":k;q=void 0===q?"rgb(20,20,20)":q;var l=b/8,n=b/8;h=[{x:.5*n+l,y:.5*n+l},{x:1*n+l,y:0*n+l},{x:0*n+l,y:1*n+l},{x:1*n+l,y:1*n+l},{x:1.75*n+l,y:1*n+l},{x:1*n+l,y:1.75*n+l}];var m=[{x:b/2,y:.5*n+l},{x:b/2-.5*n,y:1*n+l},{x:b/2+.5*n,y:1*n+l},{x:b/2-.5*n,y:0*n+l},{x:b/2+.5*
n,y:0*n+l}],t=[{x:b-.5*n-l,y:.5*n+l},{x:b-1*n-l,y:0*n+l},{x:b-0*n-l,y:1*n+l},{x:b-1*n-l,y:1*n+l},{x:b-1*n-l,y:1.75*n+l},{x:b-1.75*n-l,y:1*n+l}],p=[{x:0*n+l,y:.5*d-.5*n},{x:1*n+l,y:.5*d-.5*n},{x:.5*n+l,y:.5*d-0*n},{x:0*n+l,y:.5*d+.5*n},{x:1*n+l,y:.5*d+.5*n}],z=[{x:b/2,y:d/2},{x:b/2-.5*n,y:.5*n+d/2},{x:b/2-.25*n,y:1.25*n+d/2},{x:b/2-1*n,y:.5*n+d/2},{x:b/2+.5*n,y:.5*n+d/2},{x:b/2+.5*n,y:1.75*n+d/2},{x:b/2+1*n,y:.5*n+d/2},{x:b/2-.5*n,y:.5*-n+d/2},{x:b/2-.25*n,y:1.25*-n+d/2},{x:b/2-1*n,y:.25*-n+d/2},{x:b/
2+.5*n,y:.5*-n+d/2},{x:b/2+.5*n,y:1.75*-n+d/2},{x:b/2+1*n,y:.25*-n+d/2}],y=[{x:b-1*n-l,y:.5*d-.5*n},{x:b-0*n-l,y:.5*d-.5*n},{x:b-.5*n-l,y:.5*d-0*n},{x:b-1*n-l,y:.5*d+.5*n},{x:b-0*n-l,y:.5*d+.5*n}],A=[{x:.5*n+l,y:d-.5*n-l},{x:0*n+l,y:d-1*n-l},{x:1*n+l,y:d-0*n-l},{x:1*n+l,y:d-1*n-l},{x:1*n+l,y:d-1.75*n-l},{x:1.75*n+l,y:d-1*n-l}],x=[{x:b/2-.5*n,y:d-1*n-l},{x:b/2+.5*n,y:d-1*n-l},{x:b/2,y:d-.5*n-l},{x:b/2-.5*n,y:d-0*n-l},{x:b/2+.5*n,y:d-0*n-l}];l=[{x:b-.5*n-l,y:d-.5*n-l},{x:b-0*n-l,y:d-1*n-l},{x:b-1*n-
l,y:d-0*n-l},{x:b-1*n-l,y:d-1*n-l},{x:b-1*n-l,y:d-1.75*n-l},{x:b-1.75*n-l,y:d-1*n-l}];c=e.builder("group",void 0===c?"sixteenSegmentDisplay":c,{x:f,y:a});b=e.builder("rectangle","backing",{width:b,height:d,style:{fill:g}});c.append(b);var u=[];b=[[h[1],h[0],h[3],m[1],m[0],m[3]],[m[4],m[0],m[2],t[3],t[0],t[1]],[h[0],h[2],p[0],p[2],p[1],h[3]],[h[4],h[3],h[5],z[9],z[7],z[8]],[m[0],m[1],z[7],z[0],z[10],m[2]],[t[4],t[3],t[5],z[11],z[10],z[12]],[t[0],t[2],y[1],y[2],y[0],t[3]],[p[4],p[2],p[1],z[7],z[0],
z[1]],[y[3],y[2],y[0],z[10],z[0],z[4]],[A[0],A[1],p[3],p[2],p[4],A[3]],[A[4],A[3],A[5],z[2],z[1],z[3]],[x[0],x[2],x[1],z[4],z[0],z[1]],[l[4],l[3],l[5],z[5],z[4],z[6]],[l[3],y[3],y[2],y[4],l[1],l[0]],[A[2],A[0],A[3],x[0],x[2],x[3]],[l[2],l[0],l[3],x[1],x[2],x[4]]];for(d=0;d<b.length;d++)g={segment:e.builder("polygon","segment_"+d,{points:b[d],style:{fill:q}}),state:!1},u.push(g),c.append(g.segment);c.set=function(a,b){u[a].state=b;u[a].segment.style.fill=b?k:q};c.get=function(a){return u[a].state};
c.clear=function(){for(var a=0;a<u.length;a++)this.set(a,!1)};c.enterCharacter=function(a){switch(a){case "!":a=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":a=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":a=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":a=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":a=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':a=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];
break;case "-":a=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":a=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":a=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":a=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":a=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":a=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":a=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":a=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":a=[1,1,1,0,0,0,0,0,0,1,0,0,
0,0,1,1];break;case "]":a=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":a=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":a=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":a=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":a=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":a=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":a=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":a=[1,1,1,0,0,0,0,1,
1,1,0,0,0,1,1,1];break;case "7":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":a=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":a=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":a=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":a=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":a=[1,1,
1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":a=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":a=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":a=[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":a=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":a=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":a=[0,0,1,1,0,0,1,0,0,1,0,0,1,
1,0,0];break;case "o":case "O":a=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":a=[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":a=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":a=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":a=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":a=
[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":a=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":a=[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":a=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,1==a[b])};return c};this.glowbox_rect=function(c,f,a,b,d,h,l,k){b=void 0===b?30:b;d=void 0===d?30:d;h=void 0===h?0:h;l=void 0===l?"rgba(244,234,141,1)":
l;k=void 0===k?"rgba(80,80,80,1)":k;c=e.builder("group",void 0===c?"glowbox_rect":c,{x:f,y:a});var g=e.builder("rectangle","light",{width:b,height:d,angle:h,style:{fill:k}});c.append(g);c.on=function(){g.style.fill=l};c.off=function(){g.style.fill=k};return c};this.audio_meter_level=function(c,f,a,b,d,h,l,k,g,r,n){d=void 0===d?20:d;h=void 0===h?60:h;l=void 0===l?[.125,.25,.375,.5,.625,.75,.875]:l;k=void 0===k?"rgb(10,10,10)":k;g=void 0===g?["rgba(250,250,250,1)","rgb(100,100,100)"]:g;r=void 0===r?
"rgba(220,220,220,1)":r;n=void 0===n?"1pt Courier New":n;c=e.builder("group",void 0===c?"audio_meter_level":c,{x:f,y:a,angle:void 0===b?0:b});var q=e.builder("meter_level","meter",{width:d,height:h,markings:l,style:{backing:k,levels:g,markingStyle_fill:r,markingStyle_font:n}});c.append(q);var t=m.circuit.audio2percentage();t.newValue=function(a){q.set(a)};c.audioIn=function(){return t.audioIn()};c.start=function(){t.start()};c.stop=function(){t.stop()};return c};this.grapher__static=function(c,f,
a,b,d,h,l,k,q,r,n,m,t,p){function v(){C._.fillStyle=p;C._.fillRect(0,0,C.$(b),C.$(d))}function y(){for(var a=g.library.math.relativeDistance(b,x.left,x.right,u.mappedPosition),c=0;c<u.points.length;c++)if(u.points[c]<x.top||u.points[c]>x.bottom){var e=d-g.library.math.relativeDistance(d,x.bottom,x.top,u.points[c]);C._.fillStyle=r;C._.fillRect(0,C.$(e),C.$(b),C.$(n));u.printText&&(C._.fillStyle=m,C._.font=t,C._.fillText(u.printingValues&&void 0!=u.printingValues[c]?u.printingValues[c]:u.points[c],
C.$(a+u.textPositionOffset.x),C.$(e+u.textPositionOffset.y)))}e=d-g.library.math.relativeDistance(d,x.bottom,x.top,w.mappedPosition);for(c=0;c<w.points.length;c++)w.points[c]<x.left||w.points[c]>x.right||(a=g.library.math.relativeDistance(b,x.left,x.right,w.points[c]),C._.fillStyle=r,C._.fillRect(C.$(a),0,C.$(n),C.$(d)),w.printText&&(C._.fillStyle=m,C._.font=t,C._.fillText(w.printingValues&&void 0!=w.printingValues[c]?w.printingValues[c]:w.points[c],C.$(a+w.textPositionOffset.x),C.$(e+w.textPositionOffset.y))))}
function A(a,e,f){f=void 0===f?0:f;B[f]=void 0==a&&void 0==e?void 0:{x:e,y:a};if(void 0!=B[f]&&void 0==B[f].y)console.warn("grapher__static error",c,"attempting to add line with no y component"),console.warn("x:",B[f].x),console.warn("y:",B[f].y);else for(a=0;a<B.length;a++)if(void 0!=B[a]){f=B[a];C._.strokeStyle=k[a].stroke;C._.lineWidth=C.$(k[a].lineWidth);C._.lineJoin=k[a].lineJoin;C._.lineCap=k[a].lineJoin;C._.beginPath();if(void 0!=f.y&&void 0==f.x)for(C._.moveTo(0,C.$(d-g.library.math.relativeDistance(d,
x.bottom,x.top,f.y[0],!0))),e=1;e<f.y.length;e++)C._.lineTo(C.$(b/(f.y.length-1)*e),C.$(d-g.library.math.relativeDistance(d,x.bottom,x.top,f.y[e],!0)));else if(f.y.length==f.x.length)for(e=0;e<f.y.length;e++)for(C._.moveTo(C.$(g.library.math.relativeDistance(b,x.left,x.right,f.x[0],!0)),C.$(d-g.library.math.relativeDistance(d,x.bottom,x.top,f.y[0],!0))),e=1;e<f.y.length;e++)C._.lineTo(C.$(g.library.math.relativeDistance(b,x.left,x.right,f.x[e],!0)),C.$(d-g.library.math.relativeDistance(d,x.bottom,
x.top,f.y[e],!0)));else console.error("grapher__static::"+c,":layers are of different length:",f.y,f.x);C._.stroke()}}c=void 0===c?"grapher__static":c;b=void 0===b?120:b;d=void 0===d?60:d;l=void 0===l?5:l;k=void 0===k?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:k;r=void 0===r?"rgba(0,100,0,1)":r;n=void 0===n?.25:n;m=void 0===m?"rgba(0,150,0,1)":m;t=void 0===t?"7.5pt Helvetica":
t;p=void 0===p?"rgba(50,50,50,1)":p;var x={bottom:-1,top:1,left:-1,right:1},u={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},w={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},B=[];f=e.builder("group",c,{x:f,y:a,angle:void 0===h?0:h});var C=e.builder("canvas","backing",{width:b,height:d,resolution:l});f.append(C);f.resolution=function(a){return C.resolution(a)};
f.viewbox=function(a){if(null==a)return x;void 0!=a.bottom&&(x.bottom=a.bottom);void 0!=a.top&&(x.top=a.top);void 0!=a.left&&(x.left=a.left);void 0!=a.right&&(x.right=a.right)};f.horizontalMarkings=function(a){if(null==a)return u;void 0!=a.points&&(u.points=a.points);void 0!=a.printingValues&&(u.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(u.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(u.printText=a.printText)};f.verticalMarkings=function(a){if(null==a)return w;
void 0!=a.points&&(w.points=a.points);void 0!=a.printingValues&&(w.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(w.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(w.printText=a.printText)};f.drawBackground=function(){v();y()};f.drawForeground=function(a,b,d){A(a,b,void 0===d?0:d)};f.draw=function(a,b,d){d=void 0===d?0:d;v();y();A(a,b,d)};return f};this.grapher_periodicWave__static=function(c,f,a,b,d,h,l,k,g,r,n,m,t,p){c=void 0===c?"grapher_periodicWave__static":c;
b=void 0===b?120:b;d=void 0===d?60:d;l=void 0===l?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:l;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;g=void 0===g?"rgba(0,100,0,1)":g;r=void 0===r?.25:r;n=void 0===n?"rgba(0,150,0,1)":n;m=void 0===m?.1:m;t=void 0===t?"Helvetica":t;p=void 0===p?"rgba(50,50,50,1)":p;var q={sin:[],cos:[]},v=100;f=e.builder("group",c,{x:f,y:a,angle:void 0===h?0:h});var A=e.builder("grapher__static",c,{x:0,y:0,width:b,height:d,foregroundStyles:[l],
foregroundTextStyles:[k],backgroundStyle_stroke:g,backgroundStyle_lineWidth:r,backgroundTextStyle_fill:n,backgroundTextStyle_size:m,backgroundTextStyle_font:t,backingStyle:p});f.append(A);f.wave=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;if(null==a){for(;q.sin.length<q.cos.length;)q.sin.push(0);for(;q.sin.length>q.cos.length;)q.cos.push(0);for(a=0;a<q.sin.length;a++)q.sin[a]||(q.sin[a]=0),q.cos[a]||(q.cos[a]=0);return q}null==b&&(q=a);switch(b){case "sin":q.sin=a;break;case "cos":q.cos=
a}};f.waveElement=function(a,b,d){if(null==d)return q[a][b];q[a][b]=d};f.resolution=function(a){a=void 0===a?null:a;if(null==a)return v;v=a};f.updateBackground=function(){A.viewbox({bottom:-1.1,top:1.1,left:0});A.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});A.verticalMarkings({points:[0,.25,.5,.75],printText:!0});A.drawBackground()};f.draw=function(){for(var a=[],b,d=0;d<=v;d++){for(var c=b=0;c<q.sin.length;c++)q.sin[c]||(q.sin[c]=0),b+=Math.sin(d/v*c*Math.PI*2)*q.sin[c];
for(c=0;c<q.cos.length;c++)q.cos[c]||(q.cos[c]=0),b+=Math.cos(d/v*c*Math.PI*2)*q.cos[c];a.push(b)}A.draw(a)};f.reset=function(){this.wave({sin:[],cos:[]});this.resolution(100);this.updateBackground()};return f};this.grapher=function(c,f,a,b,d,h,l,k,q,r,n,m,t){function p(){w.clear();for(var a=g.library.math.relativeDistance(b,y.left,y.right,A.mappedPosition),c=0;c<A.points.length;c++)if(A.points[c]<y.top||A.points[c]>y.bottom){var f=d-g.library.math.relativeDistance(d,y.bottom,y.top,A.points[c]),k=
e.builder("rectangle","horizontal_line_"+c,{x:0,y:f,width:b,height:r,style:{fill:q}});w.append(k);A.printText&&(k=e.builder("text","horizontal_text_"+c,{x:a+A.textPositionOffset.x,y:f+A.textPositionOffset.y,text:A.printingValues&&void 0!=A.printingValues[c]?A.printingValues[c]:A.points[c],style:{fill:n,font:m}}),w.append(k))}f=d-g.library.math.relativeDistance(d,y.bottom,y.top,x.mappedPosition);for(c=0;c<x.points.length;c++)x.points[c]<y.left||x.points[c]>y.right||(a=g.library.math.relativeDistance(b,
y.left,y.right,x.points[c]),k=e.builder("rectangle","vertical_line_"+c,{x:a,y:0,width:r,height:d,style:{fill:q}}),w.append(k),x.printText&&(k=e.builder("text","vertical_text_"+c,{x:a+x.textPositionOffset.x,y:f+x.textPositionOffset.y,text:x.printingValues&&void 0!=x.printingValues[c]?x.printingValues[c]:x.points[c],style:{fill:n,font:m}}),w.append(k)))}function v(a,f,k){k=void 0===k?0:k;B.clear();u[k]=void 0==a&&void 0==f?void 0:{x:f,y:a};if(void 0!=u[k]&&void 0==u[k].y)console.warn("grapher error",
c,"attempting to add line with no y component"),console.warn("x:",u[k].x),console.warn("y:",u[k].y);else for(a=0;a<u.length;a++)if(void 0!=u[a]){k=u[a];f=[];if(void 0!=k.y&&void 0==k.x)for(var h=0;h<k.y.length;h++)f.push({x:b/(k.y.length-1)*h,y:d-g.library.math.relativeDistance(d,y.bottom,y.top,k.y[h],!0)});else if(k.y.length==k.x.length)for(h=0;h<k.y.length;h++)f.push({x:g.library.math.relativeDistance(b,y.left,y.right,k.x[h],!0),y:d-g.library.math.relativeDistance(d,y.bottom,y.top,k.y[h],!0)});
else console.error("grapher::"+c,":layers are of differnt length:",k.y,k.x);B.append(e.builder("path","layer_"+a,{points:f,style:{stroke:l[a].stroke,lineWidth:l[a].lineWidth,lineJoin:l[a].lineJoin,lineCap:l[a].lineJoin}}))}}c=void 0===c?"grapher":c;b=void 0===b?120:b;d=void 0===d?60:d;l=void 0===l?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:l;q=void 0===q?"rgba(0,100,0,1)":
q;r=void 0===r?.25:r;n=void 0===n?"rgba(0,150,0,1)":n;m=void 0===m?"1.5pt Helvetica":m;t=void 0===t?"rgba(50,50,50,1)":t;var y={bottom:-1,top:1,left:-1,right:1},A={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},x={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},u=[];f=e.builder("group",c,{x:f,y:a,angle:void 0===h?0:h});t=e.builder("rectangle","backing",{width:b,
height:d,style:{fill:t}});f.append(t);var w=e.builder("group","background");f.append(w);var B=e.builder("group","foreground");f.append(B);t=e.builder("rectangle","stencil",{width:b,height:d});f.stencil(t);f.clip(!0);f.viewbox=function(a){if(null==a)return y;void 0!=a.bottom&&(y.bottom=a.bottom);void 0!=a.top&&(y.top=a.top);void 0!=a.left&&(y.left=a.left);void 0!=a.right&&(y.right=a.right)};f.horizontalMarkings=function(a){if(null==a)return A;void 0!=a.points&&(A.points=a.points);void 0!=a.printingValues&&
(A.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(A.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(A.printText=a.printText)};f.verticalMarkings=function(a){if(null==a)return x;void 0!=a.points&&(x.points=a.points);void 0!=a.printingValues&&(x.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(x.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(x.printText=a.printText)};f.drawBackground=function(){p()};f.drawForeground=function(a,b,d){v(a,
b,void 0===d?0:d)};f.draw=function(a,b,d){d=void 0===d?0:d;p();v(a,b,d)};return f};this.meter_level=function(c,f,a,b,d,h,l,k,g,r,n){function q(a){return e.builder("polygon","mark_"+a,{points:[{x:d,y:a-.1},{x:d-d/4,y:a-.1},{x:d-d/4,y:a+.1},{x:d,y:a+.1}],style:{fill:r}})}function m(a,b){return e.builder("text","text_"+b,{x:.5,y:a+.3,text:b,style:{fill:r,font:n}})}d=void 0===d?20:d;h=void 0===h?60:h;l=void 0===l?[.125,.25,.375,.5,.625,.75,.875]:l;k=void 0===k?"rgb(10,10,10)":k;g=void 0===g?["rgba(250,250,250,1)",
"fill:rgb(100,100,100)"]:g;r=void 0===r?"rgba(220,220,220,1)":r;n=void 0===n?"1pt Courier New":n;c=e.builder("group",void 0===c?"meter_level":c,{x:f,y:a,angle:void 0===b?0:b});var p=e.builder("level","level",{width:d,height:h,style:{backing:k,levels:g}});c.append(p);k=e.builder("group","markings");c.append(k);for(g=0;g<l.length;g++)k.append(q(h*(1-l[g]))),k.append(m(h*(1-l[g]),l[g]));var z=0,y=0;setInterval(function(){p.layer(y,0);0<z&&(z-=.005);p.layer(z,1);y>z&&(z=y)},1E3/15);c.set=function(a){y=
a};return c};this.sevenSegmentDisplay__static=function(c,f,a,b,d,g,l,k,q,r){function h(){C._.fillStyle=k;C._.fillRect(0,0,C.$(b),C.$(d))}function m(){for(var a=0;a<w.length;a++){C._.beginPath();C._.moveTo(C.$(w[a][0].x),C.$(w[a][0].y));for(var b=1;b<w[a].length;b++)C._.lineTo(C.$(w[a][b].x),C.$(w[a][b].y));C._.closePath();C._.fillStyle=0==B[a]?r:q;C._.fill()}}b=void 0===b?20:b;d=void 0===d?30:d;l=void 0===l?5:l;k=void 0===k?"rgb(0,0,0)":k;q=void 0===q?"rgb(200,200,200)":q;r=void 0===r?"rgb(20,20,20)":
r;var t=b/8,p=b/8,z=[{x:1*p+t,y:1*p+t},{x:.5*p+t,y:.5*p+t},{x:1*p+t,y:0*p+t},{x:0*p+t,y:1*p+t}],y=[{x:b-1*p-t,y:0*p+t},{x:b-.5*p-t,y:.5*p+t},{x:b-1*p-t,y:1*p+t},{x:b-0*p-t,y:1*p+t}],A=[{x:1*p+t,y:.5*d-1*p+.5*t},{x:.5*p+t,y:.5*d-.5*p+.5*t},{x:1*p+t,y:.5*d-0*p+.5*t},{x:0*p+t,y:.5*d-1*p+.5*t},{x:0*p+t,y:.5*d-0*p+.5*t}],x=[{x:b-1*p-t,y:.5*d-0*p+.5*t},{x:b-.5*p-t,y:.5*d-.5*p+.5*t},{x:b-1*p-t,y:.5*d-1*p+.5*t},{x:b-0*p-t,y:.5*d-1*p+.5*t},{x:b-0*p-t,y:.5*d-0*p+.5*t}],u=[{x:1*p+t,y:d-1*p-t},{x:.5*p+t,y:d-
.5*p-t},{x:1*p+t,y:d-0*p-t},{x:0*p+t,y:d-1*p-t}];t=[{x:b-1*p-t,y:d-0*p-t},{x:b-.5*p-t,y:d-.5*p-t},{x:b-1*p-t,y:d-1*p-t},{x:b-0*p-t,y:d-1*p-t}];var w=[[z[0],y[2],y[1],y[0],z[2],z[1]],[z[1],z[3],A[3],A[1],A[0],z[0]],[y[1],y[3],x[3],x[1],x[2],y[2]],[A[0],x[2],x[1],x[0],A[2],A[1]],[A[1],A[4],u[3],u[1],u[0],A[2]],[x[1],x[4],t[3],t[1],t[2],x[0]],[u[0],t[2],t[1],t[0],u[2],u[1]]],B=[0,0,0,0,0,0,0];c=e.builder("group",void 0===c?"sevenSegmentDisplay__static":c,{x:f,y:a,angle:void 0===g?0:g});var C=e.builder("canvas",
"subcanvas",{width:b,height:d,resolution:l});c.append(C);c.set=function(a,b){B[a].state=b;m()};c.get=function(a){return B[a].state};c.clear=function(){for(var a=0;a<B.length;a++)this.set(a,!1)};c.enterCharacter=function(a){switch(a){case 0:case "0":B=[1,1,1,0,1,1,1];break;case 1:case "1":B=[0,0,1,0,0,1,0];break;case 2:case "2":B=[1,0,1,1,1,0,1];break;case 3:case "3":B=[1,0,1,1,0,1,1];break;case 4:case "4":B=[0,1,1,1,0,1,0];break;case 5:case "5":B=[1,1,0,1,0,1,1];break;case 6:case "6":B=[1,1,0,1,1,
1,1];break;case 7:case "7":B=[1,0,1,0,0,1,0];break;case 8:case "8":B=[1,1,1,1,1,1,1];break;case 9:case "9":B=[1,1,1,1,0,1,1];break;default:B=[0,0,0,0,0,0,0]}h();m()};h();m();return c};this.grapher_periodicWave=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p){c=void 0===c?"grapher_periodicWave":c;b=void 0===b?120:b;d=void 0===d?60:d;l=void 0===l?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:l;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;q=void 0===q?"rgba(0,100,0,1)":q;r=void 0===
r?.25:r;n=void 0===n?"rgba(0,150,0,1)":n;m=void 0===m?.1:m;t=void 0===t?"Helvetica":t;p=void 0===p?"rgba(50,50,50,1)":p;var h={sin:[],cos:[]},v=100;f=e.builder("group",c,{x:f,y:a,angle:void 0===g?0:g});var A=e.builder("grapher",c,{x:0,y:0,width:b,height:d,foregroundStyles:[l],foregroundTextStyles:[k],backgroundStyle_stroke:q,backgroundStyle_lineWidth:r,backgroundTextStyle_fill:n,backgroundTextStyle_size:m,backgroundTextStyle_font:t,backingStyle:p});f.append(A);f.wave=function(a,b){a=void 0===a?null:
a;b=void 0===b?null:b;if(null==a){for(;h.sin.length<h.cos.length;)h.sin.push(0);for(;h.sin.length>h.cos.length;)h.cos.push(0);for(a=0;a<h.sin.length;a++)h.sin[a]||(h.sin[a]=0),h.cos[a]||(h.cos[a]=0);return h}null==b&&(h=a);switch(b){case "sin":h.sin=a;break;case "cos":h.cos=a}};f.waveElement=function(a,b,d){if(null==d)return h[a][b];h[a][b]=d};f.resolution=function(a){a=void 0===a?null:a;if(null==a)return v;v=a};f.updateBackground=function(){A.viewbox({bottom:-1.1,top:1.1,left:0});A.horizontalMarkings({points:[1,
.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});A.verticalMarkings({points:[0,.25,.5,.75],printText:!0});A.drawBackground()};f.draw=function(){for(var a=[],b,d=0;d<=v;d++){for(var c=b=0;c<h.sin.length;c++)h.sin[c]||(h.sin[c]=0),b+=Math.sin(d/v*c*Math.PI*2)*h.sin[c];for(c=0;c<h.cos.length;c++)h.cos[c]||(h.cos[c]=0),b+=Math.cos(d/v*c*Math.PI*2)*h.cos[c];a.push(b)}A.draw(a)};f.reset=function(){this.wave({sin:[],cos:[]});this.resolution(100);this.updateBackground()};return f};this.sixteenSegmentDisplay__static=
function(c,f,a,b,d,h,l,k,g,r){function q(){D._.fillStyle=k;D._.fillRect(0,0,D.$(b),D.$(d))}function m(){for(var a=0;a<H.length;a++){D._.beginPath();D._.moveTo(D.$(H[a][0].x),D.$(H[a][0].y));for(var b=1;b<H[a].length;b++)D._.lineTo(D.$(H[a][b].x),D.$(H[a][b].y));D._.closePath();D._.fillStyle=0==stamp[a]?r:g;D._.fill()}}b=void 0===b?20:b;d=void 0===d?30:d;l=void 0===l?5:l;k=void 0===k?"rgb(0,0,0)":k;g=void 0===g?"rgb(200,200,200)":g;r=void 0===r?"rgb(20,20,20)":r;var t=b/8,p=b/8,z=[{x:.5*p+t,y:.5*p+
t},{x:1*p+t,y:0*p+t},{x:0*p+t,y:1*p+t},{x:1*p+t,y:1*p+t},{x:1.75*p+t,y:1*p+t},{x:1*p+t,y:1.75*p+t}],y=[{x:b/2,y:.5*p+t},{x:b/2-.5*p,y:1*p+t},{x:b/2+.5*p,y:1*p+t},{x:b/2-.5*p,y:0*p+t},{x:b/2+.5*p,y:0*p+t}],A=[{x:b-.5*p-t,y:.5*p+t},{x:b-1*p-t,y:0*p+t},{x:b-0*p-t,y:1*p+t},{x:b-1*p-t,y:1*p+t},{x:b-1*p-t,y:1.75*p+t},{x:b-1.75*p-t,y:1*p+t}],x=[{x:0*p+t,y:.5*d-.5*p},{x:1*p+t,y:.5*d-.5*p},{x:.5*p+t,y:.5*d-0*p},{x:0*p+t,y:.5*d+.5*p},{x:1*p+t,y:.5*d+.5*p}],u=[{x:b/2,y:d/2},{x:b/2-.5*p,y:.5*p+d/2},{x:b/2-.25*
p,y:1.25*p+d/2},{x:b/2-1*p,y:.5*p+d/2},{x:b/2+.5*p,y:.5*p+d/2},{x:b/2+.5*p,y:1.75*p+d/2},{x:b/2+1*p,y:.5*p+d/2},{x:b/2-.5*p,y:.5*-p+d/2},{x:b/2-.25*p,y:1.25*-p+d/2},{x:b/2-1*p,y:.25*-p+d/2},{x:b/2+.5*p,y:.5*-p+d/2},{x:b/2+.5*p,y:1.75*-p+d/2},{x:b/2+1*p,y:.25*-p+d/2}],w=[{x:b-1*p-t,y:.5*d-.5*p},{x:b-0*p-t,y:.5*d-.5*p},{x:b-.5*p-t,y:.5*d-0*p},{x:b-1*p-t,y:.5*d+.5*p},{x:b-0*p-t,y:.5*d+.5*p}],B=[{x:.5*p+t,y:d-.5*p-t},{x:0*p+t,y:d-1*p-t},{x:1*p+t,y:d-0*p-t},{x:1*p+t,y:d-1*p-t},{x:1*p+t,y:d-1.75*p-t},{x:1.75*
p+t,y:d-1*p-t}],C=[{x:b/2-.5*p,y:d-1*p-t},{x:b/2+.5*p,y:d-1*p-t},{x:b/2,y:d-.5*p-t},{x:b/2-.5*p,y:d-0*p-t},{x:b/2+.5*p,y:d-0*p-t}];t=[{x:b-.5*p-t,y:d-.5*p-t},{x:b-0*p-t,y:d-1*p-t},{x:b-1*p-t,y:d-0*p-t},{x:b-1*p-t,y:d-1*p-t},{x:b-1*p-t,y:d-1.75*p-t},{x:b-1.75*p-t,y:d-1*p-t}];var H=[[z[1],z[0],z[3],y[1],y[0],y[3]],[y[4],y[0],y[2],A[3],A[0],A[1]],[z[0],z[2],x[0],x[2],x[1],z[3]],[z[4],z[3],z[5],u[9],u[7],u[8]],[y[0],y[1],u[7],u[0],u[10],y[2]],[A[4],A[3],A[5],u[11],u[10],u[12]],[A[0],A[2],w[1],w[2],w[0],
A[3]],[x[4],x[2],x[1],u[7],u[0],u[1]],[w[3],w[2],w[0],u[10],u[0],u[4]],[B[0],B[1],x[3],x[2],x[4],B[3]],[B[4],B[3],B[5],u[2],u[1],u[3]],[C[0],C[2],C[1],u[4],u[0],u[1]],[t[4],t[3],t[5],u[5],u[4],u[6]],[t[3],w[3],w[2],w[4],t[1],t[0]],[B[2],B[0],B[3],C[0],C[2],C[3]],[t[2],t[0],t[3],C[1],C[2],C[4]]];stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];c=e.builder("group",void 0===c?"sixteenSegmentDisplay__static":c,{x:f,y:a,angle:void 0===h?0:h});var D=e.builder("canvas","subcanvas",{width:b,height:d,resolution:l});
c.append(D);c.set=function(a,b){stamp[a].state=b;m()};c.get=function(a){return segments[a].state};c.clear=function(){for(var a=0;a<segments.length;a++)this.set(a,!1)};c.enterCharacter=function(a){switch(a){case "!":stamp=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":stamp=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":stamp=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":stamp=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":stamp=[0,0,
0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':stamp=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":stamp=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":stamp=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":stamp=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":stamp=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":stamp=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":stamp=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":stamp=[0,0,0,1,0,
0,0,0,0,0,1,0,0,0,0,0];break;case "(":stamp=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":stamp=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":stamp=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":stamp=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":stamp=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":stamp=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":case 0:stamp=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":case 1:stamp=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":case 2:stamp=
[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":case 3:stamp=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":case 4:stamp=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":case 5:stamp=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":case 6:stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":case 7:stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":case 8:stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":case 9:stamp=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":stamp=[1,
1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":stamp=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":stamp=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":stamp=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":stamp=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":stamp=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":stamp=
[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":stamp=[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":stamp=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":stamp=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":stamp=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":stamp=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":stamp=
[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":stamp=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":stamp=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":stamp=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":stamp=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":stamp=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":stamp=
[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":stamp=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}q();m()};q();m();return c};this.readout_sixteenSegmentDisplay__static=function(c,f,a,b,d,h,l,k,g,r,n){b=void 0===b?100:b;d=void 0===d?30:d;h=void 0===h?5:h;k=void 0===k?5:k;g=void 0===g?"rgb(0,0,0)":g;r=void 0===r?"rgb(200,200,200)":r;n=void 0===n?"rgb(20,20,20)":n;var q="",m=null;c=e.builder("group",
void 0===c?"readout_sixteenSegmentDisplay__static":c,{x:f,y:a,angle:void 0===l?0:l});var p=[];for(f=0;f<h;f++)a=e.builder("sixteenSegmentDisplay__static",""+f,{x:b/h*f,width:b/h,height:d,resolution:k,style:{background:g,glow:r,dim:n}}),c.append(a),p.push(a);c.text=function(a){if(null==a)return q;q=a};c.print=function(a){clearInterval(m);switch(a){case "smart":q.length>p.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;m=setInterval(function(){for(var a=p.length-1;0<=
a;a--)p[a].enterCharacter(q[b-(p.length-1-a)]);b++;b>p.length+q.length-1&&(b=0)},150);break;default:for(a=0;a<p.length;a++)p[a].enterCharacter(q[a])}};return c};this.readout_sixteenSegmentDisplay=function(c,f,a,b,d,h,g,k,q,r){b=void 0===b?100:b;d=void 0===d?30:d;h=void 0===h?5:h;k=void 0===k?"rgb(0,0,0)":k;q=void 0===q?"rgb(200,200,200)":q;r=void 0===r?"rgb(20,20,20)":r;var l="",m=null;c=e.builder("group",void 0===c?"readout_sixteenSegmentDisplay":c,{x:f,y:a,angle:void 0===g?0:g});var t=[];for(f=
0;f<h;f++)a=e.builder("sixteenSegmentDisplay",""+f,{x:b/h*f,width:b/h,height:d,style:{background:k,glow:q,dim:r}}),c.append(a),t.push(a);c.text=function(a){if(null==a)return l;l=a};c.print=function(a){clearInterval(m);switch(a){case "smart":l.length>t.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;m=setInterval(function(){for(var a=t.length-1;0<=a;a--)t[a].enterCharacter(l[b-(t.length-1-a)]);b++;b>t.length+l.length-1&&(b=0)},150);break;default:for(a=0;a<t.length;a++)t[a].enterCharacter(l[a])}};
return c};this.grapher_audioScope__static=function(c,f,a,b,d,h,l,k,q,r,n,m,t,p){c=void 0===c?"grapher_audioScope__static":c;b=void 0===b?120:b;d=void 0===d?60:d;h=void 0===h?0:h;l=void 0===l?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:l;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;q=void 0===q?"rgba(0,100,0,1)":q;r=void 0===r?.25:r;n=void 0===n?"rgba(0,150,0,1)":n;m=void 0===m?.1:m;t=void 0===t?"Helvetica":t;p=void 0===p?"rgba(50,50,50,1)":p;var v=g.library.audio.context.createAnalyser(),
y=null,A=10,x=null,u=256;v.fftSize=u;y=new Uint8Array(v.fftSize);new Uint8Array(v.fftSize);f=e.builder("group",c,{x:f,y:a,angle:h});var w=e.builder("grapher__static",c,{x:0,y:0,width:b,height:d,foregroundStyles:[l],foregroundTextStyles:[k],backgroundStyle_stroke:q,backgroundStyle_lineWidth:r,backgroundTextStyle_fill:n,backgroundTextStyle_size:m,backgroundTextStyle_font:t,backingStyle:p});f.append(w);f.start=function(){null==x&&(x=setInterval(function(){var a=[];v.getByteTimeDomainData(y);for(var b=
0;b<y.length;b++)a.push(y[b]/128-1);w.draw(a)},1E3/A))};f.stop=function(){clearInterval(x);x=null};f.getNode=function(){return v};f.resolution=function(a){a=void 0===a?null:a;if(null==a)return u;u=a;this.stop();this.start()};f.refreshRate=function(a){if(null==a)return A;A=a;this.stop();this.start()};w.viewbox({l:-1.1,h:1.1});w.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});w.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});w.drawBackground();return f};
this.level=function(c,f,a,b,d,g,l,k){d=void 0===d?20:d;g=void 0===g?60:g;l=void 0===l?"rgb(10,10,10)":l;k=void 0===k?["rgb(250,250,250)","rgb(200,200,200)"]:k;var h=[];c=e.builder("group",void 0===c?"level":c,{x:f,y:a,angle:void 0===b?0:b});l=e.builder("rectangle","backing",{width:d,height:g,style:{fill:l}});c.append(l);l=e.builder("group","levels");c.append(l);var r=[];for(f=0;f<k.length;f++)h.push(0),r.push(e.builder("rectangle","movingRect_"+f,{y:g,width:d,height:0,style:{fill:k[f]}})),l.prepend(r[f]);
c.layer=function(a,b){b=void 0===b?0:b;if(void 0==b)return h;if(null==a)return h[b];a=1<a?1:a;a=0>a?0:a;h[b]=a;r[b].parameter.height(g*a);r[b].parameter.y(g-g*a)};return c}};this.dynamic=new function(){this.connectionNode_voltage=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z){t=void 0===t?function(a){}:t;p=void 0===p?function(a){}:p;z=void 0===z?function(a){}:z;var h=e.builder("connectionNode",void 0===c?"connectionNode_voltage":c,{x:f,y:a,angle:void 0===b?0:b,width:void 0===d?20:d,height:void 0===g?20:
g,allowConnections:void 0===l?!0:l,allowDisconnections:void 0===k?!0:k,type:"voltage",style:{dim:void 0===q?"rgb(222, 255, 220)":q,glow:void 0===r?"rgb(240, 252, 239)":r,cable_dim:void 0===n?"rgb(84, 247, 111)":n,cable_glow:void 0===m?"rgb(159, 252, 174)":m}}),v=0;h._getLocalValue=function(){return v};h._update=function(a){0<a?h.activate():h.deactivate();t(a)};h.set=function(a){v=a;a=h.read();h._update(a);void 0!=h.getForeignNode()&&h.getForeignNode()._update(a)};h.read=function(){return v+(void 0!=
h.getForeignNode()?h.getForeignNode()._getLocalValue():!1)};h.onconnect=function(a){p&&p(a);h._update(h.read())};h.ondisconnect=function(a){z&&z(a);h._update(v)};return h};this.cable=function(c,f,a,b,d,g,l){f=void 0===f?0:f;a=void 0===a?0:a;b=void 0===b?0:b;d=void 0===d?0:d;g=void 0===g?"rgb(255,0,0)":g;l=void 0===l?"rgb(255,100,100)":l;c=e.builder("group",void 0===c?"path":c);var k=e.builder("path","cable",{points:[{x:f,y:a},{x:b,y:d}],style:{stroke:g,lineWidth:5}});c.append(k);c.activate=function(){k.style.stroke=
l};c.deactivate=function(){k.style.stroke=g};c.draw=function(c,e,g,h){f=void 0!=c?c:f;a=void 0!=e?e:a;b=void 0!=g?g:b;d=void 0!=h?h:d;k.parameter.points([{x:f,y:a},{x:b,y:d}])};c._isCable=!0;return c};this.connectionNode_audio=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y){q=void 0===q?!1:q;z=void 0===z?function(){}:z;y=void 0===y?function(){}:y;var h=e.builder("connectionNode",void 0===c?"connectionNode_audio":c,{x:f,y:a,angle:void 0===b?0:b,width:void 0===d?20:d,height:void 0===g?20:g,allowConnections:void 0===
l?!0:l,allowDisconnections:void 0===k?!0:k,type:"audio",direction:q?"out":"in",style:{dim:void 0===n?"rgba(255, 244, 220, 1)":n,glow:void 0===m?"rgba(255, 244, 244, 1)":m,cable_dim:void 0===t?"rgb(247, 146, 84)":t,cable_glow:void 0===p?"rgb(242, 168, 123)":p}});h._direction=q?"out":"in";h.audioNode=r.createAnalyser();h.out=function(){return h.audioNode};h.in=function(){return h.audioNode};h.onconnect=function(a){"out"==h._direction&&h.audioNode.connect(h.getForeignNode().audioNode);z&&z(a)};h.ondisconnect=
function(a){"out"==h._direction&&h.audioNode.disconnect(h.getForeignNode().audioNode);y&&y(a)};return h};this.connectionNode_data=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,z,y){function h(a){a.activate();setTimeout(function(){void 0!=a&&a.deactivate()},100);void 0!=a.getForeignNode()&&(a.getForeignNode().activate(),setTimeout(function(){void 0!=a&&void 0!=a.getForeignNode()&&a.getForeignNode().deactivate()},100))}t=void 0===t?function(a,b){}:t;p=void 0===p?function(a){}:p;var v=e.builder("connectionNode",
void 0===c?"connectionNode_data":c,{x:f,y:a,angle:void 0===b?0:b,width:void 0===d?20:d,height:void 0===g?20:g,allowConnections:void 0===l?!0:l,allowDisconnections:void 0===k?!0:k,type:"data",style:{dim:void 0===q?"rgba(220, 244, 255,1)":q,glow:void 0===r?"rgba(244, 244, 255, 1)":r,cable_dim:void 0===n?"rgb(84, 146, 247)":n,cable_glow:void 0===m?"rgb(123, 168, 242)":m},onconnect:void 0===z?function(){}:z,ondisconnect:void 0===y?function(){}:y});v.send=function(a,b){h(v);if(void 0!=v.getForeignNode())v.getForeignNode().onreceivedata(a,
b)};v.request=function(a){h(v);if(void 0!=v.getForeignNode())v.getForeignNode().ongivedata(a)};v.onreceivedata=t;v.ongivedata=p;return v};this.connectionNode=function(c,f,a,b,d,h,l,k,q,r,m,v,t,p,z,y){d=void 0===d?20:d;h=void 0===h?20:h;l=void 0===l?"none":l;k=void 0===k?"":k;q=void 0===q?!0:q;r=void 0===r?!0:r;m=void 0===m?"rgb(220, 220, 220)":m;v=void 0===v?"rgb(244, 244, 244)":v;t=void 0===t?"rgb(146, 146, 146)":t;p=void 0===p?"rgb(215, 215, 215)":p;z=void 0===z?function(a){}:z;y=void 0===y?function(a){}:
y;var n=e.builder("group",void 0===c?"connectionNode2":c,{x:f,y:a,angle:void 0===b?0:b});n._connectionNode=!0;n._type=l;n._direction=k;var x=e.builder("rectangle","node",{width:d,height:h,style:{fill:m}});n.append(x);var u=void 0;n.isConnected=function(){return void 0!=w};n.canDisconnect=function(){return this.allowDisconnections()&&void 0!=u&&u.allowDisconnections()};n.allowConnections=function(a){if(void 0==a)return q;q=a};n.allowDisconnections=function(a){if(void 0==a)return r;r=a};n.connectTo=
function(a){if(void 0!=a&&a!=this&&a._type==this._type&&(""!=this._direction&&""!=a._direction||this._direction==a._direction)&&(""==this._direction||a._direction!=this._direction)&&a!=u){this.disconnect();u=a;if(void 0!=z)this.onconnect(!0);u._receiveConnection(this);this._addCable(this)}};n._receiveConnection=function(a){this.disconnect();u=a;if(void 0!=z)this.onconnect(!1)};n.disconnect=function(){if(void 0!=u){this._removeCable();if(void 0!=y)this.ondisconnect(!0);u._receiveDisconnection();u=
null}};n._receiveDisconnection=function(){if(void 0!=y)this.ondisconnect(!1);u=null};n.getForeignNode=function(){return u};x.onmousedown=function(a,b,d){g.system.mouse.mouseInteractionHandler(void 0,function(a){a=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=g.core.arrangement.getElementUnderPoint(a.x,a.y);void 0!=a&&(a=a.parent,!a._connectionNode||a.isConnected()&&!a.canDisconnect()||n.isConnected()&&!n.canDisconnect()||q&&a.allowConnections()&&n.connectTo(a))})};x.ondblclick=function(a,
b,d){r&&u.allowDisconnections()&&n.disconnect()};var w;n._addCable=function(){w=e.builder("cable","cable-"+this.getAddress(),{x1:0,y1:0,x2:100,y2:100,style:{dim:t,glow:p}});u._receiveCable(w);g.system.pane.getMiddlegroundPane(this).append(w);this.draw()};n._receiveCable=function(a){w=a};n._removeCable=function(){w.parent.remove(w);w=void 0;u._loseCable()};n._loseCable=function(){w=void 0};n.getCablePoint=function(){var b=this.getOffset(),c=g.library.math.cartesianAngleAdjust(f+d/2,a+h/2,b.a);c.x+=
b.x;c.y+=b.y;return c};n.draw=function(){if(void 0!=w){var a=this.getCablePoint(),b=u.getCablePoint();w.draw(a.x,a.y,b.x,b.y)}};n.activate=function(){x.style.fill=v;void 0!=w&&w.activate()};n.deactivate=function(){x.style.fill=m;void 0!=w&&w.deactivate()};n.onconnect=z;n.ondisconnect=y;return n};this.connectionNode_signal=function(c,f,a,b,d,g,l,k,q,r,n,m,t,p,w){t=void 0===t?function(a){}:t;p=void 0===p?function(a){}:p;w=void 0===w?function(a){}:w;var h=e.builder("connectionNode",void 0===c?"connectionNode_signal":
c,{x:f,y:a,angle:void 0===b?0:b,width:void 0===d?20:d,height:void 0===g?20:g,allowConnections:void 0===l?!0:l,allowDisconnections:void 0===k?!0:k,type:"signal",style:{dim:void 0===q?"rgb(255, 220, 244)":q,glow:void 0===r?"rgb(255, 244, 244)":r,cable_dim:void 0===n?"rgb(247, 84, 146)":n,cable_glow:void 0===m?"rgb(247, 195, 215)":m}}),v=!1;h._getLocalValue=function(){return v};h._update=function(){var a=h.read();a?h.activate():h.deactivate();t(a)};h.set=function(a){v=a;h._update();void 0!=h.getForeignNode()&&
h.getForeignNode()._update()};h.read=function(){return v||(void 0!=h.getForeignNode()?h.getForeignNode()._getLocalValue():!1)};h.onconnect=function(a){p&&p(a);h._update()};h.ondisconnect=function(a){w&&w(a);h._update()};return h}}};this.builder=function(c,e,a){a||(a={});void 0==a.style&&(a.style={});switch(c){default:return console.warn("Unknown element: "+c),null;case "group":return this.collection.basic.group(e,a.x,a.y,a.angle,a.ignored);case "rectangle":return this.collection.basic.rectangle(e,
a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);case "image":return this.collection.basic.image(e,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.url);case "canvas":return this.collection.basic.canvas(e,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.resolution);case "polygon":return this.collection.basic.polygon(e,a.points,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);
case "text":return this.collection.basic.text(e,a.x,a.y,a.text,a.angle,a.anchor,a.size,a.ignored,a.style.font,a.style.textAlign,a.style.textBaseline,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);case "circle":return this.collection.basic.circle(e,a.x,a.y,a.r,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);case "path":return this.collection.basic.path(e,a.points,a.ignored,a.style.stroke,a.style.lineWidth,a.style.lineCap,
a.style.lineJoin,a.style.miterLimit);case "glowbox_rect":return this.collection.display.glowbox_rect(e,a.x,a.y,a.width,a.height,a.angle,a.style.glow,a.style.dim);case "sevenSegmentDisplay":return this.collection.display.sevenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,a.style.dim);case "sevenSegmentDisplay__static":return this.collection.display.sevenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);
case "sixteenSegmentDisplay":return this.collection.display.sixteenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,a.style.dim);case "sixteenSegmentDisplay__static":return this.collection.display.sixteenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "readout_sixteenSegmentDisplay":return this.collection.display.readout_sixteenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.count,a.angle,a.style.background,
a.style.glow,a.style.dim);case "readout_sixteenSegmentDisplay__static":return this.collection.display.readout_sixteenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.count,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "level":return this.collection.display.level(e,a.x,a.y,a.angle,a.width,a.height,a.style.backing,a.style.levels);case "meter_level":return this.collection.display.meter_level(e,a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,
a.style.markingStyle_font);case "audio_meter_level":return this.collection.display.audio_meter_level(e,a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,a.style.markingStyle_font);case "rastorDisplay":return this.collection.display.rastorDisplay(e,a.x,a.y,a.angle,a.width,a.height,a.xCount,a.yCount,a.xGappage,a.yGappage);case "grapher":return this.collection.display.grapher(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,
a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher__static":return this.collection.display.grapher__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave":return this.collection.display.grapher_periodicWave(e,a.x,
a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave__static":return this.collection.display.grapher_periodicWave__static(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,
a.style.backgroundText_font,a.style.backing);case "grapher_audioScope":return this.collection.display.grapher_audioScope(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_audioScope__static":return this.collection.display.grapher_audioScope__static(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,
a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "button_":return this.collection.control.button_(e,a.x,a.y,a.angle,a.interactable,a.active,a.hoverable,a.selectable,a.pressable,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect,a.subject);case "button_image":return this.collection.control.button_image(e,a.x,a.y,a.width,a.height,a.angle,
a.interactable,a.active,a.hoverable,a.selectable,a.pressable,a.backingURL__off,a.backingURL__up,a.backingURL__press,a.backingURL__select,a.backingURL__select_press,a.backingURL__glow,a.backingURL__glow_press,a.backingURL__glow_select,a.backingURL__glow_select_press,a.backingURL__hover,a.backingURL__hover_press,a.backingURL__hover_select,a.backingURL__hover_select_press,a.backingURL__hover_glow,a.backingURL__hover_glow_press,a.backingURL__hover_glow_select,a.backingURL__hover_glow_select_press,a.onenter,
a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "button_circle":return this.collection.control.button_circle(e,a.x,a.y,a.r,a.angle,a.interactable,a.text_centre,a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,
a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,a.style.background__select__fill,a.style.background__select__stroke,a.style.background__select__strokeWidth,a.style.background__select_press__fill,a.style.background__select_press__stroke,a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,a.style.background__glow_press__fill,a.style.background__glow_press__stroke,
a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,a.style.background__glow_select__strokeWidth,a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,a.style.background__glow_select_press__strokeWidth,a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,
a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,a.style.background__hover_select_press__fill,a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,a.style.background__hover_glow__fill,a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,
a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,a.style.background__hover_glow_select_press__fill,a.style.background__hover_glow_select_press__stroke,a.style.background__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "button_polygon":return this.collection.control.button_polygon(e,a.x,a.y,a.points,a.angle,a.interactable,a.text_centre,
a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,a.style.background__select__fill,a.style.background__select__stroke,
a.style.background__select__strokeWidth,a.style.background__select_press__fill,a.style.background__select_press__stroke,a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,a.style.background__glow_press__fill,a.style.background__glow_press__stroke,a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,a.style.background__glow_select__strokeWidth,
a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,a.style.background__glow_select_press__strokeWidth,a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,a.style.background__hover_select_press__fill,
a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,a.style.background__hover_glow__fill,a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,a.style.background__hover_glow_select_press__fill,
a.style.background__hover_glow_select_press__stroke,a.style.background__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "button_rectangle":return this.collection.control.button_rectangle(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.text_centre,a.text_left,a.text_right,a.textVerticalOffsetMux,a.textHorizontalOffsetMux,a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,
a.style.text_stroke,a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,a.style.background__select__fill,a.style.background__select__stroke,a.style.background__select__strokeWidth,a.style.background__select_press__fill,a.style.background__select_press__stroke,
a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,a.style.background__glow_press__fill,a.style.background__glow_press__stroke,a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,a.style.background__glow_select__strokeWidth,a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,a.style.background__glow_select_press__strokeWidth,
a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,a.style.background__hover_select_press__fill,a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,a.style.background__hover_glow__fill,
a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,a.style.background__hover_glow_select_press__fill,a.style.background__hover_glow_select_press__stroke,a.style.background__hover_glow_select_press__strokeWidth,
a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "dial_continuous":return this.collection.control.dial_continuous(e,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.startAngle,a.maxAngle,a.style.handle,a.style.slot,a.style.needle,a.onchange,a.onrelease);case "dial_discrete":return this.collection.control.dial_discrete(e,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.optionCount,a.startAngle,a.maxAngle,a.style.handle,a.style.slot,a.style.needle,
a.onchange,a.onrelease);case "dial_continuous_image":return this.collection.control.dial_continuous_image(e,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.startAngle,a.maxAngle,a.handleURL,a.slotURL,a.needleURL,a.onchange,a.onrelease);case "dial_discrete_image":return this.collection.control.dial_discrete_image(e,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.optionCount,a.startAngle,a.maxAngle,a.handleURL,a.slotURL,a.needleURL,a.onchange,a.onrelease);case "slide":return this.collection.control.slide(e,
a.x,a.y,a.width,a.height,a.angle,a.interactable,a.handleHeight,a.value,a.resetValue,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "slide_image":return this.collection.control.slide_image(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.handleHeight,a.value,a.resetValue,a.handleURL,a.backingURL,a.slotURL,a.style.invisibleHandle,a.onchange,a.onrelease);case "slidePanel":return this.collection.control.slidePanel(e,a.x,a.y,a.width,a.height,a.angle,
a.interactable,a.handleHeight,a.count,a.value,a.resetValue,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "slidePanel_image":return this.collection.control.slidePanel(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.handleHeight,a.count,a.value,a.resetValue,a.handleURL,a.backingURL,a.slotURL,a.overlayURL,a.style.invisibleHandle,a.onchange,a.onrelease);case "rangeslide":return this.collection.control.rangeslide(e,a.x,a.y,a.width,a.height,a.angle,
a.interactable,a.handleHeight,a.spanWidth,a.values,a.resetValues,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.style.span,a.onchange,a.onrelease);case "rangeslide_image":return this.collection.control.rangeslide_image(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.handleHeight,a.spanWidth,a.values,a.resetValues,a.handleURL,a.backingURL,a.slotURL,a.style.invisibleHandle,a.spanURL,a.onchange,a.onrelease);case "list":return this.collection.control.list(e,a.x,a.y,a.width,
a.height,a.angle,a.interactable,a.list,a.itemTextVerticalOffsetMux,a.itemTextHorizontalOffsetMux,a.active,a.multiSelect,a.hoverable,a.selectable,a.pressable,a.itemHeightMux,a.itemWidthMux,a.itemSpacingMux,a.breakHeightMux,a.breakWidthMux,a.spacingHeightMux,a.style.backing,a.style.break,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.item__off__fill,a.style.item__off__stroke,a.style.item__off__strokeWidth,a.style.item__up__fill,a.style.item__up__stroke,
a.style.item__up__strokeWidth,a.style.item__press__fill,a.style.item__press__stroke,a.style.item__press__strokeWidth,a.style.item__select__fill,a.style.item__select__stroke,a.style.item__select__strokeWidth,a.style.item__select_press__fill,a.style.item__select_press__stroke,a.style.item__select_press__strokeWidth,a.style.item__glow__fill,a.style.item__glow__stroke,a.style.item__glow__strokeWidth,a.style.item__glow_press__fill,a.style.item__glow_press__stroke,a.style.item__glow_press__strokeWidth,
a.style.item__glow_select__fill,a.style.item__glow_select__stroke,a.style.item__glow_select__strokeWidth,a.style.item__glow_select_press__fill,a.style.item__glow_select_press__stroke,a.style.item__glow_select_press__strokeWidth,a.style.item__hover__fill,a.style.item__hover__stroke,a.style.item__hover__strokeWidth,a.style.item__hover_press__fill,a.style.item__hover_press__stroke,a.style.item__hover_press__strokeWidth,a.style.item__hover_select__fill,a.style.item__hover_select__stroke,a.style.item__hover_select__strokeWidth,
a.style.item__hover_select_press__fill,a.style.item__hover_select_press__stroke,a.style.item__hover_select_press__strokeWidth,a.style.item__hover_glow__fill,a.style.item__hover_glow__stroke,a.style.item__hover_glow__strokeWidth,a.style.item__hover_glow_press__fill,a.style.item__hover_glow_press__stroke,a.style.item__hover_glow_press__strokeWidth,a.style.item__hover_glow_select__fill,a.style.item__hover_glow_select__stroke,a.style.item__hover_glow_select__strokeWidth,a.style.item__hover_glow_select_press__fill,
a.style.item__hover_glow_select_press__stroke,a.style.item__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselection,a.onpositionchange);case "list_image":return this.collection.control.list_image(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.list,a.itemTextVerticalOffsetMux,a.itemTextHorizontalOffsetMux,a.active,a.multiSelect,a.hoverable,a.selectable,a.pressable,a.itemHeightMux,a.itemWidthMux,a.itemSpacingMux,a.breakHeightMux,a.breakWidthMux,
a.spacingHeightMux,a.backingURL,a.breakURL,a.itemURL__off,a.itemURL__up,a.itemURL__press,a.itemURL__select,a.itemURL__select_press,a.itemURL__glow,a.itemURL__glow_press,a.itemURL__glow_select,a.itemURL__glow_select_press,a.itemURL__hover,a.itemURL__hover_press,a.itemURL__hover_select,a.itemURL__hover_select_press,a.itemURL__hover_glow,a.itemURL__hover_glow_press,a.itemURL__hover_glow_select,a.itemURL__hover_glow_select_press,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselection,a.onpositionchange);
case "checkbox_":return this.collection.control.checkbox_(e,a.x,a.y,a.angle,a.interactable,a.onchange,a.subject);case "checkbox_circle":return this.collection.control.checkbox_circle(e,a.x,a.y,a.r,a.angle,a.interactable,a.style.check,a.style.backing,a.style.checkGlow,a.style.backingGlow,a.onchange);case "checkbox_image":return this.collection.control.checkbox_image(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.uncheckURL,a.checkURL,a.onchange);case "checkbox_polygon":return this.collection.control.checkbox_polygon(e,
a.x,a.y,a.outterPoints,a.innerPoints,a.angle,a.interactable,a.style.check,a.style.backing,a.style.checkGlow,a.style.backingGlow,a.onchange);case "checkbox_rect":case "checkbox_rectangle":return this.collection.control.checkbox_rectangle(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.style.check,a.style.backing,a.style.checkGlow,a.style.backingGlow,a.onchange);case "rastorgrid":return this.collection.control.rastorgrid(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.xCount,a.yCount,a.style.backing,
a.style.check,a.style.backingGlow,a.style.checkGlow,a.onchange);case "needleOverlay":return this.collection.control.needleOverlay(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.needleWidth,a.selectNeedle,a.selectionArea,a.style.needles,a.onchange,a.onrelease,a.selectionAreaToggle);case "grapher_waveWorkspace":return this.collection.control.grapher_waveWorkspace(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.selectNeedle,a.selectionArea,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,
a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing,a.onchange,a.onrelease,a.selectionAreaToggle);case "sequencer":return this.collection.control.sequencer(e,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.xCount,a.yCount,a.zoomLevel_x,a.zoomLevel_y,a.backingStyle,a.selectionAreaStyle,a.blockStyle_body,a.blockStyle_bodyGlow,a.blockStyle_handle,a.blockStyle_handleWidth,a.horizontalStripStyle_pattern,a.horizontalStripStyle_glow,a.horizontalStripStyle_styles,
a.verticalStripStyle_pattern,a.verticalStripStyle_glow,a.verticalStripStyle_styles,a.playheadStyle,a.onpan,a.onchangeviewarea,a.event);case "cable":return this.collection.dynamic.cable(e,a.x1,a.y1,a.x2,a.y2,a.style.dim,a.style.glow);case "connectionNode":return this.collection.dynamic.connectionNode(e,a.x,a.y,a.angle,a.width,a.height,a.type,a.direction,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect);case "connectionNode_signal":return this.collection.dynamic.connectionNode_signal(e,
a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,a.ondisconnect);case "connectionNode_voltage":return this.collection.dynamic.connectionNode_voltage(e,a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,a.ondisconnect);case "connectionNode_data":return this.collection.dynamic.connectionNode_data(e,
a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onreceive,a.ongive,a.onconnect,a.ondisconnect);case "connectionNode_audio":return this.collection.dynamic.connectionNode_audio(e,a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.isAudioOutput,g.library.audio.context,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect)}}};this.unit=new function(){this.collection=
new function(){this.test=new function(){this.testUnit_1=function(e,c,f){e=m.unit.builder(this.testUnit_1,{name:"testUnit_1",collection:"test",x:e,y:c,a:f,space:[{x:-5,y:-5},{x:280,y:-5},{x:280,y:30},{x:605,y:30},{x:605,y:130},{x:705,y:130},{x:705,y:210},{x:240,y:210},{x:240,y:325},{x:430,y:325},{x:430,y:435},{x:-5,y:445}],elements:[{type:"rectangle",name:"testRectangle",data:{x:5,y:5,width:30,height:30,style:{fill:"rgba(255,0,0,1)"}}},{type:"circle",name:"testCircle",data:{x:20,y:55,r:15}},{type:"image",
name:"testImage",data:{x:40,y:40,width:30,height:30,url:"https://t2.genius.com/unsafe/300x300/https%3A%2F%2Fimages.genius.com%2F72ee0b753f056baa410c17a6ad9fea70.588x588x1.jpg"}},{type:"polygon",name:"testPolygon",data:{points:[{x:55,y:5},{x:70,y:35},{x:40,y:35}],style:{fill:"rgba(0,255,0,1)"}}},{type:"text",name:"testText",data:{x:7.5,y:95,text:"Hello",style:{font:"20pt Arial",fill:"rgba(150,150,255,1)"}}},{type:"path",name:"testPath",data:{points:[{x:0,y:0},{x:0,y:90},{x:2.5,y:90},{x:2.5,y:72.5},
{x:75,y:72.5}]}},{type:"glowbox_rect",name:"test_glowbox_rect",data:{x:90,y:0}},{type:"sevenSegmentDisplay",name:"test_sevenSegmentDisplay",data:{x:125,y:0}},{type:"sixteenSegmentDisplay",name:"test_sixteenSegmentDisplay",data:{x:150,y:0}},{type:"readout_sixteenSegmentDisplay",name:"test_readout_sixteenSegmentDisplay",data:{x:175,y:0}},{type:"level",name:"test_level1",data:{x:90,y:35}},{type:"meter_level",name:"test_meterLevel1",data:{x:115,y:35}},{type:"audio_meter_level",name:"test_audioMeterLevel1",
data:{x:140,y:35}},{type:"rastorDisplay",name:"test_rastorDisplay1",data:{x:165,y:35}},{type:"grapher",name:"test_grapher1",data:{x:230,y:35}},{type:"grapher_periodicWave",name:"test_grapher_periodicWave1",data:{x:355,y:35}},{type:"grapher_audioScope",name:"test_grapher_audioScope1",data:{x:480,y:35}},{type:"slide",name:"test_slide1",data:{x:0,y:110}},{type:"slidePanel",name:"test_slidePanel1",data:{x:15,y:110}},{type:"slide",name:"test_slide2",data:{x:0,y:220,angle:-Math.PI/2}},{type:"slidePanel",
name:"test_slidePanel2",data:{x:0,y:305,angle:-Math.PI/2}},{type:"rangeslide",name:"test_rangeslide1",data:{x:100,y:110}},{type:"rangeslide",name:"test_rangeslide2",data:{x:100,y:220,angle:-Math.PI/2}},{type:"dial_continuous",name:"test_dial_continuous1",data:{x:130,y:125}},{type:"dial_discrete",name:"test_dial_discrete1",data:{x:170,y:125}},{type:"button_rectangle",name:"test_button_rectangle1",data:{x:115,y:145}},{type:"list",name:"test_list1",data:{x:185,y:225,list:["space",{text_left:"item1",
text_centre:"",text_right:"",function:function(){console.log("item1 function")}},{text_left:"item2",text_centre:"",text_right:"",function:function(){console.log("item2 function")}},{text_left:"item3",text_centre:"",text_right:"",function:function(){console.log("item3 function")}},{text_left:"item4",text_centre:"",text_right:"",function:function(){console.log("item4 function")}},{text_left:"item5",text_centre:"",text_right:"",function:function(){console.log("item5 function")}},"break",{text_left:"item6",
text_centre:"",text_right:"",function:function(){console.log("item6 function")}},{text_left:"item7",text_centre:"",text_right:"",function:function(){console.log("item7 function")}},{text_left:"item8",text_centre:"",text_right:"",function:function(){console.log("item8 function")}},{text_left:"item9",text_centre:"",text_right:"",function:function(){console.log("item9 function")}},{text_left:"item10",text_centre:"",text_right:"",function:function(){console.log("item10 function")}},"break",{text_left:"item11",
text_centre:"",text_right:"",function:function(){console.log("item11 function")}},{text_left:"item12",text_centre:"",text_right:"",function:function(){console.log("item12 function")}},{text_left:"item13",text_centre:"",text_right:"",function:function(){console.log("item13 function")}},{text_left:"item14",text_centre:"",text_right:"",function:function(){console.log("item14 function")}},{text_left:"item15",text_centre:"",text_right:"",function:function(){console.log("item15 function")}},"space"]}},
{type:"checkbox_rect",name:"test_checkbox_rect1",data:{x:150,y:145}},{type:"rastorgrid",name:"test_rastorgrid1",data:{x:100,y:225}},{type:"needleOverlay",name:"test_needleOverlay1",data:{x:0,y:310}},{type:"grapher_waveWorkspace",name:"test_grapher_waveWorkspace1",data:{x:0,y:375}},{type:"sequencer",name:"test_sequencer1",data:{x:125,y:330}},{type:"connectionNode",name:"test_connectionNode1",data:{x:255,y:135}},{type:"connectionNode",name:"test_connectionNode2",data:{x:230,y:185}},{type:"connectionNode",
name:"test_connectionNode3",data:{x:280,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal1",data:{x:355,y:135}},{type:"connectionNode_signal",name:"test_connectionNode_signal2",data:{x:330,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal3",data:{x:380,y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage1",data:{x:455,y:135}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage2",data:{x:430,y:185}},{type:"connectionNode_voltage",
name:"test_connectionNode_voltage3",data:{x:480,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data1",data:{x:555,y:135}},{type:"connectionNode_data",name:"test_connectionNode_data2",data:{x:530,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data3",data:{x:580,y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio1",data:{x:655,y:135,isAudioOutput:!0}},{type:"connectionNode_audio",name:"test_connectionNode_audio2",data:{x:630,y:185}},{type:"connectionNode_audio",
name:"test_connectionNode_audio3",data:{x:680,y:185}}]});e.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.text("hello");e.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.print();e.elements.grapher.test_grapher1.draw([0,-2,1,-1,2],[0,.25,.5,.75,1]);e.elements.grapher.test_grapher1.draw([0,.25,1],void 0,1);e.elements.grapher_periodicWave.test_grapher_periodicWave1.updateBackground();e.elements.grapher_periodicWave.test_grapher_periodicWave1.wave({sin:[0,
1,0,1/3,0,.2,0,1/7,0,1/9,0,1/11,0,1/13,0,1/15],cos:[0,0]});e.elements.grapher_periodicWave.test_grapher_periodicWave1.draw();e.elements.needleOverlay.test_needleOverlay1.select(.25);e.elements.needleOverlay.test_needleOverlay1.area(.5,.75);e.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.select(.25);e.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.area(.5,.75);e.elements.sequencer.test_sequencer1.addSignal(0,0,10,0);e.elements.sequencer.test_sequencer1.addSignal(1,1,10,.1);
e.elements.sequencer.test_sequencer1.addSignal(2,2,10,.2);e.elements.sequencer.test_sequencer1.addSignal(3,3,10,.3);e.elements.sequencer.test_sequencer1.addSignal(4,4,10,.4);e.elements.sequencer.test_sequencer1.addSignal(5,5,10,.5);e.elements.sequencer.test_sequencer1.addSignal(6,6,10,.6);e.elements.sequencer.test_sequencer1.addSignal(7,7,10,.7);e.elements.sequencer.test_sequencer1.addSignal(8,8,10,.8);e.elements.sequencer.test_sequencer1.addSignal(9,9,10,.9);e.elements.sequencer.test_sequencer1.addSignal(10,
10,10,1);return e};this.testUnit_1.devUnit=!0;this.testUnit_1.metadata={name:"Test Unit 1",helpURL:"https://curve.metasophiea.com/help/units/test/testUnit_1/"};this.testUnit_2=function(e,c,f){return m.unit.builder(this.testUnit_2,{name:"testUnit_2",collection:"test",x:e,y:c,a:f,space:[{x:0,y:0},{x:100,y:0},{x:100,y:100},{x:0,y:100}],elements:[{type:"rectangle",name:"testRectangle1",data:{x:0,y:0,width:100,height:100,style:{fill:"rgba(200,200,200,1)"}}},{type:"rectangle",name:"testRectangle2",data:{x:10,
y:10,width:80,height:80,style:{fill:"rgba(200,100,200,1)"}}}]})};this.testUnit_2.devUnit=!0;this.testUnit_2.metadata={name:"Test Unit 2",helpURL:"https://curve.metasophiea.com/help/units/test/testUnit_2/"}}};this.builder=function(e,c){function f(){a.space={points:c.space.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.parameter.angle());return{x:c.x+b.x,y:c.y+b.y}})};a.space.boundingBox=g.library.math.boundingBoxFromPoints(a.space.points)}if(e){var a=g._interface.part.builder("group",
c.name,{x:c.x,y:c.y,angle:c.a});a.model=c.name;a.collection=c.collection;a.creatorMethod=e;a.elements={};for(e=0;e<c.elements.length;e++)if(void 0!=a.getChildByName(c.elements[e].name))console.warn('error: part with the name "'+c.elements[e].name+'" already exists. Part:',c.elements[e],"will not be added");else{var b=g._interface.part.builder(c.elements[e].type,c.elements[e].name,c.elements[e].data);a.append(b);void 0==a.elements[c.elements[e].type]&&(a.elements[c.elements[e].type]={});a.elements[c.elements[e].type][c.elements[e].name]=
b}a.io={};[{key:"_",name:"connectionNode"},{key:"signal",name:"connectionNode_signal"},{key:"voltage",name:"connectionNode_voltage"},{key:"data",name:"connectionNode_data"},{key:"audio",name:"connectionNode_audio"}].forEach(function(b){if(a.elements[b.name])for(var d=Object.keys(a.elements[b.name]),c=0;c<d.length;c++){var e=a.elements[b.name][d[c]];void 0==a.io[b.key]&&(a.io[b.key]={});a.io[b.key][e.name]=e}});a.disconnectEverything=function(){for(connectionType in a.io)for(connectionName in a.io[connectionType])a.io[connectionType][connectionName].disconnect()};
a.allowIOConnections=function(b){if(void 0!=b)for(connectionType in a.io)for(connectionName in a.io[connectionType])a.io[connectionType][connectionName].allowConnections(b)};a.allowIODisconnections=function(b){if(void 0!=b)for(connectionType in a.io)for(connectionName in a.io[connectionType])a.io[connectionType][connectionName].allowDisconnections(b)};f();for(e="spaceShape";void 0!=a.getChildByName(e);)e+=Math.floor(10*Math.random());b=g._interface.part.builder("polygon",e,{points:c.space,style:{fill:"rgba(0,0,0,0)"}});
a.prepend(b);c.spaceOutline&&a.append(g._interface.part.builder("polygon",e+"Outline",{points:c.space,style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,1)"}}));a._parameter={};a._parameter.x=a.parameter.x;a._parameter.y=a.parameter.y;a._parameter.angle=a.parameter.angle;a.parameter.x=function(b){if(void 0!=a._parameter.x(b))return a.x;c.x=b;f()};a.parameter.y=function(b){if(void 0!=a._parameter.y(b))return a.y;c.y=b;f()};a.parameter.angle=function(b){if(void 0!=a._parameter.angle(b))return a.angle;c.angle=
b;f()};a.interactable=function(b){if(void 0!=b)for(partType in a.elements)for(partName in a.elements[partType])a.elements[partType][partName].interactable&&a.elements[partType][partName].interactable(b)};return a}console.error("workspace unit\u00a0builder:: creatorMethod missing")}}};g.system.mouse.functionList.onmousedown.push({requiredKeys:[],function:function(m){g.control.gui.closeAllDropdowns()}});g.system.mouse.functionList.onmousedown.push({requiredKeys:[["shift"]],function:function(m){if(g.control.interaction.mouseGroupSelect())return g.system.mouse.tmp.selectionRectangle=
g._interface.part.builder("rectangle","selectionRectangle",{x:m.x,y:m.y,width:0,height:0,style:{fill:"rgba(224, 184, 252, 0.25)"}}),g.system.pane.mf.append(g.system.mouse.tmp.selectionRectangle),g.system.mouse.tmp.start={x:m.x,y:m.y},g.system.mouse.mouseInteractionHandler(function(e){var c=g.system.mouse.tmp.start;e=g.core.viewport.windowPoint2workspacePoint(e.x,e.y);g.system.mouse.tmp.selectionRectangle.parameter.width(e.x-c.x);g.system.mouse.tmp.selectionRectangle.parameter.height(e.y-c.y)},function(e){g.system.pane.mf.remove(g.system.mouse.tmp.selectionRectangle);
var c=g.system.mouse.tmp.start;e=g.core.viewport.windowPoint2workspacePoint(e.x,e.y);g.control.selection.selectUnits(g.control.scene.getUnitsWithinPoly([{x:c.x,y:c.y},{x:e.x,y:c.y},{x:e.x,y:e.y},{x:c.x,y:e.y}]))}),!0}});g.system.mouse.functionList.onmousedown.push({requiredKeys:[],function:function(m){if(g.control.interaction.mouseGripPanningEnabled())return g.control.selection.deselectEverything(),g.system.mouse.tmp.oldPosition=g.core.viewport.position(),g.system.mouse.tmp.clickPosition={x:m.event.x,
y:m.event.y},g.system.mouse.mouseInteractionHandler(function(e){g.core.viewport.position(g.system.mouse.tmp.oldPosition.x-(g.system.mouse.tmp.clickPosition.x-e.x)/g.core.viewport.scale()*window.devicePixelRatio,g.system.mouse.tmp.oldPosition.y-(g.system.mouse.tmp.clickPosition.y-e.y)/g.core.viewport.scale()*window.devicePixelRatio)},function(e){}),!0}});g.system.mouse.functionList.onwheel.push({requiredKeys:[],function:function(m){if(g.control.interaction.mouseWheelZoomEnabled()){var e=m.x,c=m.y,
f=g.core.viewport.scale();f-=m.event.deltaY/100*f;20<f&&(f=20);.1>f&&(f=.1);g.core.viewport.scale(f);m=g.core.viewport.windowPoint2workspacePoint(m.event.x,m.event.y);e=g.library.math.cartesianAngleAdjust(m.x-e,m.y-c,g.core.viewport.angle());c=g.core.viewport.position();g.core.viewport.position(c.x+e.x,c.y+e.y);return!0}}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","F2"],["command","F2"]],function:function(m){g.control.scene.load(void 0,void 0,!0);return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control",
"F3"],["command","F3"]],function:function(m){g.control.scene.save();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyX"],["command","KeyX"]],function:function(m){g.control.selection.cut();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyC"],["command","KeyC"]],function:function(m){g.system.keyboard.releaseKey("KeyC");g.control.selection.copy();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control",
"KeyV"],["command","KeyV"]],function:function(m){g.system.keyboard.releaseKey("KeyV");g.control.selection.paste();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyB"],["command","KeyB"]],function:function(m){g.control.selection.duplicate();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["Delete"],["Backspace"]],function:function(m){g.control.selection.delete();return!0}});g.control=new function(){var m=this;this.interaction=new function(){var e=
!1;this.devMode=function(a){if(void 0==a)return e;if(e=a)for(item in this)if("devMode"!=item)this[item](!0)};var c=!0;this.enableMenubar=function(a){if(void 0==a)return c;(c=a)||m.gui.hideMenubar()};var f=!0;this.enableSceneSave=function(a){if(void 0==a)return f;e||(f=a)};var a=!0;this.enableSceneLoad=function(b){if(void 0==b)return a;e||(a=b)};var b=!0;this.enableUnitAdditionRemoval=function(a){if(void 0==a)return b;e||(b=a)};var d=!0;this.enableUnitSelection=function(a){if(void 0==a)return d;e||
(d=a)};var h=!0;this.enableUnitInteractable=function(a){if(void 0==a)return h;e||(h=a,m.scene.getAllUnits().forEach(function(a){return a.interactable(h)}))};var g=!0;this.enableUnitCollision=function(a){if(void 0==a)return g;e||(g=a)};var k=!0;this.enableCableDisconnectionConnection=function(a){if(void 0==a)return k;e||(k=a,m.scene.getAllUnits().forEach(function(a){a.allowIOConnections(k);a.allowIODisconnections(k)}))};var q=!0;this.mouseGripPanningEnabled=function(a){if(void 0==a)return q;e||(q=
a)};var r=!0;this.mouseWheelZoomEnabled=function(a){if(void 0==a)return r;e||(r=a)};var n=!0;this.mouseGroupSelect=function(a){if(void 0==a)return n;e||(n=a)}};this.gui=new function(){var e=g.system.pane.f,c=void 0,f=window.devicePixelRatio;this.refresh=function(){void 0!=c&&c.refresh()};this.showMenubar=function(){g.control.interaction.enableMenubar()?void 0==c&&(c=m.gui.elements.menubar(0,0,f),e.append(c)):this.hideMenubar()};this.hideMenubar=function(){void 0!=c&&(e.remove(c),c=void 0)};this.closeAllDropdowns=
function(){void 0!=c&&c.closeAllDropdowns()};this.elements=new function(){this.menubar=function(a,b,d){g.control.viewport.width();var c=20*d,e=void 0,f=void 0;a={text_fill:"rgba(0,0,0,1)",text_font:11.25*d+"pt Helvetica",background__up__fill:"rgba(240,240,240,1)",background__press__fill:"rgba(240,240,240,1)",background__select_press__fill:"rgba(229,167,255,1)",background__press__stroke:"rgba(0,0,0,0)",background__select__fill:"rgba(229,167,255,1)",background__select__stroke:"rgba(0,0,0,0)",background__select_press__stroke:"rgba(0,0,0,0)"};
var q={text_font:11.25*d+"pt Helvetica",item__up__fill:"rgba(240,240,240,1)",item__hover__fill:"rgba(229,167,255,1)"},r=g._interface.part.builder("group","menubar",{}),n=g._interface.part.builder("rectangle","rectangle",{x:0,y:0,width:c,height:c,style:{fill:"rgba(240,240,240,1)"}});r.append(n);for(var m=b=0;m<this.menubar.dropdowns.length;m++){var t=g._interface.part.builder("button_rectangle","dropdownButton_"+m,{x:b*d,y:0,width:this.menubar.dropdowns[m].width*d,height:c,hoverable:!1,selectable:!0,
text_centre:this.menubar.dropdowns[m].text,style:a});r.append(t);t.onpress=function(a){return function(){e=r.getChildByName("dropdownButton_"+a).select()?void 0:a}}(m);t.onenter=function(a){return function(b){void 0!=e&&e!=a&&(r.getChildByName("dropdownButton_"+e).select(!1),e=a,0==b.buttons&&r.getChildByName("dropdownButton_"+e).select(!0))}}(m);t.onselect=function(a,b,k){return function(){for(var h=0,l=0;l<k.menubar.dropdowns[a].itemList.length;l++)switch(k.menubar.dropdowns[a].itemList[l]){case "break":h+=
k.menubar.dropdowns[a].breakHeight*d;break;case "space":h+=k.menubar.dropdowns[a].spaceHeight*d;break;default:h+=k.menubar.dropdowns[a].listItemHeight*d}h>g.control.viewport.height()*d&&(h=g.control.viewport.height()*d);f=g._interface.part.builder("list","dropdown",{x:b*d,y:c,style:q,width:k.menubar.dropdowns[a].listWidth*d,height:h,multiSelect:!1,selectable:!1,itemWidthMux:1,itemHeightMux:k.menubar.dropdowns[a].listItemHeight/h*d,breakHeightMux:k.menubar.dropdowns[a].breakHeight/h*d,spaceHeightMux:k.menubar.dropdowns[a].spaceHeight/
h*d,itemSpacingMux:0,list:k.menubar.dropdowns[a].itemList});f.onrelease=function(){r.getChildByName("dropdownButton_"+a).select(!1);e=void 0};r.append(f)}}(m,b,this);t.ondeselect=function(){r.remove(f)};this.menubar.dropdowns[m].x=b;b+=this.menubar.dropdowns[m].width}r.closeAllDropdowns=function(){if(void 0!=f)f.onrelease()};r.refresh=function(){n.parameter.width(g.control.viewport.width())};r.refresh();return r}}};this.viewport=new function(){this.width=function(){return g.width};this.height=function(){return g.height};
this.scale=function(e){return g.core.viewport.scale(e)};this.position=function(e,c){return g.core.viewport.position(e,c)};this.refresh=function(){g.core.viewport.refresh();m.gui.refresh()};this.stopMouseScroll=function(e){return g.core.viewport.stopMouseScroll(e)};this.activeRender=function(e){return g.core.render.active(e)}};this.scene=new function(){var e=g.system.pane.mm,c=0;this.backgroundColour=function(c){return g.core.render.clearColour(c)};this.new=function(e){if(void 0===e||!e||confirm("This will clear the current scene! Are you sure?"))m.selection.selectEverything(),
m.selection.delete(),c=0,m.viewport.position(0,0),m.viewport.scale(0)};this.documentUnits=function(c){for(var a=[],b=0;b<c.length;b++){var d=c[b],e={};e.position={x:d.parameter.x(),y:d.parameter.y(),angle:d.parameter.angle()};e.details={collection:d.collection,model:d.model};e.data=d.exportData?d.exportData():null;e.connections=[];for(var f in d.io)for(var k in d.io[f]){var g=d.io[f][k].getForeignNode();if(void 0!=g){var m={};m.typeAndNameOfSourcePort={type:f,name:k};m.indexOfDestinationUnit=c.indexOf(g.parent);
m.typeAndNameOfDestinationPort={type:f,name:g.name};e.connections.push(m)}}a.push(e)}return a};this.printUnits=function(c){for(var a=[],b=0;b<c.length;b++){var d=c[b],e=m.scene.addUnit(d.position.x,d.position.y,d.position.angle,d.details.model,d.details.collection);a.push(e);e.importData&&e.importData(d.data);m.selection.selectUnit(e);for(var f=0;f<d.connections.length;f++){var k=d.connections[f],g=m.selection.selectedUnits[k.indexOfDestinationUnit];void 0!=g&&e.io[k.typeAndNameOfSourcePort.type][k.typeAndNameOfSourcePort.name].connectTo(g.io[k.typeAndNameOfDestinationPort.type][k.typeAndNameOfDestinationPort.name])}}return a};
this.export=function(){return this.documentUnits(Array.from(e.children).filter(function(c){return!c._isCable}))};this.import=function(c){this.printUnits(c)};this.save=function(c,a){c=void 0===c?"project":c;a=void 0===a?!0:a;if(g.control.interaction.enableSceneSave()){var b={filename:c,viewportLocation:{xy:g.control.viewport.position(),scale:g.control.viewport.scale()}};g.library.audio.destination.masterGain(0);b.units=this.export();b=g.library.misc.serialize(b,a);b={compressed:a,data:b};b=g.library.misc.serialize(b,
!1);g.library.misc.printFile(c,b);g.library.audio.destination.masterGain(1)}};this.load=function(c,a,b){function d(a,b){g.library.audio.destination.masterGain(0);try{a=g.library.misc.unserialize(a,!1)}catch(q){console.error("Major error unserializing first layer of file");console.error(q);return}var d=a.compressed;try{a=g.library.misc.unserialize(a.data,d)}catch(q){console.error("Major error unserializing second layer of file");console.error(q);return}m.scene.new();m.scene.import(a.units);m.viewport.position(a.viewportLocation.xy.x,
a.viewportLocation.xy.y);m.viewport.scale(a.viewportLocation.scale);g.library.audio.destination.masterGain(1);m.selection.deselectEverything();b&&b(metadata)}b=void 0===b?!1:b;!g.control.interaction.enableSceneLoad()||b&&!confirm("This will clear the current scene! Are you sure?")||(void 0==c?g.library.misc.openFile(function(b){d(b,a)}):(b=new XMLHttpRequest,b.open("GET",c,!0),b.responseType="text",b.onload=function(){d(this.response,a)},b.send()))};this.generateUnitName=function(){return c++};this.addUnit=
function(c,a,b,d,h){h=void 0===h?"alpha":h;if(g.control.interaction.enableUnitAdditionRemoval()){var f=this.generateUnitName();if(void 0==g._interface.unit.collection[h])console.warn('unknown unit collection "'+h+'" (workspace._interface.unit.collection['+h+"])");else if(void 0==g._interface.unit.collection[h][d])console.warn('unknown unit model "'+d+'" (workspace._interface.unit.collection['+h+"]["+d+"])");else return c=g._interface.unit.collection[h][d](c,a,b),c.name=""+f,c=g.control.grapple.declare(c),
this.rectifyUnitPosition(c),e.append(c),c}};this.removeUnit=function(c){g.control.interaction.enableUnitAdditionRemoval()&&e.remove(c)};this.getAllUnits=function(){return e.children.filter(function(c){return!c._isCable})};this.getUnitByName=function(c){return e.getChildByName(c)};this.getUnitUnderPoint=function(c,a){for(var b=0;b<e.children.length;b++)if(g.library.math.detectOverlap.boundingBoxes({bottomRight:{x:c,y:a},topLeft:{x:c,y:a}},e.children[b].space.box)&&g.library.math.detectOverlap.pointWithinPoly({x:c,
y:a},e.children[b].space.points))return e.children[b]};this.getUnitsWithinPoly=function(c){var a=g.library.math.boundingBoxFromPoints(c);return e.children.filter(function(b){return!b._isCable&&g.library.math.detectOverlap.boundingBoxes(a,b.space.boundingBox)&&g.library.math.detectOverlap.overlappingPolygons(c,b.space.points)})};this.rectifyUnitPosition=function(c){if(g.control.interaction.enableUnitCollision()){var a=m.scene.getAllUnits().filter(function(a){return a!=c}).map(function(a){return a.space});
if(!g.library.math.detectOverlap.overlappingPolygonWithPolygons(c.space,a))return!1;a=g.library.math.fitPolyIn(c.space,a);c.parameter.x(c.parameter.x()+a.x);c.parameter.y(c.parameter.y()+a.y);return!0}}};this.selection=new function(){this.selectedUnits=[];this.lastSelectedUnits=null;this.clipboard=[];this.selectUnit=function(e,c){c=void 0===c?!0:c;if(g.control.interaction.enableUnitSelection()&&-1==this.selectedUnits.indexOf(e)){c&&(c=g.system.pane.getMiddlegroundPane(e),c.remove(e),c.append(e));
c=g._interface.part.builder("polygon","selectionGlow-"+e.getAddress(),{points:e.space.points.map(function(c){return g.library.math.cartesianAngleAdjust(c.x-e.x,c.y-e.y,-e.parameter.angle())}),style:{fill:"rgba(244, 226, 66, 0.25)",stroke:"rgba(244, 226, 66, 1)"}});e.append(c);if(e.onselect)object.onselect();this.selectedUnits.push(e);this.lastSelectedUnits=e}};this.selectUnits=function(e){for(var c=0;c<e.length;c++)this.selectUnit(e[c])};this.deselectUnit=function(e){e.remove(e.getChildByName("selectionGlow-"+
e.getAddress()));this.selectedUnits.splice(this.selectedUnits.indexOf(e),1);if(e.ondeselect)e.ondeselect()};this.selectEverything=function(){this.deselectEverything();for(var e=0;e<g.system.pane.mm.children.length;e++)g.system.pane.mm.children[e]._isCable||this.selectUnit(g.system.pane.mm.children[e],!1)};this.deselectEverything=function(){for(;0<this.selectedUnits.length;)this.deselectUnit(this.selectedUnits[0])};this.cut=function(){g.control.interaction.enableUnitAdditionRemoval()&&(this.copy(),
this.delete())};this.copy=function(){g.control.interaction.enableUnitAdditionRemoval()&&(this.clipboard=g.control.scene.documentUnits(this.selectedUnits))};this.paste=function(e){if(g.control.interaction.enableUnitAdditionRemoval()&&0!=this.clipboard.length){this.deselectEverything();if("duplicate"!=e){var c=[];this.clipboard.forEach(function(a){return c.push(a.position)});var f=g.library.math.boundingBoxFromPoints(c).topLeft;void 0==e&&(e=g.core.viewport.mousePosition(),void 0==e.x||void 0==e.y)&&
(e=g.core.viewport.windowPoint2workspacePoint(0,0));this.clipboard.forEach(function(a){a.position.x+=e.x-f.x;a.position.y+=e.y-f.y})}g.control.scene.printUnits(this.clipboard)}};this.duplicate=function(){g.control.interaction.enableUnitAdditionRemoval()&&(this.copy(),this.paste("duplicate"),this.clipboard=[])};this.delete=function(){if(g.control.interaction.enableUnitAdditionRemoval()){for(;0<this.selectedUnits.length;){var e=this.selectedUnits[0];if(e.ondelete)e.ondelete();e.disconnectEverything();
g.system.pane.getMiddlegroundPane(e).remove(e);this.selectedUnits.shift()}this.lastSelectedUnits=null}}}};g.control.grapple={tmpdata:{},tmpunit:void 0,functionList:{onmousedown:[],onmouseup:[]},declare:function(m){function e(c){return function(e,a,b){0==b.button&&(g.control.grapple.tmpunit=this,g.library.structure.functionListRunner(c,g.system.keyboard.pressedKeys)({event:b,x:e,y:a}))}}m.onmousedown=e(this.functionList.onmousedown);m.onmouseup=e(this.functionList.onmouseup);return m}};g.control.grapple.functionList.onmousedown.push({requiredKeys:[],
function:function(m){var e=g.control;e.selection.selectedUnits.includes(e.grapple.tmpunit)||(m.event.shiftKey||e.selection.deselectEverything(),e.selection.selectUnit(e.grapple.tmpunit))}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[["shift","alt"]],function:function(m){var e=g.control;e.grapple.tmpdata.oldClickPosition={x:m.x,y:m.y};e.grapple.tmpdata.oldUnitsPositions=[];e.grapple.tmpdata.oldUnitsSelectionArea=[];for(m=0;m<e.selection.selectedUnits.length;m++)e.grapple.tmpdata.oldUnitsPositions.push({x:e.selection.selectedUnits[m].x,
y:e.selection.selectedUnits[m].y,angle:e.selection.selectedUnits[m].angle}),e.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},e.selection.selectedUnits[m].selectionArea));g.system.mouse.mouseInteractionHandler(function(c){for(var f=0;f<e.selection.selectedUnits.length;f++){var a=e.selection.selectedUnits[f],b=e.grapple.tmpdata.oldClickPosition,d=g.core.viewport.windowPoint2workspacePoint(c.x,c.y);a.parameter.angle(e.grapple.tmpdata.oldUnitsPositions[f].angle+(d.y-b.y)/100);g.control.scene.rectifyUnitPosition(a);
if(a.onrotate)a.onrotate();if(a.io)for(b=Object.keys(a.io),d=0;d<b.length;d++)for(var h=a.io[b[d]],l=Object.keys(h),k=0;k<l.length;k++)h[l[k]].draw()}},function(c){});return!0}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[["alt"]],function:function(m){g.control.selection.duplicate()}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[],function:function(m){var e=g.control;e.grapple.tmpdata.oldClickPosition={x:m.x,y:m.y};e.grapple.tmpdata.oldUnitsPositions=[];e.grapple.tmpdata.oldUnitsSelectionArea=
[];for(m=0;m<e.selection.selectedUnits.length;m++)e.grapple.tmpdata.oldUnitsPositions.push({x:e.selection.selectedUnits[m].x,y:e.selection.selectedUnits[m].y}),e.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},e.selection.selectedUnits[m].selectionArea));g.system.mouse.mouseInteractionHandler(function(c){for(var f=0;f<e.selection.selectedUnits.length;f++){var a=e.selection.selectedUnits[f],b=e.grapple.tmpdata.oldClickPosition,d=g.core.viewport.windowPoint2workspacePoint(c.x,c.y),h=e.grapple.tmpdata.oldUnitsPositions[f],
l=h.y+(d.y-b.y);a.parameter.x(h.x+(d.x-b.x));a.parameter.y(l);g.control.scene.rectifyUnitPosition(a);if(a.onmove)a.onmove();if(a.io)for(b=Object.keys(a.io),d=0;d<b.length;d++){h=a.io[b[d]];l=Object.keys(h);for(var k=0;k<l.length;k++)h[l[k]].draw()}}},function(c){})}});g.control.grapple.functionList.onmouseup.push({requiredKeys:[],function:function(m){var e=g.control;e.selection.selectedUnits.includes(e.grapple.tmpunit)&&(m.event.shiftKey&&e.selection.lastSelectedUnits!=e.grapple.tmpunit&&e.selection.deselectUnit(e.grapple.tmpunit),
e.selection.lastSelectedUnits=null);return!0}});window.onresize=g.control.viewport.refresh;g.control.interaction.devMode(null!=(new URL(window.location.href)).searchParams.get("dev"));g._interface.unit.collection.alpha=new function(){this.audio_duplicator=function(m,e,c){var f={fill:"rgba(150,150,150,1)"};m=g._interface.unit.builder(this.audio_duplicator,{name:"audio_duplicator",category:"misc",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],elements:[{type:"connectionNode_audio",
name:"input",data:{type:0,x:55,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"output_1",data:{type:1,x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"output_2",data:{type:1,x:-10,y:30,width:10,height:20,isAudioOutput:!0}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"polygon",name:"upperArrow",data:{points:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:f}},{type:"polygon",
name:"lowerArrow",data:{points:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:f}},{type:"rectangle",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:f}},{type:"rectangle",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:f}},{type:"rectangle",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:f}}]});m.elements.connectionNode_audio.input.out().connect(m.elements.connectionNode_audio.output_1.in());m.elements.connectionNode_audio.input.out().connect(m.elements.connectionNode_audio.output_2.in());
return m};this.audio_duplicator.metadata={name:"Audio Duplicator",category:"misc",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioDuplicator/"};this.universalreadout=function(m,e,c){var f={fill:"rgba(0,0,0,1)",size:.75,font:"Courier New"},a=g._interface.unit.builder(this.universalreadout,{name:"universalreadout",category:"misc",collection:"alpha",x:m,y:e,a:c,space:[{x:-5,y:-5},{x:10,y:-10},{x:25,y:-5},{x:30,y:10},{x:25,y:25},{x:10,y:30},{x:-5,y:25},{x:-10,y:10}],elements:[{type:"circle",
name:"base",data:{x:10,y:10,r:20,style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"in",data:{x:0,y:0,width:20,height:20,onreceive:function(c,e){c="address: "+c+" data: "+JSON.stringify(e);c=l++ +"> "+c;b.unshift(c);b.length>h&&b.pop();for(c=0;c<d.length;c++)d[c].parent.remove(d[c]);d=[];for(c=0;c<b.length;c++)d[c]=g._interface.part.builder("text","universalreadout_"+c,{x:40,y:5*c,size:f.size,text:b[c],style:f}),a.append(d[c])}}}]}),b=[],d=[],h=10,l=0;return a};this.universalreadout.metadata=
{name:"Universal Readout",category:"misc",helpURL:"https://curve.metasophiea.com/help/units/alpha/universalReadout/"};this.pulseGenerator_hyper=function(m,e,c){function f(a){b.elements.readout_sixteenSegmentDisplay__static.readout.text(g.library.misc.padString(a,3," ")+"bpm");b.elements.readout_sixteenSegmentDisplay__static.readout.print();d&&clearInterval(d);0<a&&(d=setInterval(function(){b.io.data.out.send("pulse")},60/a*1E3));b.io.data.out.send("pulse");h=a}var a={handle:"rgba(220,220,220,1)",
slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},b=g._interface.unit.builder(this.pulseGenerator_hyper,{name:"pulseGenerator_hyper",category:"misc",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){b.elements.button_rectangle.sync.press()}}},
{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:{fill:"rgba(200,200,200,1)"}}},{type:"button_rectangle",name:"syncButton",data:{x:102.5,y:11.25,width:10,height:17.5,selectable:!1,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){f(h)}}},{type:"dial_continuous",name:"tempo",data:{x:20,
y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:a.handle,slot:a.slot,needle:a.needle,outerArc:a.arc}}},{type:"readout_sixteenSegmentDisplay__static",name:"readout",data:{x:35,y:10,width:65,height:20,count:6}}]});b.elements.dial_continuous.tempo.onchange=function(a){f(Math.round(999*a))};b.exportData=function(){return b.elements.dial_continuous.tempo.get()};b.importData=function(a){b.elements.dial_continuous.tempo.set(a)};var d=null,h=120;b.i={setTempo:function(a){b.elements.dial_continuous.tempo.set(a)}};
b.elements.dial_continuous.tempo.set(.5);return b};this.pulseGenerator_hyper.metadata={name:"Pulse Generator (Hyper)",category:"misc",helpURL:"https://curve.metasophiea.com/help/objectects/alpha/pulseGenerator_hyper/"};this.pulseGenerator=function(m,e,c){function f(a){b.elements.readout_sixteenSegmentDisplay__static.readout.text(g.library.misc.padString(a,3," ")+"bpm");b.elements.readout_sixteenSegmentDisplay__static.readout.print();d&&clearInterval(d);0<a&&(d=setInterval(function(){b.io.data.out.send("pulse")},
60/a*1E3));b.io.data.out.send("pulse");h=a}var a={handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},b=g._interface.unit.builder(this.pulseGenerator,{name:"pulseGenerator",category:"misc",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,
width:5,height:17.5,receive:function(){b.elements.button_rectangle.sync.press()}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:{fill:"rgba(200,200,200,1)"}}},{type:"button_rectangle",name:"syncButton",data:{x:102.5,y:11.25,width:10,height:17.5,selectable:!1,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},
onpress:function(){f(h)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:a.handle,slot:a.slot,needle:a.needle,outerArc:a.arc}}},{type:"readout_sixteenSegmentDisplay__static",name:"readout",data:{x:35,y:10,width:65,height:20,count:6}}]});b.elements.dial_continuous.tempo.onchange=function(a){f(Math.round(240*a))};b.exportData=function(){return b.elements.dial_continuous.tempo.get()};b.importData=function(a){b.elements.dial_continuous.tempo.set(a)};
var d=null,h=120;b.i={setTempo:function(a){b.elements.dial_continuous.tempo.set(a)}};b.elements.dial_continuous.tempo.set(.5);return b};this.pulseGenerator.metadata={name:"Pulse Generator",category:"misc",helpURL:"https://curve.metasophiea.com/help/objectects/alpha/pulseGenerator/"};this.data_duplicator=function(m,e,c){var f={fill:"rgba(150,150,150,1)"},a=g._interface.unit.builder(this.data_duplicator,{name:"data_duplicator",category:"misc",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:55,y:0},
{x:55,y:55},{x:0,y:55}],elements:[{type:"connectionNode_data",name:"output_1",data:{x:-10,y:5,width:20,height:20}},{type:"connectionNode_data",name:"output_2",data:{x:-10,y:30,width:20,height:20}},{type:"connectionNode_data",name:"input",data:{x:45,y:5,width:20,height:20,onreceive:function(b,c){a.io.data.output_1.send(b,c);a.io.data.output_2.send(b,c)}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"polygon",name:"upperArrow",
data:{points:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:f}},{type:"polygon",name:"lowerArrow",data:{points:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:f}},{type:"rectangle",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:f}},{type:"rectangle",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:f}},{type:"rectangle",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:f}}]});return a};this.data_duplicator.metadata={name:"Data Duplicator",category:"misc",helpURL:"https://curve.metasophiea.com/help/units/alpha/dataDuplicator/"};
this.basicMixer=function(m,e,c){var f={fill:"rgba(150,150,150,1)"},a={fill:"rgb(150,150,150)",font:"5pt Courier New"};m={name:"basicMixer",category:"misc",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],elements:[{type:"connectionNode_audio",name:"output_0",data:{x:-10,y:5,width:20,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"output_1",data:{x:-10,y:30,width:20,height:20,isAudioOutput:!0}},{type:"polygon",name:"backing",data:{points:[{x:0,
y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],style:{fill:"rgba(200,200,200,1)"}}},{type:"text",name:"gain",data:{x:77.5,y:8,text:"gain",style:a}},{type:"text",name:"pan",data:{x:54,y:8,text:"pan",style:a}},{type:"rectangle",name:"vertical",data:{x:22.5,y:6,width:2,height:190,style:f}},{type:"rectangle",name:"overTheTop",data:{x:10,y:6,width:14,height:2,style:f}},{type:"rectangle",name:"down",data:{x:10,y:6,width:2,height:35,style:f}},{type:"rectangle",name:"inTo0",data:{x:2,y:14,width:10,height:2,
style:f}},{type:"rectangle",name:"inTo1",data:{x:2,y:39,width:10,height:2,style:f}}]};for(c=0;8>c;c++)m.elements.unshift({type:"connectionNode_audio",name:"input_"+c,data:{x:90,y:10+25*c,width:20,height:20}}),m.elements.push({type:"rectangle",name:"line_"+c,data:{x:23,y:19.1+25*c,width:75,height:2,style:f}}),m.elements.push({type:"dial_continuous",name:"gain_"+c,data:{x:85,y:20+25*c,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",
needle:"rgba(250,150,150,1)"}}}),m.elements.push({type:"dial_continuous",name:"pan_"+c,data:{x:60,y:20+25*c,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}});var b=g._interface.unit.builder(this.basicMixer,m);for(c=0;8>c;c++)b["splitter_"+c]=new g._interface.circuit.channelMultiplier(g.library.audio.context,2),b.elements.connectionNode_audio["input_"+c].out().connect(b["splitter_"+
c].in()),b["splitter_"+c].out(0).connect(b.elements.connectionNode_audio.output_0.in()),b["splitter_"+c].out(1).connect(b.elements.connectionNode_audio.output_1.in()),b.elements.dial_continuous["gain_"+c].onchange=function(a){return function(c){b["splitter_"+a].inGain(c)}}(c),b.elements.dial_continuous["gain_"+c].onchange=function(a){return function(c){b["splitter_"+a].outGain(0,c);b["splitter_"+a].outGain(1,1-c)}}(c);b.i={gain:function(a,c){b.elements.dial_continuous["gain_"+a].set(c)},pan:function(a,
c){b.elements.dial_continuous["pan_"+a].set(c)}};for(c=0;8>c;c++)b.i.gain(c,.5),b.i.pan(c,.5);return b};this.basicMixer.metadata={name:"Basic Audio Mixer",category:"misc",helpURL:"https://curve.metasophiea.com/help/units/alpha/basicAudioMixer/"};this.filterUnit=function(m,e,c){function f(){for(var a=[],c=[],d=0;d<=Math.floor(Math.log10(b.freqRange.high))+1;d++)for(var e=1;10>e&&!(e/10*Math.pow(10,d)>=b.freqRange.high);e+=1/Math.pow(2,b.graphDetail))a.push(Math.log10(Math.pow(10,d)*e)),c.push(e/10*
Math.pow(10,d));return{frequency:c,location:g.library.math.normalizeStretchArray(a)}}function a(){var a=f();k.elements.grapher__static.graph.draw(k.filterCircuit.measureFrequencyResponse_values(a.frequency)[0],a.location)}var b={freqRange:{low:.1,high:2E4},graphDetail:3},d={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},h={fill:"rgba(0,0,0,1)",font:"2pt Courier New"},l={fill:"rgba(0,0,0,1)",font:"1.5pt Courier New"},k=g._interface.unit.builder(this.filterUnit,{name:"filterUnit",category:"audioEffectUnits",
collection:"alpha",x:m,y:e,a:c,space:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},{x:0,y:70}],elements:[{type:"polygon",name:"backing",data:{points:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},{x:0,y:70}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:94.8,y:16,width:10,height:20,angle:-.14}},{type:"connectionNode_audio",name:"audioOut",data:{x:-2.3,y:16,width:10,height:20,angle:.144,isAudioOutput:!0}},{type:"grapher__static",name:"graph",
data:{x:15,y:5,width:72.5,height:50,resolution:5,style:{foregrounds:[{stroke:"rgba(0,200,163,1)",lineWidth:.5,lineJoin:"round"}],background_stroke:"rgba(0,200,163,0.25)",background_lineWidth:.25,backgroundText_fill:"rgba(0,200,163,0.75)",backgroundText_font:"6pt Helvetica"}}},{type:"text",name:"Q_0",data:{x:74,y:76,text:"0",style:h}},{type:"text",name:"Q_1/2",data:{x:80,y:59.5,text:"1/2",style:h}},{type:"text",name:"Q_1",data:{x:89,y:76,text:"1",style:h}},{type:"text",name:"Q_title",data:{x:81,y:79,
text:"Q",style:d}},{type:"dial_continuous",name:"Q_dial",data:{x:82.5,y:68.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"gain_0",data:{x:54,y:86,text:"0",style:h}},{type:"text",name:"gain_1/2",data:{x:61.75,y:68.5,text:"5",style:h}},{type:"text",name:"gain_1",data:{x:69,y:86,text:"10",style:h}},{type:"text",name:"gain_title",data:{x:58,y:89,text:"Gain",style:d}},{type:"dial_continuous",
name:"gain_dial",data:{x:62.5,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"frequency_0",data:{x:31.5,y:86,text:"0",style:h}},{type:"text",name:"frequency_100",data:{x:37.5,y:68.5,text:"100",style:h}},{type:"text",name:"frequency_20000",data:{x:46.5,y:86,text:"20k",style:h}},{type:"text",name:"frequency_title",data:{x:35.5,y:89,text:"Freq",style:d}},{type:"dial_continuous",name:"frequency_dial",
data:{x:40,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"type_lowp",data:{x:9,y:74.5,text:"lowp",style:l}},{type:"text",name:"type_highp",data:{x:6,y:69,text:"highp",style:l}},{type:"text",name:"type_band",data:{x:8,y:63,text:"band",style:l}},{type:"text",name:"type_lows",data:{x:14,y:59,text:"lows",style:l}},{type:"text",name:"type_highs",data:{x:22.5,y:59.5,text:"highs",style:l}},
{type:"text",name:"type_peak",data:{x:27.5,y:63,text:"peak",style:l}},{type:"text",name:"type_notch",data:{x:29,y:69,text:"notch",style:l}},{type:"text",name:"type_all",data:{x:25.5,y:74.5,text:"all",style:l}},{type:"text",name:"type_title",data:{x:15.5,y:78.5,text:"Type",style:d}},{type:"dial_discrete",name:"type_dial",data:{x:20,y:67.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:8,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});k.importData=
function(a){k.elements.dial_continuous.Q_dial.set(a.Q);k.elements.dial_continuous.gain_dial.set(a.gain);k.elements.dial_discrete.type_dial.set(a.type);k.elements.dial_continuous.frequency_dial.set(a.frequency)};k.exportData=function(){return{Q:k.elements.dial_continuous.Q_dial.get(),gain:k.elements.dial_continuous.gain_dial.get(),type:k.elements.dial_discrete.type_dial.get(),frequency:k.elements.dial_continuous.frequency_dial.get()}};k.filterCircuit=new g._interface.circuit.filterUnit(g.library.audio.context);
k.elements.connectionNode_audio.audioIn.out().connect(k.filterCircuit.in());k.filterCircuit.out().connect(k.elements.connectionNode_audio.audioOut.in());k.elements.dial_continuous.Q_dial.onchange=function(b){k.filterCircuit.Q(10*b);a()};k.elements.dial_continuous.gain_dial.onchange=function(b){k.filterCircuit.gain(10*b);a()};k.elements.dial_continuous.frequency_dial.onchange=function(b){k.filterCircuit.frequency(g.library.math.curvePoint.exponential(b,0,2E4,10.5866095));a()};k.elements.dial_discrete.type_dial.onchange=
function(b){k.filterCircuit.type("lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ")[b]);a()};m=f();m.frequency=m.frequency.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});m.location=m.location.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});k.elements.grapher__static.graph.viewbox({bottom:0,top:2,left:0,right:1});k.elements.grapher__static.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});
k.elements.grapher__static.graph.verticalMarkings({points:m.location,printingValues:m.frequency.map(function(a){return 0==Math.log10(a)%1?a:""}).slice(0,m.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});k.elements.dial_discrete.type_dial.set(0);k.elements.dial_continuous.Q_dial.set(0);k.elements.dial_continuous.gain_dial.set(.1);k.elements.dial_continuous.frequency_dial.set(.5);setTimeout(a,100);return k};this.filterUnit.metadata={name:"Filter Unit",category:"audioEffectUnits",
helpURL:"https://curve.metasophiea.com/help/units/alpha/filterUnit/"};this.reverbUnit=function(m,e){function c(a){0==f.availableTypes.length?console.log("broken or not yet ready"):(a>=f.availableTypes.length?a=f.availableTypes.length-1:0>a&&(a=0),f.reverbTypeSelected=a,d.reverbCircuit.type(f.availableTypes[a],function(){var a=f.reverbTypeSelected;a=("0"+a).slice(-2);d.elements.sevenSegmentDisplay__static.ones.enterCharacter(a[0]);d.elements.sevenSegmentDisplay__static.tens.enterCharacter(a[1])}))}
var f={reverbTypeSelected:0,availableTypes:[]},a={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},d=g._interface.unit.builder(this.reverbUnit,{name:"reverbUnit",category:"audioEffectUnits",collection:"alpha",x:m,y:e,space:[{x:0,y:10},{x:51.25,y:0},{x:102.5,y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,
y:10},{x:51.25,y:0},{x:102.5,y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:102.5,y:16,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:16,width:10,height:20,isAudioOutput:!0}},{type:"text",name:"outGain_0",data:{x:8,y:38,text:"0",style:a}},{type:"text",name:"outGain_1/2",data:{x:16.5,y:11,text:"1/2",style:a}},{type:"text",name:"outGain_1",data:{x:29,y:38,text:"1",style:a}},{type:"dial_continuous",
name:"outGain_dial",data:{x:20,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"wetdry_1/2",data:{x:66.5,y:39,text:"wet",style:a}},{type:"text",name:"wetdry_1",data:{x:91.5,y:39,text:"dry",style:a}},{type:"dial_continuous",name:"wetdry_dial",data:{x:82.5,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},
{type:"button_rectangle",name:"raiseByOne",data:{x:51,y:6,width:10.25,height:5,style:b,onpress:function(){c(f.reverbTypeSelected+1)}}},{type:"button_rectangle",name:"raiseByTen",data:{x:38.75,y:6,width:10.25,height:5,style:b,onpress:function(){c(f.reverbTypeSelected+10)}}},{type:"button_rectangle",name:"lowerByOne",data:{x:51,y:39,width:10.25,height:5,style:b,onpress:function(){c(f.reverbTypeSelected-1)}}},{type:"button_rectangle",name:"lowerByTen",data:{x:38.75,y:39,width:10.25,height:5,style:b,
onpress:function(){c(f.reverbTypeSelected-10)}}},{type:"sevenSegmentDisplay__static",name:"tens",data:{x:50,y:12.5,width:12.5,height:25}},{type:"sevenSegmentDisplay__static",name:"ones",data:{x:37.5,y:12.5,width:12.5,height:25}}]});d.importData=function(a){f.reverbTypeSelected=a.selectedType;d.elements.dial_continuous.wetdry_dial.set(a.wetdry);d.elements.dial_continuous.outGain_dial.set(a.outGain)};d.exportData=function(){return{selectedType:f.reverbTypeSelected,wetdry:d.elements.dial_continuous.wetdry_dial.get(),
outGain:d.elements.dial_continuous.outGain_dial.get()}};d.reverbCircuit=new g._interface.circuit.reverbUnit(g.library.audio.context);d.elements.connectionNode_audio.audioIn.out().connect(d.reverbCircuit.in());d.reverbCircuit.out().connect(d.elements.connectionNode_audio.audioOut.in());d.reverbCircuit.getTypes(function(a){f.availableTypes=a});d.elements.dial_continuous.outGain_dial.onchange=function(a){d.reverbCircuit.outGain(a)};d.elements.dial_continuous.wetdry_dial.onchange=function(a){d.reverbCircuit.wetdry(1-
a)};d.i={gain:function(a){d.elements.dial_continuous.outGain_dial.set(a)},wetdry:function(a){d.elements.dial_continuous.wetdry_dial.set(a)}};d.elements.dial_continuous.outGain_dial.set(.5);d.elements.dial_continuous.wetdry_dial.set(.5);setTimeout(function(){c(f.reverbTypeSelected)},1E3);return d};this.reverbUnit.metadata={name:"Reverb Unit",category:"audioEffectUnits",helpURL:"https://curve.metasophiea.com/help/units/alpha/reverbUnit/"};this.multibandFilter=function(m,e,c){function f(){for(var a=
[],c=[],d=0;d<=Math.floor(Math.log10(b.freqRange.high))+1;d++)for(var e=1;10>e&&!(e/10*Math.pow(10,d)>=b.freqRange.high);e+=1/Math.pow(2,b.graphDetail))a.push(Math.log10(Math.pow(10,d)*e)),c.push(e/10*Math.pow(10,d));return{frequency:c,location:g.library.math.normalizeStretchArray(a)}}function a(a){if(b.allowUpdate){var c=f();if(void 0==a){var d=k.filterCircuit_0.measureFrequencyResponse(void 0,c.frequency);for(a=0;a<b.channelCount;a++)k.elements.grapher__static.graph.draw(d[a][0],c.location,a)}else d=
k.filterCircuit_0.measureFrequencyResponse(a,c.frequency),k.elements.grapher__static.graph.draw(d[0],c.location,a)}}var b={allowUpdate:!1,freqRange:{low:.1,high:2E4},graphDetail:2,channelCount:8,masterGain:1,gain:[],Q:[],frequency:[],curvePointExponentialSharpness:10.586609649448985,defaultValues:{gain:[.5,.5,.5,.5,.5,.5,.5,.5],Q:[0,.09,.09,.09,.09,.09,.09,0],frequency:[.41416,.479046,.565238,.630592,.717072,.803595,.91345175,.93452845]}},d=[{fill:"rgba(0,200,163,  0.5)"},{fill:"rgba(100,235,131,0.5)"},
{fill:"rgba(228,255,26, 0.5)"},{fill:"rgba(232,170,20, 0.5)"},{fill:"rgba(255,87,20,  0.5)"},{fill:"rgba(0,191,255,  0.5)"},{fill:"rgba(249,99,202, 0.5)"},{fill:"rgba(255,255,255,0.5)"}],h={handle:"rgba(240,240,240,1)",backing:"rgba(200,200,200,0.5)",slot:"rgba(50,50,50,1)"},l={handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"};m={name:"multibandFilter",category:"audioEffectUnits",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:10},{x:10,y:0},{x:185,y:0},{x:195,y:10},
{x:195,y:245},{x:185,y:255},{x:10,y:255},{x:0,y:245},{x:0,y:75},{x:-25,y:65},{x:-25,y:10}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:185,y:0},{x:195,y:10},{x:195,y:245},{x:185,y:255},{x:10,y:255},{x:0,y:245},{x:0,y:75},{x:-25,y:65},{x:-25,y:10}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn_0",data:{x:195,y:15,width:10,height:20}},{type:"connectionNode_audio",name:"audioIn_1",data:{x:195,y:40,width:10,height:20}},{type:"connectionNode_audio",
name:"audioOut_0",data:{x:-35,y:15,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"audioOut_1",data:{x:-35,y:40,width:10,height:20,isAudioOutput:!0}},{type:"dial_continuous",name:"masterGain",data:{x:-10,y:37.5,r:10,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,resetValue:.5,style:l}},{type:"grapher__static",name:"graph",data:{x:10,y:10,width:175,height:75,style:{foregrounds:[{stroke:"rgba(0,200,163,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(100,235,131,1)",lineWidth:.5,
lineJoin:"round"},{stroke:"rgba(228,255,26,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(232,170,20,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,87,20,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,191,255,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(249,99,202,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,255,1)",lineWidth:.5,lineJoin:"round"}],background_stroke:"rgba(0,200,163,0.25)",background_lineWidth:.25,backgroundText_fill:"rgba(0,200,163,0.75)",backgroundText_font:"8pt Helvetica"},
resolution:5}}]};for(c=0;c<b.channelCount;c++)m.elements.push({type:"rectangle",name:"backing_"+c,data:{x:13.75+22*c,y:87.5,width:12.5,height:157.5,style:d[c]}},{type:"slide",name:"gainSlide_"+c,data:{x:15+22*c,y:90,width:10,height:80,angle:0,handleHeight:.05,resetValue:.5,style:h}},{type:"dial_continuous",name:"qDial_"+c,data:{x:20+22*c,y:180,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:l}},{type:"dial_continuous",name:"frequencyDial_"+c,data:{x:20+22*c,y:200,r:7,startAngle:3*Math.PI/4,
maxAngle:1.5*Math.PI,style:l}},{type:"readout_sixteenSegmentDisplay__static",name:"frequencyReadout_"+c,data:{x:25+22*c,y:212.5,width:30,height:10,count:8,angle:Math.PI/2,resolution:10}});var k=g._interface.unit.builder(this.multibandFilter,m);k.exportData=function(){return{masterGain:b.masterGain,freqRange:b.freqRange,channelCount:b.channelCount,gain:b.gain,Q:b.Q,frequency:b.frequency}};k.importData=function(a){};k.filterCircuit_0=new g._interface.circuit.multibandFilter(g.library.audio.context,
b.channelCount,!0);k.filterCircuit_1=new g._interface.circuit.multibandFilter(g.library.audio.context,b.channelCount,!0);k.elements.connectionNode_audio.audioIn_0.out().connect(k.filterCircuit_0.in());k.elements.connectionNode_audio.audioIn_1.out().connect(k.filterCircuit_1.in());k.filterCircuit_0.out().connect(k.elements.connectionNode_audio.audioOut_0.in());k.filterCircuit_1.out().connect(k.elements.connectionNode_audio.audioOut_1.in());k.elements.dial_continuous.masterGain.onchange=function(c){b.masterGain=
2*c;k.filterCircuit_0.masterGain(b.masterGain);k.filterCircuit_1.masterGain(b.masterGain);a()};for(c=0;c<b.channelCount;c++)k.elements.slide["gainSlide_"+c].onchange=function(c){return function(d){b.gain[c]=2*(1-d);k.filterCircuit_0.gain(c,b.gain[c]);k.filterCircuit_1.gain(c,b.gain[c]);a(c)}}(c),k.elements.dial_continuous["qDial_"+c].onchange=function(c){return function(d){b.Q[c]=d;k.filterCircuit_0.Q(c,g.library.math.curvePoint.exponential(b.Q[c],0,2E4,b.curvePointExponentialSharpness));k.filterCircuit_1.Q(c,
g.library.math.curvePoint.exponential(b.Q[c],0,2E4,b.curvePointExponentialSharpness));a(c)}}(c),k.elements.dial_continuous["frequencyDial_"+c].onchange=function(c){return function(d){b.frequency[c]=d;k.elements.readout_sixteenSegmentDisplay__static["frequencyReadout_"+c].text(g.library.misc.padString(g.library.math.curvePoint.exponential(d,0,2E4,b.curvePointExponentialSharpness).toFixed(2),8));k.elements.readout_sixteenSegmentDisplay__static["frequencyReadout_"+c].print("smart");k.filterCircuit_0.frequency(c,
g.library.math.curvePoint.exponential(b.frequency[c],0,2E4,b.curvePointExponentialSharpness));k.filterCircuit_1.frequency(c,g.library.math.curvePoint.exponential(b.frequency[c],0,2E4,b.curvePointExponentialSharpness));a(c)}}(c);k.i={gain:function(a,b){if(void 0==b)return k.elements.slide["gainSlide_"+a].get(b);k.elements.slide["gainSlide_"+a].set(b)},Q:function(a,b){if(void 0==b)return k.elements.dial_continuous["qDial_"+a].get(b);k.elements.dial_continuous["qDial_"+a].set(b)},frequency:function(a,
b){if(void 0==b)return k.elements.dial_continuous["frequencyDial_"+a].get(b);k.elements.dial_continuous["frequencyDial_"+a].set(b)},reset:function(a){if(void 0==a){for(a=0;a<b.channelCount;a++)k.i.reset(a);k.elements.dial_continuous.masterGain.set(.5)}else for(a=0;a<b.channelCount;a++)k.elements.slide["gainSlide_"+a].set(b.defaultValues.gain[a]),k.elements.dial_continuous["qDial_"+a].set(b.defaultValues.Q[a]),k.elements.dial_continuous["frequencyDial_"+a].set(b.defaultValues.frequency[a])}};c=f();
c.frequency=c.frequency.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});c.location=c.location.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});k.elements.grapher__static.graph.viewbox({bottom:0,top:2,left:0,right:1});k.elements.grapher__static.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});k.elements.grapher__static.graph.verticalMarkings({points:c.location,printingValues:c.frequency.map(function(a){return 0==Math.log10(a)%
1?a:""}).slice(0,c.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});k.i.reset();setTimeout(function(){k.i.reset()},1);b.allowUpdate=!0;a();return k};this.multibandFilter.metadata={name:"Multiband Filter",category:"audioEffectUnits",helpURL:"https://curve.metasophiea.com/help/units/alpha/multibandFilter/"};this.distortionUnit=function(m,e,c){var f={fill:"rgba(0,0,0,1)",font:"4pt Courier New"},a={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b=g._interface.unit.builder(this.distortionUnit,
{name:"distortionUnit",category:"audioEffectUnits",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,y:10},{x:102.5*.55,y:10},{x:102.5/3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,y:10},{x:102.5*.55,y:10},{x:102.5/3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},
{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:102.5,y:61.5,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:61.5,width:10,height:20,isAudioOutput:!0}},{type:"text",name:"outGain_title",data:{x:17.5,y:91,text:"out",style:f}},{type:"text",name:"outGain_0",data:{x:9.5,y:85.5,text:"0",style:a}},{type:"text",
name:"outGain_1/2",data:{x:19,y:57,text:"1/2",style:a}},{type:"text",name:"outGain_1",data:{x:33,y:85.5,text:"1",style:a}},{type:"dial_continuous",name:"outGain_dial",data:{x:22.5,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"distortionAmount_title",data:{x:16.5,y:41.5,text:"dist",style:f}},{type:"text",name:"distortionAmount_0",data:{x:9.5,y:36,text:"0",style:a}},
{type:"text",name:"distortionAmount_50",data:{x:20,y:7.5,text:"50",style:a}},{type:"text",name:"distortionAmount_100",data:{x:33,y:36,text:"100",style:a}},{type:"dial_continuous",name:"distortionAmount_dial",data:{x:22.5,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"resolution_title",data:{x:47,y:66,text:"res",style:f}},{type:"text",name:"resolution_2",data:{x:39,
y:60,text:"2",style:a}},{type:"text",name:"resolution_50",data:{x:49,y:32,text:"500",style:a}},{type:"text",name:"resolution_100",data:{x:63,y:60,text:"1000",style:a}},{type:"dial_continuous",name:"resolution_dial",data:{x:52.5,y:47.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"overSample_title",data:{x:67,y:41.5,text:"overSamp",style:f}},{type:"text",name:"overSample_0",
data:{x:61,y:12,text:"none",style:a}},{type:"text",name:"overSample_50",data:{x:77.5,y:7.5,text:"2x",style:a}},{type:"text",name:"overSample_100",data:{x:90.5,y:12,text:"4x",style:a}},{type:"dial_discrete",name:"overSample_dial",data:{x:80,y:23,r:12,startAngle:1.25*Math.PI,maxAngle:.5*Math.PI,arcDistance:1.35,optionCount:3,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"inGain_title",data:{x:76,y:91,text:"in",style:f}},{type:"text",name:"inGain_0",
data:{x:67,y:85.5,text:"0",style:a}},{type:"text",name:"inGain_1/2",data:{x:76.5,y:57,text:"1/2",style:a}},{type:"text",name:"inGain_1",data:{x:90.5,y:85.5,text:"1",style:a}},{type:"dial_continuous",name:"inGain_dial",data:{x:80,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});b.importData=function(a){b.elements.dial_continuous.outGain_dial.set(a.outGain);b.elements.dial_continuous.distortionAmount_dial.set(a.distortionAmount);
b.elements.dial_continuous.resolution_dial.set(a.resolution);b.elements.dial_discrete.overSample_dial.set(a.overSample);b.elements.dial_continuous.inGain_dial.set(a.inGain)};b.exportData=function(){return{outGain:b.elements.dial_continuous.outGain_dial.get(),distortionAmount:b.elements.dial_continuous.distortionAmount_dial.get(),resolution:b.elements.dial_continuous.resolution_dial.get(),overSample:b.elements.dial_discrete.overSample_dial.get(),inGain:b.elements.dial_continuous.inGain_dial.get()}};
b.distortionCircuit=new g._interface.circuit.distortionUnit(g.library.audio.context);b.elements.connectionNode_audio.audioIn.out().connect(b.distortionCircuit.in());b.distortionCircuit.out().connect(b.elements.connectionNode_audio.audioOut.in());b.elements.dial_continuous.outGain_dial.onchange=function(a){b.distortionCircuit.outGain(a)};b.elements.dial_continuous.distortionAmount_dial.onchange=function(a){b.distortionCircuit.distortionAmount(100*a)};b.elements.dial_continuous.resolution_dial.onchange=
function(a){b.distortionCircuit.resolution(Math.round(1E3*a))};b.elements.dial_discrete.overSample_dial.onchange=function(a){b.distortionCircuit.oversample(["none","2x","4x"][a])};b.elements.dial_continuous.inGain_dial.onchange=function(a){b.distortionCircuit.inGain(2*a)};b.elements.dial_continuous.resolution_dial.set(.5);b.elements.dial_continuous.inGain_dial.set(.5);b.elements.dial_continuous.outGain_dial.set(1);return b};this.distortionUnit.metadata={name:"Distortion Unit",category:"audioEffectUnits",
helpURL:"https://curve.metasophiea.com/help/units/alpha/distortionUnit/"};this.audioScope=function(m,e,c){var f={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},a=g._interface.unit.builder(this.audioScope,{name:"audioScope",category:"humanOutputDevices",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",
name:"input",data:{x:195,y:5,width:10,height:20}},{type:"grapher_audioScope__static",name:"waveport",data:{x:5,y:5,width:150,height:100}},{type:"button_rectangle",name:"holdKey",data:{x:160,y:5,width:30,height:20,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(190,190,190,1)",background__hover_press__fill:"rgba(170,170,170,1)"}}},{type:"text",name:"framerate_name",data:{x:161.5,y:68,text:"framerate",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},{type:"text",
name:"framerate_1",data:{x:162,y:62,text:"1",style:f}},{type:"text",name:"framerate_15",data:{x:172.5,y:32,text:"15",style:f}},{type:"text",name:"framerate_30",data:{x:186,y:62,text:"30",style:f}},{type:"dial_continuous",name:"framerate",data:{x:175,y:47.5,r:12,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});a.elements.button_rectangle.holdKey.onpress=function(){a.elements.grapher_audioScope__static.waveport.stop()};a.elements.button_rectangle.holdKey.onrelease=
function(){a.elements.grapher_audioScope__static.waveport.start()};a.elements.connectionNode_audio.input.out().connect(a.elements.grapher_audioScope__static.waveport.getNode());a.elements.dial_continuous.framerate.onchange=function(b){a.elements.grapher_audioScope__static.waveport.refreshRate(1+Math.floor(29*b))};a.elements.grapher_audioScope__static.waveport.start();a.elements.dial_continuous.framerate.set(0);return a};this.audioScope.metadata={name:"Audio Scope",category:"humanOutputDevices",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioScope/"};
this.audioSink=function(m,e,c){var f={backing:"rgba(10,10,10,1)",levels:["rgb(250,250,250)","rgb(200,200,200)"],markingStyle_fill:"rgba(220,220,220,1)",markingStyle_font:"1pt Courier New"};m=g._interface.unit.builder(this.audioSink,{name:"audioSink",category:"humanOutputDevices",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:30,y:0},{x:30,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:30,y:0},{x:30,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",
name:"audioInput_right",data:{x:30,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"audioInput_left",data:{x:30,y:30,width:10,height:20}},{type:"audio_meter_level",name:"audioLevel_right",data:{x:15,y:5,width:10,height:45,style:f}},{type:"audio_meter_level",name:"audioLevel_left",data:{x:5,y:5,width:10,height:45,style:f}}]});c=g.library.audio.destination;e=new ChannelMergerNode(g.library.audio.context,{numberOfInputs:2});m.elements.connectionNode_audio.audioInput_left.out().connect(m.elements.audio_meter_level.audioLevel_left.audioIn());
m.elements.connectionNode_audio.audioInput_right.out().connect(m.elements.audio_meter_level.audioLevel_right.audioIn());m.elements.connectionNode_audio.audioInput_left.out().connect(e,0,0);m.elements.connectionNode_audio.audioInput_right.out().connect(e,0,1);e.connect(c);m.elements.audio_meter_level.audioLevel_left.start();m.elements.audio_meter_level.audioLevel_right.start();return m};this.audioSink.metadata={name:"Audio Sink",category:"humanOutputDevices",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioSink/"};
this.basicSynthesizer=function(m,e,c){var f={fill:"rgba(0,0,0,1)",font:"4pt Courier New"},a={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b={fill:"rgba(220,220,220,1)"},d={fill:"rgba(50,50,50,1)"},h={fill:"rgba(250,150,150,1)"},l=g._interface.unit.builder(this.basicSynthesizer,{name:"basicSynthesizer",category:"synthesizers",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:240,
y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-15,y:5,width:15,height:30,isAudioOutput:!0}},{type:"connectionNode_data",name:"port_gain",data:{x:12.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":l.elements.dial_continuous.gain.set(b);break;case "%t":l.__synthesizer.gain(b.target,b.time,b.curve),l.elements.dial_continuous.gain.smoothSet(b.target,b.time,b.curve,!1)}}}},{type:"connectionNode_data",
name:"port_attack",data:{x:52.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&l.elements.dial_continuous.attack.set(b)}}},{type:"connectionNode_data",name:"port_release",data:{x:92.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&l.elements.dial_continuous.release.set(b)}}},{type:"connectionNode_data",name:"port_detune",data:{x:132.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":l.elements.dial_continuous.detune.set(b);break;case "%t":l.__synthesizer.detune(200*
b.target+-100,b.time,b.curve),l.elements.dial_continuous.detune.smoothSet(b.target,b.time,b.curve,!1)}}}},{type:"connectionNode_data",name:"port_octave",data:{x:170.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&l.elements.dial_discrete.octave.select(b)}}},{type:"connectionNode_data",name:"port_waveType",data:{x:210.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&l.elements.dial_discrete.waveType.select(b)}}},{type:"connectionNode_data",name:"port_periodicWave",
data:{x:240,y:12.5,width:7.5,height:15,onreceive:function(a,b){"periodicWave"==a&&l.__synthesizer.periodicWave(b)}}},{type:"connectionNode_data",name:"port_midiNote",data:{x:225,y:55,width:15,height:30,angle:Math.PI/4,onreceive:function(a,b){"midinumber"==a&&l.__synthesizer.perform(b)}}},{type:"connectionNode_data",name:"port_gainWobblePeriod",data:{x:22.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&l.elements.dial_continuous.gainWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_gainWobbleDepth",
data:{x:57.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&l.elements.dial_continuous.gainWobbleDepth.set(b)}}},{type:"connectionNode_data",name:"port_detuneWobblePeriod",data:{x:107.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&l.elements.dial_continuous.detuneWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_detuneWobbleDepth",data:{x:142.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&l.elements.dial_continuous.detuneWobbleDepth.set(b)}}},{type:"text",
name:"gain_gain",data:{x:13,y:43,text:"gain",style:f}},{type:"text",name:"gain_0",data:{x:7,y:37,text:"0",style:a}},{type:"text",name:"gain_1/2",data:{x:16.5,y:8,text:"1/2",style:a}},{type:"text",name:"gain_1",data:{x:31,y:37,text:"1",style:a}},{type:"dial_continuous",name:"dial_gain",data:{x:20,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"attack_gain",data:{x:50,y:43,text:"attack",style:f}},{type:"text",
name:"attack_0",data:{x:47,y:37,text:"0",style:a}},{type:"text",name:"attack_5",data:{x:58.75,y:8,text:"5",style:a}},{type:"text",name:"attack_10",data:{x:71,y:37,text:"10",style:a}},{type:"dial_continuous",name:"dial_attack",data:{x:60,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"release_gain",data:{x:89,y:43,text:"release",style:f}},{type:"text",name:"release_0",data:{x:87,y:37,text:"0",style:a}},{type:"text",
name:"release_5",data:{x:98.75,y:8,text:"5",style:a}},{type:"text",name:"release_10",data:{x:111,y:37,text:"10",style:a}},{type:"dial_continuous",name:"dial_release",data:{x:100,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"detune_gain",data:{x:131,y:43,text:"detune",style:f}},{type:"text",name:"detune_-100",data:{x:122,y:37,text:"-100",style:a}},{type:"text",name:"detune_0",data:{x:138.75,y:8,text:"0",style:a}},
{type:"text",name:"detune_100",data:{x:148,y:37,text:"100",style:a}},{type:"dial_continuous",name:"dial_detune",data:{x:140,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,value:.5,resetValue:.5,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"octave_gain",data:{x:170,y:43,text:"octave",style:f}},{type:"text",name:"octave_-3",data:{x:165,y:35,text:"-3",style:a}},{type:"text",name:"octave_-2",data:{x:161,y:24,text:"-2",style:a}},{type:"text",name:"octave_-1",data:{x:165,
y:13,text:"-1",style:a}},{type:"text",name:"octave_0",data:{x:178.75,y:8,text:"0",style:a}},{type:"text",name:"octave_1",data:{x:190,y:13,text:"1",style:a}},{type:"text",name:"octave_2",data:{x:195,y:24,text:"2",style:a}},{type:"text",name:"octave_3",data:{x:190,y:35,text:"3",style:a}},{type:"dial_discrete",name:"dial_octave",data:{x:180,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:7,value:3,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"waveType_gain",data:{x:214,y:43,
text:"wave",style:f}},{type:"text",name:"waveType_sin",data:{x:202,y:35,text:"sin",style:a}},{type:"text",name:"waveType_tri",data:{x:199,y:21,text:"tri",style:a}},{type:"text",name:"waveType_squ",data:{x:210,y:9,text:"squ",style:a}},{type:"text",name:"waveType_saw",data:{x:227,y:10,text:"saw",style:a}},{type:"rectangle",name:"periodicWaveType",data:{x:232,y:21.75,angle:0,width:8,height:2.5,style:f}},{type:"dial_discrete",name:"dial_waveType",data:{x:220,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:5*
Math.PI/4,optionCount:5,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"gainWobble",data:{x:13,y:70,angle:-Math.PI/2,text:"gain",style:a}},{type:"text",name:"gainWobblePeriod_gain",data:{x:23,y:84,text:"rate",style:f}},{type:"text",name:"gainWobblePeriod_0",data:{x:17,y:79,text:"0",style:a}},{type:"text",name:"gainWobblePeriod_50",data:{x:27.5,y:50,text:"50",style:a}},{type:"text",name:"gainWobblePeriod_100",data:{x:41,y:79,text:"100",style:a}},{type:"dial_continuous",name:"dial_gainWobblePeriod",
data:{x:30,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"gainWobbleDepth_gain",data:{x:57,y:84,text:"depth",style:f}},{type:"text",name:"gainWobbleDepth_0",data:{x:52,y:79,text:"0",style:a}},{type:"text",name:"gainWobbleDepth_50",data:{x:61,y:50,text:"1/2",style:a}},{type:"text",name:"gainWobbleDepth_100",data:{x:76,y:79,text:"1",style:a}},{type:"dial_continuous",name:"dial_gainWobbleDepth",data:{x:65,y:65,r:12,startAngle:3*
Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"detuneWobble",data:{x:98,y:70,angle:-Math.PI/2,text:"detune",style:a}},{type:"text",name:"detuneWobblePeriod_gain",data:{x:108,y:84,text:"rate",style:f}},{type:"text",name:"detuneWobblePeriod_0",data:{x:101,y:79,text:"0",style:a}},{type:"text",name:"detuneWobblePeriod_50",data:{x:111.5,y:50,text:"50",style:a}},{type:"text",name:"detuneWobblePeriod_100",data:{x:125,y:79,text:"100",style:a}},{type:"dial_continuous",
name:"dial_detuneWobblePeriod",data:{x:114,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:b,slot:d,needle:h}}},{type:"text",name:"detuneWobbleDepth_gain",data:{x:141,y:84,text:"depth",style:f}},{type:"text",name:"detuneWobbleDepth_0",data:{x:136,y:79,text:"0",style:a}},{type:"text",name:"detuneWobbleDepth_50",data:{x:145.5,y:50,text:"1/2",style:a}},{type:"text",name:"detuneWobbleDepth_100",data:{x:160,y:79,text:"1",style:a}},{type:"dial_continuous",name:"dial_detuneWobbleDepth",
data:{x:149,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:b,slot:d,needle:h}}},{type:"button_rectangle",name:"panicButton",data:{x:197.5,y:47.5,width:20,height:20,angle:Math.PI/4,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"}}}]});l.exportData=function(){return{gain:l.elements.dial_continuous.dial_gain.get(),attack:10*l.elements.dial_continuous.dial_attack.get(),
release:10*l.elements.dial_continuous.dial_release.get(),detune:100*(2*l.elements.dial_continuous.dial_detune.get()-1),octave:l.elements.dial_discrete.dial_octave.get()-3,waveType:["sine","triangle","square","sawtooth","custom"][l.elements.dial_discrete.dial_waveType.get()],gainWobble:{rate:100*l.elements.dial_continuous.dial_gainWobblePeriod.get(),depth:l.elements.dial_continuous.dial_gainWobbleDepth.get()},detuneWobble:{rate:100*l.elements.dial_continuous.dial_detuneWobblePeriod.get(),depth:l.elements.dial_continuous.dial_detuneWobbleDepth.get()}}};
l.importData=function(a){void 0!=a&&(l.elements.dial_continuous.dial_gain.set(a.gain),l.elements.dial_continuous.dial_attack.set(a.attack/10),l.elements.dial_continuous.dial_release.set(a.release/10),l.elements.dial_continuous.dial_detune.set((1+a.detune/100)/2),l.elements.dial_discrete.dial_octave.set(a.octave+3),l.elements.dial_discrete.dial_waveType.set(["sine","triangle","square","sawtooth","custom"].indexOf(a.waveType)),l.elements.dial_continuous.dial_gainWobblePeriod.set(a.gainWobble.rate/100),
l.elements.dial_continuous.dial_gainWobbleDepth.set(a.gainWobble.depth),l.elements.dial_continuous.dial_detuneWobblePeriod.set(a.detuneWobble.rate/100),l.elements.dial_continuous.dial_detuneWobbleDepth.set(a.detuneWobble.depth))};l.__synthesizer=new g._interface.circuit.synthesizer(g.library.audio.context);l.__synthesizer.out().connect(l.elements.connectionNode_audio.audioOut.in());l.elements.dial_continuous.dial_gain.onchange=function(a){l.__synthesizer.gain(a)};l.elements.dial_continuous.dial_attack.onchange=
function(a){l.__synthesizer.attack(a)};l.elements.dial_continuous.dial_release.onchange=function(a){l.__synthesizer.release(a)};l.elements.dial_continuous.dial_detune.onchange=function(a){l.__synthesizer.detune(200*a+-100)};l.elements.dial_discrete.dial_octave.onchange=function(a){l.__synthesizer.octave(a-3)};l.elements.dial_discrete.dial_waveType.onchange=function(a){l.__synthesizer.waveType(["sine","triangle","square","sawtooth","custom"][a])};l.elements.dial_continuous.dial_gainWobblePeriod.onchange=
function(a){l.__synthesizer.gainWobblePeriod(.01>1-a?.011:1-a)};l.elements.dial_continuous.dial_gainWobbleDepth.onchange=function(a){l.__synthesizer.gainWobbleDepth(a)};l.elements.dial_continuous.dial_detuneWobblePeriod.onchange=function(a){l.__synthesizer.detuneWobblePeriod(.01>1-a?.011:1-a)};l.elements.dial_continuous.dial_detuneWobbleDepth.onchange=function(a){l.__synthesizer.detuneWobbleDepth(100*a)};l.elements.button_rectangle.panicButton.onpress=function(){l.__synthesizer.panic()};l.i={gain:function(a){l.elements.dial_continuous.dial_gain.set(a)},
attack:function(a){l.elements.dial_continuous.dial_attack.set(a)},release:function(a){l.elements.dial_continuous.dial_release.set(a)},detune:function(a){l.elements.dial_continuous.dial_detune.set(a)},octave:function(a){l.elements.dial_discrete.dial_octave.set(a)},waveType:function(a){l.elements.dial_discrete.dial_waveType.set(a)},periodicWave:function(a){l.__synthesizer.periodicWave(a)},midiNote:function(a){l.__synthesizer.perform(a)},gainWobblePeriod:function(a){l.elements.dial_continuous.dial_gainWobblePeriod.set(a)},
gainWobbleDepth:function(a){l.elements.dial_continuous.dial_gainWobbleDepth.set(a)},detuneWobblePeriod:function(a){l.elements.dial_continuous.dial_detuneWobblePeriod.set(a)},detuneWobbleDepth:function(a){l.elements.dial_continuous.dial_detuneWobbleDepth.set(a)}};l.elements.dial_continuous.dial_gain.set(.5);l.elements.dial_continuous.dial_detune.set(.5);l.elements.dial_discrete.dial_octave.set(3);return l};this.basicSynthesizer.metadata={name:"Basic Synthesizer",category:"synthesizer",helpURL:"https://curve.metasophiea.com/help/units/alpha/basicSynthesizer/"};
this.basicSynthesizer_img=function(m,e,c){var f=g._interface.unit.builder(this.basicSynthesizer_img,{name:"basicSynthesizer_img",category:"synthesizers",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],elements:[{type:"image",name:"imgBacking",data:{x:0,y:0,width:240,height:90,url:"images/units/alpha/basicSynthesizer_2.png",points:[{x:0,y:0},{x:1,y:0},{x:1,y:4/9},{x:19/24,y:1},{x:0,y:1}]}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,
x:-15,y:5,width:15,height:30,isAudioOutput:!0}},{type:"connectionNode_data",name:"port_gain",data:{x:12.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":f.elements.dial_continuous_image.gain.set(b);break;case "%t":f.__synthesizer.gain(b.target,b.time,b.curve),f.elements.dial_continuous_image.gain.smoothSet(b.target,b.time,b.curve,!1)}}}},{type:"connectionNode_data",name:"port_attack",data:{x:52.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&f.elements.dial_continuous_image.attack.set(b)}}},
{type:"connectionNode_data",name:"port_release",data:{x:92.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&f.elements.dial_continuous_image.release.set(b)}}},{type:"connectionNode_data",name:"port_detune",data:{x:132.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":f.elements.dial_continuous_image.detune.set(b);break;case "%t":f.__synthesizer.detune(200*b.target+-100,b.time,b.curve),f.elements.dial_continuous_image.detune.smoothSet(b.target,b.time,b.curve,!1)}}}},
{type:"connectionNode_data",name:"port_octave",data:{x:170.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&f.elements.dial_discrete_image.octave.select(b)}}},{type:"connectionNode_data",name:"port_waveType",data:{x:210.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&f.elements.dial_discrete_image.waveType.select(b)}}},{type:"connectionNode_data",name:"port_periodicWave",data:{x:240,y:12.5,width:7.5,height:15,onreceive:function(a,b){"periodicWave"==a&&f.__synthesizer.periodicWave(b)}}},
{type:"connectionNode_data",name:"port_midiNote",data:{x:225,y:55,width:15,height:30,angle:Math.PI/4,onreceive:function(a,b){"midinumber"==a&&f.__synthesizer.perform(b)}}},{type:"connectionNode_data",name:"port_gainWobblePeriod",data:{x:22.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&f.elements.dial_continuous_image.gainWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_gainWobbleDepth",data:{x:57.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&f.elements.dial_continuous_image.gainWobbleDepth.set(b)}}},
{type:"connectionNode_data",name:"port_detuneWobblePeriod",data:{x:107.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&f.elements.dial_continuous_image.detuneWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_detuneWobbleDepth",data:{x:142.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&f.elements.dial_continuous_image.detuneWobbleDepth.set(b)}}},{type:"dial_continuous_image",name:"dial_gain",data:{x:20,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,
resetValue:.5,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_continuous_image",name:"dial_attack",data:{x:60,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},
{type:"dial_continuous_image",name:"dial_release",data:{x:100,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_continuous_image",name:"dial_detune",data:{x:140,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,value:.5,resetValue:.5,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",
slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_discrete_image",name:"dial_octave",data:{x:180,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:7,value:3,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_discrete_image",name:"dial_waveType",
data:{x:220,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:5*Math.PI/4,optionCount:5,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_continuous_image",name:"dial_gainWobblePeriod",data:{x:30,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",
needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_continuous_image",name:"dial_gainWobbleDepth",data:{x:65,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_continuous_image",name:"dial_detuneWobblePeriod",data:{x:114,y:65,r:12,startAngle:3*Math.PI/
4,maxAngle:1.5*Math.PI,arcDistance:1.2,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"dial_continuous_image",name:"dial_detuneWobbleDepth",data:{x:149,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,handleURL:"images/units/alpha/basicSynthesizer_2_dial_handle.png",slotURL:"images/units/alpha/basicSynthesizer_2_dial_slot.png",
needleURL:"images/units/alpha/basicSynthesizer_2_dial_needle.png"}},{type:"button_rectangle",name:"panicButton",data:{x:197.5,y:47.5,width:20,height:20,angle:Math.PI/4,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"}}}]});f.exportData=function(){return{gain:f.elements.dial_continuous_image.dial_gain.get(),attack:10*f.elements.dial_continuous_image.dial_attack.get(),release:10*f.elements.dial_continuous_image.dial_release.get(),
detune:100*(2*f.elements.dial_continuous_image.dial_detune.get()-1),octave:f.elements.dial_discrete_image.dial_octave.get()-3,waveType:["sine","triangle","square","sawtooth","custom"][f.elements.dial_discrete_image.dial_waveType.get()],gainWobble:{rate:100*f.elements.dial_continuous_image.dial_gainWobblePeriod.get(),depth:f.elements.dial_continuous_image.dial_gainWobbleDepth.get()},detuneWobble:{rate:100*f.elements.dial_continuous_image.dial_detuneWobblePeriod.get(),depth:f.elements.dial_continuous_image.dial_detuneWobbleDepth.get()}}};
f.importData=function(a){void 0!=a&&(f.elements.dial_continuous_image.dial_gain.set(a.gain),f.elements.dial_continuous_image.dial_attack.set(a.attack/10),f.elements.dial_continuous_image.dial_release.set(a.release/10),f.elements.dial_continuous_image.dial_detune.set((1+a.detune/100)/2),f.elements.dial_discrete_image.dial_octave.set(a.octave+3),f.elements.dial_discrete_image.dial_waveType.set(["sine","triangle","square","sawtooth","custom"].indexOf(a.waveType)),f.elements.dial_continuous_image.dial_gainWobblePeriod.set(a.gainWobble.rate/
100),f.elements.dial_continuous_image.dial_gainWobbleDepth.set(a.gainWobble.depth),f.elements.dial_continuous_image.dial_detuneWobblePeriod.set(a.detuneWobble.rate/100),f.elements.dial_continuous_image.dial_detuneWobbleDepth.set(a.detuneWobble.depth))};f.__synthesizer=new g._interface.circuit.synthesizer(g.library.audio.context);f.__synthesizer.out().connect(f.elements.connectionNode_audio.audioOut.in());f.elements.dial_continuous_image.dial_gain.onchange=function(a){f.__synthesizer.gain(a)};f.elements.dial_continuous_image.dial_attack.onchange=
function(a){f.__synthesizer.attack(a)};f.elements.dial_continuous_image.dial_release.onchange=function(a){f.__synthesizer.release(a)};f.elements.dial_continuous_image.dial_detune.onchange=function(a){f.__synthesizer.detune(200*a+-100)};f.elements.dial_discrete_image.dial_octave.onchange=function(a){f.__synthesizer.octave(a-3)};f.elements.dial_discrete_image.dial_waveType.onchange=function(a){f.__synthesizer.waveType(["sine","triangle","square","sawtooth","custom"][a])};f.elements.dial_continuous_image.dial_gainWobblePeriod.onchange=
function(a){f.__synthesizer.gainWobblePeriod(.01>1-a?.011:1-a)};f.elements.dial_continuous_image.dial_gainWobbleDepth.onchange=function(a){f.__synthesizer.gainWobbleDepth(a)};f.elements.dial_continuous_image.dial_detuneWobblePeriod.onchange=function(a){f.__synthesizer.detuneWobblePeriod(.01>1-a?.011:1-a)};f.elements.dial_continuous_image.dial_detuneWobbleDepth.onchange=function(a){f.__synthesizer.detuneWobbleDepth(100*a)};f.elements.button_rectangle.panicButton.onpress=function(){f.__synthesizer.panic()};
f.i={gain:function(a){f.elements.dial_continuous_image.dial_gain.set(a)},attack:function(a){f.elements.dial_continuous_image.dial_attack.set(a)},release:function(a){f.elements.dial_continuous_image.dial_release.set(a)},detune:function(a){f.elements.dial_continuous_image.dial_detune.set(a)},octave:function(a){f.elements.dial_discrete_image.dial_octave.set(a)},waveType:function(a){f.elements.dial_discrete_image.dial_waveType.set(a)},periodicWave:function(a){f.__synthesizer.periodicWave(a)},midiNote:function(a){f.__synthesizer.perform(a)},
gainWobblePeriod:function(a){f.elements.dial_continuous_image.dial_gainWobblePeriod.set(a)},gainWobbleDepth:function(a){f.elements.dial_continuous_image.dial_gainWobbleDepth.set(a)},detuneWobblePeriod:function(a){f.elements.dial_continuous_image.dial_detuneWobblePeriod.set(a)},detuneWobbleDepth:function(a){f.elements.dial_continuous_image.dial_detuneWobbleDepth.set(a)}};f.elements.dial_continuous_image.dial_gain.set(.5);f.elements.dial_continuous_image.dial_detune.set(.5);f.elements.dial_discrete_image.dial_octave.set(3);
return f};this.basicSynthesizer_img.metadata={name:"Basic Synthesizer With Image",dev:!0,category:"synthesizer",helpURL:"https://curve.metasophiea.com/help/units/alpha/basicSynthesizer_img/"};this.audioIn=function(m,e,c,f){function a(a){if(0==b.deviceList.length)q.elements.readout_sixteenSegmentDisplay__static.index.text(" n/a"),q.elements.readout_sixteenSegmentDisplay__static.index.print(),q.elements.readout_sixteenSegmentDisplay__static.text.text("no devices"),q.elements.readout_sixteenSegmentDisplay__static.text.print("smart");
else if(!(0>a||a>=b.deviceList.length)){b.currentSelection=a;for(selectionNum=""+(a+1);2>selectionNum.length;)selectionNum="0"+selectionNum;for(totalNum=""+b.deviceList.length;2>totalNum.length;)totalNum="0"+totalNum;q.elements.readout_sixteenSegmentDisplay__static.index.text(selectionNum+"/"+totalNum);q.elements.readout_sixteenSegmentDisplay__static.index.print();var c=b.deviceList[a].deviceId;0<b.deviceList[a].label.length&&(c=b.deviceList[a].label+" - "+c);q.elements.readout_sixteenSegmentDisplay__static.text.text(c);
q.elements.readout_sixteenSegmentDisplay__static.text.print("smart");q.circuitry.unit.selectDevice(b.deviceList[a].deviceId)}}f=void 0===f?!0:f;var b={deviceList:[],currentSelection:0},d={stroke:"rgb(160,160,160)",lineWidth:1},h={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},l={background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"},k={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(230,230,230,1)",background__hover_press__fill:"rgba(180,180,180,1)"},q=g._interface.unit.builder(this.audioIn,
{name:"audioIn",category:"humanInputDevices",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},{x:50,y:40},{x:37.5,y:50},{x:22.5,y:50},{x:10,y:40},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},{x:50,y:40},{x:37.5,y:50},{x:22.5,y:50},{x:10,y:40},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",
name:"audioOut",data:{x:-10,y:15,width:10,height:20,isAudioOutput:!0}},{type:"readout_sixteenSegmentDisplay__static",name:"index",data:{x:70,y:15,angle:0,width:50,height:20,count:5,style:l}},{type:"readout_sixteenSegmentDisplay__static",name:"text",data:{x:122.5,y:15,angle:0,width:100,height:20,count:10,style:l}},{type:"button_rectangle",name:"up",data:{x:225,y:15,width:15,height:10,selectable:!1,style:k,onpress:function(){a(b.currentSelection+1)}}},{type:"button_rectangle",name:"down",data:{x:225,
y:25,width:15,height:10,selectable:!1,style:k,onpress:function(){a(b.currentSelection-1)}}},{type:"text",name:"gainLabel_name",data:{x:21.25,y:44,text:"gain",style:{fill:"rgba(0,0,0,1)",font:"5pt Courier New"},angle:0}},{type:"text",name:"gainLabel_0",data:{x:17,y:39,text:"0",style:h,angle:0}},{type:"text",name:"gainLabel_1",data:{x:28.75,y:10,text:"1",style:h,angle:0}},{type:"text",name:"gainLabel_2",data:{x:40.5,y:39,text:"2",style:h,angle:0}},{type:"dial_continuous",name:"outputGain",data:{x:30,
y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},resetValue:.5}},{type:"path",name:"upArrow",data:{points:[{x:227.5,y:22.5},{x:232.5,y:17.5},{x:237.5,y:22.5}],style:d}},{type:"path",name:"downArrow",data:{points:[{x:227.5,y:27.5},{x:232.5,y:32.5},{x:237.5,y:27.5}],style:d}},{type:"audio_meter_level",name:"audioIn",data:{x:50,y:15,width:17.5,height:20}}]});q.onkeydown=function(a,b,c){switch(c.key){case "ArrowUp":q.elements.button_rectangle.up.press();
break;case "ArrowDown":q.elements.button_rectangle.down.press();break;case "ArrowLeft":q.elements.dial_continuous.outputGain.set(q.elements.dial_continuous.outputGain.get()-.1);break;case "ArrowRight":q.elements.dial_continuous.outputGain.set(q.elements.dial_continuous.outputGain.get()+.1)}};q.circuitry={unit:new g._interface.circuit.audioIn(g.library.audio.context,f)};q.circuitry.unit.out().connect(q.elements.connectionNode_audio.audioOut.in());q.circuitry.unit.out().connect(q.elements.audio_meter_level.audioIn.audioIn());
q.elements.dial_continuous.outputGain.onchange=function(a){q.circuitry.unit.gain(2*a)};q.circuitry.unit.listDevices(function(a){b.deviceList=a});f&&setTimeout(function(){a(0)},500);q.elements.dial_continuous.outputGain.set(.5);q.elements.audio_meter_level.audioIn.start();return q};this.audioIn.metadata={name:"Audio Input",category:"humanInputDevices",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioInput/"};this.musicalKeyboard=function(m,e,c){var f=.5,a={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},
b={background__up__fill:"rgba(250,250,250,1)",background__press__fill:"rgba(230,230,230,1)",background__glow__fill:"rgba(220,200,220,1)",background__glow_press__fill:"rgba(200,150,200,1)"},d={background__up__fill:"rgba(50,50,50,1)",background__press__fill:"rgba(100,100,100,1)",background__glow__fill:"rgba(220,200,220,1)",background__glow_press__fill:"rgba(200,150,200,1)"};m={name:"musicalKeyboard",category:"humanInputDevices",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},
{x:0,y:62.5}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},{x:0,y:62.5}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"midiout",data:{x:-5,y:5,width:5,height:10}},{type:"connectionNode_data",name:"midiin",data:{x:320,y:5,width:5,height:10,onreceive:function(a,b){"midinumber"==a&&(0<b.velocity?k.elements.button_rectangle[g.library.audio.num2name(b.num)].press():k.elements.button_rectangle[g.library.audio.num2name(b.num)].release())}}},
{type:"text",name:"velocity_title",data:{x:5,y:59,text:"velocity",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},{type:"text",name:"velocity_0",data:{x:4,y:55,text:"0",style:a}},{type:"text",name:"velocity_1/2",data:{x:14,y:26.5,text:"1/2",style:a}},{type:"text",name:"velocity_1",data:{x:29,y:55,text:"1",style:a}},{type:"dial_continuous",name:"velocity_dial",data:{x:17.5,y:42,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,resetValue:.5,value:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",
needle:"rgba(250,150,150,1)"},onchange:function(a){f=a}}}]};var h="\\azsxcfvgbhnmk,l./1q2w3er5t6yu8i9o0p[".split(""),l="4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C".split(" ");a=35;e=45;for(c=0;c<h.length;c++)"#"!=l[c].slice(-1)&&(m.elements.push({type:"button_rectangle",name:l[c],data:{x:a,y:12.5,width:12.5,height:50,hoverable:!1,style:b,onpress:function(){k.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),
velocity:f})},onrelease:function(){k.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),velocity:0})}}}),a+=12.5);for(c=b=0;c<h.length;c++)"#"==l[c].slice(-1)?(m.elements.push({type:"button_rectangle",name:l[c],data:{x:e,y:12.5,width:5,height:30,hoverable:!1,style:d,onpress:function(){k.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),velocity:f})},onrelease:function(){k.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),velocity:0})}}}),
e+=12.5,b=0):b++,1<b&&(e+=12.5);var k=g._interface.unit.builder(this.musicalKeyboard,m);k.onkeydown=function(a,b,c){h.includes(c.key)&&k.elements.button_rectangle[l[h.indexOf(c.key)]].press()};k.onkeyup=function(a,b,c){h.includes(c.key)&&k.elements.button_rectangle[l[h.indexOf(c.key)]].release()};k.i={velocity:function(a){k.elements.dial_continuous.velocity.set(a)}};return k};this.musicalKeyboard.metadata={name:"Musical Keyboard",category:"humanInputDevices",helpURL:"https://curve.metasophiea.com/help/units/alpha/musicalKeyboard/"};
this.recorder=function(m,e,c){function f(a){if("empty"!=h||"save"!=a&&"stop"!=a){if("stop"==a||"save"==a)h="full";"empty"==h&&"rec"==a&&(h="recording");"clear"==a&&(h="empty");"recording"==h&&"pause/resume"==a?h="paused":"paused"!=h||"pause/resume"!=a&&"rec"!=a||(h="recording");if("empty"==h)d.elements.glowbox_rect.activityLight_empty.on();else d.elements.glowbox_rect.activityLight_empty.off();if("recording"==h)d.elements.glowbox_rect.activityLight_recording.on();else d.elements.glowbox_rect.activityLight_recording.off();
if("paused"==h)d.elements.glowbox_rect.activityLight_paused.on();else d.elements.glowbox_rect.activityLight_paused.off();if("full"==h)d.elements.glowbox_rect.activityLight_full.on();else d.elements.glowbox_rect.activityLight_full.off()}}var a={fill:"rgba(0,0,0,1)",font:"4pt Courier New"},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},d=g._interface.unit.builder(this.recorder,{name:"recorder",category:"audioFile",
collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:175,y:0},{x:175,y:40},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:175,y:0},{x:175,y:40},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"inRight",data:{x:175,y:2.5,width:10,height:15}},{type:"connectionNode_audio",name:"inLeft",data:{x:175,y:22.5,width:10,height:15}},{type:"rectangle",name:"logo_rect",data:{x:135,y:27.5,angle:-.25,width:35,height:10,style:{fill:"rgb(230,230,230)"}}},
{type:"text",name:"logo_label",data:{x:139,y:34.5,angle:-.25,text:"REcorder",style:{fill:"rgba(100,100,100,1)",font:"6pt Bookman"}}},{type:"button_rectangle",name:"rec",data:{x:5,y:25,width:20,height:10,style:b,onpress:function(){"paused"==h?d.recorder.resume():d.recorder.start();f("rec")}}},{type:"text",name:"button_rectangle_text",data:{x:10.5,y:31.5,text:"rec",angle:0,style:a}},{type:"button_rectangle",name:"pause/resume",data:{x:27.5,y:25,width:20,height:10,style:b,onpress:function(){"paused"==
h?d.recorder.resume():d.recorder.pause();f("pause/resume")}}},{type:"text",name:"button_pause/resume_text",data:{x:30,y:31.5,text:"pause",angle:0,style:a}},{type:"button_rectangle",name:"stop",data:{x:50,y:25,width:20,height:10,style:b,onpress:function(){f("stop");d.recorder.stop()}}},{type:"text",name:"button_stop_text",data:{x:54,y:31.5,text:"stop",angle:0,style:a}},{type:"button_rectangle",name:"save",data:{x:72.5,y:25,width:20,height:10,style:b,onpress:function(){f("save");"empty"!=h&&d.recorder.save()}}},
{type:"text",name:"button_save_text",data:{x:76.5,y:31.5,text:"save",angle:0,style:a}},{type:"button_rectangle",name:"clear",data:{x:95,y:25,width:20,height:10,style:b,onpress:function(){f("clear");d.recorder.clear()}}},{type:"text",name:"button_clear_text",data:{x:97.5,y:31.5,text:"clear",angle:0,style:a}},{type:"readout_sixteenSegmentDisplay__static",name:"time",data:{x:70,y:5,angle:0,width:100,height:15,count:11,style:{background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"}}},{type:"glowbox_rect",
name:"activityLight_recording",data:{x:5,y:5,width:15,height:15,style:{glow:"rgb(255, 63, 63)",dim:"rgb(25, 6, 6)"}}},{type:"text",name:"activityLight_recording_text",data:{x:8,y:14,text:"rec",angle:0,style:a}},{type:"glowbox_rect",name:"activityLight_paused",data:{x:20,y:5,width:15,height:15,style:{glow:"rgb(126, 186, 247)",dim:"rgb(12, 18, 24)"}}},{type:"text",name:"activityLight_paused_text",data:{x:23,y:14,text:"pau",angle:0,style:a}},{type:"glowbox_rect",name:"activityLight_empty",data:{x:35,
y:5,width:15,height:15,style:{glow:"rgb(199, 249, 244)",dim:"rgb(19, 24, 24)"}}},{type:"text",name:"activityLight_empty_text",data:{x:38,y:14,text:"emp",angle:0,style:a}},{type:"glowbox_rect",name:"activityLight_full",data:{x:50,y:5,width:15,height:15,style:{glow:"rgb(61, 224, 35)",dim:"rgb(6, 22, 3)"}}},{type:"text",name:"activityLight_full_text",data:{x:53,y:14,text:"ful",angle:0,style:a}}]});setInterval(function(){var a=d.recorder.recordingTime(),b=a%1;a=g.library.math.seconds2time(Math.round(a));
d.elements.readout_sixteenSegmentDisplay__static.time.text(g.library.misc.padString(a.h,2,"0")+":"+g.library.misc.padString(a.m,2,"0")+":"+g.library.misc.padString(a.s,2,"0")+"."+g.library.misc.padString((""+b).slice(2),2,"0"));d.elements.readout_sixteenSegmentDisplay__static.time.print()},100);var h="empty";f("clear");d.elements.glowbox_rect.activityLight_empty.on();d.recorder=new g._interface.circuit.recorder(g.library.audio.context);d.elements.connectionNode_audio.inRight.out().connect(d.recorder.in_right());
d.elements.connectionNode_audio.inLeft.out().connect(d.recorder.in_left());return d};this.recorder.metadata={name:"Recorder",category:"audioFile",helpURL:"https://curve.metasophiea.com/help/units/alpha/recorder/"};this.looper=function(m,e,c){var f={fill:"rgba(200,200,200,1)"},a={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},b=g._interface.unit.builder(this.looper,{name:"looper",category:"audioFile",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],
elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:f}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,onreceive:function(a,c){b.elements.button_rectangle.fire.press()}}},{type:"circle",name:"symbol_outterCircle1",
data:{x:11.5,y:41,r:6,style:a}},{type:"circle",name:"symbol_outterCircle2",data:{x:18.5,y:41,r:6,style:a}},{type:"rectangle",name:"symbol_blockingrect",data:{x:11.5,y:34,width:7,height:15,style:f}},{type:"path",name:"symbol_upperarrow",data:{points:[{x:13.5,y:32.5},{x:16.5,y:35},{x:13.5,y:37.5}],style:a}},{type:"path",name:"symbol_lowerarrow",data:{points:[{x:16.5,y:44.75},{x:13.5,y:47.25},{x:16.5,y:49.75}],style:a}},{type:"button_rectangle",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",
background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){b.looper.load("file",function(a){b.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(b.looper.waveformSegment())})}}},{type:"button_rectangle",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){if(!(0>b.looper.duration())){b.looper.start();
var a=b.looper.duration();d&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),clearTimeout(h));k=void 0;l=0;var c=Math.floor(a),e=c/(1E3*a);h=setInterval(function(){void 0!=k&&b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);k=l;l+=e;b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);1<l&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),l=0,k=void 0)},c);d=!0}}}},{type:"button_rectangle",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",
background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){b.looper.stop();d&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),d=!1,l=void 0,clearTimeout(h))}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]}),d=!1,h=void 0,l=void 0,k=void 0;b.looper=new g._interface.circuit.looper(g.library.audio.context);b.looper.out_right().connect(b.elements.connectionNode_audio.outRight.in());
b.looper.out_left().connect(b.elements.connectionNode_audio.outLeft.in());return b};this.looper.metadata={name:"Looper",category:"audioFile",helpURL:"https://curve.metasophiea.com/help/units/alpha/looper/"};this.oneShot_single=function(m,e,c){var f={fill:"rgba(150,150,150,1)"},a={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},b=g._interface.unit.builder(this.oneShot_single,{name:"oneShot_single",category:"audioFile",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:220,y:0},{x:220,
y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,onreceive:function(a,c){b.elements.button_rectangle.fire.press();
b.elements.button_rectangle.fire.release()}}},{type:"path",name:"symbol_arrow",data:{points:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:a}},{type:"rectangle",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:f}},{type:"circle",name:"symbol_outerCircle",data:{x:10,y:40,r:5.5,style:a}},{type:"rectangle",name:"symbol_1",data:{x:9.5,y:37.5,width:1,height:5,style:f}},{type:"button_rectangle",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",
background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){b.oneShot.load("file",function(a){b.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(b.oneShot.waveformSegment())})}}},{type:"button_rectangle",name:"fire",data:{x:5,y:17.5,width:20,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){if(!(0>b.oneShot.duration())){b.oneShot.fire();var a=b.oneShot.duration();
d&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),clearTimeout(h));k=void 0;l=0;var c=10/(1E3*a);h=setInterval(function(){void 0!=k&&b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);k=l;l+=c;b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);1<l&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),l=0,k=void 0,clearInterval(h))},10);d=!0}}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,
selectionArea:!1}}]}),d=void 0,h=void 0,l=void 0,k=void 0;b.oneShot=new g._interface.circuit.oneShot_single(g.library.audio.context);b.oneShot.out_right().connect(b.elements.connectionNode_audio.outRight.in());b.oneShot.out_left().connect(b.elements.connectionNode_audio.outLeft.in());return b};this.oneShot_single.metadata={name:"One Shot (Single)",category:"audioFile",helpURL:"https://curve.metasophiea.com/help/objects/units/oneShot_single/"};this.oneShot_multi=function(m,e,c){var f={fill:"rgba(0,0,0,0)",
stroke:"rgba(150,150,150,1)",lineWidth:1},a=g._interface.unit.builder(this.oneShot_multi,{name:"oneShot_multi",category:"audioFile",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,
y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,onreceive:function(b,c){a.elements.button_rectangle.fire.press();a.elements.button_rectangle.fire.release()}}},{type:"path",name:"symbol_arrow",data:{points:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:f}},{type:"rectangle",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:{fill:"rgba(150,150,150,1)"}}},{type:"circle",name:"symbol_outterCircle",data:{x:10,y:40,r:5.5,
style:f}},{type:"circle",name:"symbol_infCircle1",data:{x:8.5,y:40,r:1.5,style:f}},{type:"circle",name:"symbol_infCircle2",data:{x:11.5,y:40,r:1.5,style:f}},{type:"button_rectangle",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){a.oneShot.load("file",function(b){a.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(a.oneShot.waveformSegment())})}}},
{type:"button_rectangle",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){var c=a.oneShot,e=a.elements.grapher_waveWorkspace.grapher_waveWorkspace;if(!(0>c.duration())){var f=void 0!=e.area().A?e.area().A:0,g=void 0!=e.area().B?e.area().B:1,m=c.duration();f*=m;g=g*m-f;c.fire(f,g);for(var r=0;r in b;)r++;b[r]={};a.elements.glowbox_rect.glowbox_rect.on();
setTimeout(function(){a.elements.glowbox_rect.glowbox_rect.off()},100);b[r].previousPosition=void 0;b[r].currentPosition=f/m;b[r].endPosition=f/m+g/m;var n=10/(1E3*g);b[r].needleInterval=setInterval(function(){void 0!=b[r].previousPosition&&e.mark(b[r].currentPosition);b[r].previousPosition=b[r].currentPosition;b[r].currentPosition+=n;e.mark(b[r].currentPosition);b[r].currentPosition>b[r].endPosition&&(e.mark(b[r].currentPosition),clearInterval(b[r].needleInterval))},10)}}}},{type:"button_rectangle",
name:"panic",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){var c=a.elements.grapher_waveWorkspace.grapher_waveWorkspace;a.oneShot.panic();for(var e=Object.keys(b),f=0;f<e.length;f++)void 0!=b[f]&&(clearTimeout(b[f].needleInterval),delete b[f]);c.removeAllMarks()}}},{type:"slide",name:"rate",data:{x:26.25,y:5,width:5,height:45,value:.5,resetValue:.5,
style:{handle:"rgba(220,220,220,1)"},onchange:function(b){a.oneShot.rate(2*(1-b))}}},{type:"glowbox_rect",name:"glowbox_rect",data:{x:32.5,y:5,width:2.5,height:45}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:35,y:5,width:180,height:45,selectNeedle:!1,selectionArea:!0}}]}),b=[];a.oneShot=new g._interface.circuit.oneShot_multi(g.library.audio.context);a.oneShot.out_right().connect(a.elements.connectionNode_audio.outRight.in());a.oneShot.out_left().connect(a.elements.connectionNode_audio.outLeft.in());
a.i={};a.i.loadURL=function(b,c){a.oneShot.load("url",function(){a.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(a.oneShot.waveformSegment());void 0!=c&&c()},b)};a.i.area=function(b,c){a.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(b,c)};return a};this.oneShot_multi.metadata={name:"One Shot (Multi)",category:"audioFile",helpURL:"https://curve.metasophiea.com/help/units/alpha/oneShot_multi/"};this.oneShot_multi_multiTrack=function(m,e,c){var f={fill:"rgba(150,150,150,1)"},
a={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},d={background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},h={background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},
l={handle:"rgba(220,220,220,1)"};m={name:"oneShot_multi_multiTrack",category:"audioFile",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}}]};
for(c=0;8>c;c++)m.elements=m.elements.concat([{type:"path",name:"symbol_"+c+"_arrow",data:{points:[{x:19,y:35+47*c},{x:25,y:40+47*c},{x:19,y:45+47*c}],style:a}},{type:"rectangle",name:"symbol_"+c+"_line",data:{x:15,y:39.5+47*c,width:6,height:1,style:f}},{type:"circle",name:"symbol_"+c+"l_outerCircle",data:{x:10,y:40+47*c,r:5.5,style:a}},{type:"circle",name:"symbol_"+c+"_infCircle1",data:{x:8.5,y:40+47*c,r:1.5,style:a}},{type:"circle",name:"symbol_"+c+"_infCircle2",data:{x:11.5,y:40+47*c,r:1.5,style:a}}]),
m.elements.push({type:"slide",name:"rate_"+c,data:{x:26.25,y:5+47*c,width:5,height:45,value:.5,resetValue:.5,style:l,onchange:function(a){return function(b){k.oneShot_multi_array[a].rate(2*(1-b))}}(c)}}),m.elements.push({type:"glowbox_rect",name:"glowbox_rect_"+c,data:{x:32.5,y:5+47*c,width:2.5,height:45}}),m.elements.push({type:"grapher_waveWorkspace",name:"grapher_waveWorkspace_"+c,data:{x:35,y:5+47*c,width:180,height:45,selectNeedle:!1,selectionArea:!0}}),m.elements.push({type:"button_rectangle",
name:"loadFile_"+c,data:{x:5,y:5+47*c,width:20,height:10,style:b,onpress:function(a){return function(){k.oneShot_multi_array[a].load("file",function(a){return function(b){k.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a].draw(k.oneShot_multi_array[a].waveformSegment())}}(a))}}(c)}}),m.elements.push({type:"button_rectangle",name:"fire_"+c,data:{x:5,y:17.5+47*c,width:10,height:10,style:d,onpress:function(a){return function(){var b=k.oneShot_multi_array[a],c=k.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+
a],d=k.players[a];if(!(0>b.duration())){var e=void 0!=c.area().A?c.area().A:0,f=void 0!=c.area().B?c.area().B:1;if(e>f){var g=e;e=f;f=g}g=b.duration();e*=g;f=f*g-e;b.fire(e,f);for(var h=0;h in d;)h++;d[h]={};k.elements.glowbox_rect["glowbox_rect_"+a].on();setTimeout(function(a){return function(){k.elements.glowbox_rect["glowbox_rect_"+a].off()}}(a),100);d[h].previousPosition=void 0;d[h].currentPosition=e/g;d[h].endPosition=e/g+f/g;var l=10/(1E3*f);d[h].needleInterval=setInterval(function(){void 0!=
d[h].previousPosition&&c.mark(d[h].currentPosition);d[h].previousPosition=d[h].currentPosition;d[h].currentPosition+=l;c.mark(d[h].currentPosition);d[h].currentPosition>d[h].endPosition&&(c.mark(d[h].currentPosition),clearInterval(d[h].needleInterval))},10)}}}(c)}}),m.elements.push({type:"button_rectangle",name:"panic_"+c,data:{x:15,y:17.5+47*c,width:10,height:10,style:h,onpress:function(a){return function(b){b=k.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a];var c=k.players[a];k.oneShot_multi_array[a].panic();
for(var d=Object.keys(c),e=0;e<d.length;e++)void 0!=c[e]&&(clearTimeout(c[e].needleInterval),delete c[e]);b.removeAllMarks()}}(c)}}),m.elements.push({type:"connectionNode_data",name:"trigger_"+c,data:{x:220,y:17.5+47*c,width:10,height:20,onreceive:function(a){return function(b,c){"pulse"==b?(k.elements.button_rectangle["fire_"+a].press(),k.elements.button_rectangle["fire_"+a].release()):"hit"==b&&.49<c.velocity&&(k.elements.button_rectangle["fire_"+a].press(),k.elements.button_rectangle["fire_"+a].release())}}(c)}});
var k=g._interface.unit.builder(this.oneShot_multi_multiTrack,m);k.exportData=function(){for(var a={tracks:[],areas:[]},b=0;8>b;b++)a.tracks.push(k.oneShot_multi_array[b].unloadRaw()),a.areas.push(k.i.area(b));return a};k.importData=function(a){for(var b=0;8>b;b++)k.i.loadRaw(b,a.tracks[b]),k.i.area(b,a.areas[b].A,a.areas[b].B)};k.players=[];k.oneShot_multi_array=[];for(c=0;8>c;c++)k.oneShot_multi_array.push(new g._interface.circuit.oneShot_multi(g.library.audio.context)),k.oneShot_multi_array[c].out_right().connect(k.elements.connectionNode_audio.outRight.in()),
k.oneShot_multi_array[c].out_left().connect(k.elements.connectionNode_audio.outLeft.in()),k.players.push([]);k.i={loadURL:function(a,b,c){k.oneShot_multi_array[a].load("url",function(a){return function(){document.getElementById("oneShot_multi_multiTrack").children["grapher_waveWorkspace_"+a].draw(document.getElementById("oneShot_multi_multiTrack").oneShot_multi_array[a].waveformSegment())}}(a),b)},loadRaw:function(a,b){k.oneShot_multi_array[a].loadRaw(b);k.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+
a].draw(k.oneShot_multi_array[a].waveformSegment())},area:function(a,b,c){return k.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a].area(b,c)}};return k};this.oneShot_multi_multiTrack.metadata={name:"One Shot (Multi)(8 Track)",category:"audioFile",helpURL:"https://curve.metasophiea.com/help/units/alpha/oneShot_multi_multiTrack/"};this.player=function(m,e,c){function f(a){h.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(h.player.waveformSegment());h.elements.grapher_waveWorkspace.grapher_waveWorkspace.select(0);
h.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(-1,-1);h.elements.readout_sixteenSegmentDisplay__static.trackNameReadout.text(a.name);h.elements.readout_sixteenSegmentDisplay__static.trackNameReadout.print("smart")}var a={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b={fill:"rgba(150,150,150,1)"},d={background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"},h=g._interface.unit.builder(this.player,{name:"player",category:"audioFile",collection:"alpha",x:m,y:e,a:c,space:[{x:0,
y:0},{x:220,y:0},{x:220,y:80},{x:0,y:80}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:80},{x:0,y:80}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"rectangle",name:"symbol_line1",data:{x:3.5,y:38.5,width:1,height:2,style:b}},{type:"rectangle",name:"symbol_line2",
data:{x:5.5,y:37,width:1,height:5,style:b}},{type:"rectangle",name:"symbol_line3",data:{x:7.5,y:35.5,width:1,height:8,style:b}},{type:"rectangle",name:"symbol_line4",data:{x:9.5,y:34.5,width:1,height:10,style:b}},{type:"rectangle",name:"symbol_line5",data:{x:11.5,y:35.5,width:1,height:8,style:b}},{type:"rectangle",name:"symbol_line6",data:{x:13.5,y:37,width:1,height:5,style:b}},{type:"rectangle",name:"symbol_line7",data:{x:15.5,y:39,width:1,height:1,style:b}},{type:"rectangle",name:"symbol_line8",
data:{x:17.5,y:36,width:1,height:7,style:b}},{type:"rectangle",name:"symbol_line9",data:{x:19.5,y:32,width:1,height:15,style:b}},{type:"rectangle",name:"symbol_line10",data:{x:21.5,y:34.5,width:1,height:10,style:b}},{type:"rectangle",name:"symbol_line11",data:{x:23.5,y:37,width:1,height:5,style:b}},{type:"rectangle",name:"symbol_line12",data:{x:25.5,y:38.5,width:1,height:2,style:b}},{type:"readout_sixteenSegmentDisplay__static",name:"trackNameReadout",data:{x:30,y:5,angle:0,width:100,height:20,count:10,
style:d}},{type:"readout_sixteenSegmentDisplay__static",name:"time",data:{x:135,y:5,angle:0,width:80,height:20,count:8,style:d}},{type:"button_rectangle",name:"load",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){h.i.loadByFile()}}},{type:"button_rectangle",name:"start",data:{x:5,y:17.5,width:20,height:10,style:{background__up__fill:"rgba(175,195,175,1)",
background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){h.player.start()}}},{type:"button_rectangle",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){h.player.stop()}}},{type:"text",name:"rate_label_name",data:{x:8.5,y:79,text:"rate",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},
{type:"text",name:"rate_label_0",data:{x:5,y:75,text:"0",style:a}},{type:"text",name:"rate_label_1",data:{x:13.7,y:54,text:"1",style:a}},{type:"text",name:"rate_label_2",data:{x:23,y:75,text:"2",style:a}},{type:"dial_continuous",name:"rate_dial",data:{x:15,y:65,r:9,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,resetValue:.5}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:30,width:185,height:45,selectionArea:!1,selectionAreaToggle:function(a){h.player.loop({active:a})}}}]});
h.player=new g._interface.circuit.player(g.library.audio.context);h.player.out_right().connect(h.elements.connectionNode_audio.outRight.in());h.player.out_left().connect(h.elements.connectionNode_audio.outLeft.in());setInterval(function(){if(h.player.isLoaded()){var a=g.library.math.seconds2time(Math.round(h.player.currentTime()));h.elements.readout_sixteenSegmentDisplay__static.time.text(g.library.misc.padString(a.h,2,"0")+":"+g.library.misc.padString(a.m,2,"0")+":"+g.library.misc.padString(a.s,
2,"0"));h.elements.readout_sixteenSegmentDisplay__static.time.print();h.elements.grapher_waveWorkspace.grapher_waveWorkspace.select(h.player.progress(),!1)}},1E3/30);h.exportData=function(){return{track:h.player.unloadRaw()}};h.importData=function(a){h.i.loadRaw(a.track)};h.elements.dial_continuous.rate_dial.onchange=function(a){h.player.rate(2*a)};h.elements.grapher_waveWorkspace.grapher_waveWorkspace.onchange=function(a,b){if("lead"==a)h.player.jumpTo(b);else if("selection_A"==a||"selection_B"==
a)a=h.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(),a.A<a.B?h.player.loop({start:a.A,end:a.B}):h.player.loop({start:a.B,end:a.A})};h.i={loadRaw:function(a){h.player.loadRaw(a,f)},loadByFile:function(){h.player.load("file",f)},loadByURL:function(a){h.player.load("url",f,a)}};h.elements.dial_continuous.rate_dial.set(.5);return h};this.player.metadata={name:"Player",category:"audioFile",helpURL:"https://curve.metasophiea.com/help/units/alpha/player/"};this.basicSequencer=function(m,e,c){var f=
{stroke:"rgba(150,150,150,1)",lineWidth:1},a={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(240,240,240,1)",background__hover_press__fill:"rgba(180,180,180,1)"};m={name:"basicSequencer",category:"sequencers",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:{fill:"rgba(200,200,200,1)"}}},
{type:"sequencer",name:"main",data:{x:10,y:20,width:780,height:170,xCount:64,yCount:10,event:function(a){for(var c=0;c<a.length;c++)b.elements.connectionNode_data["output_"+a[c].line].send("hit",{velocity:a[c].strength})},onchangeviewarea:function(a){b.elements.rangeslide.viewselect.set({start:a.left,end:a.right},!1)}}},{type:"rangeslide",name:"viewselect",data:{x:10,y:20,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:1,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",
slot:"rgba(50,50,50,1)",invisibleHandle:"rgba(0,0,0,0)",span:"rgba(220,220,220,1)"}}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"rgba(229, 229, 229,1)",check:"rgba(252,252,252,1)"},onchange:function(a){b.elements.sequencer.main.automove(a)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"rgba(229, 221, 112,1)",check:"rgba(252,244,128,1)"},onchange:function(a){b.elements.sequencer.main.loopActive(a)}}},
{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:.75,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",span:"rgba(255,247,145,0.5)"}}},{type:"connectionNode_data",name:"progress_input",data:{x:800,y:5,width:5,height:20,onreceive:function(){b.elements.sequencer.main.progress()}}},{type:"button_rectangle",name:"progress_button",data:{x:10,y:205,width:25,height:15,style:a,onpress:function(){b.elements.sequencer.main.progress()}}},
{type:"path",name:"progress_arrow",data:{points:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:f}},{type:"connectionNode_data",name:"reset_input",data:{x:800,y:30,width:5,height:20,onreceive:function(){b.elements.sequencer.main.playheadPosition(0)}}},{type:"button_rectangle",name:"reset_button",data:{x:40,y:205,width:25,height:15,style:a,onpress:function(){b.elements.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{points:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:f}},
{type:"path",name:"reset_line",data:{points:[{x:49,y:209},{x:49,y:216}],style:f}}]};for(c=0;10>c;c++)m.elements.push({type:"connectionNode_data",name:"output_"+c,data:{x:-5,y:11+18*c,width:5,height:16,onreceive:function(){b.elements.sequencer.main.playheadPosition(0)}}});var b=g._interface.unit.builder(this.basicSequencer,m);b.elements.rangeslide.viewselect.onchange=function(a){b.elements.sequencer.main.viewarea({topLeft:{x:a.start,y:0},bottomRight:{x:a.end,y:1}},!1)};b.elements.rangeslide.loopSelect.onchange=
function(a){var c=Math.round(64*a.start);a=Math.round(64*a.end);0==a&&(a=1);b.elements.sequencer.main.loopPeriod(c,a)};b.exportData=function(){return{loop:{active:b.elements.checkbox_rect.loopActive.get(),range:b.elements.rangeslide.loopSelect.get()},autofollow:b.elements.checkbox_rect.followPlayhead.get(),notes:b.elements.sequencer.main.getAllSignals(),viewarea:{horizontal:b.elements.rangeslide.viewselect.get()}}};b.importData=function(a){b.elements.sequencer.main.addSignals(a.notes);b.i.loopActive(a.loop.active);
b.elements.rangeslide.loopSelect.set(a.loop.range);b.elements.checkbox_rect.followPlayhead.set(a.autofollow);b.elements.rangeslide.viewselect.set(a.viewarea.horizontal)};b.i={addNote:function(a,c,e,f){b.elements.sequencer.main.addSignal(a,c,e,void 0===f?1:f)},addNotes:function(a){b.elements.sequencer.main.addSignal(a)},getNotes:function(){return b.elements.sequencer.main.getAllSignals()},loopActive:function(a){b.elements.checkbox_rect.loopActive.set(a)},step:b.elements.sequencer.step};return b};this.basicSequencer.metadata=
{name:"Basic Sequencer (Multi Pulse Out)",category:"sequencer",helpURL:"https://curve.metasophiea.com/help/units/alpha/basicSequencer_pulseOut/"};this.launchpad=function(m,e,c){function f(){for(var b=0;b<a.yCount;b++)h.elements.rastorgrid.rastorgrid.light(h.internalCircuits.previousPosition(),b,!1),h.elements.rastorgrid.rastorgrid.light(h.internalCircuits.position(),b,!0)}var a={xCount:8,yCount:8},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},
d={backing:"rgba(200,175,200,1)",check:"rgba(150,125,150,1)",backingGlow:"rgba(225,175,225,1)",checkGlow:"rgba(200,125,200,1)"};m={name:"launchpad",category:"sequencers",collection:"alpha",x:m,y:e,a:c,space:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"pulse_input",data:{x:125,
y:5,width:5,height:10}},{type:"connectionNode_data",name:"nextPage_input",data:{x:125,y:22.5,width:5,height:10}},{type:"connectionNode_data",name:"prevPage_input",data:{x:125,y:35,width:5,height:10}},{type:"button_rectangle",name:"pulse_button",data:{x:100,y:5,width:20,height:10,style:b}},{type:"rectangle",name:"rastorBacking",data:{x:5,y:5,width:90,height:90,style:{fill:d.backing}}},{type:"rastorgrid",name:"rastorgrid",data:{x:5,y:5,width:90,height:90,xCount:a.xCount,yCount:a.yCount,style:d}},{type:"sevenSegmentDisplay",
name:"pageNumber",data:{x:100,y:22.5,width:20,height:22.5,style:b}},{type:"button_rectangle",name:"nextPage",data:{x:102.5,y:17.5,width:15,height:5,style:b}},{type:"button_rectangle",name:"prevPage",data:{x:102.5,y:45,width:15,height:5,style:b}}]};for(c=0;c<a.yCount;c++)m.elements.push({type:"connectionNode_data",name:"out_"+c,data:{x:-5,y:12.5*c+2.5,width:5,height:7.5}});var h=g._interface.unit.builder(this.launchpad,m);h.exportData=function(){return{currentPage:h.internalCircuits.page(),data:h.internalCircuits.exportPages()}};
h.importData=function(a){void 0!=a.data&&h.internalCircuits.importPages(a.data);a.currentPage&&h.internalCircuits.page(a.currentPage)};h.internalCircuits=new this.launchpad.sequencer(a.xCount,a.yCount);h.internalCircuits.commands=function(b){for(var c=0;c<a.yCount;c++)b[c]&&h.io["out_"+c].send("pulse")};h.internalCircuits.pageChange=function(a){h.elements.sevenSegmentDisplay.pageNumber.enterCharacter(""+a);a=h.internalCircuits.exportPage();void 0==a?h.elements.rastorgrid.rastorgrid.clear():h.elements.rastorgrid.rastorgrid.set(a)};
h.elements.connectionNode_data.pulse_input.onreceive=function(){h.internalCircuits.inc();f()};h.elements.connectionNode_data.nextPage_input.onreceive=function(){h.internalCircuits.incPage()};h.elements.connectionNode_data.prevPage_input.onreceive=function(){h.internalCircuits.decPage()};h.elements.button_rectangle.pulse_button.onreceive=function(){h.internalCircuits.inc();f()};h.elements.rastorgrid.rastorgrid.onchange=function(a){h.internalCircuits.importPage(a)};h.elements.button_rectangle.nextPage.onpress=
function(){h.internalCircuits.incPage()};h.elements.button_rectangle.prevPage.onpress=function(){h.internalCircuits.decPage()};h.i={importPage:function(a,b){h.internalCircuits.importPage(a,b)},exportPage:function(a){return h.internalCircuits.exportPage(a)},importPages:function(a){h.internalCircuits.importPages(a)},exportPages:function(){return h.internalCircuits.exportPages()},setPage:function(a){h.internalCircuits.page(a)}};f();h.elements.sevenSegmentDisplay.pageNumber.enterCharacter("0");return h};
this.launchpad.metadata={name:"Launchpad",category:"sequencer",helpURL:"https://curve.metasophiea.com/help/units/alpha/launchpad/"};this.launchpad.sequencer=function(g,e){var c=[],f=0,a=0,b=g-1;this.square=function(a,b,l){0>a?a=0:a>g-1&&(a=g-1);0>b?b=0:a>e-1&&(a=e-1);if(void 0==l)return c[f][b][a];c[f][b][a]=l};this.line=function(b,g){if(void 0==g){g=[];for(b=0;b<e;b++)void 0==c[f]||void 0==c[f][b]||void 0==c[f][b][a]?g.push(!1):g.push(c[f][b][a]);return g}for(b=0;b<e;b++)c[f][b][a]=g[b]};this.position=
function(c,e){if(void 0==c)return a;b=a;c>g-1?c=0:0>c&&(c=g-1);a=c;(void 0===e||e)&&this.commands(this.line())};this.previousPosition=function(){return b};this.inc=function(){this.position(a+1)};this.dec=function(){this.position(a-1)};this.page=function(a){if(void 0==a)return f;-1==a?a=9:0>a?a=0:10==a?a=0:10<=a&&(a=9);f=a;void 0!=this.pageChange&&this.pageChange(f)};this.incPage=function(){this.page(f+1)};this.decPage=function(){this.page(f-1)};this.exportPages=function(){return JSON.parse(JSON.stringify(c))};
this.importPages=function(a){c=a;this.pageChange(f)};this.exportPage=function(a){void 0==a&&(a=f);return void 0==c[a]?Array(g).fill(Array(e).fill(!1)):JSON.parse(JSON.stringify(c[a]))};this.importPage=function(a,b){void 0==b&&(b=f);c[b]=a;void 0!=this.pageChange&&this.pageChange(f)};this.commands=function(){};this.pageChange=function(){}};this.basicSequencer_midiOut=function(m,e,c){var f=void 0,a=[0,0,1,0,1,0,1,0,0,1,0,1];f=108;var b=a.length-"C C# D D# E F F# G G# A A# B".split(" ").indexOf(g.library.audio.num2name(131).slice(1));
a=a.slice(b).concat(a.slice(0,b));b={stroke:"rgba(150,150,150,1)",lineWidth:1};var d={handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",invisibleHandle:"rgba(0,0,0,0)",span:"rgba(220,220,220,1)"},h={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(240,240,240,1)",background__hover_press__fill:"rgba(180,180,180,1)"},l=g._interface.unit.builder(this.basicSequencer,{name:"basicSequencer_midiOut",category:"sequencers",collection:"alpha",x:m,y:e,
a:c,space:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"midiout",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"sequencer",name:"main",data:{x:20,y:20,width:770,height:170,xCount:64,yCount:f,horizontalStripStyle_pattern:a,event:function(a){for(var b=0;b<a.length;b++)l.elements.connectionNode_data.midiout.send("midinumber",
{num:131-a[b].line,velocity:a[b].strength})},onchangeviewarea:function(a){l.elements.rangeslide.viewselect.set({start:a.left,end:a.right},!1)}}},{type:"rangeslide",name:"viewselect_y",data:{x:10,y:20,height:170,width:10,angle:0,handleHeight:.0625,spanWidth:1,style:d}},{type:"rangeslide",name:"viewselect_x",data:{x:20,y:20,height:770,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:1,style:d}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"rgba(229, 229, 229,1)",
check:"rgba(252,252,252,1)"},onchange:function(a){l.elements.sequencer.main.automove(a)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"rgba(229, 221, 112,1)",check:"rgba(252,244,128,1)"},onchange:function(a){l.elements.sequencer.main.loopActive(a)}}},{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:.75,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",
span:"rgba(255,247,145,0.5)"}}},{type:"connectionNode_data",name:"progress_input",data:{x:800,y:5,width:5,height:20,onreceive:function(){l.elements.sequencer.main.progress()}}},{type:"button_rectangle",name:"progress_button",data:{x:10,y:205,width:25,height:15,style:h,onpress:function(){l.elements.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{points:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:b}},{type:"connectionNode_data",name:"reset_input",data:{x:800,y:30,width:5,
height:20,onreceive:function(){l.elements.sequencer.main.playheadPosition(0)}}},{type:"button_rectangle",name:"reset_button",data:{x:40,y:205,width:25,height:15,style:h,onpress:function(){l.elements.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{points:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:b}},{type:"path",name:"reset_line",data:{points:[{x:49,y:209},{x:49,y:216}],style:b}}]});l.elements.rangeslide.viewselect_y.onchange=function(a){l.elements.sequencer.main.viewarea({topLeft:{y:a.start},
bottomRight:{y:a.end}},!1)};l.elements.rangeslide.viewselect_x.onchange=function(a){l.elements.sequencer.main.viewarea({topLeft:{x:a.start},bottomRight:{x:a.end}},!1)};l.elements.rangeslide.loopSelect.onchange=function(a){var b=Math.round(64*a.start);a=Math.round(64*a.end);0==a&&(a=1);l.elements.sequencer.main.loopPeriod(b,a)};l.exportData=function(){return{loop:{active:l.elements.checkbox_rect.loopActive.get(),range:l.elements.rangeslide.loopSelect.get()},autofollow:l.elements.checkbox_rect.followPlayhead.get(),
notes:l.elements.sequencer.main.getAllSignals(),viewarea:{horizontal:l.elements.rangeslide.viewselect_y.get(),vertical:l.elements.rangeslide.viewselect_x.get()}}};l.importData=function(a){l.elements.sequencer.main.addSignals(a.notes);l.i.loopActive(a.loop.active);l.elements.rangeslide.loopSelect.set(a.loop.range);l.elements.checkbox_rect.followPlayhead.set(a.autofollow);l.elements.rangeslide.viewselect_y.set(a.viewarea.horizontal);l.elements.rangeslide.viewselect_x.set(a.viewarea.vertical)};l.i={addNote:function(a,
b,c,d){l.elements.sequencer.main.addSignal(131-a,b,c,void 0===d?1:d)},addNotes:function(a){for(var b=0;b<a.length;b++)this.addSignal(a[b].line,a[b].position,a[b].length,a[b].strength)},getNotes:function(){return l.elements.sequencer.main.getAllSignals()},loopActive:function(a){l.elements.checkbox_rect.loopActive.set(a)},step:l.elements.sequencer.step};l.elements.rangeslide.viewselect_y.set({start:.3,end:.7});return l};this.basicSequencer_midiOut.metadata={name:"Basic Sequencer (Midi Out)",category:"sequencer",
helpURL:"https://curve.metasophiea.com/help/units/alpha/basicSequencer_midiOut/"}};g.control.gui.elements.menubar.dropdowns=[{text:"file",width:45,listWidth:150,listItemHeight:22.5,breakHeight:.5,spaceHeight:1,itemList:[{text_left:"New Scene",function:function(){control.scene.new(!0)}},{text_left:"Open Scene",text_right:"ctrl-f2",function:function(){control.scene.load(void 0,void 0,!0)}},{text_left:"Save Scene",text_right:"ctrl-f3",function:function(){control.scene.save("project.crv")}}]},{text:"edit",
width:45,listWidth:150,listItemHeight:22.5,breakHeight:.5,spaceHeight:1,itemList:[{text_left:"Cut",text_right:"ctrl-x",function:function(){control.selection.cut()}},{text_left:"Copy",text_right:"ctrl-c",function:function(){control.selection.copy()}},{text_left:"Paste",text_right:"ctrl-v",function:function(){control.selection.paste()}},{text_left:"Duplicate",text_right:"ctrl-b",function:function(){control.selection.duplicate()}},{text_left:"Delete",text_right:"del",function:function(){control.selection.delete()}}]},
{text:"create",width:65,listWidth:250,listItemHeight:22.5,breakHeight:.5,spaceHeight:1,itemList:function(){var m={};for(design in g._interface.unit.collection.alpha){var e=g._interface.unit.collection.alpha[design].metadata;e.dev||(void 0==m[void 0==e.category?"":e.category]&&(m[void 0==e.category?"":e.category]=[]),m[void 0==e.category?"":e.category].push({text_left:e.name,function:function(c){return function(){var e=g.core.viewport.windowPoint2workspacePoint(30,30);g.control.scene.addUnit(e.x,e.y,
0,c,"alpha")}}(design)}))}e=[];for(category in m)e=e.concat(m[category]),e.push("break");e.pop();return e}()},{text:"help",width:50,listWidth:150,listItemHeight:22.5,breakHeight:.5,spaceHeight:1,itemList:[{text_left:"Help Docs",text_right:"(empty)",function:function(){console.log("go to help site")}}]}];g.control.interaction.devMode()||(window.onbeforeunload=function(){return"Unsaved work will be lost"});g.control.gui.showMenubar();g.control.viewport.stopMouseScroll(!0);g.control.viewport.activeRender(!0)}})();
