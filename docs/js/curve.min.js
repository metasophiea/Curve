var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(v){var G=0;return function(){return G<v.length?{done:!1,value:v[G++]}:{done:!0}}};$jscomp.arrayIterator=function(v){return{next:$jscomp.arrayIteratorImpl(v)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(v,G,g){v!=Array.prototype&&v!=Object.prototype&&(v[G]=g.value)};$jscomp.getGlobal=function(v){return"undefined"!=typeof window&&window===v?v:"undefined"!=typeof global&&null!=global?global:v};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var v=0;return function(G){return $jscomp.SYMBOL_PREFIX+(G||"")+v++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var v=$jscomp.global.Symbol.iterator;v||(v=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[v]&&$jscomp.defineProperty(Array.prototype,v,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var v=$jscomp.global.Symbol.asyncIterator;v||(v=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(v){$jscomp.initSymbolIterator();v={next:v};v[$jscomp.global.Symbol.iterator]=function(){return this};return v};
$jscomp.iteratorFromArray=function(v,G){$jscomp.initSymbolIterator();v instanceof String&&(v+="");var g=0,r={next:function(){if(g<v.length){var d=g++;return{value:G(d,v[d]),done:!1}}r.next=function(){return{done:!0,value:void 0}};return r.next()}};r[Symbol.iterator]=function(){return r};return r};
$jscomp.polyfill=function(v,G,g,r){if(G){g=$jscomp.global;v=v.split(".");for(r=0;r<v.length-1;r++){var d=v[r];d in g||(g[d]={});g=g[d]}v=v[v.length-1];r=g[v];G=G(r);G!=r&&null!=G&&$jscomp.defineProperty(g,v,{configurable:!0,writable:!0,value:G})}};$jscomp.polyfill("Array.prototype.keys",function(v){return v?v:function(){return $jscomp.iteratorFromArray(this,function(v){return v})}},"es6","es3");
$jscomp.polyfill("Array.from",function(v){return v?v:function(v,g,r){g=null!=g?g:function(a){return a};var d=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&v[Symbol.iterator];if("function"==typeof f){v=f.call(v);for(var e=0;!(f=v.next()).done;)d.push(g.call(r,f.value,e++))}else for(f=v.length,e=0;e<f;e++)d.push(g.call(r,v[e],e));return d}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var v={},G=Object.create(new $jscomp.global.Proxy(v,{get:function(g,r,d){return g==v&&"q"==r&&d==G}}));return!0===G.q}catch(g){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(v){var G="undefined"!=typeof Symbol&&Symbol.iterator&&v[Symbol.iterator];return G?G.call(v):$jscomp.arrayIterator(v)};
$jscomp.owns=function(v,G){return Object.prototype.hasOwnProperty.call(v,G)};
$jscomp.polyfill("WeakMap",function(v){function G(){if(!v||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),h=new v([[a,2],[b,3]]);if(2!=h.get(a)||3!=h.get(b))return!1;h.delete(a);h.set(b,4);return!h.has(a)&&4==h.get(b)}catch(k){return!1}}function g(){}function r(a){if(!$jscomp.owns(a,f)){var b=new g;$jscomp.defineProperty(a,f,{value:b})}}function d(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof g)return a;r(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(v&&
$jscomp.ES6_CONFORMANCE)return v}else if(G())return v;var f="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var e=0,a=function(a){this.id_=(e+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};a.prototype.set=function(a,b){r(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};a.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};a.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};a.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return a},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(v){function G(){if($jscomp.ASSUME_NO_NATIVE_MAP||!v||"function"!=typeof v||!v.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),b=new v($jscomp.makeIterator([[a,"s"]]));if("s"!=b.get(a)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var h=b.entries(),k=h.next();if(k.done||k.value[0]!=a||"s"!=k.value[1])return!1;k=h.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!h.next().done?!1:!0}catch(l){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(v&&$jscomp.ES6_CONFORMANCE)return v}else if(G())return v;$jscomp.initSymbolIterator();var g=new WeakMap,r=function(a){this.data_={};this.head_=e();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};r.prototype.set=function(a,b){a=0===a?0:a;var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};r.prototype.delete=function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};r.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=e();this.size=0};r.prototype.has=function(a){return!!d(this,a).entry};
r.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};r.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};r.prototype.keys=function(){return f(this,function(a){return a.key})};r.prototype.values=function(){return f(this,function(a){return a.value})};r.prototype.forEach=function(a,b){for(var c=this.entries(),k;!(k=c.next()).done;)k=k.value,a.call(b,k[1],k[0],this)};r.prototype[Symbol.iterator]=r.prototype.entries;var d=function(c,b){var h=b&&typeof b;"object"==
h||"function"==h?g.has(b)?h=g.get(b):(h=""+ ++a,g.set(b,h)):h="p_"+b;var k=c.data_[h];if(k&&$jscomp.owns(c.data_,h))for(c=0;c<k.length;c++){var e=k[c];if(b!==b&&e.key!==e.key||b===e.key)return{id:h,list:k,index:c,entry:e}}return{id:h,list:k,index:-1,entry:void 0}},f=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},e=function(){var a={};return a.previous=
a.next=a.head=a},a=0;return r},"es6","es3");
$jscomp.polyfill("Set",function(v){function G(){if($jscomp.ASSUME_NO_NATIVE_SET||!v||"function"!=typeof v||!v.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),d=new v($jscomp.makeIterator([g]));if(!d.has(g)||1!=d.size||d.add(g)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var f=d.entries(),e=f.next();if(e.done||e.value[0]!=g||e.value[1]!=g)return!1;e=f.next();return e.done||e.value[0]==g||4!=e.value[0].x||e.value[1]!=e.value[0]?!1:f.next().done}catch(a){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(v&&$jscomp.ES6_CONFORMANCE)return v}else if(G())return v;$jscomp.initSymbolIterator();var g=function(g){this.map_=new Map;if(g){g=$jscomp.makeIterator(g);for(var d;!(d=g.next()).done;)this.add(d.value)}this.size=this.map_.size};g.prototype.add=function(g){g=0===g?0:g;this.map_.set(g,g);this.size=this.map_.size;return this};g.prototype.delete=function(g){g=this.map_.delete(g);this.size=this.map_.size;return g};g.prototype.clear=function(){this.map_.clear();
this.size=0};g.prototype.has=function(g){return this.map_.has(g)};g.prototype.entries=function(){return this.map_.entries()};g.prototype.values=function(){return this.map_.values()};g.prototype.keys=g.prototype.values;g.prototype[Symbol.iterator]=g.prototype.values;g.prototype.forEach=function(g,d){var f=this;this.map_.forEach(function(e){return g.call(d,e,e,f)})};return g},"es6","es3");
$jscomp.polyfill("Object.entries",function(v){return v?v:function(v){var g=[],r;for(r in v)$jscomp.owns(v,r)&&g.push([r,v[r]]);return g}},"es8","es3");$jscomp.polyfill("Array.prototype.fill",function(v){return v?v:function(v,g,r){var d=this.length||0;0>g&&(g=Math.max(0,d+g));if(null==r||r>d)r=d;r=Number(r);0>r&&(r=Math.max(0,d+r));for(g=Number(g||0);g<r;g++)this[g]=v;return this}},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(v,G){for(var g=1;g<arguments.length;g++){var r=arguments[g];if(r)for(var d in r)$jscomp.owns(r,d)&&(v[d]=r[d])}return v};$jscomp.polyfill("Object.assign",function(v){return v||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.is",function(v){return v?v:function(v,g){return v===g?0!==v||1/v===1/g:v!==v&&g!==g}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(v){return v?v:function(v,g){var r=this;r instanceof String&&(r=String(r));var d=r.length;g=g||0;for(0>g&&(g=Math.max(g+d,0));g<d;g++){var f=r[g];if(f===v||Object.is(f,v))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(v,G,g){if(null==v)throw new TypeError("The 'this' value for String.prototype."+g+" must not be null or undefined");if(G instanceof RegExp)throw new TypeError("First argument to String.prototype."+g+" must not be a regular expression");return v+""};$jscomp.polyfill("String.prototype.includes",function(v){return v?v:function(v,g){return-1!==$jscomp.checkStringArgs(this,v,"includes").indexOf(v,g||0)}},"es6","es3");
$jscomp.polyfill("Math.sign",function(v){return v?v:function(v){v=Number(v);return 0===v||isNaN(v)?v:0<v?1:-1}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(v){return v?v:function(){return $jscomp.iteratorFromArray(this,function(v,g){return g})}},"es8","es3");$jscomp.polyfill("Math.log10",function(v){return v?v:function(v){return Math.log(v)/Math.LN10}},"es6","es3");
(function(){for(var v=document.getElementsByTagName("canvas"),G=0;G<v.length;G++)if(v[G].hasAttribute("workspace")){var g=v[G];g.library=new function(){var g=this;this.math=new function(){this.averageArray=function(d){return d.reduce(function(d,e){return d+e},0)/d.length};this.distanceBetweenTwoPoints=function(d,f){return Math.pow(Math.pow(d.x-f.x,2)+Math.pow(d.y-f.y,2),.5)};this.seconds2time=function(d){var f={h:0,m:0,s:0};f.h=Math.floor(d/3600);d-=3600*f.h;f.m=Math.floor(d/60);d-=60*f.m;f.s=d;return f};
this.largestValueFound=function(d){return d.reduce(function(d,e){return Math.abs(d)>Math.abs(e)?d:e})};this.smallestValueFound=function(d){return d.reduce(function(d,e){return Math.abs(d)<Math.abs(e)?d:e})};this.cartesian2polar=function(d,f){return{dis:Math.pow(Math.pow(d,2)+Math.pow(f,2),.5),ang:0===d?0===f?0:0<f?.5*Math.PI:1.5*Math.PI:0===f?0<=d?0:Math.PI:0<=d?Math.atan(f/d):Math.atan(f/d)+Math.PI}};this.polar2cartesian=function(d,f){return{x:f*Math.cos(d),y:f*Math.sin(d)}};this.cartesianAngleAdjust=
function(d,f,e){d=this.cartesian2polar(d,f);d.ang+=e;return this.polar2cartesian(d.ang,d.dis)};this.boundingBoxFromPoints=function(d){if(0==d.length)return{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};for(var f=d[0].x,e=d[0].x,a=d[0].y,c=d[0].y,b=1;b<d.length;b++)d[b].x<f?f=d[b].x:d[b].x>e&&(e=d[b].x),d[b].y<a?a=d[b].y:d[b].y>c&&(c=d[b].y);return{topLeft:{x:f,y:a},bottomRight:{x:e,y:c}}};this.pointsOfRect=function(d,f,e,a,c,b){c=void 0===c?0:c;b=void 0===b?{x:0,y:0}:b;var h=b.x*e,k=b.y*a,l=this.cartesian2polar(h,
k);l=this.polar2cartesian(l.ang-c,l.dis);b={x:d-l.x,y:f-l.y};l=this.cartesian2polar(h-e,k);l=this.polar2cartesian(l.ang-c,l.dis);var m={x:d-l.x,y:f-l.y};l=this.cartesian2polar(h-e,k-a);l=this.polar2cartesian(l.ang-c,l.dis);e={x:d-l.x,y:f-l.y};l=this.cartesian2polar(h,k-a);l=this.polar2cartesian(l.ang-c,l.dis);return[b,m,e,{x:d-l.x,y:f-l.y}]};this.pointsOfCircle=function(d,f,e,a){a=void 0===a?3:a;for(var c=[],b=0;b<a;b++)c.push({x:d+e*Math.sin(b/a*Math.PI*2),y:f+e*Math.cos(b/a*Math.PI*2)});return c};
this.pointsOfText=function(d,f,e,a,c,b,h,k){var l=document.createElement("canvas").getContext("2d");l.font=b;l.textAlign=h;l.textBaseline=k;d=l.measureText(d).width/c;b=-b.split("pt")[0].split(" ").pop();isNaN(b)&&(b=-7.5);b/=c;c=[{x:f,y:e},{x:f+d,y:e},{x:f+d,y:e-b},{x:f,y:e-b}];d={start:0,end:0,center:d/2,left:d,right:d};b={alphabetic:b,top:0,hanging:0,middle:b/2,ideographic:0,bottom:b};for(l=0;l<c.length;l++)c[l]={x:c[l].x-d[h],y:c[l].y+b[k]};for(l=0;l<c.length;l++)c[l]=this.cartesianAngleAdjust(c[l].x-
f,c[l].y-e,a),c[l].x+=f,c[l].y+=e;return c};this.relativeDistance=function(d,f,e,a,c){f=(a-f)/(e-f);if(void 0===c||!c){if(1<f)return d;if(0>f)return 0}return f*d};this.lineCorrecter=function(d,f,e){if(!(0>d.x1||0>d.x2||d.x1>e||d.x2>e||0>d.y1&&0>d.y2||d.y1>f&&d.y2>f))return e=(d.y2-d.y1)/(d.x2-d.x1),0>d.y1?(d.x1=(0-d.y1+e*d.x1)/e,d.y1=0):0>d.y2&&(d.x2=(0-d.y2+e*d.x2)/e,d.y2=0),d.y1>f?(d.x1=(f-d.y1+e*d.x1)/e,d.y1=f):d.y2>f&&(d.x2=(f-d.y2+e*d.x2)/e,d.y2=f),d};this.normalizeStretchArray=function(d){var f=
d.reduce(function(a,b,h,e){return b>e[a]?h:a},0),e=Math.abs(d[f]);d=d.map(function(a){return a/e});if(0==d[0]&&1==d[d.length-1])return d;var a=0!=d[0]?d[0]:d[d.length-1];return d=d.map(function(c){return(c-a)/(1-a)})};this.curvePoint=new function(){this.linear=function(d,f,e){f=void 0===f?0:f;return(void 0===d?.5:d)*((void 0===e?1:e)-f)+f};this.sin=function(d,f,e){f=void 0===f?0:f;return Math.sin(Math.PI/2*(void 0===d?.5:d))*((void 0===e?1:e)-f)+f};this.cos=function(d,f,e){f=void 0===f?0:f;return(1-
Math.cos(Math.PI/2*(void 0===d?.5:d)))*((void 0===e?1:e)-f)+f};this.s=function(d,f,e,a){f=void 0===f?0:f;e=void 0===e?1:e;a=void 0===a?8:a;return g.math.normalizeStretchArray([1/(1+Math.exp(-.5*-a)),1/(1+Math.exp(-a*((void 0===d?.5:d)-.5))),1/(1+Math.exp(.5*-a))])[1]*(e-f)+f};this.exponential=function(d,f,e,a){f=void 0===f?0:f;e=void 0===e?1:e;a=void 0===a?2:a;return g.math.normalizeStretchArray([(Math.exp(0*a)-1)/(Math.E-1),(Math.exp(a*(void 0===d?.5:d))-1)/(Math.E-1),(Math.exp(1*a)-1)/(Math.E-1)])[1]*
(e-f)+f}};this.curveGenerator=new function(){this.linear=function(d,f,e){f=void 0===f?0:f;e=void 0===e?1:e;d=Math.abs(void 0===d?2:d)-1;for(var a=[0],c=1;c<d;c++)a.push(c/d);a.push(1);d=e-f;for(c=0;c<a.length;c++)a[c]=a[c]*d+f;return a};this.sin=function(d,f,e){f=void 0===f?0:f;e=void 0===e?1:e;d=Math.abs(void 0===d?2:d)-1;for(var a=[0],c=1;c<d;c++)a.push(Math.sin(Math.PI/2*(c/d)));a.push(1);d=e-f;for(c=0;c<a.length;c++)a[c]=a[c]*d+f;return a};this.cos=function(d,f,e){f=void 0===f?0:f;e=void 0===
e?1:e;d=Math.abs(void 0===d?2:d)-1;for(var a=[0],c=1;c<d;c++)a.push(1-Math.cos(Math.PI/2*(c/d)));a.push(1);d=e-f;for(c=0;c<a.length;c++)a[c]=a[c]*d+f;return a};this.s=function(d,f,e,a){d=void 0===d?2:d;f=void 0===f?0:f;e=void 0===e?1:e;a=void 0===a?8:a;0==a&&(a=1E-6);for(var c=[],b=0;b<d;b++)c.push(1/(1+Math.exp(-a*(b/d-.5))));d=g.math.normalizeStretchArray(c);e-=f;for(b=0;b<d.length;b++)d[b]=d[b]*e+f;return d};this.exponential=function(d,f,e,a){f=void 0===f?0:f;e=void 0===e?1:e;a=void 0===a?2:a;
d=(void 0===d?2:d)-1;for(var c=[],b=0;b<=d;b++)c.push((Math.exp(b/d*a)-1)/(Math.E-1));c=system.utility.math.normalizeStretchArray(c);d=e-f;for(b=0;b<c.length;b++)c[b]=c[b]*d+f;return c}};this.detectOverlap=new function(){this.boundingBoxes=function(d,f){return!(d.bottomRight.y<f.topLeft.y||d.topLeft.y>f.bottomRight.y||d.bottomRight.x<f.topLeft.x||d.topLeft.x>f.bottomRight.x)};this.pointWithinBoundingBox=function(d,f){return!(d.x<f.topLeft.x||d.y<f.topLeft.y||d.x>f.bottomRight.x||d.y>f.bottomRight.y)};
this.pointWithinPoly=function(d,f){for(var e=!1,a=0,c=f.length-1;a<f.length;c=a++)f[a].y>d.y!=f[c].y>d.y&&d.x<(f[c].x-f[a].x)*(d.y-f[a].y)/(f[c].y-f[a].y)+f[a].x&&(e=!e);return e};this.lineSegments=function(d,f){var e=(f[1].y-f[0].y)*(d[1].x-d[0].x)-(f[1].x-f[0].x)*(d[1].y-d[0].y);if(0==e)return null;var a=((f[1].x-f[0].x)*(d[0].y-f[0].y)-(f[1].y-f[0].y)*(d[0].x-f[0].x))/e;f=((d[1].x-d[0].x)*(d[0].y-f[0].y)-(d[1].y-d[0].y)*(d[0].x-f[0].x))/e;return{x:d[0].x+a*(d[1].x-d[0].x),y:d[0].y+a*(d[1].y-d[0].y),
inSeg1:0<=a&&1>=a,inSeg2:0<=f&&1>=f}};this.overlappingPolygons=function(d,f){for(var e=0;e<d.length;e++)if(this.pointWithinPoly(d[e],f))return!0;for(e=0;e<f.length;e++)if(this.pointWithinPoly(f[e],d))return!0;var a=Array.apply(null,{length:d.length}).map(Number.call,Number).concat([0]),c=Array.apply(null,{length:f.length}).map(Number.call,Number).concat([0]);for(e=0;e<a.length-1;e++)for(var b=0;b<c.length-1;b++){var h=this.lineSegments([d[a[e]],d[a[e+1]]],[f[c[b]],f[c[b+1]]]);if(null!=h&&h.inSeg1&&
h.inSeg2)return!0}return!1}}};this.structure=new function(){this.functionListRunner=function(d,f){return function(e,a){for(var c=0;c<d.length;c++){for(var b=!0,h=0;h<d[c].requiredKeys.length;h++){b=!0;for(var k=0;k<d[c].requiredKeys[h].length&&(b=b&&f[d[c].requiredKeys[h][k]],b);k++);if(b)break}if(b&&d[c].function(e,a))break}}};this.signalRegistry=function(d,f,e){d=void 0===d?-1:d;f=void 0===f?-1:f;e=void 0===e?-1:e;var a=[],c=[],b=[],h=[],k={},l=[];this.__dump=function(){console.log("---- signalRegistry dump ----");
console.log("\tsignals");for(var c=0;c<a.length;c++)console.log("\t\t",c," "+JSON.stringify(a[c]));console.log("\tselectedSignals");for(c=0;c<tselectedSignals.length;c++)console.log("\t\t",c," "+JSON.stringify(tselectedSignals[c]));console.log("\tevents");for(c=0;c<b.length;c++)console.log("\t\t",c," "+JSON.stringify(b[c]));console.log("\tevents_byID");for(c=0;c<h.length;c++)console.log("\t\t",c," "+JSON.stringify(h[c]));console.log("\tevents_byPosition");var e=Object.keys(k);for(c=0;c<e.length;c++)console.log("\t\t",
e[c]," "+JSON.stringify(k[e[c]]));console.log("\tpositions");for(c=0;c<l.length;c++)console.log("\t\t",c," "+JSON.stringify(l[c]))};this.export=function(){return JSON.parse(JSON.stringify({signals:a,selectedSignals:c,events:b,events_byID:h,events_byPosition:k,positions:l}))};this.import=function(e){a=JSON.parse(JSON.stringify(e.signals));c=JSON.parse(JSON.stringify(e.selectedSignals));b=JSON.parse(JSON.stringify(e.events));h=JSON.parse(JSON.stringify(e.events_byID));k=JSON.parse(JSON.stringify(e.events_byPosition));
l=JSON.parse(JSON.stringify(e.positions))};this.getAllSignals=function(){return JSON.parse(JSON.stringify(a))};this.getAllEvents=function(){return JSON.parse(JSON.stringify(b))};this.getSignal=function(b){if(void 0!=a[b])return JSON.parse(JSON.stringify(a[b]))};this.eventsBetween=function(a,c){for(var h=void 0==c?Array.from(new Set(l.filter(function(b){return b==a}))):Array.from(new Set(l.filter(function(b){return b>=a&&b<c}))),e=[],d=0;d<h.length;d++){h[d]=k[String(h[d])];for(var f=0;f<h[d].length;f++)e.push(b[h[d][f]])}return e.sort(function(a,
b){return a.position<b.position?-1:a.position>b.position?1:0})};this.add=function(c,t){if(void 0!=c&&"line"in c&&"position"in c&&"length"in c){"strength"in c||(c.strength=1);0>c.line&&(c.line=0);0>c.length&&(c.length=0);0>c.position&&(c.position=0);0>c.strength&&(c.strength=0);-1<f&&c.line>f-1&&(c.line=f-1);-1<e&&c.length>e&&(c.length=e);-1<d&&c.position>d&&(c.position=d-c.length);-1<d&&c.position+c.length>d&&(c.length=d-c.position);-1<d&&c.position+c.length>d&&(c.position=d-c.length);1<c.strength&&
(c.strength=1);var m=0;if(void 0==t)for(;void 0!=a[m];)m++;else m=t;a[m]=JSON.parse(JSON.stringify(c));c=[{signalID:m,line:c.line,position:c.position,strength:c.strength},{signalID:m,line:c.line,position:c.position+c.length,strength:0}];for(t=0;void 0!=b[t];)t++;b[t]=c[0];h[m]=[t];void 0==k[c[0].position]?k[c[0].position]=[t]:k[c[0].position].push(t);for(l.push(c[0].position);void 0!=b[t];)t++;b[t]=c[1];h[m]=h[m].concat(t);void 0==k[c[1].position]?k[c[1].position]=[t]:k[c[1].position].push(t);l.push(c[1].position);
return m}};this.remove=function(c){if(void 0!=a[c]){delete a[c];for(var e=0;e<h[c].length;e++){var d=h[c][e];k[b[d].position].splice(k[b[d].position].indexOf(d),1);l.splice(l.indexOf(b[d].position),1);0==k[b[d].position].length&&delete k[b[d].position];delete b[d]}delete h[c]}};this.update=function(b,c){void 0!=c&&("line"in c||(c.line=a[b].line),-1<d&&("position"in c&&"length"in c?c.length+c.position>d&&(c.length=d-c.position):("position"in c?a[b].length+c.position>=d&&(c.position=d-a[b].length):
c.position=a[b].position,"length"in c?c.length+c.position>d&&(c.length=d-c.position):c.length=a[b].length)),"strength"in c||(c.strength=a[b].strength),this.remove(b),this.add(c,b))};this.reset=function(){a=[];c=[];b=[];h=[];k={};l=[]}}};this.audio=new function(){this.context=new (window.AudioContext||window.webkitAudioContext);this.changeAudioParam=function(a,b,h,e,d,f){f=void 0===f?!0:f;if(null==h)return b.value;f&&b.cancelScheduledValues(a.currentTime);try{switch(d){case "linear":b.linearRampToValueAtTime(h,
a.currentTime+e);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");0==h&&(h=1E-4);b.exponentialRampToValueAtTime(h,a.currentTime+e);break;case "s":for(var c=h-b.value,k=g.math.curveGenerator.s(10),l=0;l<k.length;l++)k[l]=b.value+k[l]*c;b.setValueCurveAtTime(new Float32Array(k),a.currentTime,e);break;default:b.setTargetAtTime(h,a.currentTime,.001)}}catch(q){console.log("could not change param (possibly due to an overlap, or bad target value)"),
console.log("audioParam:",b,"target:",h,"time:",e,"curve:",d,"cancelScheduledValues:",f),console.log(q)}};this.loadAudioFile=function(a,b,h){h=void 0===h?"":h;switch(void 0===b?"file":b){case "url":b=new XMLHttpRequest;b.open("GET",h,!0);b.responseType="arraybuffer";b.onload=function(){g.audio.context.decodeAudioData(this.response,function(b){a({buffer:b,name:h.split("/").pop(),duration:b.duration})},function(a){console.warn("Error with decoding audio data"+a.err)})};b.send();break;default:var c=
document.createElement("input");c.type="file";c.onchange=function(){var b=this.files[0],h=new FileReader;h.readAsArrayBuffer(b);h.onload=function(h){g.audio.context.decodeAudioData(h.target.result,function(c){a({buffer:c,name:b.name,duration:c.duration})});c.remove()}};document.body.appendChild(c);c.click()}};this.waveformSegment=function(a,b,h){b=void 0===b?{start:0,end:1}:b;h=void 0===h?1E4:h;var c=a.getChannelData(0);b.start=b.start?b.start:0;b.end=b.end?b.end:1;var e=a.length*b.start;a=a.length*
b.end;h=(a-e)/h;for(b=[];e<a;e+=Math.round(h))b.push(g.math.largestValueFound(c.slice(e,e+Math.round(h))));return b};this.loadBuffer=function(a,b,h,e){a=a.createBufferSource();a.buffer=b;a.connect(h);a.onended=e;return a};this.destination=this.context.createGain();this.destination.connect(this.context.destination);this.destination._gain=1;this.destination.masterGain=function(a){if(void 0==a)return this.destination._gain;this._gain=a;g.audio.changeAudioParam(g.audio.context,this.gain,this._gain,.01,
"instant",!0)};this.names_frequencies_split={0:{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,"A#":29.14,B:30.87},1:{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},2:{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.8,A:110,"A#":116.5,B:123.5},3:{C:130.8,"C#":138.6,D:146.8,"D#":155.6,E:164.8,F:174.6,"F#":185,G:196,"G#":207.7,A:220,"A#":233.1,B:246.9},4:{C:261.6,"C#":277.2,
D:293.7,"D#":311.1,E:329.6,F:349.2,"F#":370,G:392,"G#":415.3,A:440,"A#":466.2,B:493.9},5:{C:523.3,"C#":554.4,D:587.3,"D#":622.3,E:659.3,F:698.5,"F#":740,G:784,"G#":830.6,A:880,"A#":932.3,B:987.8},6:{C:1047,"C#":1109,D:1175,"D#":1245,E:1319,F:1397,"F#":1480,G:1568,"G#":1661,A:1760,"A#":1865,B:1976},7:{C:2093,"C#":2217,D:2349,"D#":2489,E:2637,F:2794,"F#":2960,G:3136,"G#":3322,A:3520,"A#":3729,B:3951},8:{C:4186,"C#":4435,D:4699,"D#":4978,E:5274,F:5588,"F#":5920,G:6272,"G#":6645,A:7040,"A#":7459,B:7902}};
this.names_frequencies={};for(var d=Object.entries(this.names_frequencies_split),f=0;f<d.length;f++)for(var e=Object.entries(this.names_frequencies_split[f]),a=0;a<e.length;a++)this.names_frequencies[d[f][0]+e[a][0]]=e[a][1];this.frequencies_names={};d=Object.entries(this.names_frequencies);for(f=0;f<d.length;f++)this.frequencies_names[d[f][1]]=d[f][0];d="0C 0C# 0D 0D# 0E 0F 0F# 0G 0G# 0A 0A# 0B 1C 1C# 1D 1D# 1E 1F 1F# 1G 1G# 1A 1A# 1B 2C 2C# 2D 2D# 2E 2F 2F# 2G 2G# 2A 2A# 2B 3C 3C# 3D 3D# 3E 3F 3F# 3G 3G# 3A 3A# 3B 4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C 7C# 7D 7D# 7E 7F 7F# 7G 7G# 7A 7A# 7B 8C 8C# 8D 8D# 8E 8F 8F# 8G 8G# 8A 8A# 8B".split(" ");
this.midinumbers_names={};for(f=0;f<d.length;f++)this.midinumbers_names[f+24]=d[f];this.names_midinumbers={};d=Object.entries(this.midinumbers_names);for(f=0;f<d.length;f++)this.names_midinumbers[d[f][1]]=parseInt(d[f][0]);this.num2name=function(a){return this.midinumbers_names[a]};this.num2freq=function(a){return this.names_frequencies[this.midinumbers_names[a]]};this.name2num=function(a){return this.names_midinumbers[a]};this.name2freq=function(a){return this.names_frequencies[a]};this.freq2num=
function(a){return this.names_midinumbers[this.frequencies_names[a]]};this.freq2name=function(a){return this.frequencies_names[a]}};this.misc=new function(){this.blendColours=function(d,f,e){function a(a){a=a.split(",");a[0]=a[0].replace("rgba(","");a[3]=a[3].replace(")","");return a.map(function(a){return parseFloat(a)})}d=a(d);f=a(f);for(var c=[],b=0;b<d.length;b++)c[b]=(1-e)*d[b]+e*f[b];return"rgba("+c[0]+","+c[1]+","+c[2]+","+c[3]+")"};this.multiBlendColours=function(d,f){if(0==f)return d[0];
if(1==f)return d[d.length-1];f*=d.length-1;return g.misc.blendColours(d[~~f],d[~~f+1],f%1)};this.padString=function(d,f,e){e=void 0===e?" ":e;if(1>e.length)return d;for(d=""+d;d.length<f;)d=e+d;return d};this.compressString=function(d){return g.thirdparty.lzString.compress(d)};this.decompressString=function(d){return g.thirdparty.lzString.decompress(d)};this.serialize=function(d,f){f=void 0===f?!0:f;d=JSON.stringify(d,function(e,a){switch({}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()){case "function":return{__uniqueType:"function",
__value:a.toString(),__name:a.name};case "arraybuffer":return{__uniqueType:"arraybuffer",__value:btoa(String.fromCharCode(new Uint8Array(a)))};case "audiobuffer":e=[];for(var c=0;c<a.numberOfChannels;c++)e.push(Array.from(a.getChannelData(c)));return{__uniqueType:"audiobuffer",__channelData:e,__sampleRate:a.sampleRate,__numberOfChannels:a.numberOfChannels,__length:a.length};default:return a}});f&&(d=g.misc.compressString(d));return d};this.unserialize=function(d,f){if(void 0!==d)return(void 0===f||
f)&&(d=g.misc.decompressString(d)),JSON.parse(d,function(e,a){if("object"==typeof a&&null!=a&&"__uniqueType"in a)switch(a.__uniqueType){case "function":e=a.__value.substring(0,a.__value.indexOf("{"));e=e.substring(e.indexOf("(")+1,e.lastIndexOf(")"));a=a.__value.substring(a.__value.indexOf("{")+1,a.__value.lastIndexOf("}"));a=Function(e,a);break;case "arraybuffer":a=atob(a.__value);for(e=0;e<a.length;e++)a[e]=a[e].charCodeAt(0);a=new ArrayBuffer(a);break;case "audiobuffer":var c=g.audio.context.createBuffer(a.__numberOfChannels,
a.__length,a.__sampleRate);for(e=0;e<c.numberOfChannels;e++){workingBuffer=c.getChannelData(e);for(var b=0;b<c.length;b++)workingBuffer[b]=a.__channelData[e][b]}a=c;break;default:a=a.__value}return a})};this.openFile=function(d,f){f=void 0===f?"readAsBinaryString":f;var e=document.createElement("input");e.type="file";e.onchange=function(){var a=new FileReader;switch(f){case "readAsArrayBuffer":a.readAsArrayBuffer(this.files[0]);break;default:a.readAsBinaryString(this.files[0])}a.onloadend=function(){d&&
d(a.result)}};e.click()};this.printFile=function(d,f){var e=document.createElement("a");e.href=URL.createObjectURL(new Blob([f]));e.download=d;e.click()}};this.thirdparty=new function(){this.lzString=function(){var d=String.fromCharCode,f={},e={compress:function(a){return null==a?"":e._compress(a,6,function(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(a)})},decompress:function(a){if(null==a)return"";if(""==a)return null;a=a.replace(/ /g,"+");return e._decompress(a.length,
32,function(c){c=a.charAt(c);if(!f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]){f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]={};for(var b=0;65>b;b++)f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(b)]=b}return f["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"][c]})},_compress:function(a,c,b){if(null==a)return"";var e,d={},f={},m="",
t=2,g=3,u=2,q=[],p=0,w=0,x;for(x=0;x<a.length;x+=1){var A=a.charAt(x);Object.prototype.hasOwnProperty.call(d,A)||(d[A]=g++,f[A]=!0);var z=m+A;if(Object.prototype.hasOwnProperty.call(d,z))m=z;else{if(Object.prototype.hasOwnProperty.call(f,m)){if(256>m.charCodeAt(0)){for(e=0;e<u;e++)p<<=1,w==c-1?(w=0,q.push(b(p)),p=0):w++;var y=m.charCodeAt(0);for(e=0;8>e;e++)p=p<<1|y&1,w==c-1?(w=0,q.push(b(p)),p=0):w++,y>>=1}else{y=1;for(e=0;e<u;e++)p=p<<1|y,w==c-1?(w=0,q.push(b(p)),p=0):w++,y=0;y=m.charCodeAt(0);
for(e=0;16>e;e++)p=p<<1|y&1,w==c-1?(w=0,q.push(b(p)),p=0):w++,y>>=1}t--;0==t&&(t=Math.pow(2,u),u++);delete f[m]}else for(y=d[m],e=0;e<u;e++)p=p<<1|y&1,w==c-1?(w=0,q.push(b(p)),p=0):w++,y>>=1;t--;0==t&&(t=Math.pow(2,u),u++);d[z]=g++;m=String(A)}}if(""!==m){if(Object.prototype.hasOwnProperty.call(f,m)){if(256>m.charCodeAt(0)){for(e=0;e<u;e++)p<<=1,w==c-1?(w=0,q.push(b(p)),p=0):w++;y=m.charCodeAt(0);for(e=0;8>e;e++)p=p<<1|y&1,w==c-1?(w=0,q.push(b(p)),p=0):w++,y>>=1}else{y=1;for(e=0;e<u;e++)p=p<<1|y,
w==c-1?(w=0,q.push(b(p)),p=0):w++,y=0;y=m.charCodeAt(0);for(e=0;16>e;e++)p=p<<1|y&1,w==c-1?(w=0,q.push(b(p)),p=0):w++,y>>=1}t--;0==t&&(t=Math.pow(2,u),u++);delete f[m]}else for(y=d[m],e=0;e<u;e++)p=p<<1|y&1,w==c-1?(w=0,q.push(b(p)),p=0):w++,y>>=1;t--;0==t&&u++}y=2;for(e=0;e<u;e++)p=p<<1|y&1,w==c-1?(w=0,q.push(b(p)),p=0):w++,y>>=1;for(;;)if(p<<=1,w==c-1){q.push(b(p));break}else w++;return q.join("")},_decompress:function(a,c,b){var e=[],k=4,f=4,m=3,t=[],g,u,q=b(0),p=c,w=1;for(g=0;3>g;g+=1)e[g]=g;var x=
0;var A=Math.pow(2,2);for(u=1;u!=A;){var z=q&p;p>>=1;0==p&&(p=c,q=b(w++));x|=(0<z?1:0)*u;u<<=1}switch(x){case 0:x=0;A=Math.pow(2,8);for(u=1;u!=A;)z=q&p,p>>=1,0==p&&(p=c,q=b(w++)),x|=(0<z?1:0)*u,u<<=1;var y=d(x);break;case 1:x=0;A=Math.pow(2,16);for(u=1;u!=A;)z=q&p,p>>=1,0==p&&(p=c,q=b(w++)),x|=(0<z?1:0)*u,u<<=1;y=d(x);break;case 2:return""}g=e[3]=y;for(t.push(y);;){if(w>a)return"";x=0;A=Math.pow(2,m);for(u=1;u!=A;)z=q&p,p>>=1,0==p&&(p=c,q=b(w++)),x|=(0<z?1:0)*u,u<<=1;switch(y=x){case 0:x=0;A=Math.pow(2,
8);for(u=1;u!=A;)z=q&p,p>>=1,0==p&&(p=c,q=b(w++)),x|=(0<z?1:0)*u,u<<=1;e[f++]=d(x);y=f-1;k--;break;case 1:x=0;A=Math.pow(2,16);for(u=1;u!=A;)z=q&p,p>>=1,0==p&&(p=c,q=b(w++)),x|=(0<z?1:0)*u,u<<=1;e[f++]=d(x);y=f-1;k--;break;case 2:return t.join("")}0==k&&(k=Math.pow(2,m),m++);if(e[y])y=e[y];else if(y===f)y=g+g.charAt(0);else return null;t.push(y);e[f++]=g+y.charAt(0);k--;g=y;0==k&&(k=Math.pow(2,m),m++)}}};return e}()}};g.core=new function(){var r=new function(){function d(a){for(var b=[];void 0!=(a=
a.parent);)b.unshift({x:a.x,y:a.y,a:a.angle});a={x:void 0!=b[0]?b[0].x:0,y:void 0!=b[0]?b[0].y:0,a:void 0!=b[0]?b[0].a:0};for(var c=1;c<b.length;c++){var e=g.library.math.cartesianAngleAdjust(b[c].x,b[c].y,b[c-1].a);a.a+=b[c].a;a.x+=e.x;a.y+=e.y}return a}var f=this,e=new function(){this.length=function(a){return a*f.viewport.scale()};this.windowPoint2workspacePoint=function(a,b){var c=f.viewport.position(),e=f.viewport.scale()/window.devicePixelRatio,d=f.viewport.angle();a=a/e-c.x;b=b/e-c.y;return g.library.math.cartesianAngleAdjust(a,
b,-d)};this.workspacePoint2windowPoint=function(a,b){var c=f.viewport.position(),e=f.viewport.scale(),d=f.viewport.angle();a=g.library.math.cartesianAngleAdjust(a,b,d);return{x:(a.x+c.x)*e,y:(a.y+c.y)*e}}},a=new function(){this.polygon=function(){this.type="polygon";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.points=[];this.style={fill:"rgba(100,255,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,lineJoin:"round",miterLimit:2,
shadowColour:"rgba(0,0,0,0)",shadowBlur:20,shadowOffset:{x:20,y:20}};this.parameter={};this.parameter.points=function(a){return function(b){if(void 0==b)return a.points;a.points=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?d(this):a;this.extremities={points:[],boundingBox:{}};
this.extremities.points=this.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);
return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(a,b,d,k){b=void 0===b?{x:0,y:0,a:0}:b;d=void 0===d?!1:d;k=void 0===k?!1:k;var c=this._static?!0:g.library.math.detectOverlap.boundingBoxes(f.viewport.getBoundingBox(),this.extremities.boundingBox);if(c){c=this.points.map(function(a){a=g.library.math.cartesianAngleAdjust(a.x,a.y,b.a);return{x:a.x+
b.x,y:a.y+b.y}});var h=this.style.lineWidth,t=this.style.shadowBlur,n=this.style.shadowOffset.x,u=this.style.shadowOffset.y;d||(c=c.map(function(a){return e.workspacePoint2windowPoint(a.x,a.y)}),h=e.length(h),t=e.length(t),n=e.length(n),u=e.length(u));if(k){k=new Path2D;k.moveTo(c[0].x,c[0].y);for(d=1;d<c.length;d++)k.lineTo(c[d].x,c[d].y);a.clip(k)}else{a.fillStyle=this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=h;a.lineJoin=this.style.lineJoin;a.miterLimit=this.style.miterLimit;a.shadowColor=
this.style.shadowColour;a.shadowBlur=t;a.shadowOffsetX=n;a.shadowOffsetY=u;a.beginPath();a.moveTo(c[0].x,c[0].y);for(d=1;d<c.length;d++)a.lineTo(c[d].x,c[d].y);a.closePath();a.fill();a.stroke();if(this.dotFrame){for(d=0;d<this.extremities.points.length;d++)a=e.workspacePoint2windowPoint(this.extremities.points[d].x,this.extremities.points[d].y),f.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);
f.render.drawDot(a.x,a.y);a=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);f.render.drawDot(a.x,a.y)}}}}};this.circle=function(){this.type="circle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.y=this.x=0;this.r=2;this.style={fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,shadowColour:"rgba(0,0,0,0)",shadowBlur:2,shadowOffset:{x:1,y:1}};
this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.r=function(a){return function(b){if(void 0==b)return a.r;a.r=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,
c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?d(this):a;this.extremities={points:[],boundingBox:{},origin:{}};point=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a);this.extremities.origin={x:this.x+a.x,y:this.y+a.y};this.extremities.points=g.library.math.pointsOfCircle(this.x,this.y,this.r,10);this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=
g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return c?g.library.math.distanceBetweenTwoPoints({x:a,y:b},{x:this.x+this.extremities.origin.x,y:this.y+this.extremities.origin.y})<=this.r:!1};this.render=
function(a,b,d,k){b=void 0===b?{x:0,y:0,a:0}:b;d=void 0===d?!1:d;k=void 0===k?!1:k;var c=this._static?!0:g.library.math.detectOverlap.boundingBoxes(f.viewport.getBoundingBox(),this.extremities.boundingBox);if(c){c=g.library.math.cartesianAngleAdjust(this.x,this.y,b.a);b.x+=c.x-this.x;b.y+=c.y-this.y;b={x:this.x+b.x,y:this.y+b.y};c=this.r;var h=this.style.lineWidth,t=this.style.shadowBlur,n=this.style.shadowOffset.x,u=this.style.shadowOffset.y;d||(b=e.workspacePoint2windowPoint(b.x,b.y),c=e.length(c),
h=e.length(h),t=e.length(t),n=e.length(n),u=e.length(u));if(k)d=new Path2D,d.arc(b.x,b.y,c,0,2*Math.PI,!1),a.clip(d);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=h,a.shadowColor=this.style.shadowColour,a.shadowBlur=t,a.shadowOffsetX=n,a.shadowOffsetY=u,a.beginPath(),a.arc(b.x,b.y,c,0,2*Math.PI,!1),a.closePath(),a.fill(),a.stroke(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)d=e.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),
f.render.drawDot(d.x,d.y,4,"rgba(50,50,50,1)");d=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);f.render.drawDot(d.x,d.y);d=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);f.render.drawDot(d.x,d.y);d=e.workspacePoint2windowPoint(this.extremities.origin.x,this.extremities.origin.y);f.render.drawDot(d.x,d.y)}}}};this.canvas=function(){this.type="canvas";this.name="";this._static=
this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;var a=document.createElement("canvas"),b=1;var h=a.getContext("2d",{alpha:!1});a.setAttribute("width",this.width*b);a.setAttribute("height",this.height*b);this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==
b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);this.parameter.width=function(c){return function(e){if(void 0==e)return c.width;c.width=e;c.computeExtremities();a.setAttribute("width",c.width*b)}}(this);this.parameter.height=function(c){return function(e){if(void 0==
e)return c.height;c.height=e;c.computeExtremities();a.setAttribute("height",c.height*b)}}(this);this.resolution=function(c){if(void 0==c)return b;b=c;a.setAttribute("width",this.width*b);a.setAttribute("height",this.height*b)};this._=h;this.$=function(a){return a*b};this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==
a?d(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==
this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(b,c,d){c=void 0===c?{x:0,y:0,a:0}:c;d=void 0===d?!1:d;var h=this._static?!0:g.library.math.detectOverlap.boundingBoxes(f.viewport.getBoundingBox(),
this.extremities.boundingBox);if(h){h=g.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=h.x-this.x;c.y+=h.y-this.y;h={x:this.x+c.x,y:this.y+c.y};c=this.angle+c.a;var k=this.width,l=this.height;d||(h=e.workspacePoint2windowPoint(h.x-this.anchor.x*k,h.y-this.anchor.y*l),k=e.length(k),l=e.length(l));h=g.library.math.cartesianAngleAdjust(h.x,h.y,-c);b.save();b.rotate(c);b.drawImage(a,h.x,h.y,k,l);b.restore();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)d=e.workspacePoint2windowPoint(this.extremities.points[b].x,
this.extremities.points[b].y),f.render.drawDot(d.x,d.y,4,"rgba(50,50,50,1)");d=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);f.render.drawDot(d.x,d.y);d=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);f.render.drawDot(d.x,d.y)}}}};this.image=function(){this.type="image";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],
boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;this.url="";var a={};this.style={shadowColour:"rgba(0,0,0,0)",shadowBlur:2,shadowOffset:{x:1,y:1}};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;
a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);this.parameter.width=function(a){return function(b){if(void 0==b)return a.width;a.width=b;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(b){if(void 0==b)return a.height;a.height=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+
a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?d(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);
void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(b,c,d){c=
void 0===c?{x:0,y:0,a:0}:c;d=void 0===d?!1:d;var h=this._static?!0:g.library.math.detectOverlap.boundingBoxes(f.viewport.getBoundingBox(),this.extremities.boundingBox);if(h){h=g.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=h.x-this.x;c.y+=h.y-this.y;h=this.angle+c.a;var k=this.width,t=this.height;c={x:this.x+c.x-this.anchor.x*(this.width*Math.cos(h)+this.height*Math.sin(-h)),y:this.y+c.y-this.anchor.y*(this.width*Math.sin(h)+this.height*Math.cos(-h))};d||(c=e.workspacePoint2windowPoint(c.x,
c.y),k=e.length(k),t=e.length(t));c=g.library.math.cartesianAngleAdjust(c.x,c.y,-h);a.hasOwnProperty(this.url)||(a[this.url]=new Image,a[this.url].src=this.url);b.save();b.rotate(h);b.drawImage(a[this.url],c.x,c.y,k,t);b.restore();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)d=e.workspacePoint2windowPoint(this.extremities.points[b].x,this.extremities.points[b].y),f.render.drawDot(d.x,d.y,4,"rgba(50,50,50,1)");d=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,
this.extremities.boundingBox.topLeft.y);f.render.drawDot(d.x,d.y);d=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);f.render.drawDot(d.x,d.y)}}}};this.path=function(){this.type="path";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.points=[];this.style={stroke:"rgba(0,0,0,0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:2,shadowColour:"rgba(0,0,0,0)",
shadowBlur:20,shadowOffset:{x:20,y:20}};this.parameter={};this.parameter.points=function(a){return function(b){if(void 0==b)return a.points;a.points=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?d(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=this.points.map(function(b){b=
g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return c?(void 0==this.extremities.points?
(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(a,b,d){b=void 0===b?{x:0,y:0,a:0}:b;d=void 0===d?!1:d;var c=this._static?!0:g.library.math.detectOverlap.boundingBoxes(f.viewport.getBoundingBox(),this.extremities.boundingBox);if(c){c=this.points.map(function(a){a=g.library.math.cartesianAngleAdjust(a.x,a.y,b.a);return{x:a.x+b.x,y:a.y+b.y}});var h=this.style.lineWidth,m=this.style.shadowBlur,
t=this.style.shadowOffset.x,n=this.style.shadowOffset.y;d||(c=c.map(function(a){return e.workspacePoint2windowPoint(a.x,a.y)}),h=e.length(h),m=e.length(m),t=e.length(t),n=e.length(n));a.fillStyle=this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=h;a.lineCap=this.style.lineCap;a.lineJoin=this.style.lineJoin;a.miterLimit=this.style.miterLimit;a.shadowColor=this.style.shadowColour;a.shadowBlur=m;a.shadowOffsetX=t;a.shadowOffsetY=n;a.beginPath();a.moveTo(c[0].x,c[0].y);for(d=1;d<c.length;d++)a.lineTo(c[d].x,
c[d].y);a.stroke();if(this.dotFrame){for(d=0;d<this.extremities.points.length;d++)a=e.workspacePoint2windowPoint(this.extremities.points[d].x,this.extremities.points[d].y),f.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);f.render.drawDot(a.x,a.y);a=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);f.render.drawDot(a.x,a.y)}}}};
this.rectangle=function(){this.type="rectangle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;this.style={fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,shadowColour:"rgba(0,0,0,0)",shadowBlur:2,shadowOffset:{x:1,y:1}};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);
this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(b){if(void 0==b)return a.anchor;a.anchor=b;a.computeExtremities()}}(this);this.parameter.width=function(a){return function(b){if(void 0==b)return a.width;a.width=b;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(b){if(void 0==
b)return a.height;a.height=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.getOffset=function(){return d(this)};this.computeExtremities=function(a,b){b=this._static;for(var c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?d(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);
this.extremities.points=this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);
return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(a,b,d,k){b=void 0===b?{x:0,y:0,a:0}:b;d=void 0===d?!1:d;k=void 0===k?!1:k;var c=this._static?!0:g.library.math.detectOverlap.boundingBoxes(f.viewport.getBoundingBox(),this.extremities.boundingBox);if(c){c=g.library.math.cartesianAngleAdjust(this.x,this.y,b.a);b.x+=c.x-this.x;b.y+=c.y-this.y;c=this.angle+
b.a;var h=this.width,t=this.height,n=this.style.lineWidth,u=this.style.shadowBlur,q=this.style.shadowOffset.x,p=this.style.shadowOffset.y;b={x:this.x+b.x-this.anchor.x*(this.width*Math.cos(c)+this.height*Math.sin(-c)),y:this.y+b.y-this.anchor.y*(this.width*Math.sin(c)+this.height*Math.cos(-c))};d||(b=e.workspacePoint2windowPoint(b.x,b.y),h=e.length(h),t=e.length(t),n=e.length(n),u=e.length(u),q=e.length(q),p=e.length(p));b=g.library.math.cartesianAngleAdjust(b.x,b.y,-c);if(k)a.rotate(c),d=new Path2D,
d.rect(b.x,b.y,h,t),a.clip(d),a.rotate(-c);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=n,a.shadowColor=this.style.shadowColour,a.shadowBlur=u,a.shadowOffsetX=q,a.shadowOffsetY=p,a.save(),a.rotate(c),a.fillRect(b.x,b.y,h,t),a.strokeRect(b.x,b.y,h,t),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)d=e.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),f.render.drawDot(d.x,d.y,4,"rgba(50,50,50,1)");d=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,
this.extremities.boundingBox.topLeft.y);f.render.drawDot(d.x,d.y);d=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);f.render.drawDot(d.x,d.y)}}}};this.group=function(){function a(a,c){if(void 0==c)return a.getAddress()+" >> no element provided";if(void 0==c.name||""==c.name)return a.getAddress()+" >> element has no name";for(var b=0;b<a.children.length;b++)if(a.children[b].name==c.name)return'element with the name "'+c.name+'" already exists in the '+
(void 0==parent?"design root":'group "'+a.name+'"')}this.type="group";this.name="";this.clipActive=this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.children=[];this.clippingStencil;this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities(void 0,!0)}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities(void 0,
!0)}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities(void 0,!0)}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.clip=function(a){if(void 0==a)return this.clipActive;this.clipActive=void 0==this.clippingStencil?!1:a;this.computeExtremities()};this.stencil=function(a){if(void 0==a)return this.clippingStencil;this.clippingStencil=a;this.computeExtremities()};this.prepend=
function(b){var c=a(this,b);void 0!=c?console.error("element invalid:",c):(this.children.unshift(b),b.parent=this,b.computeExtremities(void 0,!0))};this.append=function(b){var c=a(this,b);void 0!=c?console.error("element invalid:",c):(this.children.push(b),b.parent=this,b.computeExtremities(void 0,!0))};this.remove=function(a){void 0!=a&&(a=this.children.indexOf(a),0>a||(this.children.splice(a,1),this.computeExtremities()))};this.clear=function(){this.children=[];this.computeExtremities()};this.contains=
function(a){for(var b=0;b<this.children.length;b++)if(this.children[b]==a)return!0;return!1};this.getChildByName=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b].name==a)return this.children[b]};this.getElementsWithName=function(a){for(var b=[],c=0;c<this.children.length;c++)if(this.children[c].name==a&&b.push(this.children[c]),"group"==this.children[c].type)for(var d=this.children[c].getElementsWithName(a),e=0;e<d.length;e++)b.push(d[e]);return b};this.getOffset=function(){return d(this)};
this.computeExtremities=function(a,c){c=void 0===c?!1:c;for(var b=void 0==a,e=this._static,f=this;void 0!=(f=f.parent)&&!e;)e=e||f._static;this._static=e;a=void 0==a?d(this):a;if(c)for(c={x:a.x,y:a.y,a:a.a+this.angle},e=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a),c.x+=e.x,c.y+=e.y,e=0;e<this.children.length;e++)this.children[e].computeExtremities(c,!0);this.extremities={points:[],boundingBox:{}};if(this.clipActive)c={x:a.x,y:a.y,a:a.a+this.angle},e=g.library.math.cartesianAngleAdjust(this.x,
this.y,a.a),c.x+=e.x,c.y+=e.y,this.clippingStencil.computeExtremities(c),this.extremities.points=this.clippingStencil.extremities.points;else{a=[];for(e=0;e<this.children.length;e++)a.push(this.children[e].extremities.boundingBox.topLeft),a.push(this.children[e].extremities.boundingBox.bottomRight);a=g.library.math.boundingBoxFromPoints(a);this.extremities.points=[{x:a.topLeft.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.bottomRight.y},{x:a.topLeft.x,y:a.bottomRight.y}]}this.extremities.boundingBox=
g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&b&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(this.clipActive)return this.clippingStencil.isPointWithin(a,c);if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),
a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.getElementUnderPoint=function(a,c,d,f){d=void 0===d?!1:d;f=void 0===f?!1:f;for(var b=[],k=this.children.length-1;0<=k;k--){var h=this.children[k]._static||d?e.workspacePoint2windowPoint(a,c):{x:a,y:c};if(!this.children[k].ignored&&this.children[k].isPointWithin(h.x,h.y))if("group"==this.children[k].type){if(h=this.children[k].getElementUnderPoint(a,c,this.children[k]._static||d,f),void 0!=h)if(f)b=
b.concat(h);else return h}else if(f)b.push(this.children[k]);else return this.children[k]}if(f)return b};this.render=function(a,c,d,l){c=void 0===c?{x:0,y:0,a:0}:c;d=void 0===d?!1:d;l=void 0===l?!1:l;a:if(this._static)var b=!0;else{for(b=0;b<this.children.length;b++)if(this.children[b]._static){b=!0;break a}b=g.library.math.detectOverlap.boundingBoxes(f.viewport.getBoundingBox(),this.extremities.boundingBox)}if(b){b=g.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c={a:c.a+this.angle,x:c.x+
b.x,y:c.y+b.y};if(this.clipActive||l)a.save(),this.clippingStencil.render(a,Object.assign({},c),d||this.clippingStencil._static,l||this.clipActive);for(l=0;l<this.children.length;l++)b=this.children[l],b.render(a,Object.assign({},c),d||b._static);this.clipActive&&a.restore();if(this.dotFrame){for(l=0;l<this.extremities.points.length;l++)a=e.workspacePoint2windowPoint(this.extremities.points[l].x,this.extremities.points[l].y),f.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,
this.extremities.boundingBox.topLeft.y);f.render.drawDot(a.x,a.y);a=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);f.render.drawDot(a.x,a.y)}}}};this.text=function(){this.type="text";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.y=this.x=0;this.text="curve";this.angle=0;this.size=1;this.style={font:"30pt Arial",align:"start",baseline:"alphabetic",fill:"rgba(255,100,100,1)",
stroke:"rgba(0,0,0,0)",lineWidth:1,shadowColour:"rgba(0,0,0,0)",shadowBlur:2,shadowOffset:{x:20,y:20}};this.parameter={};this.parameter.x=function(a){return function(b){if(void 0==b)return a.x;a.x=b;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(b){if(void 0==b)return a.y;a.y=b;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(b){if(void 0==b)return a.angle;a.angle=b;a.computeExtremities()}}(this);this.parameter.size=function(a){return function(b){if(void 0==
b)return a.size;a.size=b;a.computeExtremities()}}(this);this.getAddress=function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.computeExtremities=function(a){for(var b=this._static,c=this;void 0!=(c=c.parent)&&!b;)b=b||c._static;this._static=b;a=void 0==a?d(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfText(this.text,this.x,this.y,this.angle,1/this.size,this.style.font,this.style.align,this.style.baseline);this.extremities.points=
this.extremities.points.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,b.y,a.a);b.x+=a.x;b.y+=a.y;return b});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);
return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.render=function(a,b,d,k){b=void 0===b?{x:0,y:0,a:0}:b;d=void 0===d?!1:d;k=void 0===k?!1:k;var c=g.library.math.cartesianAngleAdjust(this.x,this.y,b.a);b.x+=c.x-this.x;b.y+=c.y-this.y;c={x:this.x+b.x,y:this.y+b.y};var h=this.size;b=this.angle+b.a;var t=this.style.lineWidth,n=this.style.shadowBlur,u=this.style.shadowOffset.x,
q=this.style.shadowOffset.y;d||(c=e.workspacePoint2windowPoint(c.x,c.y),h=e.length(h),n=e.length(n),u=e.length(u),q=e.length(q));c=g.library.math.cartesianAngleAdjust(c.x,c.y,-b);if(k)console.warn("no clipping available for text shape");else if(a.font=this.style.font,a.textAlign=this.style.align,a.textBaseline=this.style.baseline,a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=t,a.shadowColor=this.style.shadowColour,a.shadowBlur=n,a.shadowOffsetX=u,a.shadowOffsetY=q,a.save(),
a.rotate(b),a.scale(h,h),a.fillText(this.text,c.x/h,c.y/h),a.shadowColor="rgba(0,0,0,0)",a.strokeText(this.text,c.x/h,c.y/h),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)d=e.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),f.render.drawDot(d.x,d.y,4,"rgba(50,50,50,1)");d=e.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);f.render.drawDot(d.x,d.y);d=e.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,
this.extremities.boundingBox.bottomRight.y);f.render.drawDot(d.x,d.y)}}}};this.arrangement=new function(){var c=new a.group;c.name="root";this.createElement=function(b){return new a[b]};this.clear=function(){c.clear()};this.get=function(){return c};this.set=function(a){c=a};this.prepend=function(a){c.prepend(a)};this.append=function(a){c.append(a)};this.remove=function(a){c.remove(a)};this.getElementUnderPoint=function(a,d,e,f){return c.getElementUnderPoint(a,d,void 0===e?!1:e,void 0===f?!1:f)};this.getElementsWithName=
function(a){return c.getElementsWithName(a)}};this.viewport=new function(){function a(){function a(a){var b=a.charAt(0).toUpperCase()+a.slice(1),e=g.getAttribute("workspace"+b);if(d[a]!=e||d["window"+b]!=window["inner"+b])d[a]=e,d["window"+b]=window["inner"+b],void 0==e?(g[a]=d.defaultSize[a]*window.devicePixelRatio,g.style[a]=d.defaultSize[a]+"px"):e.indexOf("%")==e.length-1?(b=g.parentElement["offset"+b],e=parseFloat(e.slice(0,e.length-1))/100,g[a]=b*e*window.devicePixelRatio,g.style[a]=b*e+"px"):
(g[a]=e*window.devicePixelRatio,g.style[a]=e+"px"),c=!0}var c=!1;a("height");a("width");c&&b()}function b(){f.points.tl=e.windowPoint2workspacePoint(0,0);f.points.tr=e.windowPoint2workspacePoint(g.width,0);f.points.bl=e.windowPoint2workspacePoint(0,g.height);f.points.br=e.windowPoint2workspacePoint(g.width,g.height);f.boundingBox=g.library.math.boundingBoxFromPoints([f.points.tl,f.points.tr,f.points.br,f.points.bl])}var d={defaultSize:{width:640,height:480},width:0,height:0,windowWidth:0,windowHeight:0},
f={position:{x:0,y:0},scale:window.devicePixelRatio,angle:0,points:{tl:{x:0,y:0},tr:{x:0,y:0},bl:{x:0,y:0},br:{x:0,y:0}},boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}}},l=void 0,m=void 0,t=!1,n=!0;this.position=function(a,c){if(void 0==a||void 0==c)return{x:f.position.x,y:f.position.y};f.position.x=a;f.position.y=c;b()};this.scale=function(a){if(void 0==a)return f.scale;f.scale=0==a?window.devicePixelRatio:a;b()};this.angle=function(a){if(void 0==a)return f.angle;f.angle=a;b()};this.windowPoint2workspacePoint=
function(a,b){return e.windowPoint2workspacePoint(a,b)};this.refresh=function(){a();b();this.allowKeyboardInput(n)};this.getBoundingBox=function(){return f.boundingBox};this.mousePosition=function(a,b){if(void 0==a||void 0==b)return{x:l,y:m};l=a;m=b};this.stopMouseScroll=function(a){if(void 0==a)return t;t=a;a||(document.body.style.overflow="")};this.allowKeyboardInput=function(a){if(void 0==a)return n;(n=a)?g.setAttribute("tabIndex",1):g.removeAttribute("tabIndex")};this.cursor=function(a){if(void 0==
a)return document.body.style.cursor;document.body.style.cursor=a}};this.render=new function(){function a(a){void 0!==a&&a||(d.fillStyle="rgb(255,255,255)",d.fillRect(0,0,g.width,g.height));f.arrangement.get().render(d)}function b(c){e=requestAnimationFrame(b);try{a()}catch(m){f.render.active(!1),console.error("major animation error"),console.error(m)}f.stats.collect(c)}var d=g.getContext("2d",{alpha:!1}),e=void 0;this.drawDot=function(a,b,c,e){c=void 0===c?2:c;d.fillStyle=void 0===e?"rgba(150,150,255,1)":
e;d.beginPath();d.arc(a,b,c,0,2*Math.PI,!1);d.closePath();d.fill()};this.frame=function(b){a(void 0===b?!1:b)};this.active=function(a){if(void 0==a)return void 0!=e;a?void 0==e&&b():void 0!=e&&(cancelAnimationFrame(e),e=void 0)}};this.stats=new function(){var a=!1,b=0,d={compute:function(a){this.frameTimeArray.push(1E3/(a-b));30<=this.frameTimeArray.length&&this.frameTimeArray.shift();this.rate=g.library.math.averageArray(this.frameTimeArray);b=a},counter:0,frameTimeArray:[],rate:0},e={recursiveCount:function(a){void 0==
a&&(this.counts={total:0,canvas:0,circle:0,group:0,image:0,path:0,polygon:0,rectangle:0,text:0},a=g.core.arrangement.get());this.counts.total++;switch(a.type){case "canvas":this.counts.canvas++;break;case "circle":this.counts.circle++;break;case "group":this.counts.group++;break;case "image":this.counts.image++;break;case "path":this.counts.path++;break;case "polygon":this.counts.polygon++;break;case "rectangle":this.counts.rectangle++;break;case "text":this.counts.text++}if(void 0!=a.children)for(var b=
0;b<a.children.length;b++)this.recursiveCount(a.children[b])},recursivePrint:function(a,b){b=void 0===b?"":b;void 0==a&&(a=g.core.arrangement.get());console.log(b+a.name);if(void 0!=a.children)for(var c=0;c<a.children.length;c++)this.recursivePrint(a.children[c],b+"- ")},counts:{total:0,canvas:0,circle:0,group:0,image:0,path:0,polygon:0,rectangle:0,text:0}};this.collect=function(b){a&&d.compute(b)};this.active=function(b){if(void 0==b)return a;a=b};this.getReport=function(){e.recursiveCount();return{framesPerSecond:d.rate,
shapeCount:e.counts}}};this.callback=new function(){for(var a="onmousedown onmouseup onmousemove onmouseenter onmouseleave onwheel onclick ondblclick onkeydown onkeyup touchstart touchmove touchend touchenter touchleave touchcancel".split(" "),b={},d=0;d<a.length;b={$jscomp$loop$prop$getRelevantShape$8:b.$jscomp$loop$prop$getRelevantShape$8},d++){b.$jscomp$loop$prop$getRelevantShape$8=function(a,b,c){var d=f.arrangement.getElementUnderPoint(a,b);if(void 0!=d&&void 0==d[c])for(a=f.arrangement.getElementUnderPoint(a,
b,void 0,!0),b=0;b<a.length;b++)if(void 0!=a[b][c]){d=a[b];break}return d};this[a[d]]=function(a,b,c){};var k=0,l=0;g[a[d]]=function(a){return function(b){return function(c){if(f.callback[b]){var d=e.windowPoint2workspacePoint(c.x,c.y),k=a.$jscomp$loop$prop$getRelevantShape$8(d.x,d.y,b);f.callback[b](d.x,d.y,c,k)}}}}(b)(a[d]);g.onmouseover=function(a){return function(b){f.viewport.stopMouseScroll()&&(document.body.style.overflow="hidden");if(f.callback.onmouseover){var c=e.windowPoint2workspacePoint(b.x,
b.y),d=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmouseover");f.callback.onmouseover(c.x,c.y,b,d)}}}(b);g.onmouseout=function(a){return function(b){f.viewport.stopMouseScroll()&&(document.body.style.overflow="");if(f.callback.onmouseout){var c=e.windowPoint2workspacePoint(b.x,b.y),d=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmouseout");f.callback.onmouseout(c.x,c.y,b,d)}}}(b);g.onmousemove=function(a){return function(b){var c=e.windowPoint2workspacePoint(b.x,b.y);f.viewport.mousePosition(c.x,
c.y);if(f.callback.onmousemove){var d=a.$jscomp$loop$prop$getRelevantShape$8(k,l,"onmouseleave"),h=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmouseenter"),g=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onmousemove");d!=h&&(f.callback.onmouseleave(c.x,c.y,b,d),f.callback.onmouseenter(c.x,c.y,b,h));f.callback.onmousemove(c.x,c.y,b,g);k=c.x;l=c.y}}}(b);g.onkeydown=function(a){return function(b){if(f.callback.onkeydown){var c=f.viewport.mousePosition(),d=a.$jscomp$loop$prop$getRelevantShape$8(c.x,
c.y,"onkeydown");f.callback.onkeydown(c.x,c.y,b,d)}}}(b);g.onkeyup=function(a){return function(b){if(f.callback.onkeyup){var c=f.viewport.mousePosition(),d=a.$jscomp$loop$prop$getRelevantShape$8(c.x,c.y,"onkeyup");f.callback.onkeyup(c.x,c.y,b,d)}}}(b)}};f.viewport.refresh();f.arrangement.clear()};this.arrangement=new function(){this.get=function(){return r.arrangement.get()};this.set=function(d){return r.arrangement.set(d)};this.createElement=function(d){return r.arrangement.createElement(d)};this.append=
function(d){return r.arrangement.append(d)};this.prepend=function(d){return r.arrangement.prepend(d)};this.remove=function(d){return r.arrangement.remove(d)};this.getElementUnderPoint=function(d,f){return r.arrangement.getElementUnderPoint(d,f)};this.getElementsWithName=function(d){return r.arrangement.getElementsWithName(d)};this.forceRefresh=function(d){return r.arrangement.forceRefresh(d)}};this.viewport=new function(){this.position=function(d,f){return r.viewport.position(d,f)};this.scale=function(d){return r.viewport.scale(d)};
this.angle=function(d){return r.viewport.angle(d)};this.windowPoint2workspacePoint=function(d,f){return r.viewport.windowPoint2workspacePoint(d,f)};this.refresh=function(){r.viewport.refresh()};this.mousePosition=function(){return r.viewport.mousePosition()};this.stopMouseScroll=function(d){return r.viewport.stopMouseScroll(d)};this.allowKeyboardInput=function(d){return r.viewport.allowKeyboardInput(d)};this.cursor=function(d){return r.viewport.cursor(d)}};this.render=new function(){this.frame=function(d){return r.render.frame(void 0===
d?!1:d)};this.active=function(d){return r.render.active(d)}};this.stats=new function(){this.active=function(d){return r.stats.active(d)};this.getReport=function(){return r.stats.getReport()}};this.callback=new function(){this.onmousedown=function(d,f,e,a){};r.callback.onmousedown=function(d){return function(f,e,a,c){d.onmousedown(f,e,a,c)}}(this);this.onmouseup=function(d,f,e,a){};r.callback.onmouseup=function(d){return function(f,e,a,c){d.onmouseup(f,e,a,c)}}(this);this.onmousemove=function(d,f,
e,a){};r.callback.onmousemove=function(d){return function(f,e,a,c){d.onmousemove(f,e,a,c)}}(this);this.onmouseenter=function(d,f,e,a){};r.callback.onmouseenter=function(d){return function(f,e,a,c){d.onmouseenter(f,e,a,c)}}(this);this.onmouseleave=function(d,f,e,a){};r.callback.onmouseleave=function(d){return function(f,e,a,c){d.onmouseleave(f,e,a,c)}}(this);this.onwheel=function(d,f,e,a){};r.callback.onwheel=function(d){return function(f,e,a,c){d.onwheel(f,e,a,c)}}(this);this.onclick=function(d,f,
e,a){};r.callback.onclick=function(d){return function(f,e,a,c){d.onclick(f,e,a,c)}}(this);this.ondblclick=function(d,f,e,a){};r.callback.ondblclick=function(d){return function(f,e,a,c){d.ondblclick(f,e,a,c)}}(this);this.onkeydown=function(d,f,e,a){};r.callback.onkeydown=function(d){return function(f,e,a,c){d.onkeydown(f,e,a,c)}}(this);this.onkeyup=function(d,f,e,a){};r.callback.onkeyup=function(d){return function(f,e,a,c){d.onkeyup(f,e,a,c)}}(this);this.touchstart=function(d,f,e){};r.callback.touchstart=
function(d){return function(f,e,a,c){d.touchstart(f,e,a)}}(this);this.touchmove=function(d,f,e){};r.callback.touchmove=function(d){return function(f,e,a,c){d.touchmove(f,e,a)}}(this);this.touchend=function(d,f,e){};r.callback.touchend=function(d){return function(f,e,a,c){d.touchend(f,e,a)}}(this);this.touchenter=function(d,f,e){};r.callback.touchenter=function(d){return function(f,e,a,c){d.touchenter(f,e,a)}}(this);this.touchleave=function(d,f,e){};r.callback.touchleave=function(d){return function(f,
e,a,c){d.touchleave(f,e,a)}}(this);this.touchcancel=function(d,f,e){};r.callback.touchcancel=function(d){return function(f,e,a,c){d.touchcancel(f,e,a)}}(this)}};g.system=new function(){};g.system.mouse=new function(){function r(d,f,e,a,c){if(void 0==c)return!1;do if(void 0!=c[d])return c[d](f,e,a),!0;while(void 0!=(c=c.parent));return!1}this.tmp={};this.functionList={};this.mouseInteractionHandler=function(d,f){g.system.mouse.tmp.onmousemove_old=g.onmousemove;g.system.mouse.tmp.onmouseleave_old=g.onmouseleave;
g.system.mouse.tmp.onmouseup_old=g.onmouseup;g.onmousemove=function(e){void 0!=d&&d(e)};g.onmouseup=function(d){void 0!=f&&f(d);g.onmousemove=g.system.mouse.tmp.onmousemove_old;g.onmouseleave=g.system.mouse.tmp.onmouseleave_old;g.onmouseup=g.system.mouse.tmp.onmouseup_old};g.onmouseleave=g.onmouseup};this.forceMouseUp=function(){g.onmouseup()};g.core.callback.onmousedown=function(d,f,e,a){r("onmousedown",d,f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmousedown,g.system.keyboard.pressedKeys)({event:e,
x:d,y:f})};g.core.callback.onmousemove=function(d,f,e,a){r("onmousemove",d,f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmousemove,g.system.keyboard.pressedKeys)({event:e,x:d,y:f})};g.core.callback.onmouseup=function(d,f,e,a){r("onmouseup",d,f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseup,g.system.keyboard.pressedKeys)({event:e,x:d,y:f})};g.core.callback.onmouseleave=function(d,f,e,a){r("onmouseleave",d,f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseleave,
g.system.keyboard.pressedKeys)({event:e,x:d,y:f})};g.core.callback.onmouseenter=function(d,f,e,a){r("onmouseenter",d,f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseenter,g.system.keyboard.pressedKeys)({event:e,x:d,y:f})};g.core.callback.onwheel=function(d,f,e,a){r("onwheel",d,f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onwheel,g.system.keyboard.pressedKeys)({event:e,x:d,y:f})};g.core.callback.onclick=function(d,f,e,a){r("onclick",d,
f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onclick,g.system.keyboard.pressedKeys)({event:e,x:d,y:f})};g.core.callback.ondblclick=function(d,f,e,a){r("ondblclick",d,f,e,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.ondblclick,g.system.keyboard.pressedKeys)({event:e,x:d,y:f})};this.functionList.onmousedown=[];this.functionList.onmousemove=[];this.functionList.onmouseup=[];this.functionList.onmouseleave=[];this.functionList.onmouseenter=[];this.functionList.onwheel=
[];this.functionList.onclick=[];this.functionList.ondblclick=[]};g.system.keyboard=new function(){function r(d,e,a,c,b){if(void 0==b)return!1;do if(void 0!=b[d])return b[d](e,a,c),!0;while(void 0!=(b=b.parent));return!1}function d(d,e){var a=g.system.keyboard.pressedKeys;if("ControlLeft"==d.code||"ControlRight"==d.code)a.control=e;else if("AltLeft"==d.code||"AltRight"==d.code)a.alt=e;else if("MetaLeft"==d.code||"MetaRight"==d.code)a.meta=e;else if("ShiftLeft"==d.code||"ShiftRight"==d.code)a.shift=
e;-1!=window.navigator.platform.indexOf("Mac")&&(a.option=a.alt,a.command=a.meta)}g.core.callback.onkeydown=function(f,e,a,c){g.system.keyboard.pressedKeys[a.code]||(g.system.keyboard.pressedKeys[a.code]=!0,d(a,!0),r("onkeydown",f,e,a,c)||g.library.structure.functionListRunner(g.system.keyboard.functionList.onkeydown,g.system.keyboard.pressedKeys)({event:a,x:f,y:e}))};g.core.callback.onkeyup=function(f,e,a,c){g.system.keyboard.pressedKeys[a.code]&&(delete g.system.keyboard.pressedKeys[a.code],d(a,
!1),r("onkeyup",f,e,a,c)||g.library.structure.functionListRunner(g.system.keyboard.functionList.onkeyup,g.system.keyboard.pressedKeys)({event:a,x:f,y:e}))};this.releaseAll=function(){for(var d=0;d<this.pressedKeys.length;d++)this.releaseKey(this.pressedKeys[d])};this.releaseKey=function(d){g.onkeyup(new KeyboardEvent("keyup",{code:d}))};this.pressedKeys={control:!1,alt:!1,meta:!1};this.functionList={};this.functionList.onkeydown=[];this.functionList.onkeyup=[]};g.system.pane={};g.system.pane.background=
g.core.arrangement.createElement("group");g.system.pane.background.name="background";g.system.pane.background._static=!0;g.system.pane.background.ignored=!0;g.core.arrangement.append(g.system.pane.background);g.system.pane.middleground=g.core.arrangement.createElement("group");g.system.pane.middleground.name="middleground";g.core.arrangement.append(g.system.pane.middleground);g.system.pane.middleground.back=g.core.arrangement.createElement("group");g.system.pane.middleground.back.name="back";g.system.pane.middleground.append(g.system.pane.middleground.back);
g.system.pane.middleground.middle=g.core.arrangement.createElement("group");g.system.pane.middleground.middle.name="middle";g.system.pane.middleground.append(g.system.pane.middleground.middle);g.system.pane.middleground.front=g.core.arrangement.createElement("group");g.system.pane.middleground.front.name="front";g.system.pane.middleground.append(g.system.pane.middleground.front);g.system.pane.foreground=g.core.arrangement.createElement("group");g.system.pane.foreground.name="foreground";g.system.pane.foreground._static=
!0;g.core.arrangement.append(g.system.pane.foreground);g.system.pane.b=g.system.pane.background;g.system.pane.mb=g.system.pane.middleground.back;g.system.pane.mm=g.system.pane.middleground.middle;g.system.pane.mf=g.system.pane.middleground.front;g.system.pane.f=g.system.pane.foreground;g.system.pane.getMiddlegroundPane=function(r){do{if(r==g.system.pane.mb)return g.system.pane.mb;if(r==g.system.pane.mm)return g.system.pane.mm;if(r==g.system.pane.mf)return g.system.pane.mf}while(void 0!=(r=r.parent))};
g._interface=new function(){var r=this;this.circuit=new function(){this.alpha=new function(){this.recorder=function(d){function f(){switch(a.recordingNode.node.state){case "inactive":case "paused":return e.recordingLength;case "recording":return d.currentTime-e.recordingStartTime}}var e={recordedChunks:[],recordingStartTime:-1,recordingLength:0},a={leftIn:{},rightIn:{},recordingNode:{},leftOut:{},rightOut:{}};a.leftIn.node=d.createAnalyser();a.rightIn.node=d.createAnalyser();a.recordingNode.audioDest=
new MediaStreamAudioDestinationNode(d);a.recordingNode.node=new MediaRecorder(a.recordingNode.audioDest.stream,{mimeType:"audio/webm"});a.recordingNode.node.onstart=function(){};a.recordingNode.node.ondataavailable=function(a){e.recordedChunks.push(a.data)};a.recordingNode.node.onpause=function(){};a.recordingNode.node.onresume=function(){};a.recordingNode.node.onerror=function(a){console.log(a)};a.recordingNode.node.onstop=function(){};a.leftIn.node.connect(a.recordingNode.audioDest);a.rightIn.node.connect(a.recordingNode.audioDest);
a.leftOut.node=d.createAnalyser();a.leftIn.node.connect(a.leftOut.node);a.rightOut.node=d.createAnalyser();a.rightIn.node.connect(a.rightOut.node);this.clear=function(){this.stop();e.recordedChunks=[];e.recordingStartTime=-1;e.recordingLength=0};this.start=function(){this.clear();a.recordingNode.node.start();e.recordingStartTime=d.currentTime};this.pause=function(){"inactive"!=this.state()&&(e.recordingLength=f(),a.recordingNode.node.pause())};this.resume=function(){a.recordingNode.node.resume();
e.recordingStartTime=d.currentTime-e.recordingLength};this.stop=function(){"inactive"!=this.state()&&(e.recordingLength=f(),a.recordingNode.node.stop())};this.export=function(){return new Blob(e.recordedChunks,{type:"audio/ogg; codecs=opus"})};this.save=function(a){a=void 0===a?"output":a;var b=document.createElement("a");b.href=URL.createObjectURL(this.export());b.download=a+".ogg";document.body.appendChild(b);b.click();document.body.removeChild(b)};this.state=function(){return a.recordingNode.node.state};
this.recordingTime=function(){return f()};this.getTrack=function(){return this.export()};this.in_left=function(){return a.leftIn.node};this.in_right=function(){return a.rightIn.node};this.out_left=function(){return a.leftOut.node};this.out_right=function(){return a.rightOut.node}};this.audioIn=function(d,f){f=void 0===f?!0:f;var e=1;var a=d.createGain();g.library.audio.changeAudioParam(d,a.gain,e);this.out=function(){return a};this.listDevices=function(a){navigator.mediaDevices.enumerateDevices().then(function(b){a(b.filter(function(a){return"audioinput"===
a.kind}))})};this.selectDevice=function(c){navigator.mediaDevices.getUserMedia({audio:{deviceId:c}}).then(function(b){audioDevice=b;g.library.audio.context.createMediaStreamSource(b).connect(a)},function(a){console.warn('could not find audio input device: "'+c+'"');console.warn("\terror:",a)})};this.gain=function(c){if(null==c)return e;e=c;g.library.audio.changeAudioParam(d,a.gain,c)};f&&this.selectDevice("default")};this.looper=function(d){var f=this,e=!1,a=1,c=!0,b=0,h=1,k={},l=null,m={};m=d.createChannelSplitter(2);
var t=d.createGain();t.gain.setTargetAtTime(1,d.currentTime,0);m.connect(t,0);var n=d.createGain();n.gain.setTargetAtTime(1,d.currentTime,0);m.connect(n,1);this.out_left=function(){return t};this.out_right=function(){return n};this.load=function(a,b,c){e=!1;g.library.audio.loadAudioFile(function(a){f.stop();k=a;e=!0;b(a)},a,void 0===c?"":c)};this.start=function(){e&&(l&&(l.onended=function(){},l.stop(0)),l=g.library.audio.loadBuffer(d,k.buffer,m),l.playbackRate.value=a,l.loop=c,l.loopStart=b*this.duration(),
l.loopEnd=h*this.duration(),l.start(0,0),l.onended=function(){l=null})};this.stop=function(){e&&l&&(l.stop(0),l=void 0)};this.rate=function(){a=value};this.duration=function(){return e?k.duration:-1};this.title=function(){return e?k.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&e?g.library.audio.waveformSegment(k.buffer,a):[]};this.loop=function(a){if(void 0==data)return data;c=void 0===a?!1:a};this.loopBounds=function(a){a=void 0===a?{start:0,end:1}:a;
if(void 0==a)return a;b=void 0!=a.start?a.start:b;h=void 0!=a.end?a.end:h}};this.oneShot_single=function(d){var f=this,e=!1,a=1,c={},b=null,h={};h=d.createChannelSplitter(2);var k=d.createGain();k.gain.setTargetAtTime(1,d.currentTime,0);h.connect(k,0);var l=d.createGain();l.gain.setTargetAtTime(1,d.currentTime,0);h.connect(l,1);this.out_left=function(){return k};this.out_right=function(){return l};this.load=function(a,b,d){e=!1;g.library.audio.loadAudioFile(function(a){f.stop();c=a;e=!0;b(a)},a,void 0===
d?"":d)};this.fire=function(){e&&(b&&(b.onended=function(){},b.stop(0)),b=g.library.audio.loadBuffer(d,c.buffer,h),b.playbackRate.value=a,b.start(0,0),b.onended=function(){b=null})};this.stop=function(){e&&(b.stop(0),b=void 0)};this.rate=function(){a=value};this.duration=function(){return e?c.duration:-1};this.title=function(){return e?c.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&e?g.library.audio.waveformSegment(c.buffer,a):[]}};this.oneShot_multi=
function(d){var f=this,e=!1,a=1,c={},b=[],h={};h=d.createChannelSplitter(2);var k=d.createGain();k.gain.setTargetAtTime(1,d.currentTime,0);h.connect(k,0);var l=d.createGain();l.gain.setTargetAtTime(1,d.currentTime,0);h.connect(l,1);this.audioOut=function(a){switch(a){case "r":return l;case "l":return k;default:console.error('"part.circuit.alpha.oneShot_multi.audioOut" unknown channel "'+a+'"')}};this.out_left=function(){return this.audioOut("l")};this.out_right=function(){return this.audioOut("r")};
this.loadRaw=function(a){0!==Object.keys(a).length&&(c=a,e=!0)};this.load=function(a,b,c){e=!1;g.library.audio.loadAudioFile(function(a){f.loadRaw(a);void 0!=b&&b(a)},a,c)};this.unloadRaw=function(){return c};this.fire=function(f,k){f=void 0===f?0:f;if(e){var t=g.library.audio.loadBuffer(d,c.buffer,h,function(){b.splice(b.indexOf(this),1)});t.playbackRate.value=a;t.start(0,f*a,k*a);b.push(t)}};this.panic=function(){for(;0<b.length;)b.shift().stop(0)};this.rate=function(b){if(void 0==b)return a;0==
b&&(b=1E-6);a=b};this.duration=function(){return e?c.duration/a:-1};this.title=function(){return e?c.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&e?g.library.audio.waveformSegment(c.buffer,a):[]}};this.audio2percentage=function(){return new function(){var d=null,f=null;var e=g.library.audio.context.createAnalyser();e.fftSize=128;d=new Uint8Array(e.fftSize);new Uint8Array(e.fftSize);this.__render=function(){e.getByteTimeDomainData(d);for(var a=[],c=0;c<
d.length;c++)a.push(d[c]/128-1);var b=0;a.forEach(function(a){Math.abs(a)>b&&(b=Math.abs(a))});this.newValue(b)};this.audioIn=function(){return e};this.start=function(){f=setInterval(function(a){a.__render()},1E3/30,this)};this.stop=function(){clearInterval(f)};this.newValue=function(a){}}};this.reverbUnit=function(d){function f(c,b,e){var f=new XMLHttpRequest;f.open("GET",c+b,!0);f.responseType="arraybuffer";f.onload=function(){a.reverbNode.node.disconnect();a.reverbNode.node=d.createConvolver();
a.reverbGain.node.connect(a.reverbNode.node);a.reverbNode.node.connect(a.outAggregator.node);d.decodeAudioData(f.response,function(b){a.reverbNode.node.buffer=b},function(a){console.warn("Error with decoding audio data"+a.err)});e&&e()};f.send()}function e(a,b){b=void 0===b?null:b;var c=new XMLHttpRequest;c.open("GET",a+"available2.list",!0);c.onload=function(){var a=c.response.split("\n");a[a.length-1]=a[a.length-1].split("");a[a.length-1].pop();a[a.length-1]=a[a.length-1].join("");a.splice(-1,1);
null==b?console.log(a):b(a)};c.send()}var a={inAggregator:{},reverbGain:{},bypassGain:{},reverbNode:{},outAggregator:{}};a.inAggregator.gain=1;a.inAggregator.node=d.createGain();g.library.audio.changeAudioParam(d,a.inAggregator.node.gain,a.inAggregator.gain,.01,"instant",!0);a.reverbGain.gain=.5;a.bypassGain.gain=.5;a.reverbGain.node=d.createGain();a.bypassGain.node=d.createGain();g.library.audio.changeAudioParam(d,a.reverbGain.node.gain,a.reverbGain.gain,.01,"instant",!0);g.library.audio.changeAudioParam(d,
a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0);a.reverbNode.impulseResponseRepoURL="https://metasophiea.com/lib/audio/impulseResponse/";a.reverbNode.selectedReverbType="Musikvereinsaal.wav";a.reverbNode.node=d.createConvolver();a.outAggregator.gain=1;a.outAggregator.node=d.createGain();g.library.audio.changeAudioParam(d,a.outAggregator.node.gain,a.outAggregator.gain,.01,"instant",!0);a.inAggregator.node.connect(a.reverbGain.node);a.inAggregator.node.connect(a.bypassGain.node);a.reverbGain.node.connect(a.reverbNode.node);
a.bypassGain.node.connect(a.outAggregator.node);a.reverbNode.node.connect(a.outAggregator.node);this.in=function(){return a.inAggregator.node};this.out=function(){return a.outAggregator.node};this.getTypes=function(c){e(a.reverbNode.impulseResponseRepoURL,c)};this.type=function(c,b){if(null==c)return a.reverbNode.selectedReverbType;a.reverbNode.selectedReverbType=c;f(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType,b)};this.outGain=function(c){if(null==c)return a.outAggregator.gain;
a.outAggregator.gain=c;g.library.audio.changeAudioParam(d,a.outAggregator.node.gain,c,.01,"instant",!0)};this.wetdry=function(c){if(null==c)return a.reverbGain.gain;a.reverbGain.gain=c;a.bypassGain.gain=1-c;g.library.audio.changeAudioParam(d,a.reverbGain.node.gain,a.reverbGain.gain,.01,"instant",!0);g.library.audio.changeAudioParam(d,a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0)};f(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType)};this.multibandFilter=function(d,f,
e){function a(a){var b={frequency:110,Q:.1,node:d.createBiquadFilter()};b.node.type=a;g.library.audio.changeAudioParam(d,b.node.frequency,110,.01,"instant",!0);g.library.audio.changeAudioParam(d,b.node.Q,.1,.01,"instant",!0);return b}e=void 0===e?!1:e;var c=[],b=[],h=[],k=[];var l=d.createGain();g.library.audio.changeAudioParam(d,l.gain,1,.01,"instant",!0);if(e){2>f&&(f=2);h.push(a("lowpass"));for(e=1;e<f-1;e++)h.push(a("bandpass"));h.push(a("highpass"))}else for(e=0;e<f;e++)h.push(a("bandpass"));
for(e=0;e<f;e++){var m={gain:1,node:d.createGain()};g.library.audio.changeAudioParam(d,m.node.gain,m.gain,.01,"instant",!0);k.push(m);c[e]={Q:.1,gain:1,frequency:110,fresh:!0}}var t=1;var n=d.createGain();g.library.audio.changeAudioParam(d,n.gain,t,.01,"instant",!0);for(e=0;e<f;e++)l.connect(h[e].node),h[e].node.connect(k[e].node),k[e].node.connect(n);this.in=function(){return l};this.out=function(){return n};this.masterGain=function(a){if(void 0==a)return t;t=a;g.library.audio.changeAudioParam(d,
n.gain,t,.01,"instant",!0)};this.gain=function(a,b){if(void 0==b)return k[a].gain;k[a].gain=b;g.library.audio.changeAudioParam(d,k[a].node.gain,k[a].gain,.01,"instant",!0);c[a].gain=b;c[a].fresh=!0};this.frequency=function(a,b){if(void 0==b)return h[a].frequency;h[a].frequency=b;g.library.audio.changeAudioParam(d,h[a].node.frequency,h[a].frequency,.01,"instant",!0);c[a].frequency=b;c[a].fresh=!0};this.Q=function(a,b){if(void 0==b)return h[a].Q;h[a].Q=b;g.library.audio.changeAudioParam(d,h[a].node.Q,
h[a].Q,.01,"instant",!0);c[a].Q=b;c[a].fresh=!0};this.measureFrequencyResponse=function(a,d){var e=this;if(void 0==a)return Array(f).fill(0).map(function(a,b){return e.measureFrequencyResponse(b,d)});if(!c[a].fresh)return[b[a].magResponse.map(function(a){return a*t}),b[a].requencyArray];var g=new Float32Array(d),l=new Float32Array(g.length),m=new Float32Array(g.length);h[a].node.getFrequencyResponse(g,l,m);b[a]={magResponse:l.map(function(b){return b*k[a].gain}),phaseResponse:m,frequencyArray:d};
c[a].fresh=!1;return[l.map(function(b){return b*k[a].gain*t}),d]}};this.distortionUnit=function(d){function f(){e.inAggregator.node.disconnect();e.distortionNode.node&&e.distortionNode.node.disconnect();e.distortionNode.node=d.createWaveShaper();e.distortionNode.curve=new Float32Array(g.library.math.curveGenerator.s(e.distortionNode.resolution,-1,1,e.distortionNode.distortionAmount));e.distortionNode.node.curve=e.distortionNode.curve;e.distortionNode.node.oversample=e.distortionNode.oversample;e.inAggregator.node.connect(e.distortionNode.node);
e.distortionNode.node.connect(e.outAggregator.node)}var e={inAggregator:{},distortionNode:{},outAggregator:{}};e.inAggregator.gain=0;e.inAggregator.node=d.createGain();g.library.audio.changeAudioParam(d,e.inAggregator.node.gain,e.inAggregator.gain,.01,"instant",!0);e.distortionNode.distortionAmount=0;e.distortionNode.oversample="none";e.distortionNode.resolution=100;e.outAggregator.gain=0;e.outAggregator.node=d.createGain();g.library.audio.changeAudioParam(d,e.outAggregator.node.gain,e.outAggregator.gain,
.01,"instant",!0);this.in=function(){return e.inAggregator.node};this.out=function(){return e.outAggregator.node};this.inGain=function(a){if(null==a)return e.inAggregator.gain;e.inAggregator.gain=a;g.library.audio.changeAudioParam(d,e.inAggregator.node.gain,a,.01,"instant",!0)};this.outGain=function(a){if(null==a)return e.outAggregator.gain;e.outAggregator.gain=a;g.library.audio.changeAudioParam(d,e.outAggregator.node.gain,a,.01,"instant",!0)};this.distortionAmount=function(a){if(null==a)return e.distortionNode.distortionAmount;
e.distortionNode.distortionAmount=a;f()};this.oversample=function(a){if(null==a)return e.distortionNode.oversample;e.distortionNode.oversample=a;f()};this.resolution=function(a){if(null==a)return e.distortionNode.resolution;e.distortionNode.resolution=2<=a?a:2;f()};f()};this.player=function(d){function f(){clearInterval(a.loop.timeout);a.playhead.position=a.itself.currentTime();a.playhead.lastSightingTime=d.currentTime;if(a.loop.active&&a.playing){var b=a.loop.end-a.itself.currentTime();0>b&&(b=0);
a.loop.timeout=setTimeout(function(){a.itself.jumpTo(a.loop.start,!1);f()},1E3*b/a.rate)}}function e(b){a.fileLoaded&&(a.playing?(a.loop.active&&b>a.loop.end&&(b=a.loop.start),a.itself.stop(function(){a.playhead.position=b;a.playhead.lastSightingTime=d.currentTime;a.itself.start()})):(a.playhead.position=b,a.playhead.lastSightingTime=d.currentTime))}var a={itself:this,fileLoaded:!1,playing:!1,playhead:{position:0,lastSightingTime:0},loop:{active:!1,start:0,end:1,timeout:null},rate:1},c={},b=null,
h={};h=d.createChannelSplitter(2);var k=d.createGain();k.gain.setTargetAtTime(1,d.currentTime,0);h.connect(k,0);var l=d.createGain();l.gain.setTargetAtTime(1,d.currentTime,0);h.connect(l,1);this.out_left=function(){return k};this.out_right=function(){return l};this.unloadRaw=function(){return c};this.loadRaw=function(b,d){0!==Object.keys(b).length&&(a.itself.stop(),c=b,a.fileLoaded=!0,a.playhead.position=0,d(b))};this.load=function(b,d,e){a.fileLoaded=!1;g.library.audio.loadAudioFile(function(b){a.itself.stop();
c=b;a.fileLoaded=!0;a.playhead.position=0;d(b)},b,void 0===e?"":e)};this.start=function(){!a.playing&&a.fileLoaded&&(b=g.library.audio.loadBuffer(d,c.buffer,h,function(b){a.itself.stop()}),b.loop=a.loop.active,b.loopStart=a.loop.start,b.loopEnd=a.loop.end,b.playbackRate.value=a.rate,b.start(0,a.playhead.position),a.playhead.lastSightingTime=d.currentTime,a.playing=!0,f())};this.stop=function(c){a.playing&&(c&&(b.onended=function(){c()}),b.stop(0),b=void 0,f(),a.playing=!1)};this.jumpTo=function(a,
b){a=void 0===a?0:a;void 0===b||b?(a=1<a?1:a,a=0>a?0:a,e(this.duration()*a)):e(a);f()};this.loop=function(c,d){c=void 0===c?{active:!1,start:0,end:1}:c;d=void 0===d?!0:d;if(void 0==c)return a.loop;void 0!=c.active&&(a.loop.active=c.active,b&&(b.loop=c.active));if(void 0!=c.start||void 0!=c.end)d=d?this.duration():1,a.loop.start=void 0!=c.start?c.start*d:a.loop.start,a.loop.end=void 0!=c.end?c.end*d:a.loop.end,b&&(b.loopStart=a.loop.start,b.loopEnd=a.loop.end);f()};this.rate=function(c){c=void 0===
c?1:c;a.rate=c;b&&(b.playbackRate.value=c);f()};this.isLoaded=function(){return a.fileLoaded};this.duration=function(){return a.fileLoaded?c.duration:-1};this.title=function(){return a.fileLoaded?c.name:""};this.currentTime=function(){return a.fileLoaded?a.playing?a.playhead.position+a.rate*(d.currentTime-a.playhead.lastSightingTime):a.playhead.position:-1};this.progress=function(){return this.currentTime()/this.duration()};this.waveformSegment=function(b,d){b=void 0===b?{start:0,end:1}:b;return void 0!=
b&&a.fileLoaded?g.library.audio.waveformSegment(c.buffer,b,d):[]}};this.channelMultiplier=function(d,f){f=void 0===f?2:f;var e=[];var a=1;var c=d.createGain();g.library.audio.changeAudioParam(d,c.gain,a,.01,"instant",!0);for(var b=0;b<f;b++){var h={gain:.5,node:d.createGain()};g.library.audio.changeAudioParam(d,h.node.gain,h.gain,.01,"instant",!0);e.push(h);c.connect(h.node)}this.in=function(){return c};this.out=function(a){return e[a].node};this.inGain=function(b){if(void 0==b)return a;a=b;g.library.audio.changeAudioParam(d,
c.gain,a,.01,"instant",!0)};this.outGain=function(a,b){if(void 0==b)return e[a].gain;e[a].gain=b;g.library.audio.changeAudioParam(d,e[a].node.gain,e[a].gain,.01,"instant",!0)}};this.filterUnit=function(d){var f=d.createGain();g.library.audio.changeAudioParam(d,f.gain,1,.01,"instant",!0);var e=d.createBiquadFilter();e.type="lowpass";g.library.audio.changeAudioParam(d,e.frequency,110,.01,"instant",!0);g.library.audio.changeAudioParam(d,e.gain,1,.01,"instant",!0);g.library.audio.changeAudioParam(d,e.Q,
.1,.01,"instant",!0);var a=d.createGain();g.library.audio.changeAudioParam(d,a.gain,1,.01,"instant",!0);f.connect(e);e.connect(a);this.in=function(){return f};this.out=function(){return a};this.type=function(a){e.type=a};this.frequency=function(a){g.library.audio.changeAudioParam(d,e.frequency,a,.01,"instant",!0)};this.gain=function(a){g.library.audio.changeAudioParam(d,e.gain,a,.01,"instant",!0)};this.Q=function(a){g.library.audio.changeAudioParam(d,e.Q,a,.01,"instant",!0)};this.measureFrequencyResponse=
function(a,b,d){for(var c=[];a<b;a+=d)c.push(a);return this.measureFrequencyResponse_values(c)};this.measureFrequencyResponse_values=function(a){var b=new Float32Array(a),c=new Float32Array(b.length),d=new Float32Array(b.length);e.getFrequencyResponse(b,c,d);return[c,a]}};this.synthesizer=function(d,f,e,a,c,b,h,k,l,m,t,n,u,q,p,w){e=void 0===e?{sin:[0,1],cos:[0,0]}:e;a=void 0===a?1:a;c=void 0===c?0:c;b=void 0===b?0:b;h=void 0===h?.01:h;k=void 0===k?1:k;l=void 0===l?{time:.01,curve:"linear"}:l;m=void 0===
m?{time:.05,curve:"linear"}:m;p=void 0===p?.01:p;w=void 0===w?1:w;var x={},A={},z={},y={};x.waveType=void 0===f?"sine":f;x.periodicWave=e;x.attack=l;x.release=m;x.octave=void 0===t?0:t;x.detune=void 0===n?0:n;x.func=function(a,b,c,d,e,f,k,h,t,l){return new function(){this.generator=a.createOscillator();"custom"==d?this.generator.setPeriodicWave(a.createPeriodicWave(new Float32Array(e.cos),new Float32Array(e.sin))):this.generator.type=d;this.generator.frequency.setTargetAtTime(g.library.audio.num2freq(c+
12*l),a.currentTime,0);this.generator.detune.setTargetAtTime(t,a.currentTime,0);this.generator.start(0);this.gain=a.createGain();this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,a.currentTime,0);g.library.audio.changeAudioParam(a,this.gain.gain,f,k.time,k.curve,!1);this.gain.connect(b);this.detune=function(b,c,d){g.library.audio.changeAudioParam(a,this.generator.detune,b,c,d)};this.changeVelocity=function(b){g.library.audio.changeAudioParam(a,this.gain.gain,b,k.time,k.curve)};this.stop=
function(){g.library.audio.changeAudioParam(a,this.gain.gain,0,h.time,h.curve,!1);setTimeout(function(a){a.gain.disconnect();a.generator.stop();a.generator.disconnect();a.gain=null;a.generator=null},1E3*h.time,this)}}};z.depth=void 0===u?0:u;z.period=void 0===q?0:q;z.phase=!0;z.wave="s";z.interval=null;z.start=function(){z.period<p||z.period>=w||(z.interval=setInterval(function(){var a=Object.keys(A);if(z.phase)for(var b=0;b<a.length;b++)A[a[b]].detune(z.depth,.9*z.period,z.wave);else for(b=0;b<a.length;b++)A[a[b]].detune(-z.depth,
.9*z.period,z.wave);z.phase=!z.phase},1E3*z.period))};z.stop=function(){clearInterval(z.interval)};var I=d.createGain();I.gain.setTargetAtTime(1,d.currentTime,0);y.depth=c;y.period=b;y.phase=!0;y.wave="s";y.interval=null;y.start=function(){y.period<h||y.period>=k?g.library.audio.changeAudioParam(d,y.node.gain,1,.01,y.wave):y.interval=setInterval(function(){y.phase?g.library.audio.changeAudioParam(d,y.node.gain,1,.9*y.period,y.wave):g.library.audio.changeAudioParam(d,y.node.gain,1-y.depth,.9*y.period,
y.wave);y.phase=!y.phase},1E3*y.period)};y.stop=function(){clearInterval(y.interval)};y.node=d.createGain();y.node.gain.setTargetAtTime(1,d.currentTime,0);I.connect(y.node);var r=d.createGain();r.gain.setTargetAtTime(a,d.currentTime,0);y.node.connect(r);this.out=function(){return r};this.perform=function(a){if(A[a.num]||0!=a.velocity)A[a.num]?0==a.velocity?(A[a.num].stop(),delete A[a.num]):A[a.num].changeVelocity(a.velocity):A[a.num]=x.func(d,I,a.num,x.waveType,x.periodicWave,a.velocity,x.attack,
x.release,x.detune,x.octave)};this.panic=function(){for(var a=Object.keys(A),b=0;b<a.length;b++)this.perform({num:a[b],velocity:0})};this.waveType=function(a){if(null==a)return x.waveType;x.waveType=a};this.periodicWave=function(a){if(null==a)return x.periodicWave;x.periodicWave=a};this.gain=function(a,b,c){return g.library.audio.changeAudioParam(d,r.gain,a,b,c)};this.attack=function(a,b){if(null==a&&null==b)return x.attack;x.attack.time=a?a:x.attack.time;x.attack.curve=b?b:x.attack.curve};this.release=
function(a,b){if(null==a&&null==b)return x.release;x.release.time=a?a:x.release.time;x.release.curve=b?b:x.release.curve};this.octave=function(a){if(null==a)return x.octave;x.octave=a};this.detune=function(a,b,c){if(null==a)return x.detune;var d=x.detune,e=a-d,f=Math.round(Math.abs(e)),k=f*b,h=[1];switch(c){case "linear":h=system.utility.math.curveGenerator.linear(k);break;case "exponential":h=system.utility.math.curveGenerator.exponential(k);break;case "s":h=system.utility.math.curveGenerator.s(k,
8)}if(0!=h.length)var g=setInterval(function(){x.detune=d+h.shift()*e;0==h.length&&clearInterval(g)},1E3/f);f=Object.keys(A);for(k=0;k<f.length;k++)A[f[k]].detune(a,b,c)};this.gainWobbleDepth=function(a){if(null==a)return y.depth;y.depth=a;y.stop();y.start()};this.gainWobblePeriod=function(a){if(null==a)return y.period;y.period=a;y.stop();y.start()};this.detuneWobbleDepth=function(a){if(null==a)return z.depth;z.depth=a;z.stop();z.start()};this.detuneWobblePeriod=function(a){if(null==a)return z.period;
z.period=a;z.stop();z.start()}}}};this.part=new function(){this.alpha=new function(){var d=this;this.basic=new function(){this.polygon=function(d,e,a,c,b,h,k,l,m,t,n){d=void 0===d?null:d;e=void 0===e?[]:e;a=void 0===a?!1:a;c=void 0===c?"rgba(255,100,255,1)":c;b=void 0===b?"rgba(0,0,0,0)":b;h=void 0===h?1:h;k=void 0===k?"round":k;l=void 0===l?2:l;m=void 0===m?"rgba(0,0,0,0)":m;t=void 0===t?20:t;n=void 0===n?{x:20,y:20}:n;var f=g.core.arrangement.createElement("polygon");f.name=d;f.points=e;f.ignored=
a;f.style.fill=c;f.style.stroke=b;f.style.lineWidth=h;f.style.lineJoin=k;f.style.miterLimit=l;f.style.shadowColour=m;f.style.shadowBlur=t;f.style.shadowOffset=n;return f};this.advancedPolygon=function(d,e,a,c,b,h,k,l,m,t){d=void 0===d?null:d;e=void 0===e?[]:e;a=void 0===a?"rgba(255,100,255,1)":a;c=void 0===c?"rgba(0,0,0,1)":c;b=void 0===b?1:b;h=void 0===h?"round":h;k=void 0===k?2:k;l=void 0===l?"rgba(0,0,0,0)":l;m=void 0===m?20:m;t=void 0===t?{x:20,y:20}:t;var f=g.core.arrangement.createElement("advancedPolygon");
f.name=d;f.points=e;f.style.fill=a;f.style.stroke=c;f.style.lineWidth=b;f.style.lineJoin=h;f.style.miterLimit=k;f.style.shadowColour=l;f.style.shadowBlur=m;f.style.shadowOffset=t;return f};this.circle=function(d,e,a,c,b,h,k,l,m,t,n,u,q){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;c=void 0===c?2:c;b=void 0===b?!1:b;h=void 0===h?"rgba(255,100,255,1)":h;k=void 0===k?"rgba(0,0,0,0)":k;l=void 0===l?1:l;m=void 0===m?"round":m;t=void 0===t?2:t;n=void 0===n?"rgba(0,0,0,0)":n;u=void 0===u?20:u;q=
void 0===q?{x:20,y:20}:q;var f=g.core.arrangement.createElement("circle");f.name=d;f.x=e;f.y=a;f.r=c;f.ignored=b;f.style.fill=h;f.style.stroke=k;f.style.lineWidth=l;f.style.lineJoin=m;f.style.miterLimit=t;f.style.shadowColour=n;f.style.shadowBlur=u;f.style.shadowOffset=q;return f};this.canvas=function(d,e,a,c,b,h,k,l,m){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;c=void 0===c?10:c;b=void 0===b?10:b;h=void 0===h?0:h;k=void 0===k?{x:0,y:0}:k;l=void 0===l?!1:l;m=void 0===m?1:m;var f=g.core.arrangement.createElement("canvas");
f.name=d;f.x=e;f.y=a;f.parameter.width(c);f.parameter.height(b);f.resolution(m);f.angle=h;f.anchor=k;f.ignored=l;return f};this.image=function(d,e,a,c,b,h,k,l,m){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;c=void 0===c?10:c;b=void 0===b?10:b;h=void 0===h?0:h;k=void 0===k?{x:0,y:0}:k;l=void 0===l?!1:l;m=void 0===m?"":m;var f=g.core.arrangement.createElement("image");f.name=d;f.x=e;f.y=a;f.width=c;f.height=b;f.angle=h;f.anchor=k;f.ignored=l;f.url=m;return f};this.path=function(d,e,a,c,b,h,
k,l,m,t,n){d=void 0===d?null:d;e=void 0===e?[]:e;a=void 0===a?!1:a;c=void 0===c?"rgba(0,0,0,1)":c;b=void 0===b?1:b;h=void 0===h?"butt":h;k=void 0===k?"miter":k;l=void 0===l?2:l;m=void 0===m?"rgba(0,0,0,0)":m;t=void 0===t?20:t;n=void 0===n?{x:20,y:20}:n;var f=g.core.arrangement.createElement("path");f.name=d;f.points=e;f.ignored=a;f.style.stroke=c;f.style.lineWidth=b;f.style.lineCap=h;f.style.lineJoin=k;f.style.miterLimit=l;f.style.shadowColour=m;f.style.shadowBlur=t;f.style.shadowOffset=n;return f};
this.rectangle=function(d,e,a,c,b,h,k,l,m,t,n,u,q,p,w,x){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;c=void 0===c?10:c;b=void 0===b?10:b;h=void 0===h?0:h;k=void 0===k?{x:0,y:0}:k;l=void 0===l?!1:l;m=void 0===m?"rgba(255,100,255,1)":m;t=void 0===t?"rgba(0,0,0,0)":t;n=void 0===n?1:n;u=void 0===u?"round":u;q=void 0===q?2:q;p=void 0===p?"rgba(0,0,0,0)":p;w=void 0===w?20:w;x=void 0===x?{x:20,y:20}:x;var f=g.core.arrangement.createElement("rectangle");f.name=d;f.x=e;f.y=a;f.width=c;f.height=b;
f.angle=h;f.anchor=k;f.ignored=l;f.style.fill=m;f.style.stroke=t;f.style.lineWidth=n;f.style.lineJoin=u;f.style.miterLimit=q;f.style.shadowColour=p;f.style.shadowBlur=w;f.style.shadowOffset=x;return f};this.group=function(d,e,a,c,b){d=void 0===d?null:d;e=void 0===e?0:e;a=void 0===a?0:a;c=void 0===c?0:c;b=void 0===b?!1:b;var f=g.core.arrangement.createElement("group");f.name=d;f.x=e;f.y=a;f.angle=c;f.ignored=b;return f};this.text=function(d,e,a,c,b,h,k,l,m,t,n,u,q,p,w,x,A,z,y){d=void 0===d?null:d;
e=void 0===e?0:e;a=void 0===a?0:a;c=void 0===c?"Hello":c;b=void 0===b?0:b;h=void 0===h?{x:0,y:0}:h;k=void 0===k?1:k;l=void 0===l?!1:l;m=void 0===m?"30pt Arial":m;t=void 0===t?"start":t;n=void 0===n?"alphabetic":n;u=void 0===u?"rgba(255,100,255,1)":u;q=void 0===q?"rgba(0,0,0,0)":q;p=void 0===p?1:p;w=void 0===w?"round":w;x=void 0===x?2:x;A=void 0===A?"rgba(0,0,0,0)":A;z=void 0===z?20:z;y=void 0===y?{x:20,y:20}:y;var f=g.core.arrangement.createElement("text");f.name=d;f.x=e;f.y=a;f.text=c;f.angle=b;
f.anchor=h;f.size=k;f.ignored=l;f.style.font=m;f.style.align=t;f.style.baseline=n;f.style.fill=u;f.style.stroke=q;f.style.lineWidth=p;f.style.lineJoin=w;f.style.miterLimit=x;f.style.shadowColour=A;f.style.shadowBlur=z;f.style.shadowOffset=y;return f}};this.display=new function(){this.rastorDisplay=function(f,e,a,c,b,h,k,g,m,t,n,u){function l(){for(var a=0;a<k;a++)for(var b=0;b<g;b++)p[a][b].style.fill="rgb("+255*w[a][b][0]+","+255*w[a][b][1]+","+255*w[a][b][2]+")"}b=void 0===b?60:b;h=void 0===h?60:
h;k=void 0===k?8:k;g=void 0===g?8:g;m=void 0===m?.1:m;t=void 0===t?.1:t;n=void 0===n?"rgba(50,50,50)":n;u=void 0===u?"rgba(0,0,0)":u;f=d.builder("group",void 0===f?"rastorDisplay":f,{x:e,y:a,angle:void 0===c?0:c});n=d.builder("rectangle","backing",{width:b,height:h,style:{fill:n}});f.append(n);c=d.builder("group","pixels");f.append(c);var p=[],w=[];b/=k;h/=g;for(e=0;e<k;e++){var x=[],A=[];for(a=0;a<g;a++)n=d.builder("rectangle",e+"_"+a,{x:e*b+m/2,y:a*h+t/2,width:b-m,height:h-t,style:{fill:u}}),x.push(n),
A.push([0,0,0]),c.append(n);p.push(x);w.push(A)}f.get=function(a,b){return w[a][b]};f.set=function(a,b,c){w[a][b]=c;l()};f.import=function(a){for(var b=0;b<k;b++)for(var c=0;c<g;c++)this.set(b,c,a[b][c]);l()};f.export=function(){return w};f.setAll=function(a){for(var b=0;b<k;b++)for(var c=0;c<g;c++)this.set(b,c,a)};f.test=function(){this.setAll([1,1,1]);this.set(1,1,[1,.5,.5]);this.set(2,2,[.5,1,.5]);this.set(3,3,[.5,.5,1]);this.set(4,4,[1,.5,1]);l()};return f};this.grapher_audioScope=function(f,
e,a,c,b,h,k,l,m,t,n,u,q,p){f=void 0===f?"grapher_audioScope":f;c=void 0===c?120:c;b=void 0===b?60:b;h=void 0===h?0:h;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:k;l=void 0===l?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:l;m=void 0===m?"rgba(0,100,0,1)":m;t=void 0===t?.25:t;n=void 0===n?"rgba(0,150,0,1)":n;u=void 0===u?.1:u;q=void 0===q?"Helvetica":q;p=void 0===p?"rgba(50,50,50,1)":p;var w=g.library.audio.context.createAnalyser(),x=null,A=10,z=null,y=256;w.fftSize=
y;x=new Uint8Array(w.fftSize);new Uint8Array(w.fftSize);e=d.builder("group",f,{x:e,y:a,angle:h});var I=d.builder("grapher",f,{x:0,y:0,width:c,height:b,foregroundStyles:[k],foregroundTextStyles:[l],backgroundStyle_stroke:m,backgroundStyle_lineWidth:t,backgroundTextStyle_fill:n,backgroundTextStyle_size:u,backgroundTextStyle_font:q,backingStyle:p});e.append(I);e.start=function(){null==z&&(z=setInterval(function(){var a=[];w.getByteTimeDomainData(x);for(var b=0;b<x.length;b++)a.push(x[b]/128-1);I.draw(a)},
1E3/A))};e.stop=function(){clearInterval(z);z=null};e.getNode=function(){return w};e.resolution=function(a){a=void 0===a?null:a;if(null==a)return y;y=a;this.stop();this.start()};e.refreshRate=function(a){if(null==a)return A;A=a;this.stop();this.start()};I.viewbox({l:-1.1,h:1.1});I.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});I.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});I.drawBackground();return e};this.sevenSegmentDisplay=function(f,e,a,c,b,
h,k,g,m){c=void 0===c?20:c;b=void 0===b?30:b;k=void 0===k?"rgb(0,0,0)":k;g=void 0===g?"rgb(200,200,200)":g;m=void 0===m?"rgb(20,20,20)":m;var l=c/8,n=c/8;h=[{x:1*n+l,y:1*n+l},{x:.5*n+l,y:.5*n+l},{x:1*n+l,y:0*n+l},{x:0*n+l,y:1*n+l}];var u=[{x:c-1*n-l,y:0*n+l},{x:c-.5*n-l,y:.5*n+l},{x:c-1*n-l,y:1*n+l},{x:c-0*n-l,y:1*n+l}],q=[{x:1*n+l,y:.5*b-1*n+.5*l},{x:.5*n+l,y:.5*b-.5*n+.5*l},{x:1*n+l,y:.5*b-0*n+.5*l},{x:0*n+l,y:.5*b-1*n+.5*l},{x:0*n+l,y:.5*b-0*n+.5*l}],p=[{x:c-1*n-l,y:.5*b-0*n+.5*l},{x:c-.5*n-l,
y:.5*b-.5*n+.5*l},{x:c-1*n-l,y:.5*b-1*n+.5*l},{x:c-0*n-l,y:.5*b-1*n+.5*l},{x:c-0*n-l,y:.5*b-0*n+.5*l}],w=[{x:1*n+l,y:b-1*n-l},{x:.5*n+l,y:b-.5*n-l},{x:1*n+l,y:b-0*n-l},{x:0*n+l,y:b-1*n-l}];l=[{x:c-1*n-l,y:b-0*n-l},{x:c-.5*n-l,y:b-.5*n-l},{x:c-1*n-l,y:b-1*n-l},{x:c-0*n-l,y:b-1*n-l}];f=d.builder("group",void 0===f?"sevenSegmentDisplay":f,{x:e,y:a});c=d.builder("rectangle","backing",{width:c,height:b,style:{fill:k}});f.append(c);var x=[];c=[[h[0],u[2],u[1],u[0],h[2],h[1]],[h[1],h[3],q[3],q[1],q[0],h[0]],
[u[1],u[3],p[3],p[1],p[2],u[2]],[q[0],p[2],p[1],p[0],q[2],q[1]],[q[1],q[4],w[3],w[1],w[0],q[2]],[p[1],p[4],l[3],l[1],l[2],p[0]],[w[0],l[2],l[1],l[0],w[2],w[1]]];for(b=0;b<c.length;b++)k={segment:d.builder("polygon","segment_"+b,{points:c[b],style:{fill:m}}),state:!1},x.push(k),f.append(k.segment);f.set=function(a,b){x[a].state=b;x[a].segment.style.fill=b?g:m};f.get=function(a){return x[a].state};f.clear=function(){for(var a=0;a<x.length;a++)this.set(a,!1)};f.enterCharacter=function(a){switch(a){case 0:case "0":a=
[1,1,1,0,1,1,1];break;case 1:case "1":a=[0,0,1,0,0,1,0];break;case 2:case "2":a=[1,0,1,1,1,0,1];break;case 3:case "3":a=[1,0,1,1,0,1,1];break;case 4:case "4":a=[0,1,1,1,0,1,0];break;case 5:case "5":a=[1,1,0,1,0,1,1];break;case 6:case "6":a=[1,1,0,1,1,1,1];break;case 7:case "7":a=[1,0,1,0,0,1,0];break;case 8:case "8":a=[1,1,1,1,1,1,1];break;case 9:case "9":a=[1,1,1,1,0,1,1];break;default:a=[0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,1==a[b])};return f};this.sixteenSegmentDisplay=function(f,
e,a,c,b,h,k,g,m){c=void 0===c?20:c;b=void 0===b?30:b;k=void 0===k?"rgb(0,0,0)":k;g=void 0===g?"rgb(200,200,200)":g;m=void 0===m?"rgb(20,20,20)":m;var l=c/8,n=c/8;h=[{x:.5*n+l,y:.5*n+l},{x:1*n+l,y:0*n+l},{x:0*n+l,y:1*n+l},{x:1*n+l,y:1*n+l},{x:1.75*n+l,y:1*n+l},{x:1*n+l,y:1.75*n+l}];var u=[{x:c/2,y:.5*n+l},{x:c/2-.5*n,y:1*n+l},{x:c/2+.5*n,y:1*n+l},{x:c/2-.5*n,y:0*n+l},{x:c/2+.5*n,y:0*n+l}],q=[{x:c-.5*n-l,y:.5*n+l},{x:c-1*n-l,y:0*n+l},{x:c-0*n-l,y:1*n+l},{x:c-1*n-l,y:1*n+l},{x:c-1*n-l,y:1.75*n+l},{x:c-
1.75*n-l,y:1*n+l}],p=[{x:0*n+l,y:.5*b-.5*n},{x:1*n+l,y:.5*b-.5*n},{x:.5*n+l,y:.5*b-0*n},{x:0*n+l,y:.5*b+.5*n},{x:1*n+l,y:.5*b+.5*n}],w=[{x:c/2,y:b/2},{x:c/2-.5*n,y:.5*n+b/2},{x:c/2-.25*n,y:1.25*n+b/2},{x:c/2-1*n,y:.5*n+b/2},{x:c/2+.5*n,y:.5*n+b/2},{x:c/2+.5*n,y:1.75*n+b/2},{x:c/2+1*n,y:.5*n+b/2},{x:c/2-.5*n,y:.5*-n+b/2},{x:c/2-.25*n,y:1.25*-n+b/2},{x:c/2-1*n,y:.25*-n+b/2},{x:c/2+.5*n,y:.5*-n+b/2},{x:c/2+.5*n,y:1.75*-n+b/2},{x:c/2+1*n,y:.25*-n+b/2}],x=[{x:c-1*n-l,y:.5*b-.5*n},{x:c-0*n-l,y:.5*b-.5*
n},{x:c-.5*n-l,y:.5*b-0*n},{x:c-1*n-l,y:.5*b+.5*n},{x:c-0*n-l,y:.5*b+.5*n}],A=[{x:.5*n+l,y:b-.5*n-l},{x:0*n+l,y:b-1*n-l},{x:1*n+l,y:b-0*n-l},{x:1*n+l,y:b-1*n-l},{x:1*n+l,y:b-1.75*n-l},{x:1.75*n+l,y:b-1*n-l}],z=[{x:c/2-.5*n,y:b-1*n-l},{x:c/2+.5*n,y:b-1*n-l},{x:c/2,y:b-.5*n-l},{x:c/2-.5*n,y:b-0*n-l},{x:c/2+.5*n,y:b-0*n-l}];l=[{x:c-.5*n-l,y:b-.5*n-l},{x:c-0*n-l,y:b-1*n-l},{x:c-1*n-l,y:b-0*n-l},{x:c-1*n-l,y:b-1*n-l},{x:c-1*n-l,y:b-1.75*n-l},{x:c-1.75*n-l,y:b-1*n-l}];f=d.builder("group",void 0===f?"sixteenSegmentDisplay":
f,{x:e,y:a});c=d.builder("rectangle","backing",{width:c,height:b,style:{fill:k}});f.append(c);var y=[];c=[[h[1],h[0],h[3],u[1],u[0],u[3]],[u[4],u[0],u[2],q[3],q[0],q[1]],[h[0],h[2],p[0],p[2],p[1],h[3]],[h[4],h[3],h[5],w[9],w[7],w[8]],[u[0],u[1],w[7],w[0],w[10],u[2]],[q[4],q[3],q[5],w[11],w[10],w[12]],[q[0],q[2],x[1],x[2],x[0],q[3]],[p[4],p[2],p[1],w[7],w[0],w[1]],[x[3],x[2],x[0],w[10],w[0],w[4]],[A[0],A[1],p[3],p[2],p[4],A[3]],[A[4],A[3],A[5],w[2],w[1],w[3]],[z[0],z[2],z[1],w[4],w[0],w[1]],[l[4],
l[3],l[5],w[5],w[4],w[6]],[l[3],x[3],x[2],x[4],l[1],l[0]],[A[2],A[0],A[3],z[0],z[2],z[3]],[l[2],l[0],l[3],z[1],z[2],z[4]]];for(b=0;b<c.length;b++)k={segment:d.builder("polygon","segment_"+b,{points:c[b],style:{fill:m}}),state:!1},y.push(k),f.append(k.segment);f.set=function(a,b){y[a].state=b;y[a].segment.style.fill=b?g:m};f.get=function(a){return y[a].state};f.clear=function(){for(var a=0;a<y.length;a++)this.set(a,!1)};f.enterCharacter=function(a){switch(a){case "!":a=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,
1,1];break;case "?":a=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":a=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":a=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":a=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':a=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":a=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":a=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":a=[0,0,0,0,0,1,0,0,0,
0,1,0,0,0,0,0];break;case "*":a=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":a=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":a=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":a=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":a=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":a=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":a=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":a=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":a=[1,1,0,0,0,
1,0,0,1,0,0,0,1,0,1,1];break;case "0":a=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":a=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":a=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":a=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":a=[1,
1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":a=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":a=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":a=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":a=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":a=[0,0,1,0,0,0,1,1,1,1,0,0,
0,1,0,0];break;case "i":case "I":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":a=[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":a=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":a=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":a=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":a=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":a=
[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":a=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":a=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":a=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":a=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":a=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":a=[0,0,0,1,0,1,0,0,0,0,
0,1,0,0,0,0];break;case "z":case "Z":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":a=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,1==a[b])};return f};this.glowbox_rect=function(f,e,a,c,b,h,k,l){c=void 0===c?30:c;b=void 0===b?30:b;h=void 0===h?0:h;k=void 0===k?"rgba(244,234,141,1)":k;l=void 0===l?"rgba(80,80,80,1)":l;f=d.builder("group",void 0===f?"glowbox_rect":f,{x:e,y:a});var g=d.builder("rectangle","light",{width:c,
height:b,angle:h,style:{fill:l}});f.append(g);f.on=function(){g.style.fill=k};f.off=function(){g.style.fill=l};return f};this.audio_meter_level=function(f,e,a,c,b,h,k,l,g,t,n){b=void 0===b?20:b;h=void 0===h?60:h;k=void 0===k?[.125,.25,.375,.5,.625,.75,.875]:k;l=void 0===l?"rgb(10,10,10)":l;g=void 0===g?["rgba(250,250,250,1)","rgb(100,100,100)"]:g;t=void 0===t?"rgba(220,220,220,1)":t;n=void 0===n?"1pt Courier New":n;f=d.builder("group",void 0===f?"audio_meter_level":f,{x:e,y:a,angle:void 0===c?0:c});
var m=d.builder("meter_level","meter",{width:b,height:h,markings:k,style:{backing:l,levels:g,markingStyle_fill:t,markingStyle_font:n}});f.append(m);var q=r.circuit.alpha.audio2percentage();q.newValue=function(a){m.set(a)};f.audioIn=function(){return q.audioIn()};f.start=function(){q.start()};f.stop=function(){q.stop()};return f};this.grapher__static=function(f,e,a,c,b,h,k,l,m,t,n,u,q,p){function w(){B._.fillStyle=p;B._.fillRect(0,0,B.$(c),B.$(b))}function x(){for(var a=g.library.math.relativeDistance(c,
z.left,z.right,y.mappedPosition),d=0;d<y.points.length;d++)if(y.points[d]<z.top||y.points[d]>z.bottom){var e=b-g.library.math.relativeDistance(b,z.bottom,z.top,y.points[d]);B._.fillStyle=t;B._.fillRect(0,B.$(e),B.$(c),B.$(n));y.printText&&(B._.fillStyle=u,B._.font=q,B._.fillText(y.printingValues&&void 0!=y.printingValues[d]?y.printingValues[d]:y.points[d],B.$(a+y.textPositionOffset.x),B.$(e+y.textPositionOffset.y)))}e=b-g.library.math.relativeDistance(b,z.bottom,z.top,r.mappedPosition);for(d=0;d<
r.points.length;d++)r.points[d]<z.left||r.points[d]>z.right||(a=g.library.math.relativeDistance(c,z.left,z.right,r.points[d]),B._.fillStyle=t,B._.fillRect(B.$(a),0,B.$(n),B.$(b)),r.printText&&(B._.fillStyle=u,B._.font=q,B._.fillText(r.printingValues&&void 0!=r.printingValues[d]?r.printingValues[d]:r.points[d],B.$(a+r.textPositionOffset.x),B.$(e+r.textPositionOffset.y))))}function A(a,d,e){e=void 0===e?0:e;C[e]=void 0==a&&void 0==d?void 0:{x:d,y:a};if(void 0!=C[e]&&void 0==C[e].y)console.warn("grapher__static error",
f,"attempting to add line with no y component"),console.warn("x:",C[e].x),console.warn("y:",C[e].y);else for(a=0;a<C.length;a++)if(void 0!=C[a]){e=C[a];B._.strokeStyle=l[a].stroke;B._.lineWidth=B.$(l[a].lineWidth);B._.lineJoin=l[a].lineJoin;B._.lineCap=l[a].lineJoin;B._.beginPath();if(void 0!=e.y&&void 0==e.x)for(B._.moveTo(0,B.$(b-g.library.math.relativeDistance(b,z.bottom,z.top,e.y[0],!0))),d=1;d<e.y.length;d++)B._.lineTo(B.$(c/(e.y.length-1)*d),B.$(b-g.library.math.relativeDistance(b,z.bottom,
z.top,e.y[d],!0)));else if(e.y.length==e.x.length)for(d=0;d<e.y.length;d++)for(B._.moveTo(B.$(g.library.math.relativeDistance(c,z.left,z.right,e.x[0],!0)),B.$(b-g.library.math.relativeDistance(b,z.bottom,z.top,e.y[0],!0))),d=1;d<e.y.length;d++)B._.lineTo(B.$(g.library.math.relativeDistance(c,z.left,z.right,e.x[d],!0)),B.$(b-g.library.math.relativeDistance(b,z.bottom,z.top,e.y[d],!0)));else console.error("grapher__static::"+f,":layers are of different length:",e.y,e.x);B._.stroke()}}f=void 0===f?"grapher__static":
f;c=void 0===c?120:c;b=void 0===b?60:b;k=void 0===k?5:k;l=void 0===l?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:l;t=void 0===t?"rgba(0,100,0,1)":t;n=void 0===n?.25:n;u=void 0===u?"rgba(0,150,0,1)":u;q=void 0===q?"7.5pt Helvetica":q;p=void 0===p?"rgba(50,50,50,1)":p;var z={bottom:-1,top:1,left:-1,right:1},y={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,
textPositionOffset:{x:1,y:-.5},printText:!0},r={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},C=[];e=d.builder("group",f,{x:e,y:a,angle:void 0===h?0:h});var B=d.builder("canvas","backing",{width:c,height:b,resolution:k});e.append(B);e.resolution=function(a){return B.resolution(a)};e.viewbox=function(a){if(null==a)return z;void 0!=a.bottom&&(z.bottom=a.bottom);void 0!=a.top&&(z.top=a.top);void 0!=a.left&&(z.left=a.left);void 0!=
a.right&&(z.right=a.right)};e.horizontalMarkings=function(a){if(null==a)return y;void 0!=a.points&&(y.points=a.points);void 0!=a.printingValues&&(y.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(y.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(y.printText=a.printText)};e.verticalMarkings=function(a){if(null==a)return r;void 0!=a.points&&(r.points=a.points);void 0!=a.printingValues&&(r.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(r.textPositionOffset=
a.textPositionOffset);void 0!=a.printText&&(r.printText=a.printText)};e.drawBackground=function(){w();x()};e.drawForeground=function(a,b,c){A(a,b,void 0===c?0:c)};e.draw=function(a,b,c){c=void 0===c?0:c;w();x();A(a,b,c)};return e};this.grapher_periodicWave__static=function(f,e,a,c,b,h,k,l,g,t,n,u,q,p){f=void 0===f?"grapher_periodicWave__static":f;c=void 0===c?120:c;b=void 0===b?60:b;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:k;l=void 0===l?{fill:"rgba(100,255,100,1)",size:.75,
font:"Helvetica"}:l;g=void 0===g?"rgba(0,100,0,1)":g;t=void 0===t?.25:t;n=void 0===n?"rgba(0,150,0,1)":n;u=void 0===u?.1:u;q=void 0===q?"Helvetica":q;p=void 0===p?"rgba(50,50,50,1)":p;var m={sin:[],cos:[]},x=100;e=d.builder("group",f,{x:e,y:a,angle:void 0===h?0:h});var A=d.builder("grapher__static",f,{x:0,y:0,width:c,height:b,foregroundStyles:[k],foregroundTextStyles:[l],backgroundStyle_stroke:g,backgroundStyle_lineWidth:t,backgroundTextStyle_fill:n,backgroundTextStyle_size:u,backgroundTextStyle_font:q,
backingStyle:p});e.append(A);e.wave=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;if(null==a){for(;m.sin.length<m.cos.length;)m.sin.push(0);for(;m.sin.length>m.cos.length;)m.cos.push(0);for(a=0;a<m.sin.length;a++)m.sin[a]||(m.sin[a]=0),m.cos[a]||(m.cos[a]=0);return m}null==b&&(m=a);switch(b){case "sin":m.sin=a;break;case "cos":m.cos=a}};e.waveElement=function(a,b,c){if(null==c)return m[a][b];m[a][b]=c};e.resolution=function(a){a=void 0===a?null:a;if(null==a)return x;x=a};e.updateBackground=
function(){A.viewbox({bottom:-1.1,top:1.1,left:0});A.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});A.verticalMarkings({points:[0,.25,.5,.75],printText:!0});A.drawBackground()};e.draw=function(){for(var a=[],b,c=0;c<=x;c++){for(var d=b=0;d<m.sin.length;d++)m.sin[d]||(m.sin[d]=0),b+=Math.sin(c/x*d*Math.PI*2)*m.sin[d];for(d=0;d<m.cos.length;d++)m.cos[d]||(m.cos[d]=0),b+=Math.cos(c/x*d*Math.PI*2)*m.cos[d];a.push(b)}A.draw(a)};e.reset=function(){this.wave({sin:[],cos:[]});
this.resolution(100);this.updateBackground()};return e};this.grapher=function(f,e,a,c,b,h,k,l,m,t,n,u,q){function p(){r.clear();for(var a=g.library.math.relativeDistance(c,x.left,x.right,A.mappedPosition),e=0;e<A.points.length;e++)if(A.points[e]<x.top||A.points[e]>x.bottom){var f=b-g.library.math.relativeDistance(b,x.bottom,x.top,A.points[e]),k=d.builder("rectangle","horizontal_line_"+e,{x:0,y:f,width:c,height:t,style:{fill:m}});r.append(k);A.printText&&(k=d.builder("text","horizontal_text_"+e,{x:a+
A.textPositionOffset.x,y:f+A.textPositionOffset.y,text:A.printingValues&&void 0!=A.printingValues[e]?A.printingValues[e]:A.points[e],style:{fill:n,font:u}}),r.append(k))}f=b-g.library.math.relativeDistance(b,x.bottom,x.top,z.mappedPosition);for(e=0;e<z.points.length;e++)z.points[e]<x.left||z.points[e]>x.right||(a=g.library.math.relativeDistance(c,x.left,x.right,z.points[e]),k=d.builder("rectangle","vertical_line_"+e,{x:a,y:0,width:t,height:b,style:{fill:m}}),r.append(k),z.printText&&(k=d.builder("text",
"vertical_text_"+e,{x:a+z.textPositionOffset.x,y:f+z.textPositionOffset.y,text:z.printingValues&&void 0!=z.printingValues[e]?z.printingValues[e]:z.points[e],style:{fill:n,font:u}}),r.append(k)))}function w(a,e,h){h=void 0===h?0:h;C.clear();y[h]=void 0==a&&void 0==e?void 0:{x:e,y:a};if(void 0!=y[h]&&void 0==y[h].y)console.warn("grapher error",f,"attempting to add line with no y component"),console.warn("x:",y[h].x),console.warn("y:",y[h].y);else for(a=0;a<y.length;a++)if(void 0!=y[a]){h=y[a];e=[];
if(void 0!=h.y&&void 0==h.x)for(var l=0;l<h.y.length;l++)e.push({x:c/(h.y.length-1)*l,y:b-g.library.math.relativeDistance(b,x.bottom,x.top,h.y[l],!0)});else if(h.y.length==h.x.length)for(l=0;l<h.y.length;l++)e.push({x:g.library.math.relativeDistance(c,x.left,x.right,h.x[l],!0),y:b-g.library.math.relativeDistance(b,x.bottom,x.top,h.y[l],!0)});else console.error("grapher::"+f,":layers are of differnt length:",h.y,h.x);C.append(d.builder("path","layer_"+a,{points:e,style:{stroke:k[a].stroke,lineWidth:k[a].lineWidth,
lineJoin:k[a].lineJoin,lineCap:k[a].lineJoin}}))}}f=void 0===f?"grapher":f;c=void 0===c?120:c;b=void 0===b?60:b;k=void 0===k?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:k;m=void 0===m?"rgba(0,100,0,1)":m;t=void 0===t?.25:t;n=void 0===n?"rgba(0,150,0,1)":n;u=void 0===u?"1.5pt Helvetica":u;q=void 0===q?"rgba(50,50,50,1)":q;var x={bottom:-1,top:1,left:-1,right:1},A={points:[.75,
.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},z={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},y=[];e=d.builder("group",f,{x:e,y:a,angle:void 0===h?0:h});q=d.builder("rectangle","backing",{width:c,height:b,style:{fill:q}});e.append(q);var r=d.builder("group","background");e.append(r);var C=d.builder("group","foreground");e.append(C);q=d.builder("rectangle","stencil",{width:c,
height:b});e.stencil(q);e.clip(!0);e.viewbox=function(a){if(null==a)return x;void 0!=a.bottom&&(x.bottom=a.bottom);void 0!=a.top&&(x.top=a.top);void 0!=a.left&&(x.left=a.left);void 0!=a.right&&(x.right=a.right)};e.horizontalMarkings=function(a){if(null==a)return A;void 0!=a.points&&(A.points=a.points);void 0!=a.printingValues&&(A.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(A.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(A.printText=a.printText)};e.verticalMarkings=
function(a){if(null==a)return z;void 0!=a.points&&(z.points=a.points);void 0!=a.printingValues&&(z.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(z.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(z.printText=a.printText)};e.drawBackground=function(){p()};e.drawForeground=function(a,b,c){w(a,b,void 0===c?0:c)};e.draw=function(a,b,c){c=void 0===c?0:c;p();w(a,b,c)};return e};this.meter_level=function(f,e,a,c,b,h,k,l,g,t,n){function m(a){return d.builder("polygon","mark_"+
a,{points:[{x:b,y:a-.1},{x:b-b/4,y:a-.1},{x:b-b/4,y:a+.1},{x:b,y:a+.1}],style:{fill:t}})}function q(a,b){return d.builder("text","text_"+b,{x:.5,y:a+.3,text:b,style:{fill:t,font:n}})}b=void 0===b?20:b;h=void 0===h?60:h;k=void 0===k?[.125,.25,.375,.5,.625,.75,.875]:k;l=void 0===l?"rgb(10,10,10)":l;g=void 0===g?["rgba(250,250,250,1)","fill:rgb(100,100,100)"]:g;t=void 0===t?"rgba(220,220,220,1)":t;n=void 0===n?"1pt Courier New":n;f=d.builder("group",void 0===f?"meter_level":f,{x:e,y:a,angle:void 0===
c?0:c});var p=d.builder("level","level",{width:b,height:h,style:{backing:l,levels:g}});f.append(p);l=d.builder("group","markings");f.append(l);for(g=0;g<k.length;g++)l.append(m(h*(1-k[g]))),l.append(q(h*(1-k[g]),k[g]));var w=0,x=0;setInterval(function(){p.layer(x,0);0<w&&(w-=.005);p.layer(w,1);x>w&&(w=x)},1E3/15);f.set=function(a){x=a};return f};this.sevenSegmentDisplay__static=function(f,e,a,c,b,h,k,g,m,t){function l(){B._.fillStyle=g;B._.fillRect(0,0,B.$(c),B.$(b))}function u(){for(var a=0;a<r.length;a++){B._.beginPath();
B._.moveTo(B.$(r[a][0].x),B.$(r[a][0].y));for(var b=1;b<r[a].length;b++)B._.lineTo(B.$(r[a][b].x),B.$(r[a][b].y));B._.closePath();B._.fillStyle=0==C[a]?t:m;B._.fill()}}c=void 0===c?20:c;b=void 0===b?30:b;k=void 0===k?5:k;g=void 0===g?"rgb(0,0,0)":g;m=void 0===m?"rgb(200,200,200)":m;t=void 0===t?"rgb(20,20,20)":t;var q=c/8,p=c/8,w=[{x:1*p+q,y:1*p+q},{x:.5*p+q,y:.5*p+q},{x:1*p+q,y:0*p+q},{x:0*p+q,y:1*p+q}],x=[{x:c-1*p-q,y:0*p+q},{x:c-.5*p-q,y:.5*p+q},{x:c-1*p-q,y:1*p+q},{x:c-0*p-q,y:1*p+q}],A=[{x:1*
p+q,y:.5*b-1*p+.5*q},{x:.5*p+q,y:.5*b-.5*p+.5*q},{x:1*p+q,y:.5*b-0*p+.5*q},{x:0*p+q,y:.5*b-1*p+.5*q},{x:0*p+q,y:.5*b-0*p+.5*q}],z=[{x:c-1*p-q,y:.5*b-0*p+.5*q},{x:c-.5*p-q,y:.5*b-.5*p+.5*q},{x:c-1*p-q,y:.5*b-1*p+.5*q},{x:c-0*p-q,y:.5*b-1*p+.5*q},{x:c-0*p-q,y:.5*b-0*p+.5*q}],y=[{x:1*p+q,y:b-1*p-q},{x:.5*p+q,y:b-.5*p-q},{x:1*p+q,y:b-0*p-q},{x:0*p+q,y:b-1*p-q}];q=[{x:c-1*p-q,y:b-0*p-q},{x:c-.5*p-q,y:b-.5*p-q},{x:c-1*p-q,y:b-1*p-q},{x:c-0*p-q,y:b-1*p-q}];var r=[[w[0],x[2],x[1],x[0],w[2],w[1]],[w[1],w[3],
A[3],A[1],A[0],w[0]],[x[1],x[3],z[3],z[1],z[2],x[2]],[A[0],z[2],z[1],z[0],A[2],A[1]],[A[1],A[4],y[3],y[1],y[0],A[2]],[z[1],z[4],q[3],q[1],q[2],z[0]],[y[0],q[2],q[1],q[0],y[2],y[1]]],C=[0,0,0,0,0,0,0];f=d.builder("group",void 0===f?"sevenSegmentDisplay__static":f,{x:e,y:a,angle:void 0===h?0:h});var B=d.builder("canvas","subcanvas",{width:c,height:b,resolution:k});f.append(B);f.set=function(a,b){C[a].state=b;u()};f.get=function(a){return C[a].state};f.clear=function(){for(var a=0;a<C.length;a++)this.set(a,
!1)};f.enterCharacter=function(a){switch(a){case 0:case "0":C=[1,1,1,0,1,1,1];break;case 1:case "1":C=[0,0,1,0,0,1,0];break;case 2:case "2":C=[1,0,1,1,1,0,1];break;case 3:case "3":C=[1,0,1,1,0,1,1];break;case 4:case "4":C=[0,1,1,1,0,1,0];break;case 5:case "5":C=[1,1,0,1,0,1,1];break;case 6:case "6":C=[1,1,0,1,1,1,1];break;case 7:case "7":C=[1,0,1,0,0,1,0];break;case 8:case "8":C=[1,1,1,1,1,1,1];break;case 9:case "9":C=[1,1,1,1,0,1,1];break;default:C=[0,0,0,0,0,0,0]}l();u()};l();u();return f};this.grapher_periodicWave=
function(f,e,a,c,b,h,k,g,m,t,n,u,q,p){f=void 0===f?"grapher_periodicWave":f;c=void 0===c?120:c;b=void 0===b?60:b;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:k;g=void 0===g?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:g;m=void 0===m?"rgba(0,100,0,1)":m;t=void 0===t?.25:t;n=void 0===n?"rgba(0,150,0,1)":n;u=void 0===u?.1:u;q=void 0===q?"Helvetica":q;p=void 0===p?"rgba(50,50,50,1)":p;var l={sin:[],cos:[]},x=100;e=d.builder("group",f,{x:e,y:a,angle:void 0===h?0:h});
var A=d.builder("grapher",f,{x:0,y:0,width:c,height:b,foregroundStyles:[k],foregroundTextStyles:[g],backgroundStyle_stroke:m,backgroundStyle_lineWidth:t,backgroundTextStyle_fill:n,backgroundTextStyle_size:u,backgroundTextStyle_font:q,backingStyle:p});e.append(A);e.wave=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;if(null==a){for(;l.sin.length<l.cos.length;)l.sin.push(0);for(;l.sin.length>l.cos.length;)l.cos.push(0);for(a=0;a<l.sin.length;a++)l.sin[a]||(l.sin[a]=0),l.cos[a]||(l.cos[a]=0);
return l}null==b&&(l=a);switch(b){case "sin":l.sin=a;break;case "cos":l.cos=a}};e.waveElement=function(a,b,c){if(null==c)return l[a][b];l[a][b]=c};e.resolution=function(a){a=void 0===a?null:a;if(null==a)return x;x=a};e.updateBackground=function(){A.viewbox({bottom:-1.1,top:1.1,left:0});A.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});A.verticalMarkings({points:[0,.25,.5,.75],printText:!0});A.drawBackground()};e.draw=function(){for(var a=[],b,c=0;c<=x;c++){for(var d=b=
0;d<l.sin.length;d++)l.sin[d]||(l.sin[d]=0),b+=Math.sin(c/x*d*Math.PI*2)*l.sin[d];for(d=0;d<l.cos.length;d++)l.cos[d]||(l.cos[d]=0),b+=Math.cos(c/x*d*Math.PI*2)*l.cos[d];a.push(b)}A.draw(a)};e.reset=function(){this.wave({sin:[],cos:[]});this.resolution(100);this.updateBackground()};return e};this.sixteenSegmentDisplay__static=function(f,e,a,c,b,h,k,l,g,t){function m(){F._.fillStyle=l;F._.fillRect(0,0,F.$(c),F.$(b))}function u(){for(var a=0;a<K.length;a++){F._.beginPath();F._.moveTo(F.$(K[a][0].x),
F.$(K[a][0].y));for(var b=1;b<K[a].length;b++)F._.lineTo(F.$(K[a][b].x),F.$(K[a][b].y));F._.closePath();F._.fillStyle=0==stamp[a]?t:g;F._.fill()}}c=void 0===c?20:c;b=void 0===b?30:b;k=void 0===k?5:k;l=void 0===l?"rgb(0,0,0)":l;g=void 0===g?"rgb(200,200,200)":g;t=void 0===t?"rgb(20,20,20)":t;var q=c/8,p=c/8,w=[{x:.5*p+q,y:.5*p+q},{x:1*p+q,y:0*p+q},{x:0*p+q,y:1*p+q},{x:1*p+q,y:1*p+q},{x:1.75*p+q,y:1*p+q},{x:1*p+q,y:1.75*p+q}],x=[{x:c/2,y:.5*p+q},{x:c/2-.5*p,y:1*p+q},{x:c/2+.5*p,y:1*p+q},{x:c/2-.5*p,
y:0*p+q},{x:c/2+.5*p,y:0*p+q}],A=[{x:c-.5*p-q,y:.5*p+q},{x:c-1*p-q,y:0*p+q},{x:c-0*p-q,y:1*p+q},{x:c-1*p-q,y:1*p+q},{x:c-1*p-q,y:1.75*p+q},{x:c-1.75*p-q,y:1*p+q}],z=[{x:0*p+q,y:.5*b-.5*p},{x:1*p+q,y:.5*b-.5*p},{x:.5*p+q,y:.5*b-0*p},{x:0*p+q,y:.5*b+.5*p},{x:1*p+q,y:.5*b+.5*p}],y=[{x:c/2,y:b/2},{x:c/2-.5*p,y:.5*p+b/2},{x:c/2-.25*p,y:1.25*p+b/2},{x:c/2-1*p,y:.5*p+b/2},{x:c/2+.5*p,y:.5*p+b/2},{x:c/2+.5*p,y:1.75*p+b/2},{x:c/2+1*p,y:.5*p+b/2},{x:c/2-.5*p,y:.5*-p+b/2},{x:c/2-.25*p,y:1.25*-p+b/2},{x:c/2-
1*p,y:.25*-p+b/2},{x:c/2+.5*p,y:.5*-p+b/2},{x:c/2+.5*p,y:1.75*-p+b/2},{x:c/2+1*p,y:.25*-p+b/2}],r=[{x:c-1*p-q,y:.5*b-.5*p},{x:c-0*p-q,y:.5*b-.5*p},{x:c-.5*p-q,y:.5*b-0*p},{x:c-1*p-q,y:.5*b+.5*p},{x:c-0*p-q,y:.5*b+.5*p}],v=[{x:.5*p+q,y:b-.5*p-q},{x:0*p+q,y:b-1*p-q},{x:1*p+q,y:b-0*p-q},{x:1*p+q,y:b-1*p-q},{x:1*p+q,y:b-1.75*p-q},{x:1.75*p+q,y:b-1*p-q}],B=[{x:c/2-.5*p,y:b-1*p-q},{x:c/2+.5*p,y:b-1*p-q},{x:c/2,y:b-.5*p-q},{x:c/2-.5*p,y:b-0*p-q},{x:c/2+.5*p,y:b-0*p-q}];q=[{x:c-.5*p-q,y:b-.5*p-q},{x:c-0*
p-q,y:b-1*p-q},{x:c-1*p-q,y:b-0*p-q},{x:c-1*p-q,y:b-1*p-q},{x:c-1*p-q,y:b-1.75*p-q},{x:c-1.75*p-q,y:b-1*p-q}];var K=[[w[1],w[0],w[3],x[1],x[0],x[3]],[x[4],x[0],x[2],A[3],A[0],A[1]],[w[0],w[2],z[0],z[2],z[1],w[3]],[w[4],w[3],w[5],y[9],y[7],y[8]],[x[0],x[1],y[7],y[0],y[10],x[2]],[A[4],A[3],A[5],y[11],y[10],y[12]],[A[0],A[2],r[1],r[2],r[0],A[3]],[z[4],z[2],z[1],y[7],y[0],y[1]],[r[3],r[2],r[0],y[10],y[0],y[4]],[v[0],v[1],z[3],z[2],z[4],v[3]],[v[4],v[3],v[5],y[2],y[1],y[3]],[B[0],B[2],B[1],y[4],y[0],y[1]],
[q[4],q[3],q[5],y[5],y[4],y[6]],[q[3],r[3],r[2],r[4],q[1],q[0]],[v[2],v[0],v[3],B[0],B[2],B[3]],[q[2],q[0],q[3],B[1],B[2],B[4]]];stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];f=d.builder("group",void 0===f?"sixteenSegmentDisplay__static":f,{x:e,y:a,angle:void 0===h?0:h});var F=d.builder("canvas","subcanvas",{width:c,height:b,resolution:k});f.append(F);f.set=function(a,b){stamp[a].state=b;u()};f.get=function(a){return segments[a].state};f.clear=function(){for(var a=0;a<segments.length;a++)this.set(a,!1)};
f.enterCharacter=function(a){switch(a){case "!":stamp=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":stamp=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":stamp=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":stamp=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":stamp=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':stamp=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":stamp=[0,0,0,
0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":stamp=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":stamp=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":stamp=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":stamp=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":stamp=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":stamp=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":stamp=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":stamp=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":stamp=[1,1,1,0,0,0,
0,0,0,1,0,0,0,0,1,1];break;case "]":stamp=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":stamp=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":stamp=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":case 0:stamp=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":case 1:stamp=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":case 2:stamp=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":case 3:stamp=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":case 4:stamp=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;
case "5":case 5:stamp=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":case 6:stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":case 7:stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":case 8:stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":case 9:stamp=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":stamp=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":stamp=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;
case "d":case "D":stamp=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":stamp=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":stamp=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":stamp=[0,0,1,0,0,1,0,1,0,1,0,0,1,0,
0,0];break;case "l":case "L":stamp=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":stamp=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":stamp=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":stamp=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":stamp=[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":stamp=[1,1,1,0,0,0,0,1,1,
0,0,0,0,1,1,1];break;case "t":case "T":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":stamp=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":stamp=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":stamp=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":stamp=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":stamp=[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":stamp=[1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1];break;default:stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}m();u()};m();u();return f};this.readout_sixteenSegmentDisplay__static=function(f,e,a,c,b,h,k,l,g,t,n){c=void 0===c?100:c;b=void 0===b?30:b;h=void 0===h?5:h;l=void 0===l?5:l;g=void 0===g?"rgb(0,0,0)":g;t=void 0===t?"rgb(200,200,200)":t;n=void 0===n?"rgb(20,20,20)":n;var m="",q=null;f=d.builder("group",void 0===f?"readout_sixteenSegmentDisplay__static":f,{x:e,y:a,angle:void 0===k?0:k});var p=[];for(e=0;e<h;e++)a=d.builder("sixteenSegmentDisplay__static",
""+e,{x:c/h*e,width:c/h,height:b,resolution:l,style:{background:g,glow:t,dim:n}}),f.append(a),p.push(a);f.text=function(a){if(null==a)return m;m=a};f.print=function(a){clearInterval(q);switch(a){case "smart":m.length>p.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;q=setInterval(function(){for(var a=p.length-1;0<=a;a--)p[a].enterCharacter(m[b-(p.length-1-a)]);b++;b>p.length+m.length-1&&(b=0)},150);break;default:for(a=0;a<p.length;a++)p[a].enterCharacter(m[a])}};
return f};this.readout_sixteenSegmentDisplay=function(f,e,a,c,b,h,k,g,m,t){c=void 0===c?100:c;b=void 0===b?30:b;h=void 0===h?5:h;g=void 0===g?"rgb(0,0,0)":g;m=void 0===m?"rgb(200,200,200)":m;t=void 0===t?"rgb(20,20,20)":t;var l="",u=null;f=d.builder("group",void 0===f?"readout_sixteenSegmentDisplay":f,{x:e,y:a,angle:void 0===k?0:k});var q=[];for(e=0;e<h;e++)a=d.builder("sixteenSegmentDisplay",""+e,{x:c/h*e,width:c/h,height:b,style:{background:g,glow:m,dim:t}}),f.append(a),q.push(a);f.text=function(a){if(null==
a)return l;l=a};f.print=function(a){clearInterval(u);switch(a){case "smart":l.length>q.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;u=setInterval(function(){for(var a=q.length-1;0<=a;a--)q[a].enterCharacter(l[b-(q.length-1-a)]);b++;b>q.length+l.length-1&&(b=0)},150);break;default:for(a=0;a<q.length;a++)q[a].enterCharacter(l[a])}};return f};this.grapher_audioScope__static=function(f,e,a,c,b,h,k,l,m,t,n,u,q,p){f=void 0===f?"grapher_audioScope__static":f;c=void 0===
c?120:c;b=void 0===b?60:b;h=void 0===h?0:h;k=void 0===k?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:k;l=void 0===l?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:l;m=void 0===m?"rgba(0,100,0,1)":m;t=void 0===t?.25:t;n=void 0===n?"rgba(0,150,0,1)":n;u=void 0===u?.1:u;q=void 0===q?"Helvetica":q;p=void 0===p?"rgba(50,50,50,1)":p;var w=g.library.audio.context.createAnalyser(),x=null,r=10,z=null,y=256;w.fftSize=y;x=new Uint8Array(w.fftSize);new Uint8Array(w.fftSize);e=d.builder("group",
f,{x:e,y:a,angle:h});var v=d.builder("grapher__static",f,{x:0,y:0,width:c,height:b,foregroundStyles:[k],foregroundTextStyles:[l],backgroundStyle_stroke:m,backgroundStyle_lineWidth:t,backgroundTextStyle_fill:n,backgroundTextStyle_size:u,backgroundTextStyle_font:q,backingStyle:p});e.append(v);e.start=function(){null==z&&(z=setInterval(function(){var a=[];w.getByteTimeDomainData(x);for(var b=0;b<x.length;b++)a.push(x[b]/128-1);v.draw(a)},1E3/r))};e.stop=function(){clearInterval(z);z=null};e.getNode=
function(){return w};e.resolution=function(a){a=void 0===a?null:a;if(null==a)return y;y=a;this.stop();this.start()};e.refreshRate=function(a){if(null==a)return r;r=a;this.stop();this.start()};v.viewbox({l:-1.1,h:1.1});v.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});v.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});v.drawBackground();return e};this.level=function(f,e,a,c,b,h,k,g){b=void 0===b?20:b;h=void 0===h?60:h;k=void 0===k?"rgb(10,10,10)":k;g=
void 0===g?["rgb(250,250,250)","rgb(200,200,200)"]:g;var l=[];f=d.builder("group",void 0===f?"level":f,{x:e,y:a,angle:void 0===c?0:c});k=d.builder("rectangle","backing",{width:b,height:h,style:{fill:k}});f.append(k);k=d.builder("group","levels");f.append(k);var t=[];for(e=0;e<g.length;e++)l.push(0),t.push(d.builder("rectangle","movingRect_"+e,{y:h,width:b,height:0,style:{fill:g[e]}})),k.prepend(t[e]);f.layer=function(a,b){b=void 0===b?0:b;if(void 0==b)return l;if(null==a)return l[b];a=1<a?1:a;a=0>
a?0:a;l[b]=a;t[b].parameter.height(h*a);t[b].parameter.y(h-h*a)};return f}};this.control=new function(){this.rastorgrid=function(f,e,a,c,b,g,k,l,m,t,n,u,q){c=void 0===c?80:c;b=void 0===b?80:b;k=void 0===k?5:k;l=void 0===l?5:l;m=void 0===m?"rgba(200,200,200,1)":m;t=void 0===t?"rgba(150,150,150,1)":t;n=void 0===n?"rgba(220,220,220,1)":n;u=void 0===u?"rgba(220,220,220,1)":u;q=void 0===q?function(){}:q;var h=d.builder("group",void 0===f?"rastorgrid":f,{x:e,y:a,angle:void 0===g?0:g});for(a=0;a<l;a++)for(e=
0;e<k;e++)f=d.builder("checkbox_rect",a+"_"+e,{x:c/k*e,y:b/l*a,width:c/k,height:b/l,style:{check:t,backing:m,checkGlow:u,backingGlow:n},onchange:function(){if(h.onchange)h.onchange(h.get())}}),h.append(f);h.box=function(a,b){return h.getChildByName(b+"_"+a)};h.get=function(){for(var a=[],b=0;b<l;b++){for(var c=[],d=0;d<k;d++)c.push(this.box(d,b).get());a.push(c)}return a};h.set=function(a,b){for(b=0;b<l;b++)for(var c=0;c<k;c++)h.box(c,b).set(a[b][c],!1)};h.clear=function(){for(var a=0;a<l;a++)for(var b=
0;b<k;b++)h.box(b,a).set(!1,!1)};h.light=function(a,b,c){h.box(a,b).light(c)};h.onchange=q;return h};this.needleOverlay=function(f,e,a,c,b,h,k,l,m,t,n,u,q){function p(a){return a.x*Math.cos(v.__calculationAngle)-a.y*Math.sin(v.__calculationAngle)}function w(a){var d=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=d.x-C.extremities.points[0].x;d=d.y-C.extremities.points[0].y;return{x:(a*Math.cos(v.__calculationAngle)-d*Math.sin(v.__calculationAngle))/c,y:(d*Math.cos(v.__calculationAngle)-a*Math.sin(v.__calculationAngle))/
b}}function x(a,b){var d="lead"==a?K:B;void 0==b||0>b||1<b?(d.remove(F[a]),delete y[a]):(d.contains(F[a])||d.append(F[a]),F[a].parameter.x(b*c-c*k*b),y[a]=b)}function r(a,b){b=void 0===b?!0:b;if(l){if(void 0==a)return y.lead;1<a||0>a?x("lead"):x("lead",a);if(b&&void 0!=v.onchange)v.onchange("lead",a)}}function z(a,b,d){d=void 0===d?!0:d;if(m){if(void 0==a||void 0==b)return{A:y.selection_A,B:y.selection_B};1<a||0>a||1<b||0>b?(x("selection_A"),x("selection_B")):(x("selection_A",a),x("selection_B",b));
if(void 0==y.selection_A||void 0==y.selection_B||y.selection_A==y.selection_B)B.remove(F.selection_area),v.selectionAreaToggle&&v.selectionAreaToggle(!1),delete y.selection_area;else{B.contains(F.selection_area)||(B.append(F.selection_area),v.selectionAreaToggle&&v.selectionAreaToggle(!0));if(y.selection_A<y.selection_B)var e=y.selection_A,f=y.selection_B;else e=y.selection_B,f=y.selection_A;e=e-k*e+k;f=f-k*f-e;0>f&&(f=0);F.selection_area.parameter.x(c*e);F.selection_area.parameter.width(c*f)}if(d&&
void 0!=v.onchange)v.onchange("selection_A",a);if(d&&void 0!=v.onchange)v.onchange("selection_B",b)}}c=void 0===c?120:c;b=void 0===b?60:b;h=void 0===h?0:h;k=void 0===k?1/512:k;l=void 0===l?!0:l;m=void 0===m?!0:m;t=void 0===t?["rgba(240, 240, 240, 1)","rgba(255, 231, 114, 1)"]:t;n=void 0===n?function(a,b){}:n;u=void 0===u?function(a,b){}:u;q=void 0===q?function(a){}:q;var y={},v=d.builder("group",void 0===f?"needleOverlay":f,{x:e,y:a,angle:h}),C=d.builder("rectangle","backing",{width:c,height:b,style:{fill:"rgba(0,0,0,0)"}});
v.append(C);f=d.builder("group","controlObjectsGroup");v.append(f);var B=d.builder("group","back");f.append(B);var K=d.builder("group","front");f.append(K);f=c*k+.005*c;var F={};F.lead=d.builder("group","lead");F.lead.append(d.builder("rectangle","handle",{width:k*c,height:b,style:{fill:t[0]}}));F.lead.append(d.builder("rectangle","invisibleHandle",{x:(c*k-f)/2,width:f,height:b,style:{fill:"rgba(255,0,0,0)"}}));F.selection_A=d.builder("group","selection_A");F.selection_A.append(d.builder("rectangle",
"handle",{width:k*c,height:b,style:{fill:t[1]}}));F.selection_A.append(d.builder("rectangle","invisibleHandle",{x:(c*k-f)/2,width:f,height:b,style:{fill:"rgba(255,0,0,0)"}}));F.selection_B=d.builder("group","selection_B");F.selection_B.append(d.builder("rectangle","handle",{width:k*c,height:b,style:{fill:t[1]}}));F.selection_B.append(d.builder("rectangle","invisibleHandle",{x:(c*k-f)/2,width:f,height:b,style:{fill:"rgba(255,0,0,0)"}}));F.selection_area=d.builder("rectangle","selection_area",{height:b,
style:{fill:g.library.misc.blendColours(t[1],"rgba(0,0,0,0)",.5)}});F.markGroup=d.builder("group","markGroup");B.append(F.markGroup);v.__calculationAngle=h;var O=!1,M=!1,Y=!1,Z=!1;C.onmousedown=function(a,b,c){if(g.system.keyboard.pressedKeys.shift){var d=w(c).x;g.system.mouse.mouseInteractionHandler(function(a){v.area(d,w(a).x)})}else v.select(w(c).x)};F.lead.getChildByName("invisibleHandle").onmouseenter=function(a,b,c){g.core.viewport.cursor("col-resize")};F.lead.getChildByName("invisibleHandle").onmouseleave=
function(a,b,c){g.core.viewport.cursor("default")};F.lead.getChildByName("invisibleHandle").onmousedown=function(a,b,d){O=!0;var e=y.lead,f=p(d),h=(c-c*k)/2;g.system.mouse.mouseInteractionHandler(function(a){a=f-p(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;r(1<a?1:a)},function(a){a=f-p(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;O=!1;r(a);if(void 0!=v.onrelease)v.onrelease("lead",a)})};F.selection_A.getChildByName("invisibleHandle").onmouseenter=function(a,b,c){g.core.viewport.cursor("col-resize")};
F.selection_A.getChildByName("invisibleHandle").onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};F.selection_A.getChildByName("invisibleHandle").onmousedown=function(a,b,d){Y=!0;var e=y.selection_A,f=p(d),h=(c-c*k)/2;g.system.mouse.mouseInteractionHandler(function(a){a=f-p(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;z(1<a?1:a,y.selection_B)},function(a){a=f-p(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;Y=!1;z(a,y.selection_B);if(void 0!=v.onrelease)v.onrelease("selection_A",
a)})};F.selection_B.getChildByName("invisibleHandle").onmouseenter=function(a,b,c){g.core.viewport.cursor("col-resize")};F.selection_B.getChildByName("invisibleHandle").onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};F.selection_B.getChildByName("invisibleHandle").onmousedown=function(a,b,d){Z=!0;var e=y.selection_B,f=p(d),h=(c-c*k)/2;g.system.mouse.mouseInteractionHandler(function(a){a=f-p(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;z(y.selection_A,1<a?1:a)},function(a){a=
f-p(a);var b=g.core.viewport.scale();a=e-a/(b*h);a=0>a?0:a;a=1<a?1:a;Z=!1;z(y.selection_A,a);if(void 0!=v.onrelease)v.onrelease("selection_B",a)})};F.selection_area.onmouseenter=function(a,b,c){g.core.viewport.cursor("grab")};F.selection_area.onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};F.selection_area.onmousedown=function(a,b,d){g.core.viewport.cursor("grabbing");M=!0;var e=y.selection_B-y.selection_A,f=y.selection_A,h=y.selection_B,l=p(d),m=(c-c*k)/2;g.system.mouse.mouseInteractionHandler(function(a){var b=
l-p(a),c=g.core.viewport.scale();a=f-b/(c*m);b=h-b/(c*m);1<a&&(a=1,b=1+e);1<b&&(b=1,a=1-e);0>a&&(a=0,b=e);0>b&&(b=0,a=-e);z(a,b)},function(a){g.core.viewport.cursor("grab");var b=l-p(a),c=g.core.viewport.scale();a=f-b/(c*m);b=h-b/(c*m);1<a&&(a=1,b=1+e);1<b&&(b=1,a=1-e);0>a&&(a=0,b=e);0>b&&(b=0,a=-e);M=!1;z(a,b);if(void 0!=v.onrelease)v.onrelease("selection_A",a);if(void 0!=v.onrelease)v.onrelease("selection_B",b)})};F.selection_A.ondblclick=function(a,b,c,d){z(-1,-1);g.core.viewport.cursor("default")};
F.selection_B.ondblclick=F.selection_A.ondblclick;F.selection_area.ondblclick=F.selection_A.ondblclick;v.mark=function(a){var e=F.markGroup.getChildByName(""+a);void 0==e?(F.markGroup.append(d.builder("rectangle",""+a,{x:a*c,width:k*c,height:b,style:{fill:t[0]}})),a=!0):(F.markGroup.remove(e),a=!1);return a};v.removeAllMarks=function(){F.markGroup.clear()};v.select=function(a,b){b=void 0===b?!0:b;if(void 0==a)return r();O||r(a,b)};v.area=function(a,b,c){c=void 0===c?!0:c;if(void 0==a&&void 0==b)return z();
M||void 0!=a&&Y||void 0!=b&&Z||z(a,b,c)};v.onchange=n;v.onrelease=u;v.selectionAreaToggle=q;return v};this.button_rect=function(f,e,a,c,b,h,k,g,m,t,n,u,q,p,r,x,A,z,y,v,C,B,K,F,O,M,Y,Z,G,U,fa,aa,ba,da,ea,E,D,W,S,J,H,ca,N,P,Q,T,R,V,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka){function l(){if(u){var a=[{fill:F,stroke:O,lineWidth:M},{fill:Y,stroke:Z,lineWidth:G},{fill:U,stroke:fa,lineWidth:aa},{fill:ba,stroke:da,lineWidth:ea},{fill:E,stroke:D,lineWidth:W},
{fill:S,stroke:J,lineWidth:H},{fill:ca,stroke:N,lineWidth:P},{fill:Q,stroke:T,lineWidth:R},{fill:V,stroke:ha,lineWidth:ia},{fill:ja,stroke:ka,lineWidth:la},{fill:ma,stroke:na,lineWidth:oa},{fill:pa,stroke:qa,lineWidth:ra},{fill:sa,stroke:ta,lineWidth:ua},{fill:va,stroke:wa,lineWidth:xa},{fill:ya,stroke:za,lineWidth:Aa},{fill:Ba,stroke:Ca,lineWidth:Da}];!q&&w.state.hovering&&(w.state.hovering=!1);!p&&w.state.selected&&(w.state.selected=!1);var b=8*w.state.hovering+4*w.state.glowing+2*w.state.selected+
1*(r&&w.state.pressed);I.style.fill=a[b].fill;I.style.stroke=a[b].stroke;I.style.lineWidth=a[b].lineWidth}else I.style.fill=C,I.style.stroke=B,I.style.lineWidth=K}c=void 0===c?30:c;b=void 0===b?20:b;k=void 0===k?"":k;g=void 0===g?"":g;m=void 0===m?"":m;t=void 0===t?.5:t;n=void 0===n?.05:n;u=void 0===u?!0:u;q=void 0===q?!0:q;p=void 0===p?!1:p;r=void 0===r?!0:r;x=void 0===x?"5pt Arial":x;A=void 0===A?"alphabetic":A;z=void 0===z?"rgba(0,0,0,1)":z;y=void 0===y?"rgba(0,0,0,0)":y;v=void 0===v?1:v;C=void 0===
C?"rgba(180,180,180,1)":C;B=void 0===B?"rgba(0,0,0,0)":B;K=void 0===K?0:K;F=void 0===F?"rgba(200,200,200,1)":F;O=void 0===O?"rgba(0,0,0,0)":O;M=void 0===M?0:M;Y=void 0===Y?"rgba(230,230,230,1)":Y;Z=void 0===Z?"rgba(0,0,0,0)":Z;G=void 0===G?0:G;U=void 0===U?"rgba(200,200,200,1)":U;fa=void 0===fa?"rgba(120,120,120,1)":fa;aa=void 0===aa?.75:aa;ba=void 0===ba?"rgba(230,230,230,1)":ba;da=void 0===da?"rgba(120,120,120,1)":da;ea=void 0===ea?.75:ea;E=void 0===E?"rgba(220,220,220,1)":E;D=void 0===D?"rgba(0,0,0,0)":
D;W=void 0===W?0:W;S=void 0===S?"rgba(250,250,250,1)":S;J=void 0===J?"rgba(0,0,0,0)":J;H=void 0===H?0:H;ca=void 0===ca?"rgba(220,220,220,1)":ca;N=void 0===N?"rgba(120,120,120,1)":N;P=void 0===P?.75:P;Q=void 0===Q?"rgba(250,250,250,1)":Q;T=void 0===T?"rgba(120,120,120,1)":T;R=void 0===R?.75:R;V=void 0===V?"rgba(220,220,220,1)":V;ha=void 0===ha?"rgba(0,0,0,0)":ha;ia=void 0===ia?0:ia;ja=void 0===ja?"rgba(240,240,240,1)":ja;ka=void 0===ka?"rgba(0,0,0,0)":ka;la=void 0===la?0:la;ma=void 0===ma?"rgba(220,220,220,1)":
ma;na=void 0===na?"rgba(120,120,120,1)":na;oa=void 0===oa?.75:oa;pa=void 0===pa?"rgba(240,240,240,1)":pa;qa=void 0===qa?"rgba(120,120,120,1)":qa;ra=void 0===ra?.75:ra;sa=void 0===sa?"rgba(240,240,240,1)":sa;ta=void 0===ta?"rgba(0,0,0,0)":ta;ua=void 0===ua?0:ua;va=void 0===va?"rgba(250,250,250,1)":va;wa=void 0===wa?"rgba(0,0,0,0)":wa;xa=void 0===xa?0:xa;ya=void 0===ya?"rgba(240,240,240,1)":ya;za=void 0===za?"rgba(120,120,120,1)":za;Aa=void 0===Aa?.75:Aa;Ba=void 0===Ba?"rgba(250,250,250,1)":Ba;Ca=void 0===
Ca?"rgba(120,120,120,1)":Ca;Da=void 0===Da?.75:Da;Ea=void 0===Ea?function(a){}:Ea;Fa=void 0===Fa?function(a){}:Fa;Ga=void 0===Ga?function(a){}:Ga;Ha=void 0===Ha?function(a){}:Ha;Ia=void 0===Ia?function(a){}:Ia;Ja=void 0===Ja?function(a){}:Ja;Ka=void 0===Ka?function(a){}:Ka;var w=d.builder("group",void 0===f?"button_rect":f,{x:e,y:a,angle:void 0===h?0:h}),I=d.builder("rectangle","backing",{width:c,height:b,style:{fill:C,stroke:B,lineWidth:K}});w.append(I);k=d.builder("text","centre",{x:c/2,y:b*t,text:k,
style:{font:x,testBaseline:A,fill:z,stroke:y,lineWidth:v,textAlign:"center",textBaseline:"middle"}});w.append(k);g=d.builder("text","left",{x:c*n,y:b*t,text:g,style:{font:x,testBaseline:A,fill:z,stroke:y,lineWidth:v,textAlign:"left",textBaseline:"middle"}});w.append(g);m=d.builder("text","right",{x:c-c*n,y:b*t,text:m,style:{font:x,testBaseline:A,fill:z,stroke:y,lineWidth:v,textAlign:"right",textBaseline:"middle"}});w.append(m);var X=d.builder("rectangle","cover",{width:c,height:b,style:{fill:"rgba(0,0,0,0)"}});
w.append(X);w.state={hovering:!1,glowing:!1,selected:!1,pressed:!1};l();w.press=function(a){if(u){if(r){if(this.state.pressed)return;this.state.pressed=!0;if(this.onpress)this.onpress(this,a)}this.select(!this.select(),a);l()}};w.release=function(a){if(u&&r&&this.state.pressed&&(this.state.pressed=!1,l(),this.onrelease))this.onrelease(this,a)};w.active=function(a){if(void 0==a)return u;u=a;l()};w.glow=function(a){if(void 0==a)return this.state.glowing;this.state.glowing=a;l()};w.select=function(a,
b,c){c=void 0===c?!0:c;if(u){if(void 0==a)return this.state.selected;if(p&&this.state.selected!=a&&(this.state.selected=a,l(),c))if(this.state.selected)this.onselect(this,b);else this.ondeselect(this,b)}};w.forceMouseLeave=function(){w.state.hovering=!1;w.release("forced");l();if(w.onleave)w.onleave("forced")};X.onmouseenter=function(a,b,c){w.state.hovering=!0;l();if(w.onenter)w.onenter(c);if(1==c.buttons)X.onmousedown(c)};X.onmouseleave=function(a,b,c){w.state.hovering=!1;w.release(c);l();if(w.onleave)w.onleave(c)};
X.onmouseup=function(a,b,c){w.release(c)};X.onmousedown=function(a,b,c){w.press(c)};X.ondblclick=function(a,b,c){if(u&&w.ondblpress)w.ondblpress(c)};w.onenter=Ea;w.onleave=Fa;w.onpress=Ga;w.ondblpress=Ha;w.onrelease=Ia;w.onselect=Ja;w.ondeselect=Ka;return w};this.checkbox_rect=function(f,e,a,c,b,h,g,l,m,t,n){function k(){x.glowing?(p.style.fill=t,w.style.fill=x.checked?m:"rgba(0,0,0,0)"):(p.style.fill=l,w.style.fill=x.checked?g:"rgba(0,0,0,0)")}c=void 0===c?20:c;b=void 0===b?20:b;g=void 0===g?"rgba(150,150,150,1)":
g;l=void 0===l?"rgba(200,200,200,1)":l;m=void 0===m?"rgba(220,220,220,1)":m;t=void 0===t?"rgba(220,220,220,1)":t;n=void 0===n?function(){}:n;var q=d.builder("group",void 0===f?"checkbox_rect":f,{x:e,y:a,angle:void 0===h?0:h}),p=d.builder("rectangle","backing",{width:c,height:b,style:{fill:l}});q.append(p);var w=d.builder("rectangle","checkrect",{x:.1*c,y:.1*b,width:.8*c,height:.8*b,style:{fill:"rgba(0,0,0,0)"}});q.append(w);f=d.builder("rectangle","cover",{width:c,height:b,style:{fill:"rgba(0,0,0,0)"}});
q.append(f);var x={checked:!1,glowing:!1};q.get=function(){return x.checked};q.set=function(a,b){b=void 0===b?!0:b;x.checked=a;k();if(b&&this.onchange)this.onchange(a)};q.light=function(a){if(void 0==a)return a.glowing;a.glowing=a;k()};f.onclick=function(a){q.set(!q.get())};f.onmousedown=function(){};q.onchange=n;return q};this.slide=function(f,e,a,c,b,h,k,l,m,t,n,u,q,p,w){function x(a,c){a=1<a?1:a;a=0>a?0:a;if((void 0===c||c)&&void 0!=z.onchange)z.onchange(a);l=a;C.y=a*b*(1-k);B.y=a*b*(1-k);C.computeExtremities();
B.computeExtremities()}function r(a){return a.y*Math.cos(z.__calculationAngle)-a.x*Math.sin(z.__calculationAngle)}c=void 0===c?10:c;b=void 0===b?95:b;h=void 0===h?0:h;k=void 0===k?.1:k;l=void 0===l?0:l;m=void 0===m?-1:m;t=void 0===t?"rgba(200,200,200,1)":t;n=void 0===n?"rgba(150,150,150,1)":n;u=void 0===u?"rgba(50,50,50,1)":u;q=void 0===q?"rgba(255,0,0,0)":q;p=void 0===p?function(){}:p;w=void 0===w?function(){}:w;var z=d.builder("group",void 0===f?"slide":f,{x:e,y:a,angle:h}),y=d.builder("group",
"backingAndSlotGroup");z.append(y);f=d.builder("rectangle","backing",{width:c,height:b,style:{fill:n}});y.append(f);u=d.builder("rectangle","slot",{x:.45*c,y:k/2*b,width:.1*c,height:b*(1-k),style:{fill:u}});y.append(u);var v=d.builder("rectangle","backingAndSlotCover",{width:c,height:b,style:{fill:"rgba(0,0,0,0)"}});y.append(v);var C=d.builder("rectangle","handle",{width:c,height:b*k,style:{fill:t}});z.append(C);t=b*k+.01*b;var B=d.builder("rectangle","invisibleHandle",{y:(b*k-t)/2,width:c,height:t+
k,style:{fill:q}});z.append(B);z.__calculationAngle=h;var K=!1;z.set=function(a,b){K||x(a,b)};z.get=function(){return l};z.ondblclick=function(){if(!(0>m||K)&&(x(m),void 0!=z.onrelease))z.onrelease(l)};z.onwheel=function(){if(!K){var a=event.deltaY/100,b=g.core.viewport.scale();x(l+a/(10*b));if(void 0!=z.onrelease)z.onrelease(l)}};y.onmousedown=function(a,b,c){};y.onclick=function(a,b,c){if(!K&&(c=y.getOffset(),a=g.library.math.cartesianAngleAdjust(a-(y.x+c.x),b-(y.y+c.y),0-(y.angle+c.a)).y/v.height,
a+=.5*k*(2*a-1),x(a),void 0!=z.onrelease))z.onrelease(a)};B.onmousedown=function(a,c,d){K=!0;var e=l,f=r(d),h=b-b*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-r(a);var b=g.core.viewport.scale();x(e-a/(b*h)*window.devicePixelRatio)},function(a){a=f-r(a);var b=g.core.viewport.scale();z.onrelease(e-a/(b*h)*window.devicePixelRatio);K=!1})};x(l);z.onchange=p;z.onrelease=w;return z};this.dial_continuous=function(f,e,a,c,b,h,k,l,m,t,n,u,q,p){function w(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||
b)&&void 0!=x.onchange)x.onchange(a);h=a;r.parameter.angle(l+m*h)}c=void 0===c?15:c;h=void 0===h?0:h;k=void 0===k?-1:k;l=void 0===l?3*Math.PI/4:l;m=void 0===m?1.5*Math.PI:m;t=void 0===t?"rgba(200,200,200,1)":t;n=void 0===n?"rgba(50,50,50,1)":n;u=void 0===u?"rgba(250,100,100,1)":u;q=void 0===q?function(){}:q;p=void 0===p?function(){}:p;var x=d.builder("group",void 0===f?"dial_continuous":f,{x:e,y:a,angle:void 0===b?0:b});f=d.builder("circle","slot",{r:1.1*c,style:{fill:n}});x.append(f);t=d.builder("circle",
"handle",{r:c,style:{fill:t}});x.append(t);var r=d.builder("group","needleGroup",{ignored:!0});x.append(r);f=c/5;e=c;u=d.builder("rectangle","needle",{x:e/3,y:-f/2,height:f,width:e,style:{fill:u}});r.append(u);var z=!1;x.set=function(a,b){z||w(a,b)};x.get=function(){return h};var y=4*c;t.ondblclick=function(){if(!(0>k||z)&&(w(k),void 0!=x.onrelease))x.onrelease(h)};t.onwheel=function(a,b,c){if(!z&&(a=c.deltaY/100,b=g.core.viewport.scale(),w(h-a/(10*b)),void 0!=x.onrelease))x.onrelease(h)};t.onmousedown=
function(a,b,c){var d=h,e=c.y;z=!0;g.system.mouse.mouseInteractionHandler(function(a){a=a.y-e;var b=g.core.viewport.scale();w(d-a/(b*y)*window.devicePixelRatio,!0)},function(a){z=!1;if(void 0!=x.onrelease)x.onrelease(h)})};x.onchange=q;x.onrelease=p;w(h);return x};this.slidePanel=function(f,e,a,c,b,h,g,l,m,t,n,u,q){c=void 0===c?80:c;b=void 0===b?95:b;h=void 0===h?0:h;l=void 0===l?8:l;m=void 0===m?0:m;t=void 0===t?.5:t;n=void 0===n?"rgba(200,200,200,1)":n;u=void 0===u?"rgba(150,150,150,1)":u;q=void 0===
q?"rgba(50,50,50,1)":q;var k=d.builder("group",void 0===f?"slidePanel":f,{x:e,y:a,angle:h});for(f=0;f<l;f++)e=d.builder("slide","slide_"+f,{x:c/l*f,y:0,width:c/l,height:b,value:m,resetValue:t,style:{handle:n,backing:u,slot:q},onchange:function(a){k.onchange(this.id,a)},onrelease:function(a){k.onrelease(this.id,a)}}),e.__calculationAngle=h,k.append(e);return k};this.sequencer=function(f,e,a,c,b,h,k,l,m,t,n,u,q,p,w,x,r,z,y,v,C,B,K,F,G,M){function A(a){var d=g.core.viewport.windowPoint2workspacePoint(a.x,
a.y);a=d.x-ca.extremities.points[0].x;d=d.y-ca.extremities.points[0].y;return{x:(a*Math.cos(H.__calculationAngle)-d*Math.sin(H.__calculationAngle))/c,y:(d*Math.cos(H.__calculationAngle)-a*Math.sin(H.__calculationAngle))/b}}function I(a){return{x:E.viewArea.topLeft.x+a.x*m,y:E.viewArea.topLeft.y+a.y*t}}function X(a){return{x:m*(a.x-E.viewposition.x)+E.viewposition.x,y:t*(a.y-E.viewposition.y)+E.viewposition.y}}function U(a){a.y=Math.floor(a.y*l);a.y>=l&&(a.y=l-1);a.x=D.snapping?Math.round(a.x*k/D.step)*
D.step:a.x*k;0>a.x&&(a.x=0);return{line:a.y,position:a.x}}function O(a,d,e){if(void 0==a&&void 0==d)return E.viewposition;if(void 0==a||isNaN(a))a=E.viewposition.x;if(void 0==d||isNaN(d))d=E.viewposition.y;a=0>a?0:a;a=1<a?1:a;d=0>d?0:d;d=1<d?1:d;E.viewposition.x=a;E.viewposition.y=d;N.parameter.x(-E.viewposition.x*(E.totalSize.width-c));N.parameter.y(-E.viewposition.y*(E.totalSize.height-b));E.viewArea={topLeft:{x:a-m*a,y:d-t*d},bottomRight:{x:a+m*(1-a),y:d+t*(1-d)}}}function aa(a,d){if(void 0==a&&
void 0==d)return{x:m,y:t};if(void 0!=a&&a!=m&&void 0!=d&&d!=t){a=.01>a?.01:a;d=.01>d?.01:d;m=1<a?1:a;t=1<d?1:d;E.totalSize.width=c/m;E.totalSize.height=b/t;T.parameter.width(E.totalSize.width);T.parameter.height(E.totalSize.width);V.parameter.width(E.totalSize.width);V.parameter.height(E.totalSize.width);for(a=0;a<k;a++)Q.children[a].parameter.x(c/(k*m)*a),Q.children[a].parameter.width(c/(k*m)),Q.children[a].parameter.height(E.totalSize.height);for(a=0;a<l;a++)P.children[a].parameter.y(b/(l*t)*a),
P.children[a].parameter.height(b/(l*t)),P.children[a].parameter.width(E.totalSize.width);for(a=0;a<R.children.length;a++)R.children[a].unit(c/(k*m),b/(l*t));J.present&&(N.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(E.totalSize.height),N.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(E.totalSize.height),N.getElementsWithName("playhead")[0].parameter.x(E.totalSize.width/k*J.position))}else if(void 0!=a&&a!=m){a=.01>
a?.01:a;m=1<a?1:a;E.totalSize.width=c/m;T.parameter.width(E.totalSize.width);V.parameter.width(E.totalSize.width);for(a=0;a<k;a++)Q.children[a].parameter.x(c/(k*m)*a),Q.children[a].parameter.width(c/(k*m));for(a=0;a<l;a++)P.children[a].parameter.width(E.totalSize.width);for(a=0;a<R.children.length;a++)R.children[a].unit(c/(k*m),void 0);J.present&&N.getElementsWithName("playhead")[0].parameter.x(E.totalSize.width/k*J.position)}else if(void 0!=d&&d!=t){d=.01>d?.01:d;t=1<d?1:d;E.totalSize.height=b/t;
T.parameter.height(E.totalSize.width);V.parameter.height(E.totalSize.width);for(a=0;a<k;a++)Q.children[a].parameter.height(E.totalSize.height);for(a=0;a<l;a++)P.children[a].parameter.y(b/(l*t)*a),P.children[a].parameter.height(b/(l*t));for(a=0;a<R.children.length;a++)R.children[a].unit(void 0,b/(l*t));J.present&&(N.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(E.totalSize.height),N.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(E.totalSize.height))}}
function ba(a,d,e,f){f=void 0===f?D.defaultStrength:f;a=D.signalRegistry.add({line:a,position:d,length:e,strength:f});d=D.signalRegistry.getSignal(a);var h=ea.sequencer.signalBlock(a,c/(k*m),b/(l*t),d.line,d.position,d.length,d.strength,!1,q,p,w,x);R.append(h);h.select=function(a){a=void 0===a?!1:a;-1!=D.selectedSignals.indexOf(this)?a||this.deselect():(this.selected(!0),D.selectedSignals.push(this),this.glow(!0))};h.deselect=function(){D.selectedSignals.splice(D.selectedSignals.indexOf(this),1);
this.selected(!1);this.glow(!1)};h.delete=function(){this.deselect();D.signalRegistry.remove(parseInt(this.name));this.parent.remove(this)};h.ondblclick=function(a,b,c){if(g.system.keyboard.pressedKeys.control||g.system.keyboard.pressedKeys.command)for(a=0;a<D.selectedSignals.length;a++)D.selectedSignals[a].strength(D.defaultStrength),D.signalRegistry.update(parseInt(D.selectedSignals[a].name),{strength:D.defaultStrength})};h.body.onmousedown=function(a,c,d){if(g.system.keyboard.pressedKeys.Space)T.onmousedown(a,
c,d);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<D.selectedSignals.length;)D.selectedSignals[0].deselect();h.select(!0);var e=[];for(a=0;a<D.selectedSignals.length;a++)e.push({name:parseInt(D.selectedSignals[a].name),block:D.selectedSignals[a],starting:D.signalRegistry.getSignal(parseInt(D.selectedSignals[a].name))});if(g.system.keyboard.pressedKeys.control||g.system.keyboard.pressedKeys.command){var f=e.map(function(a){return a.block.strength()}),k=d.offsetY;g.system.mouse.mouseInteractionHandler(function(a){g.system.keyboard.pressedKeys.ControlLeft||
g.system.keyboard.pressedKeys.ControlRight||g.system.keyboard.pressedKeys.command||g.system.mouse.forceMouseUp();a=(k-a.offsetY)/(g.core.viewport.scale()*b*4);for(var c=0;c<e.length;c++)e[c].block.strength(f[c]+a),D.signalRegistry.update(e[c].name,{strength:f[c]+a})})}else{var l=!1,m=U(I(A(d)));g.system.mouse.mouseInteractionHandler(function(a){if(!l&&(l=!0,g.system.keyboard.pressedKeys.alt))for(var b=0;b<D.selectedSignals.length;b++){var c=D.signalRegistry.getSignal(parseInt(D.selectedSignals[b].name));
ba(c.line,c.position,c.length,c.strength)}b=U(I(A(a)));a=b.line-m.line;b=b.position-m.position;for(c=0;c<e.length;c++){D.signalRegistry.update(e[c].name,{line:e[c].starting.line+a,position:e[c].starting.position+b});var d=D.signalRegistry.getSignal(e[c].name);e[c].block.line(d.line);e[c].block.position(d.position)}})}}};h.body.onmousemove=function(a,b,c){a=g.system.keyboard.pressedKeys;b="default";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.body.onkeydown=function(a,b,c){g.system.keyboard.pressedKeys.alt&&
g.core.viewport.cursor("copy")};h.body.onkeyup=function(a,b,c){g.system.keyboard.pressedKeys.alt||g.core.viewport.cursor("default")};h.leftHandle.onmousedown=function(a,b,c){if(g.system.keyboard.pressedKeys.Space)T.onmousedown(a,b,c);else if(g.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,c);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<D.selectedSignals.length;)D.selectedSignals[0].deselect();h.select(!0);var d=[];for(a=0;a<D.selectedSignals.length;a++)d.push({name:parseInt(D.selectedSignals[a].name),
block:D.selectedSignals[a],starting:D.signalRegistry.getSignal(parseInt(D.selectedSignals[a].name))});var e=U(I(A(c)));g.system.mouse.mouseInteractionHandler(function(a){a=U(I(A(a)));a=e.position-a.position;for(var b=0;b<d.length;b++)if(!(0>d[b].starting.position-a)){D.signalRegistry.update(d[b].name,{length:d[b].starting.length+a,position:d[b].starting.position-a});var c=D.signalRegistry.getSignal(d[b].name);d[b].block.position(c.position);d[b].block.length(c.length)}})}};h.leftHandle.onmousemove=
function(a,b,c){a=g.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.leftHandle.onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};h.rightHandle.onmousedown=function(a,b,c,d){d=void 0===d?!1:d;if(g.system.keyboard.pressedKeys.Space)T.onmousedown(a,b,c);else if(!d&&g.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,c);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<D.selectedSignals.length;)D.selectedSignals[0].deselect();
h.select(!0);var e=[];for(a=0;a<D.selectedSignals.length;a++)e.push({name:parseInt(D.selectedSignals[a].name),block:D.selectedSignals[a],starting:D.signalRegistry.getSignal(parseInt(D.selectedSignals[a].name))});var f=U(I(A(c)));g.system.mouse.mouseInteractionHandler(function(a){a=U(I(A(a))).position-f.position;for(var b=0;b<e.length;b++){D.signalRegistry.update(e[b].name,{length:e[b].starting.length+a});var c=D.signalRegistry.getSignal(e[b].name);e[b].block.position(c.position);e[b].block.length(c.length)}})}};
h.rightHandle.onmousemove=function(a,b,c){a=g.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.rightHandle.onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};return{id:a,signalBlock:h}}function da(){var a=d.builder("group","playhead");N.append(a);a.main=d.builder("rectangle","main",{x:-J.width/2,width:J.width,height:E.totalSize.height,style:{fill:K}});a.append(a.main);a.invisibleHandle=d.builder("rectangle","invisibleHandle",{x:-J.width*
J.invisibleHandleMux/2+J.width/2,width:J.width*J.invisibleHandleMux,height:E.totalSize.height,style:{fill:"rgba(255,0,0,0)"}});a.append(a.invisibleHandle);a.invisibleHandle.onmousedown=function(){J.held=!0;g.system.mouse.mouseInteractionHandler(function(a){H.playheadPosition(U(I(A(a))).position)},function(){J.held=!1})};a.invisibleHandle.onmouseenter=function(a,b,c){g.core.viewport.cursor("col-resize")};a.invisibleHandle.onmousemove=function(a,b,c){g.core.viewport.cursor("col-resize")};a.invisibleHandle.onmouseleave=
function(a,b,c){g.core.viewport.cursor("default")};J.present=!0;return a}f=void 0===f?"sequencer":f;c=void 0===c?300:c;b=void 0===b?100:b;h=void 0===h?0:h;k=void 0===k?64:k;l=void 0===l?16:l;m=void 0===m?1:m;t=void 0===t?1:t;n=void 0===n?"rgba(20,20,20,1)":n;u=void 0===u?"rgba(209, 189, 222, 0.5)":u;q=void 0===q?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.95)",lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.95)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",stroke:"rgba(129,209,173,0.95)",
lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.95)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.95)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.95)",lineWidth:.5}]:q;p=void 0===p?[{fill:"rgba(138,138,138,0.8)",stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},{fill:"rgba(234,238,110,0.8)",
stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:p;w=void 0===w?"rgba(200,0,0,0)":w;x=void 0===x?3:x;r=void 0===r?[0,1]:r;z=void 0===z?{fill:"rgba(120,120,120,0.8)",stroke:"rgba(120,120,120,1)",lineWidth:.5}:z;y=void 0===y?[{fill:"rgba(120,120,120,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5},{fill:"rgba(100,100,100,  0)",stroke:"rgba(120,120,120,1)",lineWidth:.5}]:
y;v=void 0===v?[0]:v;C=void 0===C?{fill:"rgba(229, 221, 112,0.25)",stroke:"rgba(252,244,128,0.5)",lineWidth:.5}:C;B=void 0===B?[{fill:"rgba(30,30,30,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5}]:B;K=void 0===K?"rgb(240, 240, 240)":K;F=void 0===F?function(a){}:F;G=void 0===G?function(a){}:G;M=void 0===M?function(a){}:M;var ea=this,E={totalSize:{width:c/m,height:b/t},viewposition:{x:0,y:0},viewArea:{topLeft:{x:0,y:0},bottomRight:{x:m,y:t}}},D={step:1,snapping:!0,defaultStrength:.5,selectedSignals:[],
activeSignals:[],signalRegistry:new g.library.structure.signalRegistry(k,l)},W=!1,S={start:0,end:k},J={present:!1,width:.75,invisibleHandleMux:4,position:-1,held:!1,automoveViewposition:!1},H=d.builder("group",f,{x:e,y:a,angle:h}),ca=d.builder("rectangle","backing",{width:c,height:b,style:{fill:n}});H.append(ca);f=d.builder("rectangle","stencil",{width:c,height:b});H.stencil(f);H.clip(!0);var N=d.builder("group","workarea");H.append(N);f=d.builder("group","backgroundDrawArea");N.append(f);var P=d.builder("group",
"backgroundDrawArea_horizontal");f.append(P);var Q=d.builder("group","backgroundDrawArea_vertical");f.append(Q);var T=d.builder("rectangle","interactionPlane_back",{width:E.totalSize.width,height:E.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});N.append(T);T.onwheel=function(a,b,c){};var R=d.builder("group","signalPane");N.append(R);var V=d.builder("rectangle","interactionPlane_front",{width:E.totalSize.width,height:E.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});N.append(V);V.onwheel=function(a,
b,c){};H.__calculationAngle=h;H.viewposition=O;H.viewarea=function(a,b){b=void 0===b?!0:b;if(void 0==a||void 0==a.topLeft&&void 0==a.bottomRight)return E.viewArea;void 0==a.topLeft?a.topLeft={x:E.viewArea.topLeft.x,y:E.viewArea.topLeft.y}:(void 0==a.topLeft.x&&(a.topLeft.x=E.viewArea.topLeft.x),void 0==a.topLeft.y&&(a.topLeft.y=E.viewArea.topLeft.y));void 0==a.bottomRight?a.bottomRight={x:E.bottomRight.topLeft.x,y:E.bottomRight.topLeft.ys}:(void 0==a.bottomRight.x&&(a.bottomRight.x=E.viewArea.bottomRight.x),
void 0==a.bottomRight.y&&(a.bottomRight.y=E.viewArea.bottomRight.y));var c=E.viewArea.bottomRight.x-E.viewArea.topLeft.x!=a.bottomRight.x-a.topLeft.x,d=a.bottomRight.y-a.topLeft.y!=E.viewArea.bottomRight.y-E.viewArea.topLeft.y;c&&d?aa(a.bottomRight.x-a.topLeft.x,a.bottomRight.y-a.topLeft.y):c?aa(a.bottomRight.x-a.topLeft.x,void 0):d&&aa(void 0,a.bottomRight.y-a.topLeft.y);d=c=0;0!=1-(a.bottomRight.x-a.topLeft.x)&&(c=a.topLeft.x+(a.bottomRight.x-a.topLeft.x)/(1-(a.bottomRight.x-a.topLeft.x))*a.topLeft.x);
0!=1-(a.bottomRight.y-a.topLeft.y)&&(d=a.topLeft.y+(a.bottomRight.y-a.topLeft.y)/(1-(a.bottomRight.y-a.topLeft.y))*a.topLeft.y);O(c,d,b);E.viewArea=Object.assign(a,{})};H.step=function(a){if(void 0==a)return D.step;D.step=a};H.glowHorizontal=function(a,b,c){for(void 0==c&&(c=b+1);b<=c;b++){var d=a?z:y[r[b%r.length]];P.children[b].style.fill=d.fill;P.children[b].style.stroke=d.stroke;P.children[b].style.lineWidth=d.lineWidth}};H.glowVertical=function(a,b,c){for(void 0==c&&(c=b+1);b<c;b++){var d=a?
C:B[v[b%v.length]];Q.children[b].style.fill=d.fill;Q.children[b].style.stroke=d.stroke;Q.children[b].style.lineWidth=d.lineWidth}};H.loopActive=function(a){if(void 0==a)return W;W=a;H.glowVertical(!1,0,k);W&&H.glowVertical(!0,0>S.start?0:S.start,S.end>k?k:S.end)};H.loopPeriod=function(a,b){if(void 0==a||void 0==b)return S;a>b||0>a||0>b||(S={start:a,end:b},W&&(H.glowVertical(!1,0,k),H.glowVertical(!0,0>a?0:a,b>k?k:b)))};H.export=function(){return D.signalRegistry.export()};H.import=function(a){D.signalRegistry.import(a)};
H.getAllSignals=function(){return D.signalRegistry.getAllSignals()};H.addSignal=function(a,b,c,d){ba(a,b,c,void 0===d?1:d)};H.addSignals=function(a){for(var b=0;b<a.length;b++)void 0!=a[b]&&null!=a[b]&&this.addSignal(a[b].line,a[b].position,a[b].length,a[b].strength)};H.eventsBetween=function(a,b){return D.signalRegistry.eventsBetween(a,b)};H.automove=function(a){if(void 0==a)return J.automoveViewposition;J.automoveViewposition=a};H.playheadPosition=function(a,b){if(void 0==a)return J.position;J.position=
a;if(void 0===b||b){a=[];for(b=0;b<D.activeSignals.length;b++){var c=D.signalRegistry.getSignal(D.activeSignals[b]);null!=c&&a.unshift({signalID:D.activeSignals[b],line:c.line,position:S.start,strength:0})}D.activeSignals=[];H.event&&0<a.length&&H.event(a)}a=N.getElementsWithName("playhead")[0];0>J.position||J.position>k?void 0!=a&&a.parent.remove(a):(void 0==a&&(a=da()),a.parameter.x(E.totalSize.width/k*J.position),J.automoveViewposition&&(a=k-k*m,(J.position<Math.floor(E.viewposition.x*a)||J.position>
Math.floor(E.viewposition.x*a)+k*m)&&H.viewposition((J.position>a?a:J.position)/a)))};H.progress=function(){if(!J.held){var a=H.eventsBetween(J.position,J.position+D.step);if(W&&J.position==S.start){for(var b=0;b<D.activeSignals.length;b++){var c=D.signalRegistry.getSignal(D.activeSignals[b]);null!=c&&a.unshift({signalID:D.activeSignals[b],line:c.line,position:S.start,strength:0})}D.activeSignals=[]}for(b=0;b<a.length;b++)c=D.activeSignals.indexOf(a[b].signalID),-1!=c&&0==a[b].strength?D.activeSignals.splice(c):
0<a[b].strength&&D.activeSignals.push(a[b].signalID);J.position=W&&J.position+D.step==S.end?S.start:J.position+D.step;H.playheadPosition(J.position,!1);H.event&&0<a.length&&H.event(a)}};T.onmousedown=function(a,e,f){a=g.system.keyboard.pressedKeys;if(!a.alt||!a.Space)if(a.shift){var h=A(f),n=A(f),p=d.builder("rectangle","selectionArea",{x:h.x*c,y:h.y*b,width:0,height:0,style:{fill:u}});H.append(p);g.system.mouse.mouseInteractionHandler(function(a){n=A(a);n.x=0>n.x?0:n.x;n.y=0>n.y?0:n.y;n.x=1<n.x?
1:n.x;n.y=1<n.y?1:n.y;a=n.x-h.x;var d=n.y-h.y,e=h.x,f=h.y,g=1,k=1;0>a&&(g=-1,e+=a);0>d&&(k=-1,f+=d);p.parameter.x(e*c);p.parameter.y(f*b);p.parameter.width(g*a*c);p.parameter.height(k*d*b)},function(a){p.parent.remove(p);var b=X(h),c=X(n);b.x*=E.totalSize.width;c.y*=E.totalSize.height;c.x*=E.totalSize.width;b.y*=E.totalSize.height;a={topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};b.x<c.x?(a.topLeft.x=b.x,a.bottomRight.x=c.x):(a.topLeft.x=c.x,a.bottomRight.x=b.x);b.y<c.y?(a.topLeft.y=b.y,a.bottomRight.y=
c.y):(a.topLeft.y=c.y,a.bottomRight.y=b.y);for(;0<D.selectedSignals.length;)D.selectedSignals[0].deselect();for(b=0;b<R.children.length;b++)c=D.signalRegistry.getSignal(parseInt(R.children[b].name)),g.library.math.detectOverlap.boundingBoxes({topLeft:{x:E.totalSize.width/k*c.position,y:E.totalSize.height/l*c.line},bottomRight:{x:E.totalSize.width/k*(c.position+c.length),y:E.totalSize.height/l*(c.line+1)}},a)&&R.children[b].select(!0)})}else if(a.alt){for(;0<D.selectedSignals.length;)D.selectedSignals[0].deselect();
a=U(I(A(f)));a=ba(a.line,a.position,0);a.signalBlock.select();a.signalBlock.rightHandle.onmousedown(void 0,void 0,f,!0)}else if(a.Space){g.core.viewport.cursor("grabbing");var q=A(f),w=E.viewposition.x,x=E.viewposition.y;g.system.mouse.mouseInteractionHandler(function(a){a=A(a);O(w-(q.x-a.x)*m/(m-1),x-(q.y-a.y)*t/(t-1))},function(a){g.library.math.detectOverlap.pointWithinBoundingBox(I(A(a)),E.viewArea)&&g.system.keyboard.pressedKeys.Space?g.core.viewport.cursor("grab"):g.core.viewport.cursor("default")})}else for(;0<
D.selectedSignals.length;)D.selectedSignals[0].deselect()};T.onmousemove=function(a,b,c){a=g.system.keyboard.pressedKeys;a.alt?g.core.viewport.cursor("crosshair"):a.Space?g.core.viewport.cursor("grab"):g.core.viewport.cursor("default")};V.onkeydown=function(a,b,c){c=g.system.keyboard.pressedKeys;if(c.Backspace||c.Delete)for(;0<D.selectedSignals.length;)D.selectedSignals[0].delete();c.Space&&g.core.viewport.cursor("grab");c.alt&&(void 0!=R.getElementUnderPoint(a,b)?g.core.viewport.cursor("copy"):g.core.viewport.cursor("crosshair"))};
V.onkeyup=function(a,b,c){g.core.viewport.cursor("default")};H.onpan=F;H.onchangeviewarea=G;H.event=M;(function(){P.clear();for(var a=0;a<l;a++){var e=y[r[a%r.length]];P.append(d.builder("rectangle","strip_horizontal_"+a,{x:0,y:b/(l*t)*a,width:E.totalSize.width,height:b/(l*t),style:{fill:e.fill,stroke:e.stroke,lineWidth:e.lineWidth}}))}Q.clear();for(a=0;a<k;a++)e=B[v[a%v.length]],Q.append(d.builder("rectangle","strip_vertical_"+a,{x:c/(k*m)*a,y:0,width:c/(k*m),height:E.totalSize.height,style:{fill:e.fill,
stroke:e.stroke,lineWidth:e.lineWidth}}))})();return H};this.sequencer.signalBlock=function(f,e,a,c,b,h,k,l,m,t,n,u){function q(){C.body.parameter.height(a);C.leftHandle.parameter.height(a);C.rightHandle.parameter.height(a)}function p(){C.body.parameter.width(h*e);C.rightHandle.parameter.x(h*e-u/2)}function w(){C.parameter.y(c*a)}function x(a,b){var c=Object.assign({},a[0]);a[0].hasOwnProperty("fill")&&(c.fill=g.library.misc.multiBlendColours(a.map(function(a){return a.fill}),b));a[0].hasOwnProperty("stroke")&&
(c.stroke=g.library.misc.multiBlendColours(a.map(function(a){return a.stroke}),b));return c}k=void 0===k?1:k;l=void 0===l?!1:l;m=void 0===m?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.8)",lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.8)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",stroke:"rgba(129,209,173,0.8)",lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.8)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.8)",
lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.8)",lineWidth:.5}]:m;t=void 0===t?[{fill:"rgba(138,138,138,0.8)",stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},{fill:"rgba(234,238,110,0.8)",stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",
stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:t;n=void 0===n?"rgba(255,0,255,0)":n;u=void 0===u?5:u;var r=!1,z=u/4,y=x(m,k),v=x(t,k),C=d.builder("group",String(f),{x:b*e,y:c*a});C.body=d.builder("rectangle","body",{width:h*e,height:a,style:{fill:y.fill,stroke:y.stroke,lineWidth:y.lineWidth}});C.leftHandle=d.builder("rectangle","leftHandle",{x:-u/2,width:u,height:a,style:{fill:n}});C.rightHandle=d.builder("rectangle","rightHandle",{x:h*e-u/2,width:u,height:a,style:{fill:n}});C.append(C.body);C.append(C.leftHandle);
C.append(C.rightHandle);C.unit=function(c,d){if(void 0==c&&void 0==d)return{x:e,y:a};void 0==c?(a=d,q(),w()):(void 0==d?(e=c,p()):(e=c,a=d,p(),q(),w()),C.parameter.x(b*e))};C.line=function(a){if(void 0==a)return c;c=a;w()};C.position=function(a){if(void 0==a)return b;b=a;C.parameter.x(b*e)};C.length=function(a){if(void 0==a)return h;h=a<z/e?z/e:a;p()};C.strength=function(a){if(void 0==a)return k;a=1<a?1:a;k=0>a?0:a;y=x(m,k);v=x(t,k);C.glow(l)};C.glow=function(a){if(void 0==a)return l;(l=a)?(C.body.style.fill=
v.fill,C.body.style.stroke=v.stroke,C.body.style.lineWidth=v.lineWidth):(C.body.style.fill=y.fill,C.body.style.stroke=y.stroke,C.body.style.lineWidth=y.lineWidth)};C.selected=function(a){if(void 0==a)return r;r=a};return C};this.list=function(f,e,a,c,b,h,g,l,m,t,n,u,q,p,w,x,r,z,y,v,C,B,G,F,O,M,Y,Z,X,U,fa,aa,ba,da,ea,E,D,W,S,J,H,ca,N,P,Q,T,R,V,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,Ma,Oa,Qa,Ra,Na,Pa,Sa){function k(){A=[];La.clear();I=[];for(var a=
K=Ua=0,e=0;e<g.length;e++)if("space"==g[e]){var f=d.builder("rectangle",""+e,{x:0,y:a,width:c,height:b*v,style:{fill:"rgba(255,0,0,0)"}});a+=b*(v+r);La.append(f)}else"break"==g[e]?(f=d.builder("rectangle",""+e,{x:c*(1-y)*.5,y:a,width:c*y,height:b*z,style:{fill:B}}),a+=b*(z+r),La.append(f)):(f=d.builder("button_rect",""+e,{x:c*(1-x)*.5,y:a,width:c*x,height:b*w,text_left:g[e].text_left,text_centre:g[e].text?g[e].text:g[e].text_centre,text_right:g[e].text_right,textVerticalOffset:l,textHorizontalOffsetMux:m,
active:t,hoverable:u,selectable:q,pressable:p,style:{text_font:G,text_textBaseline:F,text_fill:O,text_stroke:M,text_lineWidth:Y,background__off__fill:Z,background__off__stroke:X,background__off__lineWidth:U,background__up__fill:fa,background__up__stroke:aa,background__up__lineWidth:ba,background__press__fill:da,background__press__stroke:ea,background__press__lineWidth:E,background__select__fill:D,background__select__stroke:W,background__select__lineWidth:S,background__select_press__fill:J,background__select_press__stroke:H,
background__select_press__lineWidth:ca,background__glow__fill:N,background__glow__stroke:P,background__glow__lineWidth:Q,background__glow_press__fill:T,background__glow_press__stroke:R,background__glow_press__lineWidth:V,background__glow_select__fill:ha,background__glow_select__stroke:ia,background__glow_select__lineWidth:ja,background__glow_select_press__fill:ka,background__glow_select_press__stroke:la,background__glow_select_press__lineWidth:ma,background__hover__fill:na,background__hover__stroke:oa,
background__hover__lineWidth:pa,background__hover_press__fill:qa,background__hover_press__stroke:ra,background__hover_press__lineWidth:sa,background__hover_select__fill:ta,background__hover_select__stroke:ua,background__hover_select__lineWidth:va,background__hover_select_press__fill:wa,background__hover_select_press__stroke:xa,background__hover_select_press__lineWidth:ya,background__hover_glow__fill:za,background__hover_glow__stroke:Aa,background__hover_glow__lineWidth:Ba,background__hover_glow_press__fill:Ca,
background__hover_glow_press__stroke:Da,background__hover_glow_press__lineWidth:Ea,background__hover_glow_select__fill:Fa,background__hover_glow_select__stroke:Ga,background__hover_glow_select__lineWidth:Ha,background__hover_glow_select_press__fill:Ia,background__hover_glow_select_press__stroke:Ja,background__hover_glow_select_press__lineWidth:Ka}}),f.onenter=function(a){return function(){L.onenter(a)}}(e),f.onleave=function(a){return function(){L.onleave(a)}}(e),f.onpress=function(a){return function(){L.onpress(a)}}(e),
f.ondblpress=function(a){return function(){L.ondblpress(a)}}(e),f.onrelease=function(a){return function(){g[a].function&&g[a].function();L.onrelease(a)}}(e),f.onselect=function(a){return function(b,c){L.select(a,!0,c,!1)}}(e),f.ondeselect=function(a){return function(b,c){L.select(a,!1,c,!1)}}(e),a+=b*(w+r),La.append(f),A.push(f));return a-b*r}c=void 0===c?50:c;b=void 0===b?100:b;g=void 0===g?[]:g;l=void 0===l?.5:l;m=void 0===m?.05:m;t=void 0===t?!0:t;n=void 0===n?!0:n;u=void 0===u?!0:u;q=void 0===
q?!0:q;p=void 0===p?!0:p;w=void 0===w?.1:w;x=void 0===x?.95:x;r=void 0===r?.01:r;z=void 0===z?.0025:z;y=void 0===y?.9:y;v=void 0===v?.005:v;C=void 0===C?"rgba(230,230,230,1)":C;B=void 0===B?"rgba(195,195,195,1)":B;G=void 0===G?"5pt Arial":G;F=void 0===F?"alphabetic":F;O=void 0===O?"rgba(0,0,0,1)":O;M=void 0===M?"rgba(0,0,0,0)":M;Y=void 0===Y?1:Y;Z=void 0===Z?"rgba(180,180,180,1)":Z;X=void 0===X?"rgba(0,0,0,0)":X;U=void 0===U?0:U;fa=void 0===fa?"rgba(200,200,200,1)":fa;aa=void 0===aa?"rgba(0,0,0,0)":
aa;ba=void 0===ba?0:ba;da=void 0===da?"rgba(230,230,230,1)":da;ea=void 0===ea?"rgba(0,0,0,0)":ea;E=void 0===E?0:E;D=void 0===D?"rgba(200,200,200,1)":D;W=void 0===W?"rgba(120,120,120,1)":W;S=void 0===S?2:S;J=void 0===J?"rgba(230,230,230,1)":J;H=void 0===H?"rgba(120,120,120,1)":H;ca=void 0===ca?2:ca;N=void 0===N?"rgba(220,220,220,1)":N;P=void 0===P?"rgba(0,0,0,0)":P;Q=void 0===Q?0:Q;T=void 0===T?"rgba(250,250,250,1)":T;R=void 0===R?"rgba(0,0,0,0)":R;V=void 0===V?0:V;ha=void 0===ha?"rgba(220,220,220,1)":
ha;ia=void 0===ia?"rgba(120,120,120,1)":ia;ja=void 0===ja?2:ja;ka=void 0===ka?"rgba(250,250,250,1)":ka;la=void 0===la?"rgba(120,120,120,1)":la;ma=void 0===ma?2:ma;na=void 0===na?"rgba(220,220,220,1)":na;oa=void 0===oa?"rgba(0,0,0,0)":oa;pa=void 0===pa?0:pa;qa=void 0===qa?"rgba(240,240,240,1)":qa;ra=void 0===ra?"rgba(0,0,0,0)":ra;sa=void 0===sa?0:sa;ta=void 0===ta?"rgba(220,220,220,1)":ta;ua=void 0===ua?"rgba(120,120,120,1)":ua;va=void 0===va?2:va;wa=void 0===wa?"rgba(240,240,240,1)":wa;xa=void 0===
xa?"rgba(120,120,120,1)":xa;ya=void 0===ya?2:ya;za=void 0===za?"rgba(240,240,240,1)":za;Aa=void 0===Aa?"rgba(0,0,0,0)":Aa;Ba=void 0===Ba?0:Ba;Ca=void 0===Ca?"rgba(250,250,250,1)":Ca;Da=void 0===Da?"rgba(0,0,0,0)":Da;Ea=void 0===Ea?0:Ea;Fa=void 0===Fa?"rgba(240,240,240,1)":Fa;Ga=void 0===Ga?"rgba(120,120,120,1)":Ga;Ha=void 0===Ha?2:Ha;Ia=void 0===Ia?"rgba(250,250,250,1)":Ia;Ja=void 0===Ja?"rgba(120,120,120,1)":Ja;Ka=void 0===Ka?2:Ka;Ma=void 0===Ma?function(){}:Ma;Oa=void 0===Oa?function(){}:Oa;Qa=
void 0===Qa?function(){}:Qa;Ra=void 0===Ra?function(){}:Ra;Na=void 0===Na?function(){}:Na;Pa=void 0===Pa?function(){}:Pa;Sa=void 0===Sa?function(){}:Sa;var A=[],I=[],K=0,Ua=0,L=d.builder("group",void 0===f?"list":f,{x:e,y:a,angle:void 0===h?0:h});f=d.builder("rectangle","backing",{width:c,height:b,style:{fill:C}});L.append(f);var La=d.builder("group","itemCollection");L.append(La);var Ta=k();f=d.builder("rectangle","cover",{width:c,height:b,style:{fill:"rgba(0,0,0,0)"}});L.append(f);e=d.builder("rectangle",
"stencil",{width:c,height:b,style:{fill:"rgba(0,0,0,0)"}});L.stencil(e);L.clip(!0);f.onwheel=function(a,b,c){a=c.deltaY/100;L.position(L.position()+a/10);for(a=0;a<A.length;a++)A[a].forceMouseLeave()};L.position=function(a,c){c=void 0===c?!0:c;if(void 0==a)return Ua;a=0>a?0:a;Ua=a=1<a?1:a;if(!(Ta<b)&&(La.parameter.y(-a*(Ta-b)),c&&this.onpositionchange))this.onpositionchange(a)};L.select=function(a,b,c,d){d=void 0===d?!0:d;if(q){if(n)if(void 0!=c&&c.shiftKey){b=Math.min(K,a);a=Math.max(K,a);for(c=
0;c<A.length;c++)A[c].name==""+b&&(b=c),A[c].name==""+a&&(a=c);I=[];for(c=0;c<A.length;c++)(c>a||c<b)&&A[c].select()&&A[c].select(!1,void 0,!1);for(c=b;c<=a;c++)A[c].select()||(A[c].select(!0,void 0,!1),I.push(c))}else d&&A[a].select(b),b&&!I.includes(a)?I.push(a):!b&&I.includes(a)&&I.splice(I.indexOf(a),1),K=a;else{if(b&&!I.includes(a)){for(;0<I.length;)La.children[I[0]].select(!1,void 0,!1),I.shift();I.push(a)}else!b&&I.includes(a)&&(I=[]);d&&La.children[a].select(!0,void 0,!1)}L.onselection(I)}};
L.add=function(a){g.push(a);Ta=k()};L.remove=function(a){g.splice(a,1);Ta=k()};L.onenter=Ma;L.onleave=Oa;L.onpress=Qa;L.ondblpress=Ra;L.onrelease=Na;L.onselection=Pa;L.onpositionchange=Sa;return L};this.grapher_waveWorkspace=function(f,e,a,c,b,h,g,l,m,t,n,r,q,p,w,x,v,z){c=void 0===c?120:c;b=void 0===b?60:b;g=void 0===g?!0:g;l=void 0===l?!0:l;m=void 0===m?[{stroke:"rgba(0,255,0,1)",lineWidth:.25,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.25,lineJoin:"round"}]:m;t=void 0===t?[{fill:"rgba(100,255,100,1)",
size:.75,font:"Helvetica"},{fill:"rgba(255,255,100,1)",size:.75,font:"Helvetica"}]:t;n=void 0===n?"rgba(0,100,0,1)":n;r=void 0===r?.25:r;q=void 0===q?"rgba(0,150,0,1)":q;p=void 0===p?"10pt Helvetica":p;w=void 0===w?"rgba(50,50,50,1)":w;x=void 0===x?function(a,b){}:x;v=void 0===v?function(a,b){}:v;z=void 0===z?function(a){}:z;var k=d.builder("group",void 0===f?"grapher_waveWorkspace":f,{x:e,y:a,angle:void 0===h?0:h});f=d.builder("grapher__static","graph",{width:c,height:b,style:{foregrounds:m,foregroundText:t,
background_stroke:n,background_lineWidth:r,backgroundText_fill:q,backgroundText_font:p,backing:w}});f.resolution(10);k.append(f);c=d.builder("needleOverlay","overlay",{width:c,height:b,selectNeedle:g,selectionArea:l,needleStyles:m.map(function(a){return a.stroke})});k.append(c);k.horizontalMarkings=f.horizontalMarkings;k.verticalMarkings=f.verticalMarkings;k.drawBackground=f.drawBackground;k.drawForeground=f.drawForeground;k.draw=f.draw;k.mark=c.mark;k.removeAllMarks=c.removeAllMarks;k.select=c.select;
k.area=c.area;k.onchange=x;k.onrelease=v;k.selectionAreaToggle=z;c.onchange=function(a,b){if(k.onchange)k.onchange(a,b)};c.onrelease=function(a,b){if(k.onrelease)k.onrelease(a,b)};c.selectionAreaToggle=function(a){k.selectionAreaToggle&&k.selectionAreaToggle(a)};f.viewbox({left:0});f.drawBackground();c.select(0);return k};this.dial_discrete=function(f,e,a,c,b,h,k,l,m,t,n,r,q,p,w){function x(a,b){a=a>l-1?l-1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=u.onchange)u.onchange(a);h=a=Math.round(a);z.set(h/
(l-1))}f=void 0===f?"dial_discrete":f;c=void 0===c?15:c;h=void 0===h?0:h;k=void 0===k?0:k;l=void 0===l?5:l;m=void 0===m?3*Math.PI/4:m;t=void 0===t?1.5*Math.PI:t;n=void 0===n?"rgba(200,200,200,1)":n;r=void 0===r?"rgba(50,50,50,1)":r;q=void 0===q?"rgba(250,100,100,1)":q;p=void 0===p?function(){}:p;w=void 0===w?function(){}:w;var u=d.builder("group",f,{x:e,y:a,angle:void 0===b?0:b}),z=d.builder("dial_continuous",f,{x:0,y:0,r:c,angle:0,startAngle:m,maxAngle:t,style:{handle:n,slot:r,needle:q}});z.getChildByName("handle").ondblclick=
void 0;z.getChildByName("handle").onwheel=void 0;z.getChildByName("handle").onmousedown=void 0;u.append(z);var y=!1;u.set=function(a,b){y||x(a,b)};u.get=function(){return h};var v=0;z.getChildByName("handle").ondblclick=function(){if(!(0>k||y)&&(x(k),void 0!=u.onrelease))u.onrelease(h)};z.getChildByName("handle").onwheel=function(a,b,c){if(!y&&(v+=c.deltaY/100,1<=Math.abs(v)&&(x(h-1*Math.sign(v)),v=0,void 0!=u.onrelease)))u.onrelease(h)};z.getChildByName("handle").onmousedown=function(a,b,c){var d=
h,e=c.y;y=!0;g.system.mouse.mouseInteractionHandler(function(a){x(d-Math.round((a.y-e)/25));if(void 0!=u.onchange)u.onchange(h)},function(a){y=!1;if(void 0!=u.onrelease)u.onrelease(h)})};u.onchange=p;u.onrelease=w;x(h);return u};this.rangeslide=function(f,e,a,c,b,h,k,l,m,t,n,r,q,p,w,x,v){function u(a,c,d){d=void 0===d?!0:d;a=1<a?1:a;a=0>a?0:a;switch(c){default:console.error("unknown handle to adjust");break;case "start":1<=a/(1-k/(1-k))&&(a=1-k/(1-k));var e=a+(1-a)*k,f=m.end-m.end*k;e>=f&&(m.end=
e/(1-k));break;case "end":1>=a/(k/(1-k))&&(a=k/(1-k)),e=m.start+(1-m.start)*k,f=a-a*k,e>=f&&(m.start=(f-k)/(1-k))}m[c]=a;M.start.parameter.y(m.start*b*(1-k));M.end.parameter.y(m.end*b*(1-k));O.parameter.y(b*(k+m.start-k*(m.start+.1)));O.parameter.height(b*(m.end-m.start+k*(m.start-m.end-1+.2)));if(d&&B.onchange)B.onchange(m)}function y(a,b){var c=G.getOffset();return g.library.math.cartesianAngleAdjust(a-(G.x+c.x),b-(G.y+c.y),0-(G.angle+c.a)).y/F.height}c=void 0===c?10:c;b=void 0===b?95:b;k=void 0===
k?.1:k;l=void 0===l?.75:l;m=void 0===m?{start:0,end:1}:m;t=void 0===t?{start:-1,end:-1}:t;n=void 0===n?"rgba(200,200,200,1)":n;r=void 0===r?"rgba(150,150,150,1)":r;q=void 0===q?"rgba(50,50,50,1)":q;p=void 0===p?"rgba(255,0,0,0)":p;w=void 0===w?"rgba(200,0,200,0.5)":w;x=void 0===x?function(){}:x;v=void 0===v?function(){}:v;var A=!1,C=["start","end"],B=d.builder("group",void 0===f?"rangeslide":f,{x:e,y:a,angle:void 0===h?0:h}),G=d.builder("group","backingAndSlotGroup");B.append(G);f=d.builder("rectangle",
"backing",{width:c,height:b,style:{fill:r}});G.append(f);q=d.builder("rectangle","slot",{x:.45*c,y:k/2*b,width:.1*c,height:b*(1-k),style:{fill:q}});G.append(q);var F=d.builder("rectangle","backingAndSlotCover",{width:c,height:b,style:{fill:"rgba(0,0,0,0)"}});G.append(F);var O=d.builder("rectangle","span",{x:(1-l)/2*c,y:b*k,width:c*l,height:b-2*b*k,style:{fill:w}});B.append(O);var M={};for(l=0;l<C.length;l++)M[C[l]]=d.builder("group","handle_"+l,{}),B.append(M[C[l]]),w=d.builder("rectangle","handle",
{width:c,height:b*k,style:{fill:n}}),M[C[l]].append(w),w=b*k+.01*b,w=d.builder("rectangle","invisibleHandle",{y:(b*k-w)/2,width:c,height:w+k,style:{fill:p}}),M[C[l]].append(w);B.get=function(){return m};B.set=function(a,b){A||(void 0!=a.start&&u(a.start,"start",b),void 0!=a.end&&u(a.end,"end",b))};G.onmousedown=function(a,b,c){};G.onclick=function(a,b,c){A||(a=y(a,b),a+=.5*k*(2*a-1),Math.abs(m.start-a)<Math.abs(m.end-a)?u(a,"start"):u(a,"end"))};B.ondblclick=function(){0>t.start||0>t.end||A||(u(t.start,
"start"),u(t.end,"end"),B.onrelease(m))};B.onwheel=function(){if(!A){var a=event.deltaY/100,b=g.core.viewport.scale();a/=10*b;u(m.start-a,"start");u(m.end+a,"end")}};O.onmousedown=function(a,b,c){A=!0;var d=m.start,e=y(a,b);g.system.mouse.mouseInteractionHandler(function(a){a=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=y(a.x,a.y);a=d+(a-e);a=[a,a+(m.end-m.start)];0>=a[0]?(a[1]-=a[0],a[0]=0):1<=a[1]&&(a[0]-=a[1]-1,a[1]=1);u(a[0],"start");u(a[1],"end");B.onchange(m)},function(a){B.onrelease(m);
A=!1})};for(l=0;l<C.length;l++)M[C[l]].children[1].onmousedown=function(a){return function(b,c,d){A=!0;var e=m[C[a]],f=y(b,c);g.system.mouse.mouseInteractionHandler(function(b){b=g.core.viewport.windowPoint2workspacePoint(b.x,b.y);b=y(b.x,b.y);u(e+(b-f)/(1-k),C[a]);B.onchange(m)},function(a){B.onrelease(m);A=!1})}}(l);B.onchange=x;B.onrelease=v;u(0,"start");u(1,"end");return B}};this.dynamic=new function(){this.connectionNode_voltage=function(f,e,a,c,b,h,g,l,m,t,n,r,q){n=void 0===n?function(a){}:
n;r=void 0===r?function(a){}:r;q=void 0===q?function(a){}:q;var k=d.builder("connectionNode",void 0===f?"connectionNode_voltage":f,{x:e,y:a,angle:void 0===c?0:c,width:void 0===b?20:b,height:void 0===h?20:h,type:"voltage",style:{dim:void 0===g?"rgb(222, 255, 220)":g,glow:void 0===l?"rgb(240, 252, 239)":l,cable_dim:void 0===m?"rgb(84, 247, 111)":m,cable_glow:void 0===t?"rgb(159, 252, 174)":t}}),u=0;k._getLocalValue=function(){return u};k._update=function(a){0<a?k.activate():k.deactivate();n(a)};k.set=
function(a){u=a;a=k.read();k._update(a);void 0!=k.getForeignNode()&&k.getForeignNode()._update(a)};k.read=function(){return u+(void 0!=k.getForeignNode()?k.getForeignNode()._getLocalValue():!1)};k.onconnect=function(a){r&&r(a);k._update(k.read())};k.ondisconnect=function(a){q&&q(a);k._update(u)};return k};this.cable=function(f,e,a,c,b,h,g){e=void 0===e?0:e;a=void 0===a?0:a;c=void 0===c?0:c;b=void 0===b?0:b;h=void 0===h?"rgb(255,0,0)":h;g=void 0===g?"rgb(255,100,100)":g;f=d.builder("group",void 0===
f?"path":f);var k=d.builder("path","cable",{points:[{x:e,y:a},{x:c,y:b}],style:{stroke:h,lineWidth:5}});f.append(k);f.activate=function(){k.style.stroke=g};f.deactivate=function(){k.style.stroke=h};f.draw=function(d,f,h,g){e=void 0!=d?d:e;a=void 0!=f?f:a;c=void 0!=h?h:c;b=void 0!=g?g:b;k.parameter.points([{x:e,y:a},{x:c,y:b}])};f._isCable=!0;return f};this.connectionNode_audio=function(f,e,a,c,b,h,g,l,m,t,n,r,q,p){g=void 0===g?!1:g;q=void 0===q?function(){}:q;p=void 0===p?function(){}:p;var k=d.builder("connectionNode",
void 0===f?"connectionNode_audio":f,{x:e,y:a,angle:void 0===c?0:c,width:void 0===b?20:b,height:void 0===h?20:h,type:"audio",direction:g?"out":"in",style:{dim:void 0===m?"rgba(255, 244, 220, 1)":m,glow:void 0===t?"rgba(255, 244, 244, 1)":t,cable_dim:void 0===n?"rgb(247, 146, 84)":n,cable_glow:void 0===r?"rgb(242, 168, 123)":r}});k._direction=g?"out":"in";k.audioNode=l.createAnalyser();k.out=function(){return k.audioNode};k.in=function(){return k.audioNode};k.onconnect=function(a){"out"==k._direction&&
k.audioNode.connect(k.getForeignNode().audioNode);q&&q(a)};k.ondisconnect=function(a){"out"==k._direction&&k.audioNode.disconnect(k.getForeignNode().audioNode);p&&p(a)};return k};this.connectionNode_data=function(f,e,a,c,b,h,g,l,m,t,n,r,q,p){function k(a){a.activate();setTimeout(function(){void 0!=a&&a.deactivate()},100);void 0!=a.getForeignNode()&&(a.getForeignNode().activate(),setTimeout(function(){void 0!=a&&void 0!=a.getForeignNode()&&a.getForeignNode().deactivate()},100))}n=void 0===n?function(a,
b){}:n;r=void 0===r?function(a){}:r;var u=d.builder("connectionNode",void 0===f?"connectionNode_data":f,{x:e,y:a,angle:void 0===c?0:c,width:void 0===b?20:b,height:void 0===h?20:h,type:"data",style:{dim:void 0===g?"rgba(220, 244, 255,1)":g,glow:void 0===l?"rgba(244, 244, 255, 1)":l,cable_dim:void 0===m?"rgb(84, 146, 247)":m,cable_glow:void 0===t?"rgb(123, 168, 242)":t},onconnect:void 0===q?function(){}:q,ondisconnect:void 0===p?function(){}:p});u.send=function(a,b){k(u);if(void 0!=u.getForeignNode())u.getForeignNode().onreceivedata(a,
b)};u.request=function(a){k(u);if(void 0!=u.getForeignNode())u.getForeignNode().ongivedata(a)};u.onreceivedata=n;u.ongivedata=r;return u};this.connectionNode=function(f,e,a,c,b,h,k,l,m,t,n,r,q,p){b=void 0===b?20:b;h=void 0===h?20:h;k=void 0===k?"none":k;l=void 0===l?"":l;m=void 0===m?"rgb(220, 220, 220)":m;t=void 0===t?"rgb(244, 244, 244)":t;n=void 0===n?"rgb(146, 146, 146)":n;r=void 0===r?"rgb(215, 215, 215)":r;q=void 0===q?function(a){}:q;p=void 0===p?function(a){}:p;var u=d.builder("group",void 0===
f?"connectionNode":f,{x:e,y:a,angle:void 0===c?0:c});u._connectionNode=!0;u._type=k;u._direction=l;var x=d.builder("rectangle","node",{width:b,height:h,style:{fill:m}});u.append(x);var v=void 0;u.connectTo=function(a){if(void 0!=a&&a!=this&&a._type==this._type&&(""!=this._direction&&""!=a._direction||this._direction==a._direction)&&(""==this._direction||a._direction!=this._direction)&&a!=v){this.disconnect();v=a;if(void 0!=q)this.onconnect(!0);v._receiveConnection(this);this._addCable(this)}};u._receiveConnection=
function(a){this.disconnect();v=a;if(void 0!=q)this.onconnect(!1)};u.disconnect=function(){if(void 0!=v){this._removeCable();if(void 0!=p)this.ondisconnect(!0);v._receiveDisconnection();v=null}};u._receiveDisconnection=function(){if(void 0!=p)this.ondisconnect(!1);v=null};u.getForeignNode=function(){return v};x.onmousedown=function(a,b,c){g.system.mouse.mouseInteractionHandler(void 0,function(a){a=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=g.core.arrangement.getElementUnderPoint(a.x,a.y);
void 0!=a&&(a=a.parent,a._connectionNode&&u.connectTo(a))})};x.ondblclick=function(a,b,c){u.disconnect()};var z;u._addCable=function(){z=d.builder("cable","cable-"+this.getAddress(),{x1:0,y1:0,x2:100,y2:100,style:{dim:n,glow:r}});v._receiveCable(z);g.system.pane.getMiddlegroundPane(this).append(z);this.draw()};u._receiveCable=function(a){z=a};u._removeCable=function(){z.parent.remove(z);z=void 0;v._loseCable()};u._loseCable=function(){z=void 0};u.getCablePoint=function(){var c=this.getOffset(),d=
g.library.math.cartesianAngleAdjust(e+b/2,a+h/2,c.a);d.x+=c.x;d.y+=c.y;return d};u.draw=function(){if(void 0!=z){var a=this.getCablePoint(),b=v.getCablePoint();z.draw(a.x,a.y,b.x,b.y)}};u.activate=function(){x.style.fill=t;void 0!=z&&z.activate()};u.deactivate=function(){x.style.fill=m;void 0!=z&&z.deactivate()};u.onconnect=q;u.ondisconnect=p;return u};this.connectionNode_signal=function(f,e,a,c,b,g,k,l,m,t,n,r,q){n=void 0===n?function(a){}:n;r=void 0===r?function(a){}:r;q=void 0===q?function(a){}:
q;var h=d.builder("connectionNode",void 0===f?"connectionNode_signal":f,{x:e,y:a,angle:void 0===c?0:c,width:void 0===b?20:b,height:void 0===g?20:g,type:"signal",style:{dim:void 0===k?"rgb(255, 220, 244)":k,glow:void 0===l?"rgb(255, 244, 244)":l,cable_dim:void 0===m?"rgb(247, 84, 146)":m,cable_glow:void 0===t?"rgb(247, 195, 215)":t}}),u=!1;h._getLocalValue=function(){return u};h._update=function(){var a=h.read();a?h.activate():h.deactivate();n(a)};h.set=function(a){u=a;h._update();void 0!=h.getForeignNode()&&
h.getForeignNode()._update()};h.read=function(){return u||(void 0!=h.getForeignNode()?h.getForeignNode()._getLocalValue():!1)};h.onconnect=function(a){r&&r(a);h._update()};h.ondisconnect=function(a){q&&q(a);h._update()};return h}};this.builder=function(d,e,a){a||(a={});void 0==a.style&&(a.style={});switch(d){default:return console.warn("Unknown element: "+d),null;case "group":return this.basic.group(e,a.x,a.y,a.angle,a.ignored);case "rectangle":return this.basic.rectangle(e,a.x,a.y,a.width,a.height,
a.angle,a.anchor,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "image":return this.basic.image(e,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.url);case "canvas":return this.basic.canvas(e,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.resolution);case "polygon":return this.basic.polygon(e,a.points,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,
a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "text":return this.basic.text(e,a.x,a.y,a.text,a.angle,a.anchor,a.size,a.ignored,a.style.font,a.style.textAlign,a.style.textBaseline,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "circle":return this.basic.circle(e,a.x,a.y,a.r,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit,
a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "path":return this.basic.path(e,a.points,a.ignored,a.style.stroke,a.style.lineWidth,a.style.lineCap,a.style.lineJoin,a.style.miterLimit,a.style.shadowColour,a.style.shadowBlur,a.style.shadowOffset);case "glowbox_rect":return this.display.glowbox_rect(e,a.x,a.y,a.width,a.height,a.angle,a.style.glow,a.style.dim);case "sevenSegmentDisplay":return this.display.sevenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,
a.style.dim);case "sevenSegmentDisplay__static":return this.display.sevenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "sixteenSegmentDisplay":return this.display.sixteenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,a.style.dim);case "sixteenSegmentDisplay__static":return this.display.sixteenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.background,a.style.glow,
a.style.dim);case "readout_sixteenSegmentDisplay":return this.display.readout_sixteenSegmentDisplay(e,a.x,a.y,a.width,a.height,a.count,a.angle,a.style.background,a.style.glow,a.style.dim);case "readout_sixteenSegmentDisplay__static":return this.display.readout_sixteenSegmentDisplay__static(e,a.x,a.y,a.width,a.height,a.count,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "level":return this.display.level(e,a.x,a.y,a.angle,a.width,a.height,a.style.backing,a.style.levels);case "meter_level":return this.display.meter_level(e,
a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,a.style.markingStyle_font);case "audio_meter_level":return this.display.audio_meter_level(e,a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,a.style.markingStyle_font);case "rastorDisplay":return this.display.rastorDisplay(e,a.x,a.y,a.angle,a.width,a.height,a.xCount,a.yCount,a.xGappage,a.yGappage);case "grapher":return this.display.grapher(e,a.x,
a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher__static":return this.display.grapher__static(e,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave":return this.display.grapher_periodicWave(e,
a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave__static":return this.display.grapher_periodicWave__static(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,
a.style.backgroundText_font,a.style.backing);case "grapher_audioScope":return this.display.grapher_audioScope(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_audioScope__static":return this.display.grapher_audioScope__static(e,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,
a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "slide":return this.control.slide(e,a.x,a.y,a.width,a.height,a.angle,a.handleHeight,a.value,a.resetValue,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "slidePanel":return this.control.slidePanel(e,a.x,a.y,a.width,a.height,a.angle,a.handleHeight,a.count,a.value,a.resetValue,a.style.handle,
a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "rangeslide":return this.control.rangeslide(e,a.x,a.y,a.width,a.height,a.angle,a.handleHeight,a.spanWidth,a.values,a.resetValues,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.style.span,a.onchange,a.onrelease);case "dial_continuous":return this.control.dial_continuous(e,a.x,a.y,a.r,a.angle,a.value,a.resetValue,a.startAngle,a.maxAngle,a.style.handle,a.style.slot,a.style.needle,a.onchange,a.onrelease);
case "dial_discrete":return this.control.dial_discrete(e,a.x,a.y,a.r,a.angle,a.value,a.resetValue,a.optionCount,a.startAngle,a.maxAngle,a.style.handle,a.style.slot,a.style.needle,a.onchange,a.onrelease);case "button_rect":return this.control.button_rect(e,a.x,a.y,a.width,a.height,a.angle,a.text_centre,a.text_left,a.text_right,a.textVerticalOffsetMux,a.textHorizontalOffsetMux,a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,
a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,a.style.background__select__fill,a.style.background__select__stroke,a.style.background__select__strokeWidth,a.style.background__select_press__fill,a.style.background__select_press__stroke,
a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,a.style.background__glow_press__fill,a.style.background__glow_press__stroke,a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,a.style.background__glow_select__strokeWidth,a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,a.style.background__glow_select_press__strokeWidth,
a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,a.style.background__hover_select_press__fill,a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,a.style.background__hover_glow__fill,
a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,a.style.background__hover_glow_select_press__fill,a.style.background__hover_glow_select_press__stroke,a.style.background__hover_glow_select_press__strokeWidth,
a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "list":return this.control.list(e,a.x,a.y,a.width,a.height,a.angle,a.list,a.itemTextVerticalOffsetMux,a.itemTextHorizontalOffsetMux,a.active,a.multiSelect,a.hoverable,a.selectable,a.pressable,a.itemHeightMux,a.itemWidthMux,a.itemSpacingMux,a.breakHeightMux,a.breakWidthMux,a.spacingHeightMux,a.style.backing,a.style.break,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,
a.style.item__off__fill,a.style.item__off__stroke,a.style.item__off__strokeWidth,a.style.item__up__fill,a.style.item__up__stroke,a.style.item__up__strokeWidth,a.style.item__press__fill,a.style.item__press__stroke,a.style.item__press__strokeWidth,a.style.item__select__fill,a.style.item__select__stroke,a.style.item__select__strokeWidth,a.style.item__select_press__fill,a.style.item__select_press__stroke,a.style.item__select_press__strokeWidth,a.style.item__glow__fill,a.style.item__glow__stroke,a.style.item__glow__strokeWidth,
a.style.item__glow_press__fill,a.style.item__glow_press__stroke,a.style.item__glow_press__strokeWidth,a.style.item__glow_select__fill,a.style.item__glow_select__stroke,a.style.item__glow_select__strokeWidth,a.style.item__glow_select_press__fill,a.style.item__glow_select_press__stroke,a.style.item__glow_select_press__strokeWidth,a.style.item__hover__fill,a.style.item__hover__stroke,a.style.item__hover__strokeWidth,a.style.item__hover_press__fill,a.style.item__hover_press__stroke,a.style.item__hover_press__strokeWidth,
a.style.item__hover_select__fill,a.style.item__hover_select__stroke,a.style.item__hover_select__strokeWidth,a.style.item__hover_select_press__fill,a.style.item__hover_select_press__stroke,a.style.item__hover_select_press__strokeWidth,a.style.item__hover_glow__fill,a.style.item__hover_glow__stroke,a.style.item__hover_glow__strokeWidth,a.style.item__hover_glow_press__fill,a.style.item__hover_glow_press__stroke,a.style.item__hover_glow_press__strokeWidth,a.style.item__hover_glow_select__fill,a.style.item__hover_glow_select__stroke,
a.style.item__hover_glow_select__strokeWidth,a.style.item__hover_glow_select_press__fill,a.style.item__hover_glow_select_press__stroke,a.style.item__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselection,a.onpositionchange);case "checkbox_rect":return this.control.checkbox_rect(e,a.x,a.y,a.width,a.height,a.angle,a.style.check,a.style.backing,a.style.checkGlow,a.style.backingGlow,a.onchange);case "rastorgrid":return this.control.rastorgrid(e,a.x,a.y,
a.width,a.height,a.angle,a.xCount,a.yCount,a.style.backing,a.style.check,a.style.backingGlow,a.style.checkGlow,a.onchange);case "needleOverlay":return this.control.needleOverlay(e,a.x,a.y,a.width,a.height,a.angle,a.needleWidth,a.selectNeedle,a.selectionArea,a.style.needles,a.onchange,a.onrelease,a.selectionAreaToggle);case "grapher_waveWorkspace":return this.control.grapher_waveWorkspace(e,a.x,a.y,a.width,a.height,a.angle,a.selectNeedle,a.selectionArea,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,
a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing,a.onchange,a.onrelease,a.selectionAreaToggle);case "sequencer":return this.control.sequencer(e,a.x,a.y,a.width,a.height,a.angle,a.xCount,a.yCount,a.zoomLevel_x,a.zoomLevel_y,a.backingStyle,a.selectionAreaStyle,a.blockStyle_body,a.blockStyle_bodyGlow,a.blockStyle_handle,a.blockStyle_handleWidth,a.horizontalStripStyle_pattern,a.horizontalStripStyle_glow,a.horizontalStripStyle_styles,a.verticalStripStyle_pattern,
a.verticalStripStyle_glow,a.verticalStripStyle_styles,a.playheadStyle,a.onpan,a.onchangeviewarea,a.event);case "cable":return this.dynamic.cable(e,a.x1,a.y1,a.x2,a.y2,a.style.dim,a.style.glow);case "connectionNode":return this.dynamic.connectionNode(e,a.x,a.y,a.angle,a.width,a.height,a.type,a.direction,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect);case "connectionNode_signal":return this.dynamic.connectionNode_signal(e,a.x,a.y,a.angle,a.width,a.height,a.style.dim,
a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,a.ondisconnect);case "connectionNode_voltage":return this.dynamic.connectionNode_voltage(e,a.x,a.y,a.angle,a.width,a.height,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,a.ondisconnect);case "connectionNode_data":return this.dynamic.connectionNode_data(e,a.x,a.y,a.angle,a.width,a.height,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onreceive,a.ongive,a.onconnect,a.ondisconnect);
case "connectionNode_audio":return this.dynamic.connectionNode_audio(e,a.x,a.y,a.angle,a.width,a.height,a.isAudioOutput,g.library.audio.context,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect)}}}};this.unit=new function(){this.test=new function(){var d=this;this.testUnit=function(f,e,a){f=d.builder(this.testUnit,{name:"testUnit",category:"misc",collection:"alpha",x:f,y:e,a:a,space:[{x:-5,y:-5},{x:65,y:-5},{x:65,y:5},{x:290,y:5},{x:290,y:40},{x:615,y:40},{x:615,
y:130},{x:715,y:130},{x:715,y:220},{x:255,y:220},{x:255,y:335},{x:440,y:335},{x:440,y:445},{x:-5,y:455}],elements:[{type:"rectangle",name:"testRectangle",data:{x:5,y:5,width:30,height:30,style:{fill:"rgba(255,0,0,1)"}}},{type:"circle",name:"testCircle",data:{x:20,y:55,r:15}},{type:"image",name:"testImage",data:{x:40,y:40,width:30,height:30,url:"https://t2.genius.com/unsafe/300x300/https%3A%2F%2Fimages.genius.com%2F72ee0b753f056baa410c17a6ad9fea70.588x588x1.jpg"}},{type:"polygon",name:"testPolygon",
data:{points:[{x:55,y:5},{x:70,y:35},{x:40,y:35}],style:{fill:"rgba(0,255,0,1)"}}},{type:"text",name:"testText",data:{x:7.5,y:95,text:"Hello",style:{font:"20pt Arial",fill:"rgba(150,150,255,1)"}}},{type:"path",name:"testPath",data:{points:[{x:0,y:0},{x:0,y:90},{x:2.5,y:90},{x:2.5,y:72.5},{x:75,y:72.5}]}},{type:"glowbox_rect",name:"test_glowbox_rect",data:{x:90,y:0}},{type:"sevenSegmentDisplay",name:"test_sevenSegmentDisplay",data:{x:125,y:0}},{type:"sixteenSegmentDisplay",name:"test_sixteenSegmentDisplay",
data:{x:150,y:0}},{type:"readout_sixteenSegmentDisplay",name:"test_readout_sixteenSegmentDisplay",data:{x:175,y:0}},{type:"level",name:"test_level1",data:{x:90,y:35}},{type:"meter_level",name:"test_meterLevel1",data:{x:115,y:35}},{type:"audio_meter_level",name:"test_audioMeterLevel1",data:{x:140,y:35}},{type:"rastorDisplay",name:"test_rastorDisplay1",data:{x:165,y:35}},{type:"grapher",name:"test_grapher1",data:{x:230,y:35}},{type:"grapher_periodicWave",name:"test_grapher_periodicWave1",data:{x:355,
y:35}},{type:"grapher_audioScope",name:"test_grapher_audioScope1",data:{x:480,y:35}},{type:"slide",name:"test_slide1",data:{x:0,y:110}},{type:"slidePanel",name:"test_slidePanel1",data:{x:15,y:110}},{type:"slide",name:"test_slide2",data:{x:0,y:220,angle:-Math.PI/2}},{type:"slidePanel",name:"test_slidePanel2",data:{x:0,y:305,angle:-Math.PI/2}},{type:"rangeslide",name:"test_rangeslide1",data:{x:100,y:110}},{type:"rangeslide",name:"test_rangeslide2",data:{x:100,y:220,angle:-Math.PI/2}},{type:"dial_continuous",
name:"test_dial_continuous1",data:{x:130,y:125}},{type:"dial_discrete",name:"test_dial_discrete1",data:{x:170,y:125}},{type:"button_rect",name:"test_button_rect1",data:{x:115,y:145}},{type:"list",name:"test_list1",data:{x:185,y:225,list:["space",{text_left:"item1",text_centre:"",text_right:"",function:function(){console.log("item1 function")}},{text_left:"item2",text_centre:"",text_right:"",function:function(){console.log("item2 function")}},{text_left:"item3",text_centre:"",text_right:"",function:function(){console.log("item3 function")}},
{text_left:"item4",text_centre:"",text_right:"",function:function(){console.log("item4 function")}},{text_left:"item5",text_centre:"",text_right:"",function:function(){console.log("item5 function")}},"break",{text_left:"item6",text_centre:"",text_right:"",function:function(){console.log("item6 function")}},{text_left:"item7",text_centre:"",text_right:"",function:function(){console.log("item7 function")}},{text_left:"item8",text_centre:"",text_right:"",function:function(){console.log("item8 function")}},
{text_left:"item9",text_centre:"",text_right:"",function:function(){console.log("item9 function")}},{text_left:"item10",text_centre:"",text_right:"",function:function(){console.log("item10 function")}},"break",{text_left:"item11",text_centre:"",text_right:"",function:function(){console.log("item11 function")}},{text_left:"item12",text_centre:"",text_right:"",function:function(){console.log("item12 function")}},{text_left:"item13",text_centre:"",text_right:"",function:function(){console.log("item13 function")}},
{text_left:"item14",text_centre:"",text_right:"",function:function(){console.log("item14 function")}},{text_left:"item15",text_centre:"",text_right:"",function:function(){console.log("item15 function")}},"space"]}},{type:"checkbox_rect",name:"test_checkbox_rect1",data:{x:150,y:145}},{type:"rastorgrid",name:"test_rastorgrid1",data:{x:100,y:225}},{type:"needleOverlay",name:"test_needleOverlay1",data:{x:0,y:310}},{type:"grapher_waveWorkspace",name:"test_grapher_waveWorkspace1",data:{x:0,y:375}},{type:"sequencer",
name:"test_sequencer1",data:{x:125,y:330}},{type:"connectionNode",name:"test_connectionNode1",data:{x:255,y:135}},{type:"connectionNode",name:"test_connectionNode2",data:{x:230,y:185}},{type:"connectionNode",name:"test_connectionNode3",data:{x:280,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal1",data:{x:355,y:135}},{type:"connectionNode_signal",name:"test_connectionNode_signal2",data:{x:330,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal3",data:{x:380,
y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage1",data:{x:455,y:135}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage2",data:{x:430,y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage3",data:{x:480,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data1",data:{x:555,y:135}},{type:"connectionNode_data",name:"test_connectionNode_data2",data:{x:530,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data3",data:{x:580,
y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio1",data:{x:655,y:135,isAudioOutput:!0}},{type:"connectionNode_audio",name:"test_connectionNode_audio2",data:{x:630,y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio3",data:{x:680,y:185}}]});f.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.text("hello");f.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.print();f.elements.grapher.test_grapher1.draw([0,-2,1,-1,2],
[0,.25,.5,.75,1]);f.elements.grapher.test_grapher1.draw([0,.25,1],void 0,1);f.elements.grapher_periodicWave.test_grapher_periodicWave1.updateBackground();f.elements.grapher_periodicWave.test_grapher_periodicWave1.wave({sin:[0,1,0,1/3,0,.2,0,1/7,0,1/9,0,1/11,0,1/13,0,1/15],cos:[0,0]});f.elements.grapher_periodicWave.test_grapher_periodicWave1.draw();f.elements.needleOverlay.test_needleOverlay1.select(.25);f.elements.needleOverlay.test_needleOverlay1.area(.5,.75);f.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.select(.25);
f.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.area(.5,.75);f.elements.sequencer.test_sequencer1.addSignal(0,0,10,0);f.elements.sequencer.test_sequencer1.addSignal(1,1,10,.1);f.elements.sequencer.test_sequencer1.addSignal(2,2,10,.2);f.elements.sequencer.test_sequencer1.addSignal(3,3,10,.3);f.elements.sequencer.test_sequencer1.addSignal(4,4,10,.4);f.elements.sequencer.test_sequencer1.addSignal(5,5,10,.5);f.elements.sequencer.test_sequencer1.addSignal(6,6,10,.6);f.elements.sequencer.test_sequencer1.addSignal(7,
7,10,.7);f.elements.sequencer.test_sequencer1.addSignal(8,8,10,.8);f.elements.sequencer.test_sequencer1.addSignal(9,9,10,.9);f.elements.sequencer.test_sequencer1.addSignal(10,10,10,1);return f};this.testUnit.devUnit=!0;this.testUnit.metadata={name:"Test Unit",helpURL:"https://curve.metasophiea.com/help/units/test/testUnit/"};this.builder=function(d,e){function a(){c.space={points:Object.assign([],e.space).map(function(a){return{x:e.x+a.x,y:e.y+a.y}})};c.space.box=g.library.math.boundingBoxFromPoints(c.space.points)}
if(d){var c=g._interface.part.alpha.builder("group",e.name,{x:e.x,y:e.y,angle:e.a});c.model=e.name;c.category=e.category;c.collection=e.collection;c.creatorMethod=d;c.elements={};for(d=0;d<e.elements.length;d++)if(void 0!=c.getChildByName(e.elements[d].name))console.warn('error: part with the name "'+e.elements[d].name+'" already exists. Part:',e.elements[d],"will not be added");else{var b=g._interface.part.alpha.builder(e.elements[d].type,e.elements[d].name,e.elements[d].data);c.append(b);void 0==
c.elements[e.elements[d].type]&&(c.elements[e.elements[d].type]={});c.elements[e.elements[d].type][e.elements[d].name]=b}c.io={};[{key:"_",name:"connectionNode"},{key:"signal",name:"connectionNode_signal"},{key:"voltage",name:"connectionNode_voltage"},{key:"data",name:"connectionNode_data"},{key:"audio",name:"connectionNode_audio"}].forEach(function(a){if(c.elements[a.name])for(var b=Object.keys(c.elements[a.name]),d=0;d<b.length;d++){var e=c.elements[a.name][b[d]];void 0==c.io[a.key]&&(c.io[a.key]=
{});c.io[a.key][e.name]=e}});c.disconnectEverything=function(){for(var a=Object.keys(c.io),b=0;b<a.length;b++)for(var d=Object.keys(c.io[a[b]]),e=0;e<d.length;e++)c.io[a[b]][d[e]].disconnect()};a();for(d="spaceShape";void 0!=c.getChildByName(d);)d+=Math.floor(10*Math.random());b=g._interface.part.alpha.builder("polygon",d,{points:e.space,style:{fill:"rgba(0,0,0,0)"}});c.prepend(b);e.spaceOutline&&c.append(g._interface.part.alpha.builder("polygon",d+"Outline",{points:e.space,style:{fill:"rgba(0,0,0,0)",
stroke:"rgba(0,0,0,1)"}}));c._parameter={};c._parameter.x=c.parameter.x;c._parameter.y=c.parameter.y;c._parameter.angle=c.parameter.angle;c.parameter.x=function(b){if(void 0!=c._parameter.x(b))return c.x;e.x=b;a()};c.parameter.y=function(b){if(void 0!=c._parameter.y(b))return c.y;e.y=b;a()};c.parameter.angle=function(b){if(void 0!=c._parameter.angle(b))return c.angle;e.angle=b;a()};return c}console.error("workspace unit\u00a0builder:: creatorMethod missing")}}}};g.system.mouse.functionList.onmousedown.push({requiredKeys:[],
function:function(r){g.control.gui.closeAllDropdowns()}});g.system.mouse.functionList.onmousedown.push({requiredKeys:[["shift"]],function:function(r){if(g.control.switch.mouseGroupSelect)return g.system.mouse.tmp.selectionRectangle=g._interface.part.alpha.builder("rectangle","selectionRectangle",{x:r.x,y:r.y,width:0,height:0,style:{fill:"rgba(224, 184, 252, 0.25)"}}),g.system.pane.mf.append(g.system.mouse.tmp.selectionRectangle),g.system.mouse.tmp.start={x:r.x,y:r.y},g.system.mouse.mouseInteractionHandler(function(d){var f=
g.system.mouse.tmp.start;d=g.core.viewport.windowPoint2workspacePoint(d.x,d.y);g.system.mouse.tmp.selectionRectangle.parameter.width(d.x-f.x);g.system.mouse.tmp.selectionRectangle.parameter.height(d.y-f.y)},function(d){g.system.pane.mf.remove(g.system.mouse.tmp.selectionRectangle);var f=g.system.mouse.tmp.start;d=g.core.viewport.windowPoint2workspacePoint(d.x,d.y);g.control.selection.selectUnits(g.control.scene.getUnitsWithinPoly([{x:f.x,y:f.y},{x:d.x,y:f.y},{x:d.x,y:d.y},{x:f.x,y:d.y}]))}),!0}});
g.system.mouse.functionList.onmousedown.push({requiredKeys:[],function:function(r){if(g.control.switch.mouseGripPanningEnabled)return g.control.selection.deselectEverything(),g.system.mouse.tmp.oldPosition=g.core.viewport.position(),g.system.mouse.tmp.clickPosition={x:r.event.x,y:r.event.y},g.system.mouse.mouseInteractionHandler(function(d){g.core.viewport.position(g.system.mouse.tmp.oldPosition.x-(g.system.mouse.tmp.clickPosition.x-d.x)/g.core.viewport.scale()*window.devicePixelRatio,g.system.mouse.tmp.oldPosition.y-
(g.system.mouse.tmp.clickPosition.y-d.y)/g.core.viewport.scale()*window.devicePixelRatio)},function(d){}),!0}});g.system.mouse.functionList.onwheel.push({requiredKeys:[],function:function(r){if(g.control.switch.mouseWheelZoomEnabled){var d=r.x,f=r.y,e=g.core.viewport.scale();e-=r.event.deltaY/100*e;20<e&&(e=20);.1>e&&(e=.1);g.core.viewport.scale(e);r=g.core.viewport.windowPoint2workspacePoint(r.event.x,r.event.y);d=g.library.math.cartesianAngleAdjust(r.x-d,r.y-f,g.core.viewport.angle());f=g.core.viewport.position();
g.core.viewport.position(f.x+d.x,f.y+d.y);return!0}}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","F2"],["command","F2"]],function:function(r){g.control.scene.load(void 0,void 0,!0);return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","F3"],["command","F3"]],function:function(r){g.control.scene.save();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyX"],["command","KeyX"]],function:function(r){g.control.selection.cut();
return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyC"],["command","KeyC"]],function:function(r){g.system.keyboard.releaseKey("KeyC");g.control.selection.copy();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyV"],["command","KeyV"]],function:function(r){g.system.keyboard.releaseKey("KeyV");g.control.selection.paste();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyB"],["command","KeyB"]],
function:function(r){g.control.selection.duplicate();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["Delete"],["Backspace"]],function:function(r){g.control.selection.delete();return!0}});g.control=new function(){var r=this;this.switch={devMode:null!=(new URL(window.location.href)).searchParams.get("dev"),mouseWheelZoomEnabled:!0,mouseGripPanningEnabled:!0,mouseGroupSelect:!0,enableSceneSave:!0,enableSceneLoad:!0,enableMenubar:!0,enableWindowScrollbarAutomaticRemoval:!0,
enableUnitSelection:!0,enableSceneModification:!0};this.gui=new function(){var d=g.system.pane.f,f=void 0,e=window.devicePixelRatio;this.refresh=function(){void 0!=f&&f.refresh()};this.showMenubar=function(){g.control.switch.enableMenubar?void 0==f&&(f=r.gui.elements.menubar(0,0,e),d.append(f)):this.hideMenubar()};this.hideMenubar=function(){void 0!=f&&(d.remove(f),f=void 0)};this.closeAllDropdowns=function(){void 0!=f&&f.closeAllDropdowns()};this.elements=new function(){this.menubar=function(a,c,
b){g.control.viewport.width();var d=20*b,e=void 0,f=void 0;a={text_fill:"rgba(0,0,0,1)",text_font:11.25*b+"pt Helvetica",background__up__fill:"rgba(240,240,240,1)",background__press__fill:"rgba(240,240,240,1)",background__select_press__fill:"rgba(229,167,255,1)",background__press__stroke:"rgba(0,0,0,0)",background__select__fill:"rgba(229,167,255,1)",background__select__stroke:"rgba(0,0,0,0)",background__select_press__stroke:"rgba(0,0,0,0)"};var m={text_font:11.25*b+"pt Helvetica",item__up__fill:"rgba(240,240,240,1)",
item__hover__fill:"rgba(229,167,255,1)"},t=g._interface.part.alpha.builder("group","menubar",{}),n=g._interface.part.alpha.builder("rectangle","rectangle",{x:0,y:0,width:d,height:d,style:{fill:"rgba(240,240,240,1)"}});t.append(n);for(var r=c=0;r<this.menubar.dropdowns.length;r++){var q=g._interface.part.alpha.builder("button_rect","dropdownButton_"+r,{x:c*b,y:0,width:this.menubar.dropdowns[r].width*b,height:d,hoverable:!1,selectable:!0,text_centre:this.menubar.dropdowns[r].text,style:a});t.append(q);
q.onpress=function(a){return function(){e=t.getChildByName("dropdownButton_"+a).select()?void 0:a}}(r);q.onenter=function(a){return function(b){void 0!=e&&e!=a&&(t.getChildByName("dropdownButton_"+e).select(!1),e=a,0==b.buttons&&t.getChildByName("dropdownButton_"+e).select(!0))}}(r);q.onselect=function(a,c,h){return function(){for(var k=0,l=0;l<h.menubar.dropdowns[a].itemList.length;l++)switch(h.menubar.dropdowns[a].itemList[l]){case "break":k+=h.menubar.dropdowns[a].breakHeight*b;break;case "space":k+=
h.menubar.dropdowns[a].spaceHeight*b;break;default:k+=h.menubar.dropdowns[a].listItemHeight*b}k>g.control.viewport.height()*b&&(k=g.control.viewport.height()*b);f=g._interface.part.alpha.builder("list","dropdown",{x:c*b,y:d,style:m,width:h.menubar.dropdowns[a].listWidth*b,height:k,multiSelect:!1,selectable:!1,itemWidthMux:1,itemHeightMux:h.menubar.dropdowns[a].listItemHeight/k*b,breakHeightMux:h.menubar.dropdowns[a].breakHeight/k*b,spaceHeightMux:h.menubar.dropdowns[a].spaceHeight/k*b,itemSpacingMux:0,
list:h.menubar.dropdowns[a].itemList});f.onrelease=function(){t.getChildByName("dropdownButton_"+a).select(!1);e=void 0};t.append(f)}}(r,c,this);q.ondeselect=function(){t.remove(f)};this.menubar.dropdowns[r].x=c;c+=this.menubar.dropdowns[r].width}t.closeAllDropdowns=function(){if(void 0!=f)f.onrelease()};t.refresh=function(){n.parameter.width(g.control.viewport.width())};t.refresh();return t}}};this.viewport=new function(){this.width=function(){return g.width};this.height=function(){return g.height};
this.scale=function(d){return g.core.viewport.scale(d)};this.position=function(d,f){return g.core.viewport.position(d,f)};this.refresh=function(){g.core.viewport.refresh();r.gui.refresh()};this.stopMouseScroll=function(d){return g.control.switch.enableWindowScrollbarAutomaticRemoval?g.core.viewport.stopMouseScroll(d):(g.core.viewport.stopMouseScroll(!1),!1)};this.activeRender=function(d){return g.core.render.active(d)}};this.scene=new function(){var d=g.system.pane.mm,f=0;this.new=function(d){if(void 0===
d||!d||confirm("This will clear the current scene! Are you sure?"))r.selection.selectEverything(),r.selection.delete(),f=0,r.viewport.position(0,0),r.viewport.scale(0)};this.documentUnits=function(d){for(var a=[],c=0;c<d.length;c++){var b=d[c],e={};e.position={x:b.parameter.x(),y:b.parameter.y(),angle:b.parameter.angle()};e.details={collection:b.collection,category:b.category,model:b.model};e.data=b.exportData?b.exportData():null;e.connections=[];for(var f in b.io)for(var g in b.io[f]){var m=b.io[f][g].getForeignNode();
if(void 0!=m){var t={};t.typeAndNameOfSourcePort={type:f,name:g};t.indexOfDestinationUnit=d.indexOf(m.parent);t.typeAndNameOfDestinationPort={type:f,name:m.name};e.connections.push(t)}}a.push(e)}return a};this.printUnits=function(d){for(var a=[],c=0;c<d.length;c++){var b=d[c],e=r.scene.addUnit(b.position.x,b.position.y,b.position.angle,b.details.model,b.details.category,b.details.collection);a.push(e);e.importData&&e.importData(b.data);r.selection.selectUnit(e);for(var f=0;f<b.connections.length;f++){var g=
b.connections[f],m=r.selection.selectedUnits[g.indexOfDestinationUnit];void 0!=m&&e.io[g.typeAndNameOfSourcePort.type][g.typeAndNameOfSourcePort.name].connectTo(m.io[g.typeAndNameOfDestinationPort.type][g.typeAndNameOfDestinationPort.name])}}return a};this.export=function(){return this.documentUnits(Array.from(d.children).filter(function(d){return!d._isCable}))};this.import=function(d){this.printUnits(d)};this.save=function(d,a){d=void 0===d?"project":d;a=void 0===a?!0:a;if(g.control.switch.enableSceneSave){var c=
{filename:d,viewportLocation:{xy:g.control.viewport.position(),scale:g.control.viewport.scale()}};g.library.audio.destination.masterGain(0);c.units=this.export();c=g.library.misc.serialize(c,a);c={compressed:a,data:c};c=g.library.misc.serialize(c,!1);g.library.misc.printFile(d,c);g.library.audio.destination.masterGain(1)}};this.load=function(d,a,c){function b(a,b){g.library.audio.destination.masterGain(0);try{a=g.library.misc.unserialize(a,!1)}catch(m){console.error("Major error unserializing first layer of file");
console.error(m);return}var c=a.compressed;try{a=g.library.misc.unserialize(a.data,c)}catch(m){console.error("Major error unserializing second layer of file");console.error(m);return}r.scene.new();r.scene.import(a.units);r.viewport.position(a.viewportLocation.xy.x,a.viewportLocation.xy.y);r.viewport.scale(a.viewportLocation.scale);g.library.audio.destination.masterGain(1);r.selection.deselectEverything();b&&b(metadata)}!g.control.switch.enableSceneLoad||void 0!==c&&c&&!confirm("This will clear the current scene! Are you sure?")||
(void 0==d?g.library.misc.openFile(function(c){b(c,a)}):(c=new XMLHttpRequest,c.open("GET",d,!0),c.responseType="text",c.onload=function(){b(this.response,a)},c.send()))};this.generateUnitName=function(){return f++};this.addUnit=function(e,a,c,b,f,k){k=void 0===k?"alpha":k;if(g.control.switch.enableSceneModification){var h=this.generateUnitName();e=void 0==f?g._interface.unit[k][b](e,a,c):g._interface.unit[k][f][b](e,a,c);e.name=""+h;e=g.control.grapple.declare(e);this.rectifyUnitPosition(e);d.append(e);
return e}};this.removeUnit=function(e){g.control.switch.enableSceneModification&&d.remove(e)};this.getUnitByName=function(e){return d.getChildByName(e)};this.getUnitsByType=function(e){return d.children.filter(function(a){return a.unitType==e})};this.getUnitUnderPoint=function(e,a){for(var c=0;c<d.children.length;c++)if(g.library.math.detectOverlap.boundingBoxes({bottomRight:{x:e,y:a},topLeft:{x:e,y:a}},d.children[c].space.box)&&g.library.math.detectOverlap.pointWithinPoly({x:e,y:a},d.children[c].space.points))return d.children[c]};
this.getUnitsWithinPoly=function(e){var a=g.library.math.boundingBoxFromPoints(e);return d.children.filter(function(c){return!c._isCable&&g.library.math.detectOverlap.boundingBoxes(a,c.space.box)&&g.library.math.detectOverlap.overlappingPolygons(e,c.space.points)})};this.rectifyUnitPosition=function(d){return!1}};this.selection=new function(){this.selectedUnits=[];this.lastSelectedUnits=null;this.clipboard=[];this.selectUnit=function(d,f){f=void 0===f?!0:f;if(g.control.switch.enableUnitSelection&&
-1==this.selectedUnits.indexOf(d)){f&&(f=g.system.pane.getMiddlegroundPane(d),f.remove(d),f.append(d));f=g._interface.part.alpha.builder("polygon","selectionGlow-"+d.getAddress(),{points:d.space.points.map(function(e){return{x:e.x-d.x,y:e.y-d.y}}),style:{fill:"rgba(244, 226, 66, 0.25)",stroke:"rgba(244, 226, 66, 1)"}});d.append(f);if(d.onselect)object.onselect();this.selectedUnits.push(d);this.lastSelectedUnits=d}};this.selectUnits=function(d){for(var f=0;f<d.length;f++)this.selectUnit(d[f])};this.deselectUnit=
function(d){d.remove(d.getChildByName("selectionGlow-"+d.getAddress()));this.selectedUnits.splice(this.selectedUnits.indexOf(d),1);if(d.ondeselect)d.ondeselect()};this.selectEverything=function(){this.deselectEverything();for(var d=0;d<g.system.pane.mm.children.length;d++)g.system.pane.mm.children[d]._isCable||this.selectUnit(g.system.pane.mm.children[d],!1)};this.deselectEverything=function(){for(;0<this.selectedUnits.length;)this.deselectUnit(this.selectedUnits[0])};this.cut=function(){g.control.switch.enableSceneModification&&
(this.copy(),this.delete())};this.copy=function(){g.control.switch.enableSceneModification&&(this.clipboard=g.control.scene.documentUnits(this.selectedUnits))};this.paste=function(d){if(g.control.switch.enableSceneModification&&0!=this.clipboard.length){this.deselectEverything();if("duplicate"!=d){var f=[];this.clipboard.forEach(function(a){return f.push(a.position)});var e=g.library.math.boundingBoxFromPoints(f).topLeft;void 0==d&&(d=g.core.viewport.mousePosition(),void 0==d.x||void 0==d.y)&&(d=
g.core.viewport.windowPoint2workspacePoint(0,0));this.clipboard.forEach(function(a){a.position.x+=d.x-e.x;a.position.y+=d.y-e.y})}g.control.scene.printUnits(this.clipboard)}};this.duplicate=function(){g.control.switch.enableSceneModification&&(this.copy(),this.paste("duplicate"),this.clipboard=[])};this.delete=function(){if(g.control.switch.enableSceneModification){for(;0<this.selectedUnits.length;){var d=this.selectedUnits[0];if(d.ondelete)d.ondelete();d.disconnectEverything();g.system.pane.getMiddlegroundPane(d).remove(d);
this.selectedUnits.shift()}this.lastSelectedUnits=null}}}};g.control.grapple={tmpdata:{},tmpunit:void 0,functionList:{onmousedown:[],onmouseup:[]},declare:function(r){function d(d){return function(e,a,c){0==c.button&&(g.control.grapple.tmpunit=this,g.library.structure.functionListRunner(d,g.system.keyboard.pressedKeys)({event:c,x:e,y:a}))}}r.onmousedown=d(this.functionList.onmousedown);r.onmouseup=d(this.functionList.onmouseup);return r}};g.control.grapple.functionList.onmousedown.push({requiredKeys:[],
function:function(r){var d=g.control;d.selection.selectedUnits.includes(d.grapple.tmpunit)||(r.event.shiftKey||d.selection.deselectEverything(),d.selection.selectUnit(d.grapple.tmpunit))}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[["shift","alt"]],function:function(r){var d=g.control;d.grapple.tmpdata.oldClickPosition={x:r.x,y:r.y};d.grapple.tmpdata.oldUnitsPositions=[];d.grapple.tmpdata.oldUnitsSelectionArea=[];for(r=0;r<d.selection.selectedUnits.length;r++)d.grapple.tmpdata.oldUnitsPositions.push({x:d.selection.selectedUnits[r].x,
y:d.selection.selectedUnits[r].y,angle:d.selection.selectedUnits[r].angle}),d.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},d.selection.selectedUnits[r].selectionArea));g.system.mouse.mouseInteractionHandler(function(f){for(var e=0;e<d.selection.selectedUnits.length;e++){var a=d.selection.selectedUnits[e],c=d.grapple.tmpdata.oldClickPosition,b=g.core.viewport.windowPoint2workspacePoint(f.x,f.y);a.parameter.angle(d.grapple.tmpdata.oldUnitsPositions[e].angle+(b.y-c.y)/100);g.control.scene.rectifyUnitPosition(a);
if(a.onrotate)a.onrotate();if(a.io)for(c=Object.keys(a.io),b=0;b<c.length;b++)for(var h=a.io[c[b]],k=Object.keys(h),l=0;l<k.length;l++)h[k[l]].draw()}},function(d){});return!0}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[["alt"]],function:function(r){g.control.selection.duplicate()}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[],function:function(r){var d=g.control;d.grapple.tmpdata.oldClickPosition={x:r.x,y:r.y};d.grapple.tmpdata.oldUnitsPositions=[];d.grapple.tmpdata.oldUnitsSelectionArea=
[];for(r=0;r<d.selection.selectedUnits.length;r++)d.grapple.tmpdata.oldUnitsPositions.push({x:d.selection.selectedUnits[r].x,y:d.selection.selectedUnits[r].y}),d.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},d.selection.selectedUnits[r].selectionArea));g.system.mouse.mouseInteractionHandler(function(f){for(var e=0;e<d.selection.selectedUnits.length;e++){var a=d.selection.selectedUnits[e],c=d.grapple.tmpdata.oldClickPosition,b=g.core.viewport.windowPoint2workspacePoint(f.x,f.y),h=d.grapple.tmpdata.oldUnitsPositions[e],
k=h.y+(b.y-c.y);a.parameter.x(h.x+(b.x-c.x));a.parameter.y(k);g.control.scene.rectifyUnitPosition(a);if(a.onmove)a.onmove();if(a.io)for(c=Object.keys(a.io),b=0;b<c.length;b++){h=a.io[c[b]];k=Object.keys(h);for(var l=0;l<k.length;l++)h[k[l]].draw()}}},function(d){})}});g.control.grapple.functionList.onmouseup.push({requiredKeys:[],function:function(r){var d=g.control;d.selection.selectedUnits.includes(d.grapple.tmpunit)&&(r.event.shiftKey&&d.selection.lastSelectedUnits!=d.grapple.tmpunit&&d.selection.deselectUnit(d.grapple.tmpunit),
d.selection.lastSelectedUnits=null);return!0}});window.onresize=g.control.viewport.refresh;g._interface.unit.alpha=new function(){var r=this;this.audioEffectUnits=new function(){this.filterUnit=function(d,f,e){function a(){for(var a=[],c=[],d=0;d<=Math.floor(Math.log10(b.freqRange.high))+1;d++)for(var e=1;10>e&&!(e/10*Math.pow(10,d)>=b.freqRange.high);e+=1/Math.pow(2,b.graphDetail))a.push(Math.log10(Math.pow(10,d)*e)),c.push(e/10*Math.pow(10,d));return{frequency:c,location:g.library.math.normalizeStretchArray(a)}}
function c(){var b=a();m.elements.grapher__static.graph.draw(m.filterCircuit.measureFrequencyResponse_values(b.frequency)[0],b.location)}var b={freqRange:{low:.1,high:2E4},graphDetail:3},h={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},k={fill:"rgba(0,0,0,1)",font:"2pt Courier New"},l={fill:"rgba(0,0,0,1)",font:"1.5pt Courier New"},m=r.builder(this.filterUnit,{name:"filterUnit",category:"audioEffectUnits",collection:"alpha",x:d,y:f,a:e,space:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},
{x:0,y:70}],elements:[{type:"polygon",name:"backing",data:{points:[{x:10,y:0},{x:92.5,y:0},{x:102.5,y:70},{x:51.25,y:100},{x:0,y:70}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:94.8,y:16,width:10,height:20,angle:-.14}},{type:"connectionNode_audio",name:"audioOut",data:{x:-2.3,y:16,width:10,height:20,angle:.144,isAudioOutput:!0}},{type:"grapher__static",name:"graph",data:{x:15,y:5,width:72.5,height:50,resolution:5,style:{foregrounds:[{stroke:"rgba(0,200,163,1)",
lineWidth:.5,lineJoin:"round"}],background_stroke:"rgba(0,200,163,0.25)",background_lineWidth:.25,backgroundText_fill:"rgba(0,200,163,0.75)",backgroundText_font:"6pt Helvetica"}}},{type:"text",name:"Q_0",data:{x:74,y:76,text:"0",style:k}},{type:"text",name:"Q_1/2",data:{x:80,y:59.5,text:"1/2",style:k}},{type:"text",name:"Q_1",data:{x:89,y:76,text:"1",style:k}},{type:"text",name:"Q_title",data:{x:81,y:79,text:"Q",style:h}},{type:"dial_continuous",name:"Q_dial",data:{x:82.5,y:68.5,r:7,startAngle:3*
Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"gain_0",data:{x:54,y:86,text:"0",style:k}},{type:"text",name:"gain_1/2",data:{x:61.75,y:68.5,text:"5",style:k}},{type:"text",name:"gain_1",data:{x:69,y:86,text:"10",style:k}},{type:"text",name:"gain_title",data:{x:58,y:89,text:"Gain",style:h}},{type:"dial_continuous",name:"gain_dial",data:{x:62.5,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",
slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"frequency_0",data:{x:31.5,y:86,text:"0",style:k}},{type:"text",name:"frequency_100",data:{x:37.5,y:68.5,text:"100",style:k}},{type:"text",name:"frequency_20000",data:{x:46.5,y:86,text:"20k",style:k}},{type:"text",name:"frequency_title",data:{x:35.5,y:89,text:"Freq",style:h}},{type:"dial_continuous",name:"frequency_dial",data:{x:40,y:77.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",
needle:"rgba(250,150,150,1)"}}},{type:"text",name:"type_lowp",data:{x:9,y:74.5,text:"lowp",style:l}},{type:"text",name:"type_highp",data:{x:6,y:69,text:"highp",style:l}},{type:"text",name:"type_band",data:{x:8,y:63,text:"band",style:l}},{type:"text",name:"type_lows",data:{x:14,y:59,text:"lows",style:l}},{type:"text",name:"type_highs",data:{x:22.5,y:59.5,text:"highs",style:l}},{type:"text",name:"type_peak",data:{x:27.5,y:63,text:"peak",style:l}},{type:"text",name:"type_notch",data:{x:29,y:69,text:"notch",
style:l}},{type:"text",name:"type_all",data:{x:25.5,y:74.5,text:"all",style:l}},{type:"text",name:"type_title",data:{x:15.5,y:78.5,text:"Type",style:h}},{type:"dial_discrete",name:"type_dial",data:{x:20,y:67.5,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:8,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});m.importData=function(a){m.elements.dial_continuous.Q_dial.set(a.Q);m.elements.dial_continuous.gain_dial.set(a.gain);m.elements.dial_discrete.type_dial.set(a.type);
m.elements.dial_continuous.frequency_dial.set(a.frequency)};m.exportData=function(){return{Q:m.elements.dial_continuous.Q_dial.get(),gain:m.elements.dial_continuous.gain_dial.get(),type:m.elements.dial_discrete.type_dial.get(),frequency:m.elements.dial_continuous.frequency_dial.get()}};m.filterCircuit=new g._interface.circuit.alpha.filterUnit(g.library.audio.context);m.elements.connectionNode_audio.audioIn.out().connect(m.filterCircuit.in());m.filterCircuit.out().connect(m.elements.connectionNode_audio.audioOut.in());
m.elements.dial_continuous.Q_dial.onchange=function(a){m.filterCircuit.Q(10*a);c()};m.elements.dial_continuous.gain_dial.onchange=function(a){m.filterCircuit.gain(10*a);c()};m.elements.dial_continuous.frequency_dial.onchange=function(a){m.filterCircuit.frequency(g.library.math.curvePoint.exponential(a,0,2E4,10.5866095));c()};m.elements.dial_discrete.type_dial.onchange=function(a){m.filterCircuit.type("lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ")[a]);c()};d=a();d.frequency=
d.frequency.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});d.location=d.location.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});m.elements.grapher__static.graph.viewbox({bottom:0,top:2,left:0,right:1});m.elements.grapher__static.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});m.elements.grapher__static.graph.verticalMarkings({points:d.location,printingValues:d.frequency.map(function(a){return 0==Math.log10(a)%1?
a:""}).slice(0,d.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});m.elements.dial_discrete.type_dial.set(0);m.elements.dial_continuous.Q_dial.set(0);m.elements.dial_continuous.gain_dial.set(.1);m.elements.dial_continuous.frequency_dial.set(.5);setTimeout(c,100);return m};this.filterUnit.metadata={name:"Filter Unit",helpURL:"https://curve.metasophiea.com/help/units/alpha/filterUnit/"};this.reverbUnit=function(d,f){function e(b){0==a.availableTypes.length?console.log("broken or not yet ready"):
(b>=a.availableTypes.length?b=a.availableTypes.length-1:0>b&&(b=0),a.reverbTypeSelected=b,h.reverbCircuit.type(a.availableTypes[b],function(){var b=a.reverbTypeSelected;b=("0"+b).slice(-2);h.elements.sevenSegmentDisplay__static.ones.enterCharacter(b[0]);h.elements.sevenSegmentDisplay__static.tens.enterCharacter(b[1])}))}var a={reverbTypeSelected:0,availableTypes:[]},c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",
background__hover_press__fill:"rgba(150,150,150,1)"},h=r.builder(this.reverbUnit,{name:"reverbUnit",category:"audioEffectUnits",collection:"alpha",x:d,y:f,space:[{x:0,y:10},{x:51.25,y:0},{x:102.5,y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:51.25,y:0},{x:102.5,y:10},{x:102.5,y:40},{x:51.25,y:50},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:102.5,y:16,width:10,height:20}},
{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:16,width:10,height:20,isAudioOutput:!0}},{type:"text",name:"outGain_0",data:{x:8,y:38,text:"0",style:c}},{type:"text",name:"outGain_1/2",data:{x:16.5,y:11,text:"1/2",style:c}},{type:"text",name:"outGain_1",data:{x:29,y:38,text:"1",style:c}},{type:"dial_continuous",name:"outGain_dial",data:{x:20,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},
{type:"text",name:"wetdry_1/2",data:{x:66.5,y:39,text:"wet",style:c}},{type:"text",name:"wetdry_1",data:{x:91.5,y:39,text:"dry",style:c}},{type:"dial_continuous",name:"wetdry_dial",data:{x:82.5,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"button_rect",name:"raiseByOne",data:{x:51,y:6,width:10.25,height:5,style:b,onpress:function(){e(a.reverbTypeSelected+1)}}},{type:"button_rect",name:"raiseByTen",
data:{x:38.75,y:6,width:10.25,height:5,style:b,onpress:function(){e(a.reverbTypeSelected+10)}}},{type:"button_rect",name:"lowerByOne",data:{x:51,y:39,width:10.25,height:5,style:b,onpress:function(){e(a.reverbTypeSelected-1)}}},{type:"button_rect",name:"lowerByTen",data:{x:38.75,y:39,width:10.25,height:5,style:b,onpress:function(){e(a.reverbTypeSelected-10)}}},{type:"sevenSegmentDisplay__static",name:"tens",data:{x:50,y:12.5,width:12.5,height:25}},{type:"sevenSegmentDisplay__static",name:"ones",data:{x:37.5,
y:12.5,width:12.5,height:25}}]});h.importData=function(b){a.reverbTypeSelected=b.selectedType;h.elements.dial_continuous.wetdry_dial.set(b.wetdry);h.elements.dial_continuous.outGain_dial.set(b.outGain)};h.exportData=function(){return{selectedType:a.reverbTypeSelected,wetdry:h.elements.dial_continuous.wetdry_dial.get(),outGain:h.elements.dial_continuous.outGain_dial.get()}};h.reverbCircuit=new g._interface.circuit.alpha.reverbUnit(g.library.audio.context);h.elements.connectionNode_audio.audioIn.out().connect(h.reverbCircuit.in());
h.reverbCircuit.out().connect(h.elements.connectionNode_audio.audioOut.in());h.reverbCircuit.getTypes(function(b){a.availableTypes=b});h.elements.dial_continuous.outGain_dial.onchange=function(a){h.reverbCircuit.outGain(a)};h.elements.dial_continuous.wetdry_dial.onchange=function(a){h.reverbCircuit.wetdry(1-a)};h.i={gain:function(a){h.elements.dial_continuous.outGain_dial.set(a)},wetdry:function(a){h.elements.dial_continuous.wetdry_dial.set(a)}};h.elements.dial_continuous.outGain_dial.set(.5);h.elements.dial_continuous.wetdry_dial.set(.5);
setTimeout(function(){e(a.reverbTypeSelected)},1E3);return h};this.reverbUnit.metadata={name:"Reverb Unit",helpURL:"https://curve.metasophiea.com/help/units/alpha/reverbUnit/"};this.multibandFilter=function(d,f,e){function a(){for(var a=[],c=[],d=0;d<=Math.floor(Math.log10(b.freqRange.high))+1;d++)for(var e=1;10>e&&!(e/10*Math.pow(10,d)>=b.freqRange.high);e+=1/Math.pow(2,b.graphDetail))a.push(Math.log10(Math.pow(10,d)*e)),c.push(e/10*Math.pow(10,d));return{frequency:c,location:g.library.math.normalizeStretchArray(a)}}
function c(c){if(b.allowUpdate){var d=a();if(void 0==c){var e=m.filterCircuit_0.measureFrequencyResponse(void 0,d.frequency);for(c=0;c<b.channelCount;c++)m.elements.grapher__static.graph.draw(e[c][0],d.location,c)}else e=m.filterCircuit_0.measureFrequencyResponse(c,d.frequency),m.elements.grapher__static.graph.draw(e[0],d.location,c)}}var b={allowUpdate:!1,freqRange:{low:.1,high:2E4},graphDetail:2,channelCount:8,masterGain:1,gain:[],Q:[],frequency:[],curvePointExponentialSharpness:10.586609649448985,
defaultValues:{gain:[.5,.5,.5,.5,.5,.5,.5,.5],Q:[0,.09,.09,.09,.09,.09,.09,0],frequency:[.41416,.479046,.565238,.630592,.717072,.803595,.91345175,.93452845]}},h=[{fill:"rgba(0,200,163,  0.5)"},{fill:"rgba(100,235,131,0.5)"},{fill:"rgba(228,255,26, 0.5)"},{fill:"rgba(232,170,20, 0.5)"},{fill:"rgba(255,87,20,  0.5)"},{fill:"rgba(0,191,255,  0.5)"},{fill:"rgba(249,99,202, 0.5)"},{fill:"rgba(255,255,255,0.5)"}],k={handle:"rgba(240,240,240,1)",backing:"rgba(200,200,200,0.5)",slot:"rgba(50,50,50,1)"},l=
{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"};d={name:"multibandFilter",category:"audioEffectUnits",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:10},{x:10,y:0},{x:185,y:0},{x:195,y:10},{x:195,y:245},{x:185,y:255},{x:10,y:255},{x:0,y:245},{x:0,y:75},{x:-25,y:65},{x:-25,y:10}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:185,y:0},{x:195,y:10},{x:195,y:245},{x:185,y:255},{x:10,y:255},{x:0,y:245},{x:0,y:75},{x:-25,y:65},{x:-25,y:10}],
style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn_0",data:{x:195,y:15,width:10,height:20}},{type:"connectionNode_audio",name:"audioIn_1",data:{x:195,y:40,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut_0",data:{x:-35,y:15,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"audioOut_1",data:{x:-35,y:40,width:10,height:20,isAudioOutput:!0}},{type:"dial_continuous",name:"masterGain",data:{x:-10,y:37.5,r:10,startAngle:3*Math.PI/4,maxAngle:1.5*
Math.PI,resetValue:.5,style:l}},{type:"grapher__static",name:"graph",data:{x:10,y:10,width:175,height:75,style:{foregrounds:[{stroke:"rgba(0,200,163,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(100,235,131,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(228,255,26,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(232,170,20,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,87,20,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,191,255,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(249,99,202,1)",
lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,255,1)",lineWidth:.5,lineJoin:"round"}],background_stroke:"rgba(0,200,163,0.25)",background_lineWidth:.25,backgroundText_fill:"rgba(0,200,163,0.75)",backgroundText_font:"8pt Helvetica"},resolution:5}}]};for(e=0;e<b.channelCount;e++)d.elements.push({type:"rectangle",name:"backing_"+e,data:{x:13.75+22*e,y:87.5,width:12.5,height:157.5,style:h[e]}},{type:"slide",name:"gainSlide_"+e,data:{x:15+22*e,y:90,width:10,height:80,angle:0,handleHeight:.05,resetValue:.5,
style:k}},{type:"dial_continuous",name:"qDial_"+e,data:{x:20+22*e,y:180,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:l}},{type:"dial_continuous",name:"frequencyDial_"+e,data:{x:20+22*e,y:200,r:7,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:l}},{type:"readout_sixteenSegmentDisplay__static",name:"frequencyReadout_"+e,data:{x:25+22*e,y:212.5,width:30,height:10,count:8,angle:Math.PI/2,resolution:10}});var m=r.builder(this.multibandFilter,d);m.exportData=function(){return{masterGain:b.masterGain,
freqRange:b.freqRange,channelCount:b.channelCount,gain:b.gain,Q:b.Q,frequency:b.frequency}};m.importData=function(a){};m.filterCircuit_0=new g._interface.circuit.alpha.multibandFilter(g.library.audio.context,b.channelCount,!0);m.filterCircuit_1=new g._interface.circuit.alpha.multibandFilter(g.library.audio.context,b.channelCount,!0);m.elements.connectionNode_audio.audioIn_0.out().connect(m.filterCircuit_0.in());m.elements.connectionNode_audio.audioIn_1.out().connect(m.filterCircuit_1.in());m.filterCircuit_0.out().connect(m.elements.connectionNode_audio.audioOut_0.in());
m.filterCircuit_1.out().connect(m.elements.connectionNode_audio.audioOut_1.in());m.elements.dial_continuous.masterGain.onchange=function(a){b.masterGain=2*a;m.filterCircuit_0.masterGain(b.masterGain);m.filterCircuit_1.masterGain(b.masterGain);c()};for(e=0;e<b.channelCount;e++)m.elements.slide["gainSlide_"+e].onchange=function(a){return function(d){b.gain[a]=2*(1-d);m.filterCircuit_0.gain(a,b.gain[a]);m.filterCircuit_1.gain(a,b.gain[a]);c(a)}}(e),m.elements.dial_continuous["qDial_"+e].onchange=function(a){return function(d){b.Q[a]=
d;m.filterCircuit_0.Q(a,g.library.math.curvePoint.exponential(b.Q[a],0,2E4,b.curvePointExponentialSharpness));m.filterCircuit_1.Q(a,g.library.math.curvePoint.exponential(b.Q[a],0,2E4,b.curvePointExponentialSharpness));c(a)}}(e),m.elements.dial_continuous["frequencyDial_"+e].onchange=function(a){return function(d){b.frequency[a]=d;m.elements.readout_sixteenSegmentDisplay__static["frequencyReadout_"+a].text(g.library.misc.padString(g.library.math.curvePoint.exponential(d,0,2E4,b.curvePointExponentialSharpness).toFixed(2),
8));m.elements.readout_sixteenSegmentDisplay__static["frequencyReadout_"+a].print("smart");m.filterCircuit_0.frequency(a,g.library.math.curvePoint.exponential(b.frequency[a],0,2E4,b.curvePointExponentialSharpness));m.filterCircuit_1.frequency(a,g.library.math.curvePoint.exponential(b.frequency[a],0,2E4,b.curvePointExponentialSharpness));c(a)}}(e);m.i={gain:function(a,b){if(void 0==b)return m.elements.slide["gainSlide_"+a].get(b);m.elements.slide["gainSlide_"+a].set(b)},Q:function(a,b){if(void 0==
b)return m.elements.dial_continuous["qDial_"+a].get(b);m.elements.dial_continuous["qDial_"+a].set(b)},frequency:function(a,b){if(void 0==b)return m.elements.dial_continuous["frequencyDial_"+a].get(b);m.elements.dial_continuous["frequencyDial_"+a].set(b)},reset:function(a){if(void 0==a){for(a=0;a<b.channelCount;a++)m.i.reset(a);m.elements.dial_continuous.masterGain.set(.5)}else for(a=0;a<b.channelCount;a++)m.elements.slide["gainSlide_"+a].set(b.defaultValues.gain[a]),m.elements.dial_continuous["qDial_"+
a].set(b.defaultValues.Q[a]),m.elements.dial_continuous["frequencyDial_"+a].set(b.defaultValues.frequency[a])}};e=a();e.frequency=e.frequency.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});e.location=e.location.filter(function(a,c){return 0==c%Math.pow(2,b.graphDetail)});m.elements.grapher__static.graph.viewbox({bottom:0,top:2,left:0,right:1});m.elements.grapher__static.graph.horizontalMarkings({points:[.25,.5,.75,1,1.25,1.5,1.75],textPosition:{x:.005,y:.075},printText:!0});m.elements.grapher__static.graph.verticalMarkings({points:e.location,
printingValues:e.frequency.map(function(a){return 0==Math.log10(a)%1?a:""}).slice(0,e.frequency.length-1).concat(""),textPosition:{x:-.0025,y:1.99},printText:!0});m.i.reset();setTimeout(function(){m.i.reset()},1);b.allowUpdate=!0;c();return m};this.multibandFilter.metadata={name:"Multiband Filter",helpURL:"https://curve.metasophiea.com/help/units/alpha/multibandFilter/"};this.distortionUnit=function(d,f,e){var a={fill:"rgba(0,0,0,1)",font:"4pt Courier New"},c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},
b=r.builder(this.distortionUnit,{name:"distortionUnit",category:"audioEffectUnits",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,y:10},{x:102.5*.55,y:10},{x:102.5/3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:102.5/3,y:0},{x:46.125,y:10},{x:102.5*.55,y:10},{x:102.5/
3*2,y:0},{x:92.5,y:0},{x:102.5,y:10},{x:102.5,y:85},{x:92.5,y:95},{x:102.5/3*2,y:95},{x:102.5*.55,y:85},{x:46.125,y:85},{x:102.5/3,y:95},{x:10,y:95},{x:0,y:85}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioIn",data:{x:102.5,y:61.5,width:10,height:20}},{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:61.5,width:10,height:20,isAudioOutput:!0}},{type:"text",name:"outGain_title",data:{x:17.5,y:91,text:"out",style:a}},{type:"text",name:"outGain_0",data:{x:9.5,
y:85.5,text:"0",style:c}},{type:"text",name:"outGain_1/2",data:{x:19,y:57,text:"1/2",style:c}},{type:"text",name:"outGain_1",data:{x:33,y:85.5,text:"1",style:c}},{type:"dial_continuous",name:"outGain_dial",data:{x:22.5,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"distortionAmount_title",data:{x:16.5,y:41.5,text:"dist",style:a}},{type:"text",name:"distortionAmount_0",
data:{x:9.5,y:36,text:"0",style:c}},{type:"text",name:"distortionAmount_50",data:{x:20,y:7.5,text:"50",style:c}},{type:"text",name:"distortionAmount_100",data:{x:33,y:36,text:"100",style:c}},{type:"dial_continuous",name:"distortionAmount_dial",data:{x:22.5,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"resolution_title",data:{x:47,y:66,text:"res",style:a}},{type:"text",
name:"resolution_2",data:{x:39,y:60,text:"2",style:c}},{type:"text",name:"resolution_50",data:{x:49,y:32,text:"500",style:c}},{type:"text",name:"resolution_100",data:{x:63,y:60,text:"1000",style:c}},{type:"dial_continuous",name:"resolution_dial",data:{x:52.5,y:47.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"overSample_title",data:{x:67,y:41.5,text:"overSamp",style:a}},
{type:"text",name:"overSample_0",data:{x:61,y:12,text:"none",style:c}},{type:"text",name:"overSample_50",data:{x:77.5,y:7.5,text:"2x",style:c}},{type:"text",name:"overSample_100",data:{x:90.5,y:12,text:"4x",style:c}},{type:"dial_discrete",name:"overSample_dial",data:{x:80,y:23,r:12,startAngle:1.25*Math.PI,maxAngle:.5*Math.PI,arcDistance:1.35,optionCount:3,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}},{type:"text",name:"inGain_title",data:{x:76,y:91,text:"in",
style:a}},{type:"text",name:"inGain_0",data:{x:67,y:85.5,text:"0",style:c}},{type:"text",name:"inGain_1/2",data:{x:76.5,y:57,text:"1/2",style:c}},{type:"text",name:"inGain_1",data:{x:90.5,y:85.5,text:"1",style:c}},{type:"dial_continuous",name:"inGain_dial",data:{x:80,y:72.5,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});b.importData=function(a){b.elements.dial_continuous.outGain_dial.set(a.outGain);
b.elements.dial_continuous.distortionAmount_dial.set(a.distortionAmount);b.elements.dial_continuous.resolution_dial.set(a.resolution);b.elements.dial_discrete.overSample_dial.set(a.overSample);b.elements.dial_continuous.inGain_dial.set(a.inGain)};b.exportData=function(){return{outGain:b.elements.dial_continuous.outGain_dial.get(),distortionAmount:b.elements.dial_continuous.distortionAmount_dial.get(),resolution:b.elements.dial_continuous.resolution_dial.get(),overSample:b.elements.dial_discrete.overSample_dial.get(),
inGain:b.elements.dial_continuous.inGain_dial.get()}};b.distortionCircuit=new g._interface.circuit.alpha.distortionUnit(g.library.audio.context);b.elements.connectionNode_audio.audioIn.out().connect(b.distortionCircuit.in());b.distortionCircuit.out().connect(b.elements.connectionNode_audio.audioOut.in());b.elements.dial_continuous.outGain_dial.onchange=function(a){b.distortionCircuit.outGain(a)};b.elements.dial_continuous.distortionAmount_dial.onchange=function(a){b.distortionCircuit.distortionAmount(100*
a)};b.elements.dial_continuous.resolution_dial.onchange=function(a){b.distortionCircuit.resolution(Math.round(1E3*a))};b.elements.dial_discrete.overSample_dial.onchange=function(a){b.distortionCircuit.oversample(["none","2x","4x"][a])};b.elements.dial_continuous.inGain_dial.onchange=function(a){b.distortionCircuit.inGain(2*a)};b.elements.dial_continuous.resolution_dial.set(.5);b.elements.dial_continuous.inGain_dial.set(.5);b.elements.dial_continuous.outGain_dial.set(1);return b};this.distortionUnit.metadata=
{name:"Distortion Unit",helpURL:"https://curve.metasophiea.com/help/units/alpha/distortionUnit/"}};this.audioFile=new function(){this.recorder=function(d,f,e){function a(a){if("empty"!=k||"save"!=a&&"stop"!=a){if("stop"==a||"save"==a)k="full";"empty"==k&&"rec"==a&&(k="recording");"clear"==a&&(k="empty");"recording"==k&&"pause/resume"==a?k="paused":"paused"!=k||"pause/resume"!=a&&"rec"!=a||(k="recording");if("empty"==k)h.elements.glowbox_rect.activityLight_empty.on();else h.elements.glowbox_rect.activityLight_empty.off();
if("recording"==k)h.elements.glowbox_rect.activityLight_recording.on();else h.elements.glowbox_rect.activityLight_recording.off();if("paused"==k)h.elements.glowbox_rect.activityLight_paused.on();else h.elements.glowbox_rect.activityLight_paused.off();if("full"==k)h.elements.glowbox_rect.activityLight_full.on();else h.elements.glowbox_rect.activityLight_full.off()}}var c={fill:"rgba(0,0,0,1)",font:"4pt Courier New"},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",
background__hover_press__fill:"rgba(150,150,150,1)"},h=g._interface.unit.alpha.builder(this.recorder,{name:"recorder",category:"audioFile",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:175,y:0},{x:175,y:40},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:175,y:0},{x:175,y:40},{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"inRight",data:{x:175,y:2.5,width:10,height:15}},{type:"connectionNode_audio",name:"inLeft",data:{x:175,
y:22.5,width:10,height:15}},{type:"rectangle",name:"logo_rect",data:{x:135,y:27.5,angle:-.25,width:35,height:10,style:{fill:"rgb(230,230,230)"}}},{type:"text",name:"logo_label",data:{x:139,y:34.5,angle:-.25,text:"REcorder",style:{fill:"rgba(100,100,100,1)",font:"6pt Bookman"}}},{type:"button_rect",name:"rec",data:{x:5,y:25,width:20,height:10,style:b,onpress:function(){"paused"==k?h.recorder.resume():h.recorder.start();a("rec")}}},{type:"text",name:"button_rect_text",data:{x:10.5,y:31.5,text:"rec",
angle:0,style:c}},{type:"button_rect",name:"pause/resume",data:{x:27.5,y:25,width:20,height:10,style:b,onpress:function(){"paused"==k?h.recorder.resume():h.recorder.pause();a("pause/resume")}}},{type:"text",name:"button_pause/resume_text",data:{x:30,y:31.5,text:"pause",angle:0,style:c}},{type:"button_rect",name:"stop",data:{x:50,y:25,width:20,height:10,style:b,onpress:function(){a("stop");h.recorder.stop()}}},{type:"text",name:"button_stop_text",data:{x:54,y:31.5,text:"stop",angle:0,style:c}},{type:"button_rect",
name:"save",data:{x:72.5,y:25,width:20,height:10,style:b,onpress:function(){a("save");"empty"!=k&&h.recorder.save()}}},{type:"text",name:"button_save_text",data:{x:76.5,y:31.5,text:"save",angle:0,style:c}},{type:"button_rect",name:"clear",data:{x:95,y:25,width:20,height:10,style:b,onpress:function(){a("clear");h.recorder.clear()}}},{type:"text",name:"button_clear_text",data:{x:97.5,y:31.5,text:"clear",angle:0,style:c}},{type:"readout_sixteenSegmentDisplay__static",name:"time",data:{x:70,y:5,angle:0,
width:100,height:15,count:11,style:{background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"}}},{type:"glowbox_rect",name:"activityLight_recording",data:{x:5,y:5,width:15,height:15,style:{glow:"rgb(255, 63, 63)",dim:"rgb(25, 6, 6)"}}},{type:"text",name:"activityLight_recording_text",data:{x:8,y:14,text:"rec",angle:0,style:c}},{type:"glowbox_rect",name:"activityLight_paused",data:{x:20,y:5,width:15,height:15,style:{glow:"rgb(126, 186, 247)",dim:"rgb(12, 18, 24)"}}},{type:"text",name:"activityLight_paused_text",
data:{x:23,y:14,text:"pau",angle:0,style:c}},{type:"glowbox_rect",name:"activityLight_empty",data:{x:35,y:5,width:15,height:15,style:{glow:"rgb(199, 249, 244)",dim:"rgb(19, 24, 24)"}}},{type:"text",name:"activityLight_empty_text",data:{x:38,y:14,text:"emp",angle:0,style:c}},{type:"glowbox_rect",name:"activityLight_full",data:{x:50,y:5,width:15,height:15,style:{glow:"rgb(61, 224, 35)",dim:"rgb(6, 22, 3)"}}},{type:"text",name:"activityLight_full_text",data:{x:53,y:14,text:"ful",angle:0,style:c}}]});
setInterval(function(){var a=h.recorder.recordingTime(),b=a%1;a=g.library.math.seconds2time(Math.round(a));h.elements.readout_sixteenSegmentDisplay__static.time.text(g.library.misc.padString(a.h,2,"0")+":"+g.library.misc.padString(a.m,2,"0")+":"+g.library.misc.padString(a.s,2,"0")+"."+g.library.misc.padString((""+b).slice(2),2,"0"));h.elements.readout_sixteenSegmentDisplay__static.time.print()},100);var k="empty";a("clear");h.elements.glowbox_rect.activityLight_empty.on();h.recorder=new g._interface.circuit.alpha.recorder(g.library.audio.context);
h.elements.connectionNode_audio.inRight.out().connect(h.recorder.in_right());h.elements.connectionNode_audio.inLeft.out().connect(h.recorder.in_left());return h};this.recorder.metadata={name:"Recorder",helpURL:"https://curve.metasophiea.com/help/units/alpha/recorder/"};this.looper=function(d,f,e){var a={fill:"rgba(200,200,200,1)"},c={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},b=g._interface.unit.alpha.builder(this.looper,{name:"looper",category:"audioFile",collection:"alpha",x:d,
y:f,a:e,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:a}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,onreceive:function(a,c){b.elements.button_rect.fire.press()}}},
{type:"circle",name:"symbol_outterCircle1",data:{x:11.5,y:41,r:6,style:c}},{type:"circle",name:"symbol_outterCircle2",data:{x:18.5,y:41,r:6,style:c}},{type:"rectangle",name:"symbol_blockingrect",data:{x:11.5,y:34,width:7,height:15,style:a}},{type:"path",name:"symbol_upperarrow",data:{points:[{x:13.5,y:32.5},{x:16.5,y:35},{x:13.5,y:37.5}],style:c}},{type:"path",name:"symbol_lowerarrow",data:{points:[{x:16.5,y:44.75},{x:13.5,y:47.25},{x:16.5,y:49.75}],style:c}},{type:"button_rect",name:"loadFile",data:{x:5,
y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){b.looper.load("file",function(a){b.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(b.looper.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},
onpress:function(){if(!(0>b.looper.duration())){b.looper.start();var a=b.looper.duration();h&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),clearTimeout(k));m=void 0;l=0;var c=Math.floor(a),d=c/(1E3*a);k=setInterval(function(){void 0!=m&&b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);m=l;l+=d;b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);1<l&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),l=0,m=void 0)},c);h=!0}}}},{type:"button_rect",
name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){b.looper.stop();h&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),h=!1,l=void 0,clearTimeout(k))}}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]}),h=!1,k=void 0,l=void 0,m=void 0;b.looper=
new g._interface.circuit.alpha.looper(g.library.audio.context);b.looper.out_right().connect(b.elements.connectionNode_audio.outRight.in());b.looper.out_left().connect(b.elements.connectionNode_audio.outLeft.in());return b};this.looper.metadata={name:"Looper",helpURL:"https://curve.metasophiea.com/help/units/alpha/looper/"};this.oneShot_single=function(d,f,e){var a={fill:"rgba(150,150,150,1)"},c={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},b=r.builder(this.oneShot_single,{name:"oneShot_single",
category:"audioFile",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,
width:10,height:20,onreceive:function(a,c){b.elements.button_rect.fire.press();b.elements.button_rect.fire.release()}}},{type:"path",name:"symbol_arrow",data:{points:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:c}},{type:"rectangle",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:a}},{type:"circle",name:"symbol_outerCircle",data:{x:10,y:40,r:5.5,style:c}},{type:"rectangle",name:"symbol_1",data:{x:9.5,y:37.5,width:1,height:5,style:a}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,
height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){b.oneShot.load("file",function(a){b.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(b.oneShot.waveformSegment())})}}},{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:20,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},
onpress:function(){if(!(0>b.oneShot.duration())){b.oneShot.fire();var a=b.oneShot.duration();h&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),clearTimeout(k));m=void 0;l=0;var c=10/(1E3*a);k=setInterval(function(){void 0!=m&&b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);m=l;l+=c;b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l);1<l&&(b.elements.grapher_waveWorkspace.grapher_waveWorkspace.mark(l),l=0,m=void 0,clearInterval(k))},10);h=!0}}}},{type:"grapher_waveWorkspace",
name:"grapher_waveWorkspace",data:{x:30,y:5,width:185,height:45,selectNeedle:!1,selectionArea:!1}}]}),h=void 0,k=void 0,l=void 0,m=void 0;b.oneShot=new g._interface.circuit.alpha.oneShot_single(g.library.audio.context);b.oneShot.out_right().connect(b.elements.connectionNode_audio.outRight.in());b.oneShot.out_left().connect(b.elements.connectionNode_audio.outLeft.in());return b};this.oneShot_single.metadata={name:"One Shot (Single)",helpURL:"https://curve.metasophiea.com/help/objects/units/oneShot_single/"};
this.oneShot_multi=function(d,f,e){var a={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",lineWidth:1},c=r.builder(this.oneShot_multi,{name:"oneShot_multi",category:"audioFile",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},
{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_data",name:"trigger",data:{x:220,y:17.5,width:10,height:20,onreceive:function(a,b){c.elements.button_rect.fire.press();c.elements.button_rect.fire.release()}}},{type:"path",name:"symbol_arrow",data:{points:[{x:19,y:35},{x:25,y:40},{x:19,y:45}],style:a}},{type:"rectangle",name:"symbol_line",data:{x:15,y:39.5,width:6,height:1,style:{fill:"rgba(150,150,150,1)"}}},{type:"circle",
name:"symbol_outterCircle",data:{x:10,y:40,r:5.5,style:a}},{type:"circle",name:"symbol_infCircle1",data:{x:8.5,y:40,r:1.5,style:a}},{type:"circle",name:"symbol_infCircle2",data:{x:11.5,y:40,r:1.5,style:a}},{type:"button_rect",name:"loadFile",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){c.oneShot.load("file",function(a){c.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(c.oneShot.waveformSegment())})}}},
{type:"button_rect",name:"fire",data:{x:5,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},onpress:function(){var a=c.oneShot,d=c.elements.grapher_waveWorkspace.grapher_waveWorkspace;if(!(0>a.duration())){var e=void 0!=d.area().A?d.area().A:0,f=void 0!=d.area().B?d.area().B:1,g=a.duration();e*=g;f=f*g-e;a.fire(e,f);for(var n=0;n in b;)n++;b[n]={};c.elements.glowbox_rect.glowbox_rect.on();
setTimeout(function(){c.elements.glowbox_rect.glowbox_rect.off()},100);b[n].previousPosition=void 0;b[n].currentPosition=e/g;b[n].endPosition=e/g+f/g;var r=10/(1E3*f);b[n].needleInterval=setInterval(function(){void 0!=b[n].previousPosition&&d.mark(b[n].currentPosition);b[n].previousPosition=b[n].currentPosition;b[n].currentPosition+=r;d.mark(b[n].currentPosition);b[n].currentPosition>b[n].endPosition&&(d.mark(b[n].currentPosition),clearInterval(b[n].needleInterval))},10)}}}},{type:"button_rect",name:"panic",
data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){var a=c.elements.grapher_waveWorkspace.grapher_waveWorkspace;c.oneShot.panic();for(var d=Object.keys(b),e=0;e<d.length;e++)void 0!=b[e]&&(clearTimeout(b[e].needleInterval),delete b[e]);a.removeAllMarks()}}},{type:"slide",name:"rate",data:{x:26.25,y:5,width:5,height:45,value:.5,resetValue:.5,style:{handle:"rgba(220,220,220,1)"},
onchange:function(a){c.oneShot.rate(2*(1-a))}}},{type:"glowbox_rect",name:"glowbox_rect",data:{x:32.5,y:5,width:2.5,height:45}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:35,y:5,width:180,height:45,selectNeedle:!1,selectionArea:!0}}]}),b=[];c.oneShot=new g._interface.circuit.alpha.oneShot_multi(g.library.audio.context);c.oneShot.out_right().connect(c.elements.connectionNode_audio.outRight.in());c.oneShot.out_left().connect(c.elements.connectionNode_audio.outLeft.in());c.i=
{};c.i.loadURL=function(a,b){c.oneShot.load("url",function(){c.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(c.oneShot.waveformSegment());void 0!=b&&b()},a)};c.i.area=function(a,b){c.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(a,b)};return c};this.oneShot_multi.metadata={name:"One Shot (Multi)",helpURL:"https://curve.metasophiea.com/help/units/alpha/oneShot_multi/"};this.oneShot_multi_multiTrack=function(d,f,e){var a={fill:"rgba(150,150,150,1)"},c={fill:"rgba(0,0,0,0)",stroke:"rgba(150,150,150,1)",
lineWidth:1},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},h={background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},k={background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},l={handle:"rgba(220,220,220,1)"};d={name:"oneShot_multi_multiTrack",
category:"audioFile",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:385},{x:0,y:385}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}}]};for(e=0;8>e;e++)d.elements=d.elements.concat([{type:"path",
name:"symbol_"+e+"_arrow",data:{points:[{x:19,y:35+47*e},{x:25,y:40+47*e},{x:19,y:45+47*e}],style:c}},{type:"rectangle",name:"symbol_"+e+"_line",data:{x:15,y:39.5+47*e,width:6,height:1,style:a}},{type:"circle",name:"symbol_"+e+"l_outerCircle",data:{x:10,y:40+47*e,r:5.5,style:c}},{type:"circle",name:"symbol_"+e+"_infCircle1",data:{x:8.5,y:40+47*e,r:1.5,style:c}},{type:"circle",name:"symbol_"+e+"_infCircle2",data:{x:11.5,y:40+47*e,r:1.5,style:c}}]),d.elements.push({type:"slide",name:"rate_"+e,data:{x:26.25,
y:5+47*e,width:5,height:45,value:.5,resetValue:.5,style:l,onchange:function(a){return function(b){m.oneShot_multi_array[a].rate(2*(1-b))}}(e)}}),d.elements.push({type:"glowbox_rect",name:"glowbox_rect_"+e,data:{x:32.5,y:5+47*e,width:2.5,height:45}}),d.elements.push({type:"grapher_waveWorkspace",name:"grapher_waveWorkspace_"+e,data:{x:35,y:5+47*e,width:180,height:45,selectNeedle:!1,selectionArea:!0}}),d.elements.push({type:"button_rect",name:"loadFile_"+e,data:{x:5,y:5+47*e,width:20,height:10,style:b,
onpress:function(a){return function(){m.oneShot_multi_array[a].load("file",function(a){return function(b){m.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a].draw(m.oneShot_multi_array[a].waveformSegment())}}(a))}}(e)}}),d.elements.push({type:"button_rect",name:"fire_"+e,data:{x:5,y:17.5+47*e,width:10,height:10,style:h,onpress:function(a){return function(){var b=m.oneShot_multi_array[a],c=m.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a],d=m.players[a];if(!(0>b.duration())){var e=
void 0!=c.area().A?c.area().A:0,f=void 0!=c.area().B?c.area().B:1;if(e>f){var g=e;e=f;f=g}g=b.duration();e*=g;f=f*g-e;b.fire(e,f);for(var h=0;h in d;)h++;d[h]={};m.elements.glowbox_rect["glowbox_rect_"+a].on();setTimeout(function(a){return function(){m.elements.glowbox_rect["glowbox_rect_"+a].off()}}(a),100);d[h].previousPosition=void 0;d[h].currentPosition=e/g;d[h].endPosition=e/g+f/g;var k=10/(1E3*f);d[h].needleInterval=setInterval(function(){void 0!=d[h].previousPosition&&c.mark(d[h].currentPosition);
d[h].previousPosition=d[h].currentPosition;d[h].currentPosition+=k;c.mark(d[h].currentPosition);d[h].currentPosition>d[h].endPosition&&(c.mark(d[h].currentPosition),clearInterval(d[h].needleInterval))},10)}}}(e)}}),d.elements.push({type:"button_rect",name:"panic_"+e,data:{x:15,y:17.5+47*e,width:10,height:10,style:k,onpress:function(a){return function(b){b=m.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a];var c=m.players[a];m.oneShot_multi_array[a].panic();for(var d=Object.keys(c),e=0;e<
d.length;e++)void 0!=c[e]&&(clearTimeout(c[e].needleInterval),delete c[e]);b.removeAllMarks()}}(e)}}),d.elements.push({type:"connectionNode_data",name:"trigger_"+e,data:{x:220,y:17.5+47*e,width:10,height:20,onreceive:function(a){return function(b,c){"pulse"==b?(m.elements.button_rect["fire_"+a].press(),m.elements.button_rect["fire_"+a].release()):"hit"==b&&.49<c.velocity&&(m.elements.button_rect["fire_"+a].press(),m.elements.button_rect["fire_"+a].release())}}(e)}});var m=r.builder(this.oneShot_multi_multiTrack,
d);m.exportData=function(){for(var a={tracks:[],areas:[]},b=0;8>b;b++)a.tracks.push(m.oneShot_multi_array[b].unloadRaw()),a.areas.push(m.i.area(b));return a};m.importData=function(a){for(var b=0;8>b;b++)m.i.loadRaw(b,a.tracks[b]),m.i.area(b,a.areas[b].A,a.areas[b].B)};m.players=[];m.oneShot_multi_array=[];for(e=0;8>e;e++)m.oneShot_multi_array.push(new g._interface.circuit.alpha.oneShot_multi(g.library.audio.context)),m.oneShot_multi_array[e].out_right().connect(m.elements.connectionNode_audio.outRight.in()),
m.oneShot_multi_array[e].out_left().connect(m.elements.connectionNode_audio.outLeft.in()),m.players.push([]);m.i={loadURL:function(a,b,c){m.oneShot_multi_array[a].load("url",function(a){return function(){document.getElementById("oneShot_multi_multiTrack").children["grapher_waveWorkspace_"+a].draw(document.getElementById("oneShot_multi_multiTrack").oneShot_multi_array[a].waveformSegment())}}(a),b)},loadRaw:function(a,b){m.oneShot_multi_array[a].loadRaw(b);m.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+
a].draw(m.oneShot_multi_array[a].waveformSegment())},area:function(a,b,c){return m.elements.grapher_waveWorkspace["grapher_waveWorkspace_"+a].area(b,c)}};return m};this.oneShot_multi_multiTrack.metadata={name:"One Shot (Multi)(8 Track)",helpURL:"https://curve.metasophiea.com/help/units/alpha/oneShot_multi_multiTrack/"};this.player=function(d,f,e){function a(a){k.elements.grapher_waveWorkspace.grapher_waveWorkspace.draw(k.player.waveformSegment());k.elements.grapher_waveWorkspace.grapher_waveWorkspace.select(0);
k.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(-1,-1);k.elements.readout_sixteenSegmentDisplay__static.trackNameReadout.text(a.name);k.elements.readout_sixteenSegmentDisplay__static.trackNameReadout.print("smart")}var c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b={fill:"rgba(150,150,150,1)"},h={background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"},k=r.builder(this.player,{name:"player",category:"audioFile",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:220,y:0},
{x:220,y:80},{x:0,y:80}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:220,y:0},{x:220,y:80},{x:0,y:80}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"outRight",data:{x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",name:"outLeft",data:{x:-10,y:27.5,width:10,height:20,isAudioOutput:!0}},{type:"rectangle",name:"symbol_line1",data:{x:3.5,y:38.5,width:1,height:2,style:b}},{type:"rectangle",name:"symbol_line2",data:{x:5.5,y:37,
width:1,height:5,style:b}},{type:"rectangle",name:"symbol_line3",data:{x:7.5,y:35.5,width:1,height:8,style:b}},{type:"rectangle",name:"symbol_line4",data:{x:9.5,y:34.5,width:1,height:10,style:b}},{type:"rectangle",name:"symbol_line5",data:{x:11.5,y:35.5,width:1,height:8,style:b}},{type:"rectangle",name:"symbol_line6",data:{x:13.5,y:37,width:1,height:5,style:b}},{type:"rectangle",name:"symbol_line7",data:{x:15.5,y:39,width:1,height:1,style:b}},{type:"rectangle",name:"symbol_line8",data:{x:17.5,y:36,
width:1,height:7,style:b}},{type:"rectangle",name:"symbol_line9",data:{x:19.5,y:32,width:1,height:15,style:b}},{type:"rectangle",name:"symbol_line10",data:{x:21.5,y:34.5,width:1,height:10,style:b}},{type:"rectangle",name:"symbol_line11",data:{x:23.5,y:37,width:1,height:5,style:b}},{type:"rectangle",name:"symbol_line12",data:{x:25.5,y:38.5,width:1,height:2,style:b}},{type:"readout_sixteenSegmentDisplay__static",name:"trackNameReadout",data:{x:30,y:5,angle:0,width:100,height:20,count:10,style:h}},{type:"readout_sixteenSegmentDisplay__static",
name:"time",data:{x:135,y:5,angle:0,width:80,height:20,count:8,style:h}},{type:"button_rect",name:"load",data:{x:5,y:5,width:20,height:10,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){k.i.loadByFile()}}},{type:"button_rect",name:"start",data:{x:5,y:17.5,width:20,height:10,style:{background__up__fill:"rgba(175,195,175,1)",background__hover__fill:"rgba(220,240,220,1)",background__hover_press__fill:"rgba(150,170,150,1)"},
onpress:function(){k.player.start()}}},{type:"button_rect",name:"stop",data:{x:15,y:17.5,width:10,height:10,style:{background__up__fill:"rgba(195,175,175,1)",background__hover__fill:"rgba(240,220,220,1)",background__hover_press__fill:"rgba(170,150,150,1)"},onpress:function(){k.player.stop()}}},{type:"text",name:"rate_label_name",data:{x:8.5,y:79,text:"rate",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},{type:"text",name:"rate_label_0",data:{x:5,y:75,text:"0",style:c}},{type:"text",name:"rate_label_1",
data:{x:13.7,y:54,text:"1",style:c}},{type:"text",name:"rate_label_2",data:{x:23,y:75,text:"2",style:c}},{type:"dial_continuous",name:"rate_dial",data:{x:15,y:65,r:9,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,resetValue:.5}},{type:"grapher_waveWorkspace",name:"grapher_waveWorkspace",data:{x:30,y:30,width:185,height:45,selectionArea:!1,selectionAreaToggle:function(a){k.player.loop({active:a})}}}]});k.player=new g._interface.circuit.alpha.player(g.library.audio.context);k.player.out_right().connect(k.elements.connectionNode_audio.outRight.in());
k.player.out_left().connect(k.elements.connectionNode_audio.outLeft.in());setInterval(function(){if(k.player.isLoaded()){var a=g.library.math.seconds2time(Math.round(k.player.currentTime()));k.elements.readout_sixteenSegmentDisplay__static.time.text(g.library.misc.padString(a.h,2,"0")+":"+g.library.misc.padString(a.m,2,"0")+":"+g.library.misc.padString(a.s,2,"0"));k.elements.readout_sixteenSegmentDisplay__static.time.print();k.elements.grapher_waveWorkspace.grapher_waveWorkspace.select(k.player.progress(),
!1)}},1E3/30);k.exportData=function(){return{track:k.player.unloadRaw()}};k.importData=function(a){k.i.loadRaw(a.track)};k.elements.dial_continuous.rate_dial.onchange=function(a){k.player.rate(2*a)};k.elements.grapher_waveWorkspace.grapher_waveWorkspace.onchange=function(a,b){if("lead"==a)k.player.jumpTo(b);else if("selection_A"==a||"selection_B"==a)a=k.elements.grapher_waveWorkspace.grapher_waveWorkspace.area(),a.A<a.B?k.player.loop({start:a.A,end:a.B}):k.player.loop({start:a.B,end:a.A})};k.i={loadRaw:function(b){k.player.loadRaw(b,
a)},loadByFile:function(){k.player.load("file",a)},loadByURL:function(b){k.player.load("url",a,b)}};k.elements.dial_continuous.rate_dial.set(.5);return k};this.player.metadata={name:"Player",helpURL:"https://curve.metasophiea.com/help/units/alpha/player/"}};this.humanInputDevices=new function(){this.audioIn=function(d,f,e,a){function c(a){if(0==b.deviceList.length)t.elements.readout_sixteenSegmentDisplay__static.index.text(" n/a"),t.elements.readout_sixteenSegmentDisplay__static.index.print(),t.elements.readout_sixteenSegmentDisplay__static.text.text("no devices"),
t.elements.readout_sixteenSegmentDisplay__static.text.print("smart");else if(!(0>a||a>=b.deviceList.length)){b.currentSelection=a;for(selectionNum=""+(a+1);2>selectionNum.length;)selectionNum="0"+selectionNum;for(totalNum=""+b.deviceList.length;2>totalNum.length;)totalNum="0"+totalNum;t.elements.readout_sixteenSegmentDisplay__static.index.text(selectionNum+"/"+totalNum);t.elements.readout_sixteenSegmentDisplay__static.index.print();var c=b.deviceList[a].deviceId;0<b.deviceList[a].label.length&&(c=
b.deviceList[a].label+" - "+c);t.elements.readout_sixteenSegmentDisplay__static.text.text(c);t.elements.readout_sixteenSegmentDisplay__static.text.print("smart");t.circuitry.unit.selectDevice(b.deviceList[a].deviceId)}}a=void 0===a?!0:a;var b={deviceList:[],currentSelection:0},h={stroke:"rgb(160,160,160)",lineWidth:1},k={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},l={background:"rgb(0,0,0)",glow:"rgb(200,200,200)",dim:"rgb(20,20,20)"},m={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(230,230,230,1)",
background__hover_press__fill:"rgba(180,180,180,1)"},t=r.builder(this.audioIn,{name:"audioIn",category:"humanInputDevices",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},{x:50,y:40},{x:37.5,y:50},{x:22.5,y:50},{x:10,y:40},{x:0,y:40}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:10},{x:22.5,y:0},{x:37.5,y:0},{x:50,y:10},{x:245,y:10},{x:245,y:40},{x:50,y:40},{x:37.5,y:50},{x:22.5,y:50},{x:10,y:40},
{x:0,y:40}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioOut",data:{x:-10,y:15,width:10,height:20,isAudioOutput:!0}},{type:"readout_sixteenSegmentDisplay__static",name:"index",data:{x:70,y:15,angle:0,width:50,height:20,count:5,style:l}},{type:"readout_sixteenSegmentDisplay__static",name:"text",data:{x:122.5,y:15,angle:0,width:100,height:20,count:10,style:l}},{type:"button_rect",name:"up",data:{x:225,y:15,width:15,height:10,selectable:!1,style:m,onpress:function(){c(b.currentSelection+
1)}}},{type:"button_rect",name:"down",data:{x:225,y:25,width:15,height:10,selectable:!1,style:m,onpress:function(){c(b.currentSelection-1)}}},{type:"text",name:"gainLabel_name",data:{x:21.25,y:44,text:"gain",style:{fill:"rgba(0,0,0,1)",font:"5pt Courier New"},angle:0}},{type:"text",name:"gainLabel_0",data:{x:17,y:39,text:"0",style:k,angle:0}},{type:"text",name:"gainLabel_1",data:{x:28.75,y:10,text:"1",style:k,angle:0}},{type:"text",name:"gainLabel_2",data:{x:40.5,y:39,text:"2",style:k,angle:0}},{type:"dial_continuous",
name:"outputGain",data:{x:30,y:25,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},resetValue:.5}},{type:"path",name:"upArrow",data:{points:[{x:227.5,y:22.5},{x:232.5,y:17.5},{x:237.5,y:22.5}],style:h}},{type:"path",name:"downArrow",data:{points:[{x:227.5,y:27.5},{x:232.5,y:32.5},{x:237.5,y:27.5}],style:h}},{type:"audio_meter_level",name:"audioIn",data:{x:50,y:15,width:17.5,height:20}}]});t.onkeydown=function(a,
b,c){switch(c.key){case "ArrowUp":t.elements.button_rect.up.press();break;case "ArrowDown":t.elements.button_rect.down.press();break;case "ArrowLeft":t.elements.dial_continuous.outputGain.set(t.elements.dial_continuous.outputGain.get()-.1);break;case "ArrowRight":t.elements.dial_continuous.outputGain.set(t.elements.dial_continuous.outputGain.get()+.1)}};t.circuitry={unit:new g._interface.circuit.alpha.audioIn(g.library.audio.context,a)};t.circuitry.unit.out().connect(t.elements.connectionNode_audio.audioOut.in());
t.circuitry.unit.out().connect(t.elements.audio_meter_level.audioIn.audioIn());t.elements.dial_continuous.outputGain.onchange=function(a){t.circuitry.unit.gain(2*a)};t.circuitry.unit.listDevices(function(a){b.deviceList=a});a&&setTimeout(function(){c(0)},500);t.elements.dial_continuous.outputGain.set(.5);t.elements.audio_meter_level.audioIn.start();return t};this.audioIn.metadata={name:"Audio Input",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioInput/"};this.musicalKeyboard=function(d,
f,e){var a=.5,c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b={background__up__fill:"rgba(250,250,250,1)",background__press__fill:"rgba(230,230,230,1)",background__glow__fill:"rgba(220,200,220,1)",background__glow_press__fill:"rgba(200,150,200,1)"},h={background__up__fill:"rgba(50,50,50,1)",background__press__fill:"rgba(100,100,100,1)",background__glow__fill:"rgba(220,200,220,1)",background__glow_press__fill:"rgba(200,150,200,1)"};d={name:"musicalKeyboard",category:"humanInputDevices",collection:"alpha",
x:d,y:f,a:e,space:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},{x:0,y:62.5}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:320,y:0},{x:320,y:62.5},{x:0,y:62.5}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"midiout",data:{x:-5,y:5,width:5,height:10}},{type:"connectionNode_data",name:"midiin",data:{x:320,y:5,width:5,height:10,onreceive:function(a,b){"midinumber"==a&&(0<b.velocity?m.elements.button_rect[g.library.audio.num2name(b.num)].press():m.elements.button_rect[g.library.audio.num2name(b.num)].release())}}},
{type:"text",name:"velocity_title",data:{x:5,y:59,text:"velocity",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},{type:"text",name:"velocity_0",data:{x:4,y:55,text:"0",style:c}},{type:"text",name:"velocity_1/2",data:{x:14,y:26.5,text:"1/2",style:c}},{type:"text",name:"velocity_1",data:{x:29,y:55,text:"1",style:c}},{type:"dial_continuous",name:"velocity_dial",data:{x:17.5,y:42,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,resetValue:.5,value:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",
needle:"rgba(250,150,150,1)"},onchange:function(b){a=b}}}]};var k="\\azsxcfvgbhnmk,l./1q2w3er5t6yu8i9o0p[".split(""),l="4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C".split(" ");c=35;f=45;for(e=0;e<k.length;e++)"#"!=l[e].slice(-1)&&(d.elements.push({type:"button_rect",name:l[e],data:{x:c,y:12.5,width:12.5,height:50,hoverable:!1,style:b,onpress:function(){m.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),
velocity:a})},onrelease:function(){m.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),velocity:0})}}}),c+=12.5);for(e=b=0;e<k.length;e++)"#"==l[e].slice(-1)?(d.elements.push({type:"button_rect",name:l[e],data:{x:f,y:12.5,width:5,height:30,hoverable:!1,style:h,onpress:function(){m.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),velocity:a})},onrelease:function(){m.io.data.midiout.send("midinumber",{num:g.library.audio.name2num(this.name),velocity:0})}}}),
f+=12.5,b=0):b++,1<b&&(f+=12.5);var m=r.builder(this.musicalKeyboard,d);m.onkeydown=function(a,b,c){k.includes(c.key)&&m.elements.button_rect[l[k.indexOf(c.key)]].press()};m.onkeyup=function(a,b,c){k.includes(c.key)&&m.elements.button_rect[l[k.indexOf(c.key)]].release()};m.i={velocity:function(a){m.elements.dial_continuous.velocity.set(a)}};return m};this.musicalKeyboard.metadata={name:"Musical Keyboard",helpURL:"https://curve.metasophiea.com/help/units/alpha/musicalKeyboard/"}};this.humanOutputDevices=
new function(){this.audioScope=function(d,f,e){var a={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},c=r.builder(this.audioScope,{name:"audioScope",category:"humanOutputDevices",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:195,y:0},{x:195,y:110},{x:0,y:110}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"input",data:{x:195,y:5,width:10,height:20}},{type:"grapher_audioScope__static",
name:"waveport",data:{x:5,y:5,width:150,height:100}},{type:"button_rect",name:"holdKey",data:{x:160,y:5,width:30,height:20,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(190,190,190,1)",background__hover_press__fill:"rgba(170,170,170,1)"}}},{type:"text",name:"framerate_name",data:{x:161.5,y:68,text:"framerate",style:{fill:"rgba(0,0,0,1)",font:"4pt Courier New"}}},{type:"text",name:"framerate_1",data:{x:162,y:62,text:"1",style:a}},{type:"text",name:"framerate_15",data:{x:172.5,
y:32,text:"15",style:a}},{type:"text",name:"framerate_30",data:{x:186,y:62,text:"30",style:a}},{type:"dial_continuous",name:"framerate",data:{x:175,y:47.5,r:12,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}]});c.elements.button_rect.holdKey.onpress=function(){c.elements.grapher_audioScope__static.waveport.stop()};c.elements.button_rect.holdKey.onrelease=function(){c.elements.grapher_audioScope__static.waveport.start()};c.elements.connectionNode_audio.input.out().connect(c.elements.grapher_audioScope__static.waveport.getNode());
c.elements.dial_continuous.framerate.onchange=function(a){c.elements.grapher_audioScope__static.waveport.refreshRate(1+Math.floor(29*a))};c.elements.grapher_audioScope__static.waveport.start();c.elements.dial_continuous.framerate.set(0);return c};this.audioScope.metadata={name:"Audio Scope",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioScope/"};this.audioSink=function(d,f,e){var a={backing:"rgba(10,10,10,1)",levels:["rgb(250,250,250)","rgb(200,200,200)"],markingStyle_fill:"rgba(220,220,220,1)",
markingStyle_font:"1pt Courier New"};d=r.builder(this.audioSink,{name:"audioSink",category:"humanOutputDevices",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:30,y:0},{x:30,y:55},{x:0,y:55}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:30,y:0},{x:30,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioInput_right",data:{x:30,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"audioInput_left",data:{x:30,y:30,width:10,height:20}},
{type:"audio_meter_level",name:"audioLevel_right",data:{x:15,y:5,width:10,height:45,style:a}},{type:"audio_meter_level",name:"audioLevel_left",data:{x:5,y:5,width:10,height:45,style:a}}]});e=g.library.audio.destination;f=new ChannelMergerNode(g.library.audio.context,{numberOfInputs:2});d.elements.connectionNode_audio.audioInput_left.out().connect(d.elements.audio_meter_level.audioLevel_left.audioIn());d.elements.connectionNode_audio.audioInput_right.out().connect(d.elements.audio_meter_level.audioLevel_right.audioIn());
d.elements.connectionNode_audio.audioInput_left.out().connect(f,0,0);d.elements.connectionNode_audio.audioInput_right.out().connect(f,0,1);f.connect(e);d.elements.audio_meter_level.audioLevel_left.start();d.elements.audio_meter_level.audioLevel_right.start();return d};this.audioSink.metadata={name:"Audio Sink",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioSink/"}};this.sequencers=new function(){this.basicSequencer=function(d,f,e){var a={stroke:"rgba(150,150,150,1)",lineWidth:1},c={background__up__fill:"rgba(220,220,220,1)",
background__hover__fill:"rgba(240,240,240,1)",background__hover_press__fill:"rgba(180,180,180,1)"};d={name:"basicSequencer",category:"sequencers",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:{fill:"rgba(200,200,200,1)"}}},{type:"sequencer",name:"main",data:{x:10,y:20,width:780,height:170,xCount:64,
yCount:10,event:function(a){for(var c=0;c<a.length;c++)b.elements.connectionNode_data["output_"+a[c].line].send("hit",{velocity:a[c].strength})},onchangeviewarea:function(a){b.elements.rangeslide.viewselect.set({start:a.left,end:a.right},!1)}}},{type:"rangeslide",name:"viewselect",data:{x:10,y:20,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:1,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",invisibleHandle:"rgba(0,0,0,0)",span:"rgba(220,220,220,1)"}}},
{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"rgba(229, 229, 229,1)",check:"rgba(252,252,252,1)"},onchange:function(a){b.elements.sequencer.main.automove(a)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"rgba(229, 221, 112,1)",check:"rgba(252,244,128,1)"},onchange:function(a){b.elements.sequencer.main.loopActive(a)}}},{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/
2,handleHeight:.015625,spanWidth:.75,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",span:"rgba(255,247,145,0.5)"}}},{type:"connectionNode_data",name:"progress_input",data:{x:800,y:5,width:5,height:20,onreceive:function(){b.elements.sequencer.main.progress()}}},{type:"button_rect",name:"progress_button",data:{x:10,y:205,width:25,height:15,style:c,onpress:function(){b.elements.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{points:[{x:20,
y:209},{x:25,y:212.5},{x:20,y:216}],style:a}},{type:"connectionNode_data",name:"reset_input",data:{x:800,y:30,width:5,height:20,onreceive:function(){b.elements.sequencer.main.playheadPosition(0)}}},{type:"button_rect",name:"reset_button",data:{x:40,y:205,width:25,height:15,style:c,onpress:function(){b.elements.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{points:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:a}},{type:"path",name:"reset_line",data:{points:[{x:49,y:209},
{x:49,y:216}],style:a}}]};for(e=0;10>e;e++)d.elements.push({type:"connectionNode_data",name:"output_"+e,data:{x:-5,y:11+18*e,width:5,height:16,onreceive:function(){b.elements.sequencer.main.playheadPosition(0)}}});var b=r.builder(this.basicSequencer,d);b.elements.rangeslide.viewselect.onchange=function(a){b.elements.sequencer.main.viewarea({topLeft:{x:a.start,y:0},bottomRight:{x:a.end,y:1}},!1)};b.elements.rangeslide.loopSelect.onchange=function(a){var c=Math.round(64*a.start);a=Math.round(64*a.end);
0==a&&(a=1);b.elements.sequencer.main.loopPeriod(c,a)};b.exportData=function(){return{loop:{active:b.elements.checkbox_rect.loopActive.get(),range:b.elements.rangeslide.loopSelect.get()},autofollow:b.elements.checkbox_rect.followPlayhead.get(),notes:b.elements.sequencer.main.getAllSignals(),viewarea:{horizontal:b.elements.rangeslide.viewselect.get()}}};b.importData=function(a){b.elements.sequencer.main.addSignals(a.notes);b.i.loopActive(a.loop.active);b.elements.rangeslide.loopSelect.set(a.loop.range);
b.elements.checkbox_rect.followPlayhead.set(a.autofollow);b.elements.rangeslide.viewselect.set(a.viewarea.horizontal)};b.i={addNote:function(a,c,d,e){b.elements.sequencer.main.addSignal(a,c,d,void 0===e?1:e)},addNotes:function(a){b.elements.sequencer.main.addSignal(a)},getNotes:function(){return b.elements.sequencer.main.getAllSignals()},loopActive:function(a){b.elements.checkbox_rect.loopActive.set(a)},step:b.elements.sequencer.step};return b};this.basicSequencer.metadata={name:"Basic Sequencer (Multi Pulse Out)",
helpURL:"https://curve.metasophiea.com/help/units/alpha/basicSequencer_pulseOut/"};this.launchpad=function(d,f,e){function a(){for(var a=0;a<c.yCount;a++)k.elements.rastorgrid.rastorgrid.light(k.internalCircuits.previousPosition(),a,!1),k.elements.rastorgrid.rastorgrid.light(k.internalCircuits.position(),a,!0)}var c={xCount:8,yCount:8},b={background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},g={backing:"rgba(200,175,200,1)",
check:"rgba(150,125,150,1)",backingGlow:"rgba(225,175,225,1)",checkGlow:"rgba(200,125,200,1)"};d={name:"launchpad",category:"sequencers",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:125,y:0},{x:125,y:50},{x:100,y:60},{x:100,y:100},{x:0,y:100}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"pulse_input",data:{x:125,y:5,width:5,height:10}},{type:"connectionNode_data",
name:"nextPage_input",data:{x:125,y:22.5,width:5,height:10}},{type:"connectionNode_data",name:"prevPage_input",data:{x:125,y:35,width:5,height:10}},{type:"button_rect",name:"pulse_button",data:{x:100,y:5,width:20,height:10,style:b}},{type:"rectangle",name:"rastorBacking",data:{x:5,y:5,width:90,height:90,style:{fill:g.backing}}},{type:"rastorgrid",name:"rastorgrid",data:{x:5,y:5,width:90,height:90,xCount:c.xCount,yCount:c.yCount,style:g}},{type:"sevenSegmentDisplay",name:"pageNumber",data:{x:100,y:22.5,
width:20,height:22.5,style:b}},{type:"button_rect",name:"nextPage",data:{x:102.5,y:17.5,width:15,height:5,style:b}},{type:"button_rect",name:"prevPage",data:{x:102.5,y:45,width:15,height:5,style:b}}]};for(e=0;e<c.yCount;e++)d.elements.push({type:"connectionNode_data",name:"out_"+e,data:{x:-5,y:12.5*e+2.5,width:5,height:7.5}});var k=r.builder(this.launchpad,d);k.exportData=function(){return{currentPage:k.internalCircuits.page(),data:k.internalCircuits.exportPages()}};k.importData=function(a){void 0!=
a.data&&k.internalCircuits.importPages(a.data);a.currentPage&&k.internalCircuits.page(a.currentPage)};k.internalCircuits=new this.launchpad.sequencer(c.xCount,c.yCount);k.internalCircuits.commands=function(a){for(var b=0;b<c.yCount;b++)a[b]&&k.io["out_"+b].send("pulse")};k.internalCircuits.pageChange=function(a){k.elements.sevenSegmentDisplay.pageNumber.enterCharacter(""+a);a=k.internalCircuits.exportPage();void 0==a?k.elements.rastorgrid.rastorgrid.clear():k.elements.rastorgrid.rastorgrid.set(a)};
k.elements.connectionNode_data.pulse_input.onreceive=function(){k.internalCircuits.inc();a()};k.elements.connectionNode_data.nextPage_input.onreceive=function(){k.internalCircuits.incPage()};k.elements.connectionNode_data.prevPage_input.onreceive=function(){k.internalCircuits.decPage()};k.elements.button_rect.pulse_button.onreceive=function(){k.internalCircuits.inc();a()};k.elements.rastorgrid.rastorgrid.onchange=function(a){k.internalCircuits.importPage(a)};k.elements.button_rect.nextPage.onpress=
function(){k.internalCircuits.incPage()};k.elements.button_rect.prevPage.onpress=function(){k.internalCircuits.decPage()};k.i={importPage:function(a,b){k.internalCircuits.importPage(a,b)},exportPage:function(a){return k.internalCircuits.exportPage(a)},importPages:function(a){k.internalCircuits.importPages(a)},exportPages:function(){return k.internalCircuits.exportPages()},setPage:function(a){k.internalCircuits.page(a)}};a();k.elements.sevenSegmentDisplay.pageNumber.enterCharacter("0");return k};this.launchpad.metadata=
{name:"Launchpad",helpURL:"https://curve.metasophiea.com/help/units/alpha/launchpad/"};this.launchpad.sequencer=function(d,f){var e=[],a=0,c=0,b=d-1;this.square=function(b,c,g){0>b?b=0:b>d-1&&(b=d-1);0>c?c=0:b>f-1&&(b=f-1);if(void 0==g)return e[a][c][b];e[a][c][b]=g};this.line=function(b,d){if(void 0==d){d=[];for(b=0;b<f;b++)void 0==e[a]||void 0==e[a][b]||void 0==e[a][b][c]?d.push(!1):d.push(e[a][b][c]);return d}for(b=0;b<f;b++)e[a][b][c]=d[b]};this.position=function(a,e){if(void 0==a)return c;b=
c;a>d-1?a=0:0>a&&(a=d-1);c=a;(void 0===e||e)&&this.commands(this.line())};this.previousPosition=function(){return b};this.inc=function(){this.position(c+1)};this.dec=function(){this.position(c-1)};this.page=function(b){if(void 0==b)return a;-1==b?b=9:0>b?b=0:10==b?b=0:10<=b&&(b=9);a=b;void 0!=this.pageChange&&this.pageChange(a)};this.incPage=function(){this.page(a+1)};this.decPage=function(){this.page(a-1)};this.exportPages=function(){return JSON.parse(JSON.stringify(e))};this.importPages=function(b){e=
b;this.pageChange(a)};this.exportPage=function(b){void 0==b&&(b=a);return void 0==e[b]?Array(d).fill(Array(f).fill(!1)):JSON.parse(JSON.stringify(e[b]))};this.importPage=function(b,c){void 0==c&&(c=a);e[c]=b;void 0!=this.pageChange&&this.pageChange(a)};this.commands=function(){};this.pageChange=function(){}};this.basicSequencer_midiOut=function(d,f,e){var a=void 0,c=[0,0,1,0,1,0,1,0,0,1,0,1];a=108;var b=c.length-"C C# D D# E F F# G G# A A# B".split(" ").indexOf(g.library.audio.num2name(131).slice(1));
c=c.slice(b).concat(c.slice(0,b));b={stroke:"rgba(150,150,150,1)",lineWidth:1};var h={handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",invisibleHandle:"rgba(0,0,0,0)",span:"rgba(220,220,220,1)"},k={background__up__fill:"rgba(220,220,220,1)",background__hover__fill:"rgba(240,240,240,1)",background__hover_press__fill:"rgba(180,180,180,1)"},l=r.builder(this.basicSequencer,{name:"basicSequencer_midiOut",category:"sequencers",collection:"alpha",x:d,y:f,a:e,space:[{x:0,
y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:800,y:0},{x:800,y:210},{x:140,y:210},{x:115,y:225},{x:0,y:225}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"midiout",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"sequencer",name:"main",data:{x:20,y:20,width:770,height:170,xCount:64,yCount:a,horizontalStripStyle_pattern:c,event:function(a){for(var b=0;b<a.length;b++)l.elements.connectionNode_data.midiout.send("midinumber",
{num:131-a[b].line,velocity:a[b].strength})},onchangeviewarea:function(a){l.elements.rangeslide.viewselect.set({start:a.left,end:a.right},!1)}}},{type:"rangeslide",name:"viewselect_y",data:{x:10,y:20,height:170,width:10,angle:0,handleHeight:.0625,spanWidth:1,style:h}},{type:"rangeslide",name:"viewselect_x",data:{x:20,y:20,height:770,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:1,style:h}},{type:"checkbox_rect",name:"followPlayhead",data:{x:100,y:205,width:15,height:15,style:{backing:"rgba(229, 229, 229,1)",
check:"rgba(252,252,252,1)"},onchange:function(a){l.elements.sequencer.main.automove(a)}}},{type:"checkbox_rect",name:"loopActive",data:{x:70,y:205,width:25,height:15,style:{backing:"rgba(229, 221, 112,1)",check:"rgba(252,244,128,1)"},onchange:function(a){l.elements.sequencer.main.loopActive(a)}}},{type:"rangeslide",name:"loopSelect",data:{x:10,y:200,height:780,width:10,angle:-Math.PI/2,handleHeight:.015625,spanWidth:.75,style:{handle:"rgba(240,240,240,1)",backing:"rgba(150,150,150,1)",slot:"rgba(50,50,50,1)",
span:"rgba(255,247,145,0.5)"}}},{type:"connectionNode_data",name:"progress_input",data:{x:800,y:5,width:5,height:20,onreceive:function(){l.elements.sequencer.main.progress()}}},{type:"button_rect",name:"progress_button",data:{x:10,y:205,width:25,height:15,style:k,onpress:function(){l.elements.sequencer.main.progress()}}},{type:"path",name:"progress_arrow",data:{points:[{x:20,y:209},{x:25,y:212.5},{x:20,y:216}],style:b}},{type:"connectionNode_data",name:"reset_input",data:{x:800,y:30,width:5,height:20,
onreceive:function(){l.elements.sequencer.main.playheadPosition(0)}}},{type:"button_rect",name:"reset_button",data:{x:40,y:205,width:25,height:15,style:k,onpress:function(){l.elements.sequencer.main.playheadPosition(0)}}},{type:"path",name:"reset_arrow",data:{points:[{x:55,y:209},{x:50,y:212.5},{x:55,y:216}],style:b}},{type:"path",name:"reset_line",data:{points:[{x:49,y:209},{x:49,y:216}],style:b}}]});l.elements.rangeslide.viewselect_y.onchange=function(a){l.elements.sequencer.main.viewarea({topLeft:{y:a.start},
bottomRight:{y:a.end}},!1)};l.elements.rangeslide.viewselect_x.onchange=function(a){l.elements.sequencer.main.viewarea({topLeft:{x:a.start},bottomRight:{x:a.end}},!1)};l.elements.rangeslide.loopSelect.onchange=function(a){var b=Math.round(64*a.start);a=Math.round(64*a.end);0==a&&(a=1);l.elements.sequencer.main.loopPeriod(b,a)};l.exportData=function(){return{loop:{active:l.elements.checkbox_rect.loopActive.get(),range:l.elements.rangeslide.loopSelect.get()},autofollow:l.elements.checkbox_rect.followPlayhead.get(),
notes:l.elements.sequencer.main.getAllSignals(),viewarea:{horizontal:l.elements.rangeslide.viewselect_y.get(),vertical:l.elements.rangeslide.viewselect_x.get()}}};l.importData=function(a){l.elements.sequencer.main.addSignals(a.notes);l.i.loopActive(a.loop.active);l.elements.rangeslide.loopSelect.set(a.loop.range);l.elements.checkbox_rect.followPlayhead.set(a.autofollow);l.elements.rangeslide.viewselect_y.set(a.viewarea.horizontal);l.elements.rangeslide.viewselect_x.set(a.viewarea.vertical)};l.i={addNote:function(a,
b,c,d){l.elements.sequencer.main.addSignal(131-a,b,c,void 0===d?1:d)},addNotes:function(a){for(var b=0;b<a.length;b++)this.addSignal(a[b].line,a[b].position,a[b].length,a[b].strength)},getNotes:function(){return l.elements.sequencer.main.getAllSignals()},loopActive:function(a){l.elements.checkbox_rect.loopActive.set(a)},step:l.elements.sequencer.step};l.elements.rangeslide.viewselect_y.set({start:.3,end:.7});return l};this.basicSequencer_midiOut.metadata={name:"Basic Sequencer (Midi Out)",helpURL:"https://curve.metasophiea.com/help/units/alpha/basicSequencer_midiOut/"}};
this.synthesizers=new function(){this.basicSynthesizer=function(d,f,e){var a={fill:"rgba(0,0,0,1)",font:"4pt Courier New"},c={fill:"rgba(0,0,0,1)",font:"3pt Courier New"},b={fill:"rgba(50,50,50,1)"},h=r.builder(this.basicSynthesizer,{name:"basicSynthesizer",category:"synthesizers",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},{x:0,y:0}],elements:[{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:240,y:0},{x:240,y:40},{x:190,y:90},{x:0,y:90},
{x:0,y:0}],style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_audio",name:"audioOut",data:{type:1,x:-15,y:5,width:15,height:30,isAudioOutput:!0}},{type:"connectionNode_data",name:"port_gain",data:{x:12.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":h.elements.dial_continuous.gain.set(b);break;case "%t":h.__synthesizer.gain(b.target,b.time,b.curve),h.elements.dial_continuous.gain.smoothSet(b.target,b.time,b.curve,!1)}}}},{type:"connectionNode_data",name:"port_attack",
data:{x:52.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&h.elements.dial_continuous.attack.set(b)}}},{type:"connectionNode_data",name:"port_release",data:{x:92.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"%"==a&&h.elements.dial_continuous.release.set(b)}}},{type:"connectionNode_data",name:"port_detune",data:{x:132.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){switch(a){case "%":h.elements.dial_continuous.detune.set(b);break;case "%t":h.__synthesizer.detune(200*b.target+
-100,b.time,b.curve),h.elements.dial_continuous.detune.smoothSet(b.target,b.time,b.curve,!1)}}}},{type:"connectionNode_data",name:"port_octave",data:{x:170.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&h.elements.dial_discrete.octave.select(b)}}},{type:"connectionNode_data",name:"port_waveType",data:{x:210.5,y:-7.5,width:15,height:7.5,onreceive:function(a,b){"discrete"==a&&h.elements.dial_discrete.waveType.select(b)}}},{type:"connectionNode_data",name:"port_periodicWave",data:{x:240,
y:12.5,width:7.5,height:15,onreceive:function(a,b){"periodicWave"==a&&h.__synthesizer.periodicWave(b)}}},{type:"connectionNode_data",name:"port_midiNote",data:{x:225,y:55,width:15,height:30,angle:Math.PI/4,onreceive:function(a,b){"midinumber"==a&&h.__synthesizer.perform(b)}}},{type:"connectionNode_data",name:"port_gainWobblePeriod",data:{x:22.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&h.elements.dial_continuous.gainWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_gainWobbleDepth",
data:{x:57.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&h.elements.dial_continuous.gainWobbleDepth.set(b)}}},{type:"connectionNode_data",name:"port_detuneWobblePeriod",data:{x:107.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&h.elements.dial_continuous.detuneWobblePeriod.set(b)}}},{type:"connectionNode_data",name:"port_detuneWobbleDepth",data:{x:142.5,y:90,width:15,height:7.5,onreceive:function(a,b){"%"==a&&h.elements.dial_continuous.detuneWobbleDepth.set(b)}}},{type:"text",
name:"gain_gain",data:{x:13,y:43,text:"gain",size:a.size,style:a}},{type:"text",name:"gain_0",data:{x:7,y:37,text:"0",size:c.size,style:c}},{type:"text",name:"gain_1/2",data:{x:16.5,y:8,text:"1/2",size:c.size,style:c}},{type:"text",name:"gain_1",data:{x:31,y:37,text:"1",size:c.size,style:c}},{type:"dial_continuous",name:"dial_gain",data:{x:20,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:b.fill,needle:"rgba(250,150,150,1)"}}},
{type:"text",name:"attack_gain",data:{x:50,y:43,text:"attack",size:a.size,style:a}},{type:"text",name:"attack_0",data:{x:47,y:37,text:"0",size:c.size,style:c}},{type:"text",name:"attack_5",data:{x:58.75,y:8,text:"5",size:c.size,style:c}},{type:"text",name:"attack_10",data:{x:71,y:37,text:"10",size:c.size,style:c}},{type:"dial_continuous",name:"dial_attack",data:{x:60,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:b.fill,
needle:"rgba(250,150,150,1)"}}},{type:"text",name:"release_gain",data:{x:89,y:43,text:"release",style:a}},{type:"text",name:"release_0",data:{x:87,y:37,text:"0",size:c.size,style:c}},{type:"text",name:"release_5",data:{x:98.75,y:8,text:"5",size:c.size,style:c}},{type:"text",name:"release_10",data:{x:111,y:37,text:"10",size:c.size,style:c}},{type:"dial_continuous",name:"dial_release",data:{x:100,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",
slot:b.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"detune_gain",data:{x:131,y:43,text:"detune",style:a}},{type:"text",name:"detune_-100",data:{x:122,y:37,text:"-100",style:c}},{type:"text",name:"detune_0",data:{x:138.75,y:8,text:"0",style:c}},{type:"text",name:"detune_100",data:{x:148,y:37,text:"100",style:c}},{type:"dial_continuous",name:"dial_detune",data:{x:140,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,value:.5,resetValue:.5,style:{handle:"rgba(220,220,220,1)",
slot:b.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"octave_gain",data:{x:170,y:43,text:"octave",style:a}},{type:"text",name:"octave_-3",data:{x:165,y:35,text:"-3",style:c}},{type:"text",name:"octave_-2",data:{x:161,y:24,text:"-2",style:c}},{type:"text",name:"octave_-1",data:{x:165,y:13,text:"-1",style:c}},{type:"text",name:"octave_0",data:{x:178.75,y:8,text:"0",style:c}},{type:"text",name:"octave_1",data:{x:190,y:13,text:"1",style:c}},{type:"text",name:"octave_2",data:{x:195,y:24,text:"2",
style:c}},{type:"text",name:"octave_3",data:{x:190,y:35,text:"3",style:c}},{type:"dial_discrete",name:"dial_octave",data:{x:180,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,optionCount:7,value:3,style:{handle:"rgba(220,220,220,1)",slot:b.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"waveType_gain",data:{x:214,y:43,text:"wave",style:a}},{type:"text",name:"waveType_sin",data:{x:202,y:35,text:"sin",style:c}},{type:"text",name:"waveType_tri",data:{x:199,y:21,text:"tri",style:c}},{type:"text",
name:"waveType_squ",data:{x:210,y:9,text:"squ",style:c}},{type:"text",name:"waveType_saw",data:{x:227,y:10,text:"saw",style:c}},{type:"rectangle",name:"periodicWaveType",data:{x:230,y:21.75,angle:0,width:10,height:2.5,style:b}},{type:"dial_discrete",name:"dial_waveType",data:{x:220,y:23,r:12,startAngle:3*Math.PI/4,maxAngle:5*Math.PI/4,optionCount:5,style:{handle:"rgba(220,220,220,1)",slot:b.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"gainWobble",data:{x:13,y:70,angle:-Math.PI/2,text:"gain",
style:c}},{type:"text",name:"gainWobblePeriod_gain",data:{x:23,y:84,text:"rate",style:a}},{type:"text",name:"gainWobblePeriod_0",data:{x:17,y:79,text:"0",style:c}},{type:"text",name:"gainWobblePeriod_50",data:{x:27.5,y:50,text:"50",style:c}},{type:"text",name:"gainWobblePeriod_100",data:{x:41,y:79,text:"100",style:c}},{type:"dial_continuous",name:"dial_gainWobblePeriod",data:{x:30,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:b.fill,
needle:"rgba(250,150,150,1)"}}},{type:"text",name:"gainWobbleDepth_gain",data:{x:57,y:84,text:"depth",style:a}},{type:"text",name:"gainWobbleDepth_0",data:{x:52,y:79,text:"0",style:c}},{type:"text",name:"gainWobbleDepth_50",data:{x:61,y:50,text:"1/2",style:c}},{type:"text",name:"gainWobbleDepth_100",data:{x:76,y:79,text:"1",style:c}},{type:"dial_continuous",name:"dial_gainWobbleDepth",data:{x:65,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",
slot:b.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"detuneWobble",data:{x:98,y:70,angle:-Math.PI/2,text:"detune",style:c}},{type:"text",name:"detuneWobblePeriod_gain",data:{x:108,y:84,text:"rate",style:a}},{type:"text",name:"detuneWobblePeriod_0",data:{x:101,y:79,text:"0",style:c}},{type:"text",name:"detuneWobblePeriod_50",data:{x:111.5,y:50,text:"50",style:c}},{type:"text",name:"detuneWobblePeriod_100",data:{x:125,y:79,text:"100",style:c}},{type:"dial_continuous",name:"dial_detuneWobblePeriod",
data:{x:114,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:b.fill,needle:"rgba(250,150,150,1)"}}},{type:"text",name:"detuneWobbleDepth_gain",data:{x:141,y:84,text:"depth",style:a}},{type:"text",name:"detuneWobbleDepth_0",data:{x:136,y:79,text:"0",style:c}},{type:"text",name:"detuneWobbleDepth_50",data:{x:145.5,y:50,text:"1/2",style:c}},{type:"text",name:"detuneWobbleDepth_100",data:{x:160,y:79,text:"1",style:c}},{type:"dial_continuous",
name:"dial_detuneWobbleDepth",data:{x:149,y:65,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:"rgba(220,220,220,1)",slot:b.fill,needle:"rgba(250,150,150,1)"}}},{type:"button_rect",name:"panicButton",data:{x:197.5,y:47.5,width:20,height:20,angle:Math.PI/4,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"}}}]});h.exportData=function(){return{gain:h.elements.dial_continuous.dial_gain.get(),
attack:10*h.elements.dial_continuous.dial_attack.get(),release:10*h.elements.dial_continuous.dial_release.get(),detune:100*(2*h.elements.dial_continuous.dial_detune.get()-1),octave:h.elements.dial_discrete.dial_octave.get()-3,waveType:["sine","triangle","square","sawtooth","custom"][h.elements.dial_discrete.dial_waveType.get()],gainWobble:{rate:100*h.elements.dial_continuous.dial_gainWobblePeriod.get(),depth:h.elements.dial_continuous.dial_gainWobbleDepth.get()},detuneWobble:{rate:100*h.elements.dial_continuous.dial_detuneWobblePeriod.get(),
depth:h.elements.dial_continuous.dial_detuneWobbleDepth.get()}}};h.importData=function(a){void 0!=a&&(h.elements.dial_continuous.dial_gain.set(a.gain),h.elements.dial_continuous.dial_attack.set(a.attack/10),h.elements.dial_continuous.dial_release.set(a.release/10),h.elements.dial_continuous.dial_detune.set((1+a.detune/100)/2),h.elements.dial_discrete.dial_octave.set(a.octave+3),h.elements.dial_discrete.dial_waveType.set(["sine","triangle","square","sawtooth","custom"].indexOf(a.waveType)),h.elements.dial_continuous.dial_gainWobblePeriod.set(a.gainWobble.rate/
100),h.elements.dial_continuous.dial_gainWobbleDepth.set(a.gainWobble.depth),h.elements.dial_continuous.dial_detuneWobblePeriod.set(a.detuneWobble.rate/100),h.elements.dial_continuous.dial_detuneWobbleDepth.set(a.detuneWobble.depth))};h.__synthesizer=new g._interface.circuit.alpha.synthesizer(g.library.audio.context);h.__synthesizer.out().connect(h.elements.connectionNode_audio.audioOut.in());h.elements.dial_continuous.dial_gain.onchange=function(a){h.__synthesizer.gain(a)};h.elements.dial_continuous.dial_attack.onchange=
function(a){h.__synthesizer.attack(a)};h.elements.dial_continuous.dial_release.onchange=function(a){h.__synthesizer.release(a)};h.elements.dial_continuous.dial_detune.onchange=function(a){h.__synthesizer.detune(200*a+-100)};h.elements.dial_discrete.dial_octave.onchange=function(a){h.__synthesizer.octave(a-3)};h.elements.dial_discrete.dial_waveType.onchange=function(a){h.__synthesizer.waveType(["sine","triangle","square","sawtooth","custom"][a])};h.elements.dial_continuous.dial_gainWobblePeriod.onchange=
function(a){h.__synthesizer.gainWobblePeriod(.01>1-a?.011:1-a)};h.elements.dial_continuous.dial_gainWobbleDepth.onchange=function(a){h.__synthesizer.gainWobbleDepth(a)};h.elements.dial_continuous.dial_detuneWobblePeriod.onchange=function(a){h.__synthesizer.detuneWobblePeriod(.01>1-a?.011:1-a)};h.elements.dial_continuous.dial_detuneWobbleDepth.onchange=function(a){h.__synthesizer.detuneWobbleDepth(100*a)};h.elements.button_rect.panicButton.onpress=function(){h.__synthesizer.panic()};h.i={gain:function(a){h.elements.dial_continuous.dial_gain.set(a)},
attack:function(a){h.elements.dial_continuous.dial_attack.set(a)},release:function(a){h.elements.dial_continuous.dial_release.set(a)},detune:function(a){h.elements.dial_continuous.dial_detune.set(a)},octave:function(a){h.elements.dial_discrete.dial_octave.set(a)},waveType:function(a){h.elements.dial_discrete.dial_waveType.set(a)},periodicWave:function(a){h.__synthesizer.periodicWave(a)},midiNote:function(a){h.__synthesizer.perform(a)},gainWobblePeriod:function(a){h.elements.dial_continuous.dial_gainWobblePeriod.set(a)},
gainWobbleDepth:function(a){h.elements.dial_continuous.dial_gainWobbleDepth.set(a)},detuneWobblePeriod:function(a){h.elements.dial_continuous.dial_detuneWobblePeriod.set(a)},detuneWobbleDepth:function(a){h.elements.dial_continuous.dial_detuneWobbleDepth.set(a)}};h.elements.dial_continuous.dial_gain.set(.5);h.elements.dial_continuous.dial_detune.set(.5);h.elements.dial_discrete.dial_octave.set(3);return h};this.basicSynthesizer.metadata={name:"Basic Synthesizer",helpURL:"https://curve.metasophiea.com/help/units/alpha/basicSynthesizer/"}};
this.misc=new function(){this.audio_duplicator=function(d,f,e){var a={fill:"rgba(150,150,150,1)"};d=r.builder(g._interface.unit.alpha.misc.audio_duplicator,{name:"audio_duplicator",category:"misc",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],elements:[{type:"connectionNode_audio",name:"input",data:{type:0,x:55,y:5,width:10,height:20}},{type:"connectionNode_audio",name:"output_1",data:{type:1,x:-10,y:5,width:10,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",
name:"output_2",data:{type:1,x:-10,y:30,width:10,height:20,isAudioOutput:!0}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"polygon",name:"upperArrow",data:{points:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:a}},{type:"polygon",name:"lowerArrow",data:{points:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:a}},{type:"rectangle",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:a}},{type:"rectangle",name:"vertical",
data:{x:27.5,y:15,width:2,height:25.5,style:a}},{type:"rectangle",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:a}}]});d.elements.connectionNode_audio.input.out().connect(d.elements.connectionNode_audio.output_1.in());d.elements.connectionNode_audio.input.out().connect(d.elements.connectionNode_audio.output_2.in());return d};this.audio_duplicator.metadata={name:"Audio Duplicator",helpURL:"https://curve.metasophiea.com/help/units/alpha/audioDuplicator/"};this.universalreadout=function(d,
f,e){var a={fill:"rgba(0,0,0,1)",size:.75,font:"Courier New"},c=r.builder(this.universalreadout,{name:"universalreadout",category:"misc",collection:"alpha",x:d,y:f,a:e,space:[{x:-5,y:-5},{x:10,y:-10},{x:25,y:-5},{x:30,y:10},{x:25,y:25},{x:10,y:30},{x:-5,y:25},{x:-10,y:10}],elements:[{type:"circle",name:"base",data:{x:10,y:10,r:20,style:{fill:"rgba(200,200,200,1)"}}},{type:"connectionNode_data",name:"in",data:{x:0,y:0,width:20,height:20,onreceive:function(d,e){d="address: "+d+" data: "+JSON.stringify(e);
d=l++ +"> "+d;b.unshift(d);b.length>k&&b.pop();for(d=0;d<h.length;d++)h[d].parent.remove(h[d]);h=[];for(d=0;d<b.length;d++)h[d]=g._interface.part.alpha.builder("text","universalreadout_"+d,{x:40,y:5*d,size:a.size,text:b[d],style:a}),c.append(h[d])}}}]}),b=[],h=[],k=10,l=0;return c};this.universalreadout.metadata={name:"Universal Readout",helpURL:"https://curve.metasophiea.com/help/units/alpha/universalReadout/"};this.testObject=function(d,f,e){d=r.builder(this.testObject,{name:"testObject",category:"misc",
collection:"alpha",x:d,y:f,a:e,space:[{x:-5,y:-5},{x:65,y:-5},{x:65,y:5},{x:290,y:5},{x:290,y:40},{x:615,y:40},{x:615,y:130},{x:715,y:130},{x:715,y:220},{x:255,y:220},{x:255,y:335},{x:440,y:335},{x:440,y:445},{x:-5,y:455}],elements:[{type:"rectangle",name:"testRectangle",data:{x:5,y:5,width:30,height:30,style:{fill:"rgba(255,0,0,1)"}}},{type:"circle",name:"testCircle",data:{x:20,y:55,r:15}},{type:"image",name:"testImage",data:{x:40,y:40,width:30,height:30,url:"https://t2.genius.com/unsafe/300x300/https%3A%2F%2Fimages.genius.com%2F72ee0b753f056baa410c17a6ad9fea70.588x588x1.jpg"}},
{type:"polygon",name:"testPolygon",data:{points:[{x:55,y:5},{x:70,y:35},{x:40,y:35}],style:{fill:"rgba(0,255,0,1)"}}},{type:"text",name:"testText",data:{x:7.5,y:95,text:"Hello",style:{font:"20pt Arial",fill:"rgba(150,150,255,1)"}}},{type:"path",name:"testPath",data:{points:[{x:0,y:0},{x:0,y:90},{x:2.5,y:90},{x:2.5,y:72.5},{x:75,y:72.5}]}},{type:"glowbox_rect",name:"test_glowbox_rect",data:{x:90,y:0}},{type:"sevenSegmentDisplay",name:"test_sevenSegmentDisplay",data:{x:125,y:0}},{type:"sixteenSegmentDisplay",
name:"test_sixteenSegmentDisplay",data:{x:150,y:0}},{type:"readout_sixteenSegmentDisplay",name:"test_readout_sixteenSegmentDisplay",data:{x:175,y:0}},{type:"level",name:"test_level1",data:{x:90,y:35}},{type:"meter_level",name:"test_meterLevel1",data:{x:115,y:35}},{type:"audio_meter_level",name:"test_audioMeterLevel1",data:{x:140,y:35}},{type:"rastorDisplay",name:"test_rastorDisplay1",data:{x:165,y:35}},{type:"grapher",name:"test_grapher1",data:{x:230,y:35}},{type:"grapher_periodicWave",name:"test_grapher_periodicWave1",
data:{x:355,y:35}},{type:"grapher_audioScope",name:"test_grapher_audioScope1",data:{x:480,y:35}},{type:"slide",name:"test_slide1",data:{x:0,y:110}},{type:"slidePanel",name:"test_slidePanel1",data:{x:15,y:110}},{type:"slide",name:"test_slide2",data:{x:0,y:220,angle:-Math.PI/2}},{type:"slidePanel",name:"test_slidePanel2",data:{x:0,y:305,angle:-Math.PI/2}},{type:"rangeslide",name:"test_rangeslide1",data:{x:100,y:110}},{type:"rangeslide",name:"test_rangeslide2",data:{x:100,y:220,angle:-Math.PI/2}},{type:"dial_continuous",
name:"test_dial_continuous1",data:{x:130,y:125}},{type:"dial_discrete",name:"test_dial_discrete1",data:{x:170,y:125}},{type:"button_rect",name:"test_button_rect1",data:{x:115,y:145}},{type:"list",name:"test_list1",data:{x:185,y:225,list:["space",{text_left:"item1",text_centre:"",text_right:"",function:function(){console.log("item1 function")}},{text_left:"item2",text_centre:"",text_right:"",function:function(){console.log("item2 function")}},{text_left:"item3",text_centre:"",text_right:"",function:function(){console.log("item3 function")}},
{text_left:"item4",text_centre:"",text_right:"",function:function(){console.log("item4 function")}},{text_left:"item5",text_centre:"",text_right:"",function:function(){console.log("item5 function")}},"break",{text_left:"item6",text_centre:"",text_right:"",function:function(){console.log("item6 function")}},{text_left:"item7",text_centre:"",text_right:"",function:function(){console.log("item7 function")}},{text_left:"item8",text_centre:"",text_right:"",function:function(){console.log("item8 function")}},
{text_left:"item9",text_centre:"",text_right:"",function:function(){console.log("item9 function")}},{text_left:"item10",text_centre:"",text_right:"",function:function(){console.log("item10 function")}},"break",{text_left:"item11",text_centre:"",text_right:"",function:function(){console.log("item11 function")}},{text_left:"item12",text_centre:"",text_right:"",function:function(){console.log("item12 function")}},{text_left:"item13",text_centre:"",text_right:"",function:function(){console.log("item13 function")}},
{text_left:"item14",text_centre:"",text_right:"",function:function(){console.log("item14 function")}},{text_left:"item15",text_centre:"",text_right:"",function:function(){console.log("item15 function")}},"space"]}},{type:"checkbox_rect",name:"test_checkbox_rect1",data:{x:150,y:145}},{type:"rastorgrid",name:"test_rastorgrid1",data:{x:100,y:225}},{type:"needleOverlay",name:"test_needleOverlay1",data:{x:0,y:310}},{type:"grapher_waveWorkspace",name:"test_grapher_waveWorkspace1",data:{x:0,y:375}},{type:"sequencer",
name:"test_sequencer1",data:{x:125,y:330}},{type:"connectionNode",name:"test_connectionNode1",data:{x:255,y:135}},{type:"connectionNode",name:"test_connectionNode2",data:{x:230,y:185}},{type:"connectionNode",name:"test_connectionNode3",data:{x:280,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal1",data:{x:355,y:135}},{type:"connectionNode_signal",name:"test_connectionNode_signal2",data:{x:330,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal3",data:{x:380,
y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage1",data:{x:455,y:135}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage2",data:{x:430,y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage3",data:{x:480,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data1",data:{x:555,y:135}},{type:"connectionNode_data",name:"test_connectionNode_data2",data:{x:530,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data3",data:{x:580,
y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio1",data:{x:655,y:135,isAudioOutput:!0}},{type:"connectionNode_audio",name:"test_connectionNode_audio2",data:{x:630,y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio3",data:{x:680,y:185}}]});d.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.text("hello");d.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.print();d.elements.grapher.test_grapher1.draw([0,-2,1,-1,2],
[0,.25,.5,.75,1]);d.elements.grapher.test_grapher1.draw([0,.25,1],void 0,1);d.elements.grapher_periodicWave.test_grapher_periodicWave1.updateBackground();d.elements.grapher_periodicWave.test_grapher_periodicWave1.wave({sin:[0,1,0,1/3,0,.2,0,1/7,0,1/9,0,1/11,0,1/13,0,1/15],cos:[0,0]});d.elements.grapher_periodicWave.test_grapher_periodicWave1.draw();d.elements.needleOverlay.test_needleOverlay1.select(.25);d.elements.needleOverlay.test_needleOverlay1.area(.5,.75);d.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.select(.25);
d.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.area(.5,.75);d.elements.sequencer.test_sequencer1.addSignal(0,0,10,0);d.elements.sequencer.test_sequencer1.addSignal(1,1,10,.1);d.elements.sequencer.test_sequencer1.addSignal(2,2,10,.2);d.elements.sequencer.test_sequencer1.addSignal(3,3,10,.3);d.elements.sequencer.test_sequencer1.addSignal(4,4,10,.4);d.elements.sequencer.test_sequencer1.addSignal(5,5,10,.5);d.elements.sequencer.test_sequencer1.addSignal(6,6,10,.6);d.elements.sequencer.test_sequencer1.addSignal(7,
7,10,.7);d.elements.sequencer.test_sequencer1.addSignal(8,8,10,.8);d.elements.sequencer.test_sequencer1.addSignal(9,9,10,.9);d.elements.sequencer.test_sequencer1.addSignal(10,10,10,1);return d};this.testObject.devUnit=!0;this.testObject.metadata={name:"Test Object",helpURL:"https://curve.metasophiea.com/help/units/alpha/testObject/"};this.pulseGenerator_hyper=function(d,f,e){function a(a){b.elements.readout_sixteenSegmentDisplay__static.readout.text(g.library.misc.padString(a,3," ")+"bpm");b.elements.readout_sixteenSegmentDisplay__static.readout.print();
h&&clearInterval(h);0<a&&(h=setInterval(function(){b.io.data.out.send("pulse")},60/a*1E3));b.io.data.out.send("pulse");k=a}var c={handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},b=r.builder(this.pulseGenerator_hyper,{name:"pulseGenerator_hyper",category:"misc",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],elements:[{type:"connectionNode_data",name:"out",data:{x:-5,y:11.25,width:5,
height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){b.elements.button_rect.sync.press()}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:{fill:"rgba(200,200,200,1)"}}},{type:"button_rect",name:"syncButton",data:{x:102.5,y:11.25,width:10,height:17.5,selectable:!1,style:{background__up__fill:"rgba(175,175,175,1)",background__hover__fill:"rgba(220,220,220,1)",
background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){a(k)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:c.handle,slot:c.slot,needle:c.needle,outerArc:c.arc}}},{type:"readout_sixteenSegmentDisplay__static",name:"readout",data:{x:35,y:10,width:65,height:20,count:6}}]});b.elements.dial_continuous.tempo.onchange=function(b){a(Math.round(999*b))};b.exportData=function(){return b.elements.dial_continuous.tempo.get()};
b.importData=function(a){b.elements.dial_continuous.tempo.set(a)};var h=null,k=120;b.i={setTempo:function(a){b.elements.dial_continuous.tempo.set(a)}};b.elements.dial_continuous.tempo.set(.5);return b};this.pulseGenerator_hyper.metadata={name:"Pulse Generator (Hyper)",helpURL:"https://curve.metasophiea.com/help/objectects/alpha/pulseGenerator_hyper/"};this.pulseGenerator=function(d,f,e){function a(a){b.elements.readout_sixteenSegmentDisplay__static.readout.text(g.library.misc.padString(a,3," ")+"bpm");
b.elements.readout_sixteenSegmentDisplay__static.readout.print();h&&clearInterval(h);0<a&&(h=setInterval(function(){b.io.data.out.send("pulse")},60/a*1E3));b.io.data.out.send("pulse");k=a}var c={handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"},b=r.builder(this.pulseGenerator,{name:"pulseGenerator",category:"misc",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],elements:[{type:"connectionNode_data",
name:"out",data:{x:-5,y:11.25,width:5,height:17.5}},{type:"connectionNode_data",name:"sync",data:{x:115,y:11.25,width:5,height:17.5,receive:function(){b.elements.button_rect.sync.press()}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:10},{x:10,y:0},{x:100,y:0},{x:115,y:10},{x:115,y:30},{x:100,y:40},{x:10,y:40},{x:0,y:30}],style:{fill:"rgba(200,200,200,1)"}}},{type:"button_rect",name:"syncButton",data:{x:102.5,y:11.25,width:10,height:17.5,selectable:!1,style:{background__up__fill:"rgba(175,175,175,1)",
background__hover__fill:"rgba(220,220,220,1)",background__hover_press__fill:"rgba(150,150,150,1)"},onpress:function(){a(k)}}},{type:"dial_continuous",name:"tempo",data:{x:20,y:20,r:12,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,style:{handle:c.handle,slot:c.slot,needle:c.needle,outerArc:c.arc}}},{type:"readout_sixteenSegmentDisplay__static",name:"readout",data:{x:35,y:10,width:65,height:20,count:6}}]});b.elements.dial_continuous.tempo.onchange=function(b){a(Math.round(240*b))};b.exportData=
function(){return b.elements.dial_continuous.tempo.get()};b.importData=function(a){b.elements.dial_continuous.tempo.set(a)};var h=null,k=120;b.i={setTempo:function(a){b.elements.dial_continuous.tempo.set(a)}};b.elements.dial_continuous.tempo.set(.5);return b};this.pulseGenerator.metadata={name:"Pulse Generator",helpURL:"https://curve.metasophiea.com/help/objectects/alpha/pulseGenerator/"};this.data_duplicator=function(d,f,e){var a={fill:"rgba(150,150,150,1)"},c=r.builder(this.data_duplicator,{name:"data_duplicator",
category:"misc",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:55,y:0},{x:55,y:55},{x:0,y:55}],elements:[{type:"connectionNode_data",name:"output_1",data:{x:-10,y:5,width:20,height:20}},{type:"connectionNode_data",name:"output_2",data:{x:-10,y:30,width:20,height:20}},{type:"connectionNode_data",name:"input",data:{x:45,y:5,width:20,height:20,onreceive:function(a,d){c.io.data.output_1.send(a,d);c.io.data.output_2.send(a,d)}}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:55,y:0},{x:55,
y:55},{x:0,y:55}],style:{fill:"rgba(200,200,200,1)"}}},{type:"polygon",name:"upperArrow",data:{points:[{x:10,y:11},{x:2.5,y:16},{x:10,y:21}],style:a}},{type:"polygon",name:"lowerArrow",data:{points:[{x:10,y:36},{x:2.5,y:41},{x:10,y:46}],style:a}},{type:"rectangle",name:"topHorizontal",data:{x:5,y:15,width:45,height:2,style:a}},{type:"rectangle",name:"vertical",data:{x:27.5,y:15,width:2,height:25.5,style:a}},{type:"rectangle",name:"bottomHorizontal",data:{x:5,y:40,width:24.5,height:2,style:a}}]});
return c};this.data_duplicator.metadata={name:"Data Duplicator",helpURL:"https://curve.metasophiea.com/help/units/alpha/dataDuplicator/"};this.basicMixer=function(d,f,e){var a={fill:"rgba(150,150,150,1)"},c={fill:"rgb(150,150,150)",font:"5pt Courier New"};d={name:"basicMixer",category:"misc",collection:"alpha",x:d,y:f,a:e,space:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],elements:[{type:"connectionNode_audio",name:"output_0",data:{x:-10,y:5,width:20,height:20,isAudioOutput:!0}},{type:"connectionNode_audio",
name:"output_1",data:{x:-10,y:30,width:20,height:20,isAudioOutput:!0}},{type:"polygon",name:"backing",data:{points:[{x:0,y:0},{x:100,y:0},{x:100,y:207.5},{x:0,y:207.5}],style:{fill:"rgba(200,200,200,1)"}}},{type:"text",name:"gain",data:{x:77.5,y:8,text:"gain",style:c}},{type:"text",name:"pan",data:{x:54,y:8,text:"pan",style:c}},{type:"rectangle",name:"vertical",data:{x:22.5,y:6,width:2,height:190,style:a}},{type:"rectangle",name:"overTheTop",data:{x:10,y:6,width:14,height:2,style:a}},{type:"rectangle",
name:"down",data:{x:10,y:6,width:2,height:35,style:a}},{type:"rectangle",name:"inTo0",data:{x:2,y:14,width:10,height:2,style:a}},{type:"rectangle",name:"inTo1",data:{x:2,y:39,width:10,height:2,style:a}}]};for(e=0;8>e;e++)d.elements.unshift({type:"connectionNode_audio",name:"input_"+e,data:{x:90,y:10+25*e,width:20,height:20}}),d.elements.push({type:"rectangle",name:"line_"+e,data:{x:23,y:19.1+25*e,width:75,height:2,style:a}}),d.elements.push({type:"dial_continuous",name:"gain_"+e,data:{x:85,y:20+25*
e,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}}),d.elements.push({type:"dial_continuous",name:"pan_"+e,data:{x:60,y:20+25*e,r:8,startAngle:3*Math.PI/4,maxAngle:1.5*Math.PI,arcDistance:1.2,resetValue:.5,style:{handle:"rgba(220,220,220,1)",slot:"rgba(50,50,50,1)",needle:"rgba(250,150,150,1)"}}});var b=r.builder(this.basicMixer,d);for(e=0;8>e;e++)b["splitter_"+e]=new g._interface.circuit.alpha.channelMultiplier(g.library.audio.context,
2),b.elements.connectionNode_audio["input_"+e].out().connect(b["splitter_"+e].in()),b["splitter_"+e].out(0).connect(b.elements.connectionNode_audio.output_0.in()),b["splitter_"+e].out(1).connect(b.elements.connectionNode_audio.output_1.in()),b.elements.dial_continuous["gain_"+e].onchange=function(a){return function(c){b["splitter_"+a].inGain(c)}}(e),b.elements.dial_continuous["gain_"+e].onchange=function(a){return function(c){b["splitter_"+a].outGain(0,c);b["splitter_"+a].outGain(1,1-c)}}(e);b.i=
{gain:function(a,c){b.elements.dial_continuous["gain_"+a].set(c)},pan:function(a,c){b.elements.dial_continuous["pan_"+a].set(c)}};for(e=0;8>e;e++)b.i.gain(e,.5),b.i.pan(e,.5);return b};this.basicMixer.metadata={name:"Basic Audio Mixer",helpURL:"https://curve.metasophiea.com/help/units/alpha/basicAudioMixer/"}};this.builder=function(d,f){function e(){a.space={points:Object.assign([],f.space).map(function(a){return{x:f.x+a.x,y:f.y+a.y}})};a.space.box=g.library.math.boundingBoxFromPoints(a.space.points)}
if(d){var a=g._interface.part.alpha.builder("group",f.name,{x:f.x,y:f.y,angle:f.a});a.model=f.name;a.category=f.category;a.collection=f.collection;a.creatorMethod=d;a.elements={};for(d=0;d<f.elements.length;d++)if(void 0!=a.getChildByName(f.elements[d].name))console.warn('error: part with the name "'+f.elements[d].name+'" already exists. Part:',f.elements[d],"will not be added");else{var c=g._interface.part.alpha.builder(f.elements[d].type,f.elements[d].name,f.elements[d].data);a.append(c);void 0==
a.elements[f.elements[d].type]&&(a.elements[f.elements[d].type]={});a.elements[f.elements[d].type][f.elements[d].name]=c}a.io={};[{key:"_",name:"connectionNode"},{key:"signal",name:"connectionNode_signal"},{key:"voltage",name:"connectionNode_voltage"},{key:"data",name:"connectionNode_data"},{key:"audio",name:"connectionNode_audio"}].forEach(function(b){if(a.elements[b.name])for(var c=Object.keys(a.elements[b.name]),d=0;d<c.length;d++){var e=a.elements[b.name][c[d]];void 0==a.io[b.key]&&(a.io[b.key]=
{});a.io[b.key][e.name]=e}});a.disconnectEverything=function(){for(var b=Object.keys(a.io),c=0;c<b.length;c++)for(var d=Object.keys(a.io[b[c]]),e=0;e<d.length;e++)a.io[b[c]][d[e]].disconnect()};e();for(d="spaceShape";void 0!=a.getChildByName(d);)d+=Math.floor(10*Math.random());c=g._interface.part.alpha.builder("polygon",d,{points:f.space,style:{fill:"rgba(0,0,0,0)"}});a.prepend(c);f.spaceOutline&&a.append(g._interface.part.alpha.builder("polygon",d+"Outline",{points:f.space,style:{fill:"rgba(0,0,0,0)",
stroke:"rgba(0,0,0,1)"}}));a._parameter={};a._parameter.x=a.parameter.x;a._parameter.y=a.parameter.y;a._parameter.angle=a.parameter.angle;a.parameter.x=function(b){if(void 0!=a._parameter.x(b))return a.x;f.x=b;e()};a.parameter.y=function(b){if(void 0!=a._parameter.y(b))return a.y;f.y=b;e()};a.parameter.angle=function(b){if(void 0!=a._parameter.angle(b))return a.angle;f.angle=b;e()};return a}console.error("workspace unit\u00a0builder:: creatorMethod missing")}};g.control.gui.elements.menubar.dropdowns=
[{text:"file",width:45,listWidth:150,listItemHeight:22.5,breakHeight:.5,spaceHeight:1,itemList:[{text_left:"New Scene",function:function(){control.scene.new(!0)}},{text_left:"Open Scene",text_right:"ctrl-f2",function:function(){control.scene.load(void 0,void 0,!0)}},{text_left:"Save Scene",text_right:"ctrl-f3",function:function(){control.scene.save("project.crv")}}]},{text:"edit",width:45,listWidth:150,listItemHeight:22.5,breakHeight:.5,spaceHeight:1,itemList:[{text_left:"Cut",text_right:"ctrl-x",
function:function(){control.selection.cut()}},{text_left:"Copy",text_right:"ctrl-c",function:function(){control.selection.copy()}},{text_left:"Paste",text_right:"ctrl-v",function:function(){control.selection.paste()}},{text_left:"Duplicate",text_right:"ctrl-b",function:function(){control.selection.duplicate()}},{text_left:"Delete",text_right:"del",function:function(){control.selection.delete()}}]},{text:"create",width:65,listWidth:250,listItemHeight:22.5,breakHeight:.5,spaceHeight:1,itemList:function(){var r=
[];for(category in g._interface.unit.alpha)if("builder"!=category){for(model in g._interface.unit.alpha[category])g._interface.unit.alpha[category][model].devUnit||r.push({text_left:g._interface.unit.alpha[category][model].metadata.name,function:function(d,f){return function(){var e=g.core.viewport.windowPoint2workspacePoint(30,30);g.control.scene.addUnit(e.x,e.y,0,d,f,"alpha")}}(model,category)});r.push("break")}r.pop();return r}()},{text:"help",width:50,listWidth:150,listItemHeight:22.5,breakHeight:.5,
spaceHeight:1,itemList:[{text_left:"Help Docs",text_right:"(empty)",function:function(){console.log("go to help site")}}]}];g.control.switch.devMode||(window.onbeforeunload=function(){return"Unsaved work will be lost"});g.control.gui.showMenubar();g.control.viewport.stopMouseScroll(!0);g.control.viewport.activeRender(!0)}})();
