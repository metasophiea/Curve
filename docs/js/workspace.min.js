var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(A){var H=0;return function(){return H<A.length?{done:!1,value:A[H++]}:{done:!0}}};$jscomp.arrayIterator=function(A){return{next:$jscomp.arrayIteratorImpl(A)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(A,H,g){A!=Array.prototype&&A!=Object.prototype&&(A[H]=g.value)};$jscomp.getGlobal=function(A){return"undefined"!=typeof window&&window===A?A:"undefined"!=typeof global&&null!=global?global:A};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var A=0;return function(H){return $jscomp.SYMBOL_PREFIX+(H||"")+A++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var A=$jscomp.global.Symbol.iterator;A||(A=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[A]&&$jscomp.defineProperty(Array.prototype,A,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var A=$jscomp.global.Symbol.asyncIterator;A||(A=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(A){$jscomp.initSymbolIterator();A={next:A};A[$jscomp.global.Symbol.iterator]=function(){return this};return A};
$jscomp.iteratorFromArray=function(A,H){$jscomp.initSymbolIterator();A instanceof String&&(A+="");var g=0,r={next:function(){if(g<A.length){var b=g++;return{value:H(b,A[b]),done:!1}}r.next=function(){return{done:!0,value:void 0}};return r.next()}};r[Symbol.iterator]=function(){return r};return r};
$jscomp.polyfill=function(A,H,g,r){if(H){g=$jscomp.global;A=A.split(".");for(r=0;r<A.length-1;r++){var b=A[r];b in g||(g[b]={});g=g[b]}A=A[A.length-1];r=g[A];H=H(r);H!=r&&null!=H&&$jscomp.defineProperty(g,A,{configurable:!0,writable:!0,value:H})}};$jscomp.polyfill("Array.prototype.keys",function(A){return A?A:function(){return $jscomp.iteratorFromArray(this,function(A){return A})}},"es6","es3");
$jscomp.polyfill("Array.from",function(A){return A?A:function(A,g,r){g=null!=g?g:function(a){return a};var b=[],d="undefined"!=typeof Symbol&&Symbol.iterator&&A[Symbol.iterator];if("function"==typeof d){A=d.call(A);for(var f=0;!(d=A.next()).done;)b.push(g.call(r,d.value,f++))}else for(d=A.length,f=0;f<d;f++)b.push(g.call(r,A[f],f));return b}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var A={},H=Object.create(new $jscomp.global.Proxy(A,{get:function(g,r,b){return g==A&&"q"==r&&b==H}}));return!0===H.q}catch(g){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.makeIterator=function(A){var H="undefined"!=typeof Symbol&&Symbol.iterator&&A[Symbol.iterator];return H?H.call(A):$jscomp.arrayIterator(A)};
$jscomp.owns=function(A,H){return Object.prototype.hasOwnProperty.call(A,H)};
$jscomp.polyfill("WeakMap",function(A){function H(){if(!A||!Object.seal)return!1;try{var a=Object.seal({}),c=Object.seal({}),b=new A([[a,2],[c,3]]);if(2!=b.get(a)||3!=b.get(c))return!1;b.delete(a);b.set(c,4);return!b.has(a)&&4==b.get(c)}catch(m){return!1}}function g(){}function r(a){if(!$jscomp.owns(a,d)){var c=new g;$jscomp.defineProperty(a,d,{value:c})}}function b(a){var c=Object[a];c&&(Object[a]=function(a){if(a instanceof g)return a;r(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(A&&
$jscomp.ES6_CONFORMANCE)return A}else if(H())return A;var d="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var f=0,a=function(a){this.id_=(f+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};a.prototype.set=function(a,c){r(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};a.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};a.prototype.has=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};a.prototype.delete=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return a},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(A){function H(){if($jscomp.ASSUME_NO_NATIVE_MAP||!A||"function"!=typeof A||!A.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),c=new A($jscomp.makeIterator([[a,"s"]]));if("s"!=c.get(a)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var b=c.entries(),d=b.next();if(d.done||d.value[0]!=a||"s"!=d.value[1])return!1;d=b.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!b.next().done?!1:!0}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(A&&$jscomp.ES6_CONFORMANCE)return A}else if(H())return A;$jscomp.initSymbolIterator();var g=new WeakMap,r=function(a){this.data_={};this.head_=f();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};r.prototype.set=function(a,c){a=0===a?0:a;var e=b(this,a);e.list||(e.list=this.data_[e.id]=[]);e.entry?e.entry.value=c:(e.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:c},e.list.push(e.entry),this.head_.previous.next=e.entry,this.head_.previous=e.entry,this.size++);return this};r.prototype.delete=function(a){a=b(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};r.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};r.prototype.has=function(a){return!!b(this,a).entry};
r.prototype.get=function(a){return(a=b(this,a).entry)&&a.value};r.prototype.entries=function(){return d(this,function(a){return[a.key,a.value]})};r.prototype.keys=function(){return d(this,function(a){return a.key})};r.prototype.values=function(){return d(this,function(a){return a.value})};r.prototype.forEach=function(a,c){for(var e=this.entries(),b;!(b=e.next()).done;)b=b.value,a.call(c,b[1],b[0],this)};r.prototype[Symbol.iterator]=r.prototype.entries;var b=function(e,c){var b=c&&typeof c;"object"==
b||"function"==b?g.has(c)?b=g.get(c):(b=""+ ++a,g.set(c,b)):b="p_"+c;var d=e.data_[b];if(d&&$jscomp.owns(e.data_,b))for(e=0;e<d.length;e++){var f=d[e];if(c!==c&&f.key!==f.key||c===f.key)return{id:b,list:d,index:e,entry:f}}return{id:b,list:d,index:-1,entry:void 0}},d=function(a,c){var e=a.head_;return $jscomp.iteratorPrototype(function(){if(e){for(;e.head!=a.head_;)e=e.previous;for(;e.next!=e.head;)return e=e.next,{done:!1,value:c(e)};e=null}return{done:!0,value:void 0}})},f=function(){var a={};return a.previous=
a.next=a.head=a},a=0;return r},"es6","es3");
$jscomp.polyfill("Set",function(A){function H(){if($jscomp.ASSUME_NO_NATIVE_SET||!A||"function"!=typeof A||!A.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),b=new A($jscomp.makeIterator([g]));if(!b.has(g)||1!=b.size||b.add(g)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var d=b.entries(),f=d.next();if(f.done||f.value[0]!=g||f.value[1]!=g)return!1;f=d.next();return f.done||f.value[0]==g||4!=f.value[0].x||f.value[1]!=f.value[0]?!1:d.next().done}catch(a){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(A&&$jscomp.ES6_CONFORMANCE)return A}else if(H())return A;$jscomp.initSymbolIterator();var g=function(g){this.map_=new Map;if(g){g=$jscomp.makeIterator(g);for(var b;!(b=g.next()).done;)this.add(b.value)}this.size=this.map_.size};g.prototype.add=function(g){g=0===g?0:g;this.map_.set(g,g);this.size=this.map_.size;return this};g.prototype.delete=function(g){g=this.map_.delete(g);this.size=this.map_.size;return g};g.prototype.clear=function(){this.map_.clear();
this.size=0};g.prototype.has=function(g){return this.map_.has(g)};g.prototype.entries=function(){return this.map_.entries()};g.prototype.values=function(){return this.map_.values()};g.prototype.keys=g.prototype.values;g.prototype[Symbol.iterator]=g.prototype.values;g.prototype.forEach=function(g,b){var d=this;this.map_.forEach(function(f){return g.call(b,f,f,d)})};return g},"es6","es3");
$jscomp.polyfill("Object.entries",function(A){return A?A:function(A){var g=[],r;for(r in A)$jscomp.owns(A,r)&&g.push([r,A[r]]);return g}},"es8","es3");$jscomp.polyfill("Array.prototype.fill",function(A){return A?A:function(A,g,r){var b=this.length||0;0>g&&(g=Math.max(0,b+g));if(null==r||r>b)r=b;r=Number(r);0>r&&(r=Math.max(0,b+r));for(g=Number(g||0);g<r;g++)this[g]=A;return this}},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(A,H){for(var g=1;g<arguments.length;g++){var r=arguments[g];if(r)for(var b in r)$jscomp.owns(r,b)&&(A[b]=r[b])}return A};$jscomp.polyfill("Object.assign",function(A){return A||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.is",function(A){return A?A:function(A,g){return A===g?0!==A||1/A===1/g:A!==A&&g!==g}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(A){return A?A:function(A,g){var r=this;r instanceof String&&(r=String(r));var b=r.length;g=g||0;for(0>g&&(g=Math.max(g+b,0));g<b;g++){var d=r[g];if(d===A||Object.is(d,A))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(A,H,g){if(null==A)throw new TypeError("The 'this' value for String.prototype."+g+" must not be null or undefined");if(H instanceof RegExp)throw new TypeError("First argument to String.prototype."+g+" must not be a regular expression");return A+""};$jscomp.polyfill("String.prototype.includes",function(A){return A?A:function(A,g){return-1!==$jscomp.checkStringArgs(this,A,"includes").indexOf(A,g||0)}},"es6","es3");
$jscomp.polyfill("Math.sign",function(A){return A?A:function(A){A=Number(A);return 0===A||isNaN(A)?A:0<A?1:-1}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(A){return A?A:function(){return $jscomp.iteratorFromArray(this,function(A,g){return g})}},"es8","es3");
(function(){for(var A=document.getElementsByTagName("canvas"),H=0;H<A.length;H++)if(A[H].hasAttribute("workspace")){var g=A[H];g.library=new function(){var r=this;this.math=new function(){this.averageArray=function(b){return b.reduce(function(b,f){return b+f},0)/b.length};this.averagePoint=function(b){var d=b.reduce(function(b,a){return{x:b.x+a.x,y:b.y+a.y}});return{x:d.x/b.length,y:d.y/b.length}};this.distanceBetweenTwoPoints=function(b,d){return Math.pow(Math.pow(b.x-d.x,2)+Math.pow(b.y-d.y,2),
.5)};this.seconds2time=function(b){var d={h:0,m:0,s:0};d.h=Math.floor(b/3600);b-=3600*d.h;d.m=Math.floor(b/60);b-=60*d.m;d.s=b;return d};this.largestValueFound=function(b){return b.reduce(function(b,f){return Math.abs(b)>Math.abs(f)?b:f})};this.smallestValueFound=function(b){return b.reduce(function(b,f){return Math.abs(b)<Math.abs(f)?b:f})};this.cartesian2polar=function(b,d){return{dis:Math.pow(Math.pow(b,2)+Math.pow(d,2),.5),ang:0===b?0===d?0:0<d?.5*Math.PI:1.5*Math.PI:0===d?0<=b?0:Math.PI:0<=b?
Math.atan(d/b):Math.atan(d/b)+Math.PI}};this.polar2cartesian=function(b,d){return{x:d*Math.cos(b),y:d*Math.sin(b)}};this.cartesianAngleAdjust=function(b,d,f){if(0==f||0==f%Math.PI*2)return{x:b,y:d};b=this.cartesian2polar(b,d);b.ang+=f;return this.polar2cartesian(b.ang,b.dis)};this.applyOffsetToPoints=function(b,d){return d.map(function(d){return{x:d.x+b.x,y:d.y+b.y}})};this.applyOffsetToPolygon=function(b,d){b={points:this.applyOffsetToPoints(b,d.points),boundingBox:{}};b.boundingBox=this.boundingBoxFromPoints(b.points);
return b};this.boundingBoxFromPoints=function(b){if(0==b.length)return{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};for(var d=b[0].x,f=b[0].x,a=b[0].y,e=b[0].y,c=1;c<b.length;c++)b[c].x<d?d=b[c].x:b[c].x>f&&(f=b[c].x),b[c].y<a?a=b[c].y:b[c].y>e&&(e=b[c].y);return{topLeft:{x:d,y:a},bottomRight:{x:f,y:e}}};this.pointsOfRect=function(b,d,f,a,e,c){e=void 0===e?0:e;c=void 0===c?{x:0,y:0}:c;var h=c.x*f,m=c.y*a,k=this.cartesian2polar(h,m);k=this.polar2cartesian(k.ang-e,k.dis);c={x:b-k.x,y:d-k.y};k=this.cartesian2polar(h-
f,m);k=this.polar2cartesian(k.ang-e,k.dis);var t={x:b-k.x,y:d-k.y};k=this.cartesian2polar(h-f,m-a);k=this.polar2cartesian(k.ang-e,k.dis);f={x:b-k.x,y:d-k.y};k=this.cartesian2polar(h,m-a);k=this.polar2cartesian(k.ang-e,k.dis);return[c,t,f,{x:b-k.x,y:d-k.y}]};this.pointsOfCircle=function(b,d,f,a){a=void 0===a?3:a;for(var e=[],c=0;c<a;c++)e.push({x:b+f*Math.sin(c/a*Math.PI*2),y:d+f*Math.cos(c/a*Math.PI*2)});return e};this.pointsOfText=function(b,d,f,a,e,c,h,m){var k=document.createElement("canvas").getContext("2d");
k.font=c;k.textAlign=h;k.textBaseline=m;b=k.measureText(b).width/e;c=-c.split("pt")[0].split(" ").pop();isNaN(c)&&(c=-7.5);c/=e;e=[{x:d,y:f},{x:d+b,y:f},{x:d+b,y:f-c},{x:d,y:f-c}];b={start:0,end:0,center:b/2,left:b,right:b};c={alphabetic:c,top:0,hanging:0,middle:c/2,ideographic:0,bottom:c};for(k=0;k<e.length;k++)e[k]={x:e[k].x-b[h],y:e[k].y+c[m]};for(k=0;k<e.length;k++)e[k]=this.cartesianAngleAdjust(e[k].x-d,e[k].y-f,a),e[k].x+=d,e[k].y+=f;return e};this.relativeDistance=function(b,d,f,a,e){d=(a-
d)/(f-d);if(void 0===e||!e){if(1<d)return b;if(0>d)return 0}return d*b};this.lineCorrecter=function(b,d,f){if(!(0>b.x1||0>b.x2||b.x1>f||b.x2>f||0>b.y1&&0>b.y2||b.y1>d&&b.y2>d))return f=(b.y2-b.y1)/(b.x2-b.x1),0>b.y1?(b.x1=(0-b.y1+f*b.x1)/f,b.y1=0):0>b.y2&&(b.x2=(0-b.y2+f*b.x2)/f,b.y2=0),b.y1>d?(b.x1=(d-b.y1+f*b.x1)/f,b.y1=d):b.y2>d&&(b.x2=(d-b.y2+f*b.x2)/f,b.y2=d),b};this.normalizeStretchArray=function(b){var d=b.reduce(function(a,c,b,d){return c>d[a]?b:a},0),f=Math.abs(b[d]);b=b.map(function(a){return a/
f});if(0==b[0]&&1==b[b.length-1])return b;var a=0!=b[0]?b[0]:b[b.length-1];return b=b.map(function(e){return(e-a)/(1-a)})};this.curvePoint=new function(){this.linear=function(b,d,f){d=void 0===d?0:d;return(void 0===b?.5:b)*((void 0===f?1:f)-d)+d};this.sin=function(b,d,f){d=void 0===d?0:d;return Math.sin(Math.PI/2*(void 0===b?.5:b))*((void 0===f?1:f)-d)+d};this.cos=function(b,d,f){d=void 0===d?0:d;return(1-Math.cos(Math.PI/2*(void 0===b?.5:b)))*((void 0===f?1:f)-d)+d};this.s=function(b,d,f,a){d=void 0===
d?0:d;f=void 0===f?1:f;a=void 0===a?8:a;return r.math.normalizeStretchArray([1/(1+Math.exp(-.5*-a)),1/(1+Math.exp(-a*((void 0===b?.5:b)-.5))),1/(1+Math.exp(.5*-a))])[1]*(f-d)+d};this.exponential=function(b,d,f,a){d=void 0===d?0:d;f=void 0===f?1:f;a=void 0===a?2:a;return r.math.normalizeStretchArray([(Math.exp(0*a)-1)/(Math.E-1),(Math.exp(a*(void 0===b?.5:b))-1)/(Math.E-1),(Math.exp(1*a)-1)/(Math.E-1)])[1]*(f-d)+d}};this.curveGenerator=new function(){this.linear=function(b,d,f){d=void 0===d?0:d;f=
void 0===f?1:f;b=Math.abs(void 0===b?2:b)-1;for(var a=[0],e=1;e<b;e++)a.push(e/b);a.push(1);b=f-d;for(e=0;e<a.length;e++)a[e]=a[e]*b+d;return a};this.sin=function(b,d,f){d=void 0===d?0:d;f=void 0===f?1:f;b=Math.abs(void 0===b?2:b)-1;for(var a=[0],e=1;e<b;e++)a.push(Math.sin(Math.PI/2*(e/b)));a.push(1);b=f-d;for(e=0;e<a.length;e++)a[e]=a[e]*b+d;return a};this.cos=function(b,d,f){d=void 0===d?0:d;f=void 0===f?1:f;b=Math.abs(void 0===b?2:b)-1;for(var a=[0],e=1;e<b;e++)a.push(1-Math.cos(Math.PI/2*(e/
b)));a.push(1);b=f-d;for(e=0;e<a.length;e++)a[e]=a[e]*b+d;return a};this.s=function(b,d,f,a){b=void 0===b?2:b;d=void 0===d?0:d;f=void 0===f?1:f;a=void 0===a?8:a;0==a&&(a=1E-6);for(var e=[],c=0;c<b;c++)e.push(1/(1+Math.exp(-a*(c/b-.5))));b=r.math.normalizeStretchArray(e);f-=d;for(c=0;c<b.length;c++)b[c]=b[c]*f+d;return b};this.exponential=function(b,d,f,a){d=void 0===d?0:d;f=void 0===f?1:f;a=void 0===a?2:a;b=(void 0===b?2:b)-1;for(var e=[],c=0;c<=b;c++)e.push((Math.exp(c/b*a)-1)/(Math.E-1));e=system.utility.math.normalizeStretchArray(e);
b=f-d;for(c=0;c<e.length;c++)e[c]=e[c]*b+d;return e}};this.detectOverlap=new function(){this.boundingBoxes=function(b,d){return!(b.bottomRight.y<d.topLeft.y||b.topLeft.y>d.bottomRight.y||b.bottomRight.x<d.topLeft.x||b.topLeft.x>d.bottomRight.x)};this.pointWithinBoundingBox=function(b,d){return!(b.x<d.topLeft.x||b.y<d.topLeft.y||b.x>d.bottomRight.x||b.y>d.bottomRight.y)};this.pointWithinPoly=function(b,d){for(var f=!1,a=0,e=d.length-1;a<d.length;e=a++)d[a].y>b.y!=d[e].y>b.y&&b.x<(d[e].x-d[a].x)*(b.y-
d[a].y)/(d[e].y-d[a].y)+d[a].x&&(f=!f);return f};this.lineSegments=function(b,d){var f=(d[1].y-d[0].y)*(b[1].x-b[0].x)-(d[1].x-d[0].x)*(b[1].y-b[0].y);if(0==f)return null;var a=((d[1].x-d[0].x)*(b[0].y-d[0].y)-(d[1].y-d[0].y)*(b[0].x-d[0].x))/f;d=((b[1].x-b[0].x)*(b[0].y-d[0].y)-(b[1].y-b[0].y)*(b[0].x-d[0].x))/f;return{x:b[0].x+a*(b[1].x-b[0].x),y:b[0].y+a*(b[1].y-b[0].y),inSeg1:0<=a&&1>=a,inSeg2:0<=d&&1>=d}};this.overlappingPolygons=function(b,d){for(var f=0;f<b.length;f++)if(this.pointWithinPoly(b[f],
d))return!0;for(f=0;f<d.length;f++)if(this.pointWithinPoly(d[f],b))return!0;var a=Array.apply(null,{length:b.length}).map(Number.call,Number).concat([0]),e=Array.apply(null,{length:d.length}).map(Number.call,Number).concat([0]);for(f=0;f<a.length-1;f++)for(var c=0;c<e.length-1;c++){var h=this.lineSegments([b[a[f]],b[a[f+1]]],[d[e[c]],d[e[c+1]]]);if(null!=h&&h.inSeg1&&h.inSeg2)return!0}return!1};this.overlappingPolygonWithPolygons=function(b,d){for(var f=0;f<d.length;f++)if(this.boundingBoxes(b.boundingBox,
d[f].boundingBox)&&this.overlappingPolygons(b.points,d[f].points))return!0;return!1}};this.fitPolyIn=function(b,d,f){f=void 0===f?!1:f;var a,e=[[],[],[]],c=g.library.math.averagePoint(b.points),h=100,m=[];for(a=1;a<h+1;a++){m=[];for(var k=2*a+1,t=2*Math.PI/k,q=Math.pow(a,2),n=0;n<k;n++){var y=r.math.polar2cartesian(t*n,q);f&&e[0].push({x:y.x+c.x,y:y.y+c.y});this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon(y,b),d)||m.push({ang:t*n,dis:q})}if(0!=m.length)break}h=10;if(1==
m.length)var p=m[0];else{k=Math.pow(a,2);t=Math.pow(a-1,2);q=[];for(a=0;a<h;a++){var l=[],x=(k-t)/2+t;for(n=0;n<m.length;n++)y=r.math.polar2cartesian(m[n].ang,x),f&&e[1].push({x:y.x+c.x,y:y.y+c.y}),this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon(y,b),d)||(l.push({ang:m[n].ang,dis:x}),q.push({ang:m[n].ang,dis:x}));if(1==l.length){p=l[0];break}0==l.length?t=x:k=x}void 0==p&&(p=q.pop())}h=10;a=r.math.polar2cartesian(p.ang,p.dis);f&&e[2].push({x:a.x+c.x,y:a.y+c.y});m=a.x;n=
a.y;for(a=p=y=0;a<h;a++)k=(m-y)/2+y,t=(n-p)/2+p,f&&e[2].push({x:k+c.x,y:n+c.y}),this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon({x:k,y:n},b),d)?y=k:m=k,f&&e[2].push({x:m+c.x,y:t+c.y}),this.detectOverlap.overlappingPolygonWithPolygons(this.applyOffsetToPolygon({x:m,y:t},b),d)?p=t:n=t;a={x:m,y:n};return f?{offset:a,paths:e}:a}};this.structure=new function(){this.functionListRunner=function(b,d){return function(f,a){for(var e=0;e<b.length;e++){for(var c=!0,h=0;h<b[e].requiredKeys.length;h++){c=
!0;for(var m=0;m<b[e].requiredKeys[h].length&&(c=c&&d[b[e].requiredKeys[h][m]],c);m++);if(c)break}if(c&&b[e].function(f,a))break}}};this.signalRegistry=function(b,d,f){b=void 0===b?-1:b;d=void 0===d?-1:d;f=void 0===f?-1:f;var a=[],e=[],c=[],h=[],m={},k=[];this.__dump=function(){console.log("---- signalRegistry dump ----");console.log("\tsignals");for(var e=0;e<a.length;e++)console.log("\t\t",e," "+JSON.stringify(a[e]));console.log("\tselectedSignals");for(e=0;e<tselectedSignals.length;e++)console.log("\t\t",
e," "+JSON.stringify(tselectedSignals[e]));console.log("\tevents");for(e=0;e<c.length;e++)console.log("\t\t",e," "+JSON.stringify(c[e]));console.log("\tevents_byID");for(e=0;e<h.length;e++)console.log("\t\t",e," "+JSON.stringify(h[e]));console.log("\tevents_byPosition");var b=Object.keys(m);for(e=0;e<b.length;e++)console.log("\t\t",b[e]," "+JSON.stringify(m[b[e]]));console.log("\tpositions");for(e=0;e<k.length;e++)console.log("\t\t",e," "+JSON.stringify(k[e]))};this.export=function(){return JSON.parse(JSON.stringify({signals:a,
selectedSignals:e,events:c,events_byID:h,events_byPosition:m,positions:k}))};this.import=function(b){a=JSON.parse(JSON.stringify(b.signals));e=JSON.parse(JSON.stringify(b.selectedSignals));c=JSON.parse(JSON.stringify(b.events));h=JSON.parse(JSON.stringify(b.events_byID));m=JSON.parse(JSON.stringify(b.events_byPosition));k=JSON.parse(JSON.stringify(b.positions))};this.getAllSignals=function(){return JSON.parse(JSON.stringify(a))};this.getAllEvents=function(){return JSON.parse(JSON.stringify(c))};this.getSignal=
function(c){if(void 0!=a[c])return JSON.parse(JSON.stringify(a[c]))};this.eventsBetween=function(a,e){for(var b=void 0==e?Array.from(new Set(k.filter(function(c){return c==a}))):Array.from(new Set(k.filter(function(c){return c>=a&&c<e}))),d=[],f=0;f<b.length;f++){b[f]=m[String(b[f])];for(var h=0;h<b[f].length;h++)d.push(c[b[f][h]])}return d.sort(function(a,c){return a.position<c.position?-1:a.position>c.position?1:0})};this.add=function(e,g){if(void 0!=e&&"line"in e&&"position"in e&&"length"in e){"strength"in
e||(e.strength=1);0>e.line&&(e.line=0);0>e.length&&(e.length=0);0>e.position&&(e.position=0);0>e.strength&&(e.strength=0);-1<d&&e.line>d-1&&(e.line=d-1);-1<f&&e.length>f&&(e.length=f);-1<b&&e.position>b&&(e.position=b-e.length);-1<b&&e.position+e.length>b&&(e.length=b-e.position);-1<b&&e.position+e.length>b&&(e.position=b-e.length);1<e.strength&&(e.strength=1);var q=0;if(void 0==g)for(;void 0!=a[q];)q++;else q=g;a[q]=JSON.parse(JSON.stringify(e));e=[{signalID:q,line:e.line,position:e.position,strength:e.strength},
{signalID:q,line:e.line,position:e.position+e.length,strength:0}];for(g=0;void 0!=c[g];)g++;c[g]=e[0];h[q]=[g];void 0==m[e[0].position]?m[e[0].position]=[g]:m[e[0].position].push(g);for(k.push(e[0].position);void 0!=c[g];)g++;c[g]=e[1];h[q]=h[q].concat(g);void 0==m[e[1].position]?m[e[1].position]=[g]:m[e[1].position].push(g);k.push(e[1].position);return q}};this.remove=function(e){if(void 0!=a[e]){delete a[e];for(var b=0;b<h[e].length;b++){var d=h[e][b];m[c[d].position].splice(m[c[d].position].indexOf(d),
1);k.splice(k.indexOf(c[d].position),1);0==m[c[d].position].length&&delete m[c[d].position];delete c[d]}delete h[e]}};this.update=function(e,c){void 0!=c&&("line"in c||(c.line=a[e].line),-1<b&&("position"in c&&"length"in c?c.length+c.position>b&&(c.length=b-c.position):("position"in c?a[e].length+c.position>=b&&(c.position=b-a[e].length):c.position=a[e].position,"length"in c?c.length+c.position>b&&(c.length=b-c.position):c.length=a[e].length)),"strength"in c||(c.strength=a[e].strength),this.remove(e),
this.add(c,e))};this.reset=function(){a=[];e=[];c=[];h=[];m={};k=[]}}};this.audio=new function(){this.context=new (window.AudioContext||window.webkitAudioContext);this.changeAudioParam=function(a,c,b,d,f,g){g=void 0===g?!0:g;if(null==b)return c.value;g&&c.cancelScheduledValues(a.currentTime);try{switch(f){case "linear":c.linearRampToValueAtTime(b,a.currentTime+d);break;case "exponential":console.warn("2018-4-18 - changeAudioParam:exponential doesn't work on chrome");0==b&&(b=1E-4);c.exponentialRampToValueAtTime(b,
a.currentTime+d);break;case "s":for(var e=b-c.value,h=r.math.curveGenerator.s(10),k=0;k<h.length;k++)h[k]=c.value+h[k]*e;c.setValueCurveAtTime(new Float32Array(h),a.currentTime,d);break;default:c.setTargetAtTime(b,a.currentTime,.001)}}catch(p){console.log("could not change param (possibly due to an overlap, or bad target value)"),console.log("audioParam:",c,"target:",b,"time:",d,"curve:",f,"cancelScheduledValues:",g),console.log(p)}};this.loadAudioFile=function(a,c,b){b=void 0===b?"":b;switch(void 0===
c?"file":c){case "url":c=new XMLHttpRequest;c.open("GET",b,!0);c.responseType="arraybuffer";c.onload=function(){r.audio.context.decodeAudioData(this.response,function(c){a({buffer:c,name:b.split("/").pop(),duration:c.duration})},function(a){console.warn("Error with decoding audio data"+a.err)})};c.send();break;default:var e=document.createElement("input");e.type="file";e.onchange=function(){var c=this.files[0],b=new FileReader;b.readAsArrayBuffer(c);b.onload=function(b){r.audio.context.decodeAudioData(b.target.result,
function(e){a({buffer:e,name:c.name,duration:e.duration})});e.remove()}};document.body.appendChild(e);e.click()}};this.waveformSegment=function(a,c,b){c=void 0===c?{start:0,end:1}:c;b=void 0===b?1E4:b;var e=a.getChannelData(0);c.start=c.start?c.start:0;c.end=c.end?c.end:1;var d=a.length*c.start;a=a.length*c.end;b=(a-d)/b;for(c=[];d<a;d+=Math.round(b))c.push(r.math.largestValueFound(e.slice(d,d+Math.round(b))));return c};this.loadBuffer=function(a,c,b,d){a=a.createBufferSource();a.buffer=c;a.connect(b);
a.onended=d;return a};this.destination=this.context.createGain();this.destination.connect(this.context.destination);this.destination._gain=1;this.destination.masterGain=function(a){if(void 0==a)return this.destination._gain;this._gain=a;r.audio.changeAudioParam(r.audio.context,this.gain,this._gain,.01,"instant",!0)};this.names_frequencies_split={0:{C:16.35,"C#":17.32,D:18.35,"D#":19.45,E:20.6,F:21.83,"F#":23.12,G:24.5,"G#":25.96,A:27.5,"A#":29.14,B:30.87},1:{C:32.7,"C#":34.65,D:36.71,"D#":38.89,E:41.2,
F:43.65,"F#":46.25,G:49,"G#":51.91,A:55,"A#":58.27,B:61.74},2:{C:65.41,"C#":69.3,D:73.42,"D#":77.78,E:82.41,F:87.31,"F#":92.5,G:98,"G#":103.8,A:110,"A#":116.5,B:123.5},3:{C:130.8,"C#":138.6,D:146.8,"D#":155.6,E:164.8,F:174.6,"F#":185,G:196,"G#":207.7,A:220,"A#":233.1,B:246.9},4:{C:261.6,"C#":277.2,D:293.7,"D#":311.1,E:329.6,F:349.2,"F#":370,G:392,"G#":415.3,A:440,"A#":466.2,B:493.9},5:{C:523.3,"C#":554.4,D:587.3,"D#":622.3,E:659.3,F:698.5,"F#":740,G:784,"G#":830.6,A:880,"A#":932.3,B:987.8},6:{C:1047,
"C#":1109,D:1175,"D#":1245,E:1319,F:1397,"F#":1480,G:1568,"G#":1661,A:1760,"A#":1865,B:1976},7:{C:2093,"C#":2217,D:2349,"D#":2489,E:2637,F:2794,"F#":2960,G:3136,"G#":3322,A:3520,"A#":3729,B:3951},8:{C:4186,"C#":4435,D:4699,"D#":4978,E:5274,F:5588,"F#":5920,G:6272,"G#":6645,A:7040,"A#":7459,B:7902}};this.names_frequencies={};for(var b=Object.entries(this.names_frequencies_split),d=0;d<b.length;d++)for(var f=Object.entries(this.names_frequencies_split[d]),a=0;a<f.length;a++)this.names_frequencies[b[d][0]+
f[a][0]]=f[a][1];this.frequencies_names={};b=Object.entries(this.names_frequencies);for(d=0;d<b.length;d++)this.frequencies_names[b[d][1]]=b[d][0];b="0C 0C# 0D 0D# 0E 0F 0F# 0G 0G# 0A 0A# 0B 1C 1C# 1D 1D# 1E 1F 1F# 1G 1G# 1A 1A# 1B 2C 2C# 2D 2D# 2E 2F 2F# 2G 2G# 2A 2A# 2B 3C 3C# 3D 3D# 3E 3F 3F# 3G 3G# 3A 3A# 3B 4C 4C# 4D 4D# 4E 4F 4F# 4G 4G# 4A 4A# 4B 5C 5C# 5D 5D# 5E 5F 5F# 5G 5G# 5A 5A# 5B 6C 6C# 6D 6D# 6E 6F 6F# 6G 6G# 6A 6A# 6B 7C 7C# 7D 7D# 7E 7F 7F# 7G 7G# 7A 7A# 7B 8C 8C# 8D 8D# 8E 8F 8F# 8G 8G# 8A 8A# 8B".split(" ");
this.midinumbers_names={};for(d=0;d<b.length;d++)this.midinumbers_names[d+24]=b[d];this.names_midinumbers={};b=Object.entries(this.midinumbers_names);for(d=0;d<b.length;d++)this.names_midinumbers[b[d][1]]=parseInt(b[d][0]);this.num2name=function(a){return this.midinumbers_names[a]};this.num2freq=function(a){return this.names_frequencies[this.midinumbers_names[a]]};this.name2num=function(a){return this.names_midinumbers[a]};this.name2freq=function(a){return this.names_frequencies[a]};this.freq2num=
function(a){return this.names_midinumbers[this.frequencies_names[a]]};this.freq2name=function(a){return this.frequencies_names[a]}};this.misc=new function(){this.blendColours=function(b,d,f){function a(a){a=a.split(",");a[0]=a[0].replace("rgba(","");a[3]=a[3].replace(")","");return a.map(function(a){return parseFloat(a)})}b=a(b);d=a(d);for(var e=[],c=0;c<b.length;c++)e[c]=(1-f)*b[c]+f*d[c];return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"};this.multiBlendColours=function(b,d){if(0==d)return b[0];
if(1==d)return b[b.length-1];d*=b.length-1;return r.misc.blendColours(b[~~d],b[~~d+1],d%1)};this.padString=function(b,d,f){f=void 0===f?" ":f;if(1>f.length)return b;for(b=""+b;b.length<d;)b=f+b;return b};this.compressString=function(b){return r.thirdparty.lzString.compress(b)};this.decompressString=function(b){return r.thirdparty.lzString.decompress(b)};this.serialize=function(b,d){d=void 0===d?!0:d;b=JSON.stringify(b,function(b,a){switch({}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()){case "function":return{__uniqueType:"function",
__value:a.toString(),__name:a.name};case "arraybuffer":return{__uniqueType:"arraybuffer",__value:btoa(String.fromCharCode(new Uint8Array(a)))};case "audiobuffer":b=[];for(var e=0;e<a.numberOfChannels;e++)b.push(Array.from(a.getChannelData(e)));return{__uniqueType:"audiobuffer",__channelData:b,__sampleRate:a.sampleRate,__numberOfChannels:a.numberOfChannels,__length:a.length};default:return a}});d&&(b=r.misc.compressString(b));return b};this.unserialize=function(b,d){if(void 0!==b)return(void 0===d||
d)&&(b=r.misc.decompressString(b)),JSON.parse(b,function(b,a){if("object"==typeof a&&null!=a&&"__uniqueType"in a)switch(a.__uniqueType){case "function":b=a.__value.substring(0,a.__value.indexOf("{"));b=b.substring(b.indexOf("(")+1,b.lastIndexOf(")"));a=a.__value.substring(a.__value.indexOf("{")+1,a.__value.lastIndexOf("}"));a=Function(b,a);break;case "arraybuffer":a=atob(a.__value);for(b=0;b<a.length;b++)a[b]=a[b].charCodeAt(0);a=new ArrayBuffer(a);break;case "audiobuffer":var e=r.audio.context.createBuffer(a.__numberOfChannels,
a.__length,a.__sampleRate);for(b=0;b<e.numberOfChannels;b++){workingBuffer=e.getChannelData(b);for(var c=0;c<e.length;c++)workingBuffer[c]=a.__channelData[b][c]}a=e;break;default:a=a.__value}return a})};this.openFile=function(b,d){d=void 0===d?"readAsBinaryString":d;var f=document.createElement("input");f.type="file";f.onchange=function(){var a=new FileReader;switch(d){case "readAsArrayBuffer":a.readAsArrayBuffer(this.files[0]);break;default:a.readAsBinaryString(this.files[0])}a.onloadend=function(){b&&
b(a.result)}};f.click()};this.printFile=function(b,d){var f=document.createElement("a");f.href=URL.createObjectURL(new Blob([d]));f.download=b;f.click()}};this.thirdparty=new function(){this.lzString=function(){var b=String.fromCharCode,d={},f={compress:function(a){return null==a?"":f._compress(a,6,function(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(a)})},decompress:function(a){if(null==a)return"";if(""==a)return null;a=a.replace(/ /g,"+");return f._decompress(a.length,
32,function(e){e=a.charAt(e);if(!d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]){d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]={};for(var c=0;65>c;c++)d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"]["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(c)]=c}return d["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$"][e]})},_compress:function(a,e,c){if(null==a)return"";var b,d={},f={},g="",
q=2,n=3,y=2,p=[],l=0,x=0,v;for(v=0;v<a.length;v+=1){var z=a.charAt(v);Object.prototype.hasOwnProperty.call(d,z)||(d[z]=n++,f[z]=!0);var w=g+z;if(Object.prototype.hasOwnProperty.call(d,w))g=w;else{if(Object.prototype.hasOwnProperty.call(f,g)){if(256>g.charCodeAt(0)){for(b=0;b<y;b++)l<<=1,x==e-1?(x=0,p.push(c(l)),l=0):x++;var u=g.charCodeAt(0);for(b=0;8>b;b++)l=l<<1|u&1,x==e-1?(x=0,p.push(c(l)),l=0):x++,u>>=1}else{u=1;for(b=0;b<y;b++)l=l<<1|u,x==e-1?(x=0,p.push(c(l)),l=0):x++,u=0;u=g.charCodeAt(0);
for(b=0;16>b;b++)l=l<<1|u&1,x==e-1?(x=0,p.push(c(l)),l=0):x++,u>>=1}q--;0==q&&(q=Math.pow(2,y),y++);delete f[g]}else for(u=d[g],b=0;b<y;b++)l=l<<1|u&1,x==e-1?(x=0,p.push(c(l)),l=0):x++,u>>=1;q--;0==q&&(q=Math.pow(2,y),y++);d[w]=n++;g=String(z)}}if(""!==g){if(Object.prototype.hasOwnProperty.call(f,g)){if(256>g.charCodeAt(0)){for(b=0;b<y;b++)l<<=1,x==e-1?(x=0,p.push(c(l)),l=0):x++;u=g.charCodeAt(0);for(b=0;8>b;b++)l=l<<1|u&1,x==e-1?(x=0,p.push(c(l)),l=0):x++,u>>=1}else{u=1;for(b=0;b<y;b++)l=l<<1|u,
x==e-1?(x=0,p.push(c(l)),l=0):x++,u=0;u=g.charCodeAt(0);for(b=0;16>b;b++)l=l<<1|u&1,x==e-1?(x=0,p.push(c(l)),l=0):x++,u>>=1}q--;0==q&&(q=Math.pow(2,y),y++);delete f[g]}else for(u=d[g],b=0;b<y;b++)l=l<<1|u&1,x==e-1?(x=0,p.push(c(l)),l=0):x++,u>>=1;q--;0==q&&y++}u=2;for(b=0;b<y;b++)l=l<<1|u&1,x==e-1?(x=0,p.push(c(l)),l=0):x++,u>>=1;for(;;)if(l<<=1,x==e-1){p.push(c(l));break}else x++;return p.join("")},_decompress:function(a,e,c){var d=[],f=4,k=4,g=3,q=[],n,y,p=c(0),l=e,x=1;for(n=0;3>n;n+=1)d[n]=n;var v=
0;var z=Math.pow(2,2);for(y=1;y!=z;){var w=p&l;l>>=1;0==l&&(l=e,p=c(x++));v|=(0<w?1:0)*y;y<<=1}switch(v){case 0:v=0;z=Math.pow(2,8);for(y=1;y!=z;)w=p&l,l>>=1,0==l&&(l=e,p=c(x++)),v|=(0<w?1:0)*y,y<<=1;var u=b(v);break;case 1:v=0;z=Math.pow(2,16);for(y=1;y!=z;)w=p&l,l>>=1,0==l&&(l=e,p=c(x++)),v|=(0<w?1:0)*y,y<<=1;u=b(v);break;case 2:return""}n=d[3]=u;for(q.push(u);;){if(x>a)return"";v=0;z=Math.pow(2,g);for(y=1;y!=z;)w=p&l,l>>=1,0==l&&(l=e,p=c(x++)),v|=(0<w?1:0)*y,y<<=1;switch(u=v){case 0:v=0;z=Math.pow(2,
8);for(y=1;y!=z;)w=p&l,l>>=1,0==l&&(l=e,p=c(x++)),v|=(0<w?1:0)*y,y<<=1;d[k++]=b(v);u=k-1;f--;break;case 1:v=0;z=Math.pow(2,16);for(y=1;y!=z;)w=p&l,l>>=1,0==l&&(l=e,p=c(x++)),v|=(0<w?1:0)*y,y<<=1;d[k++]=b(v);u=k-1;f--;break;case 2:return q.join("")}0==f&&(f=Math.pow(2,g),g++);if(d[u])u=d[u];else if(u===k)u=n+n.charAt(0);else return null;q.push(u);d[k++]=n+u.charAt(0);f--;n=u;0==f&&(f=Math.pow(2,g),g++)}}};return f}()}};g.core=new function(){var r=new function(){function b(a){for(var c=[];void 0!=(a=
a.parent);)c.unshift({x:a.x,y:a.y,a:a.angle});a={x:void 0!=c[0]?c[0].x:0,y:void 0!=c[0]?c[0].y:0,a:void 0!=c[0]?c[0].a:0};for(var e=1;e<c.length;e++){var b=g.library.math.cartesianAngleAdjust(c[e].x,c[e].y,c[e-1].a);a.a+=c[e].a;a.x+=b.x;a.y+=b.y}return a}var d=this,f=new function(){this.length=function(a){return a*d.viewport.scale()};this.windowPoint2workspacePoint=function(a,c){var e=d.viewport.position(),b=d.viewport.scale()/window.devicePixelRatio,f=d.viewport.angle();a=a/b-e.x;c=c/b-e.y;return g.library.math.cartesianAngleAdjust(a,
c,-f)};this.workspacePoint2windowPoint=function(a,c){var e=d.viewport.position(),b=d.viewport.scale(),f=d.viewport.angle();a=g.library.math.cartesianAngleAdjust(a,c,f);return{x:(a.x+e.x)*b,y:(a.y+e.y)*b}}},a=new function(){this.polygon=function(){this.type="polygon";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.points=[];this.style={fill:"rgba(100,255,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1,lineJoin:"round",miterLimit:2};
this.parameter={};this.parameter.points=function(a){return function(c){if(void 0==c)return a.points;a.points=c;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var c=this._static,e=this;void 0!=(e=e.parent)&&!c;)c=c||e._static;this._static=c;a=void 0==a?b(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=this.points.map(function(c){c=g.library.math.cartesianAngleAdjust(c.x,
c.y,a.a);c.x+=a.x;c.y+=a.y;return c});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var e=!1}else e=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return e?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),
a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(a,c,b,m){c=void 0===c?{x:0,y:0,a:0}:c;b=void 0===b?!1:b;m=void 0===m?!1:m;var e=this._static?!0:g.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(e){e=this.points.map(function(a){a=g.library.math.cartesianAngleAdjust(a.x,a.y,c.a);return{x:a.x+c.x,y:a.y+c.y}});var h=this.style.lineWidth;b||(e=e.map(function(a){return f.workspacePoint2windowPoint(a.x,
a.y)}),h=f.length(h));if(m){m=new Path2D;m.moveTo(e[0].x,e[0].y);for(b=1;b<e.length;b++)m.lineTo(e[b].x,e[b].y);a.clip(m)}else{a.fillStyle=this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=h;a.lineJoin=this.style.lineJoin;a.miterLimit=this.style.miterLimit;a.beginPath();a.moveTo(e[0].x,e[0].y);for(b=1;b<e.length;b++)a.lineTo(e[b].x,e[b].y);a.closePath();a.fill();a.stroke();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)a=f.workspacePoint2windowPoint(this.extremities.points[b].x,
this.extremities.points[b].y),d.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(a.x,a.y);a=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(a.x,a.y)}}}}};this.circle=function(){this.type="circle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],
boundingBox:{}};this.y=this.x=0;this.r=2;this.style={fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1};this.parameter={};this.parameter.x=function(a){return function(c){if(void 0==c)return a.x;a.x=c;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(c){if(void 0==c)return a.y;a.y=c;a.computeExtremities()}}(this);this.parameter.r=function(a){return function(c){if(void 0==c)return a.r;a.r=c;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;
do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var c=this._static,e=this;void 0!=(e=e.parent)&&!c;)c=c||e._static;this._static=c;a=void 0==a?b(this):a;this.extremities={points:[],boundingBox:{},origin:{}};point=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a);this.extremities.origin={x:this.x+a.x,y:this.y+a.y};this.extremities.points=g.library.math.pointsOfCircle(this.x,this.y,this.r,10);this.extremities.points=this.extremities.points.map(function(c){c=
g.library.math.cartesianAngleAdjust(c.x,c.y,a.a);c.x+=a.x;c.y+=a.y;return c});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var e=!1}else e=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return e?g.library.math.distanceBetweenTwoPoints({x:a,
y:c},{x:this.x+this.extremities.origin.x,y:this.y+this.extremities.origin.y})<=this.r:!1};this.render=function(a,c,b,m){c=void 0===c?{x:0,y:0,a:0}:c;b=void 0===b?!1:b;m=void 0===m?!1:m;var e=this._static?!0:g.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(e){e=g.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=e.x-this.x;c.y+=e.y-this.y;c={x:this.x+c.x,y:this.y+c.y};e=this.r;var h=this.style.lineWidth;b||(c=f.workspacePoint2windowPoint(c.x,
c.y),e=f.length(e),h=f.length(h));if(m)b=new Path2D,b.arc(c.x,c.y,e,0,2*Math.PI,!1),a.clip(b);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=h,a.beginPath(),a.arc(c.x,c.y,e,0,2*Math.PI,!1),a.closePath(),a.fill(),a.stroke(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)b=f.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),d.render.drawDot(b.x,b.y,4,"rgba(50,50,50,1)");b=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,
this.extremities.boundingBox.topLeft.y);d.render.drawDot(b.x,b.y);b=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(b.x,b.y);b=f.workspacePoint2windowPoint(this.extremities.origin.x,this.extremities.origin.y);d.render.drawDot(b.x,b.y)}}}};this.canvas=function(){this.type="canvas";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=
this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;var a=document.createElement("canvas"),c=1;var h=a.getContext("2d",{alpha:!1});a.setAttribute("width",this.width*c);a.setAttribute("height",this.height*c);this.parameter={};this.parameter.x=function(a){return function(c){if(void 0==c)return a.x;a.x=c;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(c){if(void 0==c)return a.y;a.y=c;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(c){if(void 0==
c)return a.angle;a.angle=c;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(c){if(void 0==c)return a.anchor;a.anchor=c;a.computeExtremities()}}(this);this.parameter.width=function(e){return function(b){if(void 0==b)return e.width;e.width=b;e.computeExtremities();a.setAttribute("width",e.width*c)}}(this);this.parameter.height=function(e){return function(b){if(void 0==b)return e.height;e.height=b;e.computeExtremities();a.setAttribute("height",e.height*c)}}(this);this.resolution=
function(e){if(void 0==e)return c;c=e;a.setAttribute("width",this.width*c);a.setAttribute("height",this.height*c)};this._=h;this.$=function(a){return a*c};this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var c=this._static,e=this;void 0!=(e=e.parent)&&!c;)c=c||e._static;this._static=c;a=void 0==a?b(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,
this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(c){c=g.library.math.cartesianAngleAdjust(c.x,c.y,a.a);c.x+=a.x;c.y+=a.y;return c});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var e=!1}else e=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,
y:c},this.extremities.boundingBox);return e?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(c,e,b){e=void 0===e?{x:0,y:0,a:0}:e;b=void 0===b?!1:b;var h=this._static?!0:g.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(h){h=g.library.math.cartesianAngleAdjust(this.x,this.y,e.a);e.x+=h.x-this.x;e.y+=
h.y-this.y;h={x:this.x+e.x,y:this.y+e.y};e=this.angle+e.a;var k=this.width,m=this.height;b||(h=f.workspacePoint2windowPoint(h.x-this.anchor.x*k,h.y-this.anchor.y*m),k=f.length(k),m=f.length(m));h=g.library.math.cartesianAngleAdjust(h.x,h.y,-e);c.save();c.rotate(e);c.drawImage(a,h.x,h.y,k,m);c.restore();if(this.dotFrame){for(c=0;c<this.extremities.points.length;c++)b=f.workspacePoint2windowPoint(this.extremities.points[c].x,this.extremities.points[c].y),d.render.drawDot(b.x,b.y,4,"rgba(50,50,50,1)");
b=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(b.x,b.y);b=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(b.x,b.y)}}}};this.image=function(){this.type="image";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=
this.width=10;this.url="";var a={};this.parameter={};this.parameter.x=function(a){return function(c){if(void 0==c)return a.x;a.x=c;a.computeExtremities()}}(this);this.parameter.y=function(a){return function(c){if(void 0==c)return a.y;a.y=c;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(c){if(void 0==c)return a.angle;a.angle=c;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(c){if(void 0==c)return a.anchor;a.anchor=c;a.computeExtremities()}}(this);
this.parameter.width=function(a){return function(c){if(void 0==c)return a.width;a.width=c;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(c){if(void 0==c)return a.height;a.height=c;a.computeExtremities()}}(this);this.getAddress=function(){var a="",e=this;do a=e.name+"/"+a;while(void 0!=(e=e.parent));return"/"+a};this.computeExtremities=function(a){for(var c=this._static,e=this;void 0!=(e=e.parent)&&!c;)c=c||e._static;this._static=c;a=void 0==a?b(this):a;this.extremities=
{points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);this.extremities.points=this.extremities.points.map(function(c){c=g.library.math.cartesianAngleAdjust(c.x,c.y,a.a);c.x+=a.x;c.y+=a.y;return c});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,e){if(void 0==this.extremities.boundingBox){console.warn("the shape",
this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:e},this.extremities.boundingBox);return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:e},this.extremities.points),a):!1};this.render=function(c,e,b){e=void 0===e?{x:0,y:0,a:0}:e;b=void 0===b?!1:b;var k=this._static?!0:g.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);
if(k){k=g.library.math.cartesianAngleAdjust(this.x,this.y,e.a);e.x+=k.x-this.x;e.y+=k.y-this.y;k=this.angle+e.a;var h=this.width,m=this.height;e={x:this.x+e.x-this.anchor.x*(this.width*Math.cos(k)+this.height*Math.sin(-k)),y:this.y+e.y-this.anchor.y*(this.width*Math.sin(k)+this.height*Math.cos(-k))};b||(e=f.workspacePoint2windowPoint(e.x,e.y),h=f.length(h),m=f.length(m));e=g.library.math.cartesianAngleAdjust(e.x,e.y,-k);a.hasOwnProperty(this.url)||(a[this.url]=new Image,a[this.url].src=this.url);
c.save();c.rotate(k);c.drawImage(a[this.url],e.x,e.y,h,m);c.restore();if(this.dotFrame){for(c=0;c<this.extremities.points.length;c++)b=f.workspacePoint2windowPoint(this.extremities.points[c].x,this.extremities.points[c].y),d.render.drawDot(b.x,b.y,4,"rgba(50,50,50,1)");b=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(b.x,b.y);b=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);
d.render.drawDot(b.x,b.y)}}}};this.path=function(){this.type="path";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.points=[];this.style={stroke:"rgba(0,0,0,0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:2};this.parameter={};this.parameter.points=function(a){return function(c){if(void 0==c)return a.points;a.points=c;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;
while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var c=this._static,e=this;void 0!=(e=e.parent)&&!c;)c=c||e._static;this._static=c;a=void 0==a?b(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=this.points.map(function(c){c=g.library.math.cartesianAngleAdjust(c.x,c.y,a.a);c.x+=a.x;c.y+=a.y;return c});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};
this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var e=!1}else e=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return e?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(a,c,b){c=void 0===c?{x:0,y:0,a:0}:c;b=void 0===b?!1:b;var e=
this._static?!0:g.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(e){e=this.points.map(function(a){a=g.library.math.cartesianAngleAdjust(a.x,a.y,c.a);return{x:a.x+c.x,y:a.y+c.y}});var k=this.style.lineWidth;b||(e=e.map(function(a){return f.workspacePoint2windowPoint(a.x,a.y)}),k=f.length(k));a.fillStyle=this.style.fill;a.strokeStyle=this.style.stroke;a.lineWidth=k;a.lineCap=this.style.lineCap;a.lineJoin=this.style.lineJoin;a.miterLimit=this.style.miterLimit;
a.beginPath();a.moveTo(e[0].x,e[0].y);for(b=1;b<e.length;b++)a.lineTo(e[b].x,e[b].y);a.stroke();if(this.dotFrame){for(b=0;b<this.extremities.points.length;b++)a=f.workspacePoint2windowPoint(this.extremities.points[b].x,this.extremities.points[b].y),d.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(a.x,a.y);a=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,
this.extremities.boundingBox.bottomRight.y);d.render.drawDot(a.x,a.y)}}}};this.rectangle=function(){this.type="rectangle";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.anchor={x:0,y:0};this.height=this.width=10;this.style={fill:"rgba(255,100,255,1)",stroke:"rgba(0,0,0,0)",lineWidth:1};this.parameter={};this.parameter.x=function(a){return function(c){if(void 0==c)return a.x;a.x=c;a.computeExtremities()}}(this);
this.parameter.y=function(a){return function(c){if(void 0==c)return a.y;a.y=c;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(c){if(void 0==c)return a.angle;a.angle=c;a.computeExtremities()}}(this);this.parameter.anchor=function(a){return function(c){if(void 0==c)return a.anchor;a.anchor=c;a.computeExtremities()}}(this);this.parameter.width=function(a){return function(c){if(void 0==c)return a.width;a.width=c;a.computeExtremities()}}(this);this.parameter.height=function(a){return function(c){if(void 0==
c)return a.height;a.height=c;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.getOffset=function(){return b(this)};this.computeExtremities=function(a,c){c=this._static;for(var e=this;void 0!=(e=e.parent)&&!c;)c=c||e._static;this._static=c;a=void 0==a?b(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfRect(this.x,this.y,this.width,this.height,-this.angle,this.anchor);
this.extremities.points=this.extremities.points.map(function(c){c=g.library.math.cartesianAngleAdjust(c.x,c.y,a.a);c.x+=a.x;c.y+=a.y;return c});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);
return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(a,c,b,m){c=void 0===c?{x:0,y:0,a:0}:c;b=void 0===b?!1:b;m=void 0===m?!1:m;var e=this._static?!0:g.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox);if(e){e=g.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=e.x-this.x;c.y+=e.y-this.y;e=this.angle+
c.a;var h=this.width,q=this.height,n=this.style.lineWidth;c={x:this.x+c.x-this.anchor.x*(this.width*Math.cos(e)+this.height*Math.sin(-e)),y:this.y+c.y-this.anchor.y*(this.width*Math.sin(e)+this.height*Math.cos(-e))};b||(c=f.workspacePoint2windowPoint(c.x,c.y),h=f.length(h),q=f.length(q),n=f.length(n));c=g.library.math.cartesianAngleAdjust(c.x,c.y,-e);if(m)a.rotate(e),b=new Path2D,b.rect(c.x,c.y,h,q),a.clip(b),a.rotate(-e);else if(a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=
n,a.save(),a.rotate(e),a.fillRect(c.x,c.y,h,q),a.strokeRect(c.x,c.y,h,q),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)b=f.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),d.render.drawDot(b.x,b.y,4,"rgba(50,50,50,1)");b=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(b.x,b.y);b=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);
d.render.drawDot(b.x,b.y)}}}};this.group=function(){function a(a,b){if(void 0==b)return a.getAddress()+" >> no element provided";if(void 0==b.name||""==b.name)return a.getAddress()+" >> element has no name";for(var c=0;c<a.children.length;c++)if(a.children[c].name==b.name)return'element with the name "'+b.name+'" already exists in the '+(void 0==parent?"design root":'group "'+a.name+'"')}this.type="group";this.name="";this.clipActive=this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;
this.extremities={points:[],boundingBox:{}};this.angle=this.y=this.x=0;this.children=[];this.clippingStencil;this.parameter={};this.parameter.x=function(a){return function(c){if(void 0==c)return a.x;a.x=c;a.computeExtremities(void 0,!0)}}(this);this.parameter.y=function(a){return function(c){if(void 0==c)return a.y;a.y=c;a.computeExtremities(void 0,!0)}}(this);this.parameter.angle=function(a){return function(c){if(void 0==c)return a.angle;a.angle=c;a.computeExtremities(void 0,!0)}}(this);this.getAddress=
function(){var a="",b=this;do a=b.name+"/"+a;while(void 0!=(b=b.parent));return"/"+a};this.clip=function(a){if(void 0==a)return this.clipActive;this.clipActive=void 0==this.clippingStencil?!1:a;this.computeExtremities()};this.stencil=function(a){if(void 0==a)return this.clippingStencil;this.clippingStencil=a;this.computeExtremities()};this.prepend=function(c){var b=a(this,c);void 0!=b?console.error("element invalid:",b):(this.children.unshift(c),c.parent=this,c.computeExtremities(void 0,!0))};this.append=
function(c){var b=a(this,c);void 0!=b?console.error("element invalid:",b):(this.children.push(c),c.parent=this,c.computeExtremities(void 0,!0))};this.remove=function(a){void 0!=a&&(a=this.children.indexOf(a),0>a||(this.children.splice(a,1),this.computeExtremities()))};this.clear=function(){this.children=[];this.computeExtremities()};this.contains=function(a){for(var c=0;c<this.children.length;c++)if(this.children[c]==a)return!0;return!1};this.getChildByName=function(a){for(var c=0;c<this.children.length;c++)if(this.children[c].name==
a)return this.children[c]};this.getElementsWithName=function(a){for(var c=[],b=0;b<this.children.length;b++)if(this.children[b].name==a&&c.push(this.children[b]),"group"==this.children[b].type)for(var e=this.children[b].getElementsWithName(a),d=0;d<e.length;d++)c.push(e[d]);return c};this.getOffset=function(){return b(this)};this.computeExtremities=function(a,e){e=void 0===e?!1:e;for(var c=void 0==a,d=this._static,f=this;void 0!=(f=f.parent)&&!d;)d=d||f._static;this._static=d;a=void 0==a?b(this):
a;if(e)for(e={x:a.x,y:a.y,a:a.a+this.angle},d=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a),e.x+=d.x,e.y+=d.y,d=0;d<this.children.length;d++)this.children[d].computeExtremities(e,!0);this.extremities={points:[],boundingBox:{}};if(this.clipActive)e={x:a.x,y:a.y,a:a.a+this.angle},d=g.library.math.cartesianAngleAdjust(this.x,this.y,a.a),e.x+=d.x,e.y+=d.y,this.clippingStencil.computeExtremities(e),this.extremities.points=this.clippingStencil.extremities.points;else{a=[];for(d=0;d<this.children.length;d++)a.push(this.children[d].extremities.boundingBox.topLeft),
a.push(this.children[d].extremities.boundingBox.bottomRight);a=g.library.math.boundingBoxFromPoints(a);this.extremities.points=[{x:a.topLeft.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.topLeft.y},{x:a.bottomRight.x,y:a.bottomRight.y},{x:a.topLeft.x,y:a.bottomRight.y}]}this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);void 0!=this.parent&&c&&this.parent.computeExtremities()};this.isPointWithin=function(a,b){if(this.clipActive)return this.clippingStencil.isPointWithin(a,
b);if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var c=!1}else c=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:b},this.extremities.boundingBox);return c?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:b},this.extremities.points),a):!1};this.getElementUnderPoint=function(a,b,e,d){e=void 0===e?!1:e;d=void 0===d?!1:d;for(var c=[],g=this.children.length-
1;0<=g;g--){var k=this.children[g]._static||e?f.workspacePoint2windowPoint(a,b):{x:a,y:b};if(!this.children[g].ignored&&this.children[g].isPointWithin(k.x,k.y))if("group"==this.children[g].type){if(k=this.children[g].getElementUnderPoint(a,b,this.children[g]._static||e,d),void 0!=k)if(d)c=c.concat(k);else return k}else if(d)c.push(this.children[g]);else return this.children[g]}if(d)return c};this.render=function(a,b,e,k){b=void 0===b?{x:0,y:0,a:0}:b;e=void 0===e?!1:e;k=void 0===k?!1:k;a:if(this._static)var c=
!0;else{for(c=0;c<this.children.length;c++)if(this.children[c]._static){c=!0;break a}c=g.library.math.detectOverlap.boundingBoxes(d.viewport.getBoundingBox(),this.extremities.boundingBox)}if(c){c=g.library.math.cartesianAngleAdjust(this.x,this.y,b.a);b={a:b.a+this.angle,x:b.x+c.x,y:b.y+c.y};if(this.clipActive||k)a.save(),this.clippingStencil.render(a,Object.assign({},b),e||this.clippingStencil._static,k||this.clipActive);for(k=0;k<this.children.length;k++)c=this.children[k],c.render(a,Object.assign({},
b),e||c._static);this.clipActive&&a.restore();if(this.dotFrame){for(k=0;k<this.extremities.points.length;k++)a=f.workspacePoint2windowPoint(this.extremities.points[k].x,this.extremities.points[k].y),d.render.drawDot(a.x,a.y,4,"rgba(50,50,50,1)");a=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(a.x,a.y);a=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(a.x,
a.y)}}}};this.text=function(){this.type="text";this.name="";this._static=this.ignored=!1;this.parent=void 0;this.dotFrame=!1;this.extremities={points:[],boundingBox:{}};this.y=this.x=0;this.text="curve";this.angle=0;this.size=1;this.style={font:"30pt Arial",align:"start",baseline:"alphabetic",fill:"rgba(255,100,100,1)",stroke:"rgba(0,0,0,0)",lineWidth:1};this.parameter={};this.parameter.x=function(a){return function(c){if(void 0==c)return a.x;a.x=c;a.computeExtremities()}}(this);this.parameter.y=
function(a){return function(c){if(void 0==c)return a.y;a.y=c;a.computeExtremities()}}(this);this.parameter.angle=function(a){return function(c){if(void 0==c)return a.angle;a.angle=c;a.computeExtremities()}}(this);this.parameter.size=function(a){return function(c){if(void 0==c)return a.size;a.size=c;a.computeExtremities()}}(this);this.getAddress=function(){var a="",c=this;do a=c.name+"/"+a;while(void 0!=(c=c.parent));return"/"+a};this.computeExtremities=function(a){for(var c=this._static,e=this;void 0!=
(e=e.parent)&&!c;)c=c||e._static;this._static=c;a=void 0==a?b(this):a;this.extremities={points:[],boundingBox:{}};this.extremities.points=g.library.math.pointsOfText(this.text,this.x,this.y,this.angle,1/this.size,this.style.font,this.style.align,this.style.baseline);this.extremities.points=this.extremities.points.map(function(c){c=g.library.math.cartesianAngleAdjust(c.x,c.y,a.a);c.x+=a.x;c.y+=a.y;return c});this.extremities.boundingBox=g.library.math.boundingBoxFromPoints(this.extremities.points);
void 0!=this.parent&&this.parent.computeExtremities()};this.isPointWithin=function(a,c){if(void 0==this.extremities.boundingBox){console.warn("the shape",this,"has no bounding box");var b=!1}else b=g.library.math.detectOverlap.pointWithinBoundingBox({x:a,y:c},this.extremities.boundingBox);return b?(void 0==this.extremities.points?(console.warn("the shape",this,"has no points"),a=!1):a=g.library.math.detectOverlap.pointWithinPoly({x:a,y:c},this.extremities.points),a):!1};this.render=function(a,c,b,
m){c=void 0===c?{x:0,y:0,a:0}:c;b=void 0===b?!1:b;m=void 0===m?!1:m;var e=g.library.math.cartesianAngleAdjust(this.x,this.y,c.a);c.x+=e.x-this.x;c.y+=e.y-this.y;e={x:this.x+c.x,y:this.y+c.y};var h=this.size;c=this.angle+c.a;var q=this.style.lineWidth;b||(e=f.workspacePoint2windowPoint(e.x,e.y),h=f.length(h));e=g.library.math.cartesianAngleAdjust(e.x,e.y,-c);if(m)console.warn("no clipping available for text shape");else if(a.font=this.style.font,a.textAlign=this.style.align,a.textBaseline=this.style.baseline,
a.fillStyle=this.style.fill,a.strokeStyle=this.style.stroke,a.lineWidth=q,a.save(),a.rotate(c),a.scale(h,h),a.fillText(this.text,e.x/h,e.y/h),a.strokeText(this.text,e.x/h,e.y/h),a.restore(),this.dotFrame){for(a=0;a<this.extremities.points.length;a++)b=f.workspacePoint2windowPoint(this.extremities.points[a].x,this.extremities.points[a].y),d.render.drawDot(b.x,b.y,4,"rgba(50,50,50,1)");b=f.workspacePoint2windowPoint(this.extremities.boundingBox.topLeft.x,this.extremities.boundingBox.topLeft.y);d.render.drawDot(b.x,
b.y);b=f.workspacePoint2windowPoint(this.extremities.boundingBox.bottomRight.x,this.extremities.boundingBox.bottomRight.y);d.render.drawDot(b.x,b.y)}}}};this.arrangement=new function(){var b=new a.group;b.name="root";this.createElement=function(c){return new a[c]};this.clear=function(){b.clear()};this.get=function(){return b};this.set=function(a){b=a};this.prepend=function(a){b.prepend(a)};this.append=function(a){b.append(a)};this.remove=function(a){b.remove(a)};this.getElementUnderPoint=function(a,
e,d,f){return b.getElementUnderPoint(a,e,void 0===d?!1:d,void 0===f?!1:f)};this.getElementsWithName=function(a){return b.getElementsWithName(a)}};this.viewport=new function(){function a(){function a(a){var c=a.charAt(0).toUpperCase()+a.slice(1),d=g.getAttribute("workspace"+c);if(b[a]!=d||b["window"+c]!=window["inner"+c])b[a]=d,b["window"+c]=window["inner"+c],void 0==d?(g[a]=b.defaultSize[a]*window.devicePixelRatio,g.style[a]=b.defaultSize[a]+"px"):d.indexOf("%")==d.length-1?(c=g.parentElement["offset"+
c],d=parseFloat(d.slice(0,d.length-1))/100,g[a]=c*d*window.devicePixelRatio,g.style[a]=c*d+"px"):(g[a]=d*window.devicePixelRatio,g.style[a]=d+"px"),e=!0}var e=!1;a("height");a("width");e&&c()}function c(){d.points.tl=f.windowPoint2workspacePoint(0,0);d.points.tr=f.windowPoint2workspacePoint(g.width,0);d.points.bl=f.windowPoint2workspacePoint(0,g.height);d.points.br=f.windowPoint2workspacePoint(g.width,g.height);d.boundingBox=g.library.math.boundingBoxFromPoints([d.points.tl,d.points.tr,d.points.br,
d.points.bl])}var b={defaultSize:{width:640,height:480},width:0,height:0,windowWidth:0,windowHeight:0},d={position:{x:0,y:0},scale:window.devicePixelRatio,angle:0,points:{tl:{x:0,y:0},tr:{x:0,y:0},bl:{x:0,y:0},br:{x:0,y:0}},boundingBox:{topLeft:{x:0,y:0},bottomRight:{x:0,y:0}}},k=void 0,t=void 0,q=!1,n=!0;this.position=function(a,b){if(void 0==a||void 0==b)return{x:d.position.x,y:d.position.y};d.position.x=a;d.position.y=b;c()};this.scale=function(a){if(void 0==a)return d.scale;d.scale=0==a?window.devicePixelRatio:
a;c()};this.angle=function(a){if(void 0==a)return d.angle;d.angle=a;c()};this.windowPoint2workspacePoint=function(a,c){return f.windowPoint2workspacePoint(a,c)};this.refresh=function(){a();c();this.allowKeyboardInput(n)};this.getBoundingBox=function(){return d.boundingBox};this.mousePosition=function(a,c){if(void 0==a||void 0==c)return{x:k,y:t};k=a;t=c};this.stopMouseScroll=function(a){if(void 0==a)return q;q=a;a||(document.body.style.overflow="")};this.allowKeyboardInput=function(a){if(void 0==a)return n;
(n=a)?g.setAttribute("tabIndex",1):g.removeAttribute("tabIndex")};this.cursor=function(a){if(void 0==a)return document.body.style.cursor;document.body.style.cursor=a}};this.render=new function(){function a(a){void 0!==a&&a||(b.fillStyle="rgb(255,255,255)",b.fillRect(0,0,g.width,g.height));d.arrangement.get().render(b)}function c(b){f=requestAnimationFrame(c);try{a()}catch(t){d.render.active(!1),console.error("major animation error"),console.error(t)}d.stats.collect(b)}var b=g.getContext("2d",{alpha:!1}),
f=void 0;this.drawDot=function(a,c,e,d){e=void 0===e?2:e;b.fillStyle=void 0===d?"rgba(150,150,255,1)":d;b.beginPath();b.arc(a,c,e,0,2*Math.PI,!1);b.closePath();b.fill()};this.frame=function(c){a(void 0===c?!1:c)};this.active=function(a){if(void 0==a)return void 0!=f;a?void 0==f&&c():void 0!=f&&(cancelAnimationFrame(f),f=void 0)}};this.stats=new function(){var a=!1,c=0,b={compute:function(a){this.frameTimeArray.push(1E3/(a-c));30<=this.frameTimeArray.length&&this.frameTimeArray.shift();this.rate=g.library.math.averageArray(this.frameTimeArray);
c=a},counter:0,frameTimeArray:[],rate:0},d={recursiveCount:function(a){void 0==a&&(this.counts={total:0,canvas:0,circle:0,group:0,image:0,path:0,polygon:0,rectangle:0,text:0},a=g.core.arrangement.get());this.counts.total++;switch(a.type){case "canvas":this.counts.canvas++;break;case "circle":this.counts.circle++;break;case "group":this.counts.group++;break;case "image":this.counts.image++;break;case "path":this.counts.path++;break;case "polygon":this.counts.polygon++;break;case "rectangle":this.counts.rectangle++;
break;case "text":this.counts.text++}if(void 0!=a.children)for(var c=0;c<a.children.length;c++)this.recursiveCount(a.children[c])},recursivePrint:function(a,c){c=void 0===c?"":c;void 0==a&&(a=g.core.arrangement.get());console.log(c+a.name);if(void 0!=a.children)for(var b=0;b<a.children.length;b++)this.recursivePrint(a.children[b],c+"- ")},counts:{total:0,canvas:0,circle:0,group:0,image:0,path:0,polygon:0,rectangle:0,text:0}};this.collect=function(c){a&&b.compute(c)};this.active=function(c){if(void 0==
c)return a;a=c};this.getReport=function(){d.recursiveCount();return{framesPerSecond:b.rate,shapeCount:d.counts}}};this.callback=new function(){for(var a="onmousedown onmouseup onmousemove onmouseenter onmouseleave onwheel onclick ondblclick onkeydown onkeyup touchstart touchmove touchend touchenter touchleave touchcancel".split(" "),c={},b=0;b<a.length;c={$jscomp$loop$prop$getRelevantShape$8:c.$jscomp$loop$prop$getRelevantShape$8},b++){c.$jscomp$loop$prop$getRelevantShape$8=function(a,c,b){var e=
d.arrangement.getElementUnderPoint(a,c);if(void 0!=e&&void 0==e[b])for(a=d.arrangement.getElementUnderPoint(a,c,void 0,!0),c=0;c<a.length;c++)if(void 0!=a[c][b]){e=a[c];break}return e};this[a[b]]=function(a,c,b){};var m=0,k=0;g[a[b]]=function(a){return function(c){return function(b){if(d.callback[c]){var e=f.windowPoint2workspacePoint(b.x,b.y),g=a.$jscomp$loop$prop$getRelevantShape$8(e.x,e.y,c);d.callback[c](e.x,e.y,b,g)}}}}(c)(a[b]);g.onmouseover=function(a){return function(c){d.viewport.stopMouseScroll()&&
(document.body.style.overflow="hidden");if(d.callback.onmouseover){var b=f.windowPoint2workspacePoint(c.x,c.y),e=a.$jscomp$loop$prop$getRelevantShape$8(b.x,b.y,"onmouseover");d.callback.onmouseover(b.x,b.y,c,e)}}}(c);g.onmouseout=function(a){return function(c){d.viewport.stopMouseScroll()&&(document.body.style.overflow="");if(d.callback.onmouseout){var b=f.windowPoint2workspacePoint(c.x,c.y),e=a.$jscomp$loop$prop$getRelevantShape$8(b.x,b.y,"onmouseout");d.callback.onmouseout(b.x,b.y,c,e)}}}(c);g.onmousemove=
function(a){return function(c){var b=f.windowPoint2workspacePoint(c.x,c.y);d.viewport.mousePosition(b.x,b.y);if(d.callback.onmousemove){var e=a.$jscomp$loop$prop$getRelevantShape$8(m,k,"onmouseleave"),g=a.$jscomp$loop$prop$getRelevantShape$8(b.x,b.y,"onmouseenter"),q=a.$jscomp$loop$prop$getRelevantShape$8(b.x,b.y,"onmousemove");e!=g&&(d.callback.onmouseleave(b.x,b.y,c,e),d.callback.onmouseenter(b.x,b.y,c,g));d.callback.onmousemove(b.x,b.y,c,q);m=b.x;k=b.y}}}(c);g.onkeydown=function(a){return function(c){if(d.callback.onkeydown){var b=
d.viewport.mousePosition(),e=a.$jscomp$loop$prop$getRelevantShape$8(b.x,b.y,"onkeydown");d.callback.onkeydown(b.x,b.y,c,e)}}}(c);g.onkeyup=function(a){return function(c){if(d.callback.onkeyup){var b=d.viewport.mousePosition(),e=a.$jscomp$loop$prop$getRelevantShape$8(b.x,b.y,"onkeyup");d.callback.onkeyup(b.x,b.y,c,e)}}}(c)}};d.viewport.refresh();d.arrangement.clear()};this.arrangement=new function(){this.get=function(){return r.arrangement.get()};this.set=function(b){return r.arrangement.set(b)};this.createElement=
function(b){return r.arrangement.createElement(b)};this.append=function(b){return r.arrangement.append(b)};this.prepend=function(b){return r.arrangement.prepend(b)};this.remove=function(b){return r.arrangement.remove(b)};this.getElementUnderPoint=function(b,d){return r.arrangement.getElementUnderPoint(b,d)};this.getElementsWithName=function(b){return r.arrangement.getElementsWithName(b)};this.forceRefresh=function(b){return r.arrangement.forceRefresh(b)}};this.viewport=new function(){this.position=
function(b,d){return r.viewport.position(b,d)};this.scale=function(b){return r.viewport.scale(b)};this.angle=function(b){return r.viewport.angle(b)};this.windowPoint2workspacePoint=function(b,d){return r.viewport.windowPoint2workspacePoint(b,d)};this.refresh=function(){r.viewport.refresh()};this.mousePosition=function(){return r.viewport.mousePosition()};this.stopMouseScroll=function(b){return r.viewport.stopMouseScroll(b)};this.allowKeyboardInput=function(b){return r.viewport.allowKeyboardInput(b)};
this.cursor=function(b){return r.viewport.cursor(b)}};this.render=new function(){this.frame=function(b){return r.render.frame(void 0===b?!1:b)};this.active=function(b){return r.render.active(b)}};this.stats=new function(){this.active=function(b){return r.stats.active(b)};this.getReport=function(){return r.stats.getReport()}};this.callback=new function(){this.onmousedown=function(b,d,f,a){};r.callback.onmousedown=function(b){return function(d,f,a,e){b.onmousedown(d,f,a,e)}}(this);this.onmouseup=function(b,
d,f,a){};r.callback.onmouseup=function(b){return function(d,f,a,e){b.onmouseup(d,f,a,e)}}(this);this.onmousemove=function(b,d,f,a){};r.callback.onmousemove=function(b){return function(d,f,a,e){b.onmousemove(d,f,a,e)}}(this);this.onmouseenter=function(b,d,f,a){};r.callback.onmouseenter=function(b){return function(d,f,a,e){b.onmouseenter(d,f,a,e)}}(this);this.onmouseleave=function(b,d,f,a){};r.callback.onmouseleave=function(b){return function(d,f,a,e){b.onmouseleave(d,f,a,e)}}(this);this.onwheel=function(b,
d,f,a){};r.callback.onwheel=function(b){return function(d,f,a,e){b.onwheel(d,f,a,e)}}(this);this.onclick=function(b,d,f,a){};r.callback.onclick=function(b){return function(d,f,a,e){b.onclick(d,f,a,e)}}(this);this.ondblclick=function(b,d,f,a){};r.callback.ondblclick=function(b){return function(d,f,a,e){b.ondblclick(d,f,a,e)}}(this);this.onkeydown=function(b,d,f,a){};r.callback.onkeydown=function(b){return function(d,f,a,e){b.onkeydown(d,f,a,e)}}(this);this.onkeyup=function(b,d,f,a){};r.callback.onkeyup=
function(b){return function(d,f,a,e){b.onkeyup(d,f,a,e)}}(this);this.touchstart=function(b,d,f){};r.callback.touchstart=function(b){return function(d,f,a,e){b.touchstart(d,f,a)}}(this);this.touchmove=function(b,d,f){};r.callback.touchmove=function(b){return function(d,f,a,e){b.touchmove(d,f,a)}}(this);this.touchend=function(b,d,f){};r.callback.touchend=function(b){return function(d,f,a,e){b.touchend(d,f,a)}}(this);this.touchenter=function(b,d,f){};r.callback.touchenter=function(b){return function(d,
f,a,e){b.touchenter(d,f,a)}}(this);this.touchleave=function(b,d,f){};r.callback.touchleave=function(b){return function(d,f,a,e){b.touchleave(d,f,a)}}(this);this.touchcancel=function(b,d,f){};r.callback.touchcancel=function(b){return function(d,f,a,e){b.touchcancel(d,f,a)}}(this)}};g.system=new function(){};g.system.mouse=new function(){function r(b,d,f,a,e){if(void 0==e)return!1;do if(void 0!=e[b])return e[b](d,f,a),!0;while(void 0!=(e=e.parent));return!1}this.tmp={};this.functionList={};this.mouseInteractionHandler=
function(b,d){g.system.mouse.tmp.onmousemove_old=g.onmousemove;g.system.mouse.tmp.onmouseleave_old=g.onmouseleave;g.system.mouse.tmp.onmouseup_old=g.onmouseup;g.onmousemove=function(d){void 0!=b&&b(d)};g.onmouseup=function(b){void 0!=d&&d(b);g.onmousemove=g.system.mouse.tmp.onmousemove_old;g.onmouseleave=g.system.mouse.tmp.onmouseleave_old;g.onmouseup=g.system.mouse.tmp.onmouseup_old};g.onmouseleave=g.onmouseup};this.forceMouseUp=function(){g.onmouseup()};g.core.callback.onmousedown=function(b,d,
f,a){r("onmousedown",b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmousedown,g.system.keyboard.pressedKeys)({event:f,x:b,y:d})};g.core.callback.onmousemove=function(b,d,f,a){r("onmousemove",b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmousemove,g.system.keyboard.pressedKeys)({event:f,x:b,y:d})};g.core.callback.onmouseup=function(b,d,f,a){r("onmouseup",b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseup,
g.system.keyboard.pressedKeys)({event:f,x:b,y:d})};g.core.callback.onmouseleave=function(b,d,f,a){r("onmouseleave",b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseleave,g.system.keyboard.pressedKeys)({event:f,x:b,y:d})};g.core.callback.onmouseenter=function(b,d,f,a){r("onmouseenter",b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onmouseenter,g.system.keyboard.pressedKeys)({event:f,x:b,y:d})};g.core.callback.onwheel=function(b,d,f,a){r("onwheel",
b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onwheel,g.system.keyboard.pressedKeys)({event:f,x:b,y:d})};g.core.callback.onclick=function(b,d,f,a){r("onclick",b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.onclick,g.system.keyboard.pressedKeys)({event:f,x:b,y:d})};g.core.callback.ondblclick=function(b,d,f,a){r("ondblclick",b,d,f,a)||g.library.structure.functionListRunner(g.system.mouse.functionList.ondblclick,g.system.keyboard.pressedKeys)({event:f,
x:b,y:d})};this.functionList.onmousedown=[];this.functionList.onmousemove=[];this.functionList.onmouseup=[];this.functionList.onmouseleave=[];this.functionList.onmouseenter=[];this.functionList.onwheel=[];this.functionList.onclick=[];this.functionList.ondblclick=[]};g.system.keyboard=new function(){function r(b,f,a,e,c){if(void 0==c)return!1;do if(void 0!=c[b])return c[b](f,a,e),!0;while(void 0!=(c=c.parent));return!1}function b(b,f){var a=g.system.keyboard.pressedKeys;if("ControlLeft"==b.code||"ControlRight"==
b.code)a.control=f;else if("AltLeft"==b.code||"AltRight"==b.code)a.alt=f;else if("MetaLeft"==b.code||"MetaRight"==b.code)a.meta=f;else if("ShiftLeft"==b.code||"ShiftRight"==b.code)a.shift=f;-1!=window.navigator.platform.indexOf("Mac")&&(a.option=a.alt,a.command=a.meta)}g.core.callback.onkeydown=function(d,f,a,e){g.system.keyboard.pressedKeys[a.code]||(g.system.keyboard.pressedKeys[a.code]=!0,b(a,!0),r("onkeydown",d,f,a,e)||g.library.structure.functionListRunner(g.system.keyboard.functionList.onkeydown,
g.system.keyboard.pressedKeys)({event:a,x:d,y:f}))};g.core.callback.onkeyup=function(d,f,a,e){g.system.keyboard.pressedKeys[a.code]&&(delete g.system.keyboard.pressedKeys[a.code],b(a,!1),r("onkeyup",d,f,a,e)||g.library.structure.functionListRunner(g.system.keyboard.functionList.onkeyup,g.system.keyboard.pressedKeys)({event:a,x:d,y:f}))};this.releaseAll=function(){for(var b=0;b<this.pressedKeys.length;b++)this.releaseKey(this.pressedKeys[b])};this.releaseKey=function(b){g.onkeyup(new KeyboardEvent("keyup",
{code:b}))};this.pressedKeys={control:!1,alt:!1,meta:!1};this.functionList={};this.functionList.onkeydown=[];this.functionList.onkeyup=[]};g.system.pane={};g.system.pane.background=g.core.arrangement.createElement("group");g.system.pane.background.name="background";g.system.pane.background._static=!0;g.system.pane.background.ignored=!0;g.core.arrangement.append(g.system.pane.background);g.system.pane.middleground=g.core.arrangement.createElement("group");g.system.pane.middleground.name="middleground";
g.core.arrangement.append(g.system.pane.middleground);g.system.pane.middleground.back=g.core.arrangement.createElement("group");g.system.pane.middleground.back.name="back";g.system.pane.middleground.append(g.system.pane.middleground.back);g.system.pane.middleground.middle=g.core.arrangement.createElement("group");g.system.pane.middleground.middle.name="middle";g.system.pane.middleground.append(g.system.pane.middleground.middle);g.system.pane.middleground.front=g.core.arrangement.createElement("group");
g.system.pane.middleground.front.name="front";g.system.pane.middleground.append(g.system.pane.middleground.front);g.system.pane.foreground=g.core.arrangement.createElement("group");g.system.pane.foreground.name="foreground";g.system.pane.foreground._static=!0;g.core.arrangement.append(g.system.pane.foreground);g.system.pane.b=g.system.pane.background;g.system.pane.mb=g.system.pane.middleground.back;g.system.pane.mm=g.system.pane.middleground.middle;g.system.pane.mf=g.system.pane.middleground.front;
g.system.pane.f=g.system.pane.foreground;g.system.pane.getMiddlegroundPane=function(r){do{if(r==g.system.pane.mb)return g.system.pane.mb;if(r==g.system.pane.mm)return g.system.pane.mm;if(r==g.system.pane.mf)return g.system.pane.mf}while(void 0!=(r=r.parent))};g._interface=new function(){var r=this;this.circuit=new function(){this.recorder=function(b){function d(){switch(a.recordingNode.node.state){case "inactive":case "paused":return f.recordingLength;case "recording":return b.currentTime-f.recordingStartTime}}
var f={recordedChunks:[],recordingStartTime:-1,recordingLength:0},a={leftIn:{},rightIn:{},recordingNode:{},leftOut:{},rightOut:{}};a.leftIn.node=b.createAnalyser();a.rightIn.node=b.createAnalyser();a.recordingNode.audioDest=new MediaStreamAudioDestinationNode(b);a.recordingNode.node=new MediaRecorder(a.recordingNode.audioDest.stream,{mimeType:"audio/webm"});a.recordingNode.node.onstart=function(){};a.recordingNode.node.ondataavailable=function(a){f.recordedChunks.push(a.data)};a.recordingNode.node.onpause=
function(){};a.recordingNode.node.onresume=function(){};a.recordingNode.node.onerror=function(a){console.log(a)};a.recordingNode.node.onstop=function(){};a.leftIn.node.connect(a.recordingNode.audioDest);a.rightIn.node.connect(a.recordingNode.audioDest);a.leftOut.node=b.createAnalyser();a.leftIn.node.connect(a.leftOut.node);a.rightOut.node=b.createAnalyser();a.rightIn.node.connect(a.rightOut.node);this.clear=function(){this.stop();f.recordedChunks=[];f.recordingStartTime=-1;f.recordingLength=0};this.start=
function(){this.clear();a.recordingNode.node.start();f.recordingStartTime=b.currentTime};this.pause=function(){"inactive"!=this.state()&&(f.recordingLength=d(),a.recordingNode.node.pause())};this.resume=function(){a.recordingNode.node.resume();f.recordingStartTime=b.currentTime-f.recordingLength};this.stop=function(){"inactive"!=this.state()&&(f.recordingLength=d(),a.recordingNode.node.stop())};this.export=function(){return new Blob(f.recordedChunks,{type:"audio/ogg; codecs=opus"})};this.save=function(a){a=
void 0===a?"output":a;var b=document.createElement("a");b.href=URL.createObjectURL(this.export());b.download=a+".ogg";document.body.appendChild(b);b.click();document.body.removeChild(b)};this.state=function(){return a.recordingNode.node.state};this.recordingTime=function(){return d()};this.getTrack=function(){return this.export()};this.in_left=function(){return a.leftIn.node};this.in_right=function(){return a.rightIn.node};this.out_left=function(){return a.leftOut.node};this.out_right=function(){return a.rightOut.node}};
this.audioIn=function(b,d){d=void 0===d?!0:d;var f=1;var a=b.createGain();g.library.audio.changeAudioParam(b,a.gain,f);this.out=function(){return a};this.listDevices=function(a){navigator.mediaDevices.enumerateDevices().then(function(b){a(b.filter(function(a){return"audioinput"===a.kind}))})};this.selectDevice=function(b){navigator.mediaDevices.getUserMedia({audio:{deviceId:b}}).then(function(b){audioDevice=b;g.library.audio.context.createMediaStreamSource(b).connect(a)},function(a){console.warn('could not find audio input device: "'+
b+'"');console.warn("\terror:",a)})};this.gain=function(e){if(null==e)return f;f=e;g.library.audio.changeAudioParam(b,a.gain,e)};d&&this.selectDevice("default")};this.looper=function(b){var d=this,f=!1,a=1,e=!0,c=0,h=1,m={},k=null,t={};t=b.createChannelSplitter(2);var q=b.createGain();q.gain.setTargetAtTime(1,b.currentTime,0);t.connect(q,0);var n=b.createGain();n.gain.setTargetAtTime(1,b.currentTime,0);t.connect(n,1);this.out_left=function(){return q};this.out_right=function(){return n};this.load=
function(a,b,c){f=!1;g.library.audio.loadAudioFile(function(a){d.stop();m=a;f=!0;b(a)},a,void 0===c?"":c)};this.start=function(){f&&(k&&(k.onended=function(){},k.stop(0)),k=g.library.audio.loadBuffer(b,m.buffer,t),k.playbackRate.value=a,k.loop=e,k.loopStart=c*this.duration(),k.loopEnd=h*this.duration(),k.start(0,0),k.onended=function(){k=null})};this.stop=function(){f&&k&&(k.stop(0),k=void 0)};this.rate=function(){a=value};this.duration=function(){return f?m.duration:-1};this.title=function(){return f?
m.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&f?g.library.audio.waveformSegment(m.buffer,a):[]};this.loop=function(a){if(void 0==data)return data;e=void 0===a?!1:a};this.loopBounds=function(a){a=void 0===a?{start:0,end:1}:a;if(void 0==a)return a;c=void 0!=a.start?a.start:c;h=void 0!=a.end?a.end:h}};this.oneShot_single=function(b){var d=this,f=!1,a=1,e={},c=null,h={};h=b.createChannelSplitter(2);var m=b.createGain();m.gain.setTargetAtTime(1,b.currentTime,
0);h.connect(m,0);var k=b.createGain();k.gain.setTargetAtTime(1,b.currentTime,0);h.connect(k,1);this.out_left=function(){return m};this.out_right=function(){return k};this.load=function(a,b,c){f=!1;g.library.audio.loadAudioFile(function(a){d.stop();e=a;f=!0;b(a)},a,void 0===c?"":c)};this.fire=function(){f&&(c&&(c.onended=function(){},c.stop(0)),c=g.library.audio.loadBuffer(b,e.buffer,h),c.playbackRate.value=a,c.start(0,0),c.onended=function(){c=null})};this.stop=function(){f&&(c.stop(0),c=void 0)};
this.rate=function(){a=value};this.duration=function(){return f?e.duration:-1};this.title=function(){return f?e.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&f?g.library.audio.waveformSegment(e.buffer,a):[]}};this.oneShot_multi=function(b){var d=this,f=!1,a=1,e={},c=[],h={};h=b.createChannelSplitter(2);var m=b.createGain();m.gain.setTargetAtTime(1,b.currentTime,0);h.connect(m,0);var k=b.createGain();k.gain.setTargetAtTime(1,b.currentTime,0);h.connect(k,
1);this.audioOut=function(a){switch(a){case "r":return k;case "l":return m;default:console.error('"part.circuit.alpha.oneShot_multi.audioOut" unknown channel "'+a+'"')}};this.out_left=function(){return this.audioOut("l")};this.out_right=function(){return this.audioOut("r")};this.loadRaw=function(a){0!==Object.keys(a).length&&(e=a,f=!0)};this.load=function(a,b,c){f=!1;g.library.audio.loadAudioFile(function(a){d.loadRaw(a);void 0!=b&&b(a)},a,c)};this.unloadRaw=function(){return e};this.fire=function(d,
k){d=void 0===d?0:d;if(f){var q=g.library.audio.loadBuffer(b,e.buffer,h,function(){c.splice(c.indexOf(this),1)});q.playbackRate.value=a;q.start(0,d*a,k*a);c.push(q)}};this.panic=function(){for(;0<c.length;)c.shift().stop(0)};this.rate=function(b){if(void 0==b)return a;0==b&&(b=1E-6);a=b};this.duration=function(){return f?e.duration/a:-1};this.title=function(){return f?e.name:""};this.waveformSegment=function(a){a=void 0===a?{start:0,end:1}:a;return void 0!=a&&f?g.library.audio.waveformSegment(e.buffer,
a):[]}};this.audio2percentage=function(){return new function(){var b=null,d=null;var f=g.library.audio.context.createAnalyser();f.fftSize=128;b=new Uint8Array(f.fftSize);new Uint8Array(f.fftSize);this.__render=function(){f.getByteTimeDomainData(b);for(var a=[],e=0;e<b.length;e++)a.push(b[e]/128-1);var c=0;a.forEach(function(a){Math.abs(a)>c&&(c=Math.abs(a))});this.newValue(c)};this.audioIn=function(){return f};this.start=function(){d=setInterval(function(a){a.__render()},1E3/30,this)};this.stop=function(){clearInterval(d)};
this.newValue=function(a){}}};this.reverbUnit=function(b){function d(e,c,d){var f=new XMLHttpRequest;f.open("GET",e+c,!0);f.responseType="arraybuffer";f.onload=function(){a.reverbNode.node.disconnect();a.reverbNode.node=b.createConvolver();a.reverbGain.node.connect(a.reverbNode.node);a.reverbNode.node.connect(a.outAggregator.node);b.decodeAudioData(f.response,function(b){a.reverbNode.node.buffer=b},function(a){console.warn("Error with decoding audio data"+a.err)});d&&d()};f.send()}function f(a,b){b=
void 0===b?null:b;var c=new XMLHttpRequest;c.open("GET",a+"available2.list",!0);c.onload=function(){var a=c.response.split("\n");a[a.length-1]=a[a.length-1].split("");a[a.length-1].pop();a[a.length-1]=a[a.length-1].join("");a.splice(-1,1);null==b?console.log(a):b(a)};c.send()}var a={inAggregator:{},reverbGain:{},bypassGain:{},reverbNode:{},outAggregator:{}};a.inAggregator.gain=1;a.inAggregator.node=b.createGain();g.library.audio.changeAudioParam(b,a.inAggregator.node.gain,a.inAggregator.gain,.01,
"instant",!0);a.reverbGain.gain=.5;a.bypassGain.gain=.5;a.reverbGain.node=b.createGain();a.bypassGain.node=b.createGain();g.library.audio.changeAudioParam(b,a.reverbGain.node.gain,a.reverbGain.gain,.01,"instant",!0);g.library.audio.changeAudioParam(b,a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0);a.reverbNode.impulseResponseRepoURL="https://metasophiea.com/lib/audio/impulseResponse/";a.reverbNode.selectedReverbType="Musikvereinsaal.wav";a.reverbNode.node=b.createConvolver();a.outAggregator.gain=
1;a.outAggregator.node=b.createGain();g.library.audio.changeAudioParam(b,a.outAggregator.node.gain,a.outAggregator.gain,.01,"instant",!0);a.inAggregator.node.connect(a.reverbGain.node);a.inAggregator.node.connect(a.bypassGain.node);a.reverbGain.node.connect(a.reverbNode.node);a.bypassGain.node.connect(a.outAggregator.node);a.reverbNode.node.connect(a.outAggregator.node);this.in=function(){return a.inAggregator.node};this.out=function(){return a.outAggregator.node};this.getTypes=function(b){f(a.reverbNode.impulseResponseRepoURL,
b)};this.type=function(b,c){if(null==b)return a.reverbNode.selectedReverbType;a.reverbNode.selectedReverbType=b;d(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType,c)};this.outGain=function(e){if(null==e)return a.outAggregator.gain;a.outAggregator.gain=e;g.library.audio.changeAudioParam(b,a.outAggregator.node.gain,e,.01,"instant",!0)};this.wetdry=function(e){if(null==e)return a.reverbGain.gain;a.reverbGain.gain=e;a.bypassGain.gain=1-e;g.library.audio.changeAudioParam(b,a.reverbGain.node.gain,
a.reverbGain.gain,.01,"instant",!0);g.library.audio.changeAudioParam(b,a.bypassGain.node.gain,a.bypassGain.gain,.01,"instant",!0)};d(a.reverbNode.impulseResponseRepoURL,a.reverbNode.selectedReverbType)};this.multibandFilter=function(b,d,f){function a(a){var c={frequency:110,Q:.1,node:b.createBiquadFilter()};c.node.type=a;g.library.audio.changeAudioParam(b,c.node.frequency,110,.01,"instant",!0);g.library.audio.changeAudioParam(b,c.node.Q,.1,.01,"instant",!0);return c}f=void 0===f?!1:f;var e=[],c=[],
h=[],m=[];var k=b.createGain();g.library.audio.changeAudioParam(b,k.gain,1,.01,"instant",!0);if(f){2>d&&(d=2);h.push(a("lowpass"));for(f=1;f<d-1;f++)h.push(a("bandpass"));h.push(a("highpass"))}else for(f=0;f<d;f++)h.push(a("bandpass"));for(f=0;f<d;f++){var t={gain:1,node:b.createGain()};g.library.audio.changeAudioParam(b,t.node.gain,t.gain,.01,"instant",!0);m.push(t);e[f]={Q:.1,gain:1,frequency:110,fresh:!0}}var q=1;var n=b.createGain();g.library.audio.changeAudioParam(b,n.gain,q,.01,"instant",!0);
for(f=0;f<d;f++)k.connect(h[f].node),h[f].node.connect(m[f].node),m[f].node.connect(n);this.in=function(){return k};this.out=function(){return n};this.masterGain=function(a){if(void 0==a)return q;q=a;g.library.audio.changeAudioParam(b,n.gain,q,.01,"instant",!0)};this.gain=function(a,c){if(void 0==c)return m[a].gain;m[a].gain=c;g.library.audio.changeAudioParam(b,m[a].node.gain,m[a].gain,.01,"instant",!0);e[a].gain=c;e[a].fresh=!0};this.frequency=function(a,c){if(void 0==c)return h[a].frequency;h[a].frequency=
c;g.library.audio.changeAudioParam(b,h[a].node.frequency,h[a].frequency,.01,"instant",!0);e[a].frequency=c;e[a].fresh=!0};this.Q=function(a,c){if(void 0==c)return h[a].Q;h[a].Q=c;g.library.audio.changeAudioParam(b,h[a].node.Q,h[a].Q,.01,"instant",!0);e[a].Q=c;e[a].fresh=!0};this.measureFrequencyResponse=function(a,b){var f=this;if(void 0==a)return Array(d).fill(0).map(function(a,c){return f.measureFrequencyResponse(c,b)});if(!e[a].fresh)return[c[a].magResponse.map(function(a){return a*q}),c[a].requencyArray];
var g=new Float32Array(b),k=new Float32Array(g.length),n=new Float32Array(g.length);h[a].node.getFrequencyResponse(g,k,n);c[a]={magResponse:k.map(function(b){return b*m[a].gain}),phaseResponse:n,frequencyArray:b};e[a].fresh=!1;return[k.map(function(b){return b*m[a].gain*q}),b]}};this.distortionUnit=function(b){function d(){f.inAggregator.node.disconnect();f.distortionNode.node&&f.distortionNode.node.disconnect();f.distortionNode.node=b.createWaveShaper();f.distortionNode.curve=new Float32Array(g.library.math.curveGenerator.s(f.distortionNode.resolution,
-1,1,f.distortionNode.distortionAmount));f.distortionNode.node.curve=f.distortionNode.curve;f.distortionNode.node.oversample=f.distortionNode.oversample;f.inAggregator.node.connect(f.distortionNode.node);f.distortionNode.node.connect(f.outAggregator.node)}var f={inAggregator:{},distortionNode:{},outAggregator:{}};f.inAggregator.gain=0;f.inAggregator.node=b.createGain();g.library.audio.changeAudioParam(b,f.inAggregator.node.gain,f.inAggregator.gain,.01,"instant",!0);f.distortionNode.distortionAmount=
0;f.distortionNode.oversample="none";f.distortionNode.resolution=100;f.outAggregator.gain=0;f.outAggregator.node=b.createGain();g.library.audio.changeAudioParam(b,f.outAggregator.node.gain,f.outAggregator.gain,.01,"instant",!0);this.in=function(){return f.inAggregator.node};this.out=function(){return f.outAggregator.node};this.inGain=function(a){if(null==a)return f.inAggregator.gain;f.inAggregator.gain=a;g.library.audio.changeAudioParam(b,f.inAggregator.node.gain,a,.01,"instant",!0)};this.outGain=
function(a){if(null==a)return f.outAggregator.gain;f.outAggregator.gain=a;g.library.audio.changeAudioParam(b,f.outAggregator.node.gain,a,.01,"instant",!0)};this.distortionAmount=function(a){if(null==a)return f.distortionNode.distortionAmount;f.distortionNode.distortionAmount=a;d()};this.oversample=function(a){if(null==a)return f.distortionNode.oversample;f.distortionNode.oversample=a;d()};this.resolution=function(a){if(null==a)return f.distortionNode.resolution;f.distortionNode.resolution=2<=a?a:
2;d()};d()};this.player=function(b){function d(){clearInterval(a.loop.timeout);a.playhead.position=a.itself.currentTime();a.playhead.lastSightingTime=b.currentTime;if(a.loop.active&&a.playing){var c=a.loop.end-a.itself.currentTime();0>c&&(c=0);a.loop.timeout=setTimeout(function(){a.itself.jumpTo(a.loop.start,!1);d()},1E3*c/a.rate)}}function f(c){a.fileLoaded&&(a.playing?(a.loop.active&&c>a.loop.end&&(c=a.loop.start),a.itself.stop(function(){a.playhead.position=c;a.playhead.lastSightingTime=b.currentTime;
a.itself.start()})):(a.playhead.position=c,a.playhead.lastSightingTime=b.currentTime))}var a={itself:this,fileLoaded:!1,playing:!1,playhead:{position:0,lastSightingTime:0},loop:{active:!1,start:0,end:1,timeout:null},rate:1},e={},c=null,h={};h=b.createChannelSplitter(2);var m=b.createGain();m.gain.setTargetAtTime(1,b.currentTime,0);h.connect(m,0);var k=b.createGain();k.gain.setTargetAtTime(1,b.currentTime,0);h.connect(k,1);this.out_left=function(){return m};this.out_right=function(){return k};this.unloadRaw=
function(){return e};this.loadRaw=function(b,c){0!==Object.keys(b).length&&(a.itself.stop(),e=b,a.fileLoaded=!0,a.playhead.position=0,c(b))};this.load=function(b,c,d){a.fileLoaded=!1;g.library.audio.loadAudioFile(function(b){a.itself.stop();e=b;a.fileLoaded=!0;a.playhead.position=0;c(b)},b,void 0===d?"":d)};this.start=function(){!a.playing&&a.fileLoaded&&(c=g.library.audio.loadBuffer(b,e.buffer,h,function(b){a.itself.stop()}),c.loop=a.loop.active,c.loopStart=a.loop.start,c.loopEnd=a.loop.end,c.playbackRate.value=
a.rate,c.start(0,a.playhead.position),a.playhead.lastSightingTime=b.currentTime,a.playing=!0,d())};this.stop=function(b){a.playing&&(b&&(c.onended=function(){b()}),c.stop(0),c=void 0,d(),a.playing=!1)};this.jumpTo=function(a,b){a=void 0===a?0:a;void 0===b||b?(a=1<a?1:a,a=0>a?0:a,f(this.duration()*a)):f(a);d()};this.loop=function(b,e){b=void 0===b?{active:!1,start:0,end:1}:b;e=void 0===e?!0:e;if(void 0==b)return a.loop;void 0!=b.active&&(a.loop.active=b.active,c&&(c.loop=b.active));if(void 0!=b.start||
void 0!=b.end)e=e?this.duration():1,a.loop.start=void 0!=b.start?b.start*e:a.loop.start,a.loop.end=void 0!=b.end?b.end*e:a.loop.end,c&&(c.loopStart=a.loop.start,c.loopEnd=a.loop.end);d()};this.rate=function(b){b=void 0===b?1:b;a.rate=b;c&&(c.playbackRate.value=b);d()};this.isLoaded=function(){return a.fileLoaded};this.duration=function(){return a.fileLoaded?e.duration:-1};this.title=function(){return a.fileLoaded?e.name:""};this.currentTime=function(){return a.fileLoaded?a.playing?a.playhead.position+
a.rate*(b.currentTime-a.playhead.lastSightingTime):a.playhead.position:-1};this.progress=function(){return this.currentTime()/this.duration()};this.waveformSegment=function(b,c){b=void 0===b?{start:0,end:1}:b;return void 0!=b&&a.fileLoaded?g.library.audio.waveformSegment(e.buffer,b,c):[]}};this.channelMultiplier=function(b,d){d=void 0===d?2:d;var f=[];var a=1;var e=b.createGain();g.library.audio.changeAudioParam(b,e.gain,a,.01,"instant",!0);for(var c=0;c<d;c++){var h={gain:.5,node:b.createGain()};
g.library.audio.changeAudioParam(b,h.node.gain,h.gain,.01,"instant",!0);f.push(h);e.connect(h.node)}this.in=function(){return e};this.out=function(a){return f[a].node};this.inGain=function(c){if(void 0==c)return a;a=c;g.library.audio.changeAudioParam(b,e.gain,a,.01,"instant",!0)};this.outGain=function(a,c){if(void 0==c)return f[a].gain;f[a].gain=c;g.library.audio.changeAudioParam(b,f[a].node.gain,f[a].gain,.01,"instant",!0)}};this.filterUnit=function(b){var d=b.createGain();g.library.audio.changeAudioParam(b,
d.gain,1,.01,"instant",!0);var f=b.createBiquadFilter();f.type="lowpass";g.library.audio.changeAudioParam(b,f.frequency,110,.01,"instant",!0);g.library.audio.changeAudioParam(b,f.gain,1,.01,"instant",!0);g.library.audio.changeAudioParam(b,f.Q,.1,.01,"instant",!0);var a=b.createGain();g.library.audio.changeAudioParam(b,a.gain,1,.01,"instant",!0);d.connect(f);f.connect(a);this.in=function(){return d};this.out=function(){return a};this.type=function(a){f.type=a};this.frequency=function(a){g.library.audio.changeAudioParam(b,
f.frequency,a,.01,"instant",!0)};this.gain=function(a){g.library.audio.changeAudioParam(b,f.gain,a,.01,"instant",!0)};this.Q=function(a){g.library.audio.changeAudioParam(b,f.Q,a,.01,"instant",!0)};this.measureFrequencyResponse=function(a,b,d){for(var c=[];a<b;a+=d)c.push(a);return this.measureFrequencyResponse_values(c)};this.measureFrequencyResponse_values=function(a){var b=new Float32Array(a),e=new Float32Array(b.length),d=new Float32Array(b.length);f.getFrequencyResponse(b,e,d);return[e,a]}};this.synthesizer=
function(b,d,f,a,e,c,h,m,k,t,q,n,y,p,l,x){f=void 0===f?{sin:[0,1],cos:[0,0]}:f;a=void 0===a?1:a;e=void 0===e?0:e;c=void 0===c?0:c;h=void 0===h?.01:h;m=void 0===m?1:m;k=void 0===k?{time:.01,curve:"linear"}:k;t=void 0===t?{time:.05,curve:"linear"}:t;l=void 0===l?.01:l;x=void 0===x?1:x;var v={},z={},w={},u={};v.waveType=void 0===d?"sine":d;v.periodicWave=f;v.attack=k;v.release=t;v.octave=void 0===q?0:q;v.detune=void 0===n?0:n;v.func=function(a,b,c,e,d,f,k,q,n,l){return new function(){this.generator=
a.createOscillator();"custom"==e?this.generator.setPeriodicWave(a.createPeriodicWave(new Float32Array(d.cos),new Float32Array(d.sin))):this.generator.type=e;this.generator.frequency.setTargetAtTime(g.library.audio.num2freq(c+12*l),a.currentTime,0);this.generator.detune.setTargetAtTime(n,a.currentTime,0);this.generator.start(0);this.gain=a.createGain();this.generator.connect(this.gain);this.gain.gain.setTargetAtTime(0,a.currentTime,0);g.library.audio.changeAudioParam(a,this.gain.gain,f,k.time,k.curve,
!1);this.gain.connect(b);this.detune=function(b,c,e){g.library.audio.changeAudioParam(a,this.generator.detune,b,c,e)};this.changeVelocity=function(b){g.library.audio.changeAudioParam(a,this.gain.gain,b,k.time,k.curve)};this.stop=function(){g.library.audio.changeAudioParam(a,this.gain.gain,0,q.time,q.curve,!1);setTimeout(function(a){a.gain.disconnect();a.generator.stop();a.generator.disconnect();a.gain=null;a.generator=null},1E3*q.time,this)}}};w.depth=void 0===y?0:y;w.period=void 0===p?0:p;w.phase=
!0;w.wave="s";w.interval=null;w.start=function(){w.period<l||w.period>=x||(w.interval=setInterval(function(){var a=Object.keys(z);if(w.phase)for(var b=0;b<a.length;b++)z[a[b]].detune(w.depth,.9*w.period,w.wave);else for(b=0;b<a.length;b++)z[a[b]].detune(-w.depth,.9*w.period,w.wave);w.phase=!w.phase},1E3*w.period))};w.stop=function(){clearInterval(w.interval)};var D=b.createGain();D.gain.setTargetAtTime(1,b.currentTime,0);u.depth=e;u.period=c;u.phase=!0;u.wave="s";u.interval=null;u.start=function(){u.period<
h||u.period>=m?g.library.audio.changeAudioParam(b,u.node.gain,1,.01,u.wave):u.interval=setInterval(function(){u.phase?g.library.audio.changeAudioParam(b,u.node.gain,1,.9*u.period,u.wave):g.library.audio.changeAudioParam(b,u.node.gain,1-u.depth,.9*u.period,u.wave);u.phase=!u.phase},1E3*u.period)};u.stop=function(){clearInterval(u.interval)};u.node=b.createGain();u.node.gain.setTargetAtTime(1,b.currentTime,0);D.connect(u.node);var B=b.createGain();B.gain.setTargetAtTime(a,b.currentTime,0);u.node.connect(B);
this.out=function(){return B};this.perform=function(a){if(z[a.num]||0!=a.velocity)z[a.num]?0==a.velocity?(z[a.num].stop(),delete z[a.num]):z[a.num].changeVelocity(a.velocity):z[a.num]=v.func(b,D,a.num,v.waveType,v.periodicWave,a.velocity,v.attack,v.release,v.detune,v.octave)};this.panic=function(){for(var a=Object.keys(z),b=0;b<a.length;b++)this.perform({num:a[b],velocity:0})};this.waveType=function(a){if(null==a)return v.waveType;v.waveType=a};this.periodicWave=function(a){if(null==a)return v.periodicWave;
v.periodicWave=a};this.gain=function(a,c,e){return g.library.audio.changeAudioParam(b,B.gain,a,c,e)};this.attack=function(a,b){if(null==a&&null==b)return v.attack;v.attack.time=a?a:v.attack.time;v.attack.curve=b?b:v.attack.curve};this.release=function(a,b){if(null==a&&null==b)return v.release;v.release.time=a?a:v.release.time;v.release.curve=b?b:v.release.curve};this.octave=function(a){if(null==a)return v.octave;v.octave=a};this.detune=function(a,b,c){if(null==a)return v.detune;var e=v.detune,d=a-
e,f=Math.round(Math.abs(d)),g=f*b,k=[1];switch(c){case "linear":k=system.utility.math.curveGenerator.linear(g);break;case "exponential":k=system.utility.math.curveGenerator.exponential(g);break;case "s":k=system.utility.math.curveGenerator.s(g,8)}if(0!=k.length)var q=setInterval(function(){v.detune=e+k.shift()*d;0==k.length&&clearInterval(q)},1E3/f);f=Object.keys(z);for(g=0;g<f.length;g++)z[f[g]].detune(a,b,c)};this.gainWobbleDepth=function(a){if(null==a)return u.depth;u.depth=a;u.stop();u.start()};
this.gainWobblePeriod=function(a){if(null==a)return u.period;u.period=a;u.stop();u.start()};this.detuneWobbleDepth=function(a){if(null==a)return w.depth;w.depth=a;w.stop();w.start()};this.detuneWobblePeriod=function(a){if(null==a)return w.period;w.period=a;w.stop();w.start()}}};this.part=new function(){var b=this;this.collection=new function(){this.basic=new function(){this.polygon=function(b,f,a,e,c,h,m,k){b=void 0===b?null:b;f=void 0===f?[]:f;a=void 0===a?!1:a;e=void 0===e?"rgba(255,100,255,1)":
e;c=void 0===c?"rgba(0,0,0,0)":c;h=void 0===h?1:h;m=void 0===m?"round":m;k=void 0===k?2:k;var d=g.core.arrangement.createElement("polygon");d.name=b;d.points=f;d.ignored=a;d.style.fill=e;d.style.stroke=c;d.style.lineWidth=h;d.style.lineJoin=m;d.style.miterLimit=k;return d};this.circle=function(b,f,a,e,c,h,m,k,t,q){b=void 0===b?null:b;f=void 0===f?0:f;a=void 0===a?0:a;e=void 0===e?2:e;c=void 0===c?!1:c;h=void 0===h?"rgba(255,100,255,1)":h;m=void 0===m?"rgba(0,0,0,0)":m;k=void 0===k?1:k;t=void 0===
t?"round":t;q=void 0===q?2:q;var d=g.core.arrangement.createElement("circle");d.name=b;d.x=f;d.y=a;d.r=e;d.ignored=c;d.style.fill=h;d.style.stroke=m;d.style.lineWidth=k;d.style.lineJoin=t;d.style.miterLimit=q;return d};this.canvas=function(b,f,a,e,c,h,m,k,t){b=void 0===b?null:b;f=void 0===f?0:f;a=void 0===a?0:a;e=void 0===e?10:e;c=void 0===c?10:c;h=void 0===h?0:h;m=void 0===m?{x:0,y:0}:m;k=void 0===k?!1:k;t=void 0===t?1:t;var d=g.core.arrangement.createElement("canvas");d.name=b;d.x=f;d.y=a;d.parameter.width(e);
d.parameter.height(c);d.resolution(t);d.angle=h;d.anchor=m;d.ignored=k;return d};this.image=function(b,f,a,e,c,h,m,k,t){b=void 0===b?null:b;f=void 0===f?0:f;a=void 0===a?0:a;e=void 0===e?10:e;c=void 0===c?10:c;h=void 0===h?0:h;m=void 0===m?{x:0,y:0}:m;k=void 0===k?!1:k;t=void 0===t?"":t;var d=g.core.arrangement.createElement("image");d.name=b;d.x=f;d.y=a;d.width=e;d.height=c;d.angle=h;d.anchor=m;d.ignored=k;d.url=t;return d};this.path=function(b,f,a,e,c,h,m,k){b=void 0===b?null:b;f=void 0===f?[]:
f;a=void 0===a?!1:a;e=void 0===e?"rgba(0,0,0,1)":e;c=void 0===c?1:c;h=void 0===h?"butt":h;m=void 0===m?"miter":m;k=void 0===k?2:k;var d=g.core.arrangement.createElement("path");d.name=b;d.points=f;d.ignored=a;d.style.stroke=e;d.style.lineWidth=c;d.style.lineCap=h;d.style.lineJoin=m;d.style.miterLimit=k;return d};this.rectangle=function(b,f,a,e,c,h,m,k,t,q,n,y,p){b=void 0===b?null:b;f=void 0===f?0:f;a=void 0===a?0:a;e=void 0===e?10:e;c=void 0===c?10:c;h=void 0===h?0:h;m=void 0===m?{x:0,y:0}:m;k=void 0===
k?!1:k;t=void 0===t?"rgba(255,100,255,1)":t;q=void 0===q?"rgba(0,0,0,0)":q;n=void 0===n?1:n;y=void 0===y?"round":y;p=void 0===p?2:p;var d=g.core.arrangement.createElement("rectangle");d.name=b;d.x=f;d.y=a;d.width=e;d.height=c;d.angle=h;d.anchor=m;d.ignored=k;d.style.fill=t;d.style.stroke=q;d.style.lineWidth=n;d.style.lineJoin=y;d.style.miterLimit=p;return d};this.group=function(b,f,a,e,c){b=void 0===b?null:b;f=void 0===f?0:f;a=void 0===a?0:a;e=void 0===e?0:e;c=void 0===c?!1:c;var d=g.core.arrangement.createElement("group");
d.name=b;d.x=f;d.y=a;d.angle=e;d.ignored=c;return d};this.text=function(b,f,a,e,c,h,m,k,t,q,n,y,p,l,x,v){b=void 0===b?null:b;f=void 0===f?0:f;a=void 0===a?0:a;e=void 0===e?"Hello":e;c=void 0===c?0:c;h=void 0===h?{x:0,y:0}:h;m=void 0===m?1:m;k=void 0===k?!1:k;t=void 0===t?"30pt Arial":t;q=void 0===q?"start":q;n=void 0===n?"alphabetic":n;y=void 0===y?"rgba(255,100,255,1)":y;p=void 0===p?"rgba(0,0,0,0)":p;l=void 0===l?1:l;x=void 0===x?"round":x;v=void 0===v?2:v;var d=g.core.arrangement.createElement("text");
d.name=b;d.x=f;d.y=a;d.text=e;d.angle=c;d.anchor=h;d.size=m;d.ignored=k;d.style.font=t;d.style.align=q;d.style.baseline=n;d.style.fill=y;d.style.stroke=p;d.style.lineWidth=l;d.style.lineJoin=x;d.style.miterLimit=v;return d}};this.control=new function(){this.rastorgrid=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l){e=void 0===e?80:e;c=void 0===c?80:c;m=void 0===m?!0:m;k=void 0===k?5:k;t=void 0===t?5:t;q=void 0===q?"rgba(200,200,200,1)":q;n=void 0===n?"rgba(150,150,150,1)":n;y=void 0===y?"rgba(220,220,220,1)":
y;p=void 0===p?"rgba(220,220,220,1)":p;l=void 0===l?function(){}:l;var h=b.builder("group",void 0===d?"rastorgrid":d,{x:f,y:a,angle:void 0===g?0:g});for(a=0;a<t;a++)for(f=0;f<k;f++)d=b.builder("checkbox_rect",a+"_"+f,{x:e/k*f,y:c/t*a,width:e/k,height:c/t,interactable:m,style:{check:n,backing:q,checkGlow:p,backingGlow:y},onchange:function(){if(h.onchange)h.onchange(h.get())}}),h.append(d);h.box=function(a,b){return h.getChildByName(b+"_"+a)};h.get=function(){for(var a=[],b=0;b<t;b++){for(var c=[],
e=0;e<k;e++)c.push(this.box(e,b).get());a.push(c)}return a};h.set=function(a,b){for(b=0;b<t;b++)for(var c=0;c<k;c++)h.box(c,b).set(a[b][c],!1)};h.clear=function(){for(var a=0;a<t;a++)for(var b=0;b<k;b++)h.box(b,a).set(!1,!1)};h.light=function(a,b,c){h.box(a,b).light(c)};h.interactable=function(a){if(void 0==a)return m;m=a;for(var b=0;b<t;b++)for(var c=0;c<k;c++)h.getChildByName(b+"_"+c).interactable(a)};h.onchange=l;return h};this.needleOverlay=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l){function x(a){return a.x*
Math.cos(B.__calculationAngle)-a.y*Math.sin(B.__calculationAngle)}function v(a){var b=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=b.x-C.extremities.points[0].x;b=b.y-C.extremities.points[0].y;return{x:(a*Math.cos(B.__calculationAngle)-b*Math.sin(B.__calculationAngle))/e,y:(b*Math.cos(B.__calculationAngle)-a*Math.sin(B.__calculationAngle))/c}}function z(a,b){var c="lead"==a?I:r;void 0==b||0>b||1<b?(c.remove(G[a]),delete D[a]):(c.contains(G[a])||c.append(G[a]),G[a].parameter.x(b*e-e*k*b),
D[a]=b)}function w(a,b){b=void 0===b?!0:b;if(t){if(void 0==a)return D.lead;1<a||0>a?z("lead"):z("lead",a);if(b&&void 0!=B.onchange)B.onchange("lead",a)}}function u(a,b,c){c=void 0===c?!0:c;if(q){if(void 0==a||void 0==b)return{A:D.selection_A,B:D.selection_B};1<a||0>a||1<b||0>b?(z("selection_A"),z("selection_B")):(z("selection_A",a),z("selection_B",b));if(void 0==D.selection_A||void 0==D.selection_B||D.selection_A==D.selection_B)r.remove(G.selection_area),B.selectionAreaToggle&&B.selectionAreaToggle(!1),
delete D.selection_area;else{r.contains(G.selection_area)||(r.append(G.selection_area),B.selectionAreaToggle&&B.selectionAreaToggle(!0));if(D.selection_A<D.selection_B)var d=D.selection_A,f=D.selection_B;else d=D.selection_B,f=D.selection_A;d=d-k*d+k;f=f-k*f-d;0>f&&(f=0);G.selection_area.parameter.x(e*d);G.selection_area.parameter.width(e*f)}if(c&&void 0!=B.onchange)B.onchange("selection_A",a);if(c&&void 0!=B.onchange)B.onchange("selection_B",b)}}e=void 0===e?120:e;c=void 0===c?60:c;h=void 0===h?
0:h;m=void 0===m?!0:m;k=void 0===k?1/512:k;t=void 0===t?!0:t;q=void 0===q?!0:q;n=void 0===n?["rgba(240, 240, 240, 1)","rgba(255, 231, 114, 1)"]:n;y=void 0===y?function(a,b){}:y;p=void 0===p?function(a,b){}:p;l=void 0===l?function(a){}:l;var D={},B=b.builder("group",void 0===d?"needleOverlay":d,{x:f,y:a,angle:h}),C=b.builder("rectangle","backing",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});B.append(C);d=b.builder("group","controlObjectsGroup");B.append(d);var r=b.builder("group","back");d.append(r);
var I=b.builder("group","front");d.append(I);d=e*k+.005*e;var G={};G.lead=b.builder("group","lead");G.lead.append(b.builder("rectangle","handle",{width:k*e,height:c,style:{fill:n[0]}}));G.lead.append(b.builder("rectangle","invisibleHandle",{x:(e*k-d)/2,width:d,height:c,style:{fill:"rgba(255,0,0,0)"}}));G.selection_A=b.builder("group","selection_A");G.selection_A.append(b.builder("rectangle","handle",{width:k*e,height:c,style:{fill:n[1]}}));G.selection_A.append(b.builder("rectangle","invisibleHandle",
{x:(e*k-d)/2,width:d,height:c,style:{fill:"rgba(255,0,0,0)"}}));G.selection_B=b.builder("group","selection_B");G.selection_B.append(b.builder("rectangle","handle",{width:k*e,height:c,style:{fill:n[1]}}));G.selection_B.append(b.builder("rectangle","invisibleHandle",{x:(e*k-d)/2,width:d,height:c,style:{fill:"rgba(255,0,0,0)"}}));G.selection_area=b.builder("rectangle","selection_area",{height:c,style:{fill:g.library.misc.blendColours(n[1],"rgba(0,0,0,0)",.5)}});G.markGroup=b.builder("group","markGroup");
r.append(G.markGroup);B.__calculationAngle=h;var A=!1,L=!1,U=!1,V=!1;C.onmousedown=function(a,b,c){if(m)if(g.system.keyboard.pressedKeys.shift){var e=v(c).x;g.system.mouse.mouseInteractionHandler(function(a){B.area(e,v(a).x)})}else B.select(v(c).x)};G.lead.getChildByName("invisibleHandle").onmouseenter=function(a,b,c){g.core.viewport.cursor("col-resize")};G.lead.getChildByName("invisibleHandle").onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};G.lead.getChildByName("invisibleHandle").onmousedown=
function(a,b,c){if(m){A=!0;var d=D.lead,f=x(c),q=e-e*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-x(a);var b=g.core.viewport.scale();a=d-a/(b*q);a=0>a?0:a;w(1<a?1:a)},function(a){a=f-x(a);var b=g.core.viewport.scale();a=d-a/(b*q);a=0>a?0:a;a=1<a?1:a;A=!1;w(a);if(void 0!=B.onrelease)B.onrelease("lead",a)})}};G.selection_A.getChildByName("invisibleHandle").onmouseenter=function(a,b,c){g.core.viewport.cursor("col-resize")};G.selection_A.getChildByName("invisibleHandle").onmouseleave=function(a,
b,c){g.core.viewport.cursor("default")};G.selection_A.getChildByName("invisibleHandle").onmousedown=function(a,b,c){if(m){U=!0;var d=D.selection_A,f=x(c),q=e-e*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-x(a);var b=g.core.viewport.scale();a=d-a/(b*q);a=0>a?0:a;u(1<a?1:a,D.selection_B)},function(a){a=f-x(a);var b=g.core.viewport.scale();a=d-a/(b*q);a=0>a?0:a;a=1<a?1:a;U=!1;u(a,D.selection_B);if(void 0!=B.onrelease)B.onrelease("selection_A",a)})}};G.selection_B.getChildByName("invisibleHandle").onmouseenter=
function(a,b,c){g.core.viewport.cursor("col-resize")};G.selection_B.getChildByName("invisibleHandle").onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};G.selection_B.getChildByName("invisibleHandle").onmousedown=function(a,b,c){if(m){V=!0;var d=D.selection_B,f=x(c),q=e-e*k;g.system.mouse.mouseInteractionHandler(function(a){a=f-x(a);var b=g.core.viewport.scale();a=d-a/(b*q);a=0>a?0:a;u(D.selection_A,1<a?1:a)},function(a){a=f-x(a);var b=g.core.viewport.scale();a=d-a/(b*q);a=0>a?0:a;a=
1<a?1:a;V=!1;u(D.selection_A,a);if(void 0!=B.onrelease)B.onrelease("selection_B",a)})}};G.selection_area.onmouseenter=function(a,b,c){g.core.viewport.cursor("grab")};G.selection_area.onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};G.selection_area.onmousedown=function(a,b,c){function d(a){a=n-x(a);var b=g.core.viewport.scale();a={A:q.A-a/(b*l),B:q.B-a/(b*l)};1<a.A&&(a.A=1,a.B=1+f);1<a.B&&(a.B=1,a.A=1-f);0>a.A&&(a.A=0,a.B=f);0>a.B&&(a.B=0,a.A=-f);return a}if(m){g.core.viewport.cursor("grabbing");
L=!0;var f=D.selection_B-D.selection_A,q={A:D.selection_A,B:D.selection_B},n=x(c),l=e-e*k;g.system.mouse.mouseInteractionHandler(function(a){a=d(a);u(a.A,a.B)},function(a){g.core.viewport.cursor("grab");a=d(a);L=!1;u(a.A,a.B);if(void 0!=B.onrelease)B.onrelease("selection_A",a.A);if(void 0!=B.onrelease)B.onrelease("selection_B",a.B)})}};G.selection_A.ondblclick=function(a,b,c,e){m&&(u(-1,-1),g.core.viewport.cursor("default"))};G.selection_B.ondblclick=G.selection_A.ondblclick;G.selection_area.ondblclick=
G.selection_A.ondblclick;B.mark=function(a){var d=G.markGroup.getChildByName(""+a);void 0==d?(G.markGroup.append(b.builder("rectangle",""+a,{x:a*e,width:k*e,height:c,style:{fill:n[0]}})),a=!0):(G.markGroup.remove(d),a=!1);return a};B.removeAllMarks=function(){G.markGroup.clear()};B.select=function(a,b){b=void 0===b?!0:b;if(void 0==a)return w();A||w(a,b)};B.area=function(a,b,c){c=void 0===c?!0:c;if(void 0==a&&void 0==b)return u();L||void 0!=a&&U||void 0!=b&&V||u(a,b,c)};B.interactable=function(a){if(void 0==
a)return m;m=a};B.onchange=y;B.onrelease=p;B.selectionAreaToggle=l;return B};this.slide=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x,v){function z(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=u.onchange)u.onchange(a);t=a;C.y=a*c*(1-k);r.y=a*c*(1-k);C.computeExtremities();r.computeExtremities()}function w(a){return a.y*Math.cos(u.__calculationAngle)-a.x*Math.sin(u.__calculationAngle)}e=void 0===e?10:e;c=void 0===c?95:c;h=void 0===h?0:h;m=void 0===m?!0:m;k=void 0===k?.1:k;t=void 0===t?0:t;q=void 0===
q?-1:q;n=void 0===n?"rgba(200,200,200,1)":n;y=void 0===y?"rgba(150,150,150,1)":y;p=void 0===p?"rgba(50,50,50,1)":p;l=void 0===l?"rgba(255,0,0,0)":l;x=void 0===x?function(){}:x;v=void 0===v?function(){}:v;var u=b.builder("group",void 0===d?"slide":d,{x:f,y:a,angle:h}),D=b.builder("group","backingAndSlotGroup");u.append(D);d=b.builder("rectangle","backing",{width:e,height:c,style:{fill:y}});D.append(d);p=b.builder("rectangle","slot",{x:.45*e,y:k/2*c,width:.1*e,height:c*(1-k),style:{fill:p}});D.append(p);
var B=b.builder("rectangle","backingAndSlotCover",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});D.append(B);var C=b.builder("rectangle","handle",{width:e,height:c*k,style:{fill:n}});u.append(C);n=c*k+.01*c;var r=b.builder("rectangle","invisibleHandle",{y:(c*k-n)/2,width:e,height:n+k,style:{fill:l}});u.append(r);u.__calculationAngle=h;var I=!1;u.set=function(a,b){I||z(a,b)};u.get=function(){return t};u.interactable=function(a){if(void 0==a)return m;m=a};u.ondblclick=function(){if(m&&!(0>q||I)&&
(z(q),void 0!=u.onrelease))u.onrelease(t)};u.onwheel=function(){if(m&&!I){var a=event.deltaY/100,b=g.core.viewport.scale();z(t+a/(10*b));if(void 0!=u.onrelease)u.onrelease(t)}};D.onmousedown=function(a,b,c){};D.onclick=function(a,b,c){if(m&&!I&&(c=D.getOffset(),a=g.library.math.cartesianAngleAdjust(a-(D.x+c.x),b-(D.y+c.y),0-(D.angle+c.a)).y/B.height,a+=.5*k*(2*a-1),z(a),void 0!=u.onrelease))u.onrelease(a)};r.onmousedown=function(a,b,e){if(m){I=!0;var d=t,f=w(e),q=c-c*k;g.system.mouse.mouseInteractionHandler(function(a){a=
f-w(a);var b=g.core.viewport.scale();z(d-a/(b*q)*window.devicePixelRatio)},function(a){a=f-w(a);var b=g.core.viewport.scale();u.onrelease(d-a/(b*q)*window.devicePixelRatio);I=!1})}};z(t);u.onchange=x;u.onrelease=v;return u};this.slidePanel=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l,x,v){e=void 0===e?80:e;c=void 0===c?95:c;g=void 0===g?0:g;m=void 0===m?!0:m;t=void 0===t?8:t;q=void 0===q?0:q;n=void 0===n?.5:n;y=void 0===y?"rgba(200,200,200,1)":y;p=void 0===p?"rgba(150,150,150,1)":p;l=void 0===l?"rgba(50,50,50,1)":
l;var h=b.builder("group",void 0===d?"slidePanel":d,{x:f,y:a,angle:g});for(d=0;d<t;d++)f=b.builder("slide","slide_"+d,{x:e/t*d,y:0,width:e/t,height:c,interactable:m,value:q,resetValue:n,style:{handle:y,backing:p,slot:l},onchange:function(a){if(h.onchange)h.onchange(this.id,a)},onrelease:function(a){if(h.onrelease)h.onrelease(this.id,a)}}),f.__calculationAngle=g,h.append(f);h.interactable=function(a){if(void 0==a)return m;m=a;for(var b=0;b<t;b++)h.children[b].interactable(a)};return h};this.rangeslide=
function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x,v,z,w){function u(a,b,e){e=void 0===e?!0:e;a=1<a?1:a;a=0>a?0:a;switch(b){default:console.error("unknown handle to adjust");break;case "start":1<=a/(1-k/(1-k))&&(a=1-k/(1-k));var d=a+(1-a)*k,f=q.end-q.end*k;d>=f&&(q.end=d/(1-k));break;case "end":1>=a/(k/(1-k))&&(a=k/(1-k)),d=q.start+(1-q.start)*k,f=a-a*k,d>=f&&(q.start=(f-k)/(1-k))}q[b]=a;L.start.parameter.y(q.start*c*(1-k));L.end.parameter.y(q.end*c*(1-k));A.parameter.y(c*(k+q.start-k*(q.start+.1)));A.parameter.height(c*
(q.end-q.start+k*(q.start-q.end-1+.2)));if(e&&r.onchange)r.onchange(q)}function D(a,b){var c=I.getOffset();return g.library.math.cartesianAngleAdjust(a-(I.x+c.x),b-(I.y+c.y),0-(I.angle+c.a)).y/G.height}e=void 0===e?10:e;c=void 0===c?95:c;m=void 0===m?!0:m;k=void 0===k?.1:k;t=void 0===t?.75:t;q=void 0===q?{start:0,end:1}:q;n=void 0===n?{start:-1,end:-1}:n;y=void 0===y?"rgba(200,200,200,1)":y;p=void 0===p?"rgba(150,150,150,1)":p;l=void 0===l?"rgba(50,50,50,1)":l;x=void 0===x?"rgba(255,0,0,0)":x;v=void 0===
v?"rgba(200,0,200,0.5)":v;z=void 0===z?function(){}:z;w=void 0===w?function(){}:w;var B=!1,C=["start","end"],r=b.builder("group",void 0===d?"rangeslide":d,{x:f,y:a,angle:void 0===h?0:h}),I=b.builder("group","backingAndSlotGroup");r.append(I);d=b.builder("rectangle","backing",{width:e,height:c,style:{fill:p}});I.append(d);l=b.builder("rectangle","slot",{x:.45*e,y:k/2*c,width:.1*e,height:c*(1-k),style:{fill:l}});I.append(l);var G=b.builder("rectangle","backingAndSlotCover",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});
I.append(G);var A=b.builder("rectangle","span",{x:(1-t)/2*e,y:c*k,width:e*t,height:c-2*c*k,style:{fill:v}});r.append(A);var L={};for(t=0;t<C.length;t++)L[C[t]]=b.builder("group","handle_"+t,{}),r.append(L[C[t]]),v=b.builder("rectangle","handle",{width:e,height:c*k,style:{fill:y}}),L[C[t]].append(v),v=c*k+.01*c,v=b.builder("rectangle","invisibleHandle",{y:(c*k-v)/2,width:e,height:v+k,style:{fill:x}}),L[C[t]].append(v);r.get=function(){return q};r.set=function(a,b){B||(void 0!=a.start&&u(a.start,"start",
b),void 0!=a.end&&u(a.end,"end",b))};r.interactable=function(a){if(void 0==a)return m;m=a};I.onmousedown=function(a,b,c){};I.onclick=function(a,b,c){m&&!B&&(a=D(a,b),a+=.5*k*(2*a-1),Math.abs(q.start-a)<Math.abs(q.end-a)?u(a,"start"):u(a,"end"))};r.ondblclick=function(){!m||0>n.start||0>n.end||B||(u(n.start,"start"),u(n.end,"end"),r.onrelease(q))};r.onwheel=function(){if(m&&!B){var a=event.deltaY/100,b=g.core.viewport.scale();a/=10*b;u(q.start-a,"start");u(q.end+a,"end")}};A.onmousedown=function(a,
b,c){if(m){B=!0;var e=q.start,d=D(a,b);g.system.mouse.mouseInteractionHandler(function(a){a=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=D(a.x,a.y);a=e+(a-d);a=[a,a+(q.end-q.start)];0>=a[0]?(a[1]-=a[0],a[0]=0):1<=a[1]&&(a[0]-=a[1]-1,a[1]=1);u(a[0],"start");u(a[1],"end");r.onchange(q)},function(a){r.onrelease(q);B=!1})}};for(t=0;t<C.length;t++)L[C[t]].children[1].onmousedown=function(a){return function(b,c,e){if(m){B=!0;var d=q[C[a]],f=D(b,c);g.system.mouse.mouseInteractionHandler(function(b){b=
g.core.viewport.windowPoint2workspacePoint(b.x,b.y);b=D(b.x,b.y);u(d+(b-f)/(1-k),C[a]);r.onchange(q)},function(a){r.onrelease(q);B=!1})}}}(t);r.onchange=z;r.onrelease=w;u(0,"start");u(1,"end");return r};this.checkbox_rect=function(d,f,a,e,c,g,m,k,t,q,n,y){function h(){z.glowing?(x.style.fill=n,v.style.fill=z.checked?q:"rgba(0,0,0,0)"):(x.style.fill=t,v.style.fill=z.checked?k:"rgba(0,0,0,0)")}e=void 0===e?20:e;c=void 0===c?20:c;m=void 0===m?!0:m;k=void 0===k?"rgba(150,150,150,1)":k;t=void 0===t?"rgba(200,200,200,1)":
t;q=void 0===q?"rgba(220,220,220,1)":q;n=void 0===n?"rgba(220,220,220,1)":n;y=void 0===y?function(){}:y;var l=b.builder("group",void 0===d?"checkbox_rect":d,{x:f,y:a,angle:void 0===g?0:g}),x=b.builder("rectangle","backing",{width:e,height:c,style:{fill:t}});l.append(x);var v=b.builder("rectangle","checkrect",{x:.1*e,y:.1*c,width:.8*e,height:.8*c,style:{fill:"rgba(0,0,0,0)"}});l.append(v);d=b.builder("rectangle","cover",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});l.append(d);var z={checked:!1,
glowing:!1};l.get=function(){return z.checked};l.set=function(a,b){b=void 0===b?!0:b;z.checked=a;h();if(b&&this.onchange)this.onchange(a)};l.light=function(a){if(void 0==a)return a.glowing;a.glowing=a;h()};l.interactable=function(a){if(void 0==a)return m;m=a};d.onclick=function(a){m&&l.set(!l.get())};d.onmousedown=function(){};l.onchange=y;return l};this.sequencer=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x,v,z,w,u,D,B,C,r,I,G,A,L){function M(a){var b=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);
a=b.x-ea.extremities.points[0].x;b=b.y-ea.extremities.points[0].y;return{x:(a*Math.cos(J.__calculationAngle)-b*Math.sin(J.__calculationAngle))/e,y:(b*Math.cos(J.__calculationAngle)-a*Math.sin(J.__calculationAngle))/c}}function Ga(a){return{x:F.viewArea.topLeft.x+a.x*q,y:F.viewArea.topLeft.y+a.y*n}}function H(a){return{x:q*(a.x-F.viewposition.x)+F.viewposition.x,y:n*(a.y-F.viewposition.y)+F.viewposition.y}}function O(a){a.y=Math.floor(a.y*t);a.y>=t&&(a.y=t-1);a.x=E.snapping?Math.round(a.x*k/E.step)*
E.step:a.x*k;0>a.x&&(a.x=0);return{line:a.y,position:a.x}}function W(a,b,d){if(void 0==a&&void 0==b)return F.viewposition;if(void 0==a||isNaN(a))a=F.viewposition.x;if(void 0==b||isNaN(b))b=F.viewposition.y;a=0>a?0:a;a=1<a?1:a;b=0>b?0:b;b=1<b?1:b;F.viewposition.x=a;F.viewposition.y=b;N.parameter.x(-F.viewposition.x*(F.totalSize.width-e));N.parameter.y(-F.viewposition.y*(F.totalSize.height-c));F.viewArea={topLeft:{x:a-q*a,y:b-n*b},bottomRight:{x:a+q*(1-a),y:b+n*(1-b)}}}function X(a,b){if(void 0==a&&
void 0==b)return{x:q,y:n};if(void 0!=a&&a!=q&&void 0!=b&&b!=n){a=.01>a?.01:a;b=.01>b?.01:b;q=1<a?1:a;n=1<b?1:b;F.totalSize.width=e/q;F.totalSize.height=c/n;S.parameter.width(F.totalSize.width);S.parameter.height(F.totalSize.width);Z.parameter.width(F.totalSize.width);Z.parameter.height(F.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.x(e/(k*q)*a),P.children[a].parameter.width(e/(k*q)),P.children[a].parameter.height(F.totalSize.height);for(a=0;a<t;a++)Q.children[a].parameter.y(c/(t*n)*a),
Q.children[a].parameter.height(c/(t*n)),Q.children[a].parameter.width(F.totalSize.width);for(a=0;a<R.children.length;a++)R.children[a].unit(e/(k*q),c/(t*n));K.present&&(N.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(F.totalSize.height),N.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(F.totalSize.height),N.getElementsWithName("playhead")[0].parameter.x(F.totalSize.width/k*K.position))}else if(void 0!=a&&a!=q){a=.01>
a?.01:a;q=1<a?1:a;F.totalSize.width=e/q;S.parameter.width(F.totalSize.width);Z.parameter.width(F.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.x(e/(k*q)*a),P.children[a].parameter.width(e/(k*q));for(a=0;a<t;a++)Q.children[a].parameter.width(F.totalSize.width);for(a=0;a<R.children.length;a++)R.children[a].unit(e/(k*q),void 0);K.present&&N.getElementsWithName("playhead")[0].parameter.x(F.totalSize.width/k*K.position)}else if(void 0!=b&&b!=n){b=.01>b?.01:b;n=1<b?1:b;F.totalSize.height=c/n;
S.parameter.height(F.totalSize.width);Z.parameter.height(F.totalSize.width);for(a=0;a<k;a++)P.children[a].parameter.height(F.totalSize.height);for(a=0;a<t;a++)Q.children[a].parameter.y(c/(t*n)*a),Q.children[a].parameter.height(c/(t*n));for(a=0;a<R.children.length;a++)R.children[a].unit(void 0,c/(t*n));K.present&&(N.getElementsWithName("playhead")[0].getElementsWithName("main")[0].parameter.height(F.totalSize.height),N.getElementsWithName("playhead")[0].getElementsWithName("invisibleHandle")[0].parameter.height(F.totalSize.height))}}
function Y(a,b,d,f){f=void 0===f?E.defaultStrength:f;a=E.signalRegistry.add({line:a,position:b,length:d,strength:f});b=E.signalRegistry.getSignal(a);var h=fa.sequencer.signalBlock(a,e/(k*q),c/(t*n),b.line,b.position,b.length,b.strength,!1,l,x,v,z);R.append(h);h.select=function(a){a=void 0===a?!1:a;-1!=E.selectedSignals.indexOf(this)?a||this.deselect():(this.selected(!0),E.selectedSignals.push(this),this.glow(!0))};h.deselect=function(){E.selectedSignals.splice(E.selectedSignals.indexOf(this),1);this.selected(!1);
this.glow(!1)};h.delete=function(){this.deselect();E.signalRegistry.remove(parseInt(this.name));this.parent.remove(this)};h.ondblclick=function(a,b,c){if(g.system.keyboard.pressedKeys.control||g.system.keyboard.pressedKeys.command)for(a=0;a<E.selectedSignals.length;a++)E.selectedSignals[a].strength(E.defaultStrength),E.signalRegistry.update(parseInt(E.selectedSignals[a].name),{strength:E.defaultStrength})};h.body.onmousedown=function(a,b,e){if(m)if(g.system.keyboard.pressedKeys.Space)S.onmousedown(a,
b,e);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<E.selectedSignals.length;)E.selectedSignals[0].deselect();h.select(!0);var d=[];for(a=0;a<E.selectedSignals.length;a++)d.push({name:parseInt(E.selectedSignals[a].name),block:E.selectedSignals[a],starting:E.signalRegistry.getSignal(parseInt(E.selectedSignals[a].name))});if(g.system.keyboard.pressedKeys.control||g.system.keyboard.pressedKeys.command){var f=d.map(function(a){return a.block.strength()}),k=e.offsetY;g.system.mouse.mouseInteractionHandler(function(a){g.system.keyboard.pressedKeys.ControlLeft||
g.system.keyboard.pressedKeys.ControlRight||g.system.keyboard.pressedKeys.command||g.system.mouse.forceMouseUp();a=(k-a.offsetY)/(g.core.viewport.scale()*c*4);for(var b=0;b<d.length;b++)d[b].block.strength(f[b]+a),E.signalRegistry.update(d[b].name,{strength:f[b]+a})})}else{var q=!1,n=O(Ga(M(e)));g.system.mouse.mouseInteractionHandler(function(a){if(!q&&(q=!0,g.system.keyboard.pressedKeys.alt))for(var b=0;b<E.selectedSignals.length;b++){var c=E.signalRegistry.getSignal(parseInt(E.selectedSignals[b].name));
Y(c.line,c.position,c.length,c.strength)}b=O(Ga(M(a)));a=b.line-n.line;b=b.position-n.position;for(c=0;c<d.length;c++){E.signalRegistry.update(d[c].name,{line:d[c].starting.line+a,position:d[c].starting.position+b});var e=E.signalRegistry.getSignal(d[c].name);d[c].block.line(e.line);d[c].block.position(e.position)}})}}};h.body.onmousemove=function(a,b,c){a=g.system.keyboard.pressedKeys;b="default";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.body.onkeydown=function(a,b,c){m&&g.system.keyboard.pressedKeys.alt&&
g.core.viewport.cursor("copy")};h.body.onkeyup=function(a,b,c){m&&(g.system.keyboard.pressedKeys.alt||g.core.viewport.cursor("default"))};h.leftHandle.onmousedown=function(a,b,c){if(m)if(g.system.keyboard.pressedKeys.Space)S.onmousedown(a,b,c);else if(g.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,c);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<E.selectedSignals.length;)E.selectedSignals[0].deselect();h.select(!0);var e=[];for(a=0;a<E.selectedSignals.length;a++)e.push({name:parseInt(E.selectedSignals[a].name),
block:E.selectedSignals[a],starting:E.signalRegistry.getSignal(parseInt(E.selectedSignals[a].name))});var d=O(Ga(M(c)));g.system.mouse.mouseInteractionHandler(function(a){a=O(Ga(M(a)));a=d.position-a.position;for(var b=0;b<e.length;b++)if(!(0>e[b].starting.position-a)){E.signalRegistry.update(e[b].name,{length:e[b].starting.length+a,position:e[b].starting.position-a});var c=E.signalRegistry.getSignal(e[b].name);e[b].block.position(c.position);e[b].block.length(c.length)}})}};h.leftHandle.onmousemove=
function(a,b,c){a=g.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.leftHandle.onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};h.rightHandle.onmousedown=function(a,b,c,e){e=void 0===e?!1:e;if(m)if(g.system.keyboard.pressedKeys.Space)S.onmousedown(a,b,c);else if(!e&&g.system.keyboard.pressedKeys.alt)h.body.onmousedown(a,b,c);else{if(!g.system.keyboard.pressedKeys.shift&&!h.selected())for(;0<E.selectedSignals.length;)E.selectedSignals[0].deselect();
h.select(!0);var d=[];for(a=0;a<E.selectedSignals.length;a++)d.push({name:parseInt(E.selectedSignals[a].name),block:E.selectedSignals[a],starting:E.signalRegistry.getSignal(parseInt(E.selectedSignals[a].name))});var f=O(Ga(M(c)));g.system.mouse.mouseInteractionHandler(function(a){a=O(Ga(M(a))).position-f.position;for(var b=0;b<d.length;b++){E.signalRegistry.update(d[b].name,{length:d[b].starting.length+a});var c=E.signalRegistry.getSignal(d[b].name);d[b].block.position(c.position);d[b].block.length(c.length)}})}};
h.rightHandle.onmousemove=function(a,b,c){a=g.system.keyboard.pressedKeys;b="col-resize";a.alt?b="copy":a.Space&&(b="grab");g.core.viewport.cursor(b)};h.rightHandle.onmouseleave=function(a,b,c){g.core.viewport.cursor("default")};return{id:a,signalBlock:h}}function ba(){var a=b.builder("group","playhead");N.append(a);a.main=b.builder("rectangle","main",{x:-K.width/2,width:K.width,height:F.totalSize.height,style:{fill:I}});a.append(a.main);a.invisibleHandle=b.builder("rectangle","invisibleHandle",{x:-K.width*
K.invisibleHandleMux/2+K.width/2,width:K.width*K.invisibleHandleMux,height:F.totalSize.height,style:{fill:"rgba(255,0,0,0)"}});a.append(a.invisibleHandle);a.invisibleHandle.onmousedown=function(){m&&(K.held=!0,g.system.mouse.mouseInteractionHandler(function(a){J.playheadPosition(O(Ga(M(a))).position)},function(){K.held=!1}))};a.invisibleHandle.onmouseenter=function(a,b,c){g.core.viewport.cursor("col-resize")};a.invisibleHandle.onmousemove=function(a,b,c){g.core.viewport.cursor("col-resize")};a.invisibleHandle.onmouseleave=
function(a,b,c){g.core.viewport.cursor("default")};K.present=!0;return a}d=void 0===d?"sequencer":d;e=void 0===e?300:e;c=void 0===c?100:c;h=void 0===h?0:h;m=void 0===m?!0:m;k=void 0===k?64:k;t=void 0===t?16:t;q=void 0===q?1:q;n=void 0===n?1:n;y=void 0===y?"rgba(20,20,20,1)":y;p=void 0===p?"rgba(209, 189, 222, 0.5)":p;l=void 0===l?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.95)",lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.95)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",
stroke:"rgba(129,209,173,0.95)",lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.95)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.95)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.95)",lineWidth:.5}]:l;x=void 0===x?[{fill:"rgba(138,138,138,0.8)",stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},
{fill:"rgba(234,238,110,0.8)",stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:x;v=void 0===v?"rgba(200,0,0,0)":v;z=void 0===z?3:z;w=void 0===w?[0,1]:w;u=void 0===u?{fill:"rgba(120,120,120,0.8)",stroke:"rgba(120,120,120,1)",lineWidth:.5}:u;D=void 0===D?[{fill:"rgba(120,120,120,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5},{fill:"rgba(100,100,100,  0)",stroke:"rgba(120,120,120,1)",
lineWidth:.5}]:D;B=void 0===B?[0]:B;C=void 0===C?{fill:"rgba(229, 221, 112,0.25)",stroke:"rgba(252,244,128,0.5)",lineWidth:.5}:C;r=void 0===r?[{fill:"rgba(30,30,30,0.5)",stroke:"rgba(120,120,120,1)",lineWidth:.5}]:r;I=void 0===I?"rgb(240, 240, 240)":I;G=void 0===G?function(a){}:G;A=void 0===A?function(a){}:A;L=void 0===L?function(a){}:L;var fa=this,F={totalSize:{width:e/q,height:c/n},viewposition:{x:0,y:0},viewArea:{topLeft:{x:0,y:0},bottomRight:{x:q,y:n}}},E={step:1,snapping:!0,defaultStrength:.5,
selectedSignals:[],activeSignals:[],signalRegistry:new g.library.structure.signalRegistry(k,t)},ca=!1,T={start:0,end:k},K={present:!1,width:.75,invisibleHandleMux:4,position:-1,held:!1,automoveViewposition:!1},J=b.builder("group",d,{x:f,y:a,angle:h}),ea=b.builder("rectangle","backing",{width:e,height:c,style:{fill:y}});J.append(ea);d=b.builder("rectangle","stencil",{width:e,height:c});J.stencil(d);J.clip(!0);var N=b.builder("group","workarea");J.append(N);d=b.builder("group","backgroundDrawArea");
N.append(d);var Q=b.builder("group","backgroundDrawArea_horizontal");d.append(Q);var P=b.builder("group","backgroundDrawArea_vertical");d.append(P);var S=b.builder("rectangle","interactionPlane_back",{width:F.totalSize.width,height:F.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});N.append(S);S.onwheel=function(a,b,c){};var R=b.builder("group","signalPane");N.append(R);var Z=b.builder("rectangle","interactionPlane_front",{width:F.totalSize.width,height:F.totalSize.height,style:{fill:"rgba(0,0,0,0)"}});
N.append(Z);Z.onwheel=function(a,b,c){};J.__calculationAngle=h;J.viewposition=W;J.viewarea=function(a,b){b=void 0===b?!0:b;if(void 0==a||void 0==a.topLeft&&void 0==a.bottomRight)return F.viewArea;void 0==a.topLeft?a.topLeft={x:F.viewArea.topLeft.x,y:F.viewArea.topLeft.y}:(void 0==a.topLeft.x&&(a.topLeft.x=F.viewArea.topLeft.x),void 0==a.topLeft.y&&(a.topLeft.y=F.viewArea.topLeft.y));void 0==a.bottomRight?a.bottomRight={x:F.bottomRight.topLeft.x,y:F.bottomRight.topLeft.ys}:(void 0==a.bottomRight.x&&
(a.bottomRight.x=F.viewArea.bottomRight.x),void 0==a.bottomRight.y&&(a.bottomRight.y=F.viewArea.bottomRight.y));var c=F.viewArea.bottomRight.x-F.viewArea.topLeft.x!=a.bottomRight.x-a.topLeft.x,e=a.bottomRight.y-a.topLeft.y!=F.viewArea.bottomRight.y-F.viewArea.topLeft.y;c&&e?X(a.bottomRight.x-a.topLeft.x,a.bottomRight.y-a.topLeft.y):c?X(a.bottomRight.x-a.topLeft.x,void 0):e&&X(void 0,a.bottomRight.y-a.topLeft.y);e=c=0;0!=1-(a.bottomRight.x-a.topLeft.x)&&(c=a.topLeft.x+(a.bottomRight.x-a.topLeft.x)/
(1-(a.bottomRight.x-a.topLeft.x))*a.topLeft.x);0!=1-(a.bottomRight.y-a.topLeft.y)&&(e=a.topLeft.y+(a.bottomRight.y-a.topLeft.y)/(1-(a.bottomRight.y-a.topLeft.y))*a.topLeft.y);W(c,e,b);F.viewArea=Object.assign(a,{})};J.step=function(a){if(void 0==a)return E.step;E.step=a};J.interactable=function(a){if(void 0==a)return m;m=a};J.glowHorizontal=function(a,b,c){for(void 0==c&&(c=b+1);b<=c;b++){var e=a?u:D[w[b%w.length]];Q.children[b].style.fill=e.fill;Q.children[b].style.stroke=e.stroke;Q.children[b].style.lineWidth=
e.lineWidth}};J.glowVertical=function(a,b,c){for(void 0==c&&(c=b+1);b<c;b++){var e=a?C:r[B[b%B.length]];P.children[b].style.fill=e.fill;P.children[b].style.stroke=e.stroke;P.children[b].style.lineWidth=e.lineWidth}};J.loopActive=function(a){if(void 0==a)return ca;ca=a;J.glowVertical(!1,0,k);ca&&J.glowVertical(!0,0>T.start?0:T.start,T.end>k?k:T.end)};J.loopPeriod=function(a,b){if(void 0==a||void 0==b)return T;a>b||0>a||0>b||(T={start:a,end:b},ca&&(J.glowVertical(!1,0,k),J.glowVertical(!0,0>a?0:a,b>
k?k:b)))};J.export=function(){return E.signalRegistry.export()};J.import=function(a){E.signalRegistry.import(a)};J.getAllSignals=function(){return E.signalRegistry.getAllSignals()};J.addSignal=function(a,b,c,e){Y(a,b,c,void 0===e?1:e)};J.addSignals=function(a){for(var b=0;b<a.length;b++)void 0!=a[b]&&null!=a[b]&&this.addSignal(a[b].line,a[b].position,a[b].length,a[b].strength)};J.eventsBetween=function(a,b){return E.signalRegistry.eventsBetween(a,b)};J.automove=function(a){if(void 0==a)return K.automoveViewposition;
K.automoveViewposition=a};J.playheadPosition=function(a,b){if(void 0==a)return K.position;K.position=a;if(void 0===b||b){a=[];for(b=0;b<E.activeSignals.length;b++){var c=E.signalRegistry.getSignal(E.activeSignals[b]);null!=c&&a.unshift({signalID:E.activeSignals[b],line:c.line,position:T.start,strength:0})}E.activeSignals=[];J.event&&0<a.length&&J.event(a)}a=N.getElementsWithName("playhead")[0];0>K.position||K.position>k?void 0!=a&&a.parent.remove(a):(void 0==a&&(a=ba()),a.parameter.x(F.totalSize.width/
k*K.position),K.automoveViewposition&&(a=k-k*q,(K.position<Math.floor(F.viewposition.x*a)||K.position>Math.floor(F.viewposition.x*a)+k*q)&&J.viewposition((K.position>a?a:K.position)/a)))};J.progress=function(){if(!K.held){var a=J.eventsBetween(K.position,K.position+E.step);if(ca&&K.position==T.start){for(var b=0;b<E.activeSignals.length;b++){var c=E.signalRegistry.getSignal(E.activeSignals[b]);null!=c&&a.unshift({signalID:E.activeSignals[b],line:c.line,position:T.start,strength:0})}E.activeSignals=
[]}for(b=0;b<a.length;b++)c=E.activeSignals.indexOf(a[b].signalID),-1!=c&&0==a[b].strength?E.activeSignals.splice(c):0<a[b].strength&&E.activeSignals.push(a[b].signalID);K.position=ca&&K.position+E.step==T.end?T.start:K.position+E.step;J.playheadPosition(K.position,!1);J.event&&0<a.length&&J.event(a)}};S.onmousedown=function(a,d,f){if(m&&(a=g.system.keyboard.pressedKeys,!a.alt||!a.Space))if(a.shift){var h=M(f),l=M(f),w=b.builder("rectangle","selectionArea",{x:h.x*e,y:h.y*c,width:0,height:0,style:{fill:p}});
J.append(w);g.system.mouse.mouseInteractionHandler(function(a){l=M(a);l.x=0>l.x?0:l.x;l.y=0>l.y?0:l.y;l.x=1<l.x?1:l.x;l.y=1<l.y?1:l.y;a=l.x-h.x;var b=l.y-h.y,d=h.x,f=h.y,g=1,k=1;0>a&&(g=-1,d+=a);0>b&&(k=-1,f+=b);w.parameter.x(d*e);w.parameter.y(f*c);w.parameter.width(g*a*e);w.parameter.height(k*b*c)},function(a){w.parent.remove(w);var b=H(h),c=H(l);b.x*=F.totalSize.width;c.y*=F.totalSize.height;c.x*=F.totalSize.width;b.y*=F.totalSize.height;a={topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};b.x<c.x?(a.topLeft.x=
b.x,a.bottomRight.x=c.x):(a.topLeft.x=c.x,a.bottomRight.x=b.x);b.y<c.y?(a.topLeft.y=b.y,a.bottomRight.y=c.y):(a.topLeft.y=c.y,a.bottomRight.y=b.y);for(;0<E.selectedSignals.length;)E.selectedSignals[0].deselect();for(b=0;b<R.children.length;b++)c=E.signalRegistry.getSignal(parseInt(R.children[b].name)),g.library.math.detectOverlap.boundingBoxes({topLeft:{x:F.totalSize.width/k*c.position,y:F.totalSize.height/t*c.line},bottomRight:{x:F.totalSize.width/k*(c.position+c.length),y:F.totalSize.height/t*(c.line+
1)}},a)&&R.children[b].select(!0)})}else if(a.alt){for(;0<E.selectedSignals.length;)E.selectedSignals[0].deselect();a=O(Ga(M(f)));a=Y(a.line,a.position,0);a.signalBlock.select();a.signalBlock.rightHandle.onmousedown(void 0,void 0,f,!0)}else if(a.Space){g.core.viewport.cursor("grabbing");var u=M(f),z=F.viewposition.x,x=F.viewposition.y;g.system.mouse.mouseInteractionHandler(function(a){a=M(a);W(z-(u.x-a.x)*q/(q-1),x-(u.y-a.y)*n/(n-1))},function(a){g.library.math.detectOverlap.pointWithinBoundingBox(Ga(M(a)),
F.viewArea)&&g.system.keyboard.pressedKeys.Space?g.core.viewport.cursor("grab"):g.core.viewport.cursor("default")})}else for(;0<E.selectedSignals.length;)E.selectedSignals[0].deselect()};S.onmousemove=function(a,b,c){m&&(a=g.system.keyboard.pressedKeys,a.alt?g.core.viewport.cursor("crosshair"):a.Space?g.core.viewport.cursor("grab"):g.core.viewport.cursor("default"))};Z.onkeydown=function(a,b,c){if(m){c=g.system.keyboard.pressedKeys;if(c.Backspace||c.Delete)for(;0<E.selectedSignals.length;)E.selectedSignals[0].delete();
c.Space&&g.core.viewport.cursor("grab");c.alt&&(void 0!=R.getElementUnderPoint(a,b)?g.core.viewport.cursor("copy"):g.core.viewport.cursor("crosshair"))}};Z.onkeyup=function(a,b,c){m&&g.core.viewport.cursor("default")};J.onpan=G;J.onchangeviewarea=A;J.event=L;(function(){Q.clear();for(var a=0;a<t;a++){var d=D[w[a%w.length]];Q.append(b.builder("rectangle","strip_horizontal_"+a,{x:0,y:c/(t*n)*a,width:F.totalSize.width,height:c/(t*n),style:{fill:d.fill,stroke:d.stroke,lineWidth:d.lineWidth}}))}P.clear();
for(a=0;a<k;a++)d=r[B[a%B.length]],P.append(b.builder("rectangle","strip_vertical_"+a,{x:e/(k*q)*a,y:0,width:e/(k*q),height:F.totalSize.height,style:{fill:d.fill,stroke:d.stroke,lineWidth:d.lineWidth}}))})();return J};this.sequencer.signalBlock=function(d,f,a,e,c,h,m,k,t,q,n,y){function p(){B.body.parameter.height(a);B.leftHandle.parameter.height(a);B.rightHandle.parameter.height(a)}function l(){B.body.parameter.width(h*f);B.rightHandle.parameter.x(h*f-y/2)}function x(){B.parameter.y(e*a)}function v(a,
b){var c=Object.assign({},a[0]);a[0].hasOwnProperty("fill")&&(c.fill=g.library.misc.multiBlendColours(a.map(function(a){return a.fill}),b));a[0].hasOwnProperty("stroke")&&(c.stroke=g.library.misc.multiBlendColours(a.map(function(a){return a.stroke}),b));return c}m=void 0===m?1:m;k=void 0===k?!1:k;t=void 0===t?[{fill:"rgba(138,138,138,0.6)",stroke:"rgba(175,175,175,0.8)",lineWidth:.5},{fill:"rgba(130,199,208,0.6)",stroke:"rgba(130,199,208,0.8)",lineWidth:.5},{fill:"rgba(129,209,173,0.6)",stroke:"rgba(129,209,173,0.8)",
lineWidth:.5},{fill:"rgba(234,238,110,0.6)",stroke:"rgba(234,238,110,0.8)",lineWidth:.5},{fill:"rgba(249,178,103,0.6)",stroke:"rgba(249,178,103,0.8)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.6)",stroke:"rgba(255, 69, 69,0.8)",lineWidth:.5}]:t;q=void 0===q?[{fill:"rgba(138,138,138,0.8)",stroke:"rgba(175,175,175,1)",lineWidth:.5},{fill:"rgba(130,199,208,0.8)",stroke:"rgba(130,199,208,1)",lineWidth:.5},{fill:"rgba(129,209,173,0.8)",stroke:"rgba(129,209,173,1)",lineWidth:.5},{fill:"rgba(234,238,110,0.8)",
stroke:"rgba(234,238,110,1)",lineWidth:.5},{fill:"rgba(249,178,103,0.8)",stroke:"rgba(249,178,103,1)",lineWidth:.5},{fill:"rgba(255, 69, 69,0.8)",stroke:"rgba(255, 69, 69,1)",lineWidth:.5}]:q;n=void 0===n?"rgba(255,0,255,0)":n;y=void 0===y?5:y;var z=!1,w=y/4,u=v(t,m),D=v(q,m),B=b.builder("group",String(d),{x:c*f,y:e*a});B.body=b.builder("rectangle","body",{width:h*f,height:a,style:{fill:u.fill,stroke:u.stroke,lineWidth:u.lineWidth}});B.leftHandle=b.builder("rectangle","leftHandle",{x:-y/2,width:y,
height:a,style:{fill:n}});B.rightHandle=b.builder("rectangle","rightHandle",{x:h*f-y/2,width:y,height:a,style:{fill:n}});B.append(B.body);B.append(B.leftHandle);B.append(B.rightHandle);B.unit=function(b,e){if(void 0==b&&void 0==e)return{x:f,y:a};void 0==b?(a=e,p(),x()):(void 0==e?(f=b,l()):(f=b,a=e,l(),p(),x()),B.parameter.x(c*f))};B.line=function(a){if(void 0==a)return e;e=a;x()};B.position=function(a){if(void 0==a)return c;c=a;B.parameter.x(c*f)};B.length=function(a){if(void 0==a)return h;h=a<w/
f?w/f:a;l()};B.strength=function(a){if(void 0==a)return m;a=1<a?1:a;m=0>a?0:a;u=v(t,m);D=v(q,m);B.glow(k)};B.glow=function(a){if(void 0==a)return k;(k=a)?(B.body.style.fill=D.fill,B.body.style.stroke=D.stroke,B.body.style.lineWidth=D.lineWidth):(B.body.style.fill=u.fill,B.body.style.stroke=u.stroke,B.body.style.lineWidth=u.lineWidth)};B.selected=function(a){if(void 0==a)return z;z=a};return B};this.list=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l,x,v,z,w,u,D,B,C,r,I,A,Ga,L,H,V,da,O,W,X,Y,ba,fa,F,E,ca,T,
K,J,ea,N,Q,P,S,R,Z,ha,ia,ja,ka,la,ma,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ha,Ia,Ja,Ka,La,Na,Oa,Pa,Qa,Ra,Sa,Ta){function h(){M=[];Ma.clear();G=[];for(var a=U=Va=0,d=0;d<k.length;d++)if("space"==k[d]){var f=b.builder("rectangle",""+d,{x:0,y:a,width:e,height:c*B,style:{fill:"rgba(255,0,0,0)"}});a+=c*(B+w);Ma.append(f)}else"break"==k[d]?(f=b.builder("rectangle",""+d,{x:e*(1-D)*.5,y:a,width:e*D,height:c*u,style:{fill:r}}),a+=c*(u+w),Ma.append(f)):(f=b.builder("button_rectangle",""+
d,{x:e*(1-z)*.5,y:a,width:e*z,height:c*v,interactable:m,text_left:k[d].text_left,text_centre:k[d].text?k[d].text:k[d].text_centre,text_right:k[d].text_right,textVerticalOffset:t,textHorizontalOffsetMux:q,active:n,hoverable:p,selectable:l,pressable:x,style:{text_font:I,text_textBaseline:A,text_fill:Ga,text_stroke:L,text_lineWidth:H,background__off__fill:V,background__off__stroke:da,background__off__lineWidth:O,background__up__fill:W,background__up__stroke:X,background__up__lineWidth:Y,background__press__fill:ba,
background__press__stroke:fa,background__press__lineWidth:F,background__select__fill:E,background__select__stroke:ca,background__select__lineWidth:T,background__select_press__fill:K,background__select_press__stroke:J,background__select_press__lineWidth:ea,background__glow__fill:N,background__glow__stroke:Q,background__glow__lineWidth:P,background__glow_press__fill:S,background__glow_press__stroke:R,background__glow_press__lineWidth:Z,background__glow_select__fill:ha,background__glow_select__stroke:ia,
background__glow_select__lineWidth:ja,background__glow_select_press__fill:ka,background__glow_select_press__stroke:la,background__glow_select_press__lineWidth:ma,background__hover__fill:na,background__hover__stroke:oa,background__hover__lineWidth:pa,background__hover_press__fill:ra,background__hover_press__stroke:sa,background__hover_press__lineWidth:ua,background__hover_select__fill:va,background__hover_select__stroke:qa,background__hover_select__lineWidth:ta,background__hover_select_press__fill:wa,
background__hover_select_press__stroke:xa,background__hover_select_press__lineWidth:ya,background__hover_glow__fill:za,background__hover_glow__stroke:Aa,background__hover_glow__lineWidth:Ba,background__hover_glow_press__fill:Ca,background__hover_glow_press__stroke:Da,background__hover_glow_press__lineWidth:Ea,background__hover_glow_select__fill:Fa,background__hover_glow_select__stroke:Ha,background__hover_glow_select__lineWidth:Ia,background__hover_glow_select_press__fill:Ja,background__hover_glow_select_press__stroke:Ka,
background__hover_glow_select_press__lineWidth:La}}),f.onenter=function(a){return function(){aa.onenter(a)}}(d),f.onleave=function(a){return function(){aa.onleave(a)}}(d),f.onpress=function(a){return function(){aa.onpress(a)}}(d),f.ondblpress=function(a){return function(){aa.ondblpress(a)}}(d),f.onrelease=function(a){return function(){k[a].function&&k[a].function();aa.onrelease(a)}}(d),f.onselect=function(a){return function(b,c){aa.select(a,!0,c,!1)}}(d),f.ondeselect=function(a){return function(b,
c){aa.select(a,!1,c,!1)}}(d),a+=c*(v+w),Ma.append(f),M.push(f));return a-c*w}e=void 0===e?50:e;c=void 0===c?100:c;m=void 0===m?!0:m;k=void 0===k?[]:k;t=void 0===t?.5:t;q=void 0===q?.05:q;n=void 0===n?!0:n;y=void 0===y?!0:y;p=void 0===p?!0:p;l=void 0===l?!0:l;x=void 0===x?!0:x;v=void 0===v?.1:v;z=void 0===z?.95:z;w=void 0===w?.01:w;u=void 0===u?.0025:u;D=void 0===D?.9:D;B=void 0===B?.005:B;C=void 0===C?"rgba(230,230,230,1)":C;r=void 0===r?"rgba(195,195,195,1)":r;I=void 0===I?"5pt Arial":I;A=void 0===
A?"alphabetic":A;Ga=void 0===Ga?"rgba(0,0,0,1)":Ga;L=void 0===L?"rgba(0,0,0,0)":L;H=void 0===H?1:H;V=void 0===V?"rgba(180,180,180,1)":V;da=void 0===da?"rgba(0,0,0,0)":da;O=void 0===O?0:O;W=void 0===W?"rgba(200,200,200,1)":W;X=void 0===X?"rgba(0,0,0,0)":X;Y=void 0===Y?0:Y;ba=void 0===ba?"rgba(230,230,230,1)":ba;fa=void 0===fa?"rgba(0,0,0,0)":fa;F=void 0===F?0:F;E=void 0===E?"rgba(200,200,200,1)":E;ca=void 0===ca?"rgba(120,120,120,1)":ca;T=void 0===T?2:T;K=void 0===K?"rgba(230,230,230,1)":K;J=void 0===
J?"rgba(120,120,120,1)":J;ea=void 0===ea?2:ea;N=void 0===N?"rgba(220,220,220,1)":N;Q=void 0===Q?"rgba(0,0,0,0)":Q;P=void 0===P?0:P;S=void 0===S?"rgba(250,250,250,1)":S;R=void 0===R?"rgba(0,0,0,0)":R;Z=void 0===Z?0:Z;ha=void 0===ha?"rgba(220,220,220,1)":ha;ia=void 0===ia?"rgba(120,120,120,1)":ia;ja=void 0===ja?2:ja;ka=void 0===ka?"rgba(250,250,250,1)":ka;la=void 0===la?"rgba(120,120,120,1)":la;ma=void 0===ma?2:ma;na=void 0===na?"rgba(220,220,220,1)":na;oa=void 0===oa?"rgba(0,0,0,0)":oa;pa=void 0===
pa?0:pa;ra=void 0===ra?"rgba(240,240,240,1)":ra;sa=void 0===sa?"rgba(0,0,0,0)":sa;ua=void 0===ua?0:ua;va=void 0===va?"rgba(220,220,220,1)":va;qa=void 0===qa?"rgba(120,120,120,1)":qa;ta=void 0===ta?2:ta;wa=void 0===wa?"rgba(240,240,240,1)":wa;xa=void 0===xa?"rgba(120,120,120,1)":xa;ya=void 0===ya?2:ya;za=void 0===za?"rgba(240,240,240,1)":za;Aa=void 0===Aa?"rgba(0,0,0,0)":Aa;Ba=void 0===Ba?0:Ba;Ca=void 0===Ca?"rgba(250,250,250,1)":Ca;Da=void 0===Da?"rgba(0,0,0,0)":Da;Ea=void 0===Ea?0:Ea;Fa=void 0===
Fa?"rgba(240,240,240,1)":Fa;Ha=void 0===Ha?"rgba(120,120,120,1)":Ha;Ia=void 0===Ia?2:Ia;Ja=void 0===Ja?"rgba(250,250,250,1)":Ja;Ka=void 0===Ka?"rgba(120,120,120,1)":Ka;La=void 0===La?2:La;Na=void 0===Na?function(){}:Na;Oa=void 0===Oa?function(){}:Oa;Pa=void 0===Pa?function(){}:Pa;Qa=void 0===Qa?function(){}:Qa;Ra=void 0===Ra?function(){}:Ra;Sa=void 0===Sa?function(){}:Sa;Ta=void 0===Ta?function(){}:Ta;var M=[],G=[],U=0,Va=0,aa=b.builder("group",void 0===d?"list":d,{x:f,y:a,angle:void 0===g?0:g});
d=b.builder("rectangle","backing",{width:e,height:c,style:{fill:C}});aa.append(d);var Ma=b.builder("group","itemCollection");aa.append(Ma);var Ua=h();d=b.builder("rectangle","cover",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});aa.append(d);f=b.builder("rectangle","stencil",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});aa.stencil(f);aa.clip(!0);d.onwheel=function(a,b,c){if(m)for(a=c.deltaY/100,aa.position(aa.position()+a/10),a=0;a<M.length;a++)M[a].forceMouseLeave()};aa.position=function(a,
b){b=void 0===b?!0:b;if(void 0==a)return Va;a=0>a?0:a;Va=a=1<a?1:a;if(!(Ua<c)&&(Ma.parameter.y(-a*(Ua-c)),b&&this.onpositionchange))this.onpositionchange(a)};aa.select=function(a,b,c,e){e=void 0===e?!0:e;if(l){if(y)if(void 0!=c&&c.shiftKey){b=Math.min(U,a);a=Math.max(U,a);for(c=0;c<M.length;c++)M[c].name==""+b&&(b=c),M[c].name==""+a&&(a=c);G=[];for(c=0;c<M.length;c++)(c>a||c<b)&&M[c].select()&&M[c].select(!1,void 0,!1);for(c=b;c<=a;c++)M[c].select()||(M[c].select(!0,void 0,!1),G.push(c))}else e&&
M[a].select(b),b&&!G.includes(a)?G.push(a):!b&&G.includes(a)&&G.splice(G.indexOf(a),1),U=a;else{if(b&&!G.includes(a)){for(;0<G.length;)Ma.children[G[0]].select(!1,void 0,!1),G.shift();G.push(a)}else!b&&G.includes(a)&&(G=[]);e&&Ma.children[a].select(!0,void 0,!1)}aa.onselection(G)}};aa.add=function(a){k.push(a);Ua=h()};aa.remove=function(a){k.splice(a,1);Ua=h()};aa.interactable=function(a){if(void 0==a)return m;m=a;h()};aa.onenter=Na;aa.onleave=Oa;aa.onpress=Pa;aa.ondblpress=Qa;aa.onrelease=Ra;aa.onselection=
Sa;aa.onpositionchange=Ta;return aa};this.dial_image_continuous=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x){function v(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=z.onchange)z.onchange(a);m=a;u.parameter.angle(t+q*m);w.parameter.angle(t+q*m)}e=void 0===e?15:e;h=void 0===h?!0:h;m=void 0===m?0:m;k=void 0===k?-1:k;t=void 0===t?3*Math.PI/4:t;q=void 0===q?1.5*Math.PI:q;n=void 0===n?"http://space.alglobus.net/Basics/whyImages/earthFromSpace.gif":n;y=void 0===y?"https://i.ytimg.com/vi/JS7NYKqhrFo/hqdefault.jpg":
y;p=void 0===p?"http://coolinterestingstuff.com/wp-content/uploads/2012/09/space-4.jpg":p;l=void 0===l?function(){}:l;x=void 0===x?function(){}:x;var z=b.builder("group",void 0===d?"dial_image_continuous":d,{x:f,y:a,angle:void 0===c?0:c});d=b.builder("image","slot",{width:2.2*e,height:2.2*e,anchor:{x:.5,y:.5},url:y});z.append(d);var w=b.builder("image","handle",{width:2*e,height:2*e,anchor:{x:.5,y:.5},url:n});z.append(w);var u=b.builder("group","needleGroup",{ignored:!0});z.append(u);n=e/5;d=e;p=
b.builder("image","needle",{x:d/3,y:-n/2,height:n,width:d,url:p});u.append(p);var D=!1;z.set=function(a,b){D||v(a,b)};z.get=function(){return m};z.interactable=function(a){if(void 0==a)return h;h=a};var B=4*e;w.ondblclick=function(){if(h&&!(0>k||D)&&(v(k),void 0!=z.onrelease))z.onrelease(m)};w.onwheel=function(a,b,c){if(h&&!D&&(a=c.deltaY/100,b=g.core.viewport.scale(),v(m-a/(10*b)),void 0!=z.onrelease))z.onrelease(m)};w.onmousedown=function(a,b,c){if(h){var e=m,d=c.y;D=!0;g.system.mouse.mouseInteractionHandler(function(a){a=
a.y-d;var b=g.core.viewport.scale();v(e-a/(b*B)*window.devicePixelRatio,!0)},function(a){D=!1;if(void 0!=z.onrelease)z.onrelease(m)})}};z.onchange=l;z.onrelease=x;v(m);return z};this.dial_continuous=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x){function v(a,b){a=1<a?1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=z.onchange)z.onchange(a);m=a;w.parameter.angle(t+q*m)}e=void 0===e?15:e;h=void 0===h?!0:h;m=void 0===m?0:m;k=void 0===k?-1:k;t=void 0===t?3*Math.PI/4:t;q=void 0===q?1.5*Math.PI:q;n=void 0===n?"rgba(200,200,200,1)":
n;y=void 0===y?"rgba(50,50,50,1)":y;p=void 0===p?"rgba(250,100,100,1)":p;l=void 0===l?function(){}:l;x=void 0===x?function(){}:x;var z=b.builder("group",void 0===d?"dial_continuous":d,{x:f,y:a,angle:void 0===c?0:c});d=b.builder("circle","slot",{r:1.1*e,style:{fill:y}});z.append(d);n=b.builder("circle","handle",{r:e,style:{fill:n}});z.append(n);var w=b.builder("group","needleGroup",{ignored:!0});z.append(w);d=e/5;f=e;p=b.builder("rectangle","needle",{x:f/3,y:-d/2,height:d,width:f,style:{fill:p}});
w.append(p);var u=!1;z.set=function(a,b){u||v(a,b)};z.get=function(){return m};z.interactable=function(a){if(void 0==a)return h;h=a};var D=4*e;n.ondblclick=function(){if(h&&!(0>k||u)&&(v(k),void 0!=z.onrelease))z.onrelease(m)};n.onwheel=function(a,b,c){if(h&&!u&&(a=c.deltaY/100,b=g.core.viewport.scale(),v(m-a/(10*b)),void 0!=z.onrelease))z.onrelease(m)};n.onmousedown=function(a,b,c){if(h){var e=m,d=c.y;u=!0;g.system.mouse.mouseInteractionHandler(function(a){a=a.y-d;var b=g.core.viewport.scale();v(e-
a/(b*D)*window.devicePixelRatio,!0)},function(a){u=!1;if(void 0!=z.onrelease)z.onrelease(m)})}};z.onchange=l;z.onrelease=x;v(m);return z};this.dial_image_discrete=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x,v){function z(a,b){a=a>t-1?t-1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=w.onchange)w.onchange(a);m=a=Math.round(a);u.set(m/(t-1))}d=void 0===d?"dial_image_discrete":d;e=void 0===e?15:e;h=void 0===h?!0:h;m=void 0===m?0:m;k=void 0===k?0:k;t=void 0===t?5:t;q=void 0===q?3*Math.PI/4:q;n=void 0===n?1.5*Math.PI:
n;y=void 0===y?"https://pbs.twimg.com/profile_images/927920625347383297/-ksNZr-Z_400x400.jpg":y;p=void 0===p?"https://blueblots.com/wp-content/uploads/2009/07/space1.jpg":p;l=void 0===l?"https://i.ytimg.com/vi/kpFryXQbVEA/hqdefault.jpg":l;x=void 0===x?function(){}:x;v=void 0===v?function(){}:v;var w=b.builder("group",d,{x:f,y:a,angle:void 0===c?0:c}),u=b.builder("dial_image_continuous",d,{x:0,y:0,r:e,angle:0,interactable:h,startAngle:q,maxAngle:n,handleUrl:y,slotUrl:p,needleUrl:l});u.getChildByName("handle").ondblclick=
void 0;u.getChildByName("handle").onwheel=void 0;u.getChildByName("handle").onmousedown=void 0;w.append(u);var D=!1;w.set=function(a,b){D||z(a,b)};w.get=function(){return m};w.interactable=function(a){if(void 0==a)return h;h=a};var B=0;u.getChildByName("handle").ondblclick=function(){if(h&&!(0>k||D)&&(z(k),void 0!=w.onrelease))w.onrelease(m)};u.getChildByName("handle").onwheel=function(a,b,c){if(h&&!D&&(B+=c.deltaY/100,1<=Math.abs(B)&&(z(m-1*Math.sign(B)),B=0,void 0!=w.onrelease)))w.onrelease(m)};
u.getChildByName("handle").onmousedown=function(a,b,c){if(h){var e=m,d=c.y;D=!0;g.system.mouse.mouseInteractionHandler(function(a){z(e-Math.round((a.y-d)/25));if(void 0!=w.onchange)w.onchange(m)},function(a){D=!1;if(void 0!=w.onrelease)w.onrelease(m)})}};w.onchange=x;w.onrelease=v;z(m);return w};this.dial_discrete=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x,v){function z(a,b){a=a>t-1?t-1:a;a=0>a?0:a;if((void 0===b||b)&&void 0!=w.onchange)w.onchange(a);m=a=Math.round(a);u.set(m/(t-1))}d=void 0===d?"dial_discrete":
d;e=void 0===e?15:e;h=void 0===h?!0:h;m=void 0===m?0:m;k=void 0===k?0:k;t=void 0===t?5:t;q=void 0===q?3*Math.PI/4:q;n=void 0===n?1.5*Math.PI:n;y=void 0===y?"rgba(200,200,200,1)":y;p=void 0===p?"rgba(50,50,50,1)":p;l=void 0===l?"rgba(250,100,100,1)":l;x=void 0===x?function(){}:x;v=void 0===v?function(){}:v;var w=b.builder("group",d,{x:f,y:a,angle:void 0===c?0:c}),u=b.builder("dial_continuous",d,{x:0,y:0,r:e,angle:0,interactable:h,startAngle:q,maxAngle:n,style:{handle:y,slot:p,needle:l}});u.getChildByName("handle").ondblclick=
void 0;u.getChildByName("handle").onwheel=void 0;u.getChildByName("handle").onmousedown=void 0;w.append(u);var D=!1;w.set=function(a,b){D||z(a,b)};w.get=function(){return m};w.interactable=function(a){if(void 0==a)return h;h=a};var B=0;u.getChildByName("handle").ondblclick=function(){if(h&&!(0>k||D)&&(z(k),void 0!=w.onrelease))w.onrelease(m)};u.getChildByName("handle").onwheel=function(a,b,c){if(h&&!D&&(B+=c.deltaY/100,1<=Math.abs(B)&&(z(m-1*Math.sign(B)),B=0,void 0!=w.onrelease)))w.onrelease(m)};
u.getChildByName("handle").onmousedown=function(a,b,c){if(h){var e=m,d=c.y;D=!0;g.system.mouse.mouseInteractionHandler(function(a){z(e-Math.round((a.y-d)/25));if(void 0!=w.onchange)w.onchange(m)},function(a){D=!1;if(void 0!=w.onrelease)w.onrelease(m)})}};w.onchange=x;w.onrelease=v;z(m);return w};this.button_circle=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l,x,v,z,w,u,D,B,r,A,I,G,H,L,U,V,da,O,W,X,Y,ba,fa,F,E,ca,T,K,J,ea,N,Q,P,S,R,Z,ha,ia,ja,ka,la,ma,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa){d=
void 0===d?"button_circle":d;e=void 0===e?15:e;c=void 0===c?0:c;g=void 0===g?!0:g;m=void 0===m?"":m;k=void 0===k?!0:k;t=void 0===t?!0:t;q=void 0===q?!1:q;n=void 0===n?!0:n;y=void 0===y?"5pt Arial":y;p=void 0===p?"alphabetic":p;l=void 0===l?"rgba(0,0,0,1)":l;x=void 0===x?"rgba(0,0,0,0)":x;v=void 0===v?1:v;z=void 0===z?"rgba(180,180,180,1)":z;w=void 0===w?"rgba(0,0,0,0)":w;u=void 0===u?0:u;D=void 0===D?"rgba(200,200,200,1)":D;B=void 0===B?"rgba(0,0,0,0)":B;r=void 0===r?0:r;A=void 0===A?"rgba(230,230,230,1)":
A;I=void 0===I?"rgba(0,0,0,0)":I;G=void 0===G?0:G;H=void 0===H?"rgba(200,200,200,1)":H;L=void 0===L?"rgba(120,120,120,1)":L;U=void 0===U?.75:U;V=void 0===V?"rgba(230,230,230,1)":V;da=void 0===da?"rgba(120,120,120,1)":da;O=void 0===O?.75:O;W=void 0===W?"rgba(220,220,220,1)":W;X=void 0===X?"rgba(0,0,0,0)":X;Y=void 0===Y?0:Y;ba=void 0===ba?"rgba(250,250,250,1)":ba;fa=void 0===fa?"rgba(0,0,0,0)":fa;F=void 0===F?0:F;E=void 0===E?"rgba(220,220,220,1)":E;ca=void 0===ca?"rgba(120,120,120,1)":ca;T=void 0===
T?.75:T;K=void 0===K?"rgba(250,250,250,1)":K;J=void 0===J?"rgba(120,120,120,1)":J;ea=void 0===ea?.75:ea;N=void 0===N?"rgba(220,220,220,1)":N;Q=void 0===Q?"rgba(0,0,0,0)":Q;P=void 0===P?0:P;S=void 0===S?"rgba(240,240,240,1)":S;R=void 0===R?"rgba(0,0,0,0)":R;Z=void 0===Z?0:Z;ha=void 0===ha?"rgba(220,220,220,1)":ha;ia=void 0===ia?"rgba(120,120,120,1)":ia;ja=void 0===ja?.75:ja;ka=void 0===ka?"rgba(240,240,240,1)":ka;la=void 0===la?"rgba(120,120,120,1)":la;ma=void 0===ma?.75:ma;na=void 0===na?"rgba(240,240,240,1)":
na;oa=void 0===oa?"rgba(0,0,0,0)":oa;pa=void 0===pa?0:pa;ra=void 0===ra?"rgba(250,250,250,1)":ra;sa=void 0===sa?"rgba(0,0,0,0)":sa;ua=void 0===ua?0:ua;va=void 0===va?"rgba(240,240,240,1)":va;qa=void 0===qa?"rgba(120,120,120,1)":qa;ta=void 0===ta?.75:ta;wa=void 0===wa?"rgba(250,250,250,1)":wa;xa=void 0===xa?"rgba(120,120,120,1)":xa;ya=void 0===ya?.75:ya;za=void 0===za?function(a){}:za;Aa=void 0===Aa?function(a){}:Aa;Ba=void 0===Ba?function(a){}:Ba;Ca=void 0===Ca?function(a){}:Ca;Da=void 0===Da?function(a){}:
Da;Ea=void 0===Ea?function(a){}:Ea;Fa=void 0===Fa?function(a){}:Fa;var h=b.builder("group",d+"subGroup",{}),C=b.builder("circle","backing",{r:e,style:{fill:z,stroke:w,lineWidth:u}});h.append(C);m=b.builder("text","centre",{text:m,style:{font:y,testBaseline:p,fill:l,stroke:x,lineWidth:v,textAlign:"center",textBaseline:"middle"}});h.append(m);h.cover=b.builder("circle","cover",{r:e,style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);d=b.builder("button_",d,{x:f,y:a,angle:c,interactable:g,active:k,hoverable:t,
selectable:q,pressable:n,onenter:za,onleave:Aa,onpress:Ba,ondblpress:Ca,onrelease:Da,onselect:Ea,ondeselect:Fa,subject:h});d.activateGraphicalState=function(a){if(k){var b=[{fill:D,stroke:B,lineWidth:r},{fill:A,stroke:I,lineWidth:G},{fill:H,stroke:L,lineWidth:U},{fill:V,stroke:da,lineWidth:O},{fill:W,stroke:X,lineWidth:Y},{fill:ba,stroke:fa,lineWidth:F},{fill:E,stroke:ca,lineWidth:T},{fill:K,stroke:J,lineWidth:ea},{fill:N,stroke:Q,lineWidth:P},{fill:S,stroke:R,lineWidth:Z},{fill:ha,stroke:ia,lineWidth:ja},
{fill:ka,stroke:la,lineWidth:ma},{fill:na,stroke:oa,lineWidth:pa},{fill:ra,stroke:sa,lineWidth:ua},{fill:va,stroke:qa,lineWidth:ta},{fill:wa,stroke:xa,lineWidth:ya}];!t&&a.hovering&&(a.hovering=!1);!q&&a.selected&&(a.selected=!1);a=8*a.hovering+4*a.glowing+2*a.selected+1*(n&&a.pressed);C.style.fill=b[a].fill;C.style.stroke=b[a].stroke;C.style.lineWidth=b[a].lineWidth}else C.style.fill=z,C.style.stroke=w,C.style.lineWidth=u};d.activateGraphicalState({hovering:!1,glowing:!1,selected:!1,pressed:!1});
return d};this.button_rectangle=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l,x,v,z,w,u,D,B,r,A,I,G,H,L,U,V,da,O,W,X,Y,ba,fa,F,E,ca,T,K,J,ea,N,Q,P,S,R,Z,ha,ia,ja,ka,la,ma,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ha,Ia,Ja,Ka,La){d=void 0===d?"button_rectangle":d;e=void 0===e?30:e;c=void 0===c?20:c;g=void 0===g?0:g;m=void 0===m?!0:m;k=void 0===k?"":k;t=void 0===t?"":t;q=void 0===q?"":q;n=void 0===n?.5:n;y=void 0===y?.05:y;p=void 0===p?!0:p;l=void 0===l?!0:l;x=void 0===x?!1:x;v=void 0===v?!0:
v;z=void 0===z?"5pt Arial":z;w=void 0===w?"alphabetic":w;u=void 0===u?"rgba(0,0,0,1)":u;D=void 0===D?"rgba(0,0,0,0)":D;B=void 0===B?1:B;r=void 0===r?"rgba(180,180,180,1)":r;A=void 0===A?"rgba(0,0,0,0)":A;I=void 0===I?0:I;G=void 0===G?"rgba(200,200,200,1)":G;H=void 0===H?"rgba(0,0,0,0)":H;L=void 0===L?0:L;U=void 0===U?"rgba(230,230,230,1)":U;V=void 0===V?"rgba(0,0,0,0)":V;da=void 0===da?0:da;O=void 0===O?"rgba(200,200,200,1)":O;W=void 0===W?"rgba(120,120,120,1)":W;X=void 0===X?.75:X;Y=void 0===Y?"rgba(230,230,230,1)":
Y;ba=void 0===ba?"rgba(120,120,120,1)":ba;fa=void 0===fa?.75:fa;F=void 0===F?"rgba(220,220,220,1)":F;E=void 0===E?"rgba(0,0,0,0)":E;ca=void 0===ca?0:ca;T=void 0===T?"rgba(250,250,250,1)":T;K=void 0===K?"rgba(0,0,0,0)":K;J=void 0===J?0:J;ea=void 0===ea?"rgba(220,220,220,1)":ea;N=void 0===N?"rgba(120,120,120,1)":N;Q=void 0===Q?.75:Q;P=void 0===P?"rgba(250,250,250,1)":P;S=void 0===S?"rgba(120,120,120,1)":S;R=void 0===R?.75:R;Z=void 0===Z?"rgba(220,220,220,1)":Z;ha=void 0===ha?"rgba(0,0,0,0)":ha;ia=void 0===
ia?0:ia;ja=void 0===ja?"rgba(240,240,240,1)":ja;ka=void 0===ka?"rgba(0,0,0,0)":ka;la=void 0===la?0:la;ma=void 0===ma?"rgba(220,220,220,1)":ma;na=void 0===na?"rgba(120,120,120,1)":na;oa=void 0===oa?.75:oa;pa=void 0===pa?"rgba(240,240,240,1)":pa;ra=void 0===ra?"rgba(120,120,120,1)":ra;sa=void 0===sa?.75:sa;ua=void 0===ua?"rgba(240,240,240,1)":ua;va=void 0===va?"rgba(0,0,0,0)":va;qa=void 0===qa?0:qa;ta=void 0===ta?"rgba(250,250,250,1)":ta;wa=void 0===wa?"rgba(0,0,0,0)":wa;xa=void 0===xa?0:xa;ya=void 0===
ya?"rgba(240,240,240,1)":ya;za=void 0===za?"rgba(120,120,120,1)":za;Aa=void 0===Aa?.75:Aa;Ba=void 0===Ba?"rgba(250,250,250,1)":Ba;Ca=void 0===Ca?"rgba(120,120,120,1)":Ca;Da=void 0===Da?.75:Da;Ea=void 0===Ea?function(a){}:Ea;Fa=void 0===Fa?function(a){}:Fa;Ha=void 0===Ha?function(a){}:Ha;Ia=void 0===Ia?function(a){}:Ia;Ja=void 0===Ja?function(a){}:Ja;Ka=void 0===Ka?function(a){}:Ka;La=void 0===La?function(a){}:La;var h=b.builder("group",d+"subGroup",{}),C=b.builder("rectangle","backing",{width:e,height:c,
style:{fill:r,stroke:A,lineWidth:I}});h.append(C);k=b.builder("text","centre",{x:e/2,y:c*n,text:k,style:{font:z,testBaseline:w,fill:u,stroke:D,lineWidth:B,textAlign:"center",textBaseline:"middle"}});h.append(k);t=b.builder("text","left",{x:e*y,y:c*n,text:t,style:{font:z,testBaseline:w,fill:u,stroke:D,lineWidth:B,textAlign:"left",textBaseline:"middle"}});h.append(t);q=b.builder("text","right",{x:e-e*y,y:c*n,text:q,style:{font:z,testBaseline:w,fill:u,stroke:D,lineWidth:B,textAlign:"right",textBaseline:"middle"}});
h.append(q);h.cover=b.builder("rectangle","cover",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});h.append(h.cover);d=b.builder("button_",d,{x:f,y:a,angle:g,interactable:m,active:p,hoverable:l,selectable:x,pressable:v,onenter:Ea,onleave:Fa,onpress:Ha,ondblpress:Ia,onrelease:Ja,onselect:Ka,ondeselect:La,subject:h});d.activateGraphicalState=function(a){if(p){var b=[{fill:G,stroke:H,lineWidth:L},{fill:U,stroke:V,lineWidth:da},{fill:O,stroke:W,lineWidth:X},{fill:Y,stroke:ba,lineWidth:fa},{fill:F,stroke:E,
lineWidth:ca},{fill:T,stroke:K,lineWidth:J},{fill:ea,stroke:N,lineWidth:Q},{fill:P,stroke:S,lineWidth:R},{fill:Z,stroke:ha,lineWidth:ia},{fill:ja,stroke:ka,lineWidth:la},{fill:ma,stroke:na,lineWidth:oa},{fill:pa,stroke:ra,lineWidth:sa},{fill:ua,stroke:va,lineWidth:qa},{fill:ta,stroke:wa,lineWidth:xa},{fill:ya,stroke:za,lineWidth:Aa},{fill:Ba,stroke:Ca,lineWidth:Da}];!l&&a.hovering&&(a.hovering=!1);!x&&a.selected&&(a.selected=!1);a=8*a.hovering+4*a.glowing+2*a.selected+1*(v&&a.pressed);C.style.fill=
b[a].fill;C.style.stroke=b[a].stroke;C.style.lineWidth=b[a].lineWidth}else C.style.fill=r,C.style.stroke=A,C.style.lineWidth=I};d.activateGraphicalState({hovering:!1,glowing:!1,selected:!1,pressed:!1});return d};this.button_=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l,x,v,z){d=void 0===d?"":d;e=void 0===e?0:e;c=void 0===c?!0:c;g=void 0===g?!0:g;k=void 0===k?!1:k;t=void 0===t?!0:t;q=void 0===q?function(a){}:q;n=void 0===n?function(a){}:n;y=void 0===y?function(a){}:y;p=void 0===p?function(a){}:p;l=void 0===
l?function(a){}:l;x=void 0===x?function(a){}:x;v=void 0===v?function(a){}:v;void 0==z&&console.warn("button_ : No subject provided");var h=b.builder("group",d,{x:f,y:a,angle:e});h.append(z);h.state={hovering:!1,glowing:!1,selected:!1,pressed:!1};h.press=function(a){if(g){if(t){if(this.state.pressed)return;this.state.pressed=!0;if(this.onpress)this.onpress(this,a)}this.select(!this.select(),a);h.activateGraphicalState(h.state)}};h.release=function(a){if(g&&t&&this.state.pressed&&(this.state.pressed=
!1,h.activateGraphicalState(h.state),this.onrelease))this.onrelease(this,a)};h.active=function(a){if(void 0==a)return g;g=a;h.activateGraphicalState(h.state)};h.glow=function(a){if(void 0==a)return this.state.glowing;this.state.glowing=a;h.activateGraphicalState(h.state)};h.select=function(a,b,c){c=void 0===c?!0:c;if(g){if(void 0==a)return this.state.selected;if(k&&this.state.selected!=a&&(this.state.selected=a,h.activateGraphicalState(h.state),c))if(this.state.selected)this.onselect(this,b);else this.ondeselect(this,
b)}};h.interactable=function(a){if(void 0==a)return c;c=a};h.forceMouseLeave=function(){h.state.hovering=!1;h.release("forced");h.activateGraphicalState(h.state);if(h.onleave)h.onleave("forced")};z.cover.onmouseenter=function(a,b,c){h.state.hovering=!0;h.activateGraphicalState(h.state);if(h.onenter)h.onenter(c);if(1==c.buttons)z.cover.onmousedown(c)};z.cover.onmouseleave=function(a,b,c){h.state.hovering=!1;h.release(c);h.activateGraphicalState(h.state);if(h.onleave)h.onleave(c)};z.cover.onmouseup=
function(a,b,e){c&&h.release(e)};z.cover.onmousedown=function(a,b,e){c&&h.press(e)};z.cover.ondblclick=function(a,b,e){if(g&&c&&h.ondblpress)h.ondblpress(e)};h.onenter=q;h.onleave=n;h.onpress=y;h.ondblpress=p;h.onrelease=l;h.onselect=x;h.ondeselect=v;return h};this.button_polygon=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l,x,v,z,w,u,D,B,r,A,I,G,H,L,U,V,da,O,W,X,Y,ba,fa,F,E,ca,T,K,J,ea,N,Q,P,S,R,Z,ha,ia,ja,ka,la,ma,na,oa,pa,ra,sa,ua,va,qa,ta,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa){d=void 0===d?"button_polygon":d;
e=void 0===e?[{x:0,y:5},{x:5,y:0},{x:25,y:0},{x:30,y:5},{x:30,y:25},{x:25,y:30},{x:5,y:30},{x:0,y:25}]:e;c=void 0===c?0:c;h=void 0===h?!0:h;m=void 0===m?"":m;k=void 0===k?!0:k;t=void 0===t?!0:t;q=void 0===q?!1:q;n=void 0===n?!0:n;y=void 0===y?"5pt Arial":y;p=void 0===p?"alphabetic":p;l=void 0===l?"rgba(0,0,0,1)":l;x=void 0===x?"rgba(0,0,0,0)":x;v=void 0===v?1:v;z=void 0===z?"rgba(180,180,180,1)":z;w=void 0===w?"rgba(0,0,0,0)":w;u=void 0===u?0:u;D=void 0===D?"rgba(200,200,200,1)":D;B=void 0===B?"rgba(0,0,0,0)":
B;r=void 0===r?0:r;A=void 0===A?"rgba(230,230,230,1)":A;I=void 0===I?"rgba(0,0,0,0)":I;G=void 0===G?0:G;H=void 0===H?"rgba(200,200,200,1)":H;L=void 0===L?"rgba(120,120,120,1)":L;U=void 0===U?.75:U;V=void 0===V?"rgba(230,230,230,1)":V;da=void 0===da?"rgba(120,120,120,1)":da;O=void 0===O?.75:O;W=void 0===W?"rgba(220,220,220,1)":W;X=void 0===X?"rgba(0,0,0,0)":X;Y=void 0===Y?0:Y;ba=void 0===ba?"rgba(250,250,250,1)":ba;fa=void 0===fa?"rgba(0,0,0,0)":fa;F=void 0===F?0:F;E=void 0===E?"rgba(220,220,220,1)":
E;ca=void 0===ca?"rgba(120,120,120,1)":ca;T=void 0===T?.75:T;K=void 0===K?"rgba(250,250,250,1)":K;J=void 0===J?"rgba(120,120,120,1)":J;ea=void 0===ea?.75:ea;N=void 0===N?"rgba(220,220,220,1)":N;Q=void 0===Q?"rgba(0,0,0,0)":Q;P=void 0===P?0:P;S=void 0===S?"rgba(240,240,240,1)":S;R=void 0===R?"rgba(0,0,0,0)":R;Z=void 0===Z?0:Z;ha=void 0===ha?"rgba(220,220,220,1)":ha;ia=void 0===ia?"rgba(120,120,120,1)":ia;ja=void 0===ja?.75:ja;ka=void 0===ka?"rgba(240,240,240,1)":ka;la=void 0===la?"rgba(120,120,120,1)":
la;ma=void 0===ma?.75:ma;na=void 0===na?"rgba(240,240,240,1)":na;oa=void 0===oa?"rgba(0,0,0,0)":oa;pa=void 0===pa?0:pa;ra=void 0===ra?"rgba(250,250,250,1)":ra;sa=void 0===sa?"rgba(0,0,0,0)":sa;ua=void 0===ua?0:ua;va=void 0===va?"rgba(240,240,240,1)":va;qa=void 0===qa?"rgba(120,120,120,1)":qa;ta=void 0===ta?.75:ta;wa=void 0===wa?"rgba(250,250,250,1)":wa;xa=void 0===xa?"rgba(120,120,120,1)":xa;ya=void 0===ya?.75:ya;za=void 0===za?function(a){}:za;Aa=void 0===Aa?function(a){}:Aa;Ba=void 0===Ba?function(a){}:
Ba;Ca=void 0===Ca?function(a){}:Ca;Da=void 0===Da?function(a){}:Da;Ea=void 0===Ea?function(a){}:Ea;Fa=void 0===Fa?function(a){}:Fa;var C=b.builder("group",d+"subGroup",{}),M=b.builder("polygon","backing",{points:e,style:{fill:z,stroke:w,lineWidth:u}});C.append(M);var Ga=g.library.math.averagePoint(e);m=b.builder("text","centre",{x:Ga.x,y:Ga.y,text:m,style:{font:y,testBaseline:p,fill:l,stroke:x,lineWidth:v,textAlign:"center",textBaseline:"middle"}});C.append(m);C.cover=b.builder("polygon","cover",
{points:e,style:{fill:"rgba(0,0,0,0)"}});C.append(C.cover);d=b.builder("button_",d,{x:f,y:a,angle:c,interactable:h,active:k,hoverable:t,selectable:q,pressable:n,onenter:za,onleave:Aa,onpress:Ba,ondblpress:Ca,onrelease:Da,onselect:Ea,ondeselect:Fa,subject:C});d.activateGraphicalState=function(a){if(k){var b=[{fill:D,stroke:B,lineWidth:r},{fill:A,stroke:I,lineWidth:G},{fill:H,stroke:L,lineWidth:U},{fill:V,stroke:da,lineWidth:O},{fill:W,stroke:X,lineWidth:Y},{fill:ba,stroke:fa,lineWidth:F},{fill:E,stroke:ca,
lineWidth:T},{fill:K,stroke:J,lineWidth:ea},{fill:N,stroke:Q,lineWidth:P},{fill:S,stroke:R,lineWidth:Z},{fill:ha,stroke:ia,lineWidth:ja},{fill:ka,stroke:la,lineWidth:ma},{fill:na,stroke:oa,lineWidth:pa},{fill:ra,stroke:sa,lineWidth:ua},{fill:va,stroke:qa,lineWidth:ta},{fill:wa,stroke:xa,lineWidth:ya}];!t&&a.hovering&&(a.hovering=!1);!q&&a.selected&&(a.selected=!1);a=8*a.hovering+4*a.glowing+2*a.selected+1*(n&&a.pressed);M.style.fill=b[a].fill;M.style.stroke=b[a].stroke;M.style.lineWidth=b[a].lineWidth}else M.style.fill=
z,M.style.stroke=w,M.style.lineWidth=u};d.activateGraphicalState({hovering:!1,glowing:!1,selected:!1,pressed:!1});return d};this.button_image=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l,x,v,z,w,u,D,B,r,A,I,G,H,L,U,V,da,O,W,X,Y,ba){d=void 0===d?"button_image":d;e=void 0===e?30:e;c=void 0===c?20:c;g=void 0===g?0:g;m=void 0===m?!0:m;k=void 0===k?!0:k;t=void 0===t?!0:t;q=void 0===q?!1:q;n=void 0===n?!0:n;y=void 0===y?"http://space.alglobus.net/Basics/whyImages/earthFromSpace.gif":y;p=void 0===p?"https://i.ytimg.com/vi/JS7NYKqhrFo/hqdefault.jpg":
p;l=void 0===l?"http://coolinterestingstuff.com/wp-content/uploads/2012/09/space-4.jpg":l;x=void 0===x?"https://pbs.twimg.com/profile_images/927920625347383297/-ksNZr-Z_400x400.jpg":x;v=void 0===v?"https://blueblots.com/wp-content/uploads/2009/07/space1.jpg":v;z=void 0===z?"https://i.ytimg.com/vi/kpFryXQbVEA/hqdefault.jpg":z;w=void 0===w?"https://fabiusmaximus.files.wordpress.com/2016/01/north-america-at-night-from-space.jpg":w;u=void 0===u?"https://s3.amazonaws.com/spoonflower/public/design_thumbnails/0263/6418/rspoonflower_space_picmonkey_blue_v2_shop_preview.png":
u;D=void 0===D?"https://www.onlytoptens.com/wp-content/uploads/2011/03/top-10-space-facts-moon-moving-away-from-earth.jpeg":D;B=void 0===B?"https://cbsnews2.cbsi_static.com/hub/i/r/2015/04/14/5b5bc07b-95cf-4d06-9b98-a4738d904981/resize/620x465/9146eac2f7e3d92908bd5dfe4450a31d/hubble-telescope-anniversary12.jpg#":B;r=void 0===r?"http://1.bp.blogspot.com/-gCkpyF_ib9M/TWBP5ftaeII/AAAAAAAAAY0/r1yI-UNbSSY/s1600/tychePlanet.jpg":r;A=void 0===A?"http://vignette3.wikia.nocookie.net/freerealmswarriorcats/images/6/61/4293522-567779-space-background-star-heart-in-night-sky.jpg/revision/latest?cb=20140103064430":
A;I=void 0===I?"https://spaceplace.nasa.gov/templates/featured/space/galaxies300.png":I;G=void 0===G?"https://s3.amazonaws.com/spoonflower/public/design_thumbnails/0157/0136/SPACE_PRINT-ALIEN_2_shop_preview.png":G;H=void 0===H?"http://1.bp.blogspot.com/-rbBG3L514tQ/UD9eJuVrH1I/AAAAAAAAIo0/RKOGYNs0WwM/s400/Outer+Space+Wallpapers+6.jpg":H;L=void 0===L?"http://previewcf.turbosquid.com/Preview/2014/05/25__12_10_05/gamma%20wormhole%202.jpg0671fb75-c6d0-49ee-9555-9ca9bf1ba482Larger.jpg":L;U=void 0===U?
"http://imgc.allpostersimages.com/images/P-473-488-90/61/6172/E2RG100Z/posters/earth-from-space.jpg":U;V=void 0===V?function(a){}:V;da=void 0===da?function(a){}:da;O=void 0===O?function(a){}:O;W=void 0===W?function(a){}:W;X=void 0===X?function(a){}:X;Y=void 0===Y?function(a){}:Y;ba=void 0===ba?function(a){}:ba;var h=b.builder("group",d+"subGroup",{}),C=b.builder("image","backing",{width:e,height:c,url:y});h.append(C);h.cover=b.builder("rectangle","cover",{width:e,height:c,style:{fill:"rgba(0,0,0,0)"}});
h.append(h.cover);d=b.builder("button_",d,{x:f,y:a,angle:g,interactable:m,active:k,hoverable:t,selectable:q,pressable:n,onenter:V,onleave:da,onpress:O,ondblpress:W,onrelease:X,onselect:Y,ondeselect:ba,subject:h});d.activateGraphicalState=function(a){k?(!t&&a.hovering&&(a.hovering=!1),!q&&a.selected&&(a.selected=!1),C.url=[p,l,x,v,z,w,u,D,B,r,A,I,G,H,L,U][8*a.hovering+4*a.glowing+2*a.selected+1*(n&&a.pressed)]):(C.style.fill=backing__off__fill,C.style.stroke=backing__off__stroke,C.style.lineWidth=
backing__off__lineWidth)};d.activateGraphicalState({hovering:!1,glowing:!1,selected:!1,pressed:!1});return d};this.grapher_waveWorkspace=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l,x,v,z,w,u){e=void 0===e?120:e;c=void 0===c?60:c;m=void 0===m?!0:m;k=void 0===k?!0:k;t=void 0===t?!0:t;q=void 0===q?[{stroke:"rgba(0,255,0,1)",lineWidth:.25,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.25,lineJoin:"round"}]:q;n=void 0===n?[{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"},{fill:"rgba(255,255,100,1)",
size:.75,font:"Helvetica"}]:n;y=void 0===y?"rgba(0,100,0,1)":y;p=void 0===p?.25:p;l=void 0===l?"rgba(0,150,0,1)":l;x=void 0===x?"10pt Helvetica":x;v=void 0===v?"rgba(50,50,50,1)":v;z=void 0===z?function(a,b){}:z;w=void 0===w?function(a,b){}:w;u=void 0===u?function(a){}:u;var h=b.builder("group",void 0===d?"grapher_waveWorkspace":d,{x:f,y:a,angle:void 0===g?0:g});d=b.builder("grapher__static","graph",{width:e,height:c,style:{foregrounds:q,foregroundText:n,background_stroke:y,background_lineWidth:p,
backgroundText_fill:l,backgroundText_font:x,backing:v}});d.resolution(10);h.append(d);e=b.builder("needleOverlay","overlay",{width:e,height:c,interactable:m,selectNeedle:k,selectionArea:t,needleStyles:q.map(function(a){return a.stroke})});h.append(e);h.horizontalMarkings=d.horizontalMarkings;h.verticalMarkings=d.verticalMarkings;h.drawBackground=d.drawBackground;h.drawForeground=d.drawForeground;h.draw=d.draw;h.mark=e.mark;h.removeAllMarks=e.removeAllMarks;h.select=e.select;h.area=e.area;h.interactable=
e.interactable;h.onchange=z;h.onrelease=w;h.selectionAreaToggle=u;e.onchange=function(a,b){if(h.onchange)h.onchange(a,b)};e.onrelease=function(a,b){if(h.onrelease)h.onrelease(a,b)};e.selectionAreaToggle=function(a){h.selectionAreaToggle&&h.selectionAreaToggle(a)};d.viewbox({left:0});d.drawBackground();e.select(0);return h}};this.display=new function(){this.rastorDisplay=function(d,f,a,e,c,g,m,k,t,q,n,y){function h(){for(var a=0;a<m;a++)for(var b=0;b<k;b++)l[a][b].style.fill="rgb("+255*x[a][b][0]+
","+255*x[a][b][1]+","+255*x[a][b][2]+")"}c=void 0===c?60:c;g=void 0===g?60:g;m=void 0===m?8:m;k=void 0===k?8:k;t=void 0===t?.1:t;q=void 0===q?.1:q;n=void 0===n?"rgba(50,50,50)":n;y=void 0===y?"rgba(0,0,0)":y;d=b.builder("group",void 0===d?"rastorDisplay":d,{x:f,y:a,angle:void 0===e?0:e});n=b.builder("rectangle","backing",{width:c,height:g,style:{fill:n}});d.append(n);e=b.builder("group","pixels");d.append(e);var l=[],x=[];c/=m;g/=k;for(f=0;f<m;f++){var v=[],z=[];for(a=0;a<k;a++)n=b.builder("rectangle",
f+"_"+a,{x:f*c+t/2,y:a*g+q/2,width:c-t,height:g-q,style:{fill:y}}),v.push(n),z.push([0,0,0]),e.append(n);l.push(v);x.push(z)}d.get=function(a,b){return x[a][b]};d.set=function(a,b,c){x[a][b]=c;h()};d.import=function(a){for(var b=0;b<m;b++)for(var c=0;c<k;c++)this.set(b,c,a[b][c]);h()};d.export=function(){return x};d.setAll=function(a){for(var b=0;b<m;b++)for(var c=0;c<k;c++)this.set(b,c,a)};d.test=function(){this.setAll([1,1,1]);this.set(1,1,[1,.5,.5]);this.set(2,2,[.5,1,.5]);this.set(3,3,[.5,.5,
1]);this.set(4,4,[1,.5,1]);h()};return d};this.grapher_audioScope=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l){d=void 0===d?"grapher_audioScope":d;e=void 0===e?120:e;c=void 0===c?60:c;h=void 0===h?0:h;m=void 0===m?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:m;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;t=void 0===t?"rgba(0,100,0,1)":t;q=void 0===q?.25:q;n=void 0===n?"rgba(0,150,0,1)":n;y=void 0===y?.1:y;p=void 0===p?"Helvetica":p;l=void 0===l?"rgba(50,50,50,1)":l;var x=
g.library.audio.context.createAnalyser(),v=null,z=10,w=null,u=256;x.fftSize=u;v=new Uint8Array(x.fftSize);new Uint8Array(x.fftSize);f=b.builder("group",d,{x:f,y:a,angle:h});var r=b.builder("grapher",d,{x:0,y:0,width:e,height:c,foregroundStyles:[m],foregroundTextStyles:[k],backgroundStyle_stroke:t,backgroundStyle_lineWidth:q,backgroundTextStyle_fill:n,backgroundTextStyle_size:y,backgroundTextStyle_font:p,backingStyle:l});f.append(r);f.start=function(){null==w&&(w=setInterval(function(){var a=[];x.getByteTimeDomainData(v);
for(var b=0;b<v.length;b++)a.push(v[b]/128-1);r.draw(a)},1E3/z))};f.stop=function(){clearInterval(w);w=null};f.getNode=function(){return x};f.resolution=function(a){a=void 0===a?null:a;if(null==a)return u;u=a;this.stop();this.start()};f.refreshRate=function(a){if(null==a)return z;z=a;this.stop();this.start()};r.viewbox({l:-1.1,h:1.1});r.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});r.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});r.drawBackground();
return f};this.sevenSegmentDisplay=function(d,f,a,e,c,g,m,k,t){e=void 0===e?20:e;c=void 0===c?30:c;m=void 0===m?"rgb(0,0,0)":m;k=void 0===k?"rgb(200,200,200)":k;t=void 0===t?"rgb(20,20,20)":t;var h=e/8,n=e/8;g=[{x:1*n+h,y:1*n+h},{x:.5*n+h,y:.5*n+h},{x:1*n+h,y:0*n+h},{x:0*n+h,y:1*n+h}];var y=[{x:e-1*n-h,y:0*n+h},{x:e-.5*n-h,y:.5*n+h},{x:e-1*n-h,y:1*n+h},{x:e-0*n-h,y:1*n+h}],p=[{x:1*n+h,y:.5*c-1*n+.5*h},{x:.5*n+h,y:.5*c-.5*n+.5*h},{x:1*n+h,y:.5*c-0*n+.5*h},{x:0*n+h,y:.5*c-1*n+.5*h},{x:0*n+h,y:.5*c-
0*n+.5*h}],l=[{x:e-1*n-h,y:.5*c-0*n+.5*h},{x:e-.5*n-h,y:.5*c-.5*n+.5*h},{x:e-1*n-h,y:.5*c-1*n+.5*h},{x:e-0*n-h,y:.5*c-1*n+.5*h},{x:e-0*n-h,y:.5*c-0*n+.5*h}],x=[{x:1*n+h,y:c-1*n-h},{x:.5*n+h,y:c-.5*n-h},{x:1*n+h,y:c-0*n-h},{x:0*n+h,y:c-1*n-h}];h=[{x:e-1*n-h,y:c-0*n-h},{x:e-.5*n-h,y:c-.5*n-h},{x:e-1*n-h,y:c-1*n-h},{x:e-0*n-h,y:c-1*n-h}];d=b.builder("group",void 0===d?"sevenSegmentDisplay":d,{x:f,y:a});e=b.builder("rectangle","backing",{width:e,height:c,style:{fill:m}});d.append(e);var v=[];e=[[g[0],
y[2],y[1],y[0],g[2],g[1]],[g[1],g[3],p[3],p[1],p[0],g[0]],[y[1],y[3],l[3],l[1],l[2],y[2]],[p[0],l[2],l[1],l[0],p[2],p[1]],[p[1],p[4],x[3],x[1],x[0],p[2]],[l[1],l[4],h[3],h[1],h[2],l[0]],[x[0],h[2],h[1],h[0],x[2],x[1]]];for(c=0;c<e.length;c++)m={segment:b.builder("polygon","segment_"+c,{points:e[c],style:{fill:t}}),state:!1},v.push(m),d.append(m.segment);d.set=function(a,b){v[a].state=b;v[a].segment.style.fill=b?k:t};d.get=function(a){return v[a].state};d.clear=function(){for(var a=0;a<v.length;a++)this.set(a,
!1)};d.enterCharacter=function(a){switch(a){case 0:case "0":a=[1,1,1,0,1,1,1];break;case 1:case "1":a=[0,0,1,0,0,1,0];break;case 2:case "2":a=[1,0,1,1,1,0,1];break;case 3:case "3":a=[1,0,1,1,0,1,1];break;case 4:case "4":a=[0,1,1,1,0,1,0];break;case 5:case "5":a=[1,1,0,1,0,1,1];break;case 6:case "6":a=[1,1,0,1,1,1,1];break;case 7:case "7":a=[1,0,1,0,0,1,0];break;case 8:case "8":a=[1,1,1,1,1,1,1];break;case 9:case "9":a=[1,1,1,1,0,1,1];break;default:a=[0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,
1==a[b])};return d};this.sixteenSegmentDisplay=function(d,f,a,e,c,g,m,k,t){e=void 0===e?20:e;c=void 0===c?30:c;m=void 0===m?"rgb(0,0,0)":m;k=void 0===k?"rgb(200,200,200)":k;t=void 0===t?"rgb(20,20,20)":t;var h=e/8,n=e/8;g=[{x:.5*n+h,y:.5*n+h},{x:1*n+h,y:0*n+h},{x:0*n+h,y:1*n+h},{x:1*n+h,y:1*n+h},{x:1.75*n+h,y:1*n+h},{x:1*n+h,y:1.75*n+h}];var y=[{x:e/2,y:.5*n+h},{x:e/2-.5*n,y:1*n+h},{x:e/2+.5*n,y:1*n+h},{x:e/2-.5*n,y:0*n+h},{x:e/2+.5*n,y:0*n+h}],p=[{x:e-.5*n-h,y:.5*n+h},{x:e-1*n-h,y:0*n+h},{x:e-0*
n-h,y:1*n+h},{x:e-1*n-h,y:1*n+h},{x:e-1*n-h,y:1.75*n+h},{x:e-1.75*n-h,y:1*n+h}],l=[{x:0*n+h,y:.5*c-.5*n},{x:1*n+h,y:.5*c-.5*n},{x:.5*n+h,y:.5*c-0*n},{x:0*n+h,y:.5*c+.5*n},{x:1*n+h,y:.5*c+.5*n}],x=[{x:e/2,y:c/2},{x:e/2-.5*n,y:.5*n+c/2},{x:e/2-.25*n,y:1.25*n+c/2},{x:e/2-1*n,y:.5*n+c/2},{x:e/2+.5*n,y:.5*n+c/2},{x:e/2+.5*n,y:1.75*n+c/2},{x:e/2+1*n,y:.5*n+c/2},{x:e/2-.5*n,y:.5*-n+c/2},{x:e/2-.25*n,y:1.25*-n+c/2},{x:e/2-1*n,y:.25*-n+c/2},{x:e/2+.5*n,y:.5*-n+c/2},{x:e/2+.5*n,y:1.75*-n+c/2},{x:e/2+1*n,y:.25*
-n+c/2}],v=[{x:e-1*n-h,y:.5*c-.5*n},{x:e-0*n-h,y:.5*c-.5*n},{x:e-.5*n-h,y:.5*c-0*n},{x:e-1*n-h,y:.5*c+.5*n},{x:e-0*n-h,y:.5*c+.5*n}],z=[{x:.5*n+h,y:c-.5*n-h},{x:0*n+h,y:c-1*n-h},{x:1*n+h,y:c-0*n-h},{x:1*n+h,y:c-1*n-h},{x:1*n+h,y:c-1.75*n-h},{x:1.75*n+h,y:c-1*n-h}],w=[{x:e/2-.5*n,y:c-1*n-h},{x:e/2+.5*n,y:c-1*n-h},{x:e/2,y:c-.5*n-h},{x:e/2-.5*n,y:c-0*n-h},{x:e/2+.5*n,y:c-0*n-h}];h=[{x:e-.5*n-h,y:c-.5*n-h},{x:e-0*n-h,y:c-1*n-h},{x:e-1*n-h,y:c-0*n-h},{x:e-1*n-h,y:c-1*n-h},{x:e-1*n-h,y:c-1.75*n-h},{x:e-
1.75*n-h,y:c-1*n-h}];d=b.builder("group",void 0===d?"sixteenSegmentDisplay":d,{x:f,y:a});e=b.builder("rectangle","backing",{width:e,height:c,style:{fill:m}});d.append(e);var u=[];e=[[g[1],g[0],g[3],y[1],y[0],y[3]],[y[4],y[0],y[2],p[3],p[0],p[1]],[g[0],g[2],l[0],l[2],l[1],g[3]],[g[4],g[3],g[5],x[9],x[7],x[8]],[y[0],y[1],x[7],x[0],x[10],y[2]],[p[4],p[3],p[5],x[11],x[10],x[12]],[p[0],p[2],v[1],v[2],v[0],p[3]],[l[4],l[2],l[1],x[7],x[0],x[1]],[v[3],v[2],v[0],x[10],x[0],x[4]],[z[0],z[1],l[3],l[2],l[4],
z[3]],[z[4],z[3],z[5],x[2],x[1],x[3]],[w[0],w[2],w[1],x[4],x[0],x[1]],[h[4],h[3],h[5],x[5],x[4],x[6]],[h[3],v[3],v[2],v[4],h[1],h[0]],[z[2],z[0],z[3],w[0],w[2],w[3]],[h[2],h[0],h[3],w[1],w[2],w[4]]];for(c=0;c<e.length;c++)m={segment:b.builder("polygon","segment_"+c,{points:e[c],style:{fill:t}}),state:!1},u.push(m),d.append(m.segment);d.set=function(a,b){u[a].state=b;u[a].segment.style.fill=b?k:t};d.get=function(a){return u[a].state};d.clear=function(){for(var a=0;a<u.length;a++)this.set(a,!1)};d.enterCharacter=
function(a){switch(a){case "!":a=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":a=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":a=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":a=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":a=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':a=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1];break;case "-":a=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":a=[0,0,0,1,
0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":a=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":a=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":a=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":a=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":a=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":a=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "[":a=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":a=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":a=
[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":a=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":a=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":a=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":a=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":a=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":a=[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":a=
[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":a=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":a=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":a=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":a=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":a=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":a=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":a=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,
1];break;case "h":case "H":a=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":a=[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":a=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":a=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":a=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":a=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":a=
[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":a=[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":a=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":a=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":a=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":a=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":a=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":a=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":a=[0,0,0,1,0,1,0,0,0,0,
1,0,1,0,0,0];break;case "y":case "Y":a=[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":a=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":a=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}for(var b=0;b<a.length;b++)this.set(b,1==a[b])};return d};this.glowbox_rect=function(d,f,a,e,c,g,m,k){e=void 0===e?30:e;c=void 0===c?30:c;g=void 0===g?0:g;m=void 0===m?"rgba(244,234,141,1)":m;k=void 0===k?"rgba(80,80,80,1)":k;d=b.builder("group",void 0===d?"glowbox_rect":
d,{x:f,y:a});var h=b.builder("rectangle","light",{width:e,height:c,angle:g,style:{fill:k}});d.append(h);d.on=function(){h.style.fill=m};d.off=function(){h.style.fill=k};return d};this.audio_meter_level=function(d,f,a,e,c,g,m,k,t,q,n){c=void 0===c?20:c;g=void 0===g?60:g;m=void 0===m?[.125,.25,.375,.5,.625,.75,.875]:m;k=void 0===k?"rgb(10,10,10)":k;t=void 0===t?["rgba(250,250,250,1)","rgb(100,100,100)"]:t;q=void 0===q?"rgba(220,220,220,1)":q;n=void 0===n?"1pt Courier New":n;d=b.builder("group",void 0===
d?"audio_meter_level":d,{x:f,y:a,angle:void 0===e?0:e});var h=b.builder("meter_level","meter",{width:c,height:g,markings:m,style:{backing:k,levels:t,markingStyle_fill:q,markingStyle_font:n}});d.append(h);var p=r.circuit.audio2percentage();p.newValue=function(a){h.set(a)};d.audioIn=function(){return p.audioIn()};d.start=function(){p.start()};d.stop=function(){p.stop()};return d};this.grapher__static=function(d,f,a,e,c,h,m,k,t,q,n,y,p,l){function x(){C._.fillStyle=l;C._.fillRect(0,0,C.$(e),C.$(c))}
function v(){for(var a=g.library.math.relativeDistance(e,w.left,w.right,u.mappedPosition),b=0;b<u.points.length;b++)if(u.points[b]<w.top||u.points[b]>w.bottom){var d=c-g.library.math.relativeDistance(c,w.bottom,w.top,u.points[b]);C._.fillStyle=q;C._.fillRect(0,C.$(d),C.$(e),C.$(n));u.printText&&(C._.fillStyle=y,C._.font=p,C._.fillText(u.printingValues&&void 0!=u.printingValues[b]?u.printingValues[b]:u.points[b],C.$(a+u.textPositionOffset.x),C.$(d+u.textPositionOffset.y)))}d=c-g.library.math.relativeDistance(c,
w.bottom,w.top,r.mappedPosition);for(b=0;b<r.points.length;b++)r.points[b]<w.left||r.points[b]>w.right||(a=g.library.math.relativeDistance(e,w.left,w.right,r.points[b]),C._.fillStyle=q,C._.fillRect(C.$(a),0,C.$(n),C.$(c)),r.printText&&(C._.fillStyle=y,C._.font=p,C._.fillText(r.printingValues&&void 0!=r.printingValues[b]?r.printingValues[b]:r.points[b],C.$(a+r.textPositionOffset.x),C.$(d+r.textPositionOffset.y))))}function z(a,b,f){f=void 0===f?0:f;B[f]=void 0==a&&void 0==b?void 0:{x:b,y:a};if(void 0!=
B[f]&&void 0==B[f].y)console.warn("grapher__static error",d,"attempting to add line with no y component"),console.warn("x:",B[f].x),console.warn("y:",B[f].y);else for(a=0;a<B.length;a++)if(void 0!=B[a]){f=B[a];C._.strokeStyle=k[a].stroke;C._.lineWidth=C.$(k[a].lineWidth);C._.lineJoin=k[a].lineJoin;C._.lineCap=k[a].lineJoin;C._.beginPath();if(void 0!=f.y&&void 0==f.x)for(C._.moveTo(0,C.$(c-g.library.math.relativeDistance(c,w.bottom,w.top,f.y[0],!0))),b=1;b<f.y.length;b++)C._.lineTo(C.$(e/(f.y.length-
1)*b),C.$(c-g.library.math.relativeDistance(c,w.bottom,w.top,f.y[b],!0)));else if(f.y.length==f.x.length)for(b=0;b<f.y.length;b++)for(C._.moveTo(C.$(g.library.math.relativeDistance(e,w.left,w.right,f.x[0],!0)),C.$(c-g.library.math.relativeDistance(c,w.bottom,w.top,f.y[0],!0))),b=1;b<f.y.length;b++)C._.lineTo(C.$(g.library.math.relativeDistance(e,w.left,w.right,f.x[b],!0)),C.$(c-g.library.math.relativeDistance(c,w.bottom,w.top,f.y[b],!0)));else console.error("grapher__static::"+d,":layers are of different length:",
f.y,f.x);C._.stroke()}}d=void 0===d?"grapher__static":d;e=void 0===e?120:e;c=void 0===c?60:c;m=void 0===m?5:m;k=void 0===k?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:k;q=void 0===q?"rgba(0,100,0,1)":q;n=void 0===n?.25:n;y=void 0===y?"rgba(0,150,0,1)":y;p=void 0===p?"7.5pt Helvetica":p;l=void 0===l?"rgba(50,50,50,1)":l;var w={bottom:-1,top:1,left:-1,right:1},u={points:[.75,
.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},r={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},B=[];f=b.builder("group",d,{x:f,y:a,angle:void 0===h?0:h});var C=b.builder("canvas","backing",{width:e,height:c,resolution:m});f.append(C);f.resolution=function(a){return C.resolution(a)};f.viewbox=function(a){if(null==a)return w;void 0!=a.bottom&&(w.bottom=a.bottom);void 0!=a.top&&
(w.top=a.top);void 0!=a.left&&(w.left=a.left);void 0!=a.right&&(w.right=a.right)};f.horizontalMarkings=function(a){if(null==a)return u;void 0!=a.points&&(u.points=a.points);void 0!=a.printingValues&&(u.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(u.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(u.printText=a.printText)};f.verticalMarkings=function(a){if(null==a)return r;void 0!=a.points&&(r.points=a.points);void 0!=a.printingValues&&(r.printingValues=a.printingValues);
void 0!=a.textPositionOffset&&(r.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(r.printText=a.printText)};f.drawBackground=function(){x();v()};f.drawForeground=function(a,b,c){z(a,b,void 0===c?0:c)};f.draw=function(a,b,c){c=void 0===c?0:c;x();v();z(a,b,c)};return f};this.grapher_periodicWave__static=function(d,f,a,e,c,g,m,k,t,q,n,y,p,l){d=void 0===d?"grapher_periodicWave__static":d;e=void 0===e?120:e;c=void 0===c?60:c;m=void 0===m?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:
m;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;t=void 0===t?"rgba(0,100,0,1)":t;q=void 0===q?.25:q;n=void 0===n?"rgba(0,150,0,1)":n;y=void 0===y?.1:y;p=void 0===p?"Helvetica":p;l=void 0===l?"rgba(50,50,50,1)":l;var h={sin:[],cos:[]},v=100;f=b.builder("group",d,{x:f,y:a,angle:void 0===g?0:g});var z=b.builder("grapher__static",d,{x:0,y:0,width:e,height:c,foregroundStyles:[m],foregroundTextStyles:[k],backgroundStyle_stroke:t,backgroundStyle_lineWidth:q,backgroundTextStyle_fill:n,
backgroundTextStyle_size:y,backgroundTextStyle_font:p,backingStyle:l});f.append(z);f.wave=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;if(null==a){for(;h.sin.length<h.cos.length;)h.sin.push(0);for(;h.sin.length>h.cos.length;)h.cos.push(0);for(a=0;a<h.sin.length;a++)h.sin[a]||(h.sin[a]=0),h.cos[a]||(h.cos[a]=0);return h}null==b&&(h=a);switch(b){case "sin":h.sin=a;break;case "cos":h.cos=a}};f.waveElement=function(a,b,c){if(null==c)return h[a][b];h[a][b]=c};f.resolution=function(a){a=void 0===
a?null:a;if(null==a)return v;v=a};f.updateBackground=function(){z.viewbox({bottom:-1.1,top:1.1,left:0});z.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});z.verticalMarkings({points:[0,.25,.5,.75],printText:!0});z.drawBackground()};f.draw=function(){for(var a=[],b,c=0;c<=v;c++){for(var e=b=0;e<h.sin.length;e++)h.sin[e]||(h.sin[e]=0),b+=Math.sin(c/v*e*Math.PI*2)*h.sin[e];for(e=0;e<h.cos.length;e++)h.cos[e]||(h.cos[e]=0),b+=Math.cos(c/v*e*Math.PI*2)*h.cos[e];a.push(b)}z.draw(a)};
f.reset=function(){this.wave({sin:[],cos:[]});this.resolution(100);this.updateBackground()};return f};this.grapher=function(d,f,a,e,c,h,m,k,t,q,n,y,p){function l(){r.clear();for(var a=g.library.math.relativeDistance(e,v.left,v.right,z.mappedPosition),d=0;d<z.points.length;d++)if(z.points[d]<v.top||z.points[d]>v.bottom){var f=c-g.library.math.relativeDistance(c,v.bottom,v.top,z.points[d]),h=b.builder("rectangle","horizontal_line_"+d,{x:0,y:f,width:e,height:q,style:{fill:t}});r.append(h);z.printText&&
(h=b.builder("text","horizontal_text_"+d,{x:a+z.textPositionOffset.x,y:f+z.textPositionOffset.y,text:z.printingValues&&void 0!=z.printingValues[d]?z.printingValues[d]:z.points[d],style:{fill:n,font:y}}),r.append(h))}f=c-g.library.math.relativeDistance(c,v.bottom,v.top,w.mappedPosition);for(d=0;d<w.points.length;d++)w.points[d]<v.left||w.points[d]>v.right||(a=g.library.math.relativeDistance(e,v.left,v.right,w.points[d]),h=b.builder("rectangle","vertical_line_"+d,{x:a,y:0,width:q,height:c,style:{fill:t}}),
r.append(h),w.printText&&(h=b.builder("text","vertical_text_"+d,{x:a+w.textPositionOffset.x,y:f+w.textPositionOffset.y,text:w.printingValues&&void 0!=w.printingValues[d]?w.printingValues[d]:w.points[d],style:{fill:n,font:y}}),r.append(h)))}function x(a,f,h){h=void 0===h?0:h;B.clear();u[h]=void 0==a&&void 0==f?void 0:{x:f,y:a};if(void 0!=u[h]&&void 0==u[h].y)console.warn("grapher error",d,"attempting to add line with no y component"),console.warn("x:",u[h].x),console.warn("y:",u[h].y);else for(a=0;a<
u.length;a++)if(void 0!=u[a]){h=u[a];f=[];if(void 0!=h.y&&void 0==h.x)for(var k=0;k<h.y.length;k++)f.push({x:e/(h.y.length-1)*k,y:c-g.library.math.relativeDistance(c,v.bottom,v.top,h.y[k],!0)});else if(h.y.length==h.x.length)for(k=0;k<h.y.length;k++)f.push({x:g.library.math.relativeDistance(e,v.left,v.right,h.x[k],!0),y:c-g.library.math.relativeDistance(c,v.bottom,v.top,h.y[k],!0)});else console.error("grapher::"+d,":layers are of differnt length:",h.y,h.x);B.append(b.builder("path","layer_"+a,{points:f,
style:{stroke:m[a].stroke,lineWidth:m[a].lineWidth,lineJoin:m[a].lineJoin,lineCap:m[a].lineJoin}}))}}d=void 0===d?"grapher":d;e=void 0===e?120:e;c=void 0===c?60:c;m=void 0===m?[{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(255,255,0,1)",lineWidth:.5,lineJoin:"round"},{stroke:"rgba(0,255,255,1)",lineWidth:.5,lineJoin:"round"}]:m;t=void 0===t?"rgba(0,100,0,1)":t;q=void 0===q?.25:q;n=void 0===n?"rgba(0,150,0,1)":n;y=void 0===y?"1.5pt Helvetica":y;p=void 0===p?"rgba(50,50,50,1)":
p;var v={bottom:-1,top:1,left:-1,right:1},z={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},w={points:[.75,.5,.25,0,-.25,-.5,-.75],printingValues:[],mappedPosition:0,textPositionOffset:{x:1,y:-.5},printText:!0},u=[];f=b.builder("group",d,{x:f,y:a,angle:void 0===h?0:h});p=b.builder("rectangle","backing",{width:e,height:c,style:{fill:p}});f.append(p);var r=b.builder("group","background");f.append(r);var B=b.builder("group","foreground");
f.append(B);p=b.builder("rectangle","stencil",{width:e,height:c});f.stencil(p);f.clip(!0);f.viewbox=function(a){if(null==a)return v;void 0!=a.bottom&&(v.bottom=a.bottom);void 0!=a.top&&(v.top=a.top);void 0!=a.left&&(v.left=a.left);void 0!=a.right&&(v.right=a.right)};f.horizontalMarkings=function(a){if(null==a)return z;void 0!=a.points&&(z.points=a.points);void 0!=a.printingValues&&(z.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(z.textPositionOffset=a.textPositionOffset);void 0!=
a.printText&&(z.printText=a.printText)};f.verticalMarkings=function(a){if(null==a)return w;void 0!=a.points&&(w.points=a.points);void 0!=a.printingValues&&(w.printingValues=a.printingValues);void 0!=a.textPositionOffset&&(w.textPositionOffset=a.textPositionOffset);void 0!=a.printText&&(w.printText=a.printText)};f.drawBackground=function(){l()};f.drawForeground=function(a,b,c){x(a,b,void 0===c?0:c)};f.draw=function(a,b,c){c=void 0===c?0:c;l();x(a,b,c)};return f};this.meter_level=function(d,f,a,e,c,
g,m,k,t,q,n){function h(a){return b.builder("polygon","mark_"+a,{points:[{x:c,y:a-.1},{x:c-c/4,y:a-.1},{x:c-c/4,y:a+.1},{x:c,y:a+.1}],style:{fill:q}})}function p(a,c){return b.builder("text","text_"+c,{x:.5,y:a+.3,text:c,style:{fill:q,font:n}})}c=void 0===c?20:c;g=void 0===g?60:g;m=void 0===m?[.125,.25,.375,.5,.625,.75,.875]:m;k=void 0===k?"rgb(10,10,10)":k;t=void 0===t?["rgba(250,250,250,1)","fill:rgb(100,100,100)"]:t;q=void 0===q?"rgba(220,220,220,1)":q;n=void 0===n?"1pt Courier New":n;d=b.builder("group",
void 0===d?"meter_level":d,{x:f,y:a,angle:void 0===e?0:e});var l=b.builder("level","level",{width:c,height:g,style:{backing:k,levels:t}});d.append(l);k=b.builder("group","markings");d.append(k);for(t=0;t<m.length;t++)k.append(h(g*(1-m[t]))),k.append(p(g*(1-m[t]),m[t]));var r=0,v=0;setInterval(function(){l.layer(v,0);0<r&&(r-=.005);l.layer(r,1);v>r&&(r=v)},1E3/15);d.set=function(a){v=a};return d};this.sevenSegmentDisplay__static=function(d,f,a,e,c,g,m,k,t,q){function h(){C._.fillStyle=k;C._.fillRect(0,
0,C.$(e),C.$(c))}function r(){for(var a=0;a<A.length;a++){C._.beginPath();C._.moveTo(C.$(A[a][0].x),C.$(A[a][0].y));for(var b=1;b<A[a].length;b++)C._.lineTo(C.$(A[a][b].x),C.$(A[a][b].y));C._.closePath();C._.fillStyle=0==B[a]?q:t;C._.fill()}}e=void 0===e?20:e;c=void 0===c?30:c;m=void 0===m?5:m;k=void 0===k?"rgb(0,0,0)":k;t=void 0===t?"rgb(200,200,200)":t;q=void 0===q?"rgb(20,20,20)":q;var p=e/8,l=e/8,x=[{x:1*l+p,y:1*l+p},{x:.5*l+p,y:.5*l+p},{x:1*l+p,y:0*l+p},{x:0*l+p,y:1*l+p}],v=[{x:e-1*l-p,y:0*l+
p},{x:e-.5*l-p,y:.5*l+p},{x:e-1*l-p,y:1*l+p},{x:e-0*l-p,y:1*l+p}],z=[{x:1*l+p,y:.5*c-1*l+.5*p},{x:.5*l+p,y:.5*c-.5*l+.5*p},{x:1*l+p,y:.5*c-0*l+.5*p},{x:0*l+p,y:.5*c-1*l+.5*p},{x:0*l+p,y:.5*c-0*l+.5*p}],w=[{x:e-1*l-p,y:.5*c-0*l+.5*p},{x:e-.5*l-p,y:.5*c-.5*l+.5*p},{x:e-1*l-p,y:.5*c-1*l+.5*p},{x:e-0*l-p,y:.5*c-1*l+.5*p},{x:e-0*l-p,y:.5*c-0*l+.5*p}],u=[{x:1*l+p,y:c-1*l-p},{x:.5*l+p,y:c-.5*l-p},{x:1*l+p,y:c-0*l-p},{x:0*l+p,y:c-1*l-p}];p=[{x:e-1*l-p,y:c-0*l-p},{x:e-.5*l-p,y:c-.5*l-p},{x:e-1*l-p,y:c-1*l-
p},{x:e-0*l-p,y:c-1*l-p}];var A=[[x[0],v[2],v[1],v[0],x[2],x[1]],[x[1],x[3],z[3],z[1],z[0],x[0]],[v[1],v[3],w[3],w[1],w[2],v[2]],[z[0],w[2],w[1],w[0],z[2],z[1]],[z[1],z[4],u[3],u[1],u[0],z[2]],[w[1],w[4],p[3],p[1],p[2],w[0]],[u[0],p[2],p[1],p[0],u[2],u[1]]],B=[0,0,0,0,0,0,0];d=b.builder("group",void 0===d?"sevenSegmentDisplay__static":d,{x:f,y:a,angle:void 0===g?0:g});var C=b.builder("canvas","subcanvas",{width:e,height:c,resolution:m});d.append(C);d.set=function(a,b){B[a].state=b;r()};d.get=function(a){return B[a].state};
d.clear=function(){for(var a=0;a<B.length;a++)this.set(a,!1)};d.enterCharacter=function(a){switch(a){case 0:case "0":B=[1,1,1,0,1,1,1];break;case 1:case "1":B=[0,0,1,0,0,1,0];break;case 2:case "2":B=[1,0,1,1,1,0,1];break;case 3:case "3":B=[1,0,1,1,0,1,1];break;case 4:case "4":B=[0,1,1,1,0,1,0];break;case 5:case "5":B=[1,1,0,1,0,1,1];break;case 6:case "6":B=[1,1,0,1,1,1,1];break;case 7:case "7":B=[1,0,1,0,0,1,0];break;case 8:case "8":B=[1,1,1,1,1,1,1];break;case 9:case "9":B=[1,1,1,1,0,1,1];break;
default:B=[0,0,0,0,0,0,0]}h();r()};h();r();return d};this.grapher_periodicWave=function(d,f,a,e,c,g,m,k,t,q,n,r,p,l){d=void 0===d?"grapher_periodicWave":d;e=void 0===e?120:e;c=void 0===c?60:c;m=void 0===m?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:m;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;t=void 0===t?"rgba(0,100,0,1)":t;q=void 0===q?.25:q;n=void 0===n?"rgba(0,150,0,1)":n;r=void 0===r?.1:r;p=void 0===p?"Helvetica":p;l=void 0===l?"rgba(50,50,50,1)":l;var h=
{sin:[],cos:[]},v=100;f=b.builder("group",d,{x:f,y:a,angle:void 0===g?0:g});var z=b.builder("grapher",d,{x:0,y:0,width:e,height:c,foregroundStyles:[m],foregroundTextStyles:[k],backgroundStyle_stroke:t,backgroundStyle_lineWidth:q,backgroundTextStyle_fill:n,backgroundTextStyle_size:r,backgroundTextStyle_font:p,backingStyle:l});f.append(z);f.wave=function(a,b){a=void 0===a?null:a;b=void 0===b?null:b;if(null==a){for(;h.sin.length<h.cos.length;)h.sin.push(0);for(;h.sin.length>h.cos.length;)h.cos.push(0);
for(a=0;a<h.sin.length;a++)h.sin[a]||(h.sin[a]=0),h.cos[a]||(h.cos[a]=0);return h}null==b&&(h=a);switch(b){case "sin":h.sin=a;break;case "cos":h.cos=a}};f.waveElement=function(a,b,c){if(null==c)return h[a][b];h[a][b]=c};f.resolution=function(a){a=void 0===a?null:a;if(null==a)return v;v=a};f.updateBackground=function(){z.viewbox({bottom:-1.1,top:1.1,left:0});z.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!0});z.verticalMarkings({points:[0,.25,.5,.75],printText:!0});z.drawBackground()};
f.draw=function(){for(var a=[],b,c=0;c<=v;c++){for(var e=b=0;e<h.sin.length;e++)h.sin[e]||(h.sin[e]=0),b+=Math.sin(c/v*e*Math.PI*2)*h.sin[e];for(e=0;e<h.cos.length;e++)h.cos[e]||(h.cos[e]=0),b+=Math.cos(c/v*e*Math.PI*2)*h.cos[e];a.push(b)}z.draw(a)};f.reset=function(){this.wave({sin:[],cos:[]});this.resolution(100);this.updateBackground()};return f};this.sixteenSegmentDisplay__static=function(d,f,a,e,c,g,m,k,t,q){function h(){I._.fillStyle=k;I._.fillRect(0,0,I.$(e),I.$(c))}function r(){for(var a=
0;a<H.length;a++){I._.beginPath();I._.moveTo(I.$(H[a][0].x),I.$(H[a][0].y));for(var b=1;b<H[a].length;b++)I._.lineTo(I.$(H[a][b].x),I.$(H[a][b].y));I._.closePath();I._.fillStyle=0==stamp[a]?q:t;I._.fill()}}e=void 0===e?20:e;c=void 0===c?30:c;m=void 0===m?5:m;k=void 0===k?"rgb(0,0,0)":k;t=void 0===t?"rgb(200,200,200)":t;q=void 0===q?"rgb(20,20,20)":q;var p=e/8,l=e/8,x=[{x:.5*l+p,y:.5*l+p},{x:1*l+p,y:0*l+p},{x:0*l+p,y:1*l+p},{x:1*l+p,y:1*l+p},{x:1.75*l+p,y:1*l+p},{x:1*l+p,y:1.75*l+p}],v=[{x:e/2,y:.5*
l+p},{x:e/2-.5*l,y:1*l+p},{x:e/2+.5*l,y:1*l+p},{x:e/2-.5*l,y:0*l+p},{x:e/2+.5*l,y:0*l+p}],z=[{x:e-.5*l-p,y:.5*l+p},{x:e-1*l-p,y:0*l+p},{x:e-0*l-p,y:1*l+p},{x:e-1*l-p,y:1*l+p},{x:e-1*l-p,y:1.75*l+p},{x:e-1.75*l-p,y:1*l+p}],w=[{x:0*l+p,y:.5*c-.5*l},{x:1*l+p,y:.5*c-.5*l},{x:.5*l+p,y:.5*c-0*l},{x:0*l+p,y:.5*c+.5*l},{x:1*l+p,y:.5*c+.5*l}],u=[{x:e/2,y:c/2},{x:e/2-.5*l,y:.5*l+c/2},{x:e/2-.25*l,y:1.25*l+c/2},{x:e/2-1*l,y:.5*l+c/2},{x:e/2+.5*l,y:.5*l+c/2},{x:e/2+.5*l,y:1.75*l+c/2},{x:e/2+1*l,y:.5*l+c/2},{x:e/
2-.5*l,y:.5*-l+c/2},{x:e/2-.25*l,y:1.25*-l+c/2},{x:e/2-1*l,y:.25*-l+c/2},{x:e/2+.5*l,y:.5*-l+c/2},{x:e/2+.5*l,y:1.75*-l+c/2},{x:e/2+1*l,y:.25*-l+c/2}],A=[{x:e-1*l-p,y:.5*c-.5*l},{x:e-0*l-p,y:.5*c-.5*l},{x:e-.5*l-p,y:.5*c-0*l},{x:e-1*l-p,y:.5*c+.5*l},{x:e-0*l-p,y:.5*c+.5*l}],B=[{x:.5*l+p,y:c-.5*l-p},{x:0*l+p,y:c-1*l-p},{x:1*l+p,y:c-0*l-p},{x:1*l+p,y:c-1*l-p},{x:1*l+p,y:c-1.75*l-p},{x:1.75*l+p,y:c-1*l-p}],C=[{x:e/2-.5*l,y:c-1*l-p},{x:e/2+.5*l,y:c-1*l-p},{x:e/2,y:c-.5*l-p},{x:e/2-.5*l,y:c-0*l-p},{x:e/
2+.5*l,y:c-0*l-p}];p=[{x:e-.5*l-p,y:c-.5*l-p},{x:e-0*l-p,y:c-1*l-p},{x:e-1*l-p,y:c-0*l-p},{x:e-1*l-p,y:c-1*l-p},{x:e-1*l-p,y:c-1.75*l-p},{x:e-1.75*l-p,y:c-1*l-p}];var H=[[x[1],x[0],x[3],v[1],v[0],v[3]],[v[4],v[0],v[2],z[3],z[0],z[1]],[x[0],x[2],w[0],w[2],w[1],x[3]],[x[4],x[3],x[5],u[9],u[7],u[8]],[v[0],v[1],u[7],u[0],u[10],v[2]],[z[4],z[3],z[5],u[11],u[10],u[12]],[z[0],z[2],A[1],A[2],A[0],z[3]],[w[4],w[2],w[1],u[7],u[0],u[1]],[A[3],A[2],A[0],u[10],u[0],u[4]],[B[0],B[1],w[3],w[2],w[4],B[3]],[B[4],
B[3],B[5],u[2],u[1],u[3]],[C[0],C[2],C[1],u[4],u[0],u[1]],[p[4],p[3],p[5],u[5],u[4],u[6]],[p[3],A[3],A[2],A[4],p[1],p[0]],[B[2],B[0],B[3],C[0],C[2],C[3]],[p[2],p[0],p[3],C[1],C[2],C[4]]];stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];d=b.builder("group",void 0===d?"sixteenSegmentDisplay__static":d,{x:f,y:a,angle:void 0===g?0:g});var I=b.builder("canvas","subcanvas",{width:e,height:c,resolution:m});d.append(I);d.set=function(a,b){stamp[a].state=b;r()};d.get=function(a){return segments[a].state};d.clear=function(){for(var a=
0;a<segments.length;a++)this.set(a,!1)};d.enterCharacter=function(a){switch(a){case "!":stamp=[1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,1];break;case "?":stamp=[1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1];break;case ".":stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0];break;case ",":stamp=[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0];break;case "'":stamp=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0];break;case ":":stamp=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case '"':stamp=[0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0];break;case "_":stamp=[0,0,0,0,0,0,0,0,0,0,0,
0,0,0,1,1];break;case "-":stamp=[0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0];break;case "\\":stamp=[0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0];break;case "/":stamp=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "*":stamp=[0,0,0,1,1,1,0,1,1,0,1,1,1,0,0,0];break;case "#":stamp=[1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1];break;case "<":stamp=[0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0];break;case ">":stamp=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0];break;case "(":stamp=[0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1];break;case ")":stamp=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,
1,0];break;case "[":stamp=[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "]":stamp=[1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1];break;case "{":stamp=[1,1,0,1,0,0,0,1,0,0,1,0,0,0,1,1];break;case "}":stamp=[1,1,0,0,0,1,0,0,1,0,0,0,1,0,1,1];break;case "0":case 0:stamp=[1,1,1,0,0,1,1,0,0,1,1,0,0,1,1,1];break;case "1":case 1:stamp=[1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "2":case 2:stamp=[1,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1];break;case "3":case 3:stamp=[1,1,0,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "4":case 4:stamp=
[0,0,1,0,0,0,1,1,1,0,0,0,0,1,0,0];break;case "5":case 5:stamp=[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "6":case 6:stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,1];break;case "7":case 7:stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0];break;case "8":case 8:stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1];break;case "9":case 9:stamp=[1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,1];break;case "a":case "A":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "b":case "B":stamp=[1,1,0,0,1,0,1,0,1,0,0,1,0,1,1,1];break;case "c":case "C":stamp=
[1,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "d":case "D":stamp=[1,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1];break;case "e":case "E":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,1,1];break;case "f":case "F":stamp=[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0];break;case "g":case "G":stamp=[1,1,1,0,0,0,0,0,1,1,0,0,0,1,1,1];break;case "h":case "H":stamp=[0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,0];break;case "i":case "I":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,1];break;case "j":case "J":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0];break;case "k":case "K":stamp=
[0,0,1,0,0,1,0,1,0,1,0,0,1,0,0,0];break;case "l":case "L":stamp=[0,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1];break;case "m":case "M":stamp=[0,0,1,1,0,1,1,0,0,1,0,0,0,1,0,0];break;case "n":case "N":stamp=[0,0,1,1,0,0,1,0,0,1,0,0,1,1,0,0];break;case "o":case "O":stamp=[1,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "p":case "P":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,0];break;case "q":case "Q":stamp=[1,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1];break;case "r":case "R":stamp=[1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,0];break;case "s":case "S":stamp=
[1,1,1,0,0,0,0,1,1,0,0,0,0,1,1,1];break;case "t":case "T":stamp=[1,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0];break;case "u":case "U":stamp=[0,0,1,0,0,0,1,0,0,1,0,0,0,1,1,1];break;case "v":case "V":stamp=[0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0];break;case "w":case "W":stamp=[0,0,1,0,0,0,1,0,0,1,1,0,1,1,0,0];break;case "x":case "X":stamp=[0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0];break;case "y":case "Y":stamp=[0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0];break;case "z":case "Z":stamp=[1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,1];break;case "all":stamp=
[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];break;default:stamp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}h();r()};h();r();return d};this.readout_sixteenSegmentDisplay__static=function(d,f,a,e,c,g,m,k,t,q,n){e=void 0===e?100:e;c=void 0===c?30:c;g=void 0===g?5:g;k=void 0===k?5:k;t=void 0===t?"rgb(0,0,0)":t;q=void 0===q?"rgb(200,200,200)":q;n=void 0===n?"rgb(20,20,20)":n;var h="",p=null;d=b.builder("group",void 0===d?"readout_sixteenSegmentDisplay__static":d,{x:f,y:a,angle:void 0===m?0:m});var l=[];for(f=0;f<g;f++)a=
b.builder("sixteenSegmentDisplay__static",""+f,{x:e/g*f,width:e/g,height:c,resolution:k,style:{background:t,glow:q,dim:n}}),d.append(a),l.push(a);d.text=function(a){if(null==a)return h;h=a};d.print=function(a){clearInterval(p);switch(a){case "smart":h.length>l.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;p=setInterval(function(){for(var a=l.length-1;0<=a;a--)l[a].enterCharacter(h[b-(l.length-1-a)]);b++;b>l.length+h.length-1&&(b=0)},150);break;default:for(a=0;a<
l.length;a++)l[a].enterCharacter(h[a])}};return d};this.readout_sixteenSegmentDisplay=function(d,f,a,e,c,g,m,k,t,q){e=void 0===e?100:e;c=void 0===c?30:c;g=void 0===g?5:g;k=void 0===k?"rgb(0,0,0)":k;t=void 0===t?"rgb(200,200,200)":t;q=void 0===q?"rgb(20,20,20)":q;var h="",r=null;d=b.builder("group",void 0===d?"readout_sixteenSegmentDisplay":d,{x:f,y:a,angle:void 0===m?0:m});var p=[];for(f=0;f<g;f++)a=b.builder("sixteenSegmentDisplay",""+f,{x:e/g*f,width:e/g,height:c,style:{background:k,glow:t,dim:q}}),
d.append(a),p.push(a);d.text=function(a){if(null==a)return h;h=a};d.print=function(a){clearInterval(r);switch(a){case "smart":h.length>p.length?this.print("r2lSweep"):this.print("regular");break;case "r2lSweep":var b=0;r=setInterval(function(){for(var a=p.length-1;0<=a;a--)p[a].enterCharacter(h[b-(p.length-1-a)]);b++;b>p.length+h.length-1&&(b=0)},150);break;default:for(a=0;a<p.length;a++)p[a].enterCharacter(h[a])}};return d};this.grapher_audioScope__static=function(d,f,a,e,c,h,m,k,t,q,n,r,p,l){d=
void 0===d?"grapher_audioScope__static":d;e=void 0===e?120:e;c=void 0===c?60:c;h=void 0===h?0:h;m=void 0===m?{stroke:"rgba(0,255,0,1)",lineWidth:.5,lineJoin:"round"}:m;k=void 0===k?{fill:"rgba(100,255,100,1)",size:.75,font:"Helvetica"}:k;t=void 0===t?"rgba(0,100,0,1)":t;q=void 0===q?.25:q;n=void 0===n?"rgba(0,150,0,1)":n;r=void 0===r?.1:r;p=void 0===p?"Helvetica":p;l=void 0===l?"rgba(50,50,50,1)":l;var y=g.library.audio.context.createAnalyser(),v=null,z=10,w=null,u=256;y.fftSize=u;v=new Uint8Array(y.fftSize);
new Uint8Array(y.fftSize);f=b.builder("group",d,{x:f,y:a,angle:h});var A=b.builder("grapher__static",d,{x:0,y:0,width:e,height:c,foregroundStyles:[m],foregroundTextStyles:[k],backgroundStyle_stroke:t,backgroundStyle_lineWidth:q,backgroundTextStyle_fill:n,backgroundTextStyle_size:r,backgroundTextStyle_font:p,backingStyle:l});f.append(A);f.start=function(){null==w&&(w=setInterval(function(){var a=[];y.getByteTimeDomainData(v);for(var b=0;b<v.length;b++)a.push(v[b]/128-1);A.draw(a)},1E3/z))};f.stop=
function(){clearInterval(w);w=null};f.getNode=function(){return y};f.resolution=function(a){a=void 0===a?null:a;if(null==a)return u;u=a;this.stop();this.start()};f.refreshRate=function(a){if(null==a)return z;z=a;this.stop();this.start()};A.viewbox({l:-1.1,h:1.1});A.horizontalMarkings({points:[1,.75,.5,.25,0,-.25,-.5,-.75,-1],printText:!1});A.verticalMarkings({points:[-.25,-.5,-.75,0,.25,.5,.75],printText:!1});A.drawBackground();return f};this.level=function(d,f,a,e,c,g,m,k){c=void 0===c?20:c;g=void 0===
g?60:g;m=void 0===m?"rgb(10,10,10)":m;k=void 0===k?["rgb(250,250,250)","rgb(200,200,200)"]:k;var h=[];d=b.builder("group",void 0===d?"level":d,{x:f,y:a,angle:void 0===e?0:e});m=b.builder("rectangle","backing",{width:c,height:g,style:{fill:m}});d.append(m);m=b.builder("group","levels");d.append(m);var q=[];for(f=0;f<k.length;f++)h.push(0),q.push(b.builder("rectangle","movingRect_"+f,{y:g,width:c,height:0,style:{fill:k[f]}})),m.prepend(q[f]);d.layer=function(a,b){b=void 0===b?0:b;if(void 0==b)return h;
if(null==a)return h[b];a=1<a?1:a;a=0>a?0:a;h[b]=a;q[b].parameter.height(g*a);q[b].parameter.y(g-g*a)};return d}};this.dynamic=new function(){this.connectionNode_voltage=function(d,f,a,e,c,g,m,k,r,q,n,y,p,l,x){p=void 0===p?function(a){}:p;l=void 0===l?function(a){}:l;x=void 0===x?function(a){}:x;var h=b.builder("connectionNode",void 0===d?"connectionNode_voltage":d,{x:f,y:a,angle:void 0===e?0:e,width:void 0===c?20:c,height:void 0===g?20:g,allowConnections:void 0===m?!0:m,allowDisconnections:void 0===
k?!0:k,type:"voltage",style:{dim:void 0===r?"rgb(222, 255, 220)":r,glow:void 0===q?"rgb(240, 252, 239)":q,cable_dim:void 0===n?"rgb(84, 247, 111)":n,cable_glow:void 0===y?"rgb(159, 252, 174)":y}}),t=0;h._getLocalValue=function(){return t};h._update=function(a){0<a?h.activate():h.deactivate();p(a)};h.set=function(a){t=a;a=h.read();h._update(a);void 0!=h.getForeignNode()&&h.getForeignNode()._update(a)};h.read=function(){return t+(void 0!=h.getForeignNode()?h.getForeignNode()._getLocalValue():!1)};h.onconnect=
function(a){l&&l(a);h._update(h.read())};h.ondisconnect=function(a){x&&x(a);h._update(t)};return h};this.cable=function(d,f,a,e,c,g,m){f=void 0===f?0:f;a=void 0===a?0:a;e=void 0===e?0:e;c=void 0===c?0:c;g=void 0===g?"rgb(255,0,0)":g;m=void 0===m?"rgb(255,100,100)":m;d=b.builder("group",void 0===d?"path":d);var h=b.builder("path","cable",{points:[{x:f,y:a},{x:e,y:c}],style:{stroke:g,lineWidth:5}});d.append(h);d.activate=function(){h.style.stroke=m};d.deactivate=function(){h.style.stroke=g};d.draw=
function(b,d,g,k){f=void 0!=b?b:f;a=void 0!=d?d:a;e=void 0!=g?g:e;c=void 0!=k?k:c;h.parameter.points([{x:f,y:a},{x:e,y:c}])};d._isCable=!0;return d};this.connectionNode_audio=function(d,f,a,e,c,g,m,k,r,q,n,y,p,l,x,v){r=void 0===r?!1:r;x=void 0===x?function(){}:x;v=void 0===v?function(){}:v;var h=b.builder("connectionNode",void 0===d?"connectionNode_audio":d,{x:f,y:a,angle:void 0===e?0:e,width:void 0===c?20:c,height:void 0===g?20:g,allowConnections:void 0===m?!0:m,allowDisconnections:void 0===k?!0:
k,type:"audio",direction:r?"out":"in",style:{dim:void 0===n?"rgba(255, 244, 220, 1)":n,glow:void 0===y?"rgba(255, 244, 244, 1)":y,cable_dim:void 0===p?"rgb(247, 146, 84)":p,cable_glow:void 0===l?"rgb(242, 168, 123)":l}});h._direction=r?"out":"in";h.audioNode=q.createAnalyser();h.out=function(){return h.audioNode};h.in=function(){return h.audioNode};h.onconnect=function(a){"out"==h._direction&&h.audioNode.connect(h.getForeignNode().audioNode);x&&x(a)};h.ondisconnect=function(a){"out"==h._direction&&
h.audioNode.disconnect(h.getForeignNode().audioNode);v&&v(a)};return h};this.connectionNode_data=function(d,f,a,e,c,g,m,k,r,q,n,y,p,l,x,v){function h(a){a.activate();setTimeout(function(){void 0!=a&&a.deactivate()},100);void 0!=a.getForeignNode()&&(a.getForeignNode().activate(),setTimeout(function(){void 0!=a&&void 0!=a.getForeignNode()&&a.getForeignNode().deactivate()},100))}p=void 0===p?function(a,b){}:p;l=void 0===l?function(a){}:l;var t=b.builder("connectionNode",void 0===d?"connectionNode_data":
d,{x:f,y:a,angle:void 0===e?0:e,width:void 0===c?20:c,height:void 0===g?20:g,allowConnections:void 0===m?!0:m,allowDisconnections:void 0===k?!0:k,type:"data",style:{dim:void 0===r?"rgba(220, 244, 255,1)":r,glow:void 0===q?"rgba(244, 244, 255, 1)":q,cable_dim:void 0===n?"rgb(84, 146, 247)":n,cable_glow:void 0===y?"rgb(123, 168, 242)":y},onconnect:void 0===x?function(){}:x,ondisconnect:void 0===v?function(){}:v});t.send=function(a,b){h(t);if(void 0!=t.getForeignNode())t.getForeignNode().onreceivedata(a,
b)};t.request=function(a){h(t);if(void 0!=t.getForeignNode())t.getForeignNode().ongivedata(a)};t.onreceivedata=p;t.ongivedata=l;return t};this.connectionNode=function(d,f,a,e,c,h,m,k,r,q,n,y,p,l,x,v){c=void 0===c?20:c;h=void 0===h?20:h;m=void 0===m?"none":m;k=void 0===k?"":k;r=void 0===r?!0:r;q=void 0===q?!0:q;n=void 0===n?"rgb(220, 220, 220)":n;y=void 0===y?"rgb(244, 244, 244)":y;p=void 0===p?"rgb(146, 146, 146)":p;l=void 0===l?"rgb(215, 215, 215)":l;x=void 0===x?function(a){}:x;v=void 0===v?function(a){}:
v;var t=b.builder("group",void 0===d?"connectionNode2":d,{x:f,y:a,angle:void 0===e?0:e});t._connectionNode=!0;t._type=m;t._direction=k;var w=b.builder("rectangle","node",{width:c,height:h,style:{fill:n}});t.append(w);var u=void 0;t.isConnected=function(){return void 0!=A};t.canDisconnect=function(){return this.allowDisconnections()&&void 0!=u&&u.allowDisconnections()};t.allowConnections=function(a){if(void 0==a)return r;r=a};t.allowDisconnections=function(a){if(void 0==a)return q;q=a};t.connectTo=
function(a){if(void 0!=a&&a!=this&&a._type==this._type&&(""!=this._direction&&""!=a._direction||this._direction==a._direction)&&(""==this._direction||a._direction!=this._direction)&&a!=u){this.disconnect();u=a;if(void 0!=x)this.onconnect(!0);u._receiveConnection(this);this._addCable(this)}};t._receiveConnection=function(a){this.disconnect();u=a;if(void 0!=x)this.onconnect(!1)};t.disconnect=function(){if(void 0!=u){this._removeCable();if(void 0!=v)this.ondisconnect(!0);u._receiveDisconnection();u=
null}};t._receiveDisconnection=function(){if(void 0!=v)this.ondisconnect(!1);u=null};t.getForeignNode=function(){return u};w.onmousedown=function(a,b,c){g.system.mouse.mouseInteractionHandler(void 0,function(a){a=g.core.viewport.windowPoint2workspacePoint(a.x,a.y);a=g.core.arrangement.getElementUnderPoint(a.x,a.y);void 0!=a&&(a=a.parent,!a._connectionNode||a.isConnected()&&!a.canDisconnect()||t.isConnected()&&!t.canDisconnect()||r&&a.allowConnections()&&t.connectTo(a))})};w.ondblclick=function(a,
b,c){q&&u.allowDisconnections()&&t.disconnect()};var A;t._addCable=function(){A=b.builder("cable","cable-"+this.getAddress(),{x1:0,y1:0,x2:100,y2:100,style:{dim:p,glow:l}});u._receiveCable(A);g.system.pane.getMiddlegroundPane(this).append(A);this.draw()};t._receiveCable=function(a){A=a};t._removeCable=function(){A.parent.remove(A);A=void 0;u._loseCable()};t._loseCable=function(){A=void 0};t.getCablePoint=function(){var b=this.getOffset(),e=g.library.math.cartesianAngleAdjust(f+c/2,a+h/2,b.a);e.x+=
b.x;e.y+=b.y;return e};t.draw=function(){if(void 0!=A){var a=this.getCablePoint(),b=u.getCablePoint();A.draw(a.x,a.y,b.x,b.y)}};t.activate=function(){w.style.fill=y;void 0!=A&&A.activate()};t.deactivate=function(){w.style.fill=n;void 0!=A&&A.deactivate()};t.onconnect=x;t.ondisconnect=v;return t};this.connectionNode_signal=function(d,f,a,e,c,g,m,k,t,q,n,r,p,l,x){p=void 0===p?function(a){}:p;l=void 0===l?function(a){}:l;x=void 0===x?function(a){}:x;var h=b.builder("connectionNode",void 0===d?"connectionNode_signal":
d,{x:f,y:a,angle:void 0===e?0:e,width:void 0===c?20:c,height:void 0===g?20:g,allowConnections:void 0===m?!0:m,allowDisconnections:void 0===k?!0:k,type:"signal",style:{dim:void 0===t?"rgb(255, 220, 244)":t,glow:void 0===q?"rgb(255, 244, 244)":q,cable_dim:void 0===n?"rgb(247, 84, 146)":n,cable_glow:void 0===r?"rgb(247, 195, 215)":r}}),y=!1;h._getLocalValue=function(){return y};h._update=function(){var a=h.read();a?h.activate():h.deactivate();p(a)};h.set=function(a){y=a;h._update();void 0!=h.getForeignNode()&&
h.getForeignNode()._update()};h.read=function(){return y||(void 0!=h.getForeignNode()?h.getForeignNode()._getLocalValue():!1)};h.onconnect=function(a){l&&l(a);h._update()};h.ondisconnect=function(a){x&&x(a);h._update()};return h}}};this.builder=function(b,f,a){a||(a={});void 0==a.style&&(a.style={});switch(b){default:return console.warn("Unknown element: "+b),null;case "group":return this.collection.basic.group(f,a.x,a.y,a.angle,a.ignored);case "rectangle":return this.collection.basic.rectangle(f,
a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);case "image":return this.collection.basic.image(f,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.url);case "canvas":return this.collection.basic.canvas(f,a.x,a.y,a.width,a.height,a.angle,a.anchor,a.ignored,a.resolution);case "polygon":return this.collection.basic.polygon(f,a.points,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);
case "text":return this.collection.basic.text(f,a.x,a.y,a.text,a.angle,a.anchor,a.size,a.ignored,a.style.font,a.style.textAlign,a.style.textBaseline,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);case "circle":return this.collection.basic.circle(f,a.x,a.y,a.r,a.ignored,a.style.fill,a.style.stroke,a.style.lineWidth,a.style.lineJoin,a.style.miterLimit);case "path":return this.collection.basic.path(f,a.points,a.ignored,a.style.stroke,a.style.lineWidth,a.style.lineCap,
a.style.lineJoin,a.style.miterLimit);case "glowbox_rect":return this.collection.display.glowbox_rect(f,a.x,a.y,a.width,a.height,a.angle,a.style.glow,a.style.dim);case "sevenSegmentDisplay":return this.collection.display.sevenSegmentDisplay(f,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,a.style.dim);case "sevenSegmentDisplay__static":return this.collection.display.sevenSegmentDisplay__static(f,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);
case "sixteenSegmentDisplay":return this.collection.display.sixteenSegmentDisplay(f,a.x,a.y,a.width,a.height,a.angle,a.style.background,a.style.glow,a.style.dim);case "sixteenSegmentDisplay__static":return this.collection.display.sixteenSegmentDisplay__static(f,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "readout_sixteenSegmentDisplay":return this.collection.display.readout_sixteenSegmentDisplay(f,a.x,a.y,a.width,a.height,a.count,a.angle,a.style.background,
a.style.glow,a.style.dim);case "readout_sixteenSegmentDisplay__static":return this.collection.display.readout_sixteenSegmentDisplay__static(f,a.x,a.y,a.width,a.height,a.count,a.angle,a.resolution,a.style.background,a.style.glow,a.style.dim);case "level":return this.collection.display.level(f,a.x,a.y,a.angle,a.width,a.height,a.style.backing,a.style.levels);case "meter_level":return this.collection.display.meter_level(f,a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,
a.style.markingStyle_font);case "audio_meter_level":return this.collection.display.audio_meter_level(f,a.x,a.y,a.angle,a.width,a.height,a.markings,a.style.backing,a.style.levels,a.style.markingStyle_fill,a.style.markingStyle_font);case "rastorDisplay":return this.collection.display.rastorDisplay(f,a.x,a.y,a.angle,a.width,a.height,a.xCount,a.yCount,a.xGappage,a.yGappage);case "grapher":return this.collection.display.grapher(f,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,
a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher__static":return this.collection.display.grapher__static(f,a.x,a.y,a.width,a.height,a.angle,a.resolution,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave":return this.collection.display.grapher_periodicWave(f,a.x,
a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_periodicWave__static":return this.collection.display.grapher_periodicWave__static(f,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,
a.style.backgroundText_font,a.style.backing);case "grapher_audioScope":return this.collection.display.grapher_audioScope(f,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "grapher_audioScope__static":return this.collection.display.grapher_audioScope__static(f,a.x,a.y,a.width,a.height,a.angle,a.style.foregrounds,
a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_size,a.style.backgroundText_font,a.style.backing);case "button_":return this.collection.control.button_(f,a.x,a.y,a.angle,a.interactable,a.active,a.hoverable,a.selectable,a.pressable,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect,a.subject);case "button_image":return this.collection.control.button_image(f,a.x,a.y,a.width,a.height,a.angle,
a.interactable,a.active,a.hoverable,a.selectable,a.pressable,a.backingImageUrl__off,a.backingImageUrl__up,a.backingImageUrl__press,a.backingImageUrl__select,a.backingImageUrl__select_press,a.backingImageUrl__glow,a.backingImageUrl__glow_press,a.backingImageUrl__glow_select,a.backingImageUrl__glow_select_press,a.backingImageUrl__hover,a.backingImageUrl__hover_press,a.backingImageUrl__hover_select,a.backingImageUrl__hover_select_press,a.backingImageUrl__hover_glow,a.backingImageUrl__hover_glow_press,
a.backingImageUrl__hover_glow_select,a.backingImageUrl__hover_glow_select_press,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "button_circle":return this.collection.control.button_circle(f,a.x,a.y,a.r,a.angle,a.interactable,a.text_centre,a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,
a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,a.style.background__select__fill,a.style.background__select__stroke,a.style.background__select__strokeWidth,a.style.background__select_press__fill,a.style.background__select_press__stroke,a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,
a.style.background__glow_press__fill,a.style.background__glow_press__stroke,a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,a.style.background__glow_select__strokeWidth,a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,a.style.background__glow_select_press__strokeWidth,a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,
a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,a.style.background__hover_select_press__fill,a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,a.style.background__hover_glow__fill,a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,
a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,a.style.background__hover_glow_select_press__fill,a.style.background__hover_glow_select_press__stroke,a.style.background__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "button_polygon":return this.collection.control.button_polygon(f,
a.x,a.y,a.points,a.angle,a.interactable,a.text_centre,a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,
a.style.background__select__fill,a.style.background__select__stroke,a.style.background__select__strokeWidth,a.style.background__select_press__fill,a.style.background__select_press__stroke,a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,a.style.background__glow_press__fill,a.style.background__glow_press__stroke,a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,
a.style.background__glow_select__strokeWidth,a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,a.style.background__glow_select_press__strokeWidth,a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,
a.style.background__hover_select_press__fill,a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,a.style.background__hover_glow__fill,a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,
a.style.background__hover_glow_select_press__fill,a.style.background__hover_glow_select_press__stroke,a.style.background__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "button_rectangle":return this.collection.control.button_rectangle(f,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.text_centre,a.text_left,a.text_right,a.textVerticalOffsetMux,a.textHorizontalOffsetMux,a.active,a.hoverable,a.selectable,a.pressable,a.style.text_font,
a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.background__off__fill,a.style.background__off__stroke,a.style.background__off__strokeWidth,a.style.background__up__fill,a.style.background__up__stroke,a.style.background__up__strokeWidth,a.style.background__press__fill,a.style.background__press__stroke,a.style.background__press__strokeWidth,a.style.background__select__fill,a.style.background__select__stroke,a.style.background__select__strokeWidth,a.style.background__select_press__fill,
a.style.background__select_press__stroke,a.style.background__select_press__strokeWidth,a.style.background__glow__fill,a.style.background__glow__stroke,a.style.background__glow__strokeWidth,a.style.background__glow_press__fill,a.style.background__glow_press__stroke,a.style.background__glow_press__strokeWidth,a.style.background__glow_select__fill,a.style.background__glow_select__stroke,a.style.background__glow_select__strokeWidth,a.style.background__glow_select_press__fill,a.style.background__glow_select_press__stroke,
a.style.background__glow_select_press__strokeWidth,a.style.background__hover__fill,a.style.background__hover__stroke,a.style.background__hover__strokeWidth,a.style.background__hover_press__fill,a.style.background__hover_press__stroke,a.style.background__hover_press__strokeWidth,a.style.background__hover_select__fill,a.style.background__hover_select__stroke,a.style.background__hover_select__strokeWidth,a.style.background__hover_select_press__fill,a.style.background__hover_select_press__stroke,a.style.background__hover_select_press__strokeWidth,
a.style.background__hover_glow__fill,a.style.background__hover_glow__stroke,a.style.background__hover_glow__strokeWidth,a.style.background__hover_glow_press__fill,a.style.background__hover_glow_press__stroke,a.style.background__hover_glow_press__strokeWidth,a.style.background__hover_glow_select__fill,a.style.background__hover_glow_select__stroke,a.style.background__hover_glow_select__strokeWidth,a.style.background__hover_glow_select_press__fill,a.style.background__hover_glow_select_press__stroke,
a.style.background__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselect,a.ondeselect);case "dial_continuous":return this.collection.control.dial_continuous(f,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.startAngle,a.maxAngle,a.style.handle,a.style.slot,a.style.needle,a.onchange,a.onrelease);case "dial_discrete":return this.collection.control.dial_discrete(f,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.optionCount,a.startAngle,
a.maxAngle,a.style.handle,a.style.slot,a.style.needle,a.onchange,a.onrelease);case "dial_image_continuous":return this.collection.control.dial_image_continuous(f,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.startAngle,a.maxAngle,a.handleUrl,a.slotUrl,a.needleUrl,a.onchange,a.onrelease);case "dial_image_discrete":return this.collection.control.dial_image_discrete(f,a.x,a.y,a.r,a.angle,a.interactable,a.value,a.resetValue,a.optionCount,a.startAngle,a.maxAngle,a.handleUrl,a.slotUrl,a.needleUrl,
a.onchange,a.onrelease);case "slide":return this.collection.control.slide(f,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.handleHeight,a.value,a.resetValue,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "slidePanel":return this.collection.control.slidePanel(f,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.handleHeight,a.count,a.value,a.resetValue,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.onchange,a.onrelease);case "rangeslide":return this.collection.control.rangeslide(f,
a.x,a.y,a.width,a.height,a.angle,a.interactable,a.handleHeight,a.spanWidth,a.values,a.resetValues,a.style.handle,a.style.backing,a.style.slot,a.style.invisibleHandle,a.style.span,a.onchange,a.onrelease);case "list":return this.collection.control.list(f,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.list,a.itemTextVerticalOffsetMux,a.itemTextHorizontalOffsetMux,a.active,a.multiSelect,a.hoverable,a.selectable,a.pressable,a.itemHeightMux,a.itemWidthMux,a.itemSpacingMux,a.breakHeightMux,a.breakWidthMux,
a.spacingHeightMux,a.style.backing,a.style.break,a.style.text_font,a.style.text_textBaseline,a.style.text_fill,a.style.text_stroke,a.style.text_lineWidth,a.style.item__off__fill,a.style.item__off__stroke,a.style.item__off__strokeWidth,a.style.item__up__fill,a.style.item__up__stroke,a.style.item__up__strokeWidth,a.style.item__press__fill,a.style.item__press__stroke,a.style.item__press__strokeWidth,a.style.item__select__fill,a.style.item__select__stroke,a.style.item__select__strokeWidth,a.style.item__select_press__fill,
a.style.item__select_press__stroke,a.style.item__select_press__strokeWidth,a.style.item__glow__fill,a.style.item__glow__stroke,a.style.item__glow__strokeWidth,a.style.item__glow_press__fill,a.style.item__glow_press__stroke,a.style.item__glow_press__strokeWidth,a.style.item__glow_select__fill,a.style.item__glow_select__stroke,a.style.item__glow_select__strokeWidth,a.style.item__glow_select_press__fill,a.style.item__glow_select_press__stroke,a.style.item__glow_select_press__strokeWidth,a.style.item__hover__fill,
a.style.item__hover__stroke,a.style.item__hover__strokeWidth,a.style.item__hover_press__fill,a.style.item__hover_press__stroke,a.style.item__hover_press__strokeWidth,a.style.item__hover_select__fill,a.style.item__hover_select__stroke,a.style.item__hover_select__strokeWidth,a.style.item__hover_select_press__fill,a.style.item__hover_select_press__stroke,a.style.item__hover_select_press__strokeWidth,a.style.item__hover_glow__fill,a.style.item__hover_glow__stroke,a.style.item__hover_glow__strokeWidth,
a.style.item__hover_glow_press__fill,a.style.item__hover_glow_press__stroke,a.style.item__hover_glow_press__strokeWidth,a.style.item__hover_glow_select__fill,a.style.item__hover_glow_select__stroke,a.style.item__hover_glow_select__strokeWidth,a.style.item__hover_glow_select_press__fill,a.style.item__hover_glow_select_press__stroke,a.style.item__hover_glow_select_press__strokeWidth,a.onenter,a.onleave,a.onpress,a.ondblpress,a.onrelease,a.onselection,a.onpositionchange);case "checkbox_rect":return this.collection.control.checkbox_rect(f,
a.x,a.y,a.width,a.height,a.angle,a.interactable,a.style.check,a.style.backing,a.style.checkGlow,a.style.backingGlow,a.onchange);case "rastorgrid":return this.collection.control.rastorgrid(f,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.xCount,a.yCount,a.style.backing,a.style.check,a.style.backingGlow,a.style.checkGlow,a.onchange);case "needleOverlay":return this.collection.control.needleOverlay(f,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.needleWidth,a.selectNeedle,a.selectionArea,a.style.needles,
a.onchange,a.onrelease,a.selectionAreaToggle);case "grapher_waveWorkspace":return this.collection.control.grapher_waveWorkspace(f,a.x,a.y,a.width,a.height,a.angle,a.interactable,a.selectNeedle,a.selectionArea,a.style.foregrounds,a.style.foregroundText,a.style.background_stroke,a.style.background_lineWidth,a.style.backgroundText_fill,a.style.backgroundText_font,a.style.backing,a.onchange,a.onrelease,a.selectionAreaToggle);case "sequencer":return this.collection.control.sequencer(f,a.x,a.y,a.width,
a.height,a.angle,a.interactable,a.xCount,a.yCount,a.zoomLevel_x,a.zoomLevel_y,a.backingStyle,a.selectionAreaStyle,a.blockStyle_body,a.blockStyle_bodyGlow,a.blockStyle_handle,a.blockStyle_handleWidth,a.horizontalStripStyle_pattern,a.horizontalStripStyle_glow,a.horizontalStripStyle_styles,a.verticalStripStyle_pattern,a.verticalStripStyle_glow,a.verticalStripStyle_styles,a.playheadStyle,a.onpan,a.onchangeviewarea,a.event);case "cable":return this.collection.dynamic.cable(f,a.x1,a.y1,a.x2,a.y2,a.style.dim,
a.style.glow);case "connectionNode":return this.collection.dynamic.connectionNode(f,a.x,a.y,a.angle,a.width,a.height,a.type,a.direction,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect);case "connectionNode_signal":return this.collection.dynamic.connectionNode_signal(f,a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,
a.ondisconnect);case "connectionNode_voltage":return this.collection.dynamic.connectionNode_voltage(f,a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onchange,a.onconnect,a.ondisconnect);case "connectionNode_data":return this.collection.dynamic.connectionNode_data(f,a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onreceive,
a.ongive,a.onconnect,a.ondisconnect);case "connectionNode_audio":return this.collection.dynamic.connectionNode_audio(f,a.x,a.y,a.angle,a.width,a.height,a.allowConnections,a.allowDisconnections,a.isAudioOutput,g.library.audio.context,a.style.dim,a.style.glow,a.style.cable_dim,a.style.cable_glow,a.onconnect,a.ondisconnect)}}};this.unit=new function(){this.collection=new function(){this.test=new function(){this.testUnit_1=function(b,d,f){b=r.unit.builder(this.testUnit_1,{name:"testUnit_1",collection:"test",
x:b,y:d,a:f,space:[{x:-5,y:-5},{x:280,y:-5},{x:280,y:30},{x:605,y:30},{x:605,y:130},{x:705,y:130},{x:705,y:210},{x:240,y:210},{x:240,y:325},{x:430,y:325},{x:430,y:435},{x:-5,y:445}],elements:[{type:"rectangle",name:"testRectangle",data:{x:5,y:5,width:30,height:30,style:{fill:"rgba(255,0,0,1)"}}},{type:"circle",name:"testCircle",data:{x:20,y:55,r:15}},{type:"image",name:"testImage",data:{x:40,y:40,width:30,height:30,url:"https://t2.genius.com/unsafe/300x300/https%3A%2F%2Fimages.genius.com%2F72ee0b753f056baa410c17a6ad9fea70.588x588x1.jpg"}},
{type:"polygon",name:"testPolygon",data:{points:[{x:55,y:5},{x:70,y:35},{x:40,y:35}],style:{fill:"rgba(0,255,0,1)"}}},{type:"text",name:"testText",data:{x:7.5,y:95,text:"Hello",style:{font:"20pt Arial",fill:"rgba(150,150,255,1)"}}},{type:"path",name:"testPath",data:{points:[{x:0,y:0},{x:0,y:90},{x:2.5,y:90},{x:2.5,y:72.5},{x:75,y:72.5}]}},{type:"glowbox_rect",name:"test_glowbox_rect",data:{x:90,y:0}},{type:"sevenSegmentDisplay",name:"test_sevenSegmentDisplay",data:{x:125,y:0}},{type:"sixteenSegmentDisplay",
name:"test_sixteenSegmentDisplay",data:{x:150,y:0}},{type:"readout_sixteenSegmentDisplay",name:"test_readout_sixteenSegmentDisplay",data:{x:175,y:0}},{type:"level",name:"test_level1",data:{x:90,y:35}},{type:"meter_level",name:"test_meterLevel1",data:{x:115,y:35}},{type:"audio_meter_level",name:"test_audioMeterLevel1",data:{x:140,y:35}},{type:"rastorDisplay",name:"test_rastorDisplay1",data:{x:165,y:35}},{type:"grapher",name:"test_grapher1",data:{x:230,y:35}},{type:"grapher_periodicWave",name:"test_grapher_periodicWave1",
data:{x:355,y:35}},{type:"grapher_audioScope",name:"test_grapher_audioScope1",data:{x:480,y:35}},{type:"slide",name:"test_slide1",data:{x:0,y:110}},{type:"slidePanel",name:"test_slidePanel1",data:{x:15,y:110}},{type:"slide",name:"test_slide2",data:{x:0,y:220,angle:-Math.PI/2}},{type:"slidePanel",name:"test_slidePanel2",data:{x:0,y:305,angle:-Math.PI/2}},{type:"rangeslide",name:"test_rangeslide1",data:{x:100,y:110}},{type:"rangeslide",name:"test_rangeslide2",data:{x:100,y:220,angle:-Math.PI/2}},{type:"dial_continuous",
name:"test_dial_continuous1",data:{x:130,y:125}},{type:"dial_discrete",name:"test_dial_discrete1",data:{x:170,y:125}},{type:"button_rectangle",name:"test_button_rectangle1",data:{x:115,y:145}},{type:"list",name:"test_list1",data:{x:185,y:225,list:["space",{text_left:"item1",text_centre:"",text_right:"",function:function(){console.log("item1 function")}},{text_left:"item2",text_centre:"",text_right:"",function:function(){console.log("item2 function")}},{text_left:"item3",text_centre:"",text_right:"",
function:function(){console.log("item3 function")}},{text_left:"item4",text_centre:"",text_right:"",function:function(){console.log("item4 function")}},{text_left:"item5",text_centre:"",text_right:"",function:function(){console.log("item5 function")}},"break",{text_left:"item6",text_centre:"",text_right:"",function:function(){console.log("item6 function")}},{text_left:"item7",text_centre:"",text_right:"",function:function(){console.log("item7 function")}},{text_left:"item8",text_centre:"",text_right:"",
function:function(){console.log("item8 function")}},{text_left:"item9",text_centre:"",text_right:"",function:function(){console.log("item9 function")}},{text_left:"item10",text_centre:"",text_right:"",function:function(){console.log("item10 function")}},"break",{text_left:"item11",text_centre:"",text_right:"",function:function(){console.log("item11 function")}},{text_left:"item12",text_centre:"",text_right:"",function:function(){console.log("item12 function")}},{text_left:"item13",text_centre:"",
text_right:"",function:function(){console.log("item13 function")}},{text_left:"item14",text_centre:"",text_right:"",function:function(){console.log("item14 function")}},{text_left:"item15",text_centre:"",text_right:"",function:function(){console.log("item15 function")}},"space"]}},{type:"checkbox_rect",name:"test_checkbox_rect1",data:{x:150,y:145}},{type:"rastorgrid",name:"test_rastorgrid1",data:{x:100,y:225}},{type:"needleOverlay",name:"test_needleOverlay1",data:{x:0,y:310}},{type:"grapher_waveWorkspace",
name:"test_grapher_waveWorkspace1",data:{x:0,y:375}},{type:"sequencer",name:"test_sequencer1",data:{x:125,y:330}},{type:"connectionNode",name:"test_connectionNode1",data:{x:255,y:135}},{type:"connectionNode",name:"test_connectionNode2",data:{x:230,y:185}},{type:"connectionNode",name:"test_connectionNode3",data:{x:280,y:185}},{type:"connectionNode_signal",name:"test_connectionNode_signal1",data:{x:355,y:135}},{type:"connectionNode_signal",name:"test_connectionNode_signal2",data:{x:330,y:185}},{type:"connectionNode_signal",
name:"test_connectionNode_signal3",data:{x:380,y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage1",data:{x:455,y:135}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage2",data:{x:430,y:185}},{type:"connectionNode_voltage",name:"test_connectionNode_voltage3",data:{x:480,y:185}},{type:"connectionNode_data",name:"test_connectionNode_data1",data:{x:555,y:135}},{type:"connectionNode_data",name:"test_connectionNode_data2",data:{x:530,y:185}},{type:"connectionNode_data",
name:"test_connectionNode_data3",data:{x:580,y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio1",data:{x:655,y:135,isAudioOutput:!0}},{type:"connectionNode_audio",name:"test_connectionNode_audio2",data:{x:630,y:185}},{type:"connectionNode_audio",name:"test_connectionNode_audio3",data:{x:680,y:185}}]});b.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.text("hello");b.elements.readout_sixteenSegmentDisplay.test_readout_sixteenSegmentDisplay.print();b.elements.grapher.test_grapher1.draw([0,
-2,1,-1,2],[0,.25,.5,.75,1]);b.elements.grapher.test_grapher1.draw([0,.25,1],void 0,1);b.elements.grapher_periodicWave.test_grapher_periodicWave1.updateBackground();b.elements.grapher_periodicWave.test_grapher_periodicWave1.wave({sin:[0,1,0,1/3,0,.2,0,1/7,0,1/9,0,1/11,0,1/13,0,1/15],cos:[0,0]});b.elements.grapher_periodicWave.test_grapher_periodicWave1.draw();b.elements.needleOverlay.test_needleOverlay1.select(.25);b.elements.needleOverlay.test_needleOverlay1.area(.5,.75);b.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.select(.25);
b.elements.grapher_waveWorkspace.test_grapher_waveWorkspace1.area(.5,.75);b.elements.sequencer.test_sequencer1.addSignal(0,0,10,0);b.elements.sequencer.test_sequencer1.addSignal(1,1,10,.1);b.elements.sequencer.test_sequencer1.addSignal(2,2,10,.2);b.elements.sequencer.test_sequencer1.addSignal(3,3,10,.3);b.elements.sequencer.test_sequencer1.addSignal(4,4,10,.4);b.elements.sequencer.test_sequencer1.addSignal(5,5,10,.5);b.elements.sequencer.test_sequencer1.addSignal(6,6,10,.6);b.elements.sequencer.test_sequencer1.addSignal(7,
7,10,.7);b.elements.sequencer.test_sequencer1.addSignal(8,8,10,.8);b.elements.sequencer.test_sequencer1.addSignal(9,9,10,.9);b.elements.sequencer.test_sequencer1.addSignal(10,10,10,1);return b};this.testUnit_1.devUnit=!0;this.testUnit_1.metadata={name:"Test Unit 1",helpURL:"https://curve.metasophiea.com/help/units/test/testUnit_1/"};this.testUnit_2=function(b,d,f){return r.unit.builder(this.testUnit_2,{name:"testUnit_2",collection:"test",x:b,y:d,a:f,space:[{x:0,y:0},{x:100,y:0},{x:100,y:100},{x:0,
y:100}],elements:[{type:"rectangle",name:"testRectangle1",data:{x:0,y:0,width:100,height:100,style:{fill:"rgba(200,200,200,1)"}}},{type:"rectangle",name:"testRectangle2",data:{x:10,y:10,width:80,height:80,style:{fill:"rgba(200,100,200,1)"}}}]})};this.testUnit_2.devUnit=!0;this.testUnit_2.metadata={name:"Test Unit 2",helpURL:"https://curve.metasophiea.com/help/units/test/testUnit_2/"}}};this.builder=function(b,d){function f(){a.space={points:d.space.map(function(b){b=g.library.math.cartesianAngleAdjust(b.x,
b.y,a.parameter.angle());return{x:d.x+b.x,y:d.y+b.y}})};a.space.boundingBox=g.library.math.boundingBoxFromPoints(a.space.points)}if(b){var a=g._interface.part.builder("group",d.name,{x:d.x,y:d.y,angle:d.a});a.model=d.name;a.collection=d.collection;a.creatorMethod=b;a.elements={};for(b=0;b<d.elements.length;b++)if(void 0!=a.getChildByName(d.elements[b].name))console.warn('error: part with the name "'+d.elements[b].name+'" already exists. Part:',d.elements[b],"will not be added");else{var e=g._interface.part.builder(d.elements[b].type,
d.elements[b].name,d.elements[b].data);a.append(e);void 0==a.elements[d.elements[b].type]&&(a.elements[d.elements[b].type]={});a.elements[d.elements[b].type][d.elements[b].name]=e}a.io={};[{key:"_",name:"connectionNode"},{key:"signal",name:"connectionNode_signal"},{key:"voltage",name:"connectionNode_voltage"},{key:"data",name:"connectionNode_data"},{key:"audio",name:"connectionNode_audio"}].forEach(function(b){if(a.elements[b.name])for(var c=Object.keys(a.elements[b.name]),e=0;e<c.length;e++){var d=
a.elements[b.name][c[e]];void 0==a.io[b.key]&&(a.io[b.key]={});a.io[b.key][d.name]=d}});a.disconnectEverything=function(){for(connectionType in a.io)for(connectionName in a.io[connectionType])a.io[connectionType][connectionName].disconnect()};a.allowIOConnections=function(b){if(void 0!=b)for(connectionType in a.io)for(connectionName in a.io[connectionType])a.io[connectionType][connectionName].allowConnections(b)};a.allowIODisconnections=function(b){if(void 0!=b)for(connectionType in a.io)for(connectionName in a.io[connectionType])a.io[connectionType][connectionName].allowDisconnections(b)};
f();for(b="spaceShape";void 0!=a.getChildByName(b);)b+=Math.floor(10*Math.random());e=g._interface.part.builder("polygon",b,{points:d.space,style:{fill:"rgba(0,0,0,0)"}});a.prepend(e);d.spaceOutline&&a.append(g._interface.part.builder("polygon",b+"Outline",{points:d.space,style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,1)"}}));a._parameter={};a._parameter.x=a.parameter.x;a._parameter.y=a.parameter.y;a._parameter.angle=a.parameter.angle;a.parameter.x=function(b){if(void 0!=a._parameter.x(b))return a.x;
d.x=b;f()};a.parameter.y=function(b){if(void 0!=a._parameter.y(b))return a.y;d.y=b;f()};a.parameter.angle=function(b){if(void 0!=a._parameter.angle(b))return a.angle;d.angle=b;f()};a.interactable=function(b){if(void 0!=b)for(partType in a.elements)for(partName in a.elements[partType])a.elements[partType][partName].interactable&&a.elements[partType][partName].interactable(b)};return a}console.error("workspace unit\u00a0builder:: creatorMethod missing")}}};g.system.mouse.functionList.onmousedown.push({requiredKeys:[],
function:function(r){g.control.gui.closeAllDropdowns()}});g.system.mouse.functionList.onmousedown.push({requiredKeys:[["shift"]],function:function(r){if(g.control.interaction.mouseGroupSelect())return g.system.mouse.tmp.selectionRectangle=g._interface.part.builder("rectangle","selectionRectangle",{x:r.x,y:r.y,width:0,height:0,style:{fill:"rgba(224, 184, 252, 0.25)"}}),g.system.pane.mf.append(g.system.mouse.tmp.selectionRectangle),g.system.mouse.tmp.start={x:r.x,y:r.y},g.system.mouse.mouseInteractionHandler(function(b){var d=
g.system.mouse.tmp.start;b=g.core.viewport.windowPoint2workspacePoint(b.x,b.y);g.system.mouse.tmp.selectionRectangle.parameter.width(b.x-d.x);g.system.mouse.tmp.selectionRectangle.parameter.height(b.y-d.y)},function(b){g.system.pane.mf.remove(g.system.mouse.tmp.selectionRectangle);var d=g.system.mouse.tmp.start;b=g.core.viewport.windowPoint2workspacePoint(b.x,b.y);g.control.selection.selectUnits(g.control.scene.getUnitsWithinPoly([{x:d.x,y:d.y},{x:b.x,y:d.y},{x:b.x,y:b.y},{x:d.x,y:b.y}]))}),!0}});
g.system.mouse.functionList.onmousedown.push({requiredKeys:[],function:function(r){if(g.control.interaction.mouseGripPanningEnabled())return g.control.selection.deselectEverything(),g.system.mouse.tmp.oldPosition=g.core.viewport.position(),g.system.mouse.tmp.clickPosition={x:r.event.x,y:r.event.y},g.system.mouse.mouseInteractionHandler(function(b){g.core.viewport.position(g.system.mouse.tmp.oldPosition.x-(g.system.mouse.tmp.clickPosition.x-b.x)/g.core.viewport.scale()*window.devicePixelRatio,g.system.mouse.tmp.oldPosition.y-
(g.system.mouse.tmp.clickPosition.y-b.y)/g.core.viewport.scale()*window.devicePixelRatio)},function(b){}),!0}});g.system.mouse.functionList.onwheel.push({requiredKeys:[],function:function(r){if(g.control.interaction.mouseWheelZoomEnabled()){var b=r.x,d=r.y,f=g.core.viewport.scale();f-=r.event.deltaY/100*f;20<f&&(f=20);.1>f&&(f=.1);g.core.viewport.scale(f);r=g.core.viewport.windowPoint2workspacePoint(r.event.x,r.event.y);b=g.library.math.cartesianAngleAdjust(r.x-b,r.y-d,g.core.viewport.angle());d=
g.core.viewport.position();g.core.viewport.position(d.x+b.x,d.y+b.y);return!0}}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","F2"],["command","F2"]],function:function(r){g.control.scene.load(void 0,void 0,!0);return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","F3"],["command","F3"]],function:function(r){g.control.scene.save();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyX"],["command","KeyX"]],
function:function(r){g.control.selection.cut();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyC"],["command","KeyC"]],function:function(r){g.system.keyboard.releaseKey("KeyC");g.control.selection.copy();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control","KeyV"],["command","KeyV"]],function:function(r){g.system.keyboard.releaseKey("KeyV");g.control.selection.paste();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["control",
"KeyB"],["command","KeyB"]],function:function(r){g.control.selection.duplicate();return!0}});g.system.keyboard.functionList.onkeydown.push({requiredKeys:[["Delete"],["Backspace"]],function:function(r){g.control.selection.delete();return!0}});g.control=new function(){var r=this;this.interaction=new function(){var b=!1;this.devMode=function(a){if(void 0==a)return b;if(b=a)for(item in this)if("devMode"!=item)this[item](!0)};var d=!0;this.enableMenubar=function(a){if(void 0==a)return d;(d=a)||r.gui.hideMenubar()};
var f=!0;this.enableSceneSave=function(a){if(void 0==a)return f;b||(f=a)};var a=!0;this.enableSceneLoad=function(c){if(void 0==c)return a;b||(a=c)};var e=!0;this.enableUnitAdditionRemoval=function(a){if(void 0==a)return e;b||(e=a)};var c=!0;this.enableUnitSelection=function(a){if(void 0==a)return c;b||(c=a)};var g=!0;this.enableUnitInteractable=function(a){if(void 0==a)return g;b||(g=a,r.scene.getAllUnits().forEach(function(a){return a.interactable(g)}))};var m=!0;this.enableUnitCollision=function(a){if(void 0==
a)return m;b||(m=a)};var k=!0;this.enableCableDisconnectionConnection=function(a){if(void 0==a)return k;b||(k=a,r.scene.getAllUnits().forEach(function(a){a.allowIOConnections(k);a.allowIODisconnections(k)}))};var t=!0;this.mouseGripPanningEnabled=function(a){if(void 0==a)return t;b||(t=a)};var q=!0;this.mouseWheelZoomEnabled=function(a){if(void 0==a)return q;b||(q=a)};var n=!0;this.mouseGroupSelect=function(a){if(void 0==a)return n;b||(n=a)}};this.gui=new function(){var b=g.system.pane.f,d=void 0,
f=window.devicePixelRatio;this.refresh=function(){void 0!=d&&d.refresh()};this.showMenubar=function(){g.control.interaction.enableMenubar()?void 0==d&&(d=r.gui.elements.menubar(0,0,f),b.append(d)):this.hideMenubar()};this.hideMenubar=function(){void 0!=d&&(b.remove(d),d=void 0)};this.closeAllDropdowns=function(){void 0!=d&&d.closeAllDropdowns()};this.elements=new function(){this.menubar=function(a,b,c){g.control.viewport.width();var e=20*c,d=void 0,f=void 0;a={text_fill:"rgba(0,0,0,1)",text_font:11.25*
c+"pt Helvetica",background__up__fill:"rgba(240,240,240,1)",background__press__fill:"rgba(240,240,240,1)",background__select_press__fill:"rgba(229,167,255,1)",background__press__stroke:"rgba(0,0,0,0)",background__select__fill:"rgba(229,167,255,1)",background__select__stroke:"rgba(0,0,0,0)",background__select_press__stroke:"rgba(0,0,0,0)"};var t={text_font:11.25*c+"pt Helvetica",item__up__fill:"rgba(240,240,240,1)",item__hover__fill:"rgba(229,167,255,1)"},q=g._interface.part.builder("group","menubar",
{}),n=g._interface.part.builder("rectangle","rectangle",{x:0,y:0,width:e,height:e,style:{fill:"rgba(240,240,240,1)"}});q.append(n);for(var r=b=0;r<this.menubar.dropdowns.length;r++){var p=g._interface.part.builder("button_rectangle","dropdownButton_"+r,{x:b*c,y:0,width:this.menubar.dropdowns[r].width*c,height:e,hoverable:!1,selectable:!0,text_centre:this.menubar.dropdowns[r].text,style:a});q.append(p);p.onpress=function(a){return function(){d=q.getChildByName("dropdownButton_"+a).select()?void 0:
a}}(r);p.onenter=function(a){return function(b){void 0!=d&&d!=a&&(q.getChildByName("dropdownButton_"+d).select(!1),d=a,0==b.buttons&&q.getChildByName("dropdownButton_"+d).select(!0))}}(r);p.onselect=function(a,b,h){return function(){for(var k=0,m=0;m<h.menubar.dropdowns[a].itemList.length;m++)switch(h.menubar.dropdowns[a].itemList[m]){case "break":k+=h.menubar.dropdowns[a].breakHeight*c;break;case "space":k+=h.menubar.dropdowns[a].spaceHeight*c;break;default:k+=h.menubar.dropdowns[a].listItemHeight*
c}k>g.control.viewport.height()*c&&(k=g.control.viewport.height()*c);f=g._interface.part.builder("list","dropdown",{x:b*c,y:e,style:t,width:h.menubar.dropdowns[a].listWidth*c,height:k,multiSelect:!1,selectable:!1,itemWidthMux:1,itemHeightMux:h.menubar.dropdowns[a].listItemHeight/k*c,breakHeightMux:h.menubar.dropdowns[a].breakHeight/k*c,spaceHeightMux:h.menubar.dropdowns[a].spaceHeight/k*c,itemSpacingMux:0,list:h.menubar.dropdowns[a].itemList});f.onrelease=function(){q.getChildByName("dropdownButton_"+
a).select(!1);d=void 0};q.append(f)}}(r,b,this);p.ondeselect=function(){q.remove(f)};this.menubar.dropdowns[r].x=b;b+=this.menubar.dropdowns[r].width}q.closeAllDropdowns=function(){if(void 0!=f)f.onrelease()};q.refresh=function(){n.parameter.width(g.control.viewport.width())};q.refresh();return q}}};this.viewport=new function(){this.width=function(){return g.width};this.height=function(){return g.height};this.scale=function(b){return g.core.viewport.scale(b)};this.position=function(b,d){return g.core.viewport.position(b,
d)};this.refresh=function(){g.core.viewport.refresh();r.gui.refresh()};this.stopMouseScroll=function(b){return g.core.viewport.stopMouseScroll(b)};this.activeRender=function(b){return g.core.render.active(b)}};this.scene=new function(){var b=g.system.pane.mm,d=0;this.new=function(b){if(void 0===b||!b||confirm("This will clear the current scene! Are you sure?"))r.selection.selectEverything(),r.selection.delete(),d=0,r.viewport.position(0,0),r.viewport.scale(0)};this.documentUnits=function(b){for(var a=
[],e=0;e<b.length;e++){var c=b[e],d={};d.position={x:c.parameter.x(),y:c.parameter.y(),angle:c.parameter.angle()};d.details={collection:c.collection,model:c.model};d.data=c.exportData?c.exportData():null;d.connections=[];for(var f in c.io)for(var g in c.io[f]){var r=c.io[f][g].getForeignNode();if(void 0!=r){var q={};q.typeAndNameOfSourcePort={type:f,name:g};q.indexOfDestinationUnit=b.indexOf(r.parent);q.typeAndNameOfDestinationPort={type:f,name:r.name};d.connections.push(q)}}a.push(d)}return a};this.printUnits=
function(b){for(var a=[],e=0;e<b.length;e++){var c=b[e],d=r.scene.addUnit(c.position.x,c.position.y,c.position.angle,c.details.model,c.details.collection);a.push(d);d.importData&&d.importData(c.data);r.selection.selectUnit(d);for(var f=0;f<c.connections.length;f++){var g=c.connections[f],t=r.selection.selectedUnits[g.indexOfDestinationUnit];void 0!=t&&d.io[g.typeAndNameOfSourcePort.type][g.typeAndNameOfSourcePort.name].connectTo(t.io[g.typeAndNameOfDestinationPort.type][g.typeAndNameOfDestinationPort.name])}}return a};
this.export=function(){return this.documentUnits(Array.from(b.children).filter(function(b){return!b._isCable}))};this.import=function(b){this.printUnits(b)};this.save=function(b,a){b=void 0===b?"project":b;a=void 0===a?!0:a;if(g.control.interaction.enableSceneSave()){var e={filename:b,viewportLocation:{xy:g.control.viewport.position(),scale:g.control.viewport.scale()}};g.library.audio.destination.masterGain(0);e.units=this.export();e=g.library.misc.serialize(e,a);e={compressed:a,data:e};e=g.library.misc.serialize(e,
!1);g.library.misc.printFile(b,e);g.library.audio.destination.masterGain(1)}};this.load=function(b,a,e){function c(a,b){g.library.audio.destination.masterGain(0);try{a=g.library.misc.unserialize(a,!1)}catch(t){console.error("Major error unserializing first layer of file");console.error(t);return}var c=a.compressed;try{a=g.library.misc.unserialize(a.data,c)}catch(t){console.error("Major error unserializing second layer of file");console.error(t);return}r.scene.new();r.scene.import(a.units);r.viewport.position(a.viewportLocation.xy.x,
a.viewportLocation.xy.y);r.viewport.scale(a.viewportLocation.scale);g.library.audio.destination.masterGain(1);r.selection.deselectEverything();b&&b(metadata)}e=void 0===e?!1:e;!g.control.interaction.enableSceneLoad()||e&&!confirm("This will clear the current scene! Are you sure?")||(void 0==b?g.library.misc.openFile(function(b){c(b,a)}):(e=new XMLHttpRequest,e.open("GET",b,!0),e.responseType="text",e.onload=function(){c(this.response,a)},e.send()))};this.generateUnitName=function(){return d++};this.addUnit=
function(d,a,e,c,h){h=void 0===h?"alpha":h;if(g.control.interaction.enableUnitAdditionRemoval()){var f=this.generateUnitName();if(void 0==g._interface.unit.collection[h])console.warn('unknown unit collection "'+h+'" (workspace._interface.unit.collection['+h+"])");else if(void 0==g._interface.unit.collection[h][c])console.warn('unknown unit model "'+c+'" (workspace._interface.unit.collection['+h+"]["+c+"])");else return d=g._interface.unit.collection[h][c](d,a,e),d.name=""+f,d=g.control.grapple.declare(d),
this.rectifyUnitPosition(d),b.append(d),d}};this.removeUnit=function(d){g.control.interaction.enableUnitAdditionRemoval()&&b.remove(d)};this.getAllUnits=function(){return b.children.filter(function(b){return!b._isCable})};this.getUnitByName=function(d){return b.getChildByName(d)};this.getUnitUnderPoint=function(d,a){for(var e=0;e<b.children.length;e++)if(g.library.math.detectOverlap.boundingBoxes({bottomRight:{x:d,y:a},topLeft:{x:d,y:a}},b.children[e].space.box)&&g.library.math.detectOverlap.pointWithinPoly({x:d,
y:a},b.children[e].space.points))return b.children[e]};this.getUnitsWithinPoly=function(d){var a=g.library.math.boundingBoxFromPoints(d);return b.children.filter(function(b){return!b._isCable&&g.library.math.detectOverlap.boundingBoxes(a,b.space.boundingBox)&&g.library.math.detectOverlap.overlappingPolygons(d,b.space.points)})};this.rectifyUnitPosition=function(b){if(g.control.interaction.enableUnitCollision()){var a=r.scene.getAllUnits().filter(function(a){return a!=b}).map(function(a){return a.space});
if(!g.library.math.detectOverlap.overlappingPolygonWithPolygons(b.space,a))return!1;a=g.library.math.fitPolyIn(b.space,a);b.parameter.x(b.parameter.x()+a.x);b.parameter.y(b.parameter.y()+a.y);return!0}}};this.selection=new function(){this.selectedUnits=[];this.lastSelectedUnits=null;this.clipboard=[];this.selectUnit=function(b,d){d=void 0===d?!0:d;if(g.control.interaction.enableUnitSelection()&&-1==this.selectedUnits.indexOf(b)){d&&(d=g.system.pane.getMiddlegroundPane(b),d.remove(b),d.append(b));
d=g._interface.part.builder("polygon","selectionGlow-"+b.getAddress(),{points:b.space.points.map(function(d){return g.library.math.cartesianAngleAdjust(d.x-b.x,d.y-b.y,-b.parameter.angle())}),style:{fill:"rgba(244, 226, 66, 0.25)",stroke:"rgba(244, 226, 66, 1)"}});b.append(d);if(b.onselect)object.onselect();this.selectedUnits.push(b);this.lastSelectedUnits=b}};this.selectUnits=function(b){for(var d=0;d<b.length;d++)this.selectUnit(b[d])};this.deselectUnit=function(b){b.remove(b.getChildByName("selectionGlow-"+
b.getAddress()));this.selectedUnits.splice(this.selectedUnits.indexOf(b),1);if(b.ondeselect)b.ondeselect()};this.selectEverything=function(){this.deselectEverything();for(var b=0;b<g.system.pane.mm.children.length;b++)g.system.pane.mm.children[b]._isCable||this.selectUnit(g.system.pane.mm.children[b],!1)};this.deselectEverything=function(){for(;0<this.selectedUnits.length;)this.deselectUnit(this.selectedUnits[0])};this.cut=function(){g.control.interaction.enableUnitAdditionRemoval()&&(this.copy(),
this.delete())};this.copy=function(){g.control.interaction.enableUnitAdditionRemoval()&&(this.clipboard=g.control.scene.documentUnits(this.selectedUnits))};this.paste=function(b){if(g.control.interaction.enableUnitAdditionRemoval()&&0!=this.clipboard.length){this.deselectEverything();if("duplicate"!=b){var d=[];this.clipboard.forEach(function(a){return d.push(a.position)});var f=g.library.math.boundingBoxFromPoints(d).topLeft;void 0==b&&(b=g.core.viewport.mousePosition(),void 0==b.x||void 0==b.y)&&
(b=g.core.viewport.windowPoint2workspacePoint(0,0));this.clipboard.forEach(function(a){a.position.x+=b.x-f.x;a.position.y+=b.y-f.y})}g.control.scene.printUnits(this.clipboard)}};this.duplicate=function(){g.control.interaction.enableUnitAdditionRemoval()&&(this.copy(),this.paste("duplicate"),this.clipboard=[])};this.delete=function(){if(g.control.interaction.enableUnitAdditionRemoval()){for(;0<this.selectedUnits.length;){var b=this.selectedUnits[0];if(b.ondelete)b.ondelete();b.disconnectEverything();
g.system.pane.getMiddlegroundPane(b).remove(b);this.selectedUnits.shift()}this.lastSelectedUnits=null}}}};g.control.grapple={tmpdata:{},tmpunit:void 0,functionList:{onmousedown:[],onmouseup:[]},declare:function(r){function b(b){return function(d,a,e){0==e.button&&(g.control.grapple.tmpunit=this,g.library.structure.functionListRunner(b,g.system.keyboard.pressedKeys)({event:e,x:d,y:a}))}}r.onmousedown=b(this.functionList.onmousedown);r.onmouseup=b(this.functionList.onmouseup);return r}};g.control.grapple.functionList.onmousedown.push({requiredKeys:[],
function:function(r){var b=g.control;b.selection.selectedUnits.includes(b.grapple.tmpunit)||(r.event.shiftKey||b.selection.deselectEverything(),b.selection.selectUnit(b.grapple.tmpunit))}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[["shift","alt"]],function:function(r){var b=g.control;b.grapple.tmpdata.oldClickPosition={x:r.x,y:r.y};b.grapple.tmpdata.oldUnitsPositions=[];b.grapple.tmpdata.oldUnitsSelectionArea=[];for(r=0;r<b.selection.selectedUnits.length;r++)b.grapple.tmpdata.oldUnitsPositions.push({x:b.selection.selectedUnits[r].x,
y:b.selection.selectedUnits[r].y,angle:b.selection.selectedUnits[r].angle}),b.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},b.selection.selectedUnits[r].selectionArea));g.system.mouse.mouseInteractionHandler(function(d){for(var f=0;f<b.selection.selectedUnits.length;f++){var a=b.selection.selectedUnits[f],e=b.grapple.tmpdata.oldClickPosition,c=g.core.viewport.windowPoint2workspacePoint(d.x,d.y);a.parameter.angle(b.grapple.tmpdata.oldUnitsPositions[f].angle+(c.y-e.y)/100);g.control.scene.rectifyUnitPosition(a);
if(a.onrotate)a.onrotate();if(a.io)for(e=Object.keys(a.io),c=0;c<e.length;c++)for(var h=a.io[e[c]],m=Object.keys(h),k=0;k<m.length;k++)h[m[k]].draw()}},function(b){});return!0}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[["alt"]],function:function(r){g.control.selection.duplicate()}});g.control.grapple.functionList.onmousedown.push({requiredKeys:[],function:function(r){var b=g.control;b.grapple.tmpdata.oldClickPosition={x:r.x,y:r.y};b.grapple.tmpdata.oldUnitsPositions=[];b.grapple.tmpdata.oldUnitsSelectionArea=
[];for(r=0;r<b.selection.selectedUnits.length;r++)b.grapple.tmpdata.oldUnitsPositions.push({x:b.selection.selectedUnits[r].x,y:b.selection.selectedUnits[r].y}),b.grapple.tmpdata.oldUnitsSelectionArea.push(Object.assign({},b.selection.selectedUnits[r].selectionArea));g.system.mouse.mouseInteractionHandler(function(d){for(var f=0;f<b.selection.selectedUnits.length;f++){var a=b.selection.selectedUnits[f],e=b.grapple.tmpdata.oldClickPosition,c=g.core.viewport.windowPoint2workspacePoint(d.x,d.y),h=b.grapple.tmpdata.oldUnitsPositions[f],
m=h.y+(c.y-e.y);a.parameter.x(h.x+(c.x-e.x));a.parameter.y(m);g.control.scene.rectifyUnitPosition(a);if(a.onmove)a.onmove();if(a.io)for(e=Object.keys(a.io),c=0;c<e.length;c++){h=a.io[e[c]];m=Object.keys(h);for(var k=0;k<m.length;k++)h[m[k]].draw()}}},function(b){})}});g.control.grapple.functionList.onmouseup.push({requiredKeys:[],function:function(r){var b=g.control;b.selection.selectedUnits.includes(b.grapple.tmpunit)&&(r.event.shiftKey&&b.selection.lastSelectedUnits!=b.grapple.tmpunit&&b.selection.deselectUnit(b.grapple.tmpunit),
b.selection.lastSelectedUnits=null);return!0}});window.onresize=g.control.viewport.refresh;g.control.interaction.devMode(null!=(new URL(window.location.href)).searchParams.get("dev"))}})();
