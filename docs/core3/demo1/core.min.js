var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var f=0;return function(){return f<b.length?{done:!1,value:b[f++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var f="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return f?f.call(b):$jscomp.arrayIterator(b)};$jscomp.arrayFromIterator=function(b){for(var f,e=[];!(f=b.next()).done;)e.push(f.value);return e};
$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,e){b!=Array.prototype&&b!=Object.prototype&&(b[f]=e.value)};$jscomp.polyfill=function(b,f,e,c){if(f){e=$jscomp.global;b=b.split(".");for(c=0;c<b.length-1;c++){var a=b[c];a in e||(e[a]={});e=e[a]}b=b[b.length-1];c=e[b];f=f(c);f!=c&&null!=f&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:f})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function f(){this.batch_=null}function e(d){return d instanceof a?d:new a(function(a,b){a(d)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;f.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})}this.batch_.push(a)};var c=$jscomp.global.setTimeout;f.prototype.asyncExecuteFunction=function(a){c(a,0)};f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};f.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var a=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var d=this.createResolveAndReject_();try{a(d.resolve,d.reject)}catch(k){d.reject(k)}};a.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};a.prototype.resolveTo_=function(d){if(d===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(d instanceof a)this.settleSameAsPromise_(d);else{a:switch(typeof d){case "object":var b=null!=d;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(d):this.fulfill_(d)}};a.prototype.resolveToNonPromiseObj_=function(a){var d=void 0;try{d=a.then}catch(k){this.reject_(k);return}"function"==typeof d?
this.settleSameAsThenable_(d,a):this.fulfill_(a)};a.prototype.reject_=function(a){this.settle_(2,a)};a.prototype.fulfill_=function(a){this.settle_(1,a)};a.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)g.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var g=new f;a.prototype.settleSameAsPromise_=function(a){var d=this.createResolveAndReject_();a.callWhenSettled_(d.resolve,d.reject)};a.prototype.settleSameAsThenable_=function(a,b){var d=this.createResolveAndReject_();try{a.call(b,d.resolve,d.reject)}catch(l){d.reject(l)}};a.prototype.then=function(d,b){function c(a,d){return"function"==typeof a?function(d){try{g(a(d))}catch(m){e(m)}}:d}var g,e,h=new a(function(a,d){g=a;e=d});this.callWhenSettled_(c(d,g),c(b,e));return h};
a.prototype.catch=function(a){return this.then(void 0,a)};a.prototype.callWhenSettled_=function(a,b){function d(){switch(c.state_){case 1:a(c.result_);break;case 2:b(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?g.asyncExecute(d):this.onSettledCallbacks_.push(d)};a.resolve=e;a.reject=function(d){return new a(function(a,b){b(d)})};a.race=function(d){return new a(function(a,b){for(var c=$jscomp.makeIterator(d),g=c.next();!g.done;g=c.next())e(g.value).callWhenSettled_(a,
b)})};a.all=function(d){var b=$jscomp.makeIterator(d),c=b.next();return c.done?e([]):new a(function(a,d){function g(d){return function(b){f[d]=b;h--;0==h&&a(f)}}var f=[],h=0;do f.push(void 0),h++,e(c.value).callWhenSettled_(g(f.length-1),d),c=b.next();while(!c.done)})};return a},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,e,c){var a=this.length||0;0>e&&(e=Math.max(0,a+e));if(null==c||c>a)c=a;c=Number(c);0>c&&(c=Math.max(0,a+c));for(e=Number(e||0);e<c;e++)this[e]=b;return this}},"es6","es3");
var core=new function(){var b=new Worker("core_engine.min.js"),f=this,e=document.getElementById("theCanvas");e.setAttribute("tabIndex",1);var c=new function(a,b){var d=this;this.log=function(){};this.function={};this.delayedFunction={};var c=0,g={};a.onmessage=function(b){var c=b.data;c.outgoing?c.cargo.function in d.function?(void 0==c.cargo.arguments&&(c.cargo.arguments=[]),null==c.id?d.function[c.cargo.function].apply(d.function,$jscomp.arrayFromIterable(c.cargo.arguments)):a.postMessage({id:c.id,
outgoing:!1,cargo:d.function[c.cargo.function].apply(d.function,$jscomp.arrayFromIterable(c.cargo.arguments))})):c.cargo.function in d.delayedFunction&&(void 0==c.cargo.arguments&&(c.cargo.arguments=[]),null==c.id?d.delayedFunction[c.cargo.function].apply(d.delayedFunction,$jscomp.arrayFromIterable(c.cargo.arguments)):d.delayedFunction[c.cargo.function].apply(d.delayedFunction,$jscomp.arrayFromIterable([function(d){a.postMessage({id:c.id,outgoing:!1,cargo:d})}].concat(c.cargo.arguments)))):(g[c.id](c.cargo),
delete g[c.id])};this.run=function(d,b,e,f){b=void 0===b?[]:b;var h=null;void 0!=e&&(h=c++,g[h]=e);a.postMessage({id:h,outgoing:!0,cargo:{function:d,arguments:b}},f)}}(b,"core_console");c.function.ready=function(){void 0!=core.ready&&core.ready()};c.function.printToScreen=function(a){e.getContext("bitmaprenderer").transferFromImageBitmap(a)};c.function["document.body.style.overflow"]=function(a){if(void 0==a)return document.body.style.overflow;document.body.style.overflow=a};c.function["window.devicePixelRatio"]=
function(a){if(void 0==a)return window.devicePixelRatio;window.devicePixelRatio=a};c.function.setCanvasAttributes=function(a,c){a=void 0===a?[]:a;c=void 0===c?[]:c;a.forEach(function(a,b){e[(c[b]?"core":"")+a.name]=a.value})};c.function.getCanvasAttributes=function(a,c){c=void 0===c?[]:c;return a.map(function(a,b){return e.getAttribute((c[b]?"core":"")+a)})};c.function.getCanvasParentAttributes=function(a,c){c=void 0===c?[]:c;return a.map(function(a,b){return e.parentElement[(c[b]?"core":"")+a]})};
this.ready=function(){};this.refresh=function(){return new Promise(function(a,b){c.run("refresh",[],a)})};this.element=new function(){this.getAvailableElements=function(){return new Promise(function(a,b){c.run("element.getAvailableElements",[],a)})};this.getCreatedElements=function(){return new Promise(function(a,b){c.run("element.getCreatedElements",[],a)})};this.create=function(a,b){return new Promise(function(d,g){c.run("element.create",[a,b],d)})};this.delete=function(a){c.run("element.delete",
[a],resolve)};this.deleteAllCreated=function(){c.run("element.deleteAllCreated",[],resolve)};this.getTypeById=function(a){return new Promise(function(b,d){c.run("element.getTypeById",[a],b)})};this.executeMethod=function(a,b,d){d=void 0===d?[]:d;return new Promise(function(g,e){c.run("element.executeMethod",[a,b,d],g)})};this.boatload_executeMethod=new function(){var a=[];this.load=function(c){a.push(c)};this.ship=function(){c.run("element.boatload_executeMethod",[a]);a=[]}};this._dump=function(){c.run("element._dump")}};
this.arrangement=new function(){this.new=function(){c.run("arrangement.new")};this.prepend=function(a){c.run("arrangement.prepend",[a])};this.append=function(a){c.run("arrangement.append",[a])};this.remove=function(a){c.run("arrangement.remove",[a])};this.clear=function(){c.run("arrangement.clear")};this.getElementByAddress=function(a){return new Promise(function(b,d){c.run("arrangement.getElementByAddress",[a],b)})};this.getElementsUnderPoint=function(a,b){return new Promise(function(d,g){c.run("arrangement.getElementsUnderPoint",
[a,b],d)})};this.getElementsUnderArea=function(a){return new Promise(function(b,d){c.run("arrangement.getElementsUnderArea",[a],b)})};this.printTree=function(a){c.run("arrangement.printTree",[a])};this._dump=function(){c.run("arrangement._dump")}};this.render=new function(){this.clearColour=function(a){return new Promise(function(b,d){c.run("render.clearColour",[a],b)})};this.adjustCanvasSize=function(a,b){c.run("render.adjustCanvasSize",[a,b])};this.refreshCoordinates=function(){c.run("render.refreshCoordinates",
[])};this.refresh=function(){return new Promise(function(a,b){c.run("render.refresh",[],a)})};this.activeLimitToFrameRate=function(a){return new Promise(function(b,d){c.run("render.activeLimitToFrameRate",[a],b)})};this.frameRateLimit=function(a){return new Promise(function(b,d){c.run("render.frameRateLimit",[a],b)})};this.frame=function(){c.run("render.frame",[])};this.active=function(a){return new Promise(function(b,d){c.run("render.active",[a],b)})};this.getCanvasDimensions=function(){return new Promise(function(a,
b){c.run("render.getCanvasDimensions",[],a)})};this.drawDot=function(a,b,d,e){c.run("render.drawDot",[a,b,d,e])};this._dump=function(){c.run("render._dump",[])}};this.viewport=new function(){this.position=function(a,b){return new Promise(function(d,e){c.run("viewport.position",[a,b],d)})};this.scale=function(a){return new Promise(function(b,d){c.run("viewport.scale",[a],b)})};this.angle=function(a){return new Promise(function(b,d){c.run("viewport.angle",[a],b)})};this.getElementUnderCanvasPoint=function(a,
b){return new Promise(function(d,e){c.run("viewport.getElementUnderCanvasPoint",[a,b],d)})};this.getElementsUnderCanvasArea=function(a){return new Promise(function(b,d){c.run("viewport.getElementsUnderCanvasArea",[a],b)})};this.calculateViewportExtremities=function(){c.run("viewport.calculateViewportExtremities",[])};this.refresh=function(){c.run("viewport.refresh",[])};this.getBoundingBox=function(){return new Promise(function(a,b){c.run("viewport.getBoundingBox",[],a)})};this.mousePosition=function(a,
b){return new Promise(function(d,e){c.run("viewport.mousePosition",[a,b],d)})};this.stopMouseScroll=function(a){return new Promise(function(b,d){c.run("viewport.stopMouseScroll",[a],b)})};this.clickVisibility=function(a){return new Promise(function(b,d){c.run("viewport.clickVisibility",[a],b)})};this.getHeight=function(){return new Promise(function(a,b){c.run("viewport.getHeight",[],a)})};this.getWidth=function(){return new Promise(function(a,b){c.run("viewport.getWidth",[],a)})};this._dump=function(){c.run("viewport._dump",
[])};this.onCameraAdjust=function(a){};c.function["viewport.onCameraAdjust"]=this.onCameraAdjust};this.stats=new function(){this.active=function(a){return new Promise(function(b,d){c.run("stats.active",[a],b)})};this.getReport=function(){return new Promise(function(a,b){c.run("stats.getReport",[],a)})}};this.callback=new function(){var a=new function(){var a={};this.register=function(b,c,d){b in a||(a[b]={});a[b][c]=d};this.remove=function(b,c){a[b][c]=void 0;delete a[b][c]};this.call=function(b,
c,d,e,f){if(void 0!=b&&void 0!=a[b]&&void 0!=a[b][c])a[b][c](d,e,f)}};this.listCallbackTypes=function(){return new Promise(function(a,b){c.run("callback.listCallbackTypes",[],a)})};this.getShapeCallbackState=function(a){return new Promise(function(b,d){c.run("callback.getShapeCallbackState",[a],b)})};this.activateShapeCallback=function(a){c.run("callback.activateShapeCallback",[a])};this.disactivateShapeCallback=function(a){c.run("callback.disactivateShapeCallback",[a])};this.activateAllShapeCallbacks=
function(){c.run("callback.activateAllShapeCallbacks",[])};this.disactivateAllShapeCallbacks=function(){c.run("callback.disactivateAllShapeCallbacks",[])};this.attachCallback=function(b,e,f){a.register(b,e,f);c.run("callback.attachCallback",[b,e])};this.removeCallback=function(b,e){a.remove(b,e);c.run("callback.removeCallback",[b,e])};var b=!1;this.allowDeepElementCallback=function(a){if(void 0==a)return b;b=a};this.functions={};this.listCallbackTypes().then(function(d){d.forEach(function(d){e[d]=
function(a){var b={};a instanceof KeyboardEvent?b={key:a.key,code:a.code,keyCode:a.keyCode,altKey:a.altKey,ctrlKey:a.ctrlKey,metaKey:a.metaKey,shiftKey:a.shiftKey}:a instanceof WheelEvent?b={X:a.offsetX,Y:a.offsetY,wheelDelta:a.wheelDelta,wheelDeltaX:a.wheelDeltaX,wheelDeltaY:a.wheelDeltaY}:a instanceof MouseEvent?b={X:a.offsetX,Y:a.offsetY}:console.warn("unknown event type: ",a);c.run("callback.coupling."+d,[b])};c.function["callback."+d]=function(c,e,g,h){b?h.forEach(function(b){a.call(b,d,c,e,
g)}):a.call(h[0],d,c,e,g);if(f.callback.functions[d])f.callback.functions[d](c,e,g,h)}})})}},rectangleCount=16,upper_band={elementIds:[],tick:0,tickStep:.02*rectangleCount,wavelength:3,colour:{current:{r:.9,g:0,b:0,a:1},origin:{r:1,g:0,b:0,a:1},destination:{r:Math.random(),g:Math.random(),b:Math.random(),a:1},journeyPercentageStepSize:.025,journeyPercentage:0,history:Array(rectangleCount).fill().map(function(){return{r:1,g:1,b:1,a:1}}),changeCounter:0,changeStepSize:.5}},middle_band={elementIds:[],
tick:0,tickStep:.02*rectangleCount,wavelength:2,colour:{current:{r:0,g:.9,b:0,a:1},origin:{r:1,g:1,b:0,a:1},destination:{r:Math.random(),g:Math.random(),b:Math.random(),a:1},journeyPercentageStepSize:.025,journeyPercentage:0,history:Array(rectangleCount).fill().map(function(){return{r:1,g:1,b:1,a:1}}),changeCounter:0,changeStepSize:1/3}},lower_band={elementIds:[],tick:0,tickStep:.02*rectangleCount,wavelength:1,colour:{current:{r:0,g:0,b:.9,a:1},origin:{r:1,g:1,b:0,a:1},destination:{r:Math.random(),
g:Math.random(),b:Math.random(),a:1},journeyPercentageStepSize:1/30,journeyPercentage:0,history:Array(rectangleCount).fill().map(function(){return{r:1,g:1,b:1,a:1}}),changeCounter:0,changeStepSize:.25}};function produceRectangle(b,f,e,c,a){core.element.create("rectangle",c+b).then(function(c){core.element.executeMethod(c,"unifiedAttribute",[{x:f-30*b,y:e,width:30,height:30}]);core.arrangement.append(c);a.push(c)})}
core.render.getCanvasDimensions().then(function(b){for(var f=0;f<rectangleCount;f++)produceRectangle(f,200+b.width/2,-175+b.height/2,"upperBand_rectangle_",upper_band.elementIds),produceRectangle(f,210+b.width/2,-100+b.height/2,"middleBand_rectangle_",middle_band.elementIds),produceRectangle(f,200+b.width/2,75+b.height/2,"lowerBand_rectangle_",lower_band.elementIds)});var canvasDimensions={width:0,height:0};core.render.getCanvasDimensions().then(function(b){canvasDimensions=b});
function blendColours(b,f,e){return{r:(1-e)*b.r+e*f.r,g:(1-e)*b.g+e*f.g,b:(1-e)*b.b+e*f.b,a:(1-e)*b.a+e*f.a}}
function updateColour(b){1<=b.colour.changeCounter&&(b.colour.changeCounter=0,1<=b.colour.journeyPercentage?(b.colour.journeyPercentage=0,b.colour.origin=b.colour.destination,b.colour.current=b.colour.destination,b.colour.destination={r:Math.random(),g:Math.random(),b:Math.random(),a:1}):b.colour.current=blendColours(b.colour.current,b.colour.destination,b.colour.journeyPercentage),b.colour.history.push(b.colour.current),b.colour.history.length>rectangleCount&&b.colour.history.shift(),b.colour.journeyPercentage+=
b.colour.journeyPercentageStepSize);b.colour.changeCounter+=b.colour.changeStepSize}
setInterval(function(){updateColour(upper_band);updateColour(middle_band);updateColour(lower_band);upper_band.elementIds.forEach(function(b,f){var e=(upper_band.tick+f*upper_band.wavelength)/upper_band.elementIds.length*Math.PI;core.element.boatload_executeMethod.load({id:b,method:"unifiedAttribute",argumentList:[{width:30+25*Math.sin(e),height:30+25*Math.cos(e),colour:upper_band.colour.history[f]}]})});middle_band.elementIds.forEach(function(b,f){var e=(middle_band.tick+f*middle_band.wavelength)/
middle_band.elementIds.length*Math.PI;core.element.boatload_executeMethod.load({id:b,method:"unifiedAttribute",argumentList:[{y:-45+25*Math.sin(e)+canvasDimensions.height/2,height:30+25*Math.cos(e),colour:middle_band.colour.history[f]}]})});lower_band.elementIds.forEach(function(b,f){var e=(lower_band.tick+f*lower_band.wavelength)/lower_band.elementIds.length*Math.PI;core.element.boatload_executeMethod.load({id:b,method:"unifiedAttribute",argumentList:[{width:30+25*Math.sin(e),y:canvasDimensions.height/
2+105+25*Math.cos(e),colour:lower_band.colour.history[f]}]})});upper_band.tick+=upper_band.tickStep;middle_band.tick+=middle_band.tickStep;lower_band.tick+=lower_band.tickStep;core.element.boatload_executeMethod.ship()},25);core.render.active(!0);core.render.frameRateLimit(40);
