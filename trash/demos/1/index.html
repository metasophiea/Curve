<!DOCTYPE html>
<html lang="en">
    
    <head>
        <title>curve</title>
        <meta charset="utf-8"></meta>
        <style>
            html, body{
                margin:0px;
                width:100%; height:100%;
                overflow-x: hidden; overflow-y: hidden;
            }
        </style>
    </head>

    <body>
        <section style='width:100%; height:100%;'>
            <svg workspace style='width:100%; height:100%;'></svg>
        </section>
    </body>

</html>

<script type='text/javascript' src='../../workspace.min.js'></script>


<script>
    //create objects
        var pulseGenerator = system.utility.workspace.placeAndReturnObject( object.pulseGenerator(1260, -5) );
        var launchpad_1 = system.utility.workspace.placeAndReturnObject( object.launchpad(1110, 20) );
        var launchpad_2 = system.utility.workspace.placeAndReturnObject( object.launchpad(970, 125) );
        var launchpad_3 = system.utility.workspace.placeAndReturnObject( object.launchpad(785, 245) );
        var launchpad_4 = system.utility.workspace.placeAndReturnObject( object.launchpad(615, 190) );
        var oneShot_multi_multiTrack = system.utility.workspace.placeAndReturnObject( object.oneShot_multi_multiTrack(330, 15) );
        var audio_sink = system.utility.workspace.placeAndReturnObject( object.audio_sink(20,20) );
        var reverbUnit_1 = system.utility.workspace.placeAndReturnObject( object.reverbUnit(170, 20) );
        var reverbUnit_2 = system.utility.workspace.placeAndReturnObject( object.reverbUnit(170, 80) );

    //connect obejcts
        pulseGenerator.io.out.connectTo(launchpad_1.io.pulse);
        for(var a = 0; a < 4; a++){ launchpad_1.io['out_'+a].connectTo(oneShot_multi_multiTrack.io['trigger_'+a]); }
        launchpad_1.io.out_7.connectTo(launchpad_2.io.pulse);
        launchpad_2.io.out_0.connectTo(launchpad_4.io.pulse);
        launchpad_2.io.out_3.connectTo(launchpad_3.io.pulse);
        launchpad_3.io.out_1.connectTo(launchpad_4.io.nextPage);
        launchpad_3.io.out_2.connectTo(launchpad_4.io.prevPage);
        launchpad_4.io.out_4.connectTo(oneShot_multi_multiTrack.io.trigger_4);
        launchpad_4.io.out_5.connectTo(oneShot_multi_multiTrack.io.trigger_5);
        launchpad_4.io.out_6.connectTo(oneShot_multi_multiTrack.io.trigger_6);
        launchpad_4.io.out_7.connectTo(oneShot_multi_multiTrack.io.trigger_7);
        oneShot_multi_multiTrack.io.outRight.connectTo( reverbUnit_1.io.audioIn );
        oneShot_multi_multiTrack.io.outLeft.connectTo( reverbUnit_2.io.audioIn );
        reverbUnit_1.io.audioOut.connectTo( audio_sink.io.right );
        reverbUnit_2.io.audioOut.connectTo( audio_sink.io.left );

    //load sounds from urls into the multi track
        var libURLs = ['https://metasophiea.com/curve/demos/1/sounds/','https://metasophiea.com/apps/partyCalculator/tracks/'];
        var sounds = [
            libURLs[0]+'bass.mp3', 
            libURLs[0]+'snare.mp3', 
            libURLs[0]+'openHiHat.mp3', 
            libURLs[0]+'closeHiHat.mp3', 
            libURLs[0]+'crash.mp3',
            libURLs[1]+'1-bassSynth_08.wav',
            libURLs[1]+'5-strings_09.wav',
            libURLs[1]+'2-mallet_03.wav'
        ];
        for(var a = 0; a < sounds.length; a++){ oneShot_multi_multiTrack.i.loadURL(a, sounds[a]); }

    //load performance data into the launchpads and set their pages
        launchpad_1.i.importPages([
            [
                [true, false,false,true, false,true, false,false],
                [false,false,true, false,false,false,true, false],
                [false,false,false,false,false,false,false,true ],
                [false,true, true, false,true, true, false,false],
                [false,false,false,false,false,false,false,false],
                [false,false,false,false,false,false,false,false],
                [false,false,false,false,false,false,false,false],
                [true, false,false,false,false,false,false,false],
            ],
            [
                [true, false,false,true, true, false,false,false],
                [false,false,true, false,false,false,true, false],
                [false,false,false,false,false,false,false,false],
                [true, false,true, false,true, false,true, false]
                [false,false,false,false,false,false,false,false],
                [false,false,false,false,false,false,false,false],
                [false,false,false,false,false,false,false,false],
                [true, false,false,false,false,false,false,false],
            ],
            [
                [true, false,false,true, true, true, false,false],
                [false,false,true, false,false,true, false,false],
                [false,false,false,false,false,false,true, false],
                [false,false,false,false,false,false,false,false],
                [false,false,false,false,false,false,false,false],
                [false,false,false,false,false,false,false,false],
                [false,false,false,false,false,false,false,false],
                [true, false,false,false,false,false,false,false],
            ],
        ]);
        launchpad_2.i.importPage([
            [true, false,true, false,true, false,true, false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,true, false,false,false,true, false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
        ],5);
        launchpad_2.i.setPage(5);

        launchpad_3.i.importPage([
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,true, false,false],
            [false,true, false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
        ],9);
        launchpad_3.i.setPage(9);

        launchpad_4.i.importPage([
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [true, false,false,false,false,false,false,false],
            [false,false,false,false,true, false,true, false],
            [true, false,true, false,true, false,true, false],
        ],0);
        launchpad_4.i.importPage([
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,false,false,false,false,false,false],
            [false,false,true, false,false,false,true, false],
            [true, false,true, false,true, false,true, false],
            [false,false,true, false,true, false,false,false],
            [true, false,true, false,false,false,false,false],
        ],1);
        launchpad_4.i.setPage(1);

    //adjust the tempo of the pulse generator
        pulseGenerator.i.setTempo(1);

    //set the play-areas in the multi track
        oneShot_multi_multiTrack.i.area(0,0.022635858200536246, 0.3112601773120755);
        oneShot_multi_multiTrack.i.area(1,0.024827894657491516, 0.14734331790792068);
        oneShot_multi_multiTrack.i.area(2,0.008972957530965352, 0.18193590800215986);
        oneShot_multi_multiTrack.i.area(3,0.01041431545155863,  0.12139887533724177);

</script>