<!DOCTYPE html>
<html lang="en">
    
    <head>
        <title>test</title>
        <meta charset="utf-8"></meta>
    </head>

    <body>   
    </body>

</html>

<script>
    const context = new AudioContext();

    context.audioWorklet.addModule('momentaryAmplitudeMeter.js').then( () => {
        const osc = new OscillatorNode(context);
        const gain = new GainNode(context);
        const MAM = new AudioWorkletNode(context, 'momentaryAmplitudeMeter');
        osc.connect(gain).connect(MAM).connect(context.destination);
        osc.start();

        MAM.port.onmessage = function(msg){ console.log(msg.data); }

        osc.frequency.setTargetAtTime(440, context.currentTime, 0);

        gain.gain.linearRampToValueAtTime(0, context.currentTime+10);
    });
</script>